---
about_this_resource_text: '<p><strong>Description:</strong> Succinct: Compact suffix
  arrays and trees.</p> <p><strong>Speaker:</strong> Prof. Erik Demaine</p>'
course_id: 6-851-advanced-data-structures-spring-2012
embedded_media:
- id: Video-YouTube-Stream
  media_location: ABX-Hvn8ymE
  parent_uid: 08ed076386c178aa4f42b9e22c393026
  title: Video-YouTube-Stream
  type: Video
  uid: 29e3e8271b3fdf16c5d8aec5c9bc99d2
- id: Video-iTunesU-MP4
  media_location: https://itunes.apple.com/us/itunes-u/session-18-succinct-structures/id735348884?i=169611744
  parent_uid: 08ed076386c178aa4f42b9e22c393026
  title: Video-iTunes U-MP4
  type: Video
  uid: e9231db67e7bbbb8f491bea03d3b3e20
- id: Video-InternetArchive-MP4
  media_location: http://www.archive.org/download/MIT6.851S12/MIT6_851S12_lec18_300k.mp4
  parent_uid: 08ed076386c178aa4f42b9e22c393026
  title: Video-Internet Archive-MP4
  type: Video
  uid: e8bbe8c00472a5f05ecbb18e24b730bd
- id: Thumbnail-YouTube-JPG
  media_location: https://img.youtube.com/vi/ABX-Hvn8ymE/default.jpg
  parent_uid: 08ed076386c178aa4f42b9e22c393026
  title: Thumbnail-YouTube-JPG
  type: Thumbnail
  uid: c800e2669835fd786163a95b3574d8de
- id: 3Play-3PlayYouTubeid-MP4
  media_location: ABX-Hvn8ymE
  parent_uid: 08ed076386c178aa4f42b9e22c393026
  title: 3Play-3Play YouTube id
  type: 3Play
  uid: 170a6c8b100673b4a227a564f86d722a
- id: ABX-Hvn8ymE.srt
  parent_uid: 08ed076386c178aa4f42b9e22c393026
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-851-advanced-data-structures-spring-2012/lecture-videos/session-18-succinct-structures-ii/ABX-Hvn8ymE.srt
  title: 3play caption file
  type: null
  uid: f7c4046455f888dafcb1422ad9829df6
- id: ABX-Hvn8ymE.pdf
  parent_uid: 08ed076386c178aa4f42b9e22c393026
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-851-advanced-data-structures-spring-2012/lecture-videos/session-18-succinct-structures-ii/ABX-Hvn8ymE.pdf
  title: 3play pdf file
  type: null
  uid: cf225dffc85272835a73d436d6db813b
- id: Caption-3Play YouTube id-SRT
  parent_uid: 08ed076386c178aa4f42b9e22c393026
  title: Caption-3Play YouTube id-SRT-English - US
  type: Caption
  uid: 0d8238a12dc1b04f09e2e1ad780bb6c3
- id: Transcript-3Play YouTube id-PDF
  parent_uid: 08ed076386c178aa4f42b9e22c393026
  title: Transcript-3Play YouTube id-PDF-English - US
  type: Transcript
  uid: 9a68111f1dea8c2b7f68cab7d3161102
inline_embed_id: 94247881session18:succinctstructuresii31153433
layout: video
order_index: null
parent_uid: b66cbbb7b35e74ff17cdbf44e5fb6b1d
related_resources_text: ''
short_url: session-18-succinct-structures-ii
technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-851-advanced-data-structures-spring-2012/lecture-videos/session-18-succinct-structures-ii
template_type: Tabbed
title: 'Session 18: Succinct Structures II'
transcript: <p><span m='90'>The</span> <span m='180'>following</span> <span m='630'>content</span>
  <span m='1200'>is</span> <span m='1320'>provided</span> <span m='1770'>under</span>
  <span m='2009'>a</span> <span m='2070'>Creative</span> <span m='2490'>Commons</span>
  <span m='2910'>license.</span> <span m='4030'>Your</span> <span m='4200'>support</span>
  <span m='4710'>will</span> <span m='4860'>help</span> <span m='5100'>MIT</span>
  <span m='5550'>OpenCourseWare</span> <span m='6360'>continue</span> <span m='6870'>to</span>
  <span m='6960'>offer</span> <span m='7380'>high</span> <span m='7620'>quality</span>
  <span m='8100'>educational</span> <span m='8730'>resources</span> <span m='9330'>for</span>
  <span m='9510'>free.</span> <span m='10720'>To</span> <span m='10740'>make</span>
  <span m='10920'>a</span> <span m='10980'>donation,</span> <span m='11730'>or</span>
  <span m='11940'>view</span> <span m='12390'>additional</span> <span m='12810'>materials</span>
  <span m='13320'>from</span> <span m='13500'>hundreds</span> <span m='13920'>of</span>
  <span m='14040'>MIT</span> <span m='14460'>courses,</span> <span m='15550'>visit</span>
  <span m='15780'>MIT</span> <span m='16200'>OpenCourseWare</span> <span m='17280'>at</span>
  <span m='17430'>ocw.mit.edu.</span> </p><p><span m='21240'>ERIK DEMAINE:</span>
  <span m='21630'>All</span> <span m='21720'>right,</span> <span m='21960'>welcome</span>
  <span m='22350'>back</span> <span m='22680'>to</span> <span m='22940'>Succinct</span>
  <span m='23490'>Data</span> <span m='23790'>Structures,</span> <span m='24420'>part</span>
  <span m='24750'>two</span> <span m='25260'>of</span> <span m='25380'>two.</span>
  <span m='26580'>Today</span> <span m='27060'>we're</span> <span m='27210'>going</span>
  <span m='27330'>to</span> <span m='27510'>take</span> <span m='27810'>all</span>
  <span m='27930'>the</span> <span m='28050'>stuff</span> <span m='28320'>we</span>
  <span m='28410'>know</span> <span m='28560'>about</span> <span m='28830'>tries</span>
  <span m='29610'>and</span> <span m='29910'>apply</span> <span m='30270'>them</span>
  <span m='30480'>to</span> <span m='31170'>the</span> <span m='31290'>main</span>
  <span m='31560'>motivating</span> <span m='32070'>application,</span> <span m='32770'>which</span>
  <span m='32910'>is</span> <span m='33600'>suffix</span> <span m='34020'>trees.</span>
  </p><p><span m='35190'>And</span> <span m='35550'>as</span> <span m='35730'>we</span>
  <span m='35820'>know,</span> <span m='35970'>suffix</span> <span m='36360'>trees</span>
  <span m='36570'>and</span> <span m='36660'>suffix</span> <span m='37050'>arrays</span>
  <span m='37320'>are</span> <span m='37410'>more</span> <span m='37590'>or</span>
  <span m='37620'>less</span> <span m='37830'>equivalent.</span> <span m='39510'>But</span>
  <span m='41460'>if</span> <span m='41610'>you</span> <span m='41730'>build</span>
  <span m='42030'>one,</span> <span m='42390'>you</span> <span m='42570'>can</span>
  <span m='42720'>build</span> <span m='42990'>the</span> <span m='43110'>other.</span>
  <span m='43900'>But</span> <span m='44010'>what</span> <span m='44160'>we're</span>
  <span m='44250'>going</span> <span m='44370'>to</span> <span m='44460'>show</span>
  <span m='44670'>today</span> <span m='44940'>is</span> <span m='45090'>they're</span>
  <span m='45270'>equivalent</span> <span m='45720'>also</span> <span m='46170'>from</span>
  <span m='46440'>a</span> <span m='46500'>space</span> <span m='46920'>perspective.</span>
  <span m='47500'>That</span> <span m='47640'>will</span> <span m='47760'>be</span>
  <span m='47850'>the</span> <span m='47970'>last</span> <span m='48270'>topic.</span>
  <span m='49130'>If</span> <span m='49740'>you</span> <span m='49860'>can</span>
  <span m='50040'>succinctly</span> <span m='50520'>represent</span> <span m='50940'>a</span>
  <span m='51000'>suffix</span> <span m='51420'>array,</span> <span m='52980'>then</span>
  <span m='53220'>you</span> <span m='53340'>can</span> <span m='53580'>transform--</span>
  <span m='54360'>with</span> <span m='54570'>a</span> <span m='55230'>little o</span>
  <span m='55560'>of</span> <span m='55800'>n</span> <span m='55950'>extra</span>
  <span m='56250'>space,</span> <span m='56700'>you</span> <span m='56940'>can</span>
  <span m='57930'>make</span> <span m='58170'>a</span> <span m='58230'>suffix</span>
  <span m='58620'>tree</span> <span m='58890'>as</span> <span m='59010'>well</span>
  <span m='59430'>and</span> <span m='59640'>do</span> <span m='59970'>searches</span>
  <span m='60510'>in</span> <span m='60690'>roughly</span> <span m='61500'>the</span>
  <span m='61680'>time</span> <span m='62040'>we're</span> <span m='62220'>used</span>
  <span m='62550'>to,</span> <span m='62920'>which</span> <span m='63060'>is</span>
  <span m='63310'>p</span> <span m='63750'>plus</span> <span m='64019'>size</span>
  <span m='64319'>of</span> <span m='64410'>output.</span> </p><p><span m='66180'>It's</span>
  <span m='66330'>not</span> <span m='66450'>going</span> <span m='66570'>to</span>
  <span m='66630'>be</span> <span m='66690'>exactly</span> <span m='67080'>that.</span>
  <span m='67260'>We're</span> <span m='67350'>going</span> <span m='67470'>to</span>
  <span m='67530'>lose</span> <span m='67980'>like</span> <span m='68010'>log</span>
  <span m='68250'>to</span> <span m='68340'>the</span> <span m='68460'>epsilons</span>
  <span m='69000'>and</span> <span m='69090'>such.</span> <span m='69660'>But</span>
  <span m='70020'>that's</span> <span m='70620'>mostly</span> <span m='71190'>caused--</span>
  <span m='71620'>this</span> <span m='71880'>transformation</span> <span m='72450'>only</span>
  <span m='72630'>occurs</span> <span m='72990'>like</span> <span m='74070'>an</span>
  <span m='74190'>additive</span> <span m='74610'>log,</span> <span m='74880'>log,</span>
  <span m='75090'>log,</span> <span m='75300'>log,</span> <span m='75510'>log,</span>
  <span m='75750'>log</span> <span m='76050'>n.</span> <span m='77240'>You</span>
  <span m='77403'>could</span> <span m='77566'>have</span> <span m='77730'>as</span>
  <span m='77835'>many</span> <span m='77940'>logs</span> <span m='78210'>as</span>
  <span m='78330'>you</span> <span m='78420'>want.</span> </p><p><span m='79800'>Take</span>
  <span m='80070'>any</span> <span m='80550'>arbitrarily,</span> <span m='81120'>slowly</span>
  <span m='81840'>growing</span> <span m='82200'>function,</span> <span m='83700'>that</span>
  <span m='84120'>it</span> <span m='84330'>will--</span> <span m='84940'>your</span>
  <span m='85110'>space</span> <span m='85380'>bound</span> <span m='85590'>gets</span>
  <span m='85710'>closer</span> <span m='86100'>and</span> <span m='86190'>closer</span>
  <span m='86490'>to</span> <span m='86580'>linear.</span> <span m='87610'>Anyway,</span>
  <span m='87930'>that's</span> <span m='88140'>what</span> <span m='88250'>we'll</span>
  <span m='88340'>get</span> <span m='88460'>to</span> <span m='88620'>at</span> <span
  m='88680'>the</span> <span m='88770'>end.</span> <span m='89580'>The</span> <span
  m='89730'>bulk</span> <span m='90000'>of</span> <span m='90060'>the</span> <span
  m='90150'>lecture</span> <span m='90450'>will</span> <span m='90630'>be</span> <span
  m='90810'>on</span> <span m='91070'>building</span> <span m='91440'>suffix</span>
  <span m='91860'>arrays.</span> </p><p><span m='92360'>Here</span> <span m='92550'>we're</span>
  <span m='92640'>going</span> <span m='92760'>to</span> <span m='92820'>lose</span>
  <span m='93060'>a</span> <span m='93120'>log</span> <span m='93360'>to</span> <span
  m='93450'>the</span> <span m='93570'>epsilon</span> <span m='94290'>time</span>
  <span m='94800'>in</span> <span m='95670'>the</span> <span m='95760'>query.</span>
  <span m='96810'>And</span> <span m='96930'>we're</span> <span m='97020'>going</span>
  <span m='97140'>to</span> <span m='97200'>start</span> <span m='97470'>out</span>
  <span m='99300'>improving</span> <span m='99810'>down</span> <span m='100020'>to</span>
  <span m='100140'>T</span> <span m='100440'>log</span> <span m='100740'>log</span>
  <span m='100920'>T</span> <span m='101120'>space.</span> <span m='101400'>Our</span>
  <span m='101700'>bottom</span> <span m='102060'>line</span> <span m='102300'>is</span>
  <span m='102450'>T</span> <span m='102660'>log</span> <span m='102900'>T</span>
  <span m='103110'>space.</span> <span m='103500'>That's</span> <span m='103680'>a</span>
  <span m='103770'>normal--</span> <span m='104310'>if</span> <span m='104400'>you</span>
  <span m='104460'>just</span> <span m='104610'>stored</span> <span m='104860'>a</span>
  <span m='104940'>suffix</span> <span m='105330'>array</span> <span m='106020'>as</span>
  <span m='106170'>a</span> <span m='106200'>bunch</span> <span m='106440'>of</span>
  <span m='106530'>numbers.</span> </p><p><span m='107850'>First</span> <span m='108120'>we'll</span>
  <span m='108690'>add</span> <span m='108930'>another</span> <span m='109200'>log,</span>
  <span m='109620'>then</span> <span m='109770'>we'll</span> <span m='109890'>get</span>
  <span m='110040'>down</span> <span m='110250'>to</span> <span m='110370'>linear.</span>
  <span m='111600'>That</span> <span m='112170'>gives</span> <span m='112350'>us</span>
  <span m='112500'>a</span> <span m='112560'>compact</span> <span m='113340'>suffix</span>
  <span m='113880'>tree,</span> <span m='114550'>or</span> <span m='114650'>sorry,</span>
  <span m='114810'>suffix</span> <span m='115200'>array.</span> <span m='116230'>That's</span>
  <span m='116520'>also</span> <span m='116790'>knowing</span> <span m='116970'>how</span>
  <span m='117060'>to</span> <span m='117180'>do</span> <span m='117460'>succinct</span>
  <span m='117750'>suffix</span> <span m='118500'>arrays.</span> </p><p><span m='119490'>But</span>
  <span m='120840'>there</span> <span m='121110'>are</span> <span m='121200'>dozens</span>
  <span m='121770'>of</span> <span m='121830'>papers</span> <span m='122280'>on</span>
  <span m='122400'>this</span> <span m='122550'>topic,</span> <span m='122970'>it's</span>
  <span m='123090'>kind</span> <span m='123270'>of</span> <span m='123390'>a</span>
  <span m='123450'>big</span> <span m='123690'>field</span> <span m='124050'>all</span>
  <span m='124230'>to</span> <span m='124380'>itself.</span> <span m='125970'>And</span>
  <span m='126240'>a</span> <span m='126300'>lot</span> <span m='126510'>of</span>
  <span m='127460'>the</span> <span m='127590'>techniques</span> <span m='127980'>are</span>
  <span m='128070'>pretty</span> <span m='128490'>complicated.</span> <span m='129210'>So</span>
  <span m='129509'>I'm</span> <span m='129610'>going</span> <span m='129660'>try</span>
  <span m='129870'>to</span> <span m='129960'>keep</span> <span m='130229'>it</span>
  <span m='130470'>to</span> <span m='131280'>the</span> <span m='131340'>bare</span>
  <span m='131580'>minimum</span> <span m='132000'>we</span> <span m='132180'>can</span>
  <span m='132390'>do,</span> <span m='133140'>that</span> <span m='133290'>will</span>
  <span m='133830'>give</span> <span m='134040'>us</span> <span m='134230'>linear--</span>
  <span m='135222'>linear</span> <span m='135720'>number,</span> <span m='135990'>bits</span>
  <span m='136200'>of</span> <span m='136260'>space</span> <span m='136620'>give</span>
  <span m='136770'>us</span> <span m='136920'>a</span> <span m='136980'>compact</span>
  <span m='137460'>data</span> <span m='137670'>structure.</span> </p><p><span m='138720'>But</span>
  <span m='139230'>before</span> <span m='139680'>we</span> <span m='140220'>go</span>
  <span m='140400'>to</span> <span m='140520'>those</span> <span m='140700'>data</span>
  <span m='140910'>structures,</span> <span m='141390'>I</span> <span m='141450'>want</span>
  <span m='141600'>to</span> <span m='141690'>give</span> <span m='141840'>you</span>
  <span m='141930'>a</span> <span m='141960'>little</span> <span m='142230'>survey</span>
  <span m='142890'>of</span> <span m='143160'>what's</span> <span m='143400'>known.</span>
  <span m='146680'>So</span> <span m='146970'>compact</span> <span m='148950'>suffix</span>
  <span m='149460'>arrays,</span> <span m='149820'>and</span> <span m='149940'>trees,</span>
  <span m='153900'>start</span> <span m='154290'>out</span> <span m='154410'>with--</span>
  <span m='155040'>I'm</span> <span m='155100'>going</span> <span m='155220'>to</span>
  <span m='155280'>start</span> <span m='155490'>out</span> <span m='155550'>with</span>
  <span m='155700'>the</span> <span m='155820'>original</span> <span m='156240'>results.</span>
  <span m='156630'>And</span> <span m='156750'>then</span> <span m='156900'>I'll</span>
  <span m='157020'>jump</span> <span m='157290'>to</span> <span m='157410'>sort</span>
  <span m='157620'>of</span> <span m='157710'>the</span> <span m='157800'>latest</span>
  <span m='158160'>results,</span> <span m='158580'>which</span> <span m='158790'>are</span>
  <span m='158910'>getting</span> <span m='159600'>things</span> <span m='159870'>to</span>
  <span m='159990'>be</span> <span m='160200'>succinct.</span> </p><p><span m='163810'>So</span>
  <span m='164010'>the</span> <span m='164160'>first</span> <span m='164550'>result</span>
  <span m='165060'>on</span> <span m='165280'>this</span> <span m='166650'>topic</span>
  <span m='167070'>that</span> <span m='167190'>got</span> <span m='167580'>a</span>
  <span m='167640'>compact</span> <span m='168240'>suffix</span> <span m='168660'>array,</span>
  <span m='169620'>is</span> <span m='169800'>by</span> <span m='170070'>Grossi</span>
  <span m='170550'>and</span> <span m='170670'>Vitter.</span> <span m='172620'>This</span>
  <span m='172740'>was</span> <span m='172850'>in</span> <span m='172980'>2000,</span>
  <span m='173950'>spring</span> <span m='174330'>of</span> <span m='174450'>2000.</span>
  <span m='175710'>And</span> <span m='175980'>let</span> <span m='176100'>me</span>
  <span m='176280'>tell</span> <span m='176460'>you</span> <span m='176610'>the</span>
  <span m='176730'>bounds</span> <span m='177240'>that</span> <span m='177630'>they</span>
  <span m='177900'>achieve.</span> <span m='178530'>This</span> <span m='178710'>is</span>
  <span m='178770'>actually</span> <span m='179070'>the</span> <span m='180000'>solution</span>
  <span m='180480'>that</span> <span m='180570'>we're</span> <span m='180750'>going</span>
  <span m='181020'>to</span> <span m='181170'>look</span> <span m='181410'>at.</span>
  </p><p><span m='206340'>So</span> <span m='206630'>this</span> <span m='206960'>is</span>
  <span m='207230'>the</span> <span m='207560'>first</span> <span m='208100'>space</span>
  <span m='208510'>bound.</span> <span m='211670'>I</span> <span m='211700'>guess</span>
  <span m='212180'>the</span> <span m='212540'>big</span> <span m='212750'>term</span>
  <span m='213020'>here</span> <span m='213170'>is</span> <span m='213360'>T</span>
  <span m='213680'>log</span> <span m='214010'>sigma.</span> <span m='215000'>That's</span>
  <span m='215240'>how</span> <span m='215390'>many</span> <span m='215600'>bits</span>
  <span m='215810'>it</span> <span m='215900'>takes</span> <span m='216200'>just</span>
  <span m='216410'>to</span> <span m='216530'>write</span> <span m='216710'>down</span>
  <span m='216890'>the</span> <span m='217010'>text.</span> <span m='218030'>So</span>
  <span m='218180'>this</span> <span m='218360'>is</span> <span m='218480'>what</span>
  <span m='218630'>you</span> <span m='218870'>might</span> <span m='219050'>call</span>
  <span m='219290'>optimal,</span> <span m='220760'>in</span> <span m='220850'>this</span>
  <span m='221030'>world.</span> <span m='221580'>I</span> <span m='221680'>mean,</span>
  <span m='221780'>if</span> <span m='221825'>you</span> <span m='221870'>have</span>
  <span m='222050'>random</span> <span m='222410'>text,</span> <span m='222860'>you</span>
  <span m='222980'>need</span> <span m='223130'>that</span> <span m='223310'>many</span>
  <span m='223520'>bits</span> <span m='223730'>to</span> <span m='223820'>write</span>
  <span m='223970'>it</span> <span m='224030'>down.</span> </p><p><span m='224720'>So</span>
  <span m='224840'>there's</span> <span m='225020'>1</span> <span m='225320'>times</span>
  <span m='225620'>that.</span> <span m='226610'>We're</span> <span m='226820'>also</span>
  <span m='227060'>going</span> <span m='227180'>to</span> <span m='227240'>have</span>
  <span m='227390'>this</span> <span m='227540'>1</span> <span m='227750'>over</span>
  <span m='227930'>epsilon</span> <span m='228410'>times</span> <span m='228740'>that.</span>
  <span m='229040'>And</span> <span m='229220'>this</span> <span m='229700'>is</span>
  <span m='229820'>actually</span> <span m='230090'>the</span> <span m='230210'>data</span>
  <span m='230420'>structure.</span> <span m='230750'>It's</span> <span m='230840'>going</span>
  <span m='230960'>to</span> <span m='231020'>store</span> <span m='231260'>the</span>
  <span m='231380'>text,</span> <span m='231770'>and</span> <span m='231890'>then</span>
  <span m='231980'>it's</span> <span m='232100'>going</span> <span m='232220'>to</span>
  <span m='232280'>add</span> <span m='232490'>on</span> <span m='232640'>a</span>
  <span m='232670'>data</span> <span m='232880'>structure</span> <span m='233770'>of</span>
  <span m='234020'>1</span> <span m='234090'>over</span> <span m='234200'>epsilon</span>
  <span m='234680'>times</span> <span m='235010'>that.</span> </p><p><span m='235730'>So</span>
  <span m='236285'>it's</span> <span m='236600'>order--</span> <span m='237710'>order</span>
  <span m='237980'>[? ops. ?]</span> <span m='239330'>There's</span> <span m='239510'>some</span>
  <span m='239690'>lower-order</span> <span m='240110'>terms.</span> <span m='241640'>We</span>
  <span m='241890'>won't</span> <span m='242060'>actually</span> <span m='242330'>have</span>
  <span m='242480'>this</span> <span m='242600'>lower-order</span> <span m='242990'>term,</span>
  <span m='243200'>because</span> <span m='243350'>I'm</span> <span m='243440'>going</span>
  <span m='243560'>to</span> <span m='243620'>focus</span> <span m='244010'>on</span>
  <span m='245150'>binary</span> <span m='245600'>alphabet</span> <span m='246290'>here.</span>
  <span m='246860'>Keep</span> <span m='247070'>it</span> <span m='247160'>simple.</span>
  <span m='248000'>But</span> <span m='248180'>if</span> <span m='248270'>you</span>
  <span m='248360'>have</span> <span m='248480'>a</span> <span m='248540'>non-binary</span>
  <span m='249050'>alphabet,</span> <span m='249470'>they</span> <span m='249590'>have</span>
  <span m='249770'>another</span> <span m='250610'>order</span> <span m='250850'>T</span>
  <span m='251017'>bits,</span> <span m='251520'>and</span> <span m='251900'>so</span>
  <span m='252080'>on.</span> </p><p><span m='252410'>But</span> <span m='252950'>you</span>
  <span m='253070'>get</span> <span m='253220'>to</span> <span m='253340'>control</span>
  <span m='253700'>this</span> <span m='253850'>constant.</span> <span m='254210'>This</span>
  <span m='254390'>will</span> <span m='254510'>work</span> <span m='254660'>for</span>
  <span m='254810'>any</span> <span m='255020'>epsilon</span> <span m='256010'>between</span>
  <span m='256399'>0</span> <span m='256640'>and</span> <span m='256760'>1.</span>
  <span m='259850'>And</span> <span m='260000'>why</span> <span m='260810'>are</span>
  <span m='260884'>you</span> <span m='260959'>interested</span> <span m='261350'>in</span>
  <span m='261589'>a</span> <span m='261800'>small</span> <span m='262340'>epsilon?</span>
  <span m='262910'>Because</span> <span m='263360'>if</span> <span m='263660'>epsilon</span>
  <span m='264050'>is</span> <span m='264110'>small,</span> <span m='264500'>this</span>
  <span m='264650'>space</span> <span m='264890'>bound</span> <span m='265130'>goes</span>
  <span m='265370'>up.</span> <span m='267060'>Well,</span> <span m='267290'>that</span>
  <span m='267500'>happens</span> <span m='267920'>in</span> <span m='268070'>the</span>
  <span m='268160'>query</span> <span m='268840'>bound.</span> </p><p><span m='288380'>So</span>
  <span m='289050'>in</span> <span m='289250'>the</span> <span m='289340'>query</span>
  <span m='289670'>bound,</span> <span m='289970'>there's</span> <span m='290160'>this</span>
  <span m='290450'>multiplicative</span> <span m='291320'>log</span> <span m='291590'>to</span>
  <span m='291860'>the</span> <span m='292010'>epsilon</span> <span m='292460'>of</span>
  <span m='292580'>T.</span> <span m='293180'>So</span> <span m='293330'>if</span>
  <span m='293450'>you</span> <span m='293570'>really</span> <span m='293810'>want</span>
  <span m='294020'>queries</span> <span m='294380'>to</span> <span m='294470'>go</span>
  <span m='294590'>fast,</span> <span m='295130'>you</span> <span m='295190'>don't</span>
  <span m='295370'>want</span> <span m='295520'>to</span> <span m='295580'>pay</span>
  <span m='295730'>a</span> <span m='295790'>big</span> <span m='296570'>polylog</span>
  <span m='297110'>here,</span> <span m='297290'>then</span> <span m='297440'>you're</span>
  <span m='297560'>going</span> <span m='297680'>to</span> <span m='297740'>have</span>
  <span m='297830'>to</span> <span m='297950'>pay</span> <span m='298130'>for</span>
  <span m='298310'>it</span> <span m='298370'>in</span> <span m='298460'>space.</span>
  <span m='299490'>So</span> <span m='299540'>those</span> <span m='299870'>are</span>
  <span m='299960'>the</span> <span m='300080'>same</span> <span m='300320'>epsilons.</span>
  </p><p><span m='305150'>In</span> <span m='306150'>the</span> <span m='306290'>Grossi-Vitter</span>
  <span m='306860'>paper,</span> <span m='307280'>they</span> <span m='307460'>only</span>
  <span m='308120'>multiply</span> <span m='308510'>this</span> <span m='308690'>by</span>
  <span m='308840'>the</span> <span m='308960'>size</span> <span m='309260'>of</span>
  <span m='309320'>the</span> <span m='309470'>output.</span> <span m='309920'>So</span>
  <span m='310030'>if</span> <span m='310130'>you</span> <span m='310220'>want</span>
  <span m='310340'>to</span> <span m='310400'>just</span> <span m='310560'>output</span>
  <span m='310880'>one</span> <span m='311120'>guy,</span> <span m='311870'>you</span>
  <span m='311960'>only</span> <span m='312140'>pay</span> <span m='312290'>an</span>
  <span m='312380'>additive</span> <span m='312740'>log</span> <span m='312825'>to</span>
  <span m='312910'>the</span> <span m='313050'>epsilon.</span> <span m='313430'>If</span>
  <span m='313520'>you</span> <span m='313580'>want</span> <span m='313730'>to</span>
  <span m='313880'>output</span> <span m='314090'>all</span> <span m='314300'>the</span>
  <span m='314390'>matches</span> <span m='314900'>you</span> <span m='314960'>have</span>
  <span m='315050'>to</span> <span m='315140'>pay</span> <span m='315360'>a</span>
  <span m='315380'>number</span> <span m='315660'>of</span> <span m='315720'>matches</span>
  <span m='316100'>times</span> <span m='316330'>log</span> <span m='316530'>to</span>
  <span m='316585'>the</span> <span m='316640'>epsilon.</span> </p><p><span m='317690'>They</span>
  <span m='317840'>achieve</span> <span m='318740'>the</span> <span m='318920'>P</span>
  <span m='319190'>bound.</span> <span m='320330'>In</span> <span m='320390'>fact,</span>
  <span m='320570'>they</span> <span m='320690'>do</span> <span m='320810'>a</span>
  <span m='320840'>little</span> <span m='321050'>bit</span> <span m='321170'>better</span>
  <span m='321410'>than</span> <span m='321560'>order</span> <span m='321830'>P</span>
  <span m='322010'>query.</span> <span m='323050'>On</span> <span m='323210'>a</span>
  <span m='323260'>RAM,</span> <span m='323720'>you</span> <span m='324800'>can</span>
  <span m='324920'>hope</span> <span m='325130'>to</span> <span m='325250'>do--</span>
  <span m='326150'>save</span> <span m='326450'>a</span> <span m='326510'>log</span>
  <span m='326780'>factor</span> <span m='327470'>by</span> <span m='327650'>reading</span>
  <span m='329000'>log</span> <span m='329230'>base</span> <span m='329460'>sigma</span>
  <span m='329880'>of</span> <span m='329990'>T,</span> <span m='331630'>of</span>
  <span m='331880'>the</span> <span m='332030'>letters</span> <span m='333170'>in</span>
  <span m='333410'>one</span> <span m='333770'>word</span> <span m='334010'>operation.</span>
  </p><p><span m='334950'>So</span> <span m='334990'>I'm</span> <span m='335270'>not</span>
  <span m='335420'>going</span> <span m='335570'>to</span> <span m='335630'>go</span>
  <span m='335750'>into</span> <span m='335930'>how</span> <span m='336080'>to</span>
  <span m='336170'>do</span> <span m='336320'>this--</span> <span m='336900'>I'm</span>
  <span m='337070'>going</span> <span m='337220'>to</span> <span m='337280'>cover</span>
  <span m='337610'>this</span> <span m='337790'>paper</span> <span m='338840'>today,</span>
  <span m='339230'>or</span> <span m='340460'>a</span> <span m='340550'>simplification</span>
  <span m='341270'>of</span> <span m='341360'>this</span> <span m='341480'>paper.</span>
  <span m='341840'>You</span> <span m='341930'>might</span> <span m='342110'>say,</span>
  <span m='342920'>throw</span> <span m='343260'>away.</span> <span m='343560'>I'm</span>
  <span m='343670'>going</span> <span m='343790'>to</span> <span m='343850'>get</span>
  <span m='344070'>a</span> <span m='344110'>slightly</span> <span m='344540'>worse</span>
  <span m='344810'>bounds</span> <span m='345200'>than</span> <span m='345320'>this.</span>
  </p><p><span m='346250'>Space</span> <span m='346550'>bound</span> <span m='346730'>will</span>
  <span m='346820'>be</span> <span m='346910'>the</span> <span m='347030'>same,</span>
  <span m='349670'>but</span> <span m='349910'>I'm</span> <span m='350030'>not</span>
  <span m='350180'>going</span> <span m='350300'>to--</span> <span m='351170'>I'm</span>
  <span m='351280'>not</span> <span m='351440'>going</span> <span m='351560'>to</span>
  <span m='351620'>worry</span> <span m='351800'>about</span> <span m='352010'>this</span>
  <span m='352160'>log</span> <span m='352430'>factor.</span> <span m='353300'>And</span>
  <span m='353450'>in</span> <span m='353510'>fact,</span> <span m='354020'>both</span>
  <span m='354350'>P</span> <span m='354710'>and</span> <span m='355010'>output</span>
  <span m='355400'>are</span> <span m='355490'>going</span> <span m='355610'>to</span>
  <span m='355700'>be</span> <span m='355820'>multiplied</span> <span m='356300'>by</span>
  <span m='357470'>log</span> <span m='357740'>to</span> <span m='357830'>the</span>
  <span m='357950'>epsilon.</span> <span m='359540'>So</span> <span m='359750'>I</span>
  <span m='359810'>won't</span> <span m='360090'>achieve</span> <span m='360420'>quite</span>
  <span m='360740'>the</span> <span m='360830'>best</span> <span m='361100'>query</span>
  <span m='361380'>bound,</span> <span m='361700'>but</span> <span m='362120'>same</span>
  <span m='362390'>space</span> <span m='362690'>bound,</span> <span m='362930'>just</span>
  <span m='363050'>to</span> <span m='363140'>give</span> <span m='363320'>you</span>
  <span m='363590'>an</span> <span m='363680'>idea</span> <span m='363920'>of</span>
  <span m='364010'>how</span> <span m='364130'>it</span> <span m='364220'>works.</span>
  </p><p><span m='366800'>The</span> <span m='366950'>next</span> <span m='367250'>result--</span>
  <span m='368190'>yeah,</span> <span m='368250'>I'll</span> <span m='368510'>go</span>
  <span m='368690'>to</span> <span m='370690'>another</span> <span m='370790'>board.</span>
  <span m='372170'>These</span> <span m='372320'>bounds</span> <span m='372650'>are</span>
  <span m='373100'>a</span> <span m='373160'>bit</span> <span m='373370'>big,</span>
  <span m='373830'>as</span> <span m='373990'>you</span> <span m='374100'>see.</span>
  <span m='377090'>The</span> <span m='377150'>next</span> <span m='377360'>result,</span>
  <span m='377600'>which</span> <span m='377780'>was</span> <span m='377960'>done</span>
  <span m='378170'>later</span> <span m='378620'>in</span> <span m='378800'>the</span>
  <span m='378920'>same</span> <span m='379340'>year.</span> <span m='379860'>So</span>
  <span m='379970'>these</span> <span m='380150'>are</span> <span m='380240'>probably</span>
  <span m='381350'>discovered,</span> <span m='381830'>basically</span> <span m='382250'>at</span>
  <span m='382550'>the</span> <span m='382640'>same</span> <span m='382940'>time.</span>
  <span m='385690'>Because</span> <span m='386150'>writing</span> <span m='386450'>a</span>
  <span m='386510'>paper</span> <span m='386840'>takes</span> <span m='388190'>probably</span>
  <span m='388580'>a</span> <span m='388640'>year</span> <span m='388940'>or</span>
  <span m='389000'>so.</span> </p><p><span m='389840'>So</span> <span m='389990'>they</span>
  <span m='390110'>were</span> <span m='390230'>being</span> <span m='390440'>done</span>
  <span m='390620'>in</span> <span m='390770'>parallel,</span> <span m='391550'>and</span>
  <span m='391670'>then</span> <span m='392120'>this</span> <span m='392300'>was</span>
  <span m='392390'>published</span> <span m='392810'>in</span> <span m='392930'>the</span>
  <span m='393260'>spring</span> <span m='393710'>of</span> <span m='393800'>2000.</span>
  <span m='394260'>This</span> <span m='394395'>was</span> <span m='394530'>published</span>
  <span m='394880'>in</span> <span m='394970'>the</span> <span m='395060'>fall</span>
  <span m='395330'>of</span> <span m='395420'>2000.</span> <span m='396920'>It's</span>
  <span m='397100'>called</span> <span m='397310'>the</span> <span m='397460'>FM-index.</span>
  <span m='400640'>And</span> <span m='401120'>it</span> <span m='401300'>achieves</span>
  <span m='403250'>this</span> <span m='403490'>bound,</span> <span m='403980'>which</span>
  <span m='404060'>is</span> <span m='404180'>going</span> <span m='404300'>to</span>
  <span m='404390'>take</span> <span m='404630'>a</span> <span m='404690'>little</span>
  <span m='404900'>while</span> <span m='405140'>to</span> <span m='405260'>explain.</span>
  </p><p><span m='429270'>OK.</span> <span m='431450'>Think</span> <span m='431660'>of</span>
  <span m='431780'>this</span> <span m='431990'>right</span> <span m='432260'>now,</span>
  <span m='432680'>as</span> <span m='432890'>this</span> <span m='433190'>is</span>
  <span m='433640'>T log</span> <span m='434120'>sigma.</span> <span m='436160'>Ignore</span>
  <span m='437390'>this</span> <span m='437780'>H.</span> <span m='438050'>This</span>
  <span m='438230'>is</span> <span m='438650'>entropy</span> <span m='439160'>stuff.</span>
  <span m='440360'>But</span> <span m='440540'>if</span> <span m='440630'>you</span>
  <span m='440690'>think</span> <span m='440840'>of</span> <span m='440930'>this</span>
  <span m='441110'>as</span> <span m='441200'>T</span> <span m='441380'>log</span>
  <span m='441590'>sigma,</span> <span m='441920'>we're</span> <span m='442040'>getting</span>
  <span m='442280'>5</span> <span m='442880'>times</span> <span m='443180'>T</span>
  <span m='443290'>log</span> <span m='443540'>sigma,</span> <span m='444470'>plus</span>
  <span m='445400'>some</span> <span m='446040'>lower-order</span> <span m='446540'>term.</span>
  <span m='447800'>So</span> <span m='448520'>it's</span> <span m='448610'>a</span>
  <span m='448670'>little</span> <span m='448910'>less</span> <span m='449090'>flexible</span>
  <span m='449630'>over</span> <span m='449840'>here.</span> </p><p><span m='450050'>We</span>
  <span m='450140'>kind</span> <span m='450320'>of</span> <span m='450410'>got</span>
  <span m='450560'>to</span> <span m='450680'>control</span> <span m='451040'>the</span>
  <span m='451130'>constant.</span> <span m='451670'>Anything</span> <span m='452870'>greater</span>
  <span m='453130'>or</span> <span m='453180'>equal</span> <span m='453390'>to</span>
  <span m='453490'>2</span> <span m='453800'>would</span> <span m='453950'>be</span>
  <span m='454170'>all</span> <span m='454550'>right.</span> <span m='455600'>Over</span>
  <span m='455840'>here,</span> <span m='456390'>it's</span> <span m='456570'>always</span>
  <span m='456770'>at</span> <span m='456860'>least</span> <span m='457070'>5.</span>
  <span m='457580'>This</span> <span m='457760'>has</span> <span m='457850'>since</span>
  <span m='458120'>been</span> <span m='458270'>improved.</span> <span m='459170'>I'm</span>
  <span m='459230'>just</span> <span m='459380'>telling</span> <span m='459620'>you</span>
  <span m='459740'>the</span> <span m='459830'>historical--</span> <span m='461750'>these</span>
  <span m='461930'>days</span> <span m='462140'>people</span> <span m='462410'>can</span>
  <span m='462830'>get</span> <span m='463010'>down</span> <span m='463220'>to</span>
  <span m='463310'>at</span> <span m='463370'>least</span> <span m='463700'>4</span>
  <span m='464180'>or</span> <span m='464290'>so.</span> <span m='465410'>Actually,</span>
  <span m='465830'>get</span> <span m='465980'>down</span> <span m='466100'>to</span>
  <span m='466200'>1.</span> <span m='466470'>We'll</span> <span m='466720'>talk</span>
  <span m='466970'>about</span> <span m='467220'>it</span> <span m='467256'>in</span>
  <span m='467292'>a</span> <span m='467330'>moment.</span> </p><p><span m='469730'>Before</span>
  <span m='470030'>I</span> <span m='470090'>get</span> <span m='470210'>to</span>
  <span m='470300'>the</span> <span m='470420'>Hk</span> <span m='470900'>part,</span>
  <span m='471170'>I</span> <span m='471230'>want</span> <span m='471380'>to</span>
  <span m='471440'>talk</span> <span m='471650'>about</span> <span m='471860'>the</span>
  <span m='471950'>lower-order</span> <span m='472430'>term.</span> <span m='473180'>There's</span>
  <span m='473360'>some</span> <span m='474260'>scary</span> <span m='474560'>parts</span>
  <span m='474890'>like</span> <span m='475070'>this.</span> <span m='475340'>If</span>
  <span m='475540'>sigma</span> <span m='476000'>is</span> <span m='476150'>that</span>
  <span m='476270'>at</span> <span m='476360'>all</span> <span m='476450'>large,</span>
  <span m='476960'>this</span> <span m='477170'>is</span> <span m='477350'>big</span>
  <span m='477560'>trouble.</span> <span m='478430'>Or even</span> <span m='478700'>sigma</span>
  <span m='479180'>log n--</span> <span m='480320'>this</span> <span m='480560'>is</span>
  <span m='480930'>a</span> <span m='481700'>super</span> <span m='482000'>polynomial.</span>
  <span m='483110'>So</span> <span m='483320'>this</span> <span m='483470'>cannot</span>
  <span m='483980'>handle</span> <span m='484310'>very</span> <span m='484490'>large</span>
  <span m='484730'>sigma,</span> <span m='485960'>whereas</span> <span m='486260'>this</span>
  <span m='486360'>solution</span> <span m='486890'>can.</span> <span m='487580'>And</span>
  <span m='487760'>other</span> <span m='488270'>structures</span> <span m='488690'>can,</span>
  <span m='489000'>but</span> <span m='489080'>this</span> <span m='489320'>is</span>
  <span m='489410'>an</span> <span m='489500'>early</span> <span m='489800'>result.</span>
  </p><p><span m='491930'>This</span> <span m='492320'>also</span> <span m='492830'>gets</span>
  <span m='493100'>bad</span> <span m='493370'>when</span> <span m='493520'>sigma's</span>
  <span m='493910'>very</span> <span m='494090'>large.</span> <span m='494990'>Even</span>
  <span m='495260'>bigger--</span> <span m='495830'>when</span> <span m='496140'>sigma's</span>
  <span m='496280'>bigger</span> <span m='496490'>than</span> <span m='496670'>log</span>
  <span m='496910'>log</span> <span m='497160'>T,</span> <span m='497540'>then</span>
  <span m='498530'>this</span> <span m='498740'>starts</span> <span m='499010'>to</span>
  <span m='499070'>dominate.</span> <span m='500660'>OK,</span> <span m='500840'>but</span>
  <span m='500960'>for</span> <span m='501110'>sigma</span> <span m='501440'>small,</span>
  <span m='501780'>think</span> <span m='502010'>binary</span> <span m='502400'>alphabets,</span>
  <span m='502880'>whatever.</span> <span m='503780'>This</span> <span m='503960'>is</span>
  <span m='504050'>good,</span> <span m='504380'>and</span> <span m='504560'>in</span>
  <span m='504650'>many</span> <span m='504890'>ways</span> <span m='505130'>is</span>
  <span m='505250'>actually</span> <span m='505520'>better</span> <span m='505820'>than</span>
  <span m='505970'>T</span> <span m='506180'>log</span> <span m='506390'>sigma.</span>
  </p><p><span m='506750'>So</span> <span m='506900'>let</span> <span m='507020'>me</span>
  <span m='507140'>tell</span> <span m='507290'>you</span> <span m='507380'>about</span>
  <span m='507560'>this</span> <span m='508440'>Hk of</span> <span m='508880'>T</span>
  <span m='509310'>thing.</span> <span m='511750'>This</span> <span m='512030'>is</span>
  <span m='512150'>what's</span> <span m='512360'>called</span> <span m='512929'>k-th</span>
  <span m='513289'>order</span> <span m='514200'>empirical</span> <span m='514730'>entropy.</span>
  <span m='525770'>Maybe</span> <span m='526010'>I</span> <span m='526070'>should</span>
  <span m='526250'>start</span> <span m='526700'>with</span> <span m='527000'>an</span>
  <span m='527090'>aside</span> <span m='528010'>of</span> <span m='528220'>0-th</span>
  <span m='528560'>order</span> <span m='528800'>entropy,</span> <span m='529685'>because</span>
  <span m='529970'>we</span> <span m='530060'>haven't</span> <span m='530270'>talked</span>
  <span m='530630'>about--</span> <span m='531020'>I</span> <span m='531170'>guess</span>
  <span m='531350'>we</span> <span m='531440'>talked</span> <span m='531680'>about</span>
  <span m='531860'>entropy</span> <span m='532220'>in</span> <span m='532310'>the</span>
  <span m='532400'>context</span> <span m='532760'>of</span> <span m='532820'>binary</span>
  <span m='533180'>search</span> <span m='533450'>trees.</span> </p><p><span m='533780'>We</span>
  <span m='533870'>said,</span> <span m='534170'>oh,</span> <span m='534470'>if</span>
  <span m='534560'>you've</span> <span m='534740'>got--</span> <span m='535820'>if</span>
  <span m='536150'>you</span> <span m='536360'>access</span> <span m='536780'>item</span>
  <span m='537080'>i</span> <span m='537340'>with</span> <span m='537560'>probability</span>
  <span m='538110'>P i,</span> <span m='539300'>then</span> <span m='539480'>there's</span>
  <span m='539660'>this</span> <span m='539810'>entropy</span> <span m='540230'>bound,</span>
  <span m='540720'>which</span> <span m='540850'>is</span> <span m='541180'>sum</span>
  <span m='542140'>of</span> <span m='542480'>P</span> <span m='544170'>log</span>
  <span m='545420'>1/P.</span> <span m='547450'>So</span> <span m='547640'>I</span>
  <span m='547700'>don't</span> <span m='547790'>know,</span> <span m='547940'>let's</span>
  <span m='548120'>call</span> <span m='548300'>this</span> <span m='549020'>character</span>
  <span m='549380'>x.</span> </p><p><span m='551630'>So</span> <span m='552020'>if</span>
  <span m='552260'>you--</span> <span m='556600'>let's</span> <span m='557090'>see,</span>
  <span m='560072'>you</span> <span m='560296'>have</span> <span m='560520'>H0</span>
  <span m='561110'>substring</span> <span m='561800'>s.</span> <span m='563420'>You</span>
  <span m='564500'>sum</span> <span m='565030'>over</span> <span m='565410'>all</span>
  <span m='566930'>characters</span> <span m='567590'>in</span> <span m='567710'>the</span>
  <span m='567890'>alphabet,</span> <span m='570030'>of</span> <span m='570620'>the</span>
  <span m='570740'>probability--</span> <span m='571760'>this</span> <span m='571940'>is</span>
  <span m='572030'>not</span> <span m='572240'>really</span> <span m='572600'>a</span>
  <span m='572660'>probability.</span> <span m='573380'>This</span> <span m='573590'>is</span>
  <span m='573710'>going</span> <span m='573860'>to</span> <span m='573920'>be</span>
  <span m='574670'>the</span> <span m='574790'>number</span> <span m='575280'>of</span>
  <span m='575850'>x's</span> <span m='577070'>in</span> <span m='577790'>s,</span>
  <span m='579920'>divided</span> <span m='580490'>by</span> <span m='580760'>the</span>
  <span m='580880'>length</span> <span m='581180'>of</span> <span m='581250'>s.</span>
  <span m='581900'>This</span> <span m='581975'>is</span> <span m='582050'>what's</span>
  <span m='582260'>called</span> <span m='582500'>empirical</span> <span m='583070'>probability.</span>
  <span m='583810'>It's</span> <span m='583910'>what</span> <span m='584060'>you</span>
  <span m='584420'>observe</span> <span m='584900'>from</span> <span m='585110'>this</span>
  <span m='585260'>string.</span> </p><p><span m='586320'>There's</span> <span m='586460'>this</span>
  <span m='586730'>many</span> <span m='587000'>occurrences</span> <span m='587510'>in</span>
  <span m='587630'>the</span> <span m='587720'>string.</span> <span m='588000'>You</span>
  <span m='588110'>divide</span> <span m='588560'>by</span> <span m='588650'>the</span>
  <span m='588740'>length</span> <span m='588830'>of</span> <span m='588860'>the</span>
  <span m='588890'>string.</span> <span m='589220'>That's</span> <span m='589400'>kind</span>
  <span m='589670'>of</span> <span m='589760'>like</span> <span m='589910'>a</span>
  <span m='589970'>probability.</span> <span m='590660'>It's</span> <span m='591050'>scaled</span>
  <span m='591460'>to</span> <span m='591590'>be</span> <span m='591680'>like</span>
  <span m='591785'>a</span> <span m='591890'>probability.</span> <span m='592390'>It's</span>
  <span m='592510'>between</span> <span m='592790'>0</span> <span m='592970'>and</span>
  <span m='593060'>1.</span> <span m='593760'>And if</span> <span m='593870'>you</span>
  <span m='593960'>take</span> <span m='594230'>sum</span> <span m='594590'>of</span>
  <span m='594770'>P</span> <span m='594920'>log</span> <span m='595160'>1/P,</span>
  <span m='596300'>that</span> <span m='596480'>gives</span> <span m='596690'>you</span>
  <span m='596810'>a</span> <span m='596900'>bound.</span> </p><p><span m='597410'>And</span>
  <span m='597650'>this</span> <span m='597890'>is</span> <span m='598590'>the</span>
  <span m='598930'>bound</span> <span m='599330'>achieved</span> <span m='599750'>by</span>
  <span m='599980'>say,</span> <span m='600230'>Huffman</span> <span m='600650'>coding,</span>
  <span m='601950'>or</span> <span m='602290'>the</span> <span m='602450'>optimal</span>
  <span m='603350'>code.</span> <span m='604610'>If</span> <span m='604820'>all</span>
  <span m='604970'>you're</span> <span m='605120'>allowed</span> <span m='605330'>to</span>
  <span m='605420'>do</span> <span m='605570'>is</span> <span m='605720'>give</span>
  <span m='605930'>a</span> <span m='605990'>code</span> <span m='606290'>word</span>
  <span m='606500'>for</span> <span m='606650'>each</span> <span m='607190'>letter</span>
  <span m='607460'>of</span> <span m='607550'>the</span> <span m='607670'>alphabet,</span>
  <span m='608300'>and</span> <span m='608420'>then</span> <span m='608570'>you</span>
  <span m='608660'>write</span> <span m='608900'>down</span> <span m='609430'>a</span>
  <span m='609500'>binary</span> <span m='609950'>code</span> <span m='610160'>word</span>
  <span m='610370'>for</span> <span m='610490'>each</span> <span m='610640'>letter</span>
  <span m='610820'>of</span> <span m='610880'>the</span> <span m='610970'>alphabet.</span>
  <span m='611750'>And</span> <span m='611870'>you</span> <span m='611960'>write</span>
  <span m='612170'>that</span> <span m='612350'>down</span> <span m='612590'>for</span>
  <span m='612740'>each</span> <span m='612890'>letter</span> <span m='613550'>in</span>
  <span m='613700'>s,</span> <span m='614090'>then</span> <span m='614270'>you</span>
  <span m='614360'>achieve--</span> <span m='614870'>I</span> <span m='614930'>guess</span>
  <span m='615110'>Huffman</span> <span m='615350'>codes</span> <span m='615590'>achieve</span>
  <span m='615860'>ceiling</span> <span m='616280'>of</span> <span m='616370'>this.</span>
  </p><p><span m='617480'>If</span> <span m='617660'>you</span> <span m='617780'>want</span>
  <span m='617960'>to</span> <span m='618320'>achieve</span> <span m='618620'>exactly</span>
  <span m='619040'>that</span> <span m='619250'>bound,</span> <span m='619610'>you</span>
  <span m='619760'>can</span> <span m='620120'>use</span> <span m='620450'>arithmetic</span>
  <span m='621020'>coding,</span> <span m='621620'>but</span> <span m='623180'>we're</span>
  <span m='623300'>not</span> <span m='623660'>going</span> <span m='623810'>to</span>
  <span m='623900'>get</span> <span m='624050'>into</span> <span m='624290'>those</span>
  <span m='624680'>kinds</span> <span m='624950'>of</span> <span m='625010'>details.</span>
  <span m='625850'>So</span> <span m='626720'>if</span> <span m='626960'>you</span>
  <span m='627110'>used</span> <span m='628130'>what's</span> <span m='628550'>called</span>
  <span m='628840'>a</span> <span m='628880'>0-th</span> <span m='629270'>order</span>
  <span m='629510'>code,</span> <span m='630110'>where</span> <span m='630410'>you</span>
  <span m='630560'>just</span> <span m='630740'>have</span> <span m='631210'>a</span>
  <span m='631250'>code</span> <span m='631520'>for</span> <span m='631640'>each</span>
  <span m='632060'>character</span> <span m='632660'>of</span> <span m='632960'>the</span>
  <span m='633230'>alphabet,</span> <span m='634220'>then</span> <span m='634440'>the</span>
  <span m='634520'>space</span> <span m='634880'>bound</span> <span m='635090'>you</span>
  <span m='635180'>would</span> <span m='635300'>achieve</span> <span m='636090'>is</span>
  <span m='636260'>H0</span> <span m='636710'>of</span> <span m='636800'>s,</span>
  <span m='637400'>times</span> <span m='638390'>the</span> <span m='638480'>number</span>
  <span m='638750'>of</span> <span m='638840'>characters</span> <span m='639320'>in</span>
  <span m='639410'>s.</span> </p><p><span m='641460'>So</span> <span m='642500'>that</span>
  <span m='642650'>would</span> <span m='642770'>be</span> <span m='642890'>if</span>
  <span m='643010'>you</span> <span m='643130'>substituted</span> <span m='643880'>k</span>
  <span m='644270'>equals</span> <span m='644570'>0</span> <span m='644990'>here.</span>
  <span m='645800'>So</span> <span m='645950'>that's</span> <span m='646160'>kind</span>
  <span m='646310'>of</span> <span m='646430'>neat.</span> <span m='646800'>This</span>
  <span m='646910'>is</span> <span m='647060'>a</span> <span m='647150'>compressed</span>
  <span m='647840'>representation</span> <span m='648620'>of</span> <span m='648710'>the</span>
  <span m='648800'>string.</span> <span m='650030'>Over</span> <span m='650330'>here,</span>
  <span m='651590'>we</span> <span m='651710'>just</span> <span m='651860'>wrote</span>
  <span m='652040'>down</span> <span m='652280'>the</span> <span m='652370'>string.</span>
  <span m='653150'>And</span> <span m='653360'>if</span> <span m='653720'>the</span>
  <span m='653840'>string</span> <span m='654140'>is</span> <span m='654240'>incompressible,</span>
  <span m='654950'>yeah,</span> <span m='655300'>T</span> <span m='655430'>log</span>
  <span m='655670'>sigma</span> <span m='655970'>is</span> <span m='656120'>optimal.</span>
  </p><p><span m='657140'>But</span> <span m='657260'>if</span> <span m='657350'>the</span>
  <span m='657440'>string</span> <span m='657650'>is</span> <span m='657770'>compressible,</span>
  <span m='658430'>like</span> <span m='658610'>many</span> <span m='658850'>strings</span>
  <span m='659120'>we</span> <span m='659180'>want</span> <span m='659330'>to</span>
  <span m='659390'>store--</span> <span m='659690'>you're</span> <span m='659840'>storing</span>
  <span m='659990'>English,</span> <span m='660380'>whatever--</span> <span m='660710'>you</span>
  <span m='660830'>should</span> <span m='660980'>save</span> <span m='661760'>somewhere</span>
  <span m='662060'>between</span> <span m='662480'>a</span> <span m='662540'>factor</span>
  <span m='662810'>of</span> <span m='662900'>2</span> <span m='663110'>and</span>
  <span m='663230'>10.</span> <span m='664610'>This</span> <span m='664910'>will</span>
  <span m='665210'>try</span> <span m='665420'>to</span> <span m='665510'>save</span>
  <span m='665780'>it.</span> </p><p><span m='666110'>Of</span> <span m='666230'>course,</span>
  <span m='667220'>factor</span> <span m='667820'>between</span> <span m='668150'>2</span>
  <span m='668300'>and</span> <span m='668390'>10</span> <span m='668570'>is</span>
  <span m='668690'>not--</span> <span m='669530'>is a</span> <span m='669710'>little</span>
  <span m='669890'>scary,</span> <span m='670400'>when</span> <span m='670550'>there's</span>
  <span m='670700'>this</span> <span m='670820'>factor</span> <span m='671140'>5</span>
  <span m='671520'>out</span> <span m='671720'>here.</span> <span m='672020'>That</span>
  <span m='672170'>might</span> <span m='672590'>dominate</span> <span m='673430'>whatever</span>
  <span m='673730'>savings</span> <span m='674120'>you</span> <span m='674210'>get.</span>
  <span m='674420'>But</span> <span m='674570'>in</span> <span m='674660'>theory,</span>
  <span m='674990'>this</span> <span m='675320'>could</span> <span m='675500'>be</span>
  <span m='675620'>a</span> <span m='675650'>lot</span> <span m='675830'>better.</span>
  <span m='677420'>And</span> <span m='678260'>this</span> <span m='678440'>is</span>
  <span m='678530'>just</span> <span m='678710'>the</span> <span m='678800'>first</span>
  <span m='679070'>result</span> <span m='679370'>in</span> <span m='679470'>this</span>
  <span m='679580'>series.</span> <span m='680090'>Now</span> <span m='680330'>we</span>
  <span m='680420'>can</span> <span m='680540'>get</span> <span m='680720'>1</span>
  <span m='681110'>times</span> <span m='681500'>Hk</span> <span m='681980'>of</span>
  <span m='682120'>T,</span> <span m='682760'>and</span> <span m='682910'>then</span>
  <span m='683060'>it's</span> <span m='683240'>a</span> <span m='684530'>lot</span>
  <span m='684650'>more</span> <span m='684830'>interesting.</span> </p><p><span m='687960'>OK,</span>
  <span m='688130'>so</span> <span m='688280'>that</span> <span m='688420'>was</span>
  <span m='688520'>0-th</span> <span m='688910'>order</span> <span m='689120'>entropy.</span>
  <span m='690020'>What's</span> <span m='690230'>this</span> <span m='690350'>k-th</span>
  <span m='690600'>order</span> <span m='690920'>entropy</span> <span m='691280'>business?</span>
  <span m='692210'>Essentially,</span> <span m='692840'>it's</span> <span m='693080'>about</span>
  <span m='693380'>taking--</span> <span m='693770'>instead</span> <span m='694100'>of</span>
  <span m='694220'>writing</span> <span m='694460'>a</span> <span m='694550'>code</span>
  <span m='694790'>word</span> <span m='694970'>for</span> <span m='695120'>a</span>
  <span m='695140'>single</span> <span m='695510'>letter,</span> <span m='696350'>you</span>
  <span m='696500'>can</span> <span m='696650'>write</span> <span m='696860'>a</span>
  <span m='697130'>code</span> <span m='697400'>word</span> <span m='697520'>for</span>
  <span m='697670'>a</span> <span m='697700'>letter</span> <span m='697970'>that</span>
  <span m='698120'>depends</span> <span m='698720'>on</span> <span m='698870'>the</span>
  <span m='698960'>previous</span> <span m='700100'>k</span> <span m='702020'>characters.</span>
  </p><p><span m='703670'>So</span> <span m='703850'>I'm</span> <span m='703940'>going</span>
  <span m='704060'>to</span> <span m='704120'>write</span> <span m='704300'>down</span>
  <span m='704540'>a</span> <span m='704600'>definition.</span> <span m='707170'>Hk</span>
  <span m='707980'>of</span> <span m='708110'>T</span> <span m='710980'>is</span>
  <span m='711140'>going</span> <span m='711310'>to</span> <span m='711380'>be</span>
  <span m='711660'>the</span> <span m='711880'>sum</span> <span m='712580'>over</span>
  <span m='712940'>all</span> <span m='713420'>words</span> <span m='713960'>of</span>
  <span m='714110'>length</span> <span m='714490'>k.</span> <span m='714970'>This</span>
  <span m='715160'>is</span> <span m='715250'>going</span> <span m='715370'>to</span>
  <span m='715490'>be</span> <span m='715610'>our</span> <span m='715730'>context</span>
  <span m='717500'>of</span> <span m='717740'>the</span> <span m='717860'>probability,</span>
  <span m='718970'>or</span> <span m='719420'>empirical</span> <span m='719930'>probability</span>
  <span m='721500'>of</span> <span m='721670'>w</span> <span m='722240'>occurring</span>
  <span m='727730'>times</span> <span m='729020'>the</span> <span m='729110'>0-th</span>
  <span m='729530'>order</span> <span m='729740'>entropy</span> <span m='730935'>of</span>
  <span m='731420'>the</span> <span m='731650'>string</span> <span m='735060'>of</span>
  <span m='736250'>successor</span> <span m='736820'>characters</span> <span m='743540'>of</span>
  <span m='743750'>w.</span> </p><p><span m='746510'>So</span> <span m='746810'>again,</span>
  <span m='747740'>the</span> <span m='747950'>empirical</span> <span m='748340'>probability</span>
  <span m='748850'>of</span> <span m='748910'>w</span> <span m='749180'>occurring</span>
  <span m='749660'>is</span> <span m='749810'>the</span> <span m='749930'>number</span>
  <span m='750350'>of</span> <span m='750620'>occurrences</span> <span m='751950'>of</span>
  <span m='752180'>w,</span> <span m='752840'>divided</span> <span m='753380'>by</span>
  <span m='754790'>T,</span> <span m='755150'>basically.</span> <span m='757730'>So</span>
  <span m='758330'>the</span> <span m='758420'>idea</span> <span m='758690'>is,</span>
  <span m='760010'>now</span> <span m='760370'>you</span> <span m='760550'>get</span>
  <span m='760700'>to</span> <span m='760850'>encode</span> <span m='763100'>a</span>
  <span m='763160'>character</span> <span m='763940'>depending</span> <span m='764570'>on</span>
  <span m='764720'>the</span> <span m='764810'>context</span> <span m='765350'>of</span>
  <span m='765440'>the</span> <span m='765530'>last</span> <span m='765800'>k</span>
  <span m='766010'>characters.</span> <span m='767180'>So</span> <span m='767330'>we're</span>
  <span m='767480'>summing</span> <span m='767990'>over</span> <span m='768230'>all</span>
  <span m='768440'>possible</span> <span m='769190'>contexts</span> <span m='770150'>of</span>
  <span m='770300'>k</span> <span m='770510'>characters,</span> <span m='772070'>and</span>
  <span m='772460'>we're</span> <span m='772730'>taking</span> <span m='773000'>the</span>
  <span m='773210'>expectation</span> <span m='774260'>over</span> <span m='774590'>all</span>
  <span m='775310'>possible</span> <span m='777020'>context</span> <span m='777530'>w.</span>
  </p><p><span m='778040'>That's</span> <span m='778250'>the</span> <span m='778370'>sum</span>
  <span m='778670'>of</span> <span m='778910'>the</span> <span m='779240'>probabilities</span>
  <span m='779930'>times</span> <span m='780150'>something.</span> <span m='781070'>And</span>
  <span m='781220'>then</span> <span m='782540'>condition</span> <span m='783230'>on</span>
  <span m='783680'>w</span> <span m='784160'>being</span> <span m='784460'>the</span>
  <span m='784550'>context,</span> <span m='785060'>the</span> <span m='785120'>last</span>
  <span m='785360'>k</span> <span m='785540'>characters.</span> <span m='786440'>We</span>
  <span m='786560'>want</span> <span m='786710'>to</span> <span m='786800'>measure</span>
  <span m='788450'>what</span> <span m='788780'>characters</span> <span m='789320'>follow</span>
  <span m='789740'>that.</span> <span m='790790'>And</span> <span m='791060'>there,</span>
  <span m='791390'>we</span> <span m='791540'>can</span> <span m='791690'>use</span>
  <span m='791930'>a</span> <span m='791990'>0-th</span> <span m='792450'>order</span>
  <span m='792630'>encoding.</span> <span m='793130'>I</span> <span m='793160'>mean,</span>
  <span m='793700'>we've</span> <span m='793970'>already</span> <span m='794660'>conditioned</span>
  <span m='795140'>on</span> <span m='795290'>w</span> <span m='796850'>being</span>
  <span m='797300'>right</span> <span m='797510'>there.</span> </p><p><span m='797940'>So</span>
  <span m='798500'>for</span> <span m='798740'>all</span> <span m='798950'>occurrences</span>
  <span m='799430'>of</span> <span m='799550'>w,</span> <span m='799940'>you</span>
  <span m='800090'>look</span> <span m='800300'>at</span> <span m='800390'>the</span>
  <span m='800510'>next</span> <span m='800750'>character</span> <span m='801170'>right</span>
  <span m='801380'>after</span> <span m='801710'>it,</span> <span m='802430'>and</span>
  <span m='802550'>you</span> <span m='802640'>take</span> <span m='802820'>0-th</span>
  <span m='803120'>order</span> <span m='803330'>entropy</span> <span m='803660'>of</span>
  <span m='803720'>that,</span> <span m='804110'>that's</span> <span m='804320'>called</span>
  <span m='804560'>k-th</span> <span m='804800'>order</span> <span m='805010'>entropy.</span>
  <span m='806600'>OK,</span> <span m='806690'>you</span> <span m='807440'>have</span>
  <span m='807530'>to</span> <span m='807650'>think</span> <span m='807830'>about</span>
  <span m='808040'>it</span> <span m='808100'>for</span> <span m='808250'>a</span>
  <span m='808280'>while,</span> <span m='808680'>too.</span> <span m='811230'>But</span>
  <span m='811430'>this</span> <span m='812480'>essentially</span> <span m='812900'>means</span>
  <span m='813260'>the</span> <span m='813620'>best,</span> <span m='814520'>you</span>
  <span m='814670'>can</span> <span m='814790'>prove</span> <span m='815000'>this</span>
  <span m='815180'>is</span> <span m='815300'>the</span> <span m='815420'>best</span>
  <span m='815720'>encoding</span> <span m='816350'>you</span> <span m='816530'>can</span>
  <span m='816680'>do,</span> <span m='817400'>if</span> <span m='817880'>the</span>
  <span m='818000'>codeword</span> <span m='818390'>of</span> <span m='818510'>a</span>
  <span m='818570'>letter</span> <span m='818870'>can</span> <span m='819020'>depend</span>
  <span m='819380'>on</span> <span m='819470'>the</span> <span m='819560'>previous</span>
  <span m='820240'>k</span> <span m='820520'>characters.</span> </p><p><span m='821540'>Of</span>
  <span m='821660'>course,</span> <span m='822150'>if</span> <span m='822320'>you</span>
  <span m='822410'>have</span> <span m='822560'>such</span> <span m='822770'>a</span>
  <span m='822830'>code</span> <span m='823040'>it's</span> <span m='823130'>easy</span>
  <span m='823340'>to</span> <span m='823460'>decompress,</span> <span m='824000'>because</span>
  <span m='824480'>as</span> <span m='824660'>you're</span> <span m='824810'>decompressing,</span>
  <span m='825470'>you</span> <span m='825560'>know</span> <span m='825770'>what</span>
  <span m='825950'>the</span> <span m='826070'>previous</span> <span m='826490'>k</span>
  <span m='826620'>characters</span> <span m='827180'>were.</span> <span m='828780'>OK,</span>
  <span m='828980'>interesting</span> <span m='829430'>thing</span> <span m='829640'>about</span>
  <span m='829910'>this</span> <span m='830120'>index</span> <span m='830890'>or</span>
  <span m='830990'>this</span> <span m='831260'>data</span> <span m='831560'>structure,</span>
  <span m='831980'>is</span> <span m='832140'>it's</span> <span m='833420'>independent</span>
  <span m='833960'>of</span> <span m='834080'>k.</span> <span m='834620'>The</span>
  <span m='834710'>data</span> <span m='835010'>structure</span> <span m='835400'>doesn't</span>
  <span m='835670'>know</span> <span m='835820'>what</span> <span m='835940'>k</span>
  <span m='836210'>is.</span> <span m='837080'>This</span> <span m='837290'>works</span>
  <span m='837770'>for</span> <span m='837980'>all</span> <span m='838220'>k.</span>
  </p><p><span m='840200'>For</span> <span m='840410'>any</span> <span m='841640'>fixed</span>
  <span m='842750'>k--</span> <span m='843200'>k</span> <span m='843530'>has</span>
  <span m='843740'>to</span> <span m='843860'>be</span> <span m='844190'>constant</span>
  <span m='844780'>here.</span> <span m='845090'>There</span> <span m='845100'>are</span>
  <span m='845150'>other</span> <span m='845330'>data</span> <span m='845540'>structures</span>
  <span m='845960'>like</span> <span m='846150'>[? KB, ?]</span> <span m='846770'>logarithmic,</span>
  <span m='847490'>or</span> <span m='847580'>so.</span> <span m='848870'>But</span>
  <span m='849050'>here,</span> <span m='849200'>we'll</span> <span m='849320'>think</span>
  <span m='849500'>of</span> <span m='849620'>k</span> <span m='849800'>as</span>
  <span m='849920'>a</span> <span m='849980'>constant.</span> </p><p><span m='851020'>And</span>
  <span m='851150'>so</span> <span m='851640'>this</span> <span m='851970'>is</span>
  <span m='852310'>really</span> <span m='852610'>a</span> <span m='852710'>neat</span>
  <span m='852920'>thing</span> <span m='853100'>about</span> <span m='853430'>compression.</span>
  <span m='854150'>There's</span> <span m='854690'>a</span> <span m='854750'>technique</span>
  <span m='855170'>called</span> <span m='855850'>the</span> <span m='855980'>Burrows-Wheeler</span>
  <span m='856580'>transform.</span> <span m='857750'>And</span> <span m='858020'>Lempel-Ziv</span>
  <span m='858590'>does</span> <span m='858740'>similar</span> <span m='859190'>things.</span>
  <span m='860600'>You</span> <span m='860640'>may</span> <span m='860720'>have</span>
  <span m='860840'>heard</span> <span m='860990'>of</span> <span m='861080'>those</span>
  <span m='861290'>compression</span> <span m='861740'>schemes.</span> <span m='862430'>They're</span>
  <span m='862490'>used</span> <span m='862790'>in</span> <span m='863090'>bzip,</span>
  <span m='863480'>and</span> <span m='863570'>things</span> <span m='863780'>like--</span>
  <span m='863950'>bzip</span> <span m='864430'>is</span> <span m='864950'>named</span>
  <span m='865130'>after</span> <span m='865340'>Burrows-Wheeler,</span> <span m='866000'>I</span>
  <span m='866260'>believe.</span> </p><p><span m='868190'>And</span> <span m='869570'>those</span>
  <span m='869870'>compression</span> <span m='870350'>schemes</span> <span m='870800'>achieve</span>
  <span m='872150'>Hk</span> <span m='872420'>of</span> <span m='872690'>T</span>
  <span m='873620'>bits</span> <span m='873950'>per</span> <span m='874130'>character--</span>
  <span m='875330'>so</span> <span m='875590'>Hk</span> <span m='875940'>of T</span>
  <span m='876290'>times</span> <span m='876710'>T--</span> <span m='877220'>for</span>
  <span m='877550'>all</span> <span m='877940'>k.</span> <span m='879720'>So</span>
  <span m='880550'>if</span> <span m='880640'>your</span> <span m='880760'>text</span>
  <span m='881150'>is</span> <span m='881270'>really</span> <span m='881630'>good,</span>
  <span m='882110'>given</span> <span m='882410'>the</span> <span m='882500'>context</span>
  <span m='882920'>of</span> <span m='882965'>the</span> <span m='883010'>last</span>
  <span m='883280'>five</span> <span m='883580'>letters,</span> <span m='884060'>or</span>
  <span m='884240'>three</span> <span m='884510'>letters.</span> <span m='885320'>In</span>
  <span m='885440'>some</span> <span m='885620'>sense,</span> <span m='885890'>the</span>
  <span m='886460'>compression</span> <span m='886850'>scheme</span> <span m='887120'>adapts</span>
  <span m='887510'>to</span> <span m='887630'>that.</span> </p><p><span m='889110'>So</span>
  <span m='889160'>this</span> <span m='889340'>is</span> <span m='889460'>what</span>
  <span m='889640'>we</span> <span m='889790'>call</span> <span m='891240'>a</span>
  <span m='891470'>self</span> <span m='891890'>index,</span> <span m='892185'>in</span>
  <span m='892480'>that</span> <span m='892700'>this</span> <span m='893030'>also</span>
  <span m='893360'>stores</span> <span m='893720'>the</span> <span m='893810'>string.</span>
  <span m='894260'>You</span> <span m='894380'>can</span> <span m='895100'>read</span>
  <span m='895340'>the</span> <span m='895430'>data</span> <span m='895670'>of</span>
  <span m='895790'>the</span> <span m='895880'>string.</span> <span m='896690'>And</span>
  <span m='896810'>so</span> <span m='898340'>whereas</span> <span m='898760'>over</span>
  <span m='898940'>here,</span> <span m='899120'>we</span> <span m='899240'>just</span>
  <span m='899360'>stored</span> <span m='899600'>the</span> <span m='899690'>string</span>
  <span m='899960'>uncompressed.</span> <span m='900920'>Here</span> <span m='901160'>we're</span>
  <span m='901280'>effectively</span> <span m='901760'>storing</span> <span m='902090'>the</span>
  <span m='902180'>string</span> <span m='902930'>in</span> <span m='903050'>a</span>
  <span m='903110'>compressed</span> <span m='903530'>form,</span> <span m='903860'>and</span>
  <span m='904670'>the</span> <span m='904760'>data</span> <span m='905000'>structure</span>
  <span m='905450'>is</span> <span m='905630'>similarly</span> <span m='906170'>compressed.</span>
  <span m='906920'>So</span> <span m='907070'>if</span> <span m='907160'>your</span>
  <span m='907280'>string</span> <span m='907560'>is</span> <span m='908030'>compressible</span>
  <span m='908630'>by</span> <span m='908780'>more</span> <span m='908990'>than</span>
  <span m='909110'>a</span> <span m='909170'>factor</span> <span m='909450'>of</span>
  <span m='909500'>5,</span> <span m='910310'>this</span> <span m='910460'>will</span>
  <span m='910550'>be</span> <span m='910670'>really</span> <span m='910910'>good.</span>
  <span m='913600'>And</span> <span m='913700'>that's</span> <span m='914390'>the</span>
  <span m='914540'>FM-index</span> <span m='915860'>bound.</span> </p><p><span m='917390'>Now</span>
  <span m='917600'>that</span> <span m='917720'>you</span> <span m='917870'>have</span>
  <span m='918080'>that</span> <span m='918590'>Hk</span> <span m='919010'>stuff,</span>
  <span m='920900'>it's</span> <span m='921080'>a</span> <span m='921140'>lot</span>
  <span m='921290'>easier</span> <span m='921530'>to</span> <span m='921590'>state</span>
  <span m='922370'>all</span> <span m='922610'>other</span> <span m='922790'>results.</span>
  <span m='925010'>So</span> <span m='925250'>we</span> <span m='925400'>have--</span>
  <span m='926660'>oh,</span> <span m='926750'>I</span> <span m='926810'>didn't</span>
  <span m='926990'>give</span> <span m='927140'>a</span> <span m='927230'>query</span>
  <span m='927550'>bound.</span> <span m='928370'>That</span> <span m='928520'>was</span>
  <span m='928680'>the</span> <span m='928760'>space.</span> <span m='930410'>Query</span>
  <span m='931140'>is</span> <span m='934850'>P</span> <span m='935330'>plus</span>
  <span m='935810'>size</span> <span m='936200'>of</span> <span m='936290'>output</span>
  <span m='939140'>times</span> <span m='940860'>log</span> <span m='941810'>to</span>
  <span m='941990'>the</span> <span m='942230'>epsilon</span> <span m='943030'>T.</span>
  <span m='946070'>So,</span> <span m='946310'>similar</span> <span m='946910'>to</span>
  <span m='947120'>this</span> <span m='947360'>one,</span> <span m='948890'>but</span>
  <span m='949190'>we</span> <span m='949340'>don't</span> <span m='949520'>have</span>
  <span m='950390'>this</span> <span m='950660'>trick</span> <span m='951800'>over</span>
  <span m='952040'>here.</span> </p><p><span m='954470'>Another</span> <span m='954830'>early</span>
  <span m='955070'>result</span> <span m='955610'>is</span> <span m='955760'>by</span>
  <span m='955910'>Sadakane.</span> <span m='960205'>I</span> <span m='960680'>think</span>
  <span m='960890'>also,</span> <span m='961430'>maybe</span> <span m='961700'>2001,</span>
  <span m='962730'>I</span> <span m='962920'>have</span> <span m='963110'>the</span>
  <span m='963230'>journal</span> <span m='963700'>referenced</span> <span m='964020'>as</span>
  <span m='964210'>2003.</span> <span m='970510'>This</span> <span m='970900'>is</span>
  <span m='971210'>in</span> <span m='971300'>some</span> <span m='971570'>ways</span>
  <span m='972050'>better,</span> <span m='972580'>some</span> <span m='972780'>ways</span>
  <span m='973130'>worse,</span> <span m='973940'>it's</span> <span m='974030'>kind</span>
  <span m='974180'>of</span> <span m='974240'>incomparable</span> <span m='974990'>to</span>
  <span m='975140'>the</span> <span m='975290'>other</span> <span m='975440'>results.</span>
  </p><p><span m='992380'>This</span> <span m='992650'>is</span> <span m='992860'>bits,</span>
  <span m='995170'>and</span> <span m='995290'>then</span> <span m='995530'>the</span>
  <span m='995590'>query</span> <span m='999040'>has</span> <span m='999460'>an</span>
  <span m='999520'>extra</span> <span m='999820'>large</span> <span m='1000150'>factor.</span>
  <span m='1008840'>This</span> <span m='1009020'>is</span> <span m='1009320'>again,</span>
  <span m='1009620'>another</span> <span m='1009890'>early</span> <span m='1010130'>result</span>
  <span m='1010520'>that</span> <span m='1010670'>I</span> <span m='1010760'>want</span>
  <span m='1010910'>to</span> <span m='1011000'>highlight.</span> <span m='1011480'>Now</span>
  <span m='1011630'>I'm</span> <span m='1011690'>going</span> <span m='1011810'>to</span>
  <span m='1011870'>start</span> <span m='1012080'>skipping</span> <span m='1012470'>results.</span>
  </p><p><span m='1013520'>The</span> <span m='1013610'>main</span> <span m='1013820'>innovation</span>
  <span m='1014330'>here,</span> <span m='1014990'>is</span> <span m='1015140'>that</span>
  <span m='1015230'>it</span> <span m='1015320'>works</span> <span m='1015650'>good</span>
  <span m='1015890'>for</span> <span m='1016310'>large</span> <span m='1016610'>alphabets.</span>
  <span m='1017690'>This</span> <span m='1017810'>is</span> <span m='1017870'>a</span>
  <span m='1017930'>very</span> <span m='1018110'>small</span> <span m='1018440'>dependence</span>
  <span m='1018860'>on</span> <span m='1018980'>sigma,</span> <span m='1020030'>whereas--</span>
  <span m='1020360'>as</span> <span m='1020510'>I</span> <span m='1020570'>mentioned,</span>
  <span m='1021020'>this</span> <span m='1021380'>structure</span> <span m='1022670'>really</span>
  <span m='1022970'>doesn't</span> <span m='1023240'>work</span> <span m='1023480'>well</span>
  <span m='1023690'>for</span> <span m='1023870'>large</span> <span m='1024109'>alphabets.</span>
  </p><p><span m='1024424'>Here</span> <span m='1024740'>we're</span> <span m='1024859'>getting--</span>
  <span m='1025730'>not</span> <span m='1025880'>getting</span> <span m='1026119'>k-th</span>
  <span m='1026440'>order</span> <span m='1026540'>entropy,</span> <span m='1026829'>we're</span>
  <span m='1026900'>getting</span> <span m='1027109'>0-th</span> <span m='1027410'>order</span>
  <span m='1027619'>entropy.</span> <span m='1028010'>It's</span> <span m='1028200'>a</span>
  <span m='1028440'>somewhat</span> <span m='1028770'>weaker</span> <span m='1029700'>result.</span>
  <span m='1031010'>The</span> <span m='1031190'>dependence</span> <span m='1031670'>on</span>
  <span m='1031790'>epsilon</span> <span m='1032270'>is</span> <span m='1032390'>more</span>
  <span m='1032630'>like</span> <span m='1032869'>this</span> <span m='1033079'>one.</span>
  <span m='1036680'>But</span> <span m='1036940'>if</span> <span m='1037230'>you</span>
  <span m='1037369'>just</span> <span m='1037579'>want</span> <span m='1037730'>a</span>
  <span m='1037910'>log</span> <span m='1038240'>factor</span> <span m='1038660'>here,</span>
  <span m='1039079'>then</span> <span m='1039260'>this</span> <span m='1039410'>is</span>
  <span m='1039560'>a</span> <span m='1039619'>1</span> <span m='1039859'>plus</span>
  <span m='1040130'>epsilon</span> <span m='1040770'>times</span> <span m='1041240'>H0.</span>
  <span m='1041690'>So</span> <span m='1041810'>in</span> <span m='1041869'>that</span>
  <span m='1041990'>sense,</span> <span m='1042260'>we're</span> <span m='1042410'>doing</span>
  <span m='1042680'>better--</span> <span m='1043490'>only</span> <span m='1043730'>a</span>
  <span m='1043790'>1</span> <span m='1043970'>plus</span> <span m='1044180'>epsilon,</span>
  <span m='1045270'>which</span> <span m='1045380'>is</span> <span m='1045500'>better.</span>
  </p><p><span m='1046880'>This</span> <span m='1047210'>thing</span> <span m='1047420'>was</span>
  <span m='1047599'>always</span> <span m='1047869'>at</span> <span m='1047960'>least</span>
  <span m='1048200'>2.</span> <span m='1050300'>This</span> <span m='1050480'>thing</span>
  <span m='1050660'>was</span> <span m='1050750'>always</span> <span m='1050960'>at</span>
  <span m='1051020'>least</span> <span m='1051230'>5,</span> <span m='1051740'>the</span>
  <span m='1051850'>complete</span> <span m='1052080'>constant.</span> <span m='1053000'>Here</span>
  <span m='1053360'>the</span> <span m='1053495'>lead</span> <span m='1053630'>constant</span>
  <span m='1053960'>can</span> <span m='1054080'>be</span> <span m='1054170'>1</span>
  <span m='1054350'>plus</span> <span m='1054830'>epsilon.</span> <span m='1054980'>This</span>
  <span m='1055115'>is</span> <span m='1055250'>almost</span> <span m='1056270'>succinct,</span>
  <span m='1056840'>but</span> <span m='1056990'>not</span> <span m='1057170'>quite.</span>
  </p><p><span m='1058010'>It</span> <span m='1058460'>doesn't</span> <span m='1058820'>quite</span>
  <span m='1059120'>compress</span> <span m='1059540'>as</span> <span m='1059810'>well--</span>
  <span m='1060050'>it</span> <span m='1060140'>only</span> <span m='1060350'>uses</span>
  <span m='1060490'>0-th</span> <span m='1060830'>order</span> <span m='1061040'>entropy--</span>
  <span m='1061520'>but</span> <span m='1061610'>that's</span> <span m='1061700'>still</span>
  <span m='1062150'>not</span> <span m='1062410'>bad.</span> <span m='1063140'>And</span>
  <span m='1063290'>then</span> <span m='1063440'>the</span> <span m='1063560'>other</span>
  <span m='1063740'>big</span> <span m='1064040'>innovation</span> <span m='1064610'>is</span>
  <span m='1064820'>the</span> <span m='1065570'>dependence</span> <span m='1065900'>on</span>
  <span m='1065990'>sigma</span> <span m='1066380'>small.</span> <span m='1067670'>The</span>
  <span m='1067760'>query</span> <span m='1068300'>is</span> <span m='1068950'>a</span>
  <span m='1068990'>little</span> <span m='1069230'>bit</span> <span m='1069350'>worse.</span>
  <span m='1073050'>OK,</span> <span m='1074300'>now</span> <span m='1074600'>fast</span>
  <span m='1074930'>forward</span> <span m='1075170'>a</span> <span m='1075230'>little</span>
  <span m='1075440'>bit.</span> <span m='1078620'>I</span> <span m='1078650'>want</span>
  <span m='1078800'>to</span> <span m='1078860'>talk</span> <span m='1079100'>about</span>
  <span m='1079400'>succinct</span> <span m='1079760'>data</span> <span m='1080150'>structures</span>
  <span m='1080750'>for</span> <span m='1083120'>suffix-tree-like</span> <span m='1084410'>queries.</span>
  </p><p><span m='1087350'>So</span> <span m='1087600'>there's</span> <span m='1088160'>two</span>
  <span m='1088560'>succinct</span> <span m='1088990'>data</span> <span m='1089210'>structures</span>
  <span m='1089630'>out</span> <span m='1089810'>there,</span> <span m='1090050'>with</span>
  <span m='1090350'>more</span> <span m='1090590'>or</span> <span m='1090620'>less</span>
  <span m='1090860'>the</span> <span m='1090950'>same</span> <span m='1091310'>authors</span>
  <span m='1091910'>as</span> <span m='1093110'>the</span> <span m='1093200'>first</span>
  <span m='1093440'>two</span> <span m='1093620'>results</span> <span m='1093740'>I</span>
  <span m='1093980'>talked</span> <span m='1094250'>about.</span> <span m='1095480'>So</span>
  <span m='1095720'>Grossi</span> <span m='1096170'>and</span> <span m='1096260'>Vitter,</span>
  <span m='1096560'>together</span> <span m='1096980'>with</span> <span m='1097130'>Gupta,</span>
  <span m='1099050'>can</span> <span m='1099410'>get</span> <span m='1100900'>Hk</span>
  <span m='1101320'>of</span> <span m='1101420'>T</span> <span m='1102380'>times</span>
  <span m='1102680'>T,</span> <span m='1104480'>which</span> <span m='1104660'>is</span>
  <span m='1106160'>optimal</span> <span m='1107240'>even</span> <span m='1107510'>with</span>
  <span m='1107720'>compression,</span> <span m='1109960'>with</span> <span m='1110110'>k-th</span>
  <span m='1110360'>order</span> <span m='1110660'>compression.</span> <span m='1113390'>And</span>
  <span m='1113720'>a</span> <span m='1113780'>good</span> <span m='1113960'>dependence</span>
  <span m='1114440'>on</span> <span m='1114560'>sigma.</span> </p><p><span m='1118440'>Yeah,</span>
  <span m='1118550'>I</span> <span m='1118610'>guess--</span> <span m='1119170'>T</span>
  <span m='1119360'>log</span> <span m='1119570'>sigma</span> <span m='1120530'>is</span>
  <span m='1120680'>the</span> <span m='1120860'>uncompressed</span> <span m='1121460'>bound.</span>
  <span m='1122330'>So</span> <span m='1122780'>you</span> <span m='1122870'>have</span>
  <span m='1122990'>to</span> <span m='1123080'>worry</span> <span m='1123320'>about--</span>
  <span m='1123910'>when</span> <span m='1124070'>you're</span> <span m='1124160'>talking</span>
  <span m='1124400'>about</span> <span m='1124580'>compression,</span> <span m='1125190'>so</span>
  <span m='1125210'>here</span> <span m='1125390'>we</span> <span m='1125480'>have</span>
  <span m='1126080'>the</span> <span m='1126260'>optimal</span> <span m='1126650'>bound</span>
  <span m='1127070'>using</span> <span m='1127310'>k-th</span> <span m='1127560'>order</span>
  <span m='1127760'>entropy</span> <span m='1128530'>with</span> <span m='1128690'>a</span>
  <span m='1128900'>lead</span> <span m='1129140'>constant</span> <span m='1129560'>of</span>
  <span m='1129710'>1,</span> <span m='1130670'>so</span> <span m='1130820'>that's</span>
  <span m='1131060'>great.</span> <span m='1131690'>That's</span> <span m='1131960'>what</span>
  <span m='1132080'>makes</span> <span m='1132320'>it</span> <span m='1132410'>succinct.</span>
  </p><p><span m='1133220'>As</span> <span m='1133370'>long</span> <span m='1133550'>as</span>
  <span m='1133670'>this</span> <span m='1133880'>is</span> <span m='1134030'>little
  o</span> <span m='1134300'>of</span> <span m='1134540'>that.</span> <span m='1134840'>This</span>
  <span m='1135170'>is</span> <span m='1135310'>going</span> <span m='1135460'>to</span>
  <span m='1135560'>be</span> <span m='1135650'>a</span> <span m='1135670'>little
  o</span> <span m='1135920'>of</span> <span m='1136130'>that,</span> <span m='1136400'>as</span>
  <span m='1136520'>long</span> <span m='1136820'>as</span> <span m='1137360'>Hk</span>
  <span m='1137780'>of T</span> <span m='1138170'>is</span> <span m='1138350'>not</span>
  <span m='1138770'>too</span> <span m='1139820'>small.</span> <span m='1140940'>If</span>
  <span m='1141060'>it's</span> <span m='1141290'>like</span> <span m='1141560'>1</span>
  <span m='1141800'>over</span> <span m='1142070'>log</span> <span m='1142520'>T,</span>
  <span m='1143870'>then</span> <span m='1144080'>actually</span> <span m='1144380'>this</span>
  <span m='1144560'>term</span> <span m='1145070'>dominates.</span> <span m='1146420'>But</span>
  <span m='1146520'>as</span> <span m='1146620'>long</span> <span m='1146690'>as</span>
  <span m='1146770'>it's</span> <span m='1146870'>bigger</span> <span m='1147200'>than</span>
  <span m='1149240'>log</span> <span m='1149600'>log</span> <span m='1149870'>T</span>
  <span m='1150090'>over</span> <span m='1150140'>log</span> <span m='1150410'>T,</span>
  <span m='1151080'>this</span> <span m='1151340'>thing,</span> <span m='1151800'>then</span>
  <span m='1152900'>you're</span> <span m='1153080'>fine.</span> <span m='1153810'>Just</span>
  <span m='1154280'>as</span> <span m='1154370'>long</span> <span m='1154520'>as</span>
  <span m='1154580'>you're</span> <span m='1154670'>not</span> <span m='1154820'>compressing</span>
  <span m='1155240'>a</span> <span m='1155300'>huge</span> <span m='1155600'>amount,</span>
  <span m='1156420'>then</span> <span m='1156770'>this</span> <span m='1157040'>will</span>
  <span m='1157280'>be</span> <span m='1157760'>lower-order.</span> </p><p><span m='1161940'>Sorry,</span>
  <span m='1162160'>query</span> <span m='1162680'>time.</span> <span m='1163010'>Query's</span>
  <span m='1163640'>a</span> <span m='1163700'>little</span> <span m='1163880'>bit</span>
  <span m='1164030'>worse,</span> <span m='1164280'>though.</span> <span m='1165860'>We</span>
  <span m='1165950'>have</span> <span m='1166370'>a</span> <span m='1166400'>log</span>
  <span m='1166740'>term</span> <span m='1167210'>with</span> <span m='1167680'>a</span>
  <span m='1167840'>P,</span> <span m='1168710'>only</span> <span m='1169160'>a</span>
  <span m='1169375'>log</span> <span m='1169590'>sigma,</span> <span m='1170240'>but</span>
  <span m='1170360'>then</span> <span m='1170510'>we</span> <span m='1170660'>also</span>
  <span m='1170960'>have</span> <span m='1171080'>this</span> <span m='1171260'>log</span>
  <span m='1171620'>squared</span> <span m='1172100'>over</span> <span m='1172310'>log</span>
  <span m='1172610'>log.</span> <span m='1175050'>Times</span> <span m='1176900'>log</span>
  <span m='1177320'>sigma,</span> <span m='1178910'>and</span> <span m='1179030'>here</span>
  <span m='1179420'>I</span> <span m='1179720'>haven't--</span> <span m='1181280'>there</span>
  <span m='1181430'>isn't</span> <span m='1181580'>a</span> <span m='1181640'>clear</span>
  <span m='1182660'>dependence</span> <span m='1183110'>on</span> <span m='1183230'>the</span>
  <span m='1183290'>size</span> <span m='1183530'>of</span> <span m='1183590'>the</span>
  <span m='1183710'>output.</span> </p><p><span m='1184180'>So</span> <span m='1184220'>this</span>
  <span m='1184430'>is--</span> <span m='1184700'>let's</span> <span m='1184880'>say</span>
  <span m='1185030'>size</span> <span m='1185330'>of</span> <span m='1185400'>output</span>
  <span m='1185660'>is</span> <span m='1185780'>1.</span> <span m='1186140'>You</span>
  <span m='1186200'>just</span> <span m='1186380'>want</span> <span m='1186500'>to</span>
  <span m='1186560'>find</span> <span m='1186830'>one</span> <span m='1187490'>match.</span>
  <span m='1189265'>I</span> <span m='1189392'>won't</span> <span m='1189890'>write</span>
  <span m='1190160'>this</span> <span m='1190550'>dependence</span> <span m='1190970'>on</span>
  <span m='1191040'>the</span> <span m='1191080'>size of</span> <span m='1191330'>the</span>
  <span m='1191420'>output.</span> <span m='1191690'>My</span> <span m='1191840'>guess</span>
  <span m='1192110'>is</span> <span m='1192290'>this</span> <span m='1192560'>is</span>
  <span m='1192680'>multiplied</span> <span m='1193130'>by</span> <span m='1193290'>the</span>
  <span m='1193485'>size</span> <span m='1193680'>of</span> <span m='1193730'>the</span>
  <span m='1193780'>output,</span> <span m='1193970'>but</span> <span m='1194540'>it's</span>
  <span m='1194660'>not</span> <span m='1195110'>stated</span> <span m='1195560'>explicitly</span>
  <span m='1195980'>in</span> <span m='1196040'>the</span> <span m='1196130'>paper,</span>
  <span m='1196440'>so</span> <span m='1196580'>I</span> <span m='1196640'>want</span>
  <span m='1196760'>to</span> <span m='1196850'>be</span> <span m='1197000'>careful.</span>
  </p><p><span m='1198180'>So</span> <span m='1198560'>we</span> <span m='1198740'>have</span>
  <span m='1198890'>a</span> <span m='1198950'>polylog</span> <span m='1200120'>additive</span>
  <span m='1200540'>slowdown</span> <span m='1201050'>here.</span> <span m='1202460'>So</span>
  <span m='1203030'>it's</span> <span m='1203120'>a</span> <span m='1203180'>little</span>
  <span m='1203390'>bit</span> <span m='1203510'>worse</span> <span m='1203780'>in</span>
  <span m='1203900'>time,</span> <span m='1204770'>but</span> <span m='1204980'>this</span>
  <span m='1205080'>space</span> <span m='1205460'>is</span> <span m='1205610'>obviously,</span>
  <span m='1205940'>a</span> <span m='1205970'>lot</span> <span m='1206150'>better.</span>
  <span m='1206420'>We've</span> <span m='1206630'>improved</span> <span m='1207080'>our</span>
  <span m='1207740'>constant</span> <span m='1208070'>factor</span> <span m='1208550'>from</span>
  <span m='1208790'>5,</span> <span m='1209390'>over</span> <span m='1209630'>here,</span>
  <span m='1210500'>to</span> <span m='1210680'>1.</span> <span m='1212840'>OK,</span>
  <span m='1213380'>and</span> <span m='1213530'>then</span> <span m='1215720'>there's</span>
  <span m='1216110'>one</span> <span m='1216290'>more</span> <span m='1216500'>paper</span>
  <span m='1216890'>I</span> <span m='1216920'>want</span> <span m='1217070'>to</span>
  <span m='1217160'>mention,</span> <span m='1218540'>by</span> <span m='1219680'>Ferragina,</span>
  <span m='1223350'>Manzini,</span> <span m='1227480'>Makinen,</span> <span m='1227900'>and</span>
  <span m='1228750'>Navarro.</span> </p><p><span m='1232160'>This</span> <span m='1232370'>is</span>
  <span m='1232580'>from</span> <span m='1233210'>just</span> <span m='1234530'>five</span>
  <span m='1234830'>years</span> <span m='1235040'>ago</span> <span m='1235280'>now,</span>
  <span m='1236000'>2007.</span> <span m='1238880'>They</span> <span m='1239030'>also</span>
  <span m='1239330'>achieved</span> <span m='1239750'>1</span> <span m='1240200'>times</span>
  <span m='1240680'>Hk</span> <span m='1242420'>of</span> <span m='1242600'>T</span>
  <span m='1243980'>times</span> <span m='1244490'>T</span> <span m='1245660'>as</span>
  <span m='1245870'>the</span> <span m='1245990'>lead</span> <span m='1246200'>term.</span>
  <span m='1247890'>And</span> <span m='1248000'>they</span> <span m='1248120'>get</span>
  <span m='1249070'>T</span> <span m='1249500'>divided</span> <span m='1249890'>by</span>
  <span m='1250750'>log</span> <span m='1251060'>to</span> <span m='1251150'>the</span>
  <span m='1251330'>epsilon</span> <span m='1252050'>n,</span> <span m='1252320'>so</span>
  <span m='1252620'>this</span> <span m='1252890'>is--</span> <span m='1256040'>yes,</span>
  <span m='1256320'>it's</span> <span m='1256600'>slight,</span> <span m='1257250'>there's</span>
  <span m='1257400'>probably</span> <span m='1257730'>a</span> <span m='1257790'>log</span>
  <span m='1258000'>sigma</span> <span m='1258330'>here,</span> <span m='1258480'>too.</span>
  <span m='1259370'>I'm</span> <span m='1259580'>not</span> <span m='1259740'>sure,</span>
  <span m='1260030'>it</span> <span m='1260130'>might</span> <span m='1260205'>just</span>
  <span m='1260280'>be</span> <span m='1260410'>T.</span> <span m='1261900'>Probably</span>
  <span m='1262170'>just</span> <span m='1262370'>T,</span> <span m='1262680'>actually.</span>
  </p><p><span m='1263190'>So</span> <span m='1263700'>we</span> <span m='1263850'>get</span>
  <span m='1264020'>rid</span> <span m='1264100'>of</span> <span m='1264190'>the</span>
  <span m='1264250'>log</span> <span m='1264480'>sigma,</span> <span m='1265020'>but</span>
  <span m='1265230'>this</span> <span m='1266020'>log</span> <span m='1266360'>log</span>
  <span m='1266560'>over</span> <span m='1266885'>log</span> <span m='1267210'>gets</span>
  <span m='1267390'>slightly</span> <span m='1267780'>smaller.</span> <span m='1268140'>It's</span>
  <span m='1268280'>only</span> <span m='1268360'>a</span> <span m='1268440'>log</span>
  <span m='1269720'>to</span> <span m='1269880'>the</span> <span m='1270130'>epsilon</span>
  <span m='1270360'>now.</span> <span m='1272040'>But</span> <span m='1272220'>the</span>
  <span m='1272370'>query</span> <span m='1272760'>bound</span> <span m='1273090'>is</span>
  <span m='1273210'>a</span> <span m='1273270'>little</span> <span m='1273480'>bit</span>
  <span m='1273630'>better.</span> <span m='1275550'>So</span> <span m='1275720'>the</span>
  <span m='1275920'>P</span> <span m='1276450'>plus--</span> <span m='1278120'>as</span>
  <span m='1278580'>the</span> <span m='1278740'>output</span> <span m='1280750'>times</span>
  <span m='1282160'>log</span> <span m='1282810'>to</span> <span m='1282970'>the</span>
  <span m='1283080'>1</span> <span m='1283290'>plus</span> <span m='1283770'>epsilon</span>
  <span m='1285180'>T</span> <span m='1287120'>query.</span> <span m='1290490'>So</span>
  <span m='1290740'>instead</span> <span m='1290855'>of</span> <span m='1290970'>basically</span>
  <span m='1291310'>log</span> <span m='1291580'>squared,</span> <span m='1292210'>we</span>
  <span m='1292320'>have</span> <span m='1292610'>log</span> <span m='1292750'>to</span>
  <span m='1292860'>1</span> <span m='1293010'>plus</span> <span m='1293160'>epsilon,</span>
  <span m='1293580'>slightly</span> <span m='1294060'>better.</span> <span m='1295290'>They</span>
  <span m='1295470'>also</span> <span m='1295800'>have</span> <span m='1296490'>an</span>
  <span m='1296640'>order</span> <span m='1296910'>P</span> <span m='1298020'>counting</span>
  <span m='1298620'>query.</span> <span m='1299350'>So</span> <span m='1299370'>if</span>
  <span m='1299460'>you</span> <span m='1299520'>just</span> <span m='1299670'>want</span>
  <span m='1299820'>to</span> <span m='1299880'>know</span> <span m='1300030'>how</span>
  <span m='1300210'>many</span> <span m='1300420'>matches</span> <span m='1300810'>are</span>
  <span m='1300960'>there,</span> <span m='1301710'>they</span> <span m='1301830'>can</span>
  <span m='1301980'>do</span> <span m='1302130'>that</span> <span m='1302310'>really</span>
  <span m='1302580'>fast</span> <span m='1303580'>in</span> <span m='1304200'>kind</span>
  <span m='1304350'>of</span> <span m='1304470'>regular</span> <span m='1304890'>time</span>
  <span m='1305220'>order</span> <span m='1305470'>P.</span> </p><p><span m='1307530'>And</span>
  <span m='1307650'>this</span> <span m='1307800'>is</span> <span m='1307920'>obviously</span>
  <span m='1308250'>very</span> <span m='1308430'>small.</span> <span m='1309120'>So</span>
  <span m='1309230'>this</span> <span m='1309310'>is</span> <span m='1309390'>probably</span>
  <span m='1309660'>the</span> <span m='1309780'>best</span> <span m='1309990'>result</span>
  <span m='1310310'>so</span> <span m='1310470'>far,</span> <span m='1310830'>still</span>
  <span m='1311430'>obviously,</span> <span m='1312090'>lots</span> <span m='1312360'>of</span>
  <span m='1312480'>open</span> <span m='1312690'>problems</span> <span m='1314820'>in</span>
  <span m='1315540'>this</span> <span m='1315810'>world.</span> <span m='1317040'>Still</span>
  <span m='1317370'>an</span> <span m='1317460'>active</span> <span m='1317790'>area</span>
  <span m='1317970'>of</span> <span m='1318060'>research.</span> <span m='1318990'>There</span>
  <span m='1319170'>are</span> <span m='1319560'>papers</span> <span m='1319920'>since</span>
  <span m='1320280'>these,</span> <span m='1321480'>but</span> <span m='1321660'>they</span>
  <span m='1321780'>don't</span> <span m='1321930'>achieve--</span> <span m='1322410'>the</span>
  <span m='1322650'>space</span> <span m='1322950'>bounds</span> <span m='1323190'>they</span>
  <span m='1323310'>achieve</span> <span m='1323590'>are</span> <span m='1323670'>not</span>
  <span m='1323820'>quite</span> <span m='1324060'>as</span> <span m='1324180'>good.</span>
  </p><p><span m='1324390'>There</span> <span m='1324540'>may be</span> <span m='1324780'>like</span>
  <span m='1324960'>2</span> <span m='1325170'>times</span> <span m='1325500'>Hk,</span>
  <span m='1325950'>and</span> <span m='1326070'>then</span> <span m='1326160'>they</span>
  <span m='1326250'>can</span> <span m='1326370'>get</span> <span m='1326490'>better</span>
  <span m='1326720'>query</span> <span m='1326920'>bounds.</span> <span m='1327770'>A</span>
  <span m='1327810'>lot</span> <span m='1327990'>of</span> <span m='1328050'>papers</span>
  <span m='1328350'>that</span> <span m='1328410'>I'm</span> <span m='1328470'>not</span>
  <span m='1328650'>talking</span> <span m='1328950'>about,</span> <span m='1329620'>there's</span>
  <span m='1329850'>just</span> <span m='1330120'>a</span> <span m='1330180'>few</span>
  <span m='1330390'>too</span> <span m='1330570'>many.</span> <span m='1332190'>But</span>
  <span m='1332280'>if</span> <span m='1332370'>you</span> <span m='1332460'>just</span>
  <span m='1332610'>care</span> <span m='1332760'>about</span> <span m='1332940'>space,</span>
  <span m='1333450'>this</span> <span m='1333690'>is</span> <span m='1333840'>the</span>
  <span m='1333960'>best</span> <span m='1334710'>so</span> <span m='1334890'>far.</span>
  <span m='1335550'>Or</span> <span m='1335970'>I</span> <span m='1336030'>use</span>
  <span m='1336180'>these</span> <span m='1336410'>two,</span> <span m='1337410'>depending</span>
  <span m='1337770'>on</span> <span m='1337890'>exactly</span> <span m='1338340'>how</span>
  <span m='1338490'>big</span> <span m='1338700'>sigma</span> <span m='1339030'>is.</span>
  </p><p><span m='1341700'>Just</span> <span m='1341880'>to</span> <span m='1342080'>mention,</span>
  <span m='1342280'>there's</span> <span m='1342450'>some</span> <span m='1342600'>other</span>
  <span m='1342810'>cool</span> <span m='1343050'>things</span> <span m='1343470'>you</span>
  <span m='1343620'>can</span> <span m='1343770'>do.</span> <span m='1344070'>So</span>
  <span m='1344940'>these</span> <span m='1345270'>are</span> <span m='1345780'>small</span>
  <span m='1346260'>space</span> <span m='1346950'>static</span> <span m='1347520'>data</span>
  <span m='1347760'>structures.</span> <span m='1348240'>Some</span> <span m='1348480'>of</span>
  <span m='1348570'>them</span> <span m='1348720'>can</span> <span m='1348840'>be</span>
  <span m='1348960'>made</span> <span m='1349140'>dynamic.</span> <span m='1350250'>But</span>
  <span m='1350400'>in</span> <span m='1350520'>particular,</span> <span m='1351460'>there's</span>
  <span m='1351690'>work</span> <span m='1352020'>on,</span> <span m='1352440'>how</span>
  <span m='1352710'>do</span> <span m='1352770'>you</span> <span m='1352890'>actually</span>
  <span m='1353160'>build</span> <span m='1353460'>these</span> <span m='1353640'>data</span>
  <span m='1353850'>structures</span> <span m='1354840'>with</span> <span m='1355080'>low</span>
  <span m='1355320'>space?</span> </p><p><span m='1356100'>Because</span> <span m='1356280'>you</span>
  <span m='1356340'>don't</span> <span m='1356550'>really</span> <span m='1356820'>want</span>
  <span m='1357000'>to</span> <span m='1357330'>build</span> <span m='1357900'>a</span>
  <span m='1357930'>huge</span> <span m='1358530'>suffix</span> <span m='1358890'>tree</span>
  <span m='1359070'>and</span> <span m='1359160'>then</span> <span m='1359310'>compress</span>
  <span m='1359730'>it.</span> <span m='1360180'>Because</span> <span m='1360280'>the</span>
  <span m='1360360'>whole</span> <span m='1360540'>point</span> <span m='1360750'>is</span>
  <span m='1360870'>you</span> <span m='1361020'>have</span> <span m='1361260'>a</span>
  <span m='1361320'>hard</span> <span m='1361530'>time</span> <span m='1361740'>storing</span>
  <span m='1362100'>this</span> <span m='1362220'>data</span> <span m='1362460'>structure.</span>
  <span m='1363550'>So</span> <span m='1363630'>in</span> <span m='1363690'>fact,</span>
  <span m='1365550'>there's</span> <span m='1365760'>some</span> <span m='1365910'>papers--</span>
  <span m='1367080'>I</span> <span m='1367170'>think</span> <span m='1367410'>more</span>
  <span m='1367740'>along</span> <span m='1368040'>the</span> <span m='1368130'>lines</span>
  <span m='1368370'>of</span> <span m='1368460'>these</span> <span m='1368640'>original</span>
  <span m='1369060'>results--</span> <span m='1369480'>the</span> <span m='1369570'>Grossi-Vitter,</span>
  <span m='1370680'>Ferragina,</span> <span m='1371250'>Manzini,</span> <span m='1371550'>and</span>
  <span m='1371880'>Sadakane--</span> <span m='1372630'>building</span> <span m='1372990'>those</span>
  <span m='1373260'>data</span> <span m='1373470'>structures.</span> <span m='1374820'>And</span>
  <span m='1375180'>while</span> <span m='1375510'>you're</span> <span m='1375690'>building</span>
  <span m='1376140'>the</span> <span m='1376260'>amount</span> <span m='1376470'>of</span>
  <span m='1376530'>working</span> <span m='1376860'>space</span> <span m='1377250'>is</span>
  <span m='1378100'>at</span> <span m='1378200'>least</span> <span m='1378300'>proportional</span>
  <span m='1379020'>to</span> <span m='1380220'>the</span> <span m='1380370'>size</span>
  <span m='1380820'>of</span> <span m='1380910'>the</span> <span m='1381000'>final</span>
  <span m='1381330'>data</span> <span m='1381540'>structure.</span> <span m='1382170'>So</span>
  <span m='1382320'>that</span> <span m='1382500'>can</span> <span m='1382740'>be</span>
  <span m='1382860'>done.</span> <span m='1384510'>We're</span> <span m='1384630'>not</span>
  <span m='1384780'>going</span> <span m='1384900'>to</span> <span m='1384960'>go</span>
  <span m='1385050'>into</span> <span m='1385230'>it</span> <span m='1385320'>here.</span>
  </p><p><span m='1386380'>There</span> <span m='1386430'>are</span> <span m='1386490'>other</span>
  <span m='1386670'>papers</span> <span m='1387120'>about--</span> <span m='1388620'>all</span>
  <span m='1388725'>of</span> <span m='1388830'>these</span> <span m='1389010'>papers</span>
  <span m='1389340'>are</span> <span m='1389430'>focused</span> <span m='1389790'>on</span>
  <span m='1389940'>how</span> <span m='1390120'>do</span> <span m='1390240'>I</span>
  <span m='1390330'>do</span> <span m='1390510'>a</span> <span m='1390600'>search,</span>
  <span m='1391050'>how</span> <span m='1391170'>do I</span> <span m='1391290'>search</span>
  <span m='1391530'>for</span> <span m='1391650'>a</span> <span m='1391680'>pattern,</span>
  <span m='1392130'>find</span> <span m='1392370'>all</span> <span m='1392460'>the</span>
  <span m='1392550'>matches.</span> <span m='1393540'>There's</span> <span m='1393690'>other</span>
  <span m='1393900'>things</span> <span m='1394320'>you</span> <span m='1394440'>can</span>
  <span m='1394560'>do</span> <span m='1394670'>with</span> <span m='1394740'>suffix</span>
  <span m='1395140'>trees</span> <span m='1395490'>like,</span> <span m='1396510'>given</span>
  <span m='1396900'>two</span> <span m='1397200'>suffixes,</span> <span m='1397740'>you</span>
  <span m='1397830'>can</span> <span m='1397980'>find</span> <span m='1398250'>the</span>
  <span m='1398580'>longest</span> <span m='1399180'>common</span> <span m='1399570'>prefix</span>
  <span m='1400080'>of</span> <span m='1400230'>them.</span> </p><p><span m='1401100'>So</span>
  <span m='1401280'>there's</span> <span m='1401490'>papers</span> <span m='1401880'>on</span>
  <span m='1402000'>how</span> <span m='1402150'>to</span> <span m='1402270'>do</span>
  <span m='1402390'>that</span> <span m='1402600'>kind</span> <span m='1402750'>of</span>
  <span m='1402840'>stuff</span> <span m='1403200'>in</span> <span m='1403420'>the</span>
  <span m='1404010'>compressed</span> <span m='1404550'>regime.</span> <span m='1406200'>There's</span>
  <span m='1406530'>papers</span> <span m='1406890'>on--</span> <span m='1407340'>or</span>
  <span m='1407422'>there</span> <span m='1407504'>is</span> <span m='1407586'>a</span>
  <span m='1407670'>paper</span> <span m='1408000'>on</span> <span m='1408150'>how</span>
  <span m='1408270'>to</span> <span m='1408360'>do</span> <span m='1408510'>document</span>
  <span m='1408990'>retrieval,</span> <span m='1409680'>which</span> <span m='1409905'>is</span>
  <span m='1410130'>a</span> <span m='1410280'>problem</span> <span m='1410550'>we</span>
  <span m='1410640'>looked</span> <span m='1410880'>at</span> <span m='1411540'>two</span>
  <span m='1411720'>lectures</span> <span m='1412080'>ago,</span> <span m='1412290'>in</span>
  <span m='1412380'>the</span> <span m='1412470'>string</span> <span m='1412680'>lecture.</span>
  <span m='1413670'>You</span> <span m='1413880'>want</span> <span m='1414030'>to</span>
  <span m='1414090'>find--</span> <span m='1414510'>not</span> <span m='1414720'>all</span>
  <span m='1414840'>the</span> <span m='1414960'>matches,</span> <span m='1415350'>you</span>
  <span m='1415440'>want</span> <span m='1415560'>to</span> <span m='1415620'>find</span>
  <span m='1415800'>all</span> <span m='1416100'>the</span> <span m='1416220'>documents</span>
  <span m='1416760'>that</span> <span m='1416880'>have</span> <span m='1417840'>this</span>
  <span m='1418950'>substring</span> <span m='1419490'>in</span> <span m='1419640'>them.</span>
  </p><p><span m='1420360'>So</span> <span m='1420540'>that</span> <span m='1420660'>can</span>
  <span m='1420810'>be--</span> <span m='1421140'>that</span> <span m='1421350'>reduces</span>
  <span m='1421890'>the</span> <span m='1422070'>size</span> <span m='1422400'>of</span>
  <span m='1422460'>the</span> <span m='1422640'>output</span> <span m='1424540'>in</span>
  <span m='1424860'>these</span> <span m='1425040'>bounds.</span> <span m='1426150'>That</span>
  <span m='1426300'>can</span> <span m='1426450'>also</span> <span m='1426720'>be</span>
  <span m='1426810'>done,</span> <span m='1427415'>Sadakane</span> <span m='1427920'>wrote</span>
  <span m='1428060'>a</span> <span m='1428340'>paper</span> <span m='1428580'>about</span>
  <span m='1428790'>that.</span> <span m='1429240'>Some</span> <span m='1429510'>work</span>
  <span m='1429780'>on</span> <span m='1429870'>dynamic--</span> <span m='1430470'>there's</span>
  <span m='1430680'>actually</span> <span m='1430950'>a</span> <span m='1430980'>lot</span>
  <span m='1431160'>of</span> <span m='1431250'>work</span> <span m='1431550'>in</span>
  <span m='1431760'>implementing</span> <span m='1432330'>these</span> <span m='1432480'>data</span>
  <span m='1432690'>structures,</span> <span m='1434070'>definitely</span> <span m='1434850'>FM-index,</span>
  <span m='1435990'>and</span> <span m='1436140'>I</span> <span m='1436230'>believe,</span>
  <span m='1437360'>maybe</span> <span m='1437570'>the</span> <span m='1437660'>Sadakane</span>
  <span m='1438260'>one.</span> <span m='1438850'>And</span> <span m='1438870'>maybe</span>
  <span m='1439140'>this--</span> <span m='1439620'>versions</span> <span m='1440030'>of</span>
  <span m='1440130'>this</span> <span m='1440310'>one.</span> </p><p><span m='1441270'>I</span>
  <span m='1441390'>don't</span> <span m='1441540'>think</span> <span m='1441780'>the</span>
  <span m='1441990'>succinct</span> <span m='1442080'>ones</span> <span m='1442520'>have</span>
  <span m='1442650'>been</span> <span m='1442770'>implemented,</span> <span m='1443160'>although</span>
  <span m='1443430'>I</span> <span m='1443520'>don't</span> <span m='1443670'>know</span>
  <span m='1443820'>for</span> <span m='1443970'>sure.</span> <span m='1444760'>But</span>
  <span m='1444900'>there's</span> <span m='1445080'>a</span> <span m='1445140'>lot</span>
  <span m='1445320'>of</span> <span m='1445440'>work</span> <span m='1445620'>in</span>
  <span m='1445710'>implementing</span> <span m='1446190'>this,</span> <span m='1446340'>because</span>
  <span m='1446700'>people</span> <span m='1447030'>care,</span> <span m='1447870'>and</span>
  <span m='1448110'>indeed</span> <span m='1448530'>they're</span> <span m='1448710'>small</span>
  <span m='1450150'>and</span> <span m='1450360'>reasonably</span> <span m='1450810'>fast.</span>
  <span m='1451760'>So</span> <span m='1452010'>if</span> <span m='1452160'>you</span>
  <span m='1452250'>need</span> <span m='1452430'>a</span> <span m='1452490'>text</span>
  <span m='1452820'>index,</span> <span m='1453960'>there's</span> <span m='1454170'>freely</span>
  <span m='1454440'>available</span> <span m='1454830'>implementations</span> <span
  m='1455490'>of</span> <span m='1455610'>at</span> <span m='1455670'>least</span>
  <span m='1455850'>some</span> <span m='1456060'>of</span> <span m='1456120'>these.</span>
  </p><p><span m='1458490'>So</span> <span m='1458700'>this</span> <span m='1458940'>is</span>
  <span m='1460830'>one</span> <span m='1461070'>of--</span> <span m='1461670'>I</span>
  <span m='1461700'>mean</span> <span m='1461880'>this</span> <span m='1461985'>is</span>
  <span m='1462090'>practical</span> <span m='1462630'>stuff,</span> <span m='1463200'>too.</span>
  <span m='1465350'>Cool.</span> <span m='1466020'>But</span> <span m='1466170'>as</span>
  <span m='1466290'>I</span> <span m='1466350'>said,</span> <span m='1466620'>I'm</span>
  <span m='1466740'>going</span> <span m='1466860'>to</span> <span m='1466920'>focus</span>
  <span m='1467310'>on</span> <span m='1467460'>the</span> <span m='1467600'>simplest</span>
  <span m='1468600'>I</span> <span m='1468990'>know,</span> <span m='1469590'>which</span>
  <span m='1469830'>is</span> <span m='1471000'>Grossi</span> <span m='1471420'>and</span>
  <span m='1471510'>Vitter.</span> <span m='1473220'>If</span> <span m='1473610'>you</span>
  <span m='1473700'>look</span> <span m='1473850'>at</span> <span m='1473910'>the</span>
  <span m='1474000'>paper,</span> <span m='1474330'>there</span> <span m='1474390'>are</span>
  <span m='1474450'>sort</span> <span m='1474600'>of</span> <span m='1474690'>successive</span>
  <span m='1475230'>improvements.</span> <span m='1476340'>And</span> <span m='1476430'>we're</span>
  <span m='1476580'>going</span> <span m='1476700'>to</span> <span m='1476760'>cover</span>
  <span m='1477930'>up</span> <span m='1478470'>to</span> <span m='1478830'>the</span>
  <span m='1478950'>point</span> <span m='1479280'>where</span> <span m='1479430'>we</span>
  <span m='1479550'>get</span> <span m='1479730'>a</span> <span m='1479790'>good</span>
  <span m='1479940'>space</span> <span m='1480270'>bound,</span> <span m='1480660'>and</span>
  <span m='1480750'>the</span> <span m='1480840'>query</span> <span m='1481290'>won't</span>
  <span m='1481440'>be</span> <span m='1481560'>quite</span> <span m='1481800'>as</span>
  <span m='1481920'>good.</span> </p><p><span m='1484310'>So</span> <span m='1484490'>that's</span>
  <span m='1484700'>going</span> <span m='1484820'>to</span> <span m='1484910'>be</span>
  <span m='1485090'>the</span> <span m='1485210'>bulk</span> <span m='1485510'>of</span>
  <span m='1485570'>the</span> <span m='1485660'>lecture.</span> <span m='1487710'>It's</span>
  <span m='1487940'>how</span> <span m='1488060'>to</span> <span m='1488180'>get</span>
  <span m='1488450'>that</span> <span m='1488630'>space</span> <span m='1488960'>bound.</span>
  <span m='1492230'>And</span> <span m='1492680'>as</span> <span m='1492920'>I</span>
  <span m='1493010'>mentioned,</span> <span m='1493430'>we're</span> <span m='1493520'>going</span>
  <span m='1493640'>to</span> <span m='1493730'>start</span> <span m='1494000'>out</span>
  <span m='1494120'>with</span> <span m='1494300'>a</span> <span m='1494360'>weaker</span>
  <span m='1494660'>bound,</span> <span m='1495090'>which</span> <span m='1495170'>is</span>
  <span m='1495260'>getting</span> <span m='1495560'>T</span> <span m='1495770'>log</span>
  <span m='1496040'>log</span> <span m='1496210'>T</span> <span m='1496385'>bits,</span>
  <span m='1496910'>and</span> <span m='1497060'>then</span> <span m='1497300'>we'll</span>
  <span m='1497450'>see</span> <span m='1497630'>how</span> <span m='1497720'>to</span>
  <span m='1497780'>improve</span> <span m='1498110'>that</span> <span m='1498350'>to</span>
  <span m='1498490'>T.</span> <span m='1501050'>And</span> <span m='1501200'>then</span>
  <span m='1501320'>we'll</span> <span m='1501530'>see</span> <span m='1501770'>how</span>
  <span m='1501860'>to</span> <span m='1501920'>improve</span> <span m='1502190'>it</span>
  <span m='1502280'>to</span> <span m='1502580'>1</span> <span m='1502790'>over</span>
  <span m='1503000'>epsilon</span> <span m='1504440'>times</span> <span m='1504770'>T.</span>
  </p><p><span m='1505580'>So</span> <span m='1505790'>it</span> <span m='1505880'>will</span>
  <span m='1505940'>be</span> <span m='1506060'>a</span> <span m='1506120'>series</span>
  <span m='1506450'>of</span> <span m='1506600'>improvements.</span> <span m='1511980'>And</span>
  <span m='1512210'>we're</span> <span m='1512280'>going</span> <span m='1512360'>to</span>
  <span m='1512480'>start</span> <span m='1512810'>just</span> <span m='1513080'>with</span>
  <span m='1513290'>thinking</span> <span m='1513590'>about</span> <span m='1513800'>suffix</span>
  <span m='1514250'>arrays.</span> <span m='1516390'>So</span> <span m='1516530'>what</span>
  <span m='1516710'>is</span> <span m='1516860'>the</span> <span m='1516950'>compressed</span>
  <span m='1517340'>suffix</span> <span m='1517730'>array</span> <span m='1517970'>problem?</span>
  <span m='1519110'>Well,</span> <span m='1519350'>it's</span> <span m='1519500'>just</span>
  <span m='1519710'>that</span> <span m='1520760'>I</span> <span m='1521030'>have--</span>
  <span m='1522500'>I</span> <span m='1522740'>want</span> <span m='1522980'>to</span>
  <span m='1523070'>be</span> <span m='1523190'>able</span> <span m='1523400'>to</span>
  <span m='1523550'>do</span> <span m='1523850'>queries</span> <span m='1524300'>of</span>
  <span m='1524390'>the</span> <span m='1524480'>form</span> <span m='1524840'>SA</span>
  <span m='1525110'>of</span> <span m='1525380'>k.</span> <span m='1527840'>If</span>
  <span m='1527990'>I</span> <span m='1528050'>imagine</span> <span m='1528410'>the</span>
  <span m='1528500'>suffixes</span> <span m='1528980'>in</span> <span m='1529070'>sorted</span>
  <span m='1529340'>order,</span> <span m='1529580'>what</span> <span m='1529760'>is</span>
  <span m='1529880'>the</span> <span m='1529970'>k-th</span> <span m='1530420'>suffix?</span>
  <span m='1530930'>Where</span> <span m='1531080'>does</span> <span m='1531260'>it</span>
  <span m='1531320'>begin?</span> </p><p><span m='1532520'>So</span> <span m='1532880'>I</span>
  <span m='1532970'>want</span> <span m='1533120'>to</span> <span m='1533210'>be</span>
  <span m='1533360'>able</span> <span m='1533600'>to</span> <span m='1533750'>represent</span>
  <span m='1534200'>that</span> <span m='1534350'>array.</span> <span m='1534940'>And</span>
  <span m='1535130'>using</span> <span m='1535460'>that,</span> <span m='1535610'>you</span>
  <span m='1535730'>could</span> <span m='1535850'>do</span> <span m='1535970'>searches,</span>
  <span m='1536750'>and</span> <span m='1536900'>later</span> <span m='1537140'>we'll</span>
  <span m='1537260'>see</span> <span m='1537440'>how</span> <span m='1537590'>to</span>
  <span m='1538070'>use</span> <span m='1538280'>that</span> <span m='1538550'>to</span>
  <span m='1538700'>make</span> <span m='1538940'>a</span> <span m='1539000'>suffix</span>
  <span m='1539390'>tree.</span> <span m='1540590'>But</span> <span m='1541010'>for</span>
  <span m='1541160'>now,</span> <span m='1541610'>that's</span> <span m='1541820'>just</span>
  <span m='1542030'>our</span> <span m='1542120'>goal,</span> <span m='1542480'>is</span>
  <span m='1542555'>to</span> <span m='1542630'>compute</span> <span m='1543120'>SA</span>
  <span m='1543410'>of k.</span> <span m='1544730'>OK,</span> <span m='1545090'>well,</span>
  <span m='1545270'>the</span> <span m='1545390'>idea</span> <span m='1545600'>is</span>
  <span m='1545690'>actually</span> <span m='1546140'>going</span> <span m='1546320'>to</span>
  <span m='1546410'>be</span> <span m='1546500'>very</span> <span m='1546710'>familiar.</span>
  <span m='1547400'>We</span> <span m='1547490'>saw</span> <span m='1547820'>it</span>
  <span m='1548015'>two</span> <span m='1548210'>lectures</span> <span m='1548360'>ago,</span>
  <span m='1549080'>when</span> <span m='1549200'>we</span> <span m='1549320'>did</span>
  <span m='1549470'>this</span> <span m='1549590'>divide</span> <span m='1549920'>and</span>
  <span m='1550010'>conquer</span> <span m='1550400'>for</span> <span m='1550550'>building</span>
  <span m='1551000'>a</span> <span m='1551060'>suffix</span> <span m='1551480'>array.</span>
  </p><p><span m='1552200'>We</span> <span m='1552320'>did</span> <span m='1552470'>this--</span>
  <span m='1553880'>we</span> <span m='1554120'>divided</span> <span m='1554660'>the</span>
  <span m='1554750'>letters</span> <span m='1555140'>in</span> <span m='1555260'>our</span>
  <span m='1555380'>string</span> <span m='1555770'>by</span> <span m='1556040'>0,</span>
  <span m='1556370'>1,</span> <span m='1556580'>and</span> <span m='1556670'>2,</span>
  <span m='1556880'>mod</span> <span m='1557130'>3.</span> <span m='1558170'>We</span>
  <span m='1558320'>won't</span> <span m='1558510'>need</span> <span m='1559310'>mod</span>
  <span m='1559670'>3.</span> <span m='1560050'>We'll</span> <span m='1560180'>just</span>
  <span m='1560330'>do</span> <span m='1560480'>mod</span> <span m='1560690'>2</span>
  <span m='1560960'>here.</span> <span m='1561555'>It</span> <span m='1561890'>won't</span>
  <span m='1562550'>actually</span> <span m='1562820'>matter</span> <span m='1563750'>what</span>
  <span m='1563900'>constant</span> <span m='1564320'>we</span> <span m='1564420'>use.</span>
  <span m='1565760'>But</span> <span m='1565910'>we're</span> <span m='1566000'>going</span>
  <span m='1566120'>to</span> <span m='1566180'>follow</span> <span m='1566510'>that</span>
  <span m='1566690'>recursion</span> <span m='1567830'>and</span> <span m='1568010'>use</span>
  <span m='1568250'>it</span> <span m='1568340'>to</span> <span m='1568550'>represent</span>
  <span m='1569240'>the</span> <span m='1569330'>suffix</span> <span m='1569720'>array,</span>
  <span m='1569930'>instead</span> <span m='1570260'>of</span> <span m='1570590'>using</span>
  <span m='1570890'>it</span> <span m='1570980'>to</span> <span m='1571100'>build</span>
  <span m='1571400'>it.</span> </p><p><span m='1572720'>So</span> <span m='1573230'>the</span>
  <span m='1573320'>base</span> <span m='1573590'>case,</span> <span m='1574920'>and</span>
  <span m='1575200'>set</span> <span m='1575280'>up</span> <span m='1575360'>some</span>
  <span m='1575480'>notation.</span> <span m='1576020'>T0</span> <span m='1576530'>is</span>
  <span m='1576590'>going</span> <span m='1576740'>to</span> <span m='1576800'>represent</span>
  <span m='1577280'>T.</span> <span m='1578630'>The</span> <span m='1578780'>length</span>
  <span m='1579290'>of</span> <span m='1579440'>that</span> <span m='1579710'>string</span>
  <span m='1580640'>I'm</span> <span m='1580730'>going</span> <span m='1580760'>to</span>
  <span m='1580790'>call</span> <span m='1581000'>n0</span> <span m='1581540'>or</span>
  <span m='1581840'>n.</span> <span m='1587090'>And</span> <span m='1587480'>we</span>
  <span m='1587600'>have</span> <span m='1587960'>a</span> <span m='1588020'>suffix</span>
  <span m='1588410'>array,</span> <span m='1591290'>which</span> <span m='1591590'>I'm</span>
  <span m='1591650'>going</span> <span m='1591770'>to</span> <span m='1591860'>call</span>
  <span m='1592300'>SA</span> <span m='1592910'>0,</span> <span m='1594230'>which</span>
  <span m='1594470'>is</span> <span m='1594710'>the</span> <span m='1594830'>suffix</span>
  <span m='1595220'>array</span> <span m='1595640'>of</span> <span m='1595820'>that</span>
  <span m='1596030'>text.</span> <span m='1597530'>So</span> <span m='1597710'>that's</span>
  <span m='1597890'>just</span> <span m='1598040'>notation.</span> <span m='1598820'>We're</span>
  <span m='1598920'>not</span> <span m='1599000'>actually</span> <span m='1599270'>storing</span>
  <span m='1599630'>all</span> <span m='1599780'>of</span> <span m='1599840'>those</span>
  <span m='1600050'>things.</span> </p><p><span m='1603230'>Now,</span> <span m='1605360'>the</span>
  <span m='1605750'>recursion</span> <span m='1606410'>is</span> <span m='1607360'>T
  k</span> <span m='1607760'>plus</span> <span m='1608060'>1.</span> <span m='1609410'>That's</span>
  <span m='1609590'>going</span> <span m='1609740'>to</span> <span m='1609830'>be</span>
  <span m='1609930'>the</span> <span m='1610040'>next</span> <span m='1610670'>level,</span>
  <span m='1611160'>which</span> <span m='1611270'>is,</span> <span m='1611420'>we</span>
  <span m='1611570'>write--</span> <span m='1612770'>we</span> <span m='1612890'>combine</span>
  <span m='1613490'>two</span> <span m='1613700'>letters,</span> <span m='1614840'>Tk--</span>
  <span m='1615880'>sorry,</span> <span m='1616370'>square</span> <span m='1616820'>bracket--</span>
  <span m='1617580'>2i</span> <span m='1619120'>comma</span> <span m='1620070'>Tk</span>
  <span m='1620810'>square</span> <span m='1621170'>bracket</span> <span m='1621530'>2i</span>
  <span m='1621840'>plus</span> <span m='1622070'>1.</span> </p><p><span m='1622970'>Combine</span>
  <span m='1623480'>two</span> <span m='1623660'>adjacent</span> <span m='1624020'>letters</span>
  <span m='1624965'>into</span> <span m='1625460'>one</span> <span m='1625700'>letter,</span>
  <span m='1626480'>and</span> <span m='1626570'>we</span> <span m='1626720'>do</span>
  <span m='1626900'>that</span> <span m='1627260'>for</span> <span m='1628570'>i</span>
  <span m='1628940'>equals</span> <span m='1629270'>0,</span> <span m='1630320'>1,</span>
  <span m='1631970'>up</span> <span m='1632210'>to</span> <span m='1632330'>n/2.</span>
  <span m='1635510'>That's</span> <span m='1635720'>our</span> <span m='1635810'>new</span>
  <span m='1635960'>string.</span> <span m='1637820'>I'm</span> <span m='1638000'>not</span>
  <span m='1638210'>going</span> <span m='1638450'>to</span> <span m='1638600'>sort</span>
  <span m='1638840'>these</span> <span m='1639020'>letters</span> <span m='1639440'>and</span>
  <span m='1639530'>remap</span> <span m='1639920'>the</span> <span m='1640010'>letters</span>
  <span m='1640430'>to</span> <span m='1640550'>compress</span> <span m='1641030'>the</span>
  <span m='1641360'>alphabet.</span> <span m='1641840'>I'm</span> <span m='1641930'>just</span>
  <span m='1642080'>going</span> <span m='1642200'>to</span> <span m='1642260'>leave</span>
  <span m='1642500'>those</span> <span m='1642740'>letters</span> <span m='1643040'>alone,</span>
  <span m='1643370'>as</span> <span m='1643520'>an</span> <span m='1643670'>ordered</span>
  <span m='1643910'>pair.</span> </p><p><span m='1644750'>In</span> <span m='1644840'>general,</span>
  <span m='1646010'>at</span> <span m='1646220'>level</span> <span m='1647780'>Tk,</span>
  <span m='1648710'>a</span> <span m='1648770'>single</span> <span m='1649070'>letter</span>
  <span m='1649370'>is</span> <span m='1649490'>actually</span> <span m='1649820'>2</span>
  <span m='1650010'>to</span> <span m='1650120'>the</span> <span m='1650240'>k</span>
  <span m='1650420'>letters.</span> <span m='1652160'>But</span> <span m='1652430'>still,</span>
  <span m='1652700'>this</span> <span m='1652880'>is</span> <span m='1653000'>a</span>
  <span m='1653060'>useful</span> <span m='1653390'>way</span> <span m='1653510'>to</span>
  <span m='1653600'>think</span> <span m='1653780'>about</span> <span m='1654020'>it,</span>
  <span m='1654110'>because</span> <span m='1654290'>it</span> <span m='1654380'>lets</span>
  <span m='1654590'>me</span> <span m='1654680'>think</span> <span m='1654860'>about</span>
  <span m='1655070'>fewer</span> <span m='1655520'>suffixes.</span> <span m='1656190'>Here,</span>
  <span m='1656780'>we</span> <span m='1656900'>only</span> <span m='1657170'>have</span>
  <span m='1657470'>the</span> <span m='1657770'>even</span> <span m='1658100'>suffixes,</span>
  <span m='1658880'>suffixes</span> <span m='1659450'>that</span> <span m='1659600'>begin</span>
  <span m='1659930'>at</span> <span m='1660020'>even</span> <span m='1660290'>positions</span>
  <span m='1664700'>relative</span> <span m='1665180'>to</span> <span m='1665360'>Tk.</span>
  </p><p><span m='1666650'>The</span> <span m='1666830'>size</span> <span m='1667220'>of</span>
  <span m='1667310'>this</span> <span m='1667490'>string,</span> <span m='1667910'>in</span>
  <span m='1667970'>terms</span> <span m='1668200'>of</span> <span m='1668280'>number</span>
  <span m='1668510'>of</span> <span m='1668570'>letters,</span> <span m='1669500'>is</span>
  <span m='1669800'>1/2</span> <span m='1670640'>of</span> <span m='1670700'>the</span>
  <span m='1670820'>original.</span> <span m='1671360'>So</span> <span m='1671820'>in</span>
  <span m='1671900'>general,</span> <span m='1672300'>this</span> <span m='1672400'>is</span>
  <span m='1672500'>going</span> <span m='1672560'>to</span> <span m='1672620'>be</span>
  <span m='1672680'>n</span> <span m='1672890'>over</span> <span m='1673130'>2</span>
  <span m='1673270'>to</span> <span m='1673410'>the</span> <span m='1673490'>k.</span>
  <span m='1676430'>And</span> <span m='1676700'>then</span> <span m='1676850'>we're</span>
  <span m='1677000'>interested</span> <span m='1677480'>in</span> <span m='1677810'>the</span>
  <span m='1677960'>suffix</span> <span m='1678320'>array</span> <span m='1678590'>SA</span>
  <span m='1679620'>k</span> <span m='1679820'>plus</span> <span m='1680060'>1.</span>
  </p><p><span m='1681680'>This</span> <span m='1681920'>is</span> <span m='1682040'>going</span>
  <span m='1682340'>to</span> <span m='1682460'>be</span> <span m='1684980'>just</span>
  <span m='1685310'>looking</span> <span m='1685670'>at</span> <span m='1685850'>the</span>
  <span m='1685920'>even</span> <span m='1686210'>values.</span> <span m='1687630'>So</span>
  <span m='1687740'>if</span> <span m='1688010'>we</span> <span m='1688280'>extract</span>
  <span m='1688970'>even</span> <span m='1689270'>entries</span> <span m='1693650'>from</span>
  <span m='1695015'>sorry,</span> <span m='1695480'>SA</span> <span m='1695945'>k.</span>
  <span m='1697340'>So</span> <span m='1697460'>if</span> <span m='1697520'>we</span>
  <span m='1697640'>already</span> <span m='1698000'>have</span> <span m='1698640'>SA</span>
  <span m='1698720'>k,</span> <span m='1699530'>we</span> <span m='1699620'>just</span>
  <span m='1699770'>take</span> <span m='1699950'>the</span> <span m='1700010'>even</span>
  <span m='1700340'>values</span> <span m='1701720'>that</span> <span m='1701840'>are</span>
  <span m='1701930'>in</span> <span m='1702050'>there.</span> <span m='1702380'>Those</span>
  <span m='1702620'>are</span> <span m='1702680'>the</span> <span m='1702800'>ones</span>
  <span m='1703130'>that</span> <span m='1703490'>are</span> <span m='1704000'>existing</span>
  <span m='1704540'>suffixes.</span> <span m='1705620'>Extract</span> <span m='1706040'>those,</span>
  <span m='1706970'>divide</span> <span m='1707270'>by</span> <span m='1707450'>2.</span>
  <span m='1708050'>That</span> <span m='1708230'>will</span> <span m='1708350'>be</span>
  <span m='1708530'>the</span> <span m='1708620'>suffix</span> <span m='1709040'>array</span>
  <span m='1709940'>of</span> <span m='1710150'>this</span> <span m='1710690'>text.</span>
  </p><p><span m='1712220'>This</span> <span m='1712400'>is</span> <span m='1712490'>kind</span>
  <span m='1712640'>of</span> <span m='1713070'>backwards</span> <span m='1713540'>from</span>
  <span m='1713690'>how</span> <span m='1713810'>you</span> <span m='1713940'>would</span>
  <span m='1714950'>construct</span> <span m='1715430'>the</span> <span m='1715550'>thing.</span>
  <span m='1715820'>You</span> <span m='1715895'>would</span> <span m='1715970'>construct</span>
  <span m='1716210'>it</span> <span m='1716450'>bottom</span> <span m='1716780'>up.</span>
  <span m='1717290'>Here,</span> <span m='1717530'>we're</span> <span m='1717640'>imagining--</span>
  <span m='1718020'>we</span> <span m='1718130'>already</span> <span m='1718370'>know</span>
  <span m='1718550'>the</span> <span m='1718670'>suffix</span> <span m='1718870'>arrays</span>
  <span m='1719270'>are</span> <span m='1719300'>just</span> <span m='1719450'>about</span>
  <span m='1719660'>representation.</span> <span m='1720590'>So</span> <span m='1720770'>this</span>
  <span m='1720980'>is</span> <span m='1721130'>a</span> <span m='1721940'>top-down</span>
  <span m='1722510'>kind</span> <span m='1722690'>of</span> <span m='1722870'>definition</span>
  <span m='1723440'>of</span> <span m='1723560'>what</span> <span m='1723650'>we're</span>
  <span m='1723770'>trying</span> <span m='1723980'>to</span> <span m='1724070'>store.</span>
  </p><p><span m='1725650'>OK,</span> <span m='1726110'>so</span> <span m='1727490'>this</span>
  <span m='1727670'>is</span> <span m='1727730'>what</span> <span m='1727880'>we</span>
  <span m='1728000'>want</span> <span m='1728180'>to</span> <span m='1728240'>do.</span>
  <span m='1728750'>Now</span> <span m='1728900'>we</span> <span m='1729050'>are</span>
  <span m='1729170'>going</span> <span m='1729320'>to</span> <span m='1729380'>build</span>
  <span m='1729560'>things</span> <span m='1729715'>bottom</span> <span m='1729870'>up.</span>
  <span m='1730190'>We're</span> <span m='1730250'>going</span> <span m='1730370'>to</span>
  <span m='1730430'>imagine</span> <span m='1730820'>we've</span> <span m='1731030'>already</span>
  <span m='1731510'>represented</span> <span m='1732250'>SA</span> <span m='1733040'>k</span>
  <span m='1733250'>plus</span> <span m='1733550'>1.</span> <span m='1734210'>And</span>
  <span m='1734330'>now</span> <span m='1734630'>we</span> <span m='1734750'>need</span>
  <span m='1734870'>to</span> <span m='1734990'>represent</span> <span m='1735440'>SA</span>
  <span m='1735650'>k.</span> <span m='1737060'>If</span> <span m='1737210'>we</span>
  <span m='1737300'>can</span> <span m='1737450'>represent</span> <span m='1738710'>SA</span>
  <span m='1739145'>k</span> <span m='1740660'>in</span> <span m='1740810'>terms</span>
  <span m='1741230'>of</span> <span m='1742030'>SA k</span> <span m='1742430'>plus</span>
  <span m='1742670'>1</span> <span m='1744050'>with</span> <span m='1744590'>not</span>
  <span m='1744860'>too</span> <span m='1745010'>many</span> <span m='1745250'>bits,</span>
  <span m='1745670'>then</span> <span m='1745850'>you</span> <span m='1746000'>add</span>
  <span m='1746240'>up</span> <span m='1746420'>all</span> <span m='1746630'>of</span>
  <span m='1746750'>the</span> <span m='1747530'>levels</span> <span m='1748040'>of</span>
  <span m='1748100'>recursion.</span> <span m='1748440'>We'll</span> <span m='1748780'>have</span>
  <span m='1748870'>to</span> <span m='1749000'>talk</span> <span m='1749190'>about</span>
  <span m='1749330'>how</span> <span m='1749480'>many</span> <span m='1749630'>levels</span>
  <span m='1749930'>of</span> <span m='1749990'>this</span> <span m='1750140'>recursion</span>
  <span m='1750530'>we</span> <span m='1750590'>need</span> <span m='1750740'>to</span>
  <span m='1750830'>do.</span> </p><p><span m='1751070'>We're</span> <span m='1751170'>not</span>
  <span m='1751220'>going</span> <span m='1751340'>to</span> <span m='1751400'>go</span>
  <span m='1751520'>down</span> <span m='1751730'>to</span> <span m='1752090'>constant</span>
  <span m='1752210'>size.</span> <span m='1753470'>We'll</span> <span m='1753620'>just</span>
  <span m='1753770'>go</span> <span m='1754130'>log</span> <span m='1754460'>log</span>
  <span m='1754680'>n</span> <span m='1754820'>levels.</span> <span m='1757310'>But</span>
  <span m='1758660'>we</span> <span m='1758810'>just</span> <span m='1758990'>add</span>
  <span m='1759200'>up</span> <span m='1759350'>all</span> <span m='1759510'>those</span>
  <span m='1759650'>costs,</span> <span m='1760940'>and</span> <span m='1761360'>we'll</span>
  <span m='1761480'>get</span> <span m='1761630'>the</span> <span m='1761720'>overall</span>
  <span m='1762200'>size</span> <span m='1762560'>of</span> <span m='1762650'>our</span>
  <span m='1762740'>data</span> <span m='1762950'>structure.</span> <span m='1767560'>So</span>
  <span m='1767740'>how</span> <span m='1767920'>do</span> <span m='1768010'>we</span>
  <span m='1768100'>do</span> <span m='1768220'>this</span> <span m='1768400'>representation?</span>
  </p><p><span m='1770080'>I</span> <span m='1770170'>need</span> <span m='1770320'>to</span>
  <span m='1770440'>define</span> <span m='1772030'>two</span> <span m='1772420'>kind</span>
  <span m='1772750'>of</span> <span m='1772810'>weird</span> <span m='1773080'>things,</span>
  <span m='1774190'>and</span> <span m='1774340'>then</span> <span m='1774520'>we'll</span>
  <span m='1774640'>see</span> <span m='1774850'>why</span> <span m='1775070'>they're</span>
  <span m='1775390'>interesting.</span> <span m='1777280'>OK,</span> <span m='1777550'>the</span>
  <span m='1777640'>first</span> <span m='1777910'>thing</span> <span m='1778920'>is</span>
  <span m='1779080'>called</span> <span m='1779410'>even</span> <span m='1779770'>successor</span>
  <span m='1781831'>sub</span> <span m='1782300'>k</span> <span m='1782580'>of</span>
  <span m='1782860'>i.</span> <span m='1784920'>So</span> <span m='1785200'>let</span>
  <span m='1785350'>me</span> <span m='1785500'>define</span> <span m='1785920'>it.</span>
  <span m='1787330'>It's</span> <span m='1787450'>going</span> <span m='1787600'>to</span>
  <span m='1787710'>be</span> <span m='1788464'>i</span> <span m='1790240'>if</span>
  <span m='1791800'>the</span> <span m='1791950'>i-th</span> <span m='1792250'>suffix</span>
  <span m='1795370'>starts</span> <span m='1795700'>in</span> <span m='1795790'>an</span>
  <span m='1795910'>even</span> <span m='1796240'>position.</span> </p><p><span m='1798010'>So</span>
  <span m='1798400'>it</span> <span m='1798670'>doesn't</span> <span m='1798940'>do</span>
  <span m='1799090'>anything</span> <span m='1799490'>for</span> <span m='1799605'>the</span>
  <span m='1799720'>even</span> <span m='1800020'>guys.</span> <span m='1800860'>The</span>
  <span m='1800920'>interesting</span> <span m='1801250'>thing</span> <span m='1801430'>is</span>
  <span m='1801550'>when</span> <span m='1801700'>the</span> <span m='1801790'>suffix</span>
  <span m='1802420'>starts</span> <span m='1802780'>in</span> <span m='1802900'>an</span>
  <span m='1803020'>odd</span> <span m='1803260'>position.</span> <span m='1804370'>Then</span>
  <span m='1804790'>we're</span> <span m='1804940'>going</span> <span m='1805120'>to</span>
  <span m='1805210'>write</span> <span m='1805510'>down</span> <span m='1805750'>a</span>
  <span m='1805810'>different</span> <span m='1806080'>number</span> <span m='1806320'>j.</span>
  <span m='1809860'>This</span> <span m='1810040'>is</span> <span m='1810775'>going</span>
  <span m='1810940'>to</span> <span m='1811105'>look</span> <span m='1811270'>kind</span>
  <span m='1811630'>of</span> <span m='1811690'>weird,</span> <span m='1812060'>but</span>
  <span m='1812565'>it's</span> <span m='1812830'>actually--</span> <span m='1814120'>it's</span>
  <span m='1814240'>simple</span> <span m='1814720'>after</span> <span m='1814960'>you</span>
  <span m='1815020'>think</span> <span m='1815230'>about</span> <span m='1815500'>it</span>
  <span m='1815590'>for</span> <span m='1816220'>10</span> <span m='1816400'>minutes.</span>
  </p><p><span m='1819330'>This</span> <span m='1819580'>one</span> <span m='1821340'>is</span>
  <span m='1822176'>odd.</span> <span m='1823880'>OK,</span> <span m='1824050'>so</span>
  <span m='1824170'>the</span> <span m='1824290'>other</span> <span m='1824470'>situation</span>
  <span m='1825010'>is</span> <span m='1825100'>that</span> <span m='1825250'>SA</span>
  <span m='1825620'>k--</span> <span m='1826330'>the</span> <span m='1826480'>i-th</span>
  <span m='1827080'>suffix</span> <span m='1827530'>starts</span> <span m='1827860'>at</span>
  <span m='1827980'>an</span> <span m='1828550'>even</span> <span m='1828880'>position.</span>
  <span m='1829550'>So</span> <span m='1829630'>let</span> <span m='1829750'>me</span>
  <span m='1830380'>draw</span> <span m='1830560'>a</span> <span m='1830590'>little</span>
  <span m='1830800'>picture.</span> <span m='1831910'>So</span> <span m='1832900'>here</span>
  <span m='1833410'>is</span> <span m='1834750'>SA</span> <span m='1836080'>of</span>
  <span m='1836350'>i.</span> <span m='1839600'>OK,</span> <span m='1839920'>if</span>
  <span m='1840160'>this</span> <span m='1840400'>happens</span> <span m='1840790'>to</span>
  <span m='1840880'>be</span> <span m='1841090'>odd,</span> <span m='1841930'>this</span>
  <span m='1842440'>position</span> <span m='1842920'>in</span> <span m='1843190'>the</span>
  <span m='1843340'>text--</span> <span m='1843715'>this</span> <span m='1844090'>is</span>
  <span m='1844360'>Tk.</span> </p><p><span m='1847300'>Then</span> <span m='1847750'>I</span>
  <span m='1849100'>want</span> <span m='1849310'>to</span> <span m='1849400'>go</span>
  <span m='1849700'>here.</span> <span m='1850540'>OK?</span> <span m='1851050'>Because</span>
  <span m='1851200'>that's</span> <span m='1851410'>an</span> <span m='1851500'>even</span>
  <span m='1851770'>position,</span> <span m='1852220'>it's</span> <span m='1852360'>a</span>
  <span m='1852400'>suffix,</span> <span m='1852880'>it's</span> <span m='1853030'>right</span>
  <span m='1853300'>next</span> <span m='1853510'>to</span> <span m='1853600'>the</span>
  <span m='1853720'>suffix</span> <span m='1854130'>I</span> <span m='1854200'>care</span>
  <span m='1854380'>about.</span> <span m='1855080'>It</span> <span m='1855220'>is</span>
  <span m='1855370'>what</span> <span m='1855520'>we</span> <span m='1855640'>call</span>
  <span m='1855820'>the</span> <span m='1855970'>even</span> <span m='1856240'>successor</span>
  <span m='1856720'>suffix.</span> <span m='1857710'>But</span> <span m='1857860'>I</span>
  <span m='1857920'>don't</span> <span m='1858160'>want</span> <span m='1858310'>to</span>
  <span m='1858370'>know</span> <span m='1858520'>the</span> <span m='1858760'>index</span>
  <span m='1859330'>of</span> <span m='1859450'>that.</span> <span m='1859810'>The</span>
  <span m='1860020'>index</span> <span m='1860320'>of</span> <span m='1860380'>that</span>
  <span m='1860560'>would</span> <span m='1860680'>just</span> <span m='1860830'>be</span>
  <span m='1861030'>SA</span> <span m='1861400'>k</span> <span m='1861770'>of</span>
  <span m='1861870'>i</span> <span m='1862180'>plus</span> <span m='1862480'>1.</span>
  </p><p><span m='1863590'>I</span> <span m='1863710'>want</span> <span m='1863920'>to</span>
  <span m='1864250'>map</span> <span m='1864700'>backwards</span> <span m='1865270'>through</span>
  <span m='1865700'>SA</span> <span m='1866200'>inverse.</span> <span m='1867580'>I</span>
  <span m='1867700'>want</span> <span m='1867910'>to</span> <span m='1867970'>know,</span>
  <span m='1869200'>what</span> <span m='1869500'>is</span> <span m='1869740'>the</span>
  <span m='1870190'>rank</span> <span m='1870790'>of</span> <span m='1870970'>that</span>
  <span m='1871210'>suffix?</span> <span m='1872320'>Which</span> <span m='1872590'>suffix</span>
  <span m='1873070'>j</span> <span m='1875530'>starts</span> <span m='1876520'>right</span>
  <span m='1876760'>there?</span> <span m='1877120'>I</span> <span m='1877210'>want</span>
  <span m='1877390'>to</span> <span m='1877450'>know</span> <span m='1877570'>that</span>
  <span m='1877720'>the</span> <span m='1877840'>j-th</span> <span m='1878160'>suffix</span>
  <span m='1879130'>starts</span> <span m='1879520'>right</span> <span m='1879790'>after</span>
  <span m='1880060'>the</span> <span m='1880210'>i-th</span> <span m='1880420'>suffix,</span>
  <span m='1881370'>and</span> <span m='1881500'>I</span> <span m='1881560'>want</span>
  <span m='1881680'>to</span> <span m='1881740'>write</span> <span m='1881890'>down</span>
  <span m='1882180'>j.</span> <span m='1883480'>We'll</span> <span m='1883570'>see</span>
  <span m='1883780'>why</span> <span m='1883930'>this</span> <span m='1884170'>is</span>
  <span m='1884320'>the</span> <span m='1884440'>right</span> <span m='1884620'>thing</span>
  <span m='1884980'>in</span> <span m='1885100'>a</span> <span m='1885160'>moment.</span>
  </p><p><span m='1886590'>We're</span> <span m='1886810'>just</span> <span m='1886960'>mapping</span>
  <span m='1887290'>through</span> <span m='1887470'>SA,</span> <span m='1888460'>adding</span>
  <span m='1888790'>1,</span> <span m='1889270'>and</span> <span m='1889420'>then</span>
  <span m='1889570'>mapping</span> <span m='1889930'>backwards</span> <span m='1890610'>through</span>
  <span m='1890850'>SA.</span> <span m='1892350'>So</span> <span m='1892540'>that's</span>
  <span m='1892750'>a</span> <span m='1892840'>function.</span> <span m='1894010'>We're</span>
  <span m='1894100'>going</span> <span m='1894220'>to</span> <span m='1894280'>store</span>
  <span m='1894550'>that</span> <span m='1894730'>function</span> <span m='1895150'>in</span>
  <span m='1895270'>a</span> <span m='1895330'>particular--</span> <span m='1895750'>in</span>
  <span m='1895900'>a</span> <span m='1895960'>very</span> <span m='1896260'>weird</span>
  <span m='1896560'>way,</span> <span m='1897430'>which</span> <span m='1897580'>we'll</span>
  <span m='1897700'>get</span> <span m='1897850'>to</span> <span m='1898030'>in</span>
  <span m='1898120'>a</span> <span m='1898150'>moment.</span> </p><p><span m='1900670'>OK,</span>
  <span m='1901030'>next</span> <span m='1901270'>thing</span> <span m='1901480'>we</span>
  <span m='1901570'>need</span> <span m='1902720'>is</span> <span m='1902980'>called</span>
  <span m='1903340'>even</span> <span m='1903670'>rank.</span> <span m='1905420'>This</span>
  <span m='1905620'>is</span> <span m='1905740'>going</span> <span m='1905830'>to</span>
  <span m='1905950'>be</span> <span m='1906220'>like</span> <span m='1906460'>our</span>
  <span m='1906580'>rank</span> <span m='1906850'>function.</span> <span m='1907910'>We've</span>
  <span m='1908080'>had</span> <span m='1908185'>it</span> <span m='1908290'>before.</span>
  <span m='1909850'>This</span> <span m='1910000'>is</span> <span m='1910120'>going</span>
  <span m='1910270'>to</span> <span m='1910360'>be</span> <span m='1910760'>the</span>
  <span m='1910900'>number</span> <span m='1912240'>of</span> <span m='1912580'>even</span>
  <span m='1914190'>suffixes--</span> <span m='1915220'>even</span> <span m='1915460'>suffixes</span>
  <span m='1916030'>are</span> <span m='1916150'>suffixes</span> <span m='1916630'>starting</span>
  <span m='1917020'>at</span> <span m='1917110'>even</span> <span m='1917350'>positions--</span>
  <span m='1919090'>preceding</span> <span m='1922510'>the</span> <span m='1922780'>i-th</span>
  <span m='1923320'>suffix.</span> </p><p><span m='1925600'>i-th</span> <span m='1925900'>suffix</span>
  <span m='1926440'>meaning</span> <span m='1927010'>the</span> <span m='1927470'>i-th</span>
  <span m='1927870'>one</span> <span m='1927920'>in</span> <span m='1927970'>sorted</span>
  <span m='1928330'>order.</span> <span m='1929570'>So</span> <span m='1929590'>the</span>
  <span m='1929710'>suffix</span> <span m='1930250'>SA</span> <span m='1930700'>of</span>
  <span m='1930880'>i.</span> <span m='1934600'>Yes,</span> <span m='1934810'>so</span>
  <span m='1934990'>this</span> <span m='1935200'>is--</span> <span m='1935980'>let</span>
  <span m='1936130'>me</span> <span m='1936880'>be</span> <span m='1937030'>more</span>
  <span m='1937180'>precise.</span> <span m='1938170'>This</span> <span m='1938380'>is</span>
  <span m='1938560'>the</span> <span m='1938680'>number</span> <span m='1939070'>of</span>
  <span m='1939370'>even</span> <span m='1939700'>values</span> <span m='1943510'>in</span>
  <span m='1944560'>SA</span> <span m='1945070'>k</span> <span m='1946670'>up</span>
  <span m='1946870'>to</span> <span m='1947070'>i.</span> <span m='1948460'>So</span>
  <span m='1948640'>we're</span> <span m='1948700'>looking--</span> <span m='1949660'>so</span>
  <span m='1949810'>this</span> <span m='1950050'>was</span> <span m='1950200'>the</span>
  <span m='1950320'>text.</span> <span m='1950890'>Now</span> <span m='1951160'>we're</span>
  <span m='1951280'>looking</span> <span m='1951580'>at</span> <span m='1951670'>the</span>
  <span m='1951790'>suffix</span> <span m='1952240'>array,</span> <span m='1953320'>which</span>
  <span m='1953500'>has</span> <span m='1953680'>the</span> <span m='1953770'>suffixes</span>
  <span m='1954310'>in</span> <span m='1954460'>sorted</span> <span m='1954850'>order.</span>
  </p><p><span m='1955660'>We're</span> <span m='1955750'>looking</span> <span m='1956020'>at</span>
  <span m='1956080'>position</span> <span m='1956530'>i</span> <span m='1956850'>here,</span>
  <span m='1957650'>and</span> <span m='1957790'>we</span> <span m='1957910'>want</span>
  <span m='1958120'>to</span> <span m='1958180'>know,</span> <span m='1958440'>of</span>
  <span m='1958660'>all</span> <span m='1958900'>of</span> <span m='1958990'>these</span>
  <span m='1959260'>values,</span> <span m='1960250'>which</span> <span m='1960490'>ones</span>
  <span m='1960700'>are</span> <span m='1960790'>even?</span> <span m='1961270'>Or</span>
  <span m='1961360'>how</span> <span m='1961540'>many</span> <span m='1961780'>are</span>
  <span m='1961870'>even--</span> <span m='1962540'>that's</span> <span m='1962740'>the</span>
  <span m='1962830'>even</span> <span m='1963100'>rank.</span> <span m='1964390'>Again,</span>
  <span m='1964720'>a</span> <span m='1964780'>weird</span> <span m='1965050'>thing,</span>
  <span m='1965500'>we'll</span> <span m='1965650'>see</span> <span m='1965860'>why</span>
  <span m='1966040'>it's</span> <span m='1966250'>the</span> <span m='1966370'>right</span>
  <span m='1966550'>thing</span> <span m='1966850'>in</span> <span m='1966970'>a</span>
  <span m='1967030'>moment.</span> </p><p><span m='1975760'>Right</span> <span m='1975940'>now,</span>
  <span m='1976180'>in</span> <span m='1976270'>fact.</span> <span m='1982440'>So</span>
  <span m='1982860'>here</span> <span m='1983240'>is</span> <span m='1984240'>observation</span>
  <span m='1984495'>3,</span> <span m='1984960'>putting</span> <span m='1985290'>these</span>
  <span m='1985440'>together.</span> <span m='1987900'>This</span> <span m='1988080'>is</span>
  <span m='1988230'>a</span> <span m='1988320'>rather</span> <span m='1988680'>long</span>
  <span m='1989040'>equation.</span> <span m='1992040'>Ultimately,</span> <span m='1992550'>I</span>
  <span m='1992670'>want</span> <span m='1992880'>to</span> <span m='1992940'>know--</span>
  <span m='1993510'>I</span> <span m='1993570'>want</span> <span m='1993720'>to</span>
  <span m='1993780'>represent</span> <span m='1994290'>Sk</span> <span m='1995510'>of</span>
  <span m='1995900'>i.</span> <span m='1996260'>I'm</span> <span m='1996355'>trying</span>
  <span m='1996450'>to</span> <span m='1996540'>represent</span> <span m='1996960'>that.</span>
  </p><p><span m='1997830'>And</span> <span m='1998040'>I</span> <span m='1998100'>want</span>
  <span m='1998340'>the</span> <span m='1998460'>right-hand</span> <span m='1998820'>side</span>
  <span m='1999060'>to</span> <span m='1999120'>only</span> <span m='1999390'>refer</span>
  <span m='1999690'>to</span> <span m='1999780'>SA</span> <span m='2000080'>k</span>
  <span m='2000630'>plus</span> <span m='2000890'>1.</span> <span m='2002090'>So</span>
  <span m='2002230'>here's</span> <span m='2002480'>the</span> <span m='2002580'>claim.</span>
  <span m='2004280'>Take</span> <span m='2004520'>2</span> <span m='2004850'>times</span>
  <span m='2006470'>SA</span> <span m='2006960'>k</span> <span m='2007220'>plus</span>
  <span m='2007520'>1</span> <span m='2008240'>of--</span> <span m='2015290'>I'm</span>
  <span m='2015357'>going</span> <span m='2015424'>to</span> <span m='2015491'>need</span>
  <span m='2015910'>another</span> <span m='2016160'>board.</span> <span m='2030240'>Not</span>
  <span m='2030495'>of</span> <span m='2030750'>i.</span> <span m='2031830'>Even</span>
  <span m='2032160'>rank</span> <span m='2033480'>of</span> <span m='2033930'>even</span>
  <span m='2034230'>successor</span> <span m='2036630'>of</span> <span m='2036855'>i,</span>
  <span m='2039540'>minus</span> <span m='2041340'>1</span> <span m='2041880'>minus</span>
  <span m='2043110'>is</span> <span m='2043650'>even</span> <span m='2048040'>suffix</span>
  <span m='2051650'>of</span> <span m='2052130'>i.</span> </p><p><span m='2054060'>OK,</span>
  <span m='2054270'>so</span> <span m='2054480'>that's</span> <span m='2054929'>the</span>
  <span m='2055050'>equation.</span> <span m='2056320'>Let</span> <span m='2056429'>me</span>
  <span m='2056610'>unpack</span> <span m='2057060'>this</span> <span m='2057270'>a</span>
  <span m='2057300'>little</span> <span m='2057540'>bit.</span> <span m='2059580'>The</span>
  <span m='2059670'>idea</span> <span m='2059969'>is,</span> <span m='2060600'>we</span>
  <span m='2060750'>want</span> <span m='2060960'>to</span> <span m='2061020'>know</span>
  <span m='2061170'>about</span> <span m='2061350'>a</span> <span m='2061409'>suffix</span>
  <span m='2061900'>i.</span> <span m='2062240'>If</span> <span m='2062580'>i</span>
  <span m='2062730'>happens</span> <span m='2063120'>to</span> <span m='2063239'>be</span>
  <span m='2063420'>even--</span> <span m='2064080'>sorry,</span> <span m='2064350'>not</span>
  <span m='2064530'>if</span> <span m='2064650'>i</span> <span m='2064860'>happens</span>
  <span m='2065110'>to</span> <span m='2065179'>be</span> <span m='2065290'>even--</span>
  <span m='2065520'>if</span> <span m='2065699'>SA</span> <span m='2066120'>of</span>
  <span m='2066239'>i</span> <span m='2066929'>happens</span> <span m='2067290'>to</span>
  <span m='2067380'>be</span> <span m='2067469'>even,</span> <span m='2068610'>we're</span>
  <span m='2069000'>golden.</span> <span m='2069510'>Because</span> <span m='2070020'>that</span>
  <span m='2070290'>suffix</span> <span m='2070739'>is</span> <span m='2070889'>represented</span>
  <span m='2071550'>by</span> <span m='2071739'>SA</span> <span m='2071994'>k</span>
  <span m='2072250'>plus</span> <span m='2072570'>1,</span> <span m='2073260'>but</span>
  <span m='2073440'>it</span> <span m='2073530'>might</span> <span m='2073710'>not</span>
  <span m='2073889'>be</span> <span m='2074040'>even.</span> </p><p><span m='2074429'>So</span>
  <span m='2074639'>we</span> <span m='2074760'>want</span> <span m='2074909'>to</span>
  <span m='2075000'>round</span> <span m='2075420'>it</span> <span m='2076080'>to</span>
  <span m='2076230'>an</span> <span m='2076350'>even</span> <span m='2076650'>suffix.</span>
  <span m='2078120'>Knowing</span> <span m='2078449'>about</span> <span m='2078750'>this</span>
  <span m='2079230'>odd</span> <span m='2079440'>suffix</span> <span m='2079920'>is</span>
  <span m='2080130'>just</span> <span m='2080370'>about</span> <span m='2080610'>as</span>
  <span m='2080730'>good</span> <span m='2081150'>as</span> <span m='2081330'>knowing</span>
  <span m='2081630'>about</span> <span m='2082290'>the</span> <span m='2082350'>suffix</span>
  <span m='2082739'>that</span> <span m='2082830'>starts</span> <span m='2083100'>right</span>
  <span m='2083280'>after</span> <span m='2083610'>it.</span> <span m='2084340'>So</span>
  <span m='2084389'>that's</span> <span m='2084630'>what</span> <span m='2084750'>even</span>
  <span m='2085020'>successor</span> <span m='2085500'>does.</span> <span m='2086310'>This</span>
  <span m='2086580'>is</span> <span m='2087900'>rounding</span> <span m='2090360'>to</span>
  <span m='2090719'>an</span> <span m='2090840'>even</span> <span m='2091139'>suffix,</span>
  <span m='2091620'>meaning</span> <span m='2092590'>a</span> <span m='2092690'>suffix</span>
  <span m='2093090'>starting</span> <span m='2093960'>at</span> <span m='2094110'>an</span>
  <span m='2094199'>even</span> <span m='2094469'>position.</span> </p><p><span m='2099870'>Now</span>
  <span m='2100440'>there's</span> <span m='2100710'>this</span> <span m='2101040'>issue</span>
  <span m='2101520'>that</span> <span m='2102810'>over</span> <span m='2103110'>here,</span>
  <span m='2104730'>we</span> <span m='2104820'>have</span> <span m='2104940'>this</span>
  <span m='2105090'>relation</span> <span m='2105510'>between</span> <span m='2105810'>SA</span>
  <span m='2106125'>k</span> <span m='2106440'>and</span> <span m='2106560'>SA</span>
  <span m='2106660'>k</span> <span m='2106980'>plus</span> <span m='2107250'>1,</span>
  <span m='2108630'>but</span> <span m='2109140'>it</span> <span m='2109560'>extracts</span>
  <span m='2110340'>the</span> <span m='2110460'>even</span> <span m='2110760'>entries.</span>
  <span m='2111970'>So</span> <span m='2111990'>if</span> <span m='2112080'>you</span>
  <span m='2112170'>think</span> <span m='2112410'>about</span> <span m='2113110'>the</span>
  <span m='2113210'>suffix</span> <span m='2113580'>array,</span> <span m='2113880'>which</span>
  <span m='2114130'>now</span> <span m='2114240'>I'm</span> <span m='2114300'>going</span>
  <span m='2114360'>to</span> <span m='2114450'>draw</span> <span m='2114640'>a</span>
  <span m='2114670'>vertical,</span> <span m='2115230'>because</span> <span m='2115470'>that's</span>
  <span m='2115650'>more</span> <span m='2115860'>normal.</span> </p><p><span m='2119580'>Some</span>
  <span m='2120000'>of</span> <span m='2120090'>these</span> <span m='2120300'>values</span>
  <span m='2120720'>are</span> <span m='2120780'>going</span> <span m='2120880'>to</span>
  <span m='2120960'>be</span> <span m='2121080'>even,</span> <span m='2122580'>but</span>
  <span m='2122730'>you</span> <span m='2122820'>don't</span> <span m='2122970'>really</span>
  <span m='2123180'>know</span> <span m='2123360'>which</span> <span m='2123540'>ones</span>
  <span m='2123750'>are</span> <span m='2123810'>going</span> <span m='2123920'>to</span>
  <span m='2124020'>be</span> <span m='2124110'>even.</span> <span m='2124380'>It's</span>
  <span m='2124530'>arbitrary</span> <span m='2125010'>subset</span> <span m='2125790'>of--</span>
  <span m='2126530'>in</span> <span m='2126740'>SA</span> <span m='2127120'>k,</span>
  <span m='2127980'>our</span> <span m='2128190'>even</span> <span m='2128490'>values.</span>
  <span m='2129630'>And</span> <span m='2129810'>those</span> <span m='2130170'>are</span>
  <span m='2130230'>the</span> <span m='2130350'>ones</span> <span m='2131280'>that</span>
  <span m='2131400'>you</span> <span m='2131520'>extract</span> <span m='2132660'>and</span>
  <span m='2132840'>form</span> <span m='2133900'>SA</span> <span m='2134310'>k</span>
  <span m='2134670'>plus</span> <span m='2134910'>1.</span> <span m='2135950'>But</span>
  <span m='2136170'>it's</span> <span m='2136290'>an</span> <span m='2136380'>arbitrary</span>
  <span m='2136920'>subset,</span> <span m='2137370'>that's</span> <span m='2137550'>kind</span>
  <span m='2137760'>of</span> <span m='2137920'>a--</span> <span m='2138600'>you</span>
  <span m='2138720'>can't</span> <span m='2138930'>just</span> <span m='2139260'>divide</span>
  <span m='2139560'>by</span> <span m='2139740'>2</span> <span m='2140040'>or</span>
  <span m='2140130'>something.</span> <span m='2140550'>It's</span> <span m='2140790'>not</span>
  <span m='2141330'>the</span> <span m='2141420'>right</span> <span m='2141570'>thing.</span>
  </p><p><span m='2142140'>If</span> <span m='2142260'>I'm</span> <span m='2142410'>given</span>
  <span m='2142740'>an</span> <span m='2142830'>index</span> <span m='2143280'>into</span>
  <span m='2143460'>here,</span> <span m='2143730'>even</span> <span m='2144000'>if</span>
  <span m='2144120'>it's</span> <span m='2144210'>an</span> <span m='2144330'>even</span>
  <span m='2144660'>one,</span> <span m='2145680'>I</span> <span m='2145770'>need</span>
  <span m='2145950'>to</span> <span m='2146100'>know</span> <span m='2146730'>what</span>
  <span m='2146910'>the</span> <span m='2147000'>corresponding</span> <span m='2147780'>index</span>
  <span m='2148200'>is</span> <span m='2148470'>over</span> <span m='2148740'>here.</span>
  <span m='2150270'>And</span> <span m='2150450'>that,</span> <span m='2150780'>I</span>
  <span m='2150870'>claim,</span> <span m='2151170'>is</span> <span m='2151260'>exactly</span>
  <span m='2151710'>even</span> <span m='2152010'>rank.</span> <span m='2153390'>Because</span>
  <span m='2154350'>what</span> <span m='2155310'>position</span> <span m='2156330'>does</span>
  <span m='2156570'>this</span> <span m='2156840'>cell</span> <span m='2157260'>become</span>
  <span m='2157800'>over</span> <span m='2158070'>here?</span> </p><p><span m='2159090'>Well,</span>
  <span m='2160170'>however</span> <span m='2160590'>many</span> <span m='2160890'>even</span>
  <span m='2161160'>numbers</span> <span m='2161550'>there</span> <span m='2161670'>are</span>
  <span m='2161790'>above</span> <span m='2162030'>it.</span> <span m='2163140'>So</span>
  <span m='2163290'>you</span> <span m='2163380'>take--</span> <span m='2164450'>that's</span>
  <span m='2164640'>what</span> <span m='2164760'>this</span> <span m='2164910'>definition</span>
  <span m='2165390'>was,</span> <span m='2165550'>a</span> <span m='2165580'>number</span>
  <span m='2165840'>of</span> <span m='2165900'>even</span> <span m='2166170'>values</span>
  <span m='2166620'>in</span> <span m='2166800'>that</span> <span m='2166980'>prefix.</span>
  <span m='2168060'>That</span> <span m='2168330'>is</span> <span m='2168660'>the</span>
  <span m='2168810'>position</span> <span m='2169260'>you</span> <span m='2169380'>will</span>
  <span m='2169500'>be</span> <span m='2169750'>in,</span> <span m='2170290'>in</span>
  <span m='2170520'>SA</span> <span m='2170840'>k</span> <span m='2171060'>plus</span>
  <span m='2171300'>1.</span> </p><p><span m='2172360'>So</span> <span m='2172410'>this</span>
  <span m='2172620'>is</span> <span m='2172740'>what</span> <span m='2172890'>I</span>
  <span m='2172980'>would</span> <span m='2173160'>call</span> <span m='2174210'>the</span>
  <span m='2174600'>name--</span> <span m='2175510'>we've</span> <span m='2175860'>now</span>
  <span m='2176070'>rounded</span> <span m='2176430'>to</span> <span m='2176550'>an</span>
  <span m='2176640'>even</span> <span m='2176850'>suffix</span> <span m='2177340'>but</span>
  <span m='2177480'>now</span> <span m='2177630'>we</span> <span m='2177720'>need</span>
  <span m='2177840'>to</span> <span m='2177930'>find</span> <span m='2178170'>the</span>
  <span m='2178260'>name</span> <span m='2178650'>of</span> <span m='2178800'>that</span>
  <span m='2179460'>even</span> <span m='2179760'>suffix--</span> <span m='2181530'>in</span>
  <span m='2181820'>SA</span> <span m='2182190'>k</span> <span m='2182380'>plus</span>
  <span m='2182610'>1.</span> <span m='2185070'>So</span> <span m='2185220'>that's</span>
  <span m='2185430'>exactly</span> <span m='2186100'>what</span> <span m='2186370'>even</span>
  <span m='2187350'>rank</span> <span m='2187710'>does.</span> <span m='2189120'>So</span>
  <span m='2189270'>now</span> <span m='2189510'>we</span> <span m='2189630'>can</span>
  <span m='2189780'>dereference</span> <span m='2190320'>SA</span> <span m='2190585'>k</span>
  <span m='2191100'>plus</span> <span m='2191340'>1</span> <span m='2191910'>of</span>
  <span m='2192090'>that</span> <span m='2192300'>thing.</span> </p><p><span m='2193050'>That</span>
  <span m='2193290'>will</span> <span m='2193410'>give</span> <span m='2193620'>us</span>
  <span m='2193770'>a</span> <span m='2193890'>position</span> <span m='2195300'>into</span>
  <span m='2195720'>the</span> <span m='2195870'>text</span> <span m='2197580'>T</span>
  <span m='2197850'>k</span> <span m='2198120'>plus</span> <span m='2198450'>1,</span>
  <span m='2200550'>where</span> <span m='2200760'>that</span> <span m='2200970'>suffix</span>
  <span m='2201360'>begins.</span> <span m='2202830'>Now</span> <span m='2203280'>that's</span>
  <span m='2203580'>an</span> <span m='2203850'>index</span> <span m='2204810'>into</span>
  <span m='2205110'>this</span> <span m='2206790'>divided</span> <span m='2207180'>by</span>
  <span m='2207360'>2</span> <span m='2207600'>string,</span> <span m='2207960'>we</span>
  <span m='2208050'>need</span> <span m='2208170'>to</span> <span m='2208320'>uncompress</span>
  <span m='2208980'>that</span> <span m='2209280'>to</span> <span m='2209580'>an</span>
  <span m='2209700'>index</span> <span m='2210090'>into</span> <span m='2210270'>the</span>
  <span m='2210420'>actual</span> <span m='2210870'>string.</span> </p><p><span m='2211710'>And</span>
  <span m='2211800'>there</span> <span m='2211890'>are</span> <span m='2211920'>two</span>
  <span m='2212100'>parts.</span> <span m='2212560'>One</span> <span m='2212640'>is</span>
  <span m='2212730'>we</span> <span m='2212850'>need</span> <span m='2213000'>to</span>
  <span m='2213120'>multiply</span> <span m='2213570'>by</span> <span m='2213750'>2,</span>
  <span m='2214020'>because</span> <span m='2214320'>every</span> <span m='2214560'>letter</span>
  <span m='2214950'>in</span> <span m='2215070'>T k</span> <span m='2215370'>plus</span>
  <span m='2215610'>1</span> <span m='2215850'>is</span> <span m='2215970'>two</span>
  <span m='2216180'>letters</span> <span m='2216540'>in</span> <span m='2216670'>Tk.</span>
  <span m='2217770'>So</span> <span m='2217890'>multiply</span> <span m='2218280'>by</span>
  <span m='2218430'>2.</span> <span m='2218670'>And</span> <span m='2218760'>sometimes</span>
  <span m='2219300'>we</span> <span m='2219390'>need</span> <span m='2219540'>to</span>
  <span m='2219630'>subtract</span> <span m='2220170'>1.</span> <span m='2221070'>We</span>
  <span m='2221160'>basically</span> <span m='2221490'>need</span> <span m='2221640'>to</span>
  <span m='2221730'>subtract</span> <span m='2222180'>1</span> <span m='2222450'>if</span>
  <span m='2223490'>if</span> <span m='2223710'>even</span> <span m='2223980'>successor</span>
  <span m='2224460'>did</span> <span m='2224670'>anything.</span> <span m='2225505'>If</span>
  <span m='2225870'>even</span> <span m='2226170'>successor</span> <span m='2226650'>essentially</span>
  <span m='2227070'>moved</span> <span m='2227310'>us</span> <span m='2227460'>to</span>
  <span m='2227550'>the</span> <span m='2227670'>right</span> <span m='2227910'>by</span>
  <span m='2228090'>1,</span> <span m='2228790'>now</span> <span m='2228870'>we</span>
  <span m='2228930'>need</span> <span m='2229080'>to</span> <span m='2229170'>move</span>
  <span m='2229350'>back</span> <span m='2229620'>to</span> <span m='2229740'>the</span>
  <span m='2229830'>left</span> <span m='2230040'>by</span> <span m='2230190'>1,</span>
  <span m='2230550'>if</span> <span m='2231270'>this</span> <span m='2231450'>moved</span>
  <span m='2231710'>us</span> <span m='2231900'>at</span> <span m='2231990'>all.</span>
  </p><p><span m='2233080'>So</span> <span m='2233190'>I</span> <span m='2233250'>have</span>
  <span m='2233430'>one</span> <span m='2233610'>more</span> <span m='2233790'>function</span>
  <span m='2234150'>here,</span> <span m='2234300'>which is</span> <span m='2234630'>is</span>
  <span m='2234870'>even</span> <span m='2235140'>suffix.</span> <span m='2235620'>Was</span>
  <span m='2237870'>SA</span> <span m='2238350'>of</span> <span m='2238490'>i</span>
  <span m='2238860'>an</span> <span m='2238987'>even--</span> <span m='2239670'>SA</span>
  <span m='2239910'>sub</span> <span m='2240190'>k</span> <span m='2240470'>of</span>
  <span m='2240630'>i,</span> <span m='2240810'>an</span> <span m='2240900'>even</span>
  <span m='2241230'>number</span> <span m='2241530'>already.</span> <span m='2242490'>Which</span>
  <span m='2242670'>means</span> <span m='2242970'>that</span> <span m='2243180'>even</span>
  <span m='2243480'>successor</span> <span m='2243960'>did</span> <span m='2244170'>nothing.</span>
  </p><p><span m='2245580'>If</span> <span m='2245730'>it</span> <span m='2245790'>did</span>
  <span m='2245970'>nothing,</span> <span m='2247890'>then</span> <span m='2248250'>1</span>
  <span m='2248490'>minus</span> <span m='2248730'>1</span> <span m='2248970'>is</span>
  <span m='2249630'>0.,</span> <span m='2250180'>and</span> <span m='2250290'>so</span>
  <span m='2250440'>nothing</span> <span m='2250740'>happens.</span> <span m='2251550'>If</span>
  <span m='2251730'>it</span> <span m='2251820'>did</span> <span m='2252030'>something,</span>
  <span m='2252600'>then</span> <span m='2252910'>its</span> <span m='2253140'>even</span>
  <span m='2253380'>suffix</span> <span m='2253800'>will</span> <span m='2253920'>be</span>
  <span m='2254070'>0,</span> <span m='2254580'>because</span> <span m='2254760'>it</span>
  <span m='2254850'>was</span> <span m='2255060'>odd.</span> <span m='2255780'>And</span>
  <span m='2255900'>then</span> <span m='2256020'>we're</span> <span m='2256110'>subtracting</span>
  <span m='2256680'>1.</span> <span m='2257250'>So</span> <span m='2257400'>this</span>
  <span m='2257600'>just</span> <span m='2257730'>means</span> <span m='2257970'>subtract</span>
  <span m='2258510'>1,</span> <span m='2259200'>if</span> <span m='2259350'>it</span>
  <span m='2259410'>was</span> <span m='2259590'>odd.</span> </p><p><span m='2260550'>You</span>
  <span m='2260670'>might</span> <span m='2260880'>say</span> <span m='2261300'>minus</span>
  <span m='2261930'>is</span> <span m='2262140'>odd</span> <span m='2262350'>suffix,</span>
  <span m='2262800'>instead</span> <span m='2263070'>of</span> <span m='2263130'>1</span>
  <span m='2263310'>minus</span> <span m='2263640'>is</span> <span m='2263820'>even</span>
  <span m='2264090'>suffix.</span> <span m='2264510'>But</span> <span m='2264950'>it</span>
  <span m='2265020'>turns</span> <span m='2265230'>out,</span> <span m='2265380'>this</span>
  <span m='2265590'>is</span> <span m='2265710'>the</span> <span m='2265800'>thing</span>
  <span m='2266010'>I</span> <span m='2266100'>want</span> <span m='2266250'>to</span>
  <span m='2266340'>store,</span> <span m='2267330'>so</span> <span m='2267500'>I</span>
  <span m='2267600'>wrote</span> <span m='2267780'>it</span> <span m='2267870'>in</span>
  <span m='2267990'>a</span> <span m='2268050'>weird</span> <span m='2268290'>way.</span>
  <span m='2270540'>Why</span> <span m='2270750'>did</span> <span m='2270900'>I</span>
  <span m='2270960'>write</span> <span m='2271170'>it</span> <span m='2271260'>that</span>
  <span m='2271440'>way?</span> <span m='2271590'>Because</span> <span m='2272760'>is</span>
  <span m='2273030'>even</span> <span m='2273270'>suffix</span> <span m='2274380'>is</span>
  <span m='2274530'>related</span> <span m='2274950'>to</span> <span m='2275760'>even</span>
  <span m='2276090'>rank.</span> </p><p><span m='2277380'>Even</span> <span m='2277710'>rank</span>
  <span m='2278160'>is</span> <span m='2278340'>just</span> <span m='2278940'>rank</span>
  <span m='2279270'>sub</span> <span m='2279540'>1</span> <span m='2280410'>of</span>
  <span m='2280770'>is</span> <span m='2281130'>even</span> <span m='2281430'>suffix.</span>
  <span m='2284040'>And</span> <span m='2284190'>we</span> <span m='2284280'>already</span>
  <span m='2284520'>saw</span> <span m='2284880'>how</span> <span m='2284970'>to</span>
  <span m='2285090'>do</span> <span m='2285210'>rank</span> <span m='2285420'>sub</span>
  <span m='2285670'>1,</span> <span m='2285900'>and</span> <span m='2285990'>so</span>
  <span m='2286140'>that's</span> <span m='2286320'>why</span> <span m='2286470'>I</span>
  <span m='2286500'>wanted</span> <span m='2286740'>to</span> <span m='2286860'>reuse</span>
  <span m='2287160'>it.</span> <span m='2289650'>I</span> <span m='2289740'>think</span>
  <span m='2289980'>you</span> <span m='2290070'>see</span> <span m='2290310'>now</span>
  <span m='2290580'>why</span> <span m='2290700'>this</span> <span m='2290850'>equation</span>
  <span m='2291210'>holds.</span> <span m='2292800'>What</span> <span m='2293040'>remains</span>
  <span m='2293550'>is</span> <span m='2293730'>how</span> <span m='2293940'>to</span>
  <span m='2294030'>store</span> <span m='2295830'>is</span> <span m='2296040'>even</span>
  <span m='2296280'>suffix,</span> <span m='2296820'>even</span> <span m='2297120'>rank,</span>
  <span m='2297690'>even</span> <span m='2297930'>successor.</span> </p><p><span m='2303340'>One</span>
  <span m='2303830'>other</span> <span m='2304280'>thing</span> <span m='2304460'>that</span>
  <span m='2304580'>remains,</span> <span m='2305030'>is</span> <span m='2305150'>to</span>
  <span m='2305300'>say</span> <span m='2306590'>when</span> <span m='2306890'>to</span>
  <span m='2307010'>stop</span> <span m='2307370'>this</span> <span m='2307550'>recursion.</span>
  <span m='2309240'>So</span> <span m='2309320'>I</span> <span m='2309440'>claim</span>
  <span m='2309770'>it's</span> <span m='2309920'>enough</span> <span m='2310250'>to</span>
  <span m='2310370'>just</span> <span m='2310550'>do</span> <span m='2310760'>this</span>
  <span m='2311450'>recursion</span> <span m='2312080'>for</span> <span m='2312320'>log</span>
  <span m='2312680'>log</span> <span m='2312950'>n</span> <span m='2313100'>levels.</span>
  <span m='2323900'>And</span> <span m='2324050'>then</span> <span m='2324120'>I'll</span>
  <span m='2324300'>call</span> <span m='2324730'>log</span> <span m='2324800'>log</span>
  <span m='2324920'>n</span> <span m='2325490'>l,</span> <span m='2326355'>the</span>
  <span m='2326720'>number</span> <span m='2326900'>of</span> <span m='2326990'>levels</span>
  <span m='2327320'>in</span> <span m='2327380'>this</span> <span m='2327530'>recursion.</span>
  </p><p><span m='2328620'>Because</span> <span m='2328970'>at</span> <span m='2329120'>that</span>
  <span m='2329330'>point,</span> <span m='2330670'>n</span> <span m='2331000'>sub</span>
  <span m='2331160'>l</span> <span m='2331670'>equals</span> <span m='2332270'>n</span>
  <span m='2332600'>over--</span> <span m='2333440'>it's</span> <span m='2333545'>n</span>
  <span m='2333650'>over</span> <span m='2333890'>2</span> <span m='2334085'>to</span>
  <span m='2334280'>the</span> <span m='2334460'>l,</span> <span m='2334735'>so</span>
  <span m='2335010'>that's</span> <span m='2335210'>going</span> <span m='2335330'>to</span>
  <span m='2335390'>be</span> <span m='2335510'>n</span> <span m='2335750'>over</span>
  <span m='2335920'>log</span> <span m='2336090'>n.</span> <span m='2337760'>Once</span>
  <span m='2338120'>I</span> <span m='2338240'>have</span> <span m='2338630'>a</span>
  <span m='2338690'>string</span> <span m='2339170'>of</span> <span m='2339290'>length</span>
  <span m='2339560'>n</span> <span m='2339740'>over</span> <span m='2339945'>log</span>
  <span m='2340150'>n,</span> <span m='2340880'>I</span> <span m='2340970'>can</span>
  <span m='2341180'>afford</span> <span m='2341900'>the</span> <span m='2342050'>regular</span>
  <span m='2342650'>boring</span> <span m='2343160'>representation</span> <span m='2344600'>of</span>
  <span m='2349570'>a</span> <span m='2349690'>suffix</span> <span m='2350110'>tree.</span>
  <span m='2351310'>I</span> <span m='2351430'>can</span> <span m='2351580'>afford</span>
  <span m='2352510'>T</span> <span m='2352750'>log</span> <span m='2352990'>T</span>
  <span m='2353170'>bits,</span> <span m='2354010'>when</span> <span m='2354230'>T</span>
  <span m='2354640'>is</span> <span m='2354910'>only</span> <span m='2355180'>n</span>
  <span m='2355330'>over</span> <span m='2355660'>log</span> <span m='2355825'>n.</span>
  </p><p><span m='2356560'>If</span> <span m='2356620'>you</span> <span m='2356710'>want</span>
  <span m='2356860'>to</span> <span m='2356950'>be</span> <span m='2357190'>a</span>
  <span m='2357220'>little</span> <span m='2357850'>extra</span> <span m='2358150'>clever,</span>
  <span m='2358790'>you</span> <span m='2358890'>can</span> <span m='2358990'>put</span>
  <span m='2359020'>a</span> <span m='2359050'>factor</span> <span m='2359380'>2</span>
  <span m='2359620'>here,</span> <span m='2360430'>and</span> <span m='2360610'>then</span>
  <span m='2360730'>there's</span> <span m='2361140'>a</span> <span m='2361170'>square</span>
  <span m='2361660'>here.</span> <span m='2362500'>And</span> <span m='2362590'>so</span>
  <span m='2362710'>then</span> <span m='2362860'>you're</span> <span m='2362980'>really</span>
  <span m='2363220'>paying</span> <span m='2363490'>little</span> <span m='2363810'>o</span>
  <span m='2364070'>of</span> <span m='2364360'>T</span> <span m='2365140'>in</span>
  <span m='2365290'>order</span> <span m='2365440'>to</span> <span m='2365560'>store</span>
  <span m='2365800'>that</span> <span m='2365980'>thing.</span> <span m='2367700'>So</span>
  <span m='2367810'>once</span> <span m='2368020'>you</span> <span m='2368110'>get</span>
  <span m='2368230'>down</span> <span m='2368350'>to</span> <span m='2368470'>here,</span>
  <span m='2368710'>you</span> <span m='2368860'>can</span> <span m='2369100'>afford</span>
  <span m='2369690'>a</span> <span m='2369760'>simple</span> <span m='2370120'>representation.</span>
  </p><p><span m='2371510'>Now</span> <span m='2371650'>let's</span> <span m='2371860'>think</span>
  <span m='2372070'>about</span> <span m='2372790'>how</span> <span m='2373000'>to</span>
  <span m='2373090'>compute</span> <span m='2374470'>SA,</span> <span m='2376210'>like</span>
  <span m='2376390'>the</span> <span m='2376480'>original</span> <span m='2376990'>SA,</span>
  <span m='2377560'>sub</span> <span m='2377920'>0,</span> <span m='2378780'>of</span>
  <span m='2378970'>an</span> <span m='2379090'>index.</span> <span m='2380360'>Well</span>
  <span m='2381730'>I</span> <span m='2381910'>apply</span> <span m='2383380'>this</span>
  <span m='2383590'>formula</span> <span m='2384670'>at</span> <span m='2384760'>all</span>
  <span m='2384970'>times,</span> <span m='2386740'>I</span> <span m='2386830'>do</span>
  <span m='2387040'>all</span> <span m='2387170'>these</span> <span m='2387340'>computations.</span>
  <span m='2389690'>And</span> <span m='2389770'>now</span> <span m='2389950'>I've</span>
  <span m='2390070'>reduced</span> <span m='2390340'>the</span> <span m='2390460'>problem</span>
  <span m='2390790'>to</span> <span m='2391570'>SA</span> <span m='2392320'>1,</span>
  <span m='2393080'>and</span> <span m='2393090'>then</span> <span m='2393100'>I</span>
  <span m='2393190'>do</span> <span m='2393370'>these</span> <span m='2393550'>computations.</span>
  <span m='2394180'>I</span> <span m='2394240'>reduce</span> <span m='2394510'>it</span>
  <span m='2394600'>to</span> <span m='2394690'>SA</span> <span m='2394960'>2,</span>
  <span m='2395290'>and</span> <span m='2395380'>so</span> <span m='2395590'>on.</span>
  </p><p><span m='2396170'>After</span> <span m='2396480'>l</span> <span m='2396610'>steps,</span>
  <span m='2397840'>I'll</span> <span m='2397900'>have</span> <span m='2398020'>reduced</span>
  <span m='2398380'>it</span> <span m='2398500'>to</span> <span m='2398830'>an</span>
  <span m='2398980'>SA</span> <span m='2399340'>query</span> <span m='2400350'>in</span>
  <span m='2400540'>a</span> <span m='2400600'>boring</span> <span m='2401050'>old</span>
  <span m='2401230'>suffix</span> <span m='2401650'>array,</span> <span m='2401890'>which</span>
  <span m='2402070'>I've</span> <span m='2402160'>just</span> <span m='2402310'>stored</span>
  <span m='2402610'>as</span> <span m='2402730'>an</span> <span m='2402850'>array.</span>
  <span m='2404090'>So</span> <span m='2404110'>then</span> <span m='2404260'>I</span>
  <span m='2404320'>can</span> <span m='2404440'>answer</span> <span m='2404800'>it,</span>
  <span m='2405250'>and</span> <span m='2405370'>then</span> <span m='2405520'>I</span>
  <span m='2405610'>pop</span> <span m='2405940'>up</span> <span m='2406090'>the</span>
  <span m='2406180'>recursion,</span> <span m='2407160'>log</span> <span m='2407500'>log</span>
  <span m='2407635'>n</span> <span m='2407770'>times,</span> <span m='2408760'>doing</span>
  <span m='2409120'>these</span> <span m='2409270'>adjustments</span> <span m='2409810'>as</span>
  <span m='2409990'>appropriate.</span> <span m='2411460'>In</span> <span m='2411550'>the</span>
  <span m='2411700'>end,</span> <span m='2411880'>I</span> <span m='2412030'>get</span>
  <span m='2412300'>the</span> <span m='2412540'>correct</span> <span m='2413080'>index</span>
  <span m='2413770'>into</span> <span m='2414010'>the</span> <span m='2414130'>original</span>
  <span m='2414580'>text</span> <span m='2414970'>T.</span> </p><p><span m='2415780'>How</span>
  <span m='2415900'>much</span> <span m='2416110'>time</span> <span m='2416350'>did</span>
  <span m='2416470'>it</span> <span m='2416560'>take?</span> <span m='2417850'>Order</span>
  <span m='2418180'>log</span> <span m='2418450'>log</span> <span m='2418660'>n</span>
  <span m='2418840'>time.</span> <span m='2423640'>So</span> <span m='2423760'>I</span>
  <span m='2423820'>can</span> <span m='2423970'>do</span> <span m='2424120'>a</span>
  <span m='2424150'>log</span> <span m='2424450'>log</span> <span m='2424690'>n</span>
  <span m='2425440'>time</span> <span m='2425740'>query</span> <span m='2429070'>to</span>
  <span m='2429650'>SA.</span> <span m='2434740'>This</span> <span m='2434980'>is,</span>
  <span m='2435230'>of</span> <span m='2435330'>course,</span> <span m='2435560'>assuming</span>
  <span m='2435940'>that</span> <span m='2436060'>even</span> <span m='2436360'>rank,</span>
  <span m='2436750'>even</span> <span m='2436990'>successor,</span> <span m='2437940'>and</span>
  <span m='2438130'>is</span> <span m='2438340'>even</span> <span m='2438580'>suffix</span>
  <span m='2439000'>are</span> <span m='2439090'>all</span> <span m='2439240'>constant</span>
  <span m='2439780'>time</span> <span m='2440050'>operations.</span> </p><p><span
  m='2442030'>So</span> <span m='2442540'>what</span> <span m='2442690'>remains</span>
  <span m='2443170'>is</span> <span m='2443290'>to</span> <span m='2443410'>do</span>
  <span m='2443710'>each</span> <span m='2443890'>of</span> <span m='2443950'>these</span>
  <span m='2444340'>in</span> <span m='2444460'>small</span> <span m='2444820'>space</span>
  <span m='2445540'>and</span> <span m='2445690'>constant</span> <span m='2446050'>time.</span>
  <span m='2446740'>Then</span> <span m='2446950'>my</span> <span m='2447070'>overall</span>
  <span m='2447460'>query</span> <span m='2447700'>time</span> <span m='2447970'>will</span>
  <span m='2448060'>only</span> <span m='2448270'>go</span> <span m='2448420'>up</span>
  <span m='2448510'>by</span> <span m='2448690'>log</span> <span m='2448990'>log</span>
  <span m='2449200'>factor.</span> <span m='2450790'>This</span> <span m='2451000'>is</span>
  <span m='2451090'>actually</span> <span m='2451330'>going</span> <span m='2451480'>to</span>
  <span m='2451540'>be</span> <span m='2451690'>pretty</span> <span m='2451960'>good,</span>
  <span m='2452830'>we're</span> <span m='2452980'>not</span> <span m='2453100'>going</span>
  <span m='2453220'>to--</span> <span m='2454470'>we're</span> <span m='2454570'>going</span>
  <span m='2454680'>to</span> <span m='2454760'>achieve</span> <span m='2455060'>log</span>
  <span m='2455270'>log</span> <span m='2455440'>query</span> <span m='2456550'>when</span>
  <span m='2456700'>we</span> <span m='2456820'>have</span> <span m='2457130'>T log</span>
  <span m='2457480'>log</span> <span m='2457810'>T</span> <span m='2457930'>bits.</span>
  </p><p><span m='2459920'>That'll</span> <span m='2460090'>be</span> <span m='2460210'>our</span>
  <span m='2460300'>first</span> <span m='2460570'>encoding</span> <span m='2461020'>of</span>
  <span m='2461110'>these</span> <span m='2461290'>things.</span> <span m='2462150'>Later</span>
  <span m='2462450'>on,</span> <span m='2462550'>we're</span> <span m='2462620'>going</span>
  <span m='2462850'>have</span> <span m='2462880'>to</span> <span m='2462910'>go</span>
  <span m='2463000'>up</span> <span m='2463090'>to</span> <span m='2463180'>log</span>
  <span m='2463390'>to</span> <span m='2463480'>the</span> <span m='2463600'>epsilon,</span>
  <span m='2464150'>which</span> <span m='2464200'>is</span> <span m='2464320'>worse</span>
  <span m='2464650'>than</span> <span m='2465430'>log</span> <span m='2465640'>log</span>
  <span m='2465820'>n.</span> <span m='2468620'>Clear,</span> <span m='2468910'>so</span>
  <span m='2469060'>far?</span> <span m='2469600'>Everything</span> <span m='2469930'>is</span>
  <span m='2470230'>pretty</span> <span m='2470470'>easy</span> <span m='2470800'>at</span>
  <span m='2470890'>this</span> <span m='2471010'>point</span> <span m='2471360'>now.</span>
  <span m='2472750'>It's</span> <span m='2472870'>going</span> <span m='2473020'>to</span>
  <span m='2473080'>remain</span> <span m='2473530'>easy,</span> <span m='2473860'>it's</span>
  <span m='2473980'>just</span> <span m='2474130'>there's</span> <span m='2474280'>a</span>
  <span m='2474370'>lot</span> <span m='2474550'>of</span> <span m='2474640'>pieces</span>
  <span m='2475180'>to</span> <span m='2475300'>the</span> <span m='2475390'>puzzle.</span>
  </p><p><span m='2475780'>This</span> <span m='2475990'>is</span> <span m='2476110'>the</span>
  <span m='2476200'>first--</span> <span m='2476560'>this</span> <span m='2476740'>is</span>
  <span m='2476830'>the</span> <span m='2476920'>big</span> <span m='2477130'>idea.</span>
  <span m='2478300'>Next</span> <span m='2478600'>thing</span> <span m='2479020'>is</span>
  <span m='2479770'>some</span> <span m='2479980'>fancy</span> <span m='2480340'>encoding</span>
  <span m='2480760'>schemes</span> <span m='2481240'>to</span> <span m='2481390'>make</span>
  <span m='2481570'>these</span> <span m='2481840'>things</span> <span m='2482140'>quite</span>
  <span m='2482380'>small.</span> <span m='2482790'>Question?</span> </p><p><span
  m='2483050'>AUDIENCE:</span> <span m='2483490'>[INAUDIBLE]</span> <span m='2483930'>Did
  you</span> <span m='2484370'>say</span> <span m='2484810'>what the</span> <span
  m='2485030'>space</span> <span m='2485250'>[INAUDIBLE]</span> <span m='2485690'>was?</span>
  </p><p><span m='2486640'>ERIK DEMAINE:</span> <span m='2487000'>We</span> <span
  m='2487110'>haven't</span> <span m='2487220'>analyzed</span> <span m='2487330'>space</span>
  <span m='2487420'>yet,</span> <span m='2487510'>because</span> <span m='2487750'>I</span>
  <span m='2487810'>haven't</span> <span m='2487990'>said</span> <span m='2488170'>how</span>
  <span m='2488350'>we're</span> <span m='2488440'>actually</span> <span m='2488710'>storing</span>
  <span m='2489070'>these</span> <span m='2489220'>functions.</span> <span m='2489850'>If</span>
  <span m='2490210'>you</span> <span m='2490300'>stored</span> <span m='2490540'>these</span>
  <span m='2490690'>functions</span> <span m='2491080'>explicitly,</span> <span m='2491620'>you'd</span>
  <span m='2491770'>have</span> <span m='2491890'>bad</span> <span m='2492160'>space,</span>
  <span m='2492520'>probably</span> <span m='2492820'>still</span> <span m='2493000'>T
  log</span> <span m='2493140'>T.</span> <span m='2494020'>But</span> <span m='2494140'>it</span>
  <span m='2494200'>turns</span> <span m='2494440'>out,</span> <span m='2494590'>these</span>
  <span m='2494740'>functions</span> <span m='2495100'>can</span> <span m='2495370'>be</span>
  <span m='2495520'>encoded</span> <span m='2496000'>in</span> <span m='2496090'>a</span>
  <span m='2496150'>clever</span> <span m='2496480'>way,</span> <span m='2497310'>that</span>
  <span m='2497510'>small--</span> <span m='2498400'>smaller,</span> <span m='2499150'>it's</span>
  <span m='2499240'>going</span> <span m='2499360'>to</span> <span m='2499450'>be</span>
  <span m='2499810'>T log</span> <span m='2500020'>log</span> <span m='2500200'>T.</span>
  </p><p><span m='2501610'>And</span> <span m='2503170'>still</span> <span m='2503530'>has</span>
  <span m='2503680'>constant</span> <span m='2504040'>time</span> <span m='2504220'>query.</span>
  </p><p><span m='2504710'>AUDIENCE:</span> <span m='2505200'>Without</span> <span
  m='2505690'>the</span> <span m='2506180'>functions,</span> <span m='2506670'>how</span>
  <span m='2507160'>much</span> <span m='2507490'>space</span> <span m='2507550'>are</span>
  <span m='2507610'>we</span> <span m='2507940'>using?</span> </p><p><span m='2508270'>ERIK
  DEMAINE:</span> <span m='2508540'>Without</span> <span m='2508630'>the</span> <span
  m='2508720'>functions,</span> <span m='2508765'>we're</span> <span m='2508810'>using,</span>
  <span m='2509710'>essentially,</span> <span m='2510130'>no</span> <span m='2510340'>space.</span>
  <span m='2511090'>I</span> <span m='2511180'>guess,</span> <span m='2511810'>at</span>
  <span m='2512470'>the</span> <span m='2512650'>end</span> <span m='2512820'>where</span>
  <span m='2513100'>we're</span> <span m='2513310'>using--</span> <span m='2514390'>the</span>
  <span m='2514510'>only</span> <span m='2514660'>thing</span> <span m='2514810'>we've</span>
  <span m='2514930'>said</span> <span m='2515110'>so</span> <span m='2515260'>far,</span>
  <span m='2515470'>is</span> <span m='2515590'>at</span> <span m='2515710'>the</span>
  <span m='2515830'>end</span> <span m='2515920'>we</span> <span m='2516040'>use</span>
  <span m='2516190'>an</span> <span m='2516280'>explicit</span> <span m='2516760'>suffix</span>
  <span m='2517150'>array.</span> <span m='2518120'>And</span> <span m='2518170'>if</span>
  <span m='2518290'>you</span> <span m='2518530'>set</span> <span m='2518770'>this</span>
  <span m='2518920'>to 2</span> <span m='2519250'>log log</span> <span m='2519520'>T,</span>
  <span m='2520480'>then</span> <span m='2520600'>this</span> <span m='2520750'>would</span>
  <span m='2520840'>be</span> <span m='2521080'>like</span> <span m='2521480'>n</span>
  <span m='2521660'>over</span> <span m='2521860'>log</span> <span m='2522250'>n</span>
  <span m='2522430'>bits</span> <span m='2522670'>of</span> <span m='2522730'>space.</span>
  </p><p><span m='2524010'>Because</span> <span m='2524230'>it's</span> <span m='2524380'>going</span>
  <span m='2524550'>to</span> <span m='2524620'>be</span> <span m='2524740'>this</span>
  <span m='2525140'>times--</span> <span m='2527860'>I</span> <span m='2527920'>mean,</span>
  <span m='2528340'>the</span> <span m='2528490'>space</span> <span m='2528790'>at</span>
  <span m='2528880'>the</span> <span m='2528940'>bottom</span> <span m='2529270'>is</span>
  <span m='2529360'>going</span> <span m='2529440'>to</span> <span m='2529540'>be</span>
  <span m='2529690'>nl</span> <span m='2529825'>log</span> <span m='2530500'>nl.</span>
  <span m='2532980'>That's</span> <span m='2533200'>to</span> <span m='2533620'>store</span>
  <span m='2533920'>an</span> <span m='2533980'>explicit</span> <span m='2534430'>suffix</span>
  <span m='2534820'>array,</span> <span m='2535150'>so</span> <span m='2535290'>it's</span>
  <span m='2535390'>going</span> <span m='2535520'>to</span> <span m='2535600'>be</span>
  <span m='2535750'>this</span> <span m='2536350'>times</span> <span m='2536560'>log</span>
  <span m='2536820'>of</span> <span m='2537080'>this,</span> <span m='2537400'>which</span>
  <span m='2537445'>is</span> <span m='2537490'>going</span> <span m='2537610'>to</span>
  <span m='2537700'>be</span> <span m='2538660'>n</span> <span m='2539650'>over</span>
  <span m='2539830'>log</span> <span m='2540120'>n,</span> <span m='2541180'>if</span>
  <span m='2541360'>we</span> <span m='2541450'>put</span> <span m='2541600'>the</span>
  <span m='2541690'>2</span> <span m='2541930'>in.</span> </p><p><span m='2543190'>So</span>
  <span m='2543340'>that</span> <span m='2543490'>part's</span> <span m='2543790'>really</span>
  <span m='2544000'>cheap,</span> <span m='2544780'>and</span> <span m='2544870'>that's</span>
  <span m='2545080'>little o</span> <span m='2545350'>of</span> <span m='2545530'>n.</span>
  <span m='2546280'>Of</span> <span m='2546400'>course,</span> <span m='2546670'>we</span>
  <span m='2546910'>probably</span> <span m='2547240'>also</span> <span m='2547430'>have</span>
  <span m='2547520'>to</span> <span m='2547600'>store</span> <span m='2547810'>the</span>
  <span m='2547930'>text.</span> <span m='2548670'>So</span> <span m='2548770'>that's</span>
  <span m='2549650'>n</span> <span m='2550300'>bits.</span> <span m='2550720'>I</span>
  <span m='2550990'>didn't</span> <span m='2551170'>mention--</span> <span m='2551530'>I'm</span>
  <span m='2551920'>going</span> <span m='2552250'>to</span> <span m='2552430'>assume,</span>
  <span m='2552850'>I</span> <span m='2552880'>don't</span> <span m='2553030'>think</span>
  <span m='2553150'>we</span> <span m='2553240'>need</span> <span m='2553390'>it</span>
  <span m='2553510'>yet.</span> <span m='2553780'>At</span> <span m='2553840'>some</span>
  <span m='2554050'>point</span> <span m='2554260'>I</span> <span m='2554350'>will</span>
  <span m='2554530'>assume</span> <span m='2554830'>that</span> <span m='2554950'>the</span>
  <span m='2555220'>alphabets</span> <span m='2555700'>binary.</span> <span m='2556600'>So</span>
  <span m='2556740'>I'm</span> <span m='2556770'>going</span> <span m='2556860'>to</span>
  <span m='2556930'>leave</span> <span m='2557200'>off--</span> <span m='2557560'>when</span>
  <span m='2557680'>I</span> <span m='2557740'>say</span> <span m='2557950'>n</span>
  <span m='2558190'>bits,</span> <span m='2559210'>really</span> <span m='2559540'>it's</span>
  <span m='2559700'>n</span> <span m='2559920'>log</span> <span m='2560140'>sigma</span>
  <span m='2560470'>bits,</span> <span m='2560830'>or</span> <span m='2560950'>n</span>
  <span m='2561130'>characters,</span> <span m='2561850'>or</span> <span m='2561910'>whatever.</span>
  <span m='2562270'>But</span> <span m='2563400'>I'm</span> <span m='2563560'>not</span>
  <span m='2563680'>going</span> <span m='2563800'>to</span> <span m='2563860'>worry</span>
  <span m='2564010'>about</span> <span m='2564190'>that</span> <span m='2564370'>here.</span>
  <span m='2565850'>Are</span> <span m='2566025'>there</span> <span m='2566200'>questions?</span>
  </p><p><span m='2568810'>So</span> <span m='2569020'>now,</span> <span m='2569680'>it's</span>
  <span m='2569800'>an</span> <span m='2569860'>encoding</span> <span m='2570340'>problem.</span>
  <span m='2571220'>How</span> <span m='2571270'>do</span> <span m='2571330'>we</span>
  <span m='2571390'>encode</span> <span m='2571690'>these</span> <span m='2571840'>guys?</span>
  <span m='2577120'>Actually,</span> <span m='2577720'>even</span> <span m='2578020'>successor</span>
  <span m='2578395'>is</span> <span m='2578770'>the</span> <span m='2578890'>only</span>
  <span m='2579100'>thing</span> <span m='2579310'>that's</span> <span m='2579690'>non-trivial.</span>
  <span m='2580720'>We're</span> <span m='2580810'>going</span> <span m='2580920'>to</span>
  <span m='2581020'>do</span> <span m='2581140'>the</span> <span m='2581290'>obvious</span>
  <span m='2581680'>thing</span> <span m='2581890'>for</span> <span m='2582010'>the</span>
  <span m='2582100'>rest.</span> <span m='2585110'>So</span> <span m='2585250'>let</span>
  <span m='2585400'>me</span> <span m='2585520'>tell</span> <span m='2585700'>you</span>
  <span m='2585760'>about</span> <span m='2586030'>the</span> <span m='2586180'>obvious</span>
  <span m='2586540'>ones,</span> <span m='2587320'>easy</span> <span m='2587560'>ones.</span>
  </p><p><span m='2596860'>At</span> <span m='2596975'>least,</span> <span m='2597090'>the</span>
  <span m='2597240'>first</span> <span m='2597390'>revision</span> <span m='2597810'>we're</span>
  <span m='2597960'>not</span> <span m='2598110'>going</span> <span m='2598230'>to</span>
  <span m='2598290'>do</span> <span m='2598410'>anything</span> <span m='2598740'>fancy</span>
  <span m='2599070'>with</span> <span m='2599250'>them,</span> <span m='2599650'>later</span>
  <span m='2599910'>on</span> <span m='2600090'>we</span> <span m='2600240'>will.</span>
  <span m='2606170'>Sorry,</span> <span m='2606570'>is</span> <span m='2606900'>even</span>
  <span m='2607390'>suffix.</span> <span m='2617010'>We're</span> <span m='2617160'>just</span>
  <span m='2617310'>going</span> <span m='2617460'>to</span> <span m='2617520'>store</span>
  <span m='2617800'>this</span> <span m='2617910'>as</span> <span m='2618000'>a</span>
  <span m='2618060'>bit</span> <span m='2618280'>vector.</span> <span m='2619080'>This</span>
  <span m='2619265'>is</span> <span m='2619450'>1</span> <span m='2620520'>if</span>
  <span m='2621876'>SA</span> <span m='2622290'>k</span> <span m='2623160'>is</span>
  <span m='2623430'>even,</span> <span m='2625440'>0</span> <span m='2625800'>if</span>
  <span m='2626150'>it's</span> <span m='2626370'>odd.</span> <span m='2627990'>So</span>
  <span m='2628140'>if</span> <span m='2628200'>we</span> <span m='2628290'>just</span>
  <span m='2628440'>store</span> <span m='2628620'>that</span> <span m='2628740'>is</span>
  <span m='2628860'>a</span> <span m='2628920'>bit</span> <span m='2629100'>vector,</span>
  <span m='2629840'>this</span> <span m='2630050'>is</span> <span m='2630210'>n</span>
  <span m='2630590'>sub</span> <span m='2630900'>k</span> <span m='2632070'>bits</span>
  <span m='2633870'>that</span> <span m='2634050'>we</span> <span m='2634200'>can</span>
  <span m='2634350'>afford.</span> <span m='2635730'>Because</span> <span m='2636090'>this</span>
  <span m='2636240'>is</span> <span m='2636330'>a</span> <span m='2636390'>geometric</span>
  <span m='2636900'>series,</span> <span m='2637650'>it's</span> <span m='2637740'>going</span>
  <span m='2637890'>to</span> <span m='2637950'>be</span> <span m='2638100'>order</span>
  <span m='2638310'>n.</span> </p><p><span m='2642030'>Next</span> <span m='2642360'>is</span>
  <span m='2642510'>even</span> <span m='2642810'>rank.</span> <span m='2646830'>This</span>
  <span m='2647070'>is</span> <span m='2647220'>just</span> <span m='2648430'>the</span>
  <span m='2648600'>rank</span> <span m='2648910'>one</span> <span m='2649210'>structure</span>
  <span m='2650550'>that</span> <span m='2650670'>we</span> <span m='2650790'>covered</span>
  <span m='2651090'>last</span> <span m='2651360'>class,</span> <span m='2652500'>on</span>
  <span m='2653100'>this</span> <span m='2653280'>thing.</span> <span m='2654900'>So</span>
  <span m='2655230'>this</span> <span m='2655410'>is</span> <span m='2655530'>going</span>
  <span m='2655650'>to</span> <span m='2655740'>be</span> <span m='2658640'>nk--</span>
  <span m='2659420'>I</span> <span m='2659460'>think</span> <span m='2659670'>we</span>
  <span m='2659760'>did</span> <span m='2660550'>log</span> <span m='2661070'>log</span>
  <span m='2661710'>nk</span> <span m='2662760'>over</span> <span m='2663180'>log</span>
  <span m='2663570'>nk.</span> <span m='2665610'>And</span> <span m='2665790'>this</span>
  <span m='2665910'>can</span> <span m='2666060'>be</span> <span m='2666150'>improved
  to</span> <span m='2666570'>nk</span> <span m='2666960'>over</span> <span m='2667610'>log</span>
  <span m='2668010'>to</span> <span m='2668160'>the</span> <span m='2668280'>k--</span>
  <span m='2668670'>or</span> <span m='2668790'>log</span> <span m='2669030'>to</span>
  <span m='2669120'>the</span> <span m='2669240'>something</span> <span m='2670150'>of</span>
  <span m='2670350'>nk.</span> </p><p><span m='2671760'>But</span> <span m='2672530'>that's</span>
  <span m='2673270'>an</span> <span m='2673440'>OK</span> <span m='2673620'>bound.</span>
  <span m='2673830'>It's</span> <span m='2673950'>little</span> <span m='2674380'>o</span>
  <span m='2674650'>of</span> <span m='2675040'>N.</span> <span m='2675430'>Again,</span>
  <span m='2675690'>this</span> <span m='2675810'>is</span> <span m='2675870'>geometric,</span>
  <span m='2676740'>so</span> <span m='2676920'>this</span> <span m='2677220'>overall</span>
  <span m='2677650'>will</span> <span m='2677720'>be</span> <span m='2677790'>little</span>
  <span m='2678080'>o</span> <span m='2678130'>of</span> <span m='2678190'>n.</span>
  <span m='2679890'>So</span> <span m='2680070'>those</span> <span m='2680280'>are</span>
  <span m='2681210'>easy,</span> <span m='2684090'>the</span> <span m='2684210'>remaining</span>
  <span m='2684600'>part</span> <span m='2684930'>is</span> <span m='2685260'>doing</span>
  <span m='2686760'>even</span> <span m='2687000'>successor.</span> </p><p><span m='2700120'>A</span>
  <span m='2700190'>little</span> <span m='2700520'>optimization.</span> <span m='2703370'>If</span>
  <span m='2704910'>the</span> <span m='2706820'>i's</span> <span m='2707810'>where</span>
  <span m='2708080'>Sk</span> <span m='2708425'>of</span> <span m='2708770'>i is</span>
  <span m='2709010'>even,</span> <span m='2709640'>we</span> <span m='2709730'>don't</span>
  <span m='2709880'>really</span> <span m='2710060'>need</span> <span m='2710210'>to</span>
  <span m='2710300'>store</span> <span m='2710540'>anything.</span> <span m='2711320'>Because</span>
  <span m='2712010'>then,</span> <span m='2712640'>even</span> <span m='2712850'>successor</span>
  <span m='2713105'>is</span> <span m='2713360'>the</span> <span m='2713450'>identity</span>
  <span m='2713870'>function.</span> <span m='2714870'>So</span> <span m='2714890'>let's</span>
  <span m='2715040'>forget</span> <span m='2715340'>about</span> <span m='2715610'>those</span>
  <span m='2715820'>guys.</span> <span m='2716810'>I'll</span> <span m='2716900'>say,</span>
  <span m='2717710'>it's</span> <span m='2717830'>trivial</span> <span m='2719200'>for</span>
  <span m='2719420'>even</span> <span m='2719720'>successors--</span> <span m='2721640'>for</span>
  <span m='2722030'>even</span> <span m='2724130'>suffixes.</span> </p><p><span m='2729350'>So</span>
  <span m='2729530'>what</span> <span m='2729680'>I'd</span> <span m='2729740'>like</span>
  <span m='2729950'>to</span> <span m='2730070'>do,</span> <span m='2730250'>is</span>
  <span m='2730370'>store</span> <span m='2730640'>the</span> <span m='2730820'>answers</span>
  <span m='2731930'>for</span> <span m='2732170'>odd</span> <span m='2732410'>suffixes.</span>
  <span m='2733130'>That's</span> <span m='2733550'>what</span> <span m='2733970'>we're</span>
  <span m='2734210'>going</span> <span m='2734320'>to</span> <span m='2734420'>do.</span>
  <span m='2736550'>We're</span> <span m='2736730'>going</span> <span m='2736850'>to</span>
  <span m='2736910'>store</span> <span m='2737150'>them</span> <span m='2737300'>in</span>
  <span m='2737420'>a</span> <span m='2737510'>weird</span> <span m='2737810'>way,</span>
  <span m='2739100'>as</span> <span m='2739310'>we</span> <span m='2739490'>will</span>
  <span m='2739610'>see.</span> <span m='2750388'>So</span> <span m='2750591'>that's</span>
  <span m='2751200'>the</span> <span m='2751340'>odd</span> <span m='2751550'>suffixes.</span>
  </p><p><span m='2752100'>There</span> <span m='2752510'>are</span> <span m='2753070'>nk</span>
  <span m='2754010'>over</span> <span m='2754280'>2</span> <span m='2755060'>evens,</span>
  <span m='2756280'>and</span> <span m='2756440'>there</span> <span m='2756650'>are</span>
  <span m='2756890'>nk</span> <span m='2757370'>over</span> <span m='2757610'>2</span>
  <span m='2757910'>odds.</span> <span m='2759170'>So</span> <span m='2759380'>we've</span>
  <span m='2759440'>just</span> <span m='2759620'>saved</span> <span m='2759780'>a</span>
  <span m='2759860'>factor</span> <span m='2760160'>of</span> <span m='2760220'>2.</span>
  <span m='2760470'>This</span> <span m='2760520'>wasn't</span> <span m='2760790'>a</span>
  <span m='2760850'>very</span> <span m='2761030'>deep</span> <span m='2761270'>observation.</span>
  <span m='2762350'>But</span> <span m='2762470'>it</span> <span m='2762530'>turns</span>
  <span m='2762770'>out,</span> <span m='2762860'>if</span> <span m='2763430'>you</span>
  <span m='2763520'>focus</span> <span m='2764000'>in</span> <span m='2764210'>on</span>
  <span m='2764510'>the</span> <span m='2764690'>odd</span> <span m='2764930'>ones,</span>
  <span m='2766320'>has</span> <span m='2766495'>a</span> <span m='2766670'>nice</span>
  <span m='2767480'>little</span> <span m='2767720'>structure</span> <span m='2768140'>to</span>
  <span m='2768260'>them.</span> </p><p><span m='2772330'>This</span> <span m='2772700'>step</span>
  <span m='2773000'>isn't</span> <span m='2773240'>really</span> <span m='2773450'>necessary,</span>
  <span m='2774770'>but</span> <span m='2775050'>it</span> <span m='2775290'>saves</span>
  <span m='2775400'>a</span> <span m='2775460'>factor</span> <span m='2775790'>of</span>
  <span m='2775880'>2.</span> <span m='2784910'>Now</span> <span m='2785210'>the</span>
  <span m='2785330'>kind</span> <span m='2785540'>of</span> <span m='2785660'>interesting</span>
  <span m='2786170'>observation.</span> </p><p><span m='2789560'>What</span> <span
  m='2789770'>I'd</span> <span m='2789890'>like</span> <span m='2790070'>to</span>
  <span m='2790220'>do</span> <span m='2791450'>is</span> <span m='2791570'>store</span>
  <span m='2791930'>these</span> <span m='2792140'>answers</span> <span m='2792710'>in</span>
  <span m='2792920'>order</span> <span m='2793430'>by</span> <span m='2793700'>i.</span>
  <span m='2794450'>That's</span> <span m='2794600'>the</span> <span m='2794720'>obvious</span>
  <span m='2795080'>thing</span> <span m='2795230'>to</span> <span m='2795350'>do.</span>
  <span m='2795560'>I</span> <span m='2795650'>want</span> <span m='2795800'>to</span>
  <span m='2795860'>store</span> <span m='2796190'>basically</span> <span m='2796580'>an</span>
  <span m='2796670'>array.</span> <span m='2800780'>Just</span> <span m='2801130'>store</span>
  <span m='2801480'>it</span> <span m='2801560'>in</span> <span m='2801830'>order</span>
  <span m='2802890'>by</span> <span m='2803360'>i,</span> <span m='2803440'>so</span>
  <span m='2803520'>I'm</span> <span m='2803600'>skipping</span> <span m='2804200'>the</span>
  <span m='2804350'>even</span> <span m='2804740'>suffixes,</span> <span m='2805340'>just</span>
  <span m='2805610'>storing</span> <span m='2805880'>the</span> <span m='2805970'>answers</span>
  <span m='2806360'>for</span> <span m='2806510'>the</span> <span m='2806690'>odd</span>
  <span m='2806960'>suffixes.</span> </p><p><span m='2809240'>So</span> <span m='2809390'>if</span>
  <span m='2809510'>I</span> <span m='2809600'>was</span> <span m='2809810'>given</span>
  <span m='2810110'>a</span> <span m='2810170'>number</span> <span m='2810500'>i,</span>
  <span m='2810890'>how</span> <span m='2811100'>would</span> <span m='2811250'>I</span>
  <span m='2811340'>look</span> <span m='2811550'>it</span> <span m='2811640'>up?</span>
  <span m='2812750'>Well,</span> <span m='2815240'>given</span> <span m='2816080'>an</span>
  <span m='2816230'>index</span> <span m='2816860'>i</span> <span m='2817340'>into</span>
  <span m='2817670'>the</span> <span m='2817820'>suffix</span> <span m='2818240'>array,</span>
  <span m='2819180'>what</span> <span m='2819230'>I</span> <span m='2819290'>need</span>
  <span m='2819440'>to</span> <span m='2819560'>know</span> <span m='2819920'>is--</span>
  <span m='2820925'>this</span> <span m='2821112'>is</span> <span m='2821300'>basically</span>
  <span m='2821750'>the</span> <span m='2821960'>inverse</span> <span m='2823100'>of</span>
  <span m='2823310'>what</span> <span m='2823460'>we</span> <span m='2823580'>did</span>
  <span m='2823790'>with</span> <span m='2824070'>SA k</span> <span m='2824480'>plus</span>
  <span m='2824870'>1.</span> <span m='2825290'>SA k</span> <span m='2825620'>plus</span>
  <span m='2825830'>1</span> <span m='2825980'>is</span> <span m='2826070'>extracting</span>
  <span m='2826325'>the</span> <span m='2826580'>even</span> <span m='2826850'>entries,</span>
  <span m='2827560'>here</span> <span m='2827730'>we're</span> <span m='2827830'>extracting</span>
  <span m='2828260'>the</span> <span m='2828380'>odd</span> <span m='2828620'>entries.</span>
  </p><p><span m='2829640'>So</span> <span m='2829790'>all</span> <span m='2829900'>I</span>
  <span m='2829940'>need</span> <span m='2830120'>to</span> <span m='2830240'>know</span>
  <span m='2830480'>is</span> <span m='2830630'>the</span> <span m='2831050'>odd</span>
  <span m='2831440'>rank</span> <span m='2832520'>of</span> <span m='2832760'>i,</span>
  <span m='2833660'>and</span> <span m='2833810'>then</span> <span m='2834170'>I</span>
  <span m='2834290'>look</span> <span m='2834530'>up</span> <span m='2834770'>into</span>
  <span m='2835010'>this</span> <span m='2835220'>array</span> <span m='2835940'>at</span>
  <span m='2836120'>position</span> <span m='2836660'>odd</span> <span m='2836870'>rank</span>
  <span m='2837140'>of</span> <span m='2837240'>i.</span> <span m='2838110'>That</span>
  <span m='2838330'>will</span> <span m='2838430'>give</span> <span m='2838580'>me</span>
  <span m='2838700'>the</span> <span m='2838820'>answer</span> <span m='2839090'>I</span>
  <span m='2839150'>want.</span> <span m='2840260'>Well,</span> <span m='2840440'>first</span>
  <span m='2840830'>I</span> <span m='2840920'>check</span> <span m='2841880'>is</span>
  <span m='2842190'>is</span> <span m='2842440'>it</span> <span m='2842540'>an</span>
  <span m='2842630'>even</span> <span m='2842900'>suffix,</span> <span m='2843350'>which</span>
  <span m='2843560'>I</span> <span m='2843580'>have</span> <span m='2843680'>stored</span>
  <span m='2843980'>as</span> <span m='2844070'>a</span> <span m='2844130'>bit</span>
  <span m='2844310'>vector.</span> <span m='2845000'>If</span> <span m='2845060'>it's</span>
  <span m='2845180'>an</span> <span m='2845240'>even</span> <span m='2845510'>suffix,</span>
  <span m='2846110'>I</span> <span m='2846200'>do</span> <span m='2846350'>nothing,</span>
  <span m='2846710'>I</span> <span m='2846800'>just</span> <span m='2846950'>return</span>
  <span m='2847760'>i.</span> </p><p><span m='2848990'>But</span> <span m='2849140'>if</span>
  <span m='2849260'>it's</span> <span m='2849350'>an</span> <span m='2849440'>odd</span>
  <span m='2849650'>suffix,</span> <span m='2850040'>then</span> <span m='2850190'>I</span>
  <span m='2850280'>compute</span> <span m='2850640'>the</span> <span m='2850850'>odd</span>
  <span m='2851120'>rank.</span> <span m='2852710'>How</span> <span m='2852860'>do</span>
  <span m='2852920'>I</span> <span m='2852980'>compute</span> <span m='2853250'>the</span>
  <span m='2853370'>odd</span> <span m='2853580'>rank?</span> <span m='2854290'>I</span>
  <span m='2854360'>take</span> <span m='2854590'>the</span> <span m='2854660'>even</span>
  <span m='2854930'>rank</span> <span m='2855410'>and</span> <span m='2855590'>take</span>
  <span m='2856010'>i</span> <span m='2856190'>minus</span> <span m='2856370'>that.</span>
  <span m='2857720'>Odd</span> <span m='2857930'>rank,</span> <span m='2860370'>we</span>
  <span m='2860990'>don't</span> <span m='2861290'>need</span> <span m='2861530'>to</span>
  <span m='2861620'>store</span> <span m='2861860'>anything</span> <span m='2862190'>for</span>
  <span m='2862430'>it.</span> <span m='2862610'>I</span> <span m='2862640'>mean,</span>
  <span m='2862760'>you</span> <span m='2862880'>could</span> <span m='2863090'>if</span>
  <span m='2863210'>you</span> <span m='2863300'>wanted</span> <span m='2863570'>to,</span>
  <span m='2863820'>but</span> <span m='2864500'>odd</span> <span m='2864710'>rank</span>
  <span m='2864980'>is</span> <span m='2865130'>just</span> <span m='2865980'>i</span>
  <span m='2866450'>minus</span> <span m='2866870'>even</span> <span m='2867110'>rank.</span>
  </p><p><span m='2870050'>Because</span> <span m='2870260'>every</span> <span m='2870680'>index</span>
  <span m='2871130'>is</span> <span m='2871280'>either</span> <span m='2872730'>odd</span>
  <span m='2873040'>or</span> <span m='2873140'>even.</span> <span m='2875590'>OK,</span>
  <span m='2876690'>great.</span> <span m='2877040'>So</span> <span m='2877550'>I</span>
  <span m='2877580'>can</span> <span m='2877760'>look</span> <span m='2877910'>up</span>
  <span m='2878030'>odd</span> <span m='2878240'>rank</span> <span m='2878630'>and</span>
  <span m='2878750'>then</span> <span m='2879560'>look</span> <span m='2879770'>at</span>
  <span m='2879860'>this</span> <span m='2880070'>array.</span> <span m='2880900'>That'll</span>
  <span m='2880980'>give</span> <span m='2881150'>me</span> <span m='2881270'>the</span>
  <span m='2881390'>answer</span> <span m='2881660'>I</span> <span m='2881720'>need.</span>
  <span m='2882580'>But</span> <span m='2882710'>I'm</span> <span m='2882770'>not</span>
  <span m='2882950'>going</span> <span m='2883070'>to</span> <span m='2883160'>actually</span>
  <span m='2883520'>store</span> <span m='2883710'>this</span> <span m='2883880'>as</span>
  <span m='2883970'>an</span> <span m='2884090'>array.</span> <span m='2884480'>I</span>
  <span m='2884600'>lied.</span> </p><p><span m='2887350'>But</span> <span m='2887540'>in</span>
  <span m='2887660'>any</span> <span m='2887810'>case,</span> <span m='2888510'>let's</span>
  <span m='2888590'>worry</span> <span m='2888770'>about</span> <span m='2889100'>how</span>
  <span m='2889310'>I'm</span> <span m='2889370'>going</span> <span m='2889490'>to</span>
  <span m='2889550'>store</span> <span m='2889730'>it</span> <span m='2889790'>in</span>
  <span m='2889880'>a</span> <span m='2889940'>moment.</span> <span m='2890880'>Let's</span>
  <span m='2890960'>think</span> <span m='2891200'>about</span> <span m='2891950'>i--</span>
  <span m='2892310'>if</span> <span m='2892460'>I</span> <span m='2893780'>I'm</span>
  <span m='2893930'>storing</span> <span m='2894290'>these</span> <span m='2894500'>answers--</span>
  <span m='2895670'>the</span> <span m='2895990'>even</span> <span m='2896240'>successor</span>
  <span m='2896750'>answers,</span> <span m='2897200'>these</span> <span m='2897380'>j</span>
  <span m='2897650'>values,</span> <span m='2898820'>in</span> <span m='2899090'>order</span>
  <span m='2899450'>by</span> <span m='2899900'>i.</span> </p><p><span m='2901091'>I</span>
  <span m='2901490'>claim</span> <span m='2902870'>that</span> <span m='2903080'>order</span>
  <span m='2903410'>is</span> <span m='2903530'>a</span> <span m='2903590'>very</span>
  <span m='2903800'>special</span> <span m='2904310'>order,</span> <span m='2904880'>because</span>
  <span m='2905060'>what</span> <span m='2905210'>does</span> <span m='2905360'>it</span>
  <span m='2905420'>mean</span> <span m='2905600'>to</span> <span m='2905720'>order</span>
  <span m='2905960'>by</span> <span m='2906260'>i?</span> <span m='2907100'>Ordering</span>
  <span m='2907520'>by</span> <span m='2907730'>i,</span> <span m='2908530'>that</span>
  <span m='2908750'>means</span> <span m='2908990'>the</span> <span m='2909110'>suffixes</span>
  <span m='2909740'>are</span> <span m='2909860'>sorted,</span> <span m='2910890'>right?</span>
  <span m='2911240'>So</span> <span m='2912290'>this</span> <span m='2912500'>is</span>
  <span m='2912620'>the</span> <span m='2912710'>same</span> <span m='2913010'>thing</span>
  <span m='2914030'>as</span> <span m='2914210'>ordering</span> <span m='2916070'>by</span>
  <span m='2916430'>an</span> <span m='2916580'>odd</span> <span m='2916850'>suffix</span>
  <span m='2920570'>in</span> <span m='2920920'>Tk</span> <span m='2923240'>from</span>
  <span m='2923930'>SA</span> <span m='2924335'>of</span> <span m='2924980'>i</span>
  <span m='2926690'>onwards.</span> </p><p><span m='2927590'>That's</span> <span m='2927890'>the</span>
  <span m='2928010'>suffix</span> <span m='2928460'>that</span> <span m='2928580'>we're--</span>
  <span m='2929360'>sorting</span> <span m='2929810'>by</span> <span m='2929960'>that</span>
  <span m='2930470'>suffix,</span> <span m='2930830'>is</span> <span m='2931190'>sorting</span>
  <span m='2931610'>by</span> <span m='2932030'>i.</span> <span m='2935060'>Now</span>
  <span m='2935480'>we</span> <span m='2935600'>can</span> <span m='2935780'>unpack</span>
  <span m='2936230'>an</span> <span m='2936350'>odd</span> <span m='2936530'>suffix--</span>
  <span m='2936980'>it</span> <span m='2937070'>has</span> <span m='2937250'>the</span>
  <span m='2937370'>first</span> <span m='2937610'>character--</span> <span m='2938240'>and</span>
  <span m='2938330'>then</span> <span m='2938460'>an</span> <span m='2938540'>even</span>
  <span m='2938780'>suffix.</span> <span m='2940190'>So</span> <span m='2940340'>this</span>
  <span m='2940520'>is</span> <span m='2940640'>the</span> <span m='2940730'>same</span>
  <span m='2940970'>thing</span> <span m='2942020'>as</span> <span m='2942290'>ordering</span>
  <span m='2943160'>by--</span> <span m='2944210'>this</span> <span m='2944300'>should</span>
  <span m='2944450'>look</span> <span m='2944570'>familiar</span> <span m='2945050'>because</span>
  <span m='2945230'>we</span> <span m='2945350'>did</span> <span m='2945500'>the</span>
  <span m='2945590'>same</span> <span m='2945800'>kinds</span> <span m='2946010'>of</span>
  <span m='2946100'>tricks</span> <span m='2946370'>when</span> <span m='2946460'>we</span>
  <span m='2946550'>were</span> <span m='2946640'>building</span> <span m='2947000'>suffix</span>
  <span m='2947280'>trees.</span> </p><p><span m='2961010'>This</span> <span m='2961460'>is</span>
  <span m='2962810'>even.</span> <span m='2966390'>In</span> <span m='2966530'>fact,</span>
  <span m='2966900'>it's</span> <span m='2966980'>the</span> <span m='2967070'>even</span>
  <span m='2967310'>successor.</span> <span m='2971674'>There's a</span> <span m='2972160'>typo</span>
  <span m='2972590'>here,</span> <span m='2972990'>[? see ?]</span> <span m='2978020'>If</span>
  <span m='2978290'>we</span> <span m='2979430'>follow</span> <span m='2979920'>SA</span>
  <span m='2980335'>k,</span> <span m='2981560'>and</span> <span m='2981680'>then</span>
  <span m='2981800'>we</span> <span m='2981890'>add</span> <span m='2982190'>1.</span>
  <span m='2982700'>If</span> <span m='2982850'>we</span> <span m='2982910'>follow</span>
  <span m='2983240'>SA</span> <span m='2983630'>k</span> <span m='2984020'>backwards,</span>
  <span m='2985580'>that</span> <span m='2985820'>was</span> <span m='2986000'>the</span>
  <span m='2986120'>definition</span> <span m='2986840'>of</span> <span m='2987050'>even</span>
  <span m='2987350'>successor.</span> </p><p><span m='2988430'>So</span> <span m='2988550'>I</span>
  <span m='2988610'>can</span> <span m='2988760'>rewrite</span> <span m='2989240'>this</span>
  <span m='2989450'>thing.</span> <span m='2991200'>This</span> <span m='2991380'>part</span>
  <span m='2993030'>is</span> <span m='2993330'>the</span> <span m='2993480'>same</span>
  <span m='2993630'>thing</span> <span m='2993960'>as</span> <span m='2994980'>Tk</span>
  <span m='2996650'>SA</span> <span m='2997140'>k</span> <span m='2999270'>even</span>
  <span m='2999600'>successor</span> <span m='3003130'>k</span> <span m='3004850'>of</span>
  <span m='3005400'>i,</span> <span m='3006500'>closed</span> <span m='3006980'>bracket,</span>
  <span m='3007460'>colon,</span> <span m='3008210'>closed</span> <span m='3008840'>bracket.</span>
  <span m='3009706'>Get</span> <span m='3010122'>that</span> <span m='3010540'>right?</span>
  <span m='3011980'>Yes.</span> </p><p><span m='3014650'>That</span> <span m='3014800'>was</span>
  <span m='3014875'>the</span> <span m='3014950'>definition</span> <span m='3015400'>of</span>
  <span m='3015490'>even</span> <span m='3015640'>successors.</span> <span m='3016630'>Even</span>
  <span m='3016870'>successor</span> <span m='3017440'>is</span> <span m='3017650'>the</span>
  <span m='3017770'>value</span> <span m='3018190'>j,</span> <span m='3018550'>for</span>
  <span m='3018730'>which</span> <span m='3018910'>if</span> <span m='3019030'>I</span>
  <span m='3019120'>do</span> <span m='3019420'>SA</span> <span m='3019780'>k</span>
  <span m='3020140'>of</span> <span m='3020290'>j,</span> <span m='3020950'>I</span>
  <span m='3021040'>get</span> <span m='3021250'>SA</span> <span m='3021430'>k</span>
  <span m='3021640'>of</span> <span m='3021730'>i</span> <span m='3021940'>plus</span>
  <span m='3022210'>1.</span> <span m='3022896'>That's</span> <span m='3023372'>the</span>
  <span m='3023850'>definition.</span> <span m='3025600'>OK,</span> <span m='3025890'>now</span>
  <span m='3027150'>Tk</span> <span m='3028640'>of</span> <span m='3029190'>SA</span>
  <span m='3029560'>of</span> <span m='3029720'>k.</span> <span m='3032980'>Sorry,</span>
  <span m='3033430'>the</span> <span m='3033520'>suffix--</span> <span m='3034440'>that's</span>
  <span m='3034570'>not</span> <span m='3034720'>Tk</span> <span m='3035280'>of.</span>
  <span m='3035400'>There's</span> <span m='3035530'>a</span> <span m='3035590'>colon</span>
  <span m='3035920'>here.</span> </p><p><span m='3036580'>The</span> <span m='3036700'>suffix</span>
  <span m='3037120'>of</span> <span m='3037240'>Tk</span> <span m='3038260'>starting</span>
  <span m='3038800'>at</span> <span m='3038890'>SA</span> <span m='3039620'>k.</span>
  <span m='3040690'>If</span> <span m='3040870'>I</span> <span m='3040990'>sort</span>
  <span m='3041470'>by</span> <span m='3041650'>those</span> <span m='3041890'>suffixes--</span>
  <span m='3046770'>they're</span> <span m='3047010'>sorted,</span> <span m='3047540'>right?</span>
  <span m='3047780'>I</span> <span m='3047870'>mean,</span> <span m='3048560'>that</span>
  <span m='3048710'>was</span> <span m='3049040'>the</span> <span m='3049190'>point</span>
  <span m='3049460'>of</span> <span m='3049520'>the</span> <span m='3049610'>suffix</span>
  <span m='3050030'>array,</span> <span m='3050330'>is</span> <span m='3050510'>to</span>
  <span m='3050630'>sort</span> <span m='3050900'>the</span> <span m='3050990'>suffixes.</span>
  <span m='3051860'>So</span> <span m='3051950'>if</span> <span m='3052040'>I</span>
  <span m='3052160'>say</span> <span m='3053230'>I'm</span> <span m='3053420'>ordering</span>
  <span m='3053900'>by</span> <span m='3054560'>the</span> <span m='3054710'>suffixes</span>
  <span m='3055670'>given</span> <span m='3056000'>in</span> <span m='3056150'>order</span>
  <span m='3056450'>by</span> <span m='3056600'>SA</span> <span m='3057350'>k,</span>
  <span m='3058670'>they're</span> <span m='3058880'>already</span> <span m='3059270'>sorted.</span>
  <span m='3059660'>There's</span> <span m='3059810'>no</span> <span m='3059960'>reason</span>
  <span m='3060350'>to</span> <span m='3060470'>do</span> <span m='3060650'>this</span>
  <span m='3060830'>Tk</span> <span m='3061310'>of</span> <span m='3061430'>SA k</span>
  <span m='3061910'>part.</span> </p><p><span m='3062720'>This</span> <span m='3062900'>is</span>
  <span m='3062990'>going</span> <span m='3063230'>to</span> <span m='3063350'>be</span>
  <span m='3063560'>the</span> <span m='3063710'>same</span> <span m='3064100'>thing</span>
  <span m='3065210'>as</span> <span m='3065450'>the</span> <span m='3065600'>order</span>
  <span m='3067250'>by</span> <span m='3068450'>this</span> <span m='3068630'>first</span>
  <span m='3068930'>letter,</span> <span m='3069430'>Tk</span> <span m='3070442'>SA</span>
  <span m='3070864'>k</span> <span m='3071286'>of</span> <span m='3071710'>i</span>
  <span m='3074120'>comma,</span> <span m='3075170'>even</span> <span m='3075470'>successor.</span>
  <span m='3080300'>The</span> <span m='3080450'>suffix</span> <span m='3080870'>array</span>
  <span m='3081030'>is</span> <span m='3081110'>defined</span> <span m='3081560'>to</span>
  <span m='3081650'>have</span> <span m='3081830'>this</span> <span m='3081950'>property,</span>
  <span m='3082340'>that</span> <span m='3082460'>these</span> <span m='3082640'>orders</span>
  <span m='3082910'>are</span> <span m='3083000'>the</span> <span m='3083090'>same</span>
  <span m='3083330'>thing.</span> <span m='3086470'>And</span> <span m='3086620'>sorting</span>
  <span m='3086950'>by</span> <span m='3087040'>the</span> <span m='3087130'>suffixes</span>
  <span m='3087720'>is</span> <span m='3087850'>the</span> <span m='3087940'>same</span>
  <span m='3088240'>thing</span> <span m='3088510'>as</span> <span m='3088750'>sorting</span>
  <span m='3089200'>by</span> <span m='3089470'>the</span> <span m='3089710'>indices</span>
  <span m='3090220'>into</span> <span m='3090370'>the</span> <span m='3090490'>suffix</span>
  <span m='3090880'>array.</span> </p><p><span m='3093590'>Interesting,</span> <span
  m='3095180'>because</span> <span m='3095390'>this</span> <span m='3095630'>is</span>
  <span m='3095750'>what</span> <span m='3095900'>I</span> <span m='3095990'>want</span>
  <span m='3096170'>to</span> <span m='3096230'>store,</span> <span m='3096810'>right?</span>
  <span m='3097000'>Those</span> <span m='3097190'>are</span> <span m='3097250'>the</span>
  <span m='3097400'>answers</span> <span m='3097880'>that</span> <span m='3098000'>I'm</span>
  <span m='3098090'>trying</span> <span m='3098330'>to</span> <span m='3098420'>store.</span>
  <span m='3098660'>I'm</span> <span m='3098750'>trying</span> <span m='3098960'>to</span>
  <span m='3099050'>store</span> <span m='3099740'>even</span> <span m='3099980'>successor</span>
  <span m='3100970'>for</span> <span m='3101180'>every</span> <span m='3101590'>i</span>
  <span m='3101990'>that</span> <span m='3102170'>has</span> <span m='3102950'>an</span>
  <span m='3103150'>odd--</span> <span m='3103910'>that</span> <span m='3104190'>starts</span>
  <span m='3104480'>in</span> <span m='3104570'>an</span> <span m='3104660'>odd</span>
  <span m='3105380'>suffix.</span> </p><p><span m='3108500'>So</span> <span m='3108710'>really,</span>
  <span m='3109340'>all</span> <span m='3109550'>I</span> <span m='3109580'>need</span>
  <span m='3109730'>to</span> <span m='3109820'>do</span> <span m='3109970'>is</span>
  <span m='3110060'>order</span> <span m='3110360'>by</span> <span m='3110900'>this</span>
  <span m='3111230'>thing.</span> <span m='3111740'>And</span> <span m='3111920'>then</span>
  <span m='3112940'>once</span> <span m='3113180'>I've</span> <span m='3113300'>ordered</span>
  <span m='3113540'>by</span> <span m='3113660'>this</span> <span m='3113840'>thing,</span>
  <span m='3114560'>I'll</span> <span m='3114680'>store</span> <span m='3115490'>these</span>
  <span m='3115670'>guys</span> <span m='3116270'>in</span> <span m='3116450'>order</span>
  <span m='3117710'>by</span> <span m='3117860'>their</span> <span m='3117950'>value.</span>
  <span m='3120450'>Cool.</span> <span m='3120980'>So</span> <span m='3121520'>these</span>
  <span m='3122180'>are</span> <span m='3122240'>the</span> <span m='3122360'>pairs</span>
  <span m='3122660'>I'm</span> <span m='3122730'>going</span> <span m='3122870'>to</span>
  <span m='3122930'>store.</span> <span m='3124160'>I'm</span> <span m='3124280'>not</span>
  <span m='3124490'>going</span> <span m='3124670'>to--</span> <span m='3125780'>I'm</span>
  <span m='3125840'>going</span> <span m='3125960'>to</span> <span m='3126020'>store</span>
  <span m='3126650'>this</span> <span m='3127100'>comma</span> <span m='3127450'>this,</span>
  <span m='3128510'>for</span> <span m='3128720'>all</span> <span m='3128960'>i,</span>
  <span m='3130220'>in</span> <span m='3130430'>order</span> <span m='3131110'>by</span>
  <span m='3131330'>this</span> <span m='3131510'>value.</span> <span m='3132242'>That</span>
  <span m='3132610'>is</span> <span m='3132860'>my</span> <span m='3133010'>goal.</span>
  </p><p><span m='3133430'>If</span> <span m='3133530'>I</span> <span m='3133630'>can</span>
  <span m='3133640'>store</span> <span m='3133880'>these</span> <span m='3134210'>in</span>
  <span m='3134360'>order</span> <span m='3134630'>by</span> <span m='3134780'>this</span>
  <span m='3134900'>value,</span> <span m='3136010'>then</span> <span m='3136520'>by</span>
  <span m='3137060'>computing</span> <span m='3137480'>odd</span> <span m='3137690'>rank,</span>
  <span m='3138140'>I</span> <span m='3138260'>know</span> <span m='3138560'>where</span>
  <span m='3138980'>in</span> <span m='3139100'>this</span> <span m='3139280'>list</span>
  <span m='3139520'>of</span> <span m='3139580'>pairs</span> <span m='3139940'>to</span>
  <span m='3140030'>go.</span> <span m='3140830'>And</span> <span m='3140960'>I</span>
  <span m='3141080'>just</span> <span m='3141200'>look</span> <span m='3141380'>at</span>
  <span m='3141440'>the</span> <span m='3141530'>second</span> <span m='3141860'>value</span>
  <span m='3142220'>of</span> <span m='3142310'>the</span> <span m='3142400'>pair,</span>
  <span m='3143120'>that</span> <span m='3143390'>is</span> <span m='3144560'>my</span>
  <span m='3144740'>answer.</span> <span m='3146720'>Why</span> <span m='3146930'>am</span>
  <span m='3147020'>I</span> <span m='3147080'>storing</span> <span m='3147410'>this?</span>
  <span m='3148430'>We'll</span> <span m='3148520'>see.</span> </p><p><span m='3151820'>I</span>
  <span m='3151880'>don't</span> <span m='3151970'>know</span> <span m='3152060'>if</span>
  <span m='3152150'>you</span> <span m='3152240'>really</span> <span m='3152420'>need</span>
  <span m='3152570'>to,</span> <span m='3152940'>but</span> <span m='3153110'>you</span>
  <span m='3153230'>can.</span> <span m='3156080'>OK.</span> <span m='3158810'>So</span>
  <span m='3159090'>what</span> <span m='3159200'>we're</span> <span m='3159320'>going</span>
  <span m='3159470'>to--</span> <span m='3161276'>I</span> <span m='3161690'>feel</span>
  <span m='3161990'>like</span> <span m='3162140'>it's</span> <span m='3162320'>cheating.</span>
  <span m='3163040'>I</span> <span m='3163100'>say,</span> <span m='3163280'>actually</span>
  <span m='3163880'>store</span> <span m='3164150'>these</span> <span m='3164360'>pairs.</span>
  <span m='3164780'>We're</span> <span m='3164900'>not</span> <span m='3165140'>really</span>
  <span m='3165440'>going</span> <span m='3165590'>to</span> <span m='3165650'>actually</span>
  <span m='3166010'>store</span> <span m='3166310'>them.</span> <span m='3166700'>We</span>
  <span m='3166895'>still</span> <span m='3167090'>have</span> <span m='3167210'>another</span>
  <span m='3167480'>trick</span> <span m='3167750'>up</span> <span m='3167870'>our</span>
  <span m='3167960'>sleeve.</span> <span m='3169070'>But</span> <span m='3169220'>more</span>
  <span m='3169430'>or</span> <span m='3169460'>less,</span> <span m='3169700'>we're</span>
  <span m='3169850'>going</span> <span m='3170060'>to</span> <span m='3170180'>store</span>
  <span m='3171170'>these</span> <span m='3171380'>pairs--</span> <span m='3171920'>I'll</span>
  <span m='3172190'>cross</span> <span m='3172560'>out,</span> <span m='3172760'>actually.</span>
  <span m='3174860'>Store</span> <span m='3175220'>these</span> <span m='3175430'>pairs</span>
  <span m='3176480'>in</span> <span m='3176630'>order</span> <span m='3180890'>by</span>
  <span m='3181160'>value.</span> </p><p><span m='3182930'>Storing</span> <span m='3183290'>them</span>
  <span m='3183410'>in</span> <span m='3183500'>order</span> <span m='3183680'>by</span>
  <span m='3183830'>value</span> <span m='3184190'>is</span> <span m='3184280'>the</span>
  <span m='3184370'>same</span> <span m='3184670'>thing</span> <span m='3184890'>as</span>
  <span m='3185000'>order</span> <span m='3185220'>by</span> <span m='3185640'>i.</span>
  <span m='3186820'>That's</span> <span m='3187280'>what</span> <span m='3187710'>we</span>
  <span m='3187820'>just</span> <span m='3188010'>proved.</span> <span m='3189150'>And</span>
  <span m='3189560'>at</span> <span m='3189680'>this</span> <span m='3189860'>point,</span>
  <span m='3190310'>is</span> <span m='3190520'>when</span> <span m='3190670'>I'm</span>
  <span m='3190730'>going</span> <span m='3190850'>to</span> <span m='3190910'>assume</span>
  <span m='3191400'>a</span> <span m='3191520'>binary</span> <span m='3191900'>alphabet.</span>
  <span m='3197200'>OK.</span> <span m='3202980'>Maybe,</span> <span m='3203435'>I'll</span>
  <span m='3203662'>go</span> <span m='3207460'>through</span> <span m='3207910'>here.</span>
  <span m='3211000'>Need</span> <span m='3211220'>lots</span> <span m='3211480'>of</span>
  <span m='3211540'>stuff.</span> </p><p><span m='3215180'>Think</span> <span m='3215640'>we</span>
  <span m='3215730'>don't</span> <span m='3215910'>need</span> <span m='3216060'>this</span>
  <span m='3216240'>giant</span> <span m='3216540'>recursion</span> <span m='3217020'>up</span>
  <span m='3217170'>here.</span> <span m='3221710'>Just</span> <span m='3222100'>remember,</span>
  <span m='3222175'>it's</span> <span m='3222250'>enough</span> <span m='3222580'>to</span>
  <span m='3222730'>know</span> <span m='3222910'>how</span> <span m='3223030'>to</span>
  <span m='3223120'>compute</span> <span m='3223420'>even</span> <span m='3223630'>successor,</span>
  <span m='3224710'>the</span> <span m='3224800'>rest</span> <span m='3225070'>is</span>
  <span m='3225190'>easy.</span> <span m='3256620'>So</span> <span m='3256760'>here</span>
  <span m='3256970'>we</span> <span m='3257060'>go.</span> <span m='3259880'>We're</span>
  <span m='3259910'>trying</span> <span m='3260090'>to</span> <span m='3260180'>store</span>
  <span m='3260420'>these</span> <span m='3260570'>pairs,</span> <span m='3260850'>so</span>
  <span m='3261080'>we're</span> <span m='3261200'>trying</span> <span m='3261470'>to</span>
  <span m='3261560'>store</span> <span m='3263840'>a</span> <span m='3263960'>sorted</span>
  <span m='3264440'>array</span> <span m='3270020'>of</span> <span m='3270320'>nk</span>
  <span m='3270740'>over</span> <span m='3270950'>2</span> <span m='3271170'>values.</span>
  </p><p><span m='3274550'>That's</span> <span m='3274760'>how</span> <span m='3274880'>many</span>
  <span m='3275075'>odd</span> <span m='3275270'>suffixes</span> <span m='3275810'>there</span>
  <span m='3275990'>are.</span> <span m='3277520'>And</span> <span m='3278290'>they're</span>
  <span m='3278580'>each</span> <span m='3280660'>2</span> <span m='3281020'>to</span>
  <span m='3281180'>the</span> <span m='3281300'>k</span> <span m='3281850'>plus</span>
  <span m='3282320'>log</span> <span m='3282890'>nk</span> <span m='3283460'>bits,</span>
  <span m='3284710'>I</span> <span m='3285040'>claim.</span> <span m='3286460'>Why?</span>
  <span m='3287450'>Because</span> <span m='3289370'>this</span> <span m='3289610'>was</span>
  <span m='3289940'>a</span> <span m='3290030'>single</span> <span m='3290360'>character</span>
  <span m='3290960'>in</span> <span m='3291060'>Tk.</span> <span m='3291510'>But</span>
  <span m='3291650'>a</span> <span m='3291680'>single</span> <span m='3291980'>character</span>
  <span m='3292310'>in</span> <span m='3292400'>Tk</span> <span m='3292700'>was</span>
  <span m='3292850'>actually</span> <span m='3293150'>2</span> <span m='3293430'>to</span>
  <span m='3293510'>the</span> <span m='3293630'>k</span> <span m='3294010'>bits,</span>
  <span m='3294380'>in</span> <span m='3294470'>the</span> <span m='3294590'>original</span>
  <span m='3295010'>string</span> <span m='3295310'>for</span> <span m='3295430'>binary</span>
  <span m='3295760'>alphabet,</span> <span m='3296120'>and</span> <span m='3296210'>general</span>
  <span m='3296510'>sigma</span> <span m='3296850'>to</span> <span m='3296960'>the</span>
  <span m='3297300'>k.</span> </p><p><span m='3299120'>So</span> <span m='3299240'>that's</span>
  <span m='3299450'>that</span> <span m='3299600'>part</span> <span m='3299730'>of</span>
  <span m='3299790'>this</span> <span m='3299960'>2</span> <span m='3300035'>to</span>
  <span m='3300110'>the</span> <span m='3300280'>k</span> <span m='3300420'>bits.</span>
  <span m='3301470'>The</span> <span m='3301640'>even</span> <span m='3301850'>successor,</span>
  <span m='3302670'>well,</span> <span m='3302810'>that's</span> <span m='3302930'>just</span>
  <span m='3303140'>an</span> <span m='3303230'>index</span> <span m='3303710'>into</span>
  <span m='3303920'>something</span> <span m='3304220'>of</span> <span m='3304280'>size</span>
  <span m='3304580'>nk.</span> <span m='3305570'>So</span> <span m='3305720'>it's</span>
  <span m='3305840'>log</span> <span m='3306110'>nk</span> <span m='3306530'>bits.</span>
  <span m='3308060'>OK,</span> <span m='3308270'>fine.</span> <span m='3308880'>If</span>
  <span m='3309030'>I</span> <span m='3309080'>store</span> <span m='3309300'>that</span>
  <span m='3309470'>explicitly,</span> <span m='3310100'>I</span> <span m='3310220'>would</span>
  <span m='3310370'>be</span> <span m='3310490'>in</span> <span m='3310580'>trouble,</span>
  <span m='3311390'>because</span> <span m='3311840'>2</span> <span m='3312080'>to</span>
  <span m='3312170'>the</span> <span m='3312260'>k</span> <span m='3312980'>times</span>
  <span m='3313340'>nk</span> <span m='3314510'>is</span> <span m='3315030'>n.</span>
  <span m='3316470'>And</span> <span m='3316700'>so</span> <span m='3317060'>I</span>
  <span m='3317180'>would</span> <span m='3317360'>be</span> <span m='3317480'>storing</span>
  <span m='3317900'>n</span> <span m='3318035'>bits</span> <span m='3318170'>at</span>
  <span m='3318290'>every</span> <span m='3318620'>level--</span> <span m='3319460'>well,</span>
  <span m='3319700'>so</span> <span m='3319850'>I</span> <span m='3319910'>guess</span>
  <span m='3320090'>they</span> <span m='3320150'>get</span> <span m='3320300'>n</span>
  <span m='3320510'>log</span> <span m='3320780'>log</span> <span m='3321560'>n</span>
  <span m='3321770'>space.</span> </p><p><span m='3323300'>That</span> <span m='3324290'>part's</span>
  <span m='3324530'>actually</span> <span m='3324830'>OK.</span> <span m='3325110'>I</span>
  <span m='3325170'>can</span> <span m='3325340'>afford</span> <span m='3325580'>that</span>
  <span m='3325730'>much</span> <span m='3326570'>if</span> <span m='3326690'>I'm</span>
  <span m='3326990'>just</span> <span m='3327200'>going</span> <span m='3327380'>for</span>
  <span m='3327470'>an</span> <span m='3327530'>n</span> <span m='3327870'>log</span>
  <span m='3328070'>log</span> <span m='3328200'>n</span> <span m='3328360'>bound.</span>
  <span m='3329900'>This</span> <span m='3330200'>part,</span> <span m='3332030'>not</span>
  <span m='3332210'>so</span> <span m='3332390'>much.</span> <span m='3332840'>Because</span>
  <span m='3333350'>in</span> <span m='3333440'>particular,</span> <span m='3333990'>when</span>
  <span m='3334040'>k</span> <span m='3334230'>equals</span> <span m='3334420'>0,</span>
  <span m='3335270'>that's</span> <span m='3335480'>going</span> <span m='3335600'>to</span>
  <span m='3335690'>be</span> <span m='3335930'>n</span> <span m='3336770'>times</span>
  <span m='3336980'>log</span> <span m='3337280'>n.</span> <span m='3338030'>I</span>
  <span m='3338090'>don't</span> <span m='3338390'>want</span> <span m='3338540'>to</span>
  <span m='3338630'>spend</span> <span m='3339080'>n</span> <span m='3339280'>log</span>
  <span m='3339500'>n</span> <span m='3339650'>space.</span> </p><p><span m='3340580'>And</span>
  <span m='3340670'>the</span> <span m='3340760'>whole</span> <span m='3340940'>point,</span>
  <span m='3341390'>is</span> <span m='3341540'>we're</span> <span m='3341660'>trying</span>
  <span m='3341930'>to</span> <span m='3342050'>avoid</span> <span m='3342380'>storing</span>
  <span m='3342650'>these</span> <span m='3342800'>explicitly.</span> <span m='3343340'>Because</span>
  <span m='3343550'>if</span> <span m='3343700'>I</span> <span m='3343760'>did,</span>
  <span m='3344420'>I'd</span> <span m='3344570'>get</span> <span m='3344810'>n</span>
  <span m='3344990'>log</span> <span m='3345200'>n</span> <span m='3345320'>space.</span>
  <span m='3345920'>So</span> <span m='3346100'>we're</span> <span m='3346190'>not</span>
  <span m='3346370'>going</span> <span m='3346520'>to</span> <span m='3346580'>store</span>
  <span m='3346760'>them</span> <span m='3346910'>explicitly.</span> <span m='3352010'>As</span>
  <span m='3353360'>follows,</span> <span m='3356710'>we</span> <span m='3356790'>are</span>
  <span m='3356870'>going</span> <span m='3357200'>to</span> <span m='3358610'>store</span>
  <span m='3360851'>so</span> <span m='3361350'>there</span> <span m='3361550'>are</span>
  <span m='3361655'>these</span> <span m='3361760'>big</span> <span m='3361865'>bit</span>
  <span m='3361970'>vectors.</span> <span m='3362480'>We're</span> <span m='3362630'>going</span>
  <span m='3362750'>to</span> <span m='3362870'>look</span> <span m='3363140'>at</span>
  <span m='3363380'>the</span> <span m='3363500'>leading</span> <span m='3365810'>log</span>
  <span m='3366230'>nk</span> <span m='3366390'>bits.</span> </p><p><span m='3367550'>This</span>
  <span m='3367730'>is</span> <span m='3367820'>kind</span> <span m='3368000'>of</span>
  <span m='3368090'>weird,</span> <span m='3368420'>because</span> <span m='3369680'>the</span>
  <span m='3369770'>log</span> <span m='3370010'>nk</span> <span m='3370390'>bits</span>
  <span m='3370580'>we</span> <span m='3370670'>care</span> <span m='3370850'>about</span>
  <span m='3371060'>are</span> <span m='3371150'>at</span> <span m='3371270'>the</span>
  <span m='3371420'>end.</span> <span m='3372050'>But</span> <span m='3372230'>we're</span>
  <span m='3372320'>going</span> <span m='3372470'>to</span> <span m='3372530'>look</span>
  <span m='3372710'>at</span> <span m='3372770'>the</span> <span m='3372890'>leading</span>
  <span m='3373400'>log</span> <span m='3373640'>nk</span> <span m='3373790'>bits</span>
  <span m='3374150'>especially,</span> <span m='3374870'>because</span> <span m='3376250'>this</span>
  <span m='3376460'>is</span> <span m='3376580'>a</span> <span m='3376640'>sorted</span>
  <span m='3378470'>list</span> <span m='3378710'>of</span> <span m='3378770'>bit</span>
  <span m='3378950'>vectors.</span> <span m='3380190'>So</span> <span m='3380420'>if</span>
  <span m='3380660'>you</span> <span m='3380750'>look</span> <span m='3380990'>at</span>
  <span m='3381110'>the</span> <span m='3382490'>leading</span> <span m='3382850'>bits,</span>
  <span m='3383090'>most</span> <span m='3383300'>of</span> <span m='3383360'>the</span>
  <span m='3383420'>time,</span> <span m='3383730'>they're</span> <span m='3383830'>going</span>
  <span m='3383840'>to</span> <span m='3383900'>be</span> <span m='3383990'>the</span>
  <span m='3384080'>same.</span> <span m='3384660'>They</span> <span m='3384680'>don't</span>
  <span m='3384860'>change</span> <span m='3385130'>very</span> <span m='3385280'>much.</span>
  <span m='3386300'>Leading</span> <span m='3386570'>bits</span> <span m='3386780'>are</span>
  <span m='3386840'>going</span> <span m='3386960'>to</span> <span m='3387050'>be</span>
  <span m='3387270'>all</span> <span m='3387920'>0's</span> <span m='3388250'>for</span>
  <span m='3388370'>a</span> <span m='3388400'>while,</span> <span m='3388850'>and</span>
  <span m='3388940'>then</span> <span m='3389060'>occasionally</span> <span m='3389540'>they'll</span>
  <span m='3389780'>increment.</span> <span m='3390530'>How</span> <span m='3390680'>many</span>
  <span m='3390830'>times</span> <span m='3391070'>will</span> <span m='3391180'>it</span>
  <span m='3391250'>increment?</span> <span m='3391640'>nk</span> <span m='3391950'>times,</span>
  <span m='3392540'>at</span> <span m='3392660'>most,</span> <span m='3393736'>if</span>
  <span m='3394080'>we</span> <span m='3394190'>look</span> <span m='3394370'>at</span>
  <span m='3394430'>the</span> <span m='3394520'>leading</span> <span m='3395370'>log</span>
  <span m='3395720'>nk</span> <span m='3396010'>bits.</span> </p><p><span m='3408550'>Here's</span>
  <span m='3408850'>the</span> <span m='3408940'>crazy</span> <span m='3409240'>idea,</span>
  <span m='3409510'>we're</span> <span m='3409570'>going</span> <span m='3409690'>to</span>
  <span m='3409780'>use</span> <span m='3409960'>unary</span> <span m='3410410'>encoding,</span>
  <span m='3411670'>unary</span> <span m='3412000'>differential</span> <span m='3412660'>encoding.</span>
  <span m='3419440'>Differential</span> <span m='3420010'>encoding</span> <span m='3420430'>means,</span>
  <span m='3420670'>instead</span> <span m='3420970'>of</span> <span m='3421060'>storing</span>
  <span m='3421390'>a</span> <span m='3421480'>list</span> <span m='3421750'>of</span>
  <span m='3421810'>values,</span> <span m='3422320'>you</span> <span m='3422440'>store</span>
  <span m='3423160'>the</span> <span m='3423250'>first</span> <span m='3423490'>value.</span>
  <span m='3423910'>Then</span> <span m='3424080'>the</span> <span m='3425680'>next</span>
  <span m='3425920'>value,</span> <span m='3426220'>minus</span> <span m='3426760'>the</span>
  <span m='3426910'>first</span> <span m='3427210'>value,</span> <span m='3427540'>and</span>
  <span m='3427630'>then</span> <span m='3427750'>the</span> <span m='3427810'>next</span>
  <span m='3427990'>value</span> <span m='3428260'>minus</span> <span m='3428680'>that</span>
  <span m='3428860'>value,</span> <span m='3429220'>and</span> <span m='3429310'>so</span>
  <span m='3429430'>on.</span> </p><p><span m='3430450'>And</span> <span m='3430720'>unary</span>
  <span m='3431140'>means</span> <span m='3431350'>we're</span> <span m='3431410'>going</span>
  <span m='3431530'>to</span> <span m='3431590'>represent</span> <span m='3431950'>those</span>
  <span m='3432100'>differences</span> <span m='3432640'>in</span> <span m='3432850'>unary.</span>
  <span m='3434650'>Seems</span> <span m='3434920'>like</span> <span m='3435070'>a</span>
  <span m='3435130'>bad</span> <span m='3435340'>idea,</span> <span m='3435660'>but</span>
  <span m='3435790'>it</span> <span m='3435850'>turns</span> <span m='3436120'>out</span>
  <span m='3436330'>it's</span> <span m='3436570'>a</span> <span m='3436630'>good</span>
  <span m='3436780'>idea.</span> <span m='3438370'>So</span> <span m='3438520'>here's</span>
  <span m='3438700'>what</span> <span m='3438820'>it</span> <span m='3438880'>looks</span>
  <span m='3439090'>like,</span> <span m='3439330'>you</span> <span m='3439450'>look</span>
  <span m='3439660'>at--</span> <span m='3440230'>I'm</span> <span m='3440560'>going</span>
  <span m='3440680'>to</span> <span m='3440755'>write</span> <span m='3440830'>down</span>
  <span m='3441040'>0.</span> <span m='3442020'>I'm</span> <span m='3442090'>going</span>
  <span m='3442210'>to</span> <span m='3442270'>write</span> <span m='3442420'>down</span>
  <span m='3442570'>a</span> <span m='3442630'>bunch</span> <span m='3442870'>of</span>
  <span m='3442930'>0's,</span> <span m='3443410'>however</span> <span m='3443830'>big</span>
  <span m='3445220'>v1</span> <span m='3446050'>is.</span> <span m='3447270'>Then</span>
  <span m='3447430'>I'm</span> <span m='3447640'>going</span> <span m='3447760'>to</span>
  <span m='3447820'>write</span> <span m='3448000'>a</span> <span m='3448140'>1.</span>
  <span m='3448630'>Then</span> <span m='3448810'>I'm</span> <span m='3448870'>going</span>
  <span m='3448970'>to</span> <span m='3449080'>write</span> <span m='3449410'>a</span>
  <span m='3449470'>bunch</span> <span m='3449710'>of</span> <span m='3449770'>0's,</span>
  <span m='3450250'>however</span> <span m='3450670'>big</span> <span m='3453670'>v2</span>
  <span m='3454090'>minus</span> <span m='3454390'>v1</span> <span m='3454840'>is.</span>
  </p><p><span m='3455510'>Then</span> <span m='3455700'>I'll</span> <span m='3455800'>write</span>
  <span m='3455950'>a</span> <span m='3456050'>1,</span> <span m='3457120'>and</span>
  <span m='3457240'>so</span> <span m='3457440'>on.</span> <span m='3459130'>0</span>
  <span m='3459980'>to</span> <span m='3460150'>the</span> <span m='3460270'>lead,</span>
  <span m='3461680'>the</span> <span m='3461770'>leading</span> <span m='3462070'>bits</span>
  <span m='3462370'>of</span> <span m='3462630'>v--</span> <span m='3463200'>sorry.</span>
  <span m='3464340'>It's</span> <span m='3464790'>the</span> <span m='3464890'>leading</span>
  <span m='3465190'>bits</span> <span m='3465400'>of</span> <span m='3465640'>v2</span>
  <span m='3466600'>minus</span> <span m='3467170'>the</span> <span m='3467260'>leading</span>
  <span m='3467530'>bits</span> <span m='3468350'>of</span> <span m='3468780'>v1.</span>
  <span m='3469190'>That's</span> <span m='3469460'>what</span> <span m='3469730'>I</span>
  <span m='3469945'>meant.</span> <span m='3471960'>And</span> <span m='3472110'>then</span>
  <span m='3472350'>leading</span> <span m='3472600'>bits</span> <span m='3472800'>of</span>
  <span m='3472950'>v3</span> <span m='3473300'>minus</span> <span m='3473650'>the</span>
  <span m='3473710'>leading</span> <span m='3474010'>bits</span> <span m='3474765'>of</span>
  <span m='3475190'>v2.</span> <span m='3476240'>And</span> <span m='3476400'>then</span>
  <span m='3476950'>1,</span> <span m='3477070'>and</span> <span m='3477130'>so</span>
  <span m='3477190'>on.</span> </p><p><span m='3479860'>OK,</span> <span m='3480130'>that</span>
  <span m='3480310'>is</span> <span m='3480550'>unary</span> <span m='3480910'>differential</span>
  <span m='3481540'>encoding.</span> <span m='3482290'>I</span> <span m='3482380'>claim</span>
  <span m='3482950'>this</span> <span m='3483130'>is</span> <span m='3483220'>small,</span>
  <span m='3483940'>looks</span> <span m='3484180'>kind</span> <span m='3484390'>of</span>
  <span m='3484480'>crazy.</span> <span m='3485380'>But</span> <span m='3485530'>it's</span>
  <span m='3485620'>small,</span> <span m='3486280'>because</span> <span m='3487060'>how</span>
  <span m='3487270'>many</span> <span m='3487510'>0's</span> <span m='3487930'>are</span>
  <span m='3488020'>there</span> <span m='3488170'>total?</span> <span m='3489210'>Well,</span>
  <span m='3489420'>at</span> <span m='3489610'>most,</span> <span m='3489960'>nk</span>
  <span m='3490460'>0's.</span> <span m='3491050'>Because</span> <span m='3491710'>I</span>
  <span m='3491740'>start</span> <span m='3493390'>at</span> <span m='3493690'>the</span>
  <span m='3493810'>value</span> <span m='3494160'>0.</span> <span m='3495340'>With</span>
  <span m='3495580'>log</span> <span m='3495850'>nk</span> <span m='3496140'>bits,</span>
  <span m='3496360'>at</span> <span m='3496450'>most</span> <span m='3496670'>I</span>
  <span m='3496750'>get</span> <span m='3496900'>up</span> <span m='3497020'>to</span>
  <span m='3497410'>n</span> <span m='3497590'>k</span> <span m='3497830'>minus</span>
  <span m='3497890'>1.</span> </p><p><span m='3498760'>So</span> <span m='3498860'>the</span>
  <span m='3498910'>number</span> <span m='3499180'>of</span> <span m='3499240'>times</span>
  <span m='3499510'>I</span> <span m='3499570'>increment</span> <span m='3500760'>is,</span>
  <span m='3501080'>at</span> <span m='3501200'>most,</span> <span m='3502160'>nk.</span>
  <span m='3505660'>How</span> <span m='3505780'>many</span> <span m='3506020'>1's</span>
  <span m='3506380'>are</span> <span m='3506530'>there?</span> <span m='3510040'>Well,</span>
  <span m='3510310'>there's</span> <span m='3510940'>one</span> <span m='3511960'>1,</span>
  <span m='3512560'>per</span> <span m='3512830'>value.</span> <span m='3514030'>So</span>
  <span m='3514150'>there's</span> <span m='3514360'>nk</span> <span m='3514810'>over</span>
  <span m='3514990'>2</span> <span m='3515200'>1's.</span> <span m='3520840'>So</span>
  <span m='3521060'>total</span> <span m='3521360'>size</span> <span m='3521600'>of</span>
  <span m='3521660'>this</span> <span m='3521810'>bit</span> <span m='3521990'>factor</span>
  <span m='3523160'>is</span> <span m='3524510'>3/2</span> <span m='3525870'>nk.</span>
  <span m='3528580'>So</span> <span m='3528770'>storing</span> <span m='3529190'>those</span>
  <span m='3529370'>leading</span> <span m='3529670'>bits</span> <span m='3531110'>in</span>
  <span m='3531320'>this</span> <span m='3531500'>weird</span> <span m='3531770'>way</span>
  <span m='3532430'>is</span> <span m='3532610'>cheap.</span> </p><p><span m='3534630'>Linear--</span>
  <span m='3536060'>again,</span> <span m='3536540'>this</span> <span m='3536600'>geometric</span>
  <span m='3537080'>series</span> <span m='3537470'>is</span> <span m='3537530'>going</span>
  <span m='3537590'>to</span> <span m='3537650'>add</span> <span m='3537800'>up</span>
  <span m='3537920'>to</span> <span m='3538040'>3/2.</span> <span m='3539240'>All</span>
  <span m='3539330'>right,</span> <span m='3539660'>it's</span> <span m='3539780'>going</span>
  <span m='3539930'>to</span> <span m='3539990'>add</span> <span m='3540140'>up</span>
  <span m='3540260'>to</span> <span m='3541310'>3</span> <span m='3541610'>times</span>
  <span m='3541940'>n.</span> <span m='3544640'>Cool.</span> <span m='3547050'>But</span>
  <span m='3547140'>that's</span> <span m='3547350'>just</span> <span m='3547530'>the</span>
  <span m='3547620'>leading</span> <span m='3547920'>bits--</span> <span m='3548340'>I</span>
  <span m='3548430'>need</span> <span m='3548610'>to</span> <span m='3548700'>store</span>
  <span m='3548940'>this</span> <span m='3549120'>thing.</span> <span m='3549960'>I</span>
  <span m='3550080'>need</span> <span m='3550230'>to</span> <span m='3550290'>store</span>
  <span m='3550390'>the</span> <span m='3550490'>leading</span> <span m='3550770'>bits,</span>
  <span m='3551020'>and</span> <span m='3551160'>I</span> <span m='3551280'>need</span>
  <span m='3551400'>to</span> <span m='3551460'>store</span> <span m='3551730'>the</span>
  <span m='3551850'>remaining</span> <span m='3552240'>bits.</span> </p><p><span m='3552640'>Now</span>
  <span m='3553170'>the</span> <span m='3553260'>remaining</span> <span m='3553680'>bits,</span>
  <span m='3553860'>there's</span> <span m='3553980'>only</span> <span m='3554220'>2</span>
  <span m='3554450'>to</span> <span m='3554520'>the</span> <span m='3554610'>k</span>
  <span m='3554880'>remaining</span> <span m='3555330'>bits.</span> <span m='3555660'>We</span>
  <span m='3555810'>switched</span> <span m='3556110'>the</span> <span m='3556290'>order.</span>
  <span m='3557040'>We</span> <span m='3557130'>looked</span> <span m='3557310'>at</span>
  <span m='3557370'>the</span> <span m='3557490'>high</span> <span m='3557850'>log</span>
  <span m='3558270'>nk</span> <span m='3558560'>bits,</span> <span m='3558900'>but</span>
  <span m='3558990'>then</span> <span m='3559140'>the</span> <span m='3559230'>low</span>
  <span m='3559500'>end</span> <span m='3559620'>bits,</span> <span m='3559920'>there's</span>
  <span m='3560040'>going</span> <span m='3560170'>to</span> <span m='3560250'>be</span>
  <span m='3560310'>2</span> <span m='3560550'>to</span> <span m='3560670'>the</span>
  <span m='3560790'>k</span> <span m='3560835'>of</span> <span m='3560880'>them.</span>
  <span m='3561390'>That</span> <span m='3561600'>I</span> <span m='3561660'>already</span>
  <span m='3561840'>said</span> <span m='3562080'>was</span> <span m='3563010'>OK.</span>
  <span m='3563700'>We</span> <span m='3563790'>could</span> <span m='3563910'>afford</span>
  <span m='3564180'>that--</span> <span m='3565890'>kind</span> <span m='3566250'>of,</span>
  <span m='3566760'>we'd</span> <span m='3566920'>lose</span> <span m='3567090'>a</span>
  <span m='3567150'>log</span> <span m='3567360'>log</span> <span m='3567540'>factor.</span>
  </p><p><span m='3570020'>So</span> <span m='3570150'>we</span> <span m='3570210'>store</span>
  <span m='3570450'>the</span> <span m='3570540'>trailing</span> <span m='3571620'>2</span>
  <span m='3571870'>of</span> <span m='3571960'>the</span> <span m='3572040'>k</span>
  <span m='3572300'>bits.</span> <span m='3574430'>This</span> <span m='3574860'>we</span>
  <span m='3575010'>actually</span> <span m='3575550'>store</span> <span m='3576200'>explicitly.</span>
  <span m='3581280'>So</span> <span m='3581520'>this</span> <span m='3581730'>is</span>
  <span m='3581820'>going</span> <span m='3581940'>to</span> <span m='3582060'>be</span>
  <span m='3582210'>2</span> <span m='3582420'>to</span> <span m='3582530'>the</span>
  <span m='3582720'>k</span> <span m='3583110'>times</span> <span m='3584350'>nk</span>
  <span m='3584850'>over</span> <span m='3585090'>2,</span> <span m='3586561'>which</span>
  <span m='3586940'>is</span> <span m='3588130'>n/2</span> <span m='3588750'>bits.</span>
  <span m='3590520'>nk</span> <span m='3591090'>is</span> <span m='3591450'>n</span>
  <span m='3591570'>over</span> <span m='3591720'>2</span> <span m='3591795'>to</span>
  <span m='3591870'>the</span> <span m='3591960'>k.</span> <span m='3592840'>Cancel,</span>
  <span m='3594220'>n</span> <span m='3594440'>over</span> <span m='3594710'>2.</span>
  </p><p><span m='3596650'>OK,</span> <span m='3598080'>so</span> <span m='3598290'>total</span>
  <span m='3598590'>number</span> <span m='3598800'>of</span> <span m='3598860'>bits--</span>
  <span m='3599100'>we</span> <span m='3599220'>add</span> <span m='3599400'>these</span>
  <span m='3599580'>up--</span> <span m='3600880'>is</span> <span m='3601080'>going</span>
  <span m='3601230'>to</span> <span m='3601320'>be</span> <span m='3604950'>1/2</span>
  <span m='3605250'>n</span> <span m='3605760'>plus</span> <span m='3606210'>3/2</span>
  <span m='3606750'>nk</span> <span m='3608490'>plus--</span> <span m='3611130'>we'll</span>
  <span m='3611280'>get</span> <span m='3611410'>to</span> <span m='3611520'>this</span>
  <span m='3611700'>later.</span> <span m='3613410'>And</span> <span m='3613560'>then</span>
  <span m='3613680'>the</span> <span m='3613770'>total,</span> <span m='3616585'>this</span>
  <span m='3617040'>we</span> <span m='3617160'>have</span> <span m='3617310'>to</span>
  <span m='3617400'>do</span> <span m='3617610'>for</span> <span m='3617820'>log</span>
  <span m='3618120'>log</span> <span m='3618360'>n</span> <span m='3618510'>levels.</span>
  <span m='3619710'>We're</span> <span m='3619800'>summing</span> <span m='3621130'>k</span>
  <span m='3621600'>equals</span> <span m='3621960'>0</span> <span m='3622215'>to</span>
  <span m='3622470'>log</span> <span m='3622730'>log</span> <span m='3622990'>n.</span>
  <span m='3625170'>This</span> <span m='3625380'>thing.</span> </p><p><span m='3626940'>And</span>
  <span m='3628020'>this</span> <span m='3628740'>comes</span> <span m='3628980'>out</span>
  <span m='3629160'>to</span> <span m='3630030'>1/2</span> <span m='3630630'>n</span>
  <span m='3631440'>log</span> <span m='3631740'>log</span> <span m='3631980'>n.</span>
  <span m='3633690'>This</span> <span m='3633800'>is</span> <span m='3633990'>bad,</span>
  <span m='3634380'>we</span> <span m='3634470'>want</span> <span m='3634620'>to</span>
  <span m='3634680'>get</span> <span m='3634800'>rid</span> <span m='3634920'>of</span>
  <span m='3634980'>that.</span> <span m='3635270'>But</span> <span m='3635430'>that</span>
  <span m='3635560'>was</span> <span m='3635680'>our</span> <span m='3635790'>first</span>
  <span m='3636750'>aim,</span> <span m='3637470'>then</span> <span m='3637620'>we</span>
  <span m='3637740'>have</span> <span m='3640160'>5n--</span> <span m='3642660'>did</span>
  <span m='3642870'>I</span> <span m='3643120'>miss</span> <span m='3643370'>a</span>
  <span m='3643440'>term?</span> <span m='3647770'>OK.</span> <span m='3653555'>Where</span>
  <span m='3653677'>did</span> <span m='3653799'>I</span> <span m='3653921'>miss</span>
  <span m='3654046'>the</span> <span m='3654537'>nk?</span> </p><p><span m='3657060'>This</span>
  <span m='3657810'>was</span> <span m='3657960'>the</span> <span m='3658080'>cost</span>
  <span m='3658410'>for</span> <span m='3658560'>even</span> <span m='3658830'>successor.</span>
  <span m='3661450'>OK,</span> <span m='3661830'>but</span> <span m='3662010'>there</span>
  <span m='3662130'>was</span> <span m='3662250'>also,</span> <span m='3663110'>is</span>
  <span m='3663300'>even</span> <span m='3663540'>suffix,</span> <span m='3664110'>which</span>
  <span m='3664260'>was</span> <span m='3664380'>nk</span> <span m='3664700'>bits,</span>
  <span m='3665010'>and</span> <span m='3665100'>there</span> <span m='3665190'>was</span>
  <span m='3665310'>even</span> <span m='3665610'>rank,</span> <span m='3666450'>which</span>
  <span m='3666600'>was</span> <span m='3666740'>little o</span> <span m='3667070'>of</span>
  <span m='3667170'>that.</span> <span m='3668010'>So</span> <span m='3668160'>there's</span>
  <span m='3668310'>an</span> <span m='3668400'>extra</span> <span m='3669030'>nk</span>
  <span m='3669390'>here</span> <span m='3669660'>for</span> <span m='3671100'>is</span>
  <span m='3672240'>even</span> <span m='3672720'>suffix.</span> </p><p><span m='3677760'>OK,</span>
  <span m='3678090'>so</span> <span m='3678300'>we</span> <span m='3678390'>have</span>
  <span m='3678780'>nk</span> <span m='3679380'>plus</span> <span m='3679620'>3/2</span>
  <span m='3680160'>nk.</span> <span m='3680490'>That's</span> <span m='3681150'>5/2</span>
  <span m='3681480'>nk.</span> <span m='3682080'>And</span> <span m='3682200'>then</span>
  <span m='3682410'>the</span> <span m='3682530'>1/2</span> <span m='3682980'>disappears</span>
  <span m='3683550'>because</span> <span m='3683700'>it's</span> <span m='3683850'>a</span>
  <span m='3683910'>geometric</span> <span m='3684360'>series.</span> <span m='3684840'>So</span>
  <span m='3684940'>we</span> <span m='3685040'>end</span> <span m='3685140'>up</span>
  <span m='3685240'>with</span> <span m='3685540'>5n,</span> <span m='3687330'>for</span>
  <span m='3687540'>what</span> <span m='3687630'>it's</span> <span m='3687750'>worth.</span>
  <span m='3688710'>Plus</span> <span m='3689040'>big</span> <span m='3689390'>O</span>
  <span m='3689800'>of</span> <span m='3690285'>something.</span> </p><p><span m='3690770'>OK,</span>
  <span m='3691230'>I</span> <span m='3691500'>left</span> <span m='3691740'>out</span>
  <span m='3691950'>something,</span> <span m='3692310'>because</span> <span m='3692580'>there's</span>
  <span m='3692730'>one</span> <span m='3693120'>data</span> <span m='3693330'>structure</span>
  <span m='3693810'>we</span> <span m='3693990'>haven't</span> <span m='3694290'>yet</span>
  <span m='3694990'>described.</span> <span m='3695640'>There's</span> <span m='3695670'>one</span>
  <span m='3695850'>more</span> <span m='3696000'>thing</span> <span m='3696210'>we</span>
  <span m='3696330'>need.</span> <span m='3697290'>And</span> <span m='3697620'>that</span>
  <span m='3697950'>comes</span> <span m='3698250'>up</span> <span m='3698430'>if</span>
  <span m='3698610'>you</span> <span m='3698700'>want</span> <span m='3698850'>to</span>
  <span m='3698910'>do</span> <span m='3699030'>a</span> <span m='3699060'>query</span>
  <span m='3699450'>in</span> <span m='3699540'>the</span> <span m='3699630'>structure.</span>
  <span m='3700230'>How</span> <span m='3700410'>do</span> <span m='3700530'>I</span>
  <span m='3700590'>do</span> <span m='3700740'>a</span> <span m='3700830'>query?</span>
  </p><p><span m='3704490'>I</span> <span m='3704600'>already</span> <span m='3704850'>did</span>
  <span m='3705060'>odd</span> <span m='3705330'>rank,</span> <span m='3706230'>so</span>
  <span m='3706380'>I'm</span> <span m='3706470'>just</span> <span m='3706620'>trying</span>
  <span m='3706800'>to</span> <span m='3706890'>look</span> <span m='3707190'>up</span>
  <span m='3707370'>into</span> <span m='3707610'>the</span> <span m='3707730'>sorted</span>
  <span m='3708150'>array,</span> <span m='3708420'>at</span> <span m='3708630'>a</span>
  <span m='3708690'>given</span> <span m='3708990'>index.</span> <span m='3710430'>Well,</span>
  <span m='3711540'>first</span> <span m='3711870'>thing</span> <span m='3712410'>is</span>
  <span m='3712680'>to</span> <span m='3712920'>compute</span> <span m='3714000'>the</span>
  <span m='3714090'>leading</span> <span m='3714390'>bits.</span> <span m='3715740'>Actually,</span>
  <span m='3715980'>computing</span> <span m='3716340'>leading</span> <span m='3716580'>bits</span>
  <span m='3716790'>is</span> <span m='3716880'>really</span> <span m='3717060'>easy</span>
  <span m='3718650'>if</span> <span m='3718860'>I</span> <span m='3718980'>have</span>
  <span m='3719280'>rank</span> <span m='3719520'>and</span> <span m='3719590'>select.</span>
  <span m='3720720'>What</span> <span m='3720900'>I</span> <span m='3720990'>want,</span>
  <span m='3721800'>if</span> <span m='3721920'>I'm</span> <span m='3722220'>trying</span>
  <span m='3722460'>to</span> <span m='3722550'>index</span> <span m='3722970'>into</span>
  <span m='3724040'>index</span> <span m='3724690'>i,</span> <span m='3725590'>I</span>
  <span m='3726000'>want</span> <span m='3726210'>the</span> <span m='3726360'>i-th</span>
  <span m='3726660'>one</span> <span m='3726900'>bit.</span> </p><p><span m='3727860'>To</span>
  <span m='3727980'>look</span> <span m='3728130'>at</span> <span m='3728190'>the</span>
  <span m='3728310'>i-th</span> <span m='3728580'>one</span> <span m='3728790'>bit,</span>
  <span m='3729340'>which</span> <span m='3729390'>is</span> <span m='3730590'>select</span>
  <span m='3733210'>sub</span> <span m='3733630'>1</span> <span m='3734365'>of</span>
  <span m='3734730'>i,</span> <span m='3735000'>which</span> <span m='3735390'>we</span>
  <span m='3735780'>already</span> <span m='3735990'>know</span> <span m='3736110'>how</span>
  <span m='3736260'>to</span> <span m='3736350'>do,</span> <span m='3738690'>then</span>
  <span m='3738960'>that</span> <span m='3739260'>corresponds</span> <span m='3740010'>to</span>
  <span m='3741800'>the</span> <span m='3741980'>i-th</span> <span m='3742290'>value.</span>
  <span m='3744040'>And</span> <span m='3744390'>in</span> <span m='3744600'>particular,</span>
  <span m='3745180'>if</span> <span m='3745280'>I</span> <span m='3745380'>look</span>
  <span m='3745410'>at</span> <span m='3745500'>how</span> <span m='3745770'>many</span>
  <span m='3745980'>0's</span> <span m='3746520'>are</span> <span m='3746670'>there</span>
  <span m='3746940'>up</span> <span m='3747120'>to</span> <span m='3747270'>that</span>
  <span m='3747480'>point,</span> <span m='3750390'>it's</span> <span m='3750570'>going</span>
  <span m='3750680'>to</span> <span m='3750780'>be</span> <span m='3750930'>the</span>
  <span m='3751050'>sum</span> <span m='3751380'>of</span> <span m='3751500'>this.</span>
  <span m='3751950'>Plus</span> <span m='3752250'>this,</span> <span m='3752700'>plus</span>
  <span m='3752970'>this,</span> <span m='3753420'>it's</span> <span m='3753570'>a</span>
  <span m='3753630'>telescoping</span> <span m='3754290'>sum.</span> </p><p><span
  m='3755220'>It's</span> <span m='3755400'>just</span> <span m='3755580'>going</span>
  <span m='3755700'>to</span> <span m='3755760'>give</span> <span m='3755910'>me</span>
  <span m='3756330'>the</span> <span m='3756420'>leading</span> <span m='3756750'>bits.</span>
  <span m='3759380'>Because</span> <span m='3760100'>this</span> <span m='3760340'>plus</span>
  <span m='3760580'>this</span> <span m='3760910'>is</span> <span m='3761060'>just</span>
  <span m='3761210'>lead</span> <span m='3761640'>of</span> <span m='3761960'>v2.</span>
  <span m='3762350'>This</span> <span m='3762710'>plus</span> <span m='3762950'>that</span>
  <span m='3763730'>is</span> <span m='3763910'>lead</span> <span m='3764020'>of</span>
  <span m='3764130'>v3.</span> <span m='3764930'>So</span> <span m='3765020'>they</span>
  <span m='3765120'>all</span> <span m='3765260'>cancel.</span> <span m='3766150'>I</span>
  <span m='3766190'>just</span> <span m='3766340'>count</span> <span m='3766580'>the</span>
  <span m='3766640'>number</span> <span m='3766910'>of</span> <span m='3767015'>0</span>
  <span m='3767120'>bits.</span> <span m='3767360'>That's</span> <span m='3767600'>exactly</span>
  <span m='3768530'>the</span> <span m='3768620'>value</span> <span m='3768950'>I</span>
  <span m='3769040'>want</span> <span m='3769220'>to</span> <span m='3769280'>know.</span>
  <span m='3770540'>So</span> <span m='3770750'>I</span> <span m='3770810'>want</span>
  <span m='3770990'>to</span> <span m='3771080'>do</span> <span m='3771830'>rank</span>
  <span m='3773240'>sub</span> <span m='3773606'>0</span> <span m='3774340'>of</span>
  <span m='3774530'>that</span> <span m='3774770'>position.</span> <span m='3776960'>That</span>
  <span m='3777170'>will</span> <span m='3777290'>tell</span> <span m='3777500'>me</span>
  <span m='3777650'>the</span> <span m='3777740'>leading</span> <span m='3778040'>bits.</span>
  <span m='3780780'>In</span> <span m='3780950'>a</span> <span m='3781010'>query,</span>
  <span m='3785720'>it's</span> <span m='3785870'>not</span> <span m='3786020'>really</span>
  <span m='3786170'>lead</span> <span m='3786320'>of</span> <span m='3786610'>i,</span>
  <span m='3786930'>I</span> <span m='3787250'>guess.</span> <span m='3788730'>Lead</span>
  <span m='3789170'>of</span> <span m='3789460'>vi</span> <span m='3791420'>is</span>
  <span m='3791560'>what</span> <span m='3791700'>we're</span> <span m='3791840'>trying</span>
  <span m='3792020'>to</span> <span m='3792110'>compute.</span> </p><p><span m='3793370'>Now,</span>
  <span m='3793520'>we</span> <span m='3793610'>also</span> <span m='3793790'>need</span>
  <span m='3793940'>the</span> <span m='3794030'>trailing</span> <span m='3794390'>bits.</span>
  <span m='3794540'>The</span> <span m='3794600'>trailing</span> <span m='3794930'>bits,</span>
  <span m='3795130'>they're</span> <span m='3795280'>just</span> <span m='3795440'>in</span>
  <span m='3795560'>an</span> <span m='3795650'>array,</span> <span m='3796090'>so</span>
  <span m='3796130'>you</span> <span m='3796190'>just</span> <span m='3796310'>look</span>
  <span m='3796490'>that</span> <span m='3796670'>up.</span> <span m='3797220'>You</span>
  <span m='3797300'>get</span> <span m='3797420'>the</span> <span m='3797510'>trailing</span>
  <span m='3797810'>bits.</span> <span m='3798020'>You</span> <span m='3798110'>concatenate</span>
  <span m='3798650'>those</span> <span m='3798860'>two</span> <span m='3799040'>words,</span>
  <span m='3799820'>the</span> <span m='3799900'>leading</span> <span m='3800180'>bits</span>
  <span m='3800360'>of</span> <span m='3800420'>the</span> <span m='3800510'>trailing</span>
  <span m='3800810'>bits--</span> <span m='3801050'>boom,</span> <span m='3801800'>you</span>
  <span m='3801920'>have</span> <span m='3802100'>your</span> <span m='3802220'>answer.</span>
  </p><p><span m='3802730'>That</span> <span m='3802880'>gives</span> <span m='3803060'>you</span>
  <span m='3803150'>the</span> <span m='3803260'>even</span> <span m='3803480'>successor.</span>
  <span m='3805820'>So</span> <span m='3806660'>the</span> <span m='3806780'>only</span>
  <span m='3807020'>thing</span> <span m='3807230'>is</span> <span m='3807380'>we</span>
  <span m='3807470'>need</span> <span m='3807620'>to</span> <span m='3807710'>store</span>
  <span m='3808130'>rank</span> <span m='3808400'>and</span> <span m='3808490'>a</span>
  <span m='3808550'>select</span> <span m='3808880'>structure.</span> <span m='3810020'>And</span>
  <span m='3810260'>for</span> <span m='3810440'>rank,</span> <span m='3810950'>we</span>
  <span m='3811190'>used</span> <span m='3813830'>nk</span> <span m='3814020'>over</span>
  <span m='3814190'>log</span> <span m='3814460'>log</span> <span m='3814880'>nk</span>
  <span m='3815180'>space.</span> <span m='3816320'>Again,</span> <span m='3816560'>that</span>
  <span m='3816710'>can</span> <span m='3816860'>be</span> <span m='3816950'>improved</span>
  <span m='3817330'>to</span> <span m='3817510'>nk</span> <span m='3817690'>over</span>
  <span m='3818210'>polylog</span> <span m='3818870'>nk.</span> <span m='3819130'>But</span>
  <span m='3819980'>let's</span> <span m='3820130'>not</span> <span m='3820280'>worry</span>
  <span m='3820430'>about</span> <span m='3820640'>that.</span> </p><p><span m='3832290'>Item</span>
  <span m='3832740'>1</span> <span m='3833010'>completes.</span> <span m='3834700'>We</span>
  <span m='3834720'>now</span> <span m='3834900'>have</span> <span m='3835170'>a</span>
  <span m='3835230'>T</span> <span m='3835500'>log</span> <span m='3835770'>log</span>
  <span m='3836010'>T</span> <span m='3836370'>bit</span> <span m='3836670'>suffix</span>
  <span m='3837090'>array.</span> <span m='3839410'>Next,</span> <span m='3839610'>we</span>
  <span m='3839700'>need</span> <span m='3839850'>to</span> <span m='3839940'>make</span>
  <span m='3840120'>it</span> <span m='3840180'>order</span> <span m='3840350'>T,</span>
  <span m='3841950'>then</span> <span m='3842220'>we</span> <span m='3842340'>need</span>
  <span m='3842520'>to</span> <span m='3843040'>make</span> <span m='3843240'>it</span>
  <span m='3843300'>into</span> <span m='3843500'>suffix</span> <span m='3843910'>tree.</span>
  <span m='3845436'>We're</span> <span m='3845580'>going</span> <span m='3845724'>to</span>
  <span m='3845868'>move</span> <span m='3846012'>a</span> <span m='3846156'>little</span>
  <span m='3846300'>faster.</span> <span m='3851570'>Where</span> <span m='3851780'>to</span>
  <span m='3851930'>go</span> <span m='3852200'>now?</span> </p><p><span m='3862080'>Now</span>
  <span m='3862145'>I</span> <span m='3862210'>want</span> <span m='3862650'>a</span>
  <span m='3863055'>compact</span> <span m='3863460'>suffix</span> <span m='3863940'>array.</span>
  <span m='3871670'>I'm</span> <span m='3871790'>going</span> <span m='3871910'>to</span>
  <span m='3872000'>use</span> <span m='3872180'>the</span> <span m='3872280'>same</span>
  <span m='3872630'>definition.</span> <span m='3873770'>Everything's</span> <span
  m='3874260'>going</span> <span m='3874340'>to</span> <span m='3874440'>be</span>
  <span m='3874550'>more</span> <span m='3874730'>or</span> <span m='3874760'>less</span>
  <span m='3875000'>the</span> <span m='3875090'>same.</span> <span m='3877040'>I</span>
  <span m='3877130'>just</span> <span m='3877280'>can't</span> <span m='3877520'>afford</span>
  <span m='3877820'>to</span> <span m='3877910'>store</span> <span m='3878210'>all</span>
  <span m='3878360'>these</span> <span m='3878510'>levels.</span> <span m='3884040'>There</span>
  <span m='3884160'>were</span> <span m='3884250'>log</span> <span m='3884490'>log</span>
  <span m='3884690'>n</span> <span m='3884850'>levels.</span> <span m='3885200'>Log
  log</span> <span m='3885610'>n</span> <span m='3885860'>levels</span> <span m='3886200'>is</span>
  <span m='3886320'>too</span> <span m='3886530'>expensive.</span> <span m='3887100'>Each</span>
  <span m='3887280'>one</span> <span m='3887490'>costs</span> <span m='3887760'>linear</span>
  <span m='3888060'>space.</span> <span m='3889240'>So</span> <span m='3889350'>I'm</span>
  <span m='3889440'>only</span> <span m='3889590'>going</span> <span m='3889740'>to</span>
  <span m='3889800'>store</span> <span m='3890090'>a</span> <span m='3890260'>constant</span>
  <span m='3890719'>number</span> <span m='3891178'>of</span> <span m='3891637'>levels.</span>
  </p><p><span m='3894850'>Only</span> <span m='3895310'>store</span> <span m='3897920'>1</span>
  <span m='3898480'>over</span> <span m='3898700'>epsilon</span> <span m='3899270'>plus</span>
  <span m='3899600'>1</span> <span m='3899870'>levels.</span> <span m='3903350'>And</span>
  <span m='3903560'>not</span> <span m='3903710'>just</span> <span m='3903890'>any</span>
  <span m='3904070'>levels,</span> <span m='3904730'>but</span> <span m='3905300'>the</span>
  <span m='3905420'>first</span> <span m='3905660'>level,</span> <span m='3906410'>the</span>
  <span m='3906710'>epsilon</span> <span m='3906965'>l-th</span> <span m='3907520'>level,</span>
  <span m='3908030'>the</span> <span m='3908380'>2</span> <span m='3908690'>epsilon</span>
  <span m='3909200'>l-th</span> <span m='3909470'>level,</span> <span m='3910390'>up</span>
  <span m='3910580'>to</span> <span m='3910790'>the</span> <span m='3910970'>l-th</span>
  <span m='3911270'>level.</span> <span m='3911660'>So</span> <span m='3911745'>it's</span>
  <span m='3911830'>still</span> <span m='3912110'>log</span> <span m='3912380'>log</span>
  <span m='3912620'>n</span> <span m='3912770'>levels.</span> <span m='3914486'>I'm</span>
  <span m='3914890'>just</span> <span m='3915050'>going</span> <span m='3915170'>to</span>
  <span m='3915230'>skip</span> <span m='3915590'>a</span> <span m='3915650'>lot</span>
  <span m='3915890'>of</span> <span m='3916010'>them.</span> </p><p><span m='3917120'>Now,</span>
  <span m='3918280'>it's</span> <span m='3918440'>going</span> <span m='3918590'>to</span>
  <span m='3918650'>be</span> <span m='3918710'>different.</span> <span m='3919130'>I</span>
  <span m='3919220'>can't</span> <span m='3919460'>use</span> <span m='3919640'>even</span>
  <span m='3919860'>successor</span> <span m='3920330'>anymore.</span> <span m='3921570'>Instead,</span>
  <span m='3924230'>even</span> <span m='3926040'>is</span> <span m='3926220'>going</span>
  <span m='3926390'>to</span> <span m='3926450'>be</span> <span m='3926570'>replaced</span>
  <span m='3927080'>with</span> <span m='3927290'>the</span> <span m='3927410'>notion</span>
  <span m='3927830'>of</span> <span m='3928700'>divisible</span> <span m='3929330'>by</span>
  <span m='3929690'>2</span> <span m='3929900'>to</span> <span m='3930020'>the</span>
  <span m='3930170'>epsilon</span> <span m='3930650'>l,</span> <span m='3932740'>instead</span>
  <span m='3933020'>of</span> <span m='3933080'>divisible</span> <span m='3933470'>by</span>
  <span m='3933620'>2.</span> <span m='3937460'>So</span> <span m='3937640'>I</span>
  <span m='3937730'>do</span> <span m='3937820'>all</span> <span m='3938030'>this,</span>
  <span m='3938360'>but</span> <span m='3938960'>replace</span> <span m='3939530'>the</span>
  <span m='3939620'>notion</span> <span m='3939860'>of</span> <span m='3939950'>even</span>
  <span m='3940310'>with</span> <span m='3941130'>divisible</span> <span m='3941840'>by</span>
  <span m='3941990'>epsilon</span> <span m='3942430'>l.</span> </p><p><span m='3944990'>Because</span>
  <span m='3945380'>this</span> <span m='3945620'>is</span> <span m='3945770'>when</span>
  <span m='3946580'>you</span> <span m='3946790'>are</span> <span m='3947240'>in</span>
  <span m='3948790'>SA</span> <span m='3950480'>sub</span> <span m='3953180'>k</span>
  <span m='3953540'>plus</span> <span m='3953930'>1</span> <span m='3954990'>epsilon</span>
  <span m='3956110'>l.</span> <span m='3957860'>The</span> <span m='3957980'>whole</span>
  <span m='3958220'>name</span> <span m='3958400'>of</span> <span m='3958460'>the</span>
  <span m='3958550'>game</span> <span m='3958790'>is,</span> <span m='3960250'>you're</span>
  <span m='3960390'>trying</span> <span m='3960620'>to</span> <span m='3960710'>do</span>
  <span m='3960880'>a</span> <span m='3961160'>query</span> <span m='3961520'>in</span>
  <span m='3961820'>SA</span> <span m='3962120'>k</span> <span m='3962510'>epsilon</span>
  <span m='3963010'>l,</span> <span m='3963620'>and</span> <span m='3963770'>now</span>
  <span m='3963950'>you</span> <span m='3964070'>want</span> <span m='3964220'>to</span>
  <span m='3964280'>reduce</span> <span m='3964670'>it</span> <span m='3964760'>to</span>
  <span m='3965000'>SA</span> <span m='3965330'>k</span> <span m='3965510'>plus</span>
  <span m='3965750'>1</span> <span m='3965960'>epsilon</span> <span m='3966360'>l.</span>
  </p><p><span m='3967250'>And</span> <span m='3967790'>these</span> <span m='3968000'>are</span>
  <span m='3968090'>the</span> <span m='3968630'>suffixes</span> <span m='3969170'>that</span>
  <span m='3969290'>are</span> <span m='3969680'>explicitly</span> <span m='3970250'>represented.</span>
  <span m='3970790'>Everything</span> <span m='3971150'>else</span> <span m='3971360'>needs</span>
  <span m='3971570'>to</span> <span m='3971630'>be</span> <span m='3971750'>rounded</span>
  <span m='3972200'>to</span> <span m='3972290'>that</span> <span m='3972470'>value,</span>
  <span m='3973460'>then</span> <span m='3973610'>rounded</span> <span m='3973910'>back,</span>
  <span m='3974330'>like</span> <span m='3974510'>we</span> <span m='3974630'>had</span>
  <span m='3974870'>with</span> <span m='3974950'>our</span> <span m='3975070'>giant</span>
  <span m='3975350'>formula</span> <span m='3975770'>before.</span> <span m='3977360'>It's</span>
  <span m='3977540'>not</span> <span m='3977720'>so</span> <span m='3977840'>easy</span>
  <span m='3978020'>to</span> <span m='3978110'>write</span> <span m='3978290'>a</span>
  <span m='3978320'>single</span> <span m='3978620'>formula</span> <span m='3978980'>anymore,</span>
  <span m='3979340'>it's</span> <span m='3979580'>now</span> <span m='3979880'>really</span>
  <span m='3980120'>an</span> <span m='3980210'>algorithm.</span> </p><p><span m='3984440'>So</span>
  <span m='3984770'>to</span> <span m='3984860'>compute</span> <span m='3985760'>SA</span>
  <span m='3986640'>k</span> <span m='3987170'>epsilon</span> <span m='3987660'>l</span>
  <span m='3989090'>of</span> <span m='3989215'>i,</span> <span m='3990010'>what</span>
  <span m='3990250'>you</span> <span m='3990450'>do</span> <span m='3991610'>is</span>
  <span m='3991970'>follow</span> <span m='3993670'>a</span> <span m='3993770'>new</span>
  <span m='3993980'>thing,</span> <span m='3994340'>which</span> <span m='3994510'>I'm</span>
  <span m='3994610'>going</span> <span m='3994730'>to</span> <span m='3994790'>call</span>
  <span m='3995210'>just</span> <span m='3995300'>successor</span> <span m='3996565'>of</span>
  <span m='3997050'>i,</span> <span m='3998600'>repeatedly</span> <span m='4002830'>to</span>
  <span m='4003910'>get</span> <span m='4004060'>a</span> <span m='4004120'>new</span>
  <span m='4004300'>index</span> <span m='4004630'>j.</span> <span m='4007620'>Or</span>
  <span m='4008020'>I</span> <span m='4008080'>guess</span> <span m='4008290'>call</span>
  <span m='4008520'>it</span> <span m='4008610'>i</span> <span m='4009060'>prime,</span>
  <span m='4010076'>make it</span> <span m='4010420'>a little</span> <span m='4010780'>clearer--</span>
  <span m='4011810'>until</span> <span m='4012310'>it's</span> <span m='4012580'>even.</span>
  </p><p><span m='4020080'>So</span> <span m='4020380'>before,</span> <span m='4020740'>we</span>
  <span m='4020860'>just</span> <span m='4021040'>had</span> <span m='4021190'>to</span>
  <span m='4021280'>make</span> <span m='4021460'>one</span> <span m='4021760'>step,</span>
  <span m='4022090'>and</span> <span m='4022180'>then</span> <span m='4022330'>we</span>
  <span m='4022415'>were</span> <span m='4022500'>even.</span> <span m='4023110'>Now,</span>
  <span m='4023620'>we're</span> <span m='4023710'>going</span> <span m='4023830'>to</span>
  <span m='4023920'>have</span> <span m='4024070'>to</span> <span m='4024190'>make</span>
  <span m='4024400'>potentially</span> <span m='4024820'>epsilon</span> <span m='4025320'>l</span>
  <span m='4025480'>steps.</span> <span m='4026680'>So</span> <span m='4026800'>this</span>
  <span m='4026950'>could</span> <span m='4027160'>cost</span> <span m='4027610'>log</span>
  <span m='4027900'>log</span> <span m='4028060'>n.</span> <span m='4028620'>Log</span>
  <span m='4028780'>log</span> <span m='4029010'>n,</span> <span m='4029170'>that's</span>
  <span m='4029380'>not</span> <span m='4029500'>much.</span> <span m='4030860'>Actually--</span>
  <span m='4031270'>sorry,</span> <span m='4031510'>not</span> <span m='4031690'>log</span>
  <span m='4031860'>log</span> <span m='4031980'>n.</span> </p><p><span m='4034700'>This</span>
  <span m='4034960'>is</span> <span m='4035020'>going</span> <span m='4035170'>to</span>
  <span m='4035230'>cost</span> <span m='4035920'>2</span> <span m='4036045'>to</span>
  <span m='4036260'>the</span> <span m='4036400'>epsilon</span> <span m='4036850'>l,</span>
  <span m='4037330'>because</span> <span m='4037630'>it's</span> <span m='4037750'>divisible</span>
  <span m='4038290'>by</span> <span m='4038470'>2</span> <span m='4038710'>to</span>
  <span m='4038800'>the</span> <span m='4038920'>epsilon</span> <span m='4039280'>l.</span>
  <span m='4040020'>2</span> <span m='4040210'>to</span> <span m='4040270'>the</span>
  <span m='4040330'>epsilon</span> <span m='4040690'>l</span> <span m='4040960'>is</span>
  <span m='4041830'>log</span> <span m='4042230'>to</span> <span m='4042310'>the</span>
  <span m='4042400'>epsilon.</span> <span m='4043660'>So</span> <span m='4043840'>this</span>
  <span m='4044050'>now</span> <span m='4044320'>may</span> <span m='4044530'>take</span>
  <span m='4048460'>log</span> <span m='4048825'>to</span> <span m='4049190'>the</span>
  <span m='4049240'>epsilon</span> <span m='4049960'>T</span> <span m='4051010'>steps.</span>
  <span m='4053650'>This</span> <span m='4053830'>is</span> <span m='4053950'>where</span>
  <span m='4054070'>we're</span> <span m='4054160'>going</span> <span m='4054280'>to</span>
  <span m='4054520'>get</span> <span m='4054820'>the</span> <span m='4055120'>log</span>
  <span m='4055360'>to</span> <span m='4055450'>the</span> <span m='4055540'>epsilon</span>
  <span m='4055870'>penalty,</span> <span m='4057460'>in</span> <span m='4057580'>time.</span>
  </p><p><span m='4058800'>OK,</span> <span m='4058960'>but</span> <span m='4059140'>it's</span>
  <span m='4059230'>simple</span> <span m='4059800'>linear</span> <span m='4060070'>search,</span>
  <span m='4060520'>nothing</span> <span m='4061390'>clever</span> <span m='4061690'>here.</span>
  <span m='4062410'>Now,</span> <span m='4062560'>what</span> <span m='4062710'>is</span>
  <span m='4062800'>successor?</span> <span m='4064040'>Well,</span> <span m='4064360'>successor</span>
  <span m='4064645'>is</span> <span m='4064930'>just</span> <span m='4065110'>the</span>
  <span m='4065200'>same</span> <span m='4065470'>thing.</span> <span m='4068710'>If</span>
  <span m='4069010'>you're</span> <span m='4069190'>even</span> <span m='4069640'>in</span>
  <span m='4069760'>this</span> <span m='4069910'>strong</span> <span m='4070270'>sense,</span>
  <span m='4070690'>then</span> <span m='4071080'>nothing</span> <span m='4071380'>happens.</span>
  <span m='4071740'>Otherwise,</span> <span m='4072130'>you</span> <span m='4072220'>just--</span>
  <span m='4072580'>same</span> <span m='4072880'>definition.</span> <span m='4073640'>This</span>
  <span m='4073820'>part</span> <span m='4074080'>is</span> <span m='4074200'>exactly</span>
  <span m='4074530'>the</span> <span m='4074590'>same.</span> <span m='4076360'>Just</span>
  <span m='4076550'>go</span> <span m='4076780'>to</span> <span m='4076870'>the</span>
  <span m='4076960'>next</span> <span m='4077230'>position,</span> <span m='4077800'>the</span>
  <span m='4077890'>next</span> <span m='4078040'>suffix.</span> </p><p><span m='4079180'>But</span>
  <span m='4079300'>now</span> <span m='4079510'>we</span> <span m='4079630'>have</span>
  <span m='4079750'>to</span> <span m='4079810'>follow</span> <span m='4080170'>it</span>
  <span m='4080290'>several</span> <span m='4080620'>times,</span> <span m='4081340'>until</span>
  <span m='4081490'>we</span> <span m='4081580'>get</span> <span m='4081730'>to</span>
  <span m='4081910'>an</span> <span m='4082015'>even</span> <span m='4082120'>one.</span>
  <span m='4084220'>OK.</span> <span m='4085630'>Then</span> <span m='4086110'>we</span>
  <span m='4087550'>recurse,</span> <span m='4089080'>just</span> <span m='4089260'>like</span>
  <span m='4089500'>before</span> <span m='4090790'>on</span> <span m='4091210'>SA</span>
  <span m='4092050'>k</span> <span m='4092710'>plus</span> <span m='4093220'>1,</span>
  <span m='4094360'>epsilon</span> <span m='4094900'>l.</span> <span m='4095260'>The</span>
  <span m='4095350'>next</span> <span m='4095560'>level</span> <span m='4095830'>down</span>
  <span m='4097270'>of</span> <span m='4098640'>the--</span> <span m='4100456'>I</span>
  <span m='4100910'>think</span> <span m='4101439'>we</span> <span m='4101560'>can</span>
  <span m='4101620'>still</span> <span m='4101680'>call</span> <span m='4101800'>it</span>
  <span m='4101890'>even</span> <span m='4102189'>rank.</span> <span m='4115520'>And</span>
  <span m='4115700'>then</span> <span m='4118689'>we</span> <span m='4118910'>multiply</span>
  <span m='4123529'>by</span> <span m='4125210'>2</span> <span m='4125420'>to</span>
  <span m='4125510'>the</span> <span m='4125630'>epsilon</span> <span m='4126020'>l.</span>
  <span m='4129319'>And</span> <span m='4129470'>then</span> <span m='4129890'>subtract</span>
  <span m='4134060'>the</span> <span m='4134240'>number</span> <span m='4134600'>of</span>
  <span m='4134660'>steps</span> <span m='4135140'>we</span> <span m='4135290'>did,</span>
  <span m='4136370'>in</span> <span m='4136760'>1.</span> </p><p><span m='4143319'>We</span>
  <span m='4143630'>made</span> <span m='4143899'>several</span> <span m='4144200'>steps</span>
  <span m='4144529'>here,</span> <span m='4144859'>we</span> <span m='4144979'>need</span>
  <span m='4145160'>to</span> <span m='4145430'>undo</span> <span m='4145729'>those</span>
  <span m='4145850'>steps</span> <span m='4146210'>at</span> <span m='4146300'>the</span>
  <span m='4146420'>end.</span> <span m='4147370'>That's</span> <span m='4147550'>it.</span>
  <span m='4147680'>So</span> <span m='4147830'>it's</span> <span m='4147950'>just</span>
  <span m='4148130'>the</span> <span m='4148220'>same</span> <span m='4148430'>as</span>
  <span m='4148550'>before,</span> <span m='4148979'>except</span> <span m='4149149'>before</span>
  <span m='4149420'>there</span> <span m='4149569'>was</span> <span m='4149660'>one</span>
  <span m='4149840'>step</span> <span m='4150109'>here,</span> <span m='4150290'>and</span>
  <span m='4150410'>at</span> <span m='4150470'>most,</span> <span m='4150710'>one</span>
  <span m='4150890'>step</span> <span m='4151160'>here.</span> <span m='4152010'>Now</span>
  <span m='4152120'>you</span> <span m='4152180'>just</span> <span m='4152330'>count</span>
  <span m='4152569'>them,</span> <span m='4153029'>subtract</span> <span m='4153430'>at</span>
  <span m='4153500'>the</span> <span m='4153620'>end.</span> <span m='4154439'>So</span>
  <span m='4154609'>exactly</span> <span m='4155029'>the</span> <span m='4155120'>same</span>
  <span m='4155359'>template,</span> <span m='4156380'>just</span> <span m='4156620'>skipping</span>
  <span m='4157069'>a</span> <span m='4157130'>lot</span> <span m='4157279'>of</span>
  <span m='4157350'>the</span> <span m='4157390'>levels.</span> </p><p><span m='4158689'>And</span>
  <span m='4158810'>now</span> <span m='4159229'>the</span> <span m='4159319'>space</span>
  <span m='4159710'>is</span> <span m='4159800'>going</span> <span m='4159960'>to</span>
  <span m='4160040'>be</span> <span m='4160220'>1</span> <span m='4160399'>over</span>
  <span m='4160580'>epsilon,</span> <span m='4161149'>plus</span> <span m='4161380'>1</span>
  <span m='4163580'>times</span> <span m='4163930'>n.</span> <span m='4165529'>That's</span>
  <span m='4165710'>it.</span> <span m='4167880'>OK,</span> <span m='4168050'>so</span>
  <span m='4168200'>let</span> <span m='4168380'>me</span> <span m='4168710'>analyze</span>
  <span m='4169130'>a</span> <span m='4169160'>little</span> <span m='4169370'>bit.</span>
  <span m='4175340'>So</span> <span m='4175729'>you</span> <span m='4175819'>have</span>
  <span m='4175910'>to</span> <span m='4176000'>check</span> <span m='4176240'>that</span>
  <span m='4176359'>all</span> <span m='4176550'>of</span> <span m='4176600'>this</span>
  <span m='4176779'>works.</span> <span m='4177920'>Is</span> <span m='4178250'>is</span>
  <span m='4178550'>even</span> <span m='4178819'>suffix,</span> <span m='4179270'>that's</span>
  <span m='4179450'>easy.</span> <span m='4179689'>It's</span> <span m='4179750'>still</span>
  <span m='4179960'>nk</span> <span m='4180260'>bits.</span> <span m='4180680'>Even</span>
  <span m='4180979'>rank,</span> <span m='4181310'>still</span> <span m='4181689'>nk</span>
  <span m='4182090'>bits.</span> <span m='4182479'>Even</span> <span m='4182720'>successor,</span>
  <span m='4183290'>we</span> <span m='4183380'>did</span> <span m='4183529'>all</span>
  <span m='4183649'>this</span> <span m='4183800'>fancy</span> <span m='4184149'>encoding.</span>
  </p><p><span m='4185240'>The</span> <span m='4185330'>one</span> <span m='4185569'>thing</span>
  <span m='4185720'>you</span> <span m='4185840'>can't</span> <span m='4186140'>do,</span>
  <span m='4186260'>is</span> <span m='4186410'>this</span> <span m='4186620'>part.</span>
  <span m='4187700'>I</span> <span m='4187760'>mean,</span> <span m='4187880'>there</span>
  <span m='4188000'>aren't</span> <span m='4188120'>very</span> <span m='4188330'>many</span>
  <span m='4188569'>even</span> <span m='4188810'>suffixes</span> <span m='4189319'>anymore.</span>
  <span m='4189680'>So</span> <span m='4189800'>it</span> <span m='4189859'>really</span>
  <span m='4190069'>doesn't</span> <span m='4190430'>help</span> <span m='4190790'>you,</span>
  <span m='4191870'>it</span> <span m='4191990'>buys</span> <span m='4192350'>you</span>
  <span m='4192590'>a</span> <span m='4193189'>very</span> <span m='4193550'>tiny</span>
  <span m='4193850'>factor.</span> <span m='4194970'>But</span> <span m='4196370'>1</span>
  <span m='4196550'>over</span> <span m='4197420'>2</span> <span m='4197520'>to</span>
  <span m='4197690'>the</span> <span m='4198830'>epsilon</span> <span m='4199250'>l</span>
  <span m='4199820'>are</span> <span m='4199960'>going</span> <span m='4200040'>to</span>
  <span m='4200210'>be</span> <span m='4200360'>even.</span> <span m='4200840'>So</span>
  <span m='4200975'>that's</span> <span m='4201110'>very</span> <span m='4201290'>few.</span>
  <span m='4202280'>So</span> <span m='4202370'>you</span> <span m='4202460'>still</span>
  <span m='4202670'>have</span> <span m='4202790'>to</span> <span m='4202880'>store</span>
  <span m='4203150'>all</span> <span m='4203270'>the</span> <span m='4203390'>answers,</span>
  <span m='4203720'>basically.</span> </p><p><span m='4204140'>But</span> <span m='4204260'>you</span>
  <span m='4204380'>can</span> <span m='4204530'>do</span> <span m='4204650'>all</span>
  <span m='4204830'>this</span> <span m='4204980'>ordering</span> <span m='4205340'>trick,</span>
  <span m='4206030'>it</span> <span m='4206120'>still</span> <span m='4206360'>works.</span>
  <span m='4206730'>We</span> <span m='4206750'>weren't</span> <span m='4206900'>really</span>
  <span m='4207260'>exploiting</span> <span m='4207800'>the</span> <span m='4207860'>fact</span>
  <span m='4208130'>that</span> <span m='4208220'>it</span> <span m='4208280'>was</span>
  <span m='4208460'>odd.</span> <span m='4210650'>And</span> <span m='4210800'>now</span>
  <span m='4211070'>you</span> <span m='4211220'>have</span> <span m='4211370'>to--</span>
  <span m='4211590'>this</span> <span m='4212050'>is</span> <span m='4212240'>not</span>
  <span m='4212420'>a</span> <span m='4212450'>single</span> <span m='4212810'>character,</span>
  <span m='4213290'>it's</span> <span m='4213410'>a</span> <span m='4213470'>bunch</span>
  <span m='4213710'>of</span> <span m='4213770'>characters.</span> <span m='4216800'>But</span>
  <span m='4217010'>still--</span> <span m='4218260'>and</span> <span m='4218550'>so</span>
  <span m='4218690'>now</span> <span m='4218930'>instead</span> <span m='4219230'>of</span>
  <span m='4219290'>2</span> <span m='4219470'>to</span> <span m='4219530'>the</span>
  <span m='4219590'>k,</span> <span m='4219860'>it's</span> <span m='4220130'>probably</span>
  <span m='4220650'>2</span> <span m='4221080'>to</span> <span m='4221450'>the</span>
  <span m='4221930'>k</span> <span m='4222530'>epsilon</span> <span m='4223140'>l.</span>
  </p><p><span m='4224480'>But</span> <span m='4224870'>it</span> <span m='4225020'>all</span>
  <span m='4225140'>works</span> <span m='4225380'>out.</span> <span m='4225950'>It's</span>
  <span m='4226040'>just</span> <span m='4226220'>a</span> <span m='4226280'>renaming</span>
  <span m='4226850'>of</span> <span m='4226970'>everything.</span> <span m='4229160'>It's</span>
  <span m='4229280'>still</span> <span m='4229520'>going</span> <span m='4229630'>to</span>
  <span m='4229700'>be</span> <span m='4229940'>linear</span> <span m='4230250'>number</span>
  <span m='4230450'>of</span> <span m='4230510'>bits,</span> <span m='4231770'>I</span>
  <span m='4231860'>claim.</span> <span m='4233240'>I</span> <span m='4233360'>don't</span>
  <span m='4233480'>want</span> <span m='4233600'>to</span> <span m='4233660'>go</span>
  <span m='4233810'>through</span> <span m='4233960'>a</span> <span m='4233990'>formal</span>
  <span m='4234290'>proof</span> <span m='4234490'>for</span> <span m='4234560'>that,</span>
  <span m='4234790'>we</span> <span m='4234860'>don't</span> <span m='4234920'>have</span>
  <span m='4235100'>time.</span> <span m='4238290'>But</span> <span m='4238380'>all</span>
  <span m='4238710'>the</span> <span m='4238800'>same</span> <span m='4239040'>tricks</span>
  <span m='4239280'>work.</span> </p><p><span m='4245730'>So</span> <span m='4246290'>the</span>
  <span m='4246360'>claim</span> <span m='4246790'>is</span> <span m='4251250'>space</span>
  <span m='4252690'>going</span> <span m='4252825'>to</span> <span m='4252960'>be</span>
  <span m='4253095'>sum</span> <span m='4253500'>k</span> <span m='4254160'>equals</span>
  <span m='4254440'>0</span> <span m='4255000'>to</span> <span m='4256040'>1</span>
  <span m='4256270'>over</span> <span m='4256480'>epsilon.</span> <span m='4258850'>nk</span>
  <span m='4259690'>epsilon</span> <span m='4260072'>l,</span> <span m='4261220'>plus</span>
  <span m='4261490'>n,</span> <span m='4261970'>plus</span> <span m='4262360'>2</span>
  <span m='4263480'>nk</span> <span m='4264120'>epsilon</span> <span m='4264400'>l,</span>
  <span m='4265480'>plus</span> <span m='4266920'>the</span> <span m='4267310'>select</span>
  <span m='4267800'>bound,</span> <span m='4271420'>n</span> <span m='4271610'>over</span>
  <span m='4271780'>log</span> <span m='4272050'>log</span> <span m='4272240'>n.</span>
  <span m='4277270'>Why?</span> <span m='4277900'>Because</span> <span m='4278620'>this</span>
  <span m='4278920'>is</span> <span m='4279070'>storing</span> <span m='4279610'>the</span>
  <span m='4279790'>is</span> <span m='4280060'>even</span> <span m='4280420'>structure.</span>
  <span m='4280930'>That</span> <span m='4281080'>was</span> <span m='4281500'>just</span>
  <span m='4281740'>nk</span> <span m='4282340'>bits.</span> <span m='4283180'>And</span>
  <span m='4283350'>then,</span> <span m='4283540'>this</span> <span m='4283840'>is</span>
  <span m='4284350'>the</span> <span m='4285520'>successor.</span> <span m='4287784'>This</span>
  <span m='4287992'>is,</span> <span m='4288200'>is</span> <span m='4288580'>even.</span>
  </p><p><span m='4293270'>Same</span> <span m='4293620'>as</span> <span m='4293740'>we</span>
  <span m='4293860'>had</span> <span m='4294100'>over</span> <span m='4294280'>here,</span>
  <span m='4294560'>except</span> <span m='4294700'>there's</span> <span m='4294850'>no</span>
  <span m='4295030'>1/2</span> <span m='4295330'>anymore.</span> <span m='4296080'>It's</span>
  <span m='4296200'>just</span> <span m='4296410'>n</span> <span m='4297980'>plus--</span>
  <span m='4298840'>claim</span> <span m='4299140'>is</span> <span m='4299290'>2</span>
  <span m='4301000'>nk</span> <span m='4301540'>epsilon</span> <span m='4302210'>l.</span>
  <span m='4303430'>That's</span> <span m='4303640'>the</span> <span m='4303700'>right</span>
  <span m='4303880'>answer.</span> <span m='4305590'>Yeah,</span> <span m='4305840'>that</span>
  <span m='4306010'>3</span> <span m='4306310'>was</span> <span m='4306460'>because</span>
  <span m='4306820'>of</span> <span m='4306910'>this,</span> <span m='4307150'>plus</span>
  <span m='4307390'>this.</span> <span m='4307780'>So</span> <span m='4307890'>we</span>
  <span m='4308000'>still</span> <span m='4308110'>have</span> <span m='4308155'>the</span>
  <span m='4308200'>3,</span> <span m='4308470'>just</span> <span m='4308620'>don't</span>
  <span m='4308770'>divide</span> <span m='4308935'>it</span> <span m='4309100'>by</span>
  <span m='4309220'>2</span> <span m='4309400'>anymore.</span> </p><p><span m='4315950'>So</span>
  <span m='4317990'>this</span> <span m='4318390'>equals</span> <span m='4320040'>some</span>
  <span m='4320260'>constant</span> <span m='4320570'>times</span> <span m='4320880'>n,</span>
  <span m='4322300'>6n</span> <span m='4324060'>plus</span> <span m='4324860'>1</span>
  <span m='4325070'>over</span> <span m='4325260'>epsilon</span> <span m='4325550'>n.</span>
  <span m='4329410'>Plus</span> <span m='4329830'>order</span> <span m='4330730'>n</span>
  <span m='4331360'>over</span> <span m='4332762'>log</span> <span m='4333240'>log</span>
  <span m='4333570'>n</span> <span m='4333960'>bits.</span> <span m='4338520'>OK,</span>
  <span m='4338960'>not</span> <span m='4339150'>bad.</span> <span m='4339840'>Not</span>
  <span m='4340050'>quite</span> <span m='4340470'>as</span> <span m='4340590'>good</span>
  <span m='4340740'>as</span> <span m='4340890'>this</span> <span m='4341000'>bound</span>
  <span m='4341430'>for</span> <span m='4341580'>binary</span> <span m='4341910'>alphabet,</span>
  <span m='4342400'>so</span> <span m='4342420'>ignore</span> <span m='4342720'>the</span>
  <span m='4342840'>log</span> <span m='4343590'>sigma.</span> <span m='4345210'>Before</span>
  <span m='4345480'>we</span> <span m='4345570'>had</span> <span m='4345720'>1</span>
  <span m='4346020'>plus</span> <span m='4346230'>1</span> <span m='4346380'>over</span>
  <span m='4346500'>epsilon,</span> <span m='4346930'>now</span> <span m='4346980'>we</span>
  <span m='4347070'>have</span> <span m='4347220'>6</span> <span m='4347600'>plus</span>
  <span m='4347840'>1</span> <span m='4347990'>over</span> <span m='4348150'>epsilon.</span>
  </p><p><span m='4352700'>Kind</span> <span m='4352880'>of</span> <span m='4352940'>running</span>
  <span m='4353180'>out</span> <span m='4353270'>of</span> <span m='4353330'>time.</span>
  <span m='4353660'>I'll</span> <span m='4353750'>just</span> <span m='4353900'>tell</span>
  <span m='4354140'>you,</span> <span m='4355130'>you</span> <span m='4355310'>can</span>
  <span m='4356210'>tune</span> <span m='4356540'>this</span> <span m='4357980'>to</span>
  <span m='4358280'>1</span> <span m='4358420'>over</span> <span m='4358670'>epsilon</span>
  <span m='4359110'>n,</span> <span m='4360260'>plus</span> <span m='4360740'>the</span>
  <span m='4360830'>little</span> <span m='4361060'>o,</span> <span m='4362510'>with</span>
  <span m='4362750'>two</span> <span m='4362960'>very</span> <span m='4363170'>simple</span>
  <span m='4363470'>tricks.</span> <span m='4364050'>Two</span> <span m='4364280'>simple</span>
  <span m='4364550'>observations.</span> <span m='4365310'>The</span> <span m='4365330'>first</span>
  <span m='4365570'>one</span> <span m='4365780'>is,</span> <span m='4368270'>the</span>
  <span m='4368390'>successor</span> <span m='4369260'>structure.</span> <span m='4371540'>At</span>
  <span m='4371720'>level</span> <span m='4372080'>0,</span> <span m='4372980'>there's</span>
  <span m='4373160'>nothing</span> <span m='4373460'>to</span> <span m='4373580'>do.</span>
  </p><p><span m='4375900'>Why?</span> <span m='4376260'>Because</span> <span m='4380030'>level</span>
  <span m='4380370'>0--</span> <span m='4381360'>a</span> <span m='4381420'>single</span>
  <span m='4381840'>step</span> <span m='4382530'>just</span> <span m='4382710'>corresponds</span>
  <span m='4383310'>to</span> <span m='4383610'>walking</span> <span m='4384240'>in</span>
  <span m='4384390'>the</span> <span m='4384480'>string.</span> <span m='4384900'>I've</span>
  <span m='4385395'>got</span> <span m='4385642'>to</span> <span m='4385890'>think</span>
  <span m='4386130'>about</span> <span m='4386340'>this</span> <span m='4386520'>a</span>
  <span m='4386580'>little</span> <span m='4386760'>bit.</span> <span m='4388437'>Successor--</span>
  <span m='4394430'>Actually</span> <span m='4394730'>not</span> <span m='4395210'>quite</span>
  <span m='4395390'>clear</span> <span m='4395540'>to</span> <span m='4395630'>me</span>
  <span m='4395750'>why</span> <span m='4395870'>that's</span> <span m='4396080'>true,</span>
  <span m='4396420'>but</span> <span m='4396550'>it</span> <span m='4396710'>turns</span>
  <span m='4397040'>out</span> <span m='4397130'>to</span> <span m='4397220'>be</span>
  <span m='4397310'>true.</span> <span m='4397820'>It's</span> <span m='4398130'>an</span>
  <span m='4398425'>exercise,</span> <span m='4398720'>I</span> <span m='4398780'>guess.</span>
  </p><p><span m='4400660'>At</span> <span m='4400820'>level</span> <span m='4401060'>0,</span>
  <span m='4401360'>you</span> <span m='4401480'>don't</span> <span m='4401660'>need</span>
  <span m='4401780'>to</span> <span m='4401870'>[? the ?]</span> <span m='4402080'>successor</span>
  <span m='4402630'>structure.</span> <span m='4403580'>So</span> <span m='4403760'>that</span>
  <span m='4403910'>actually</span> <span m='4404150'>saves</span> <span m='4404390'>you</span>
  <span m='4404510'>a</span> <span m='4404570'>big</span> <span m='4404780'>factor,</span>
  <span m='4405290'>because</span> <span m='4406920'>if</span> <span m='4407120'>you</span>
  <span m='4407210'>can</span> <span m='4407420'>skip</span> <span m='4407900'>the</span>
  <span m='4407990'>very--</span> <span m='4408680'>k</span> <span m='4408875'>equals</span>
  <span m='4409070'>0,</span> <span m='4410120'>then</span> <span m='4410240'>you</span>
  <span m='4410330'>get</span> <span m='4410480'>to</span> <span m='4410660'>skip--</span>
  <span m='4411060'>you</span> <span m='4411230'>get</span> <span m='4411350'>to</span>
  <span m='4411440'>divide</span> <span m='4411890'>by</span> <span m='4412130'>2</span>
  <span m='4412340'>to</span> <span m='4412400'>the</span> <span m='4412460'>epsilon</span>
  <span m='4412850'>l,</span> <span m='4413180'>the</span> <span m='4413480'>space.</span>
  <span m='4413870'>So</span> <span m='4414020'>that</span> <span m='4414200'>gets</span>
  <span m='4414410'>rid</span> <span m='4414590'>of</span> <span m='4416630'>this</span>
  <span m='4416840'>term.</span> </p><p><span m='4418850'>Then</span> <span m='4418970'>there's</span>
  <span m='4419120'>this</span> <span m='4419240'>other</span> <span m='4419450'>term,</span>
  <span m='4420590'>which</span> <span m='4420890'>you</span> <span m='4421970'>can</span>
  <span m='4422180'>skip,</span> <span m='4423630'>or</span> <span m='4423710'>you</span>
  <span m='4423860'>can</span> <span m='4424010'>store</span> <span m='4424250'>is</span>
  <span m='4424460'>even</span> <span m='4424730'>more</span> <span m='4424910'>efficiently.</span>
  <span m='4425660'>So</span> <span m='4426440'>before</span> <span m='4427010'>is</span>
  <span m='4427250'>even,</span> <span m='4427670'>should</span> <span m='4427940'>be</span>
  <span m='4428090'>a</span> <span m='4428150'>big</span> <span m='4428360'>factor.</span>
  <span m='4428690'>Because</span> <span m='4428870'>half</span> <span m='4429110'>of</span>
  <span m='4429170'>them</span> <span m='4429290'>are</span> <span m='4429380'>even,</span>
  <span m='4429650'>half</span> <span m='4429830'>of</span> <span m='4429890'>them</span>
  <span m='4430010'>are</span> <span m='4430090'>odd,</span> <span m='4430310'>that's</span>
  <span m='4430550'>the</span> <span m='4430640'>optimal</span> <span m='4430970'>thing</span>
  <span m='4431150'>to</span> <span m='4431240'>do.</span> <span m='4432200'>But</span>
  <span m='4432650'>in</span> <span m='4432920'>this</span> <span m='4433100'>structure,</span>
  <span m='4433850'>most</span> <span m='4434480'>of</span> <span m='4434540'>them</span>
  <span m='4434780'>are</span> <span m='4434870'>not</span> <span m='4435110'>even.</span>
  <span m='4435920'>So</span> <span m='4436040'>you</span> <span m='4436160'>can</span>
  <span m='4436310'>save</span> <span m='4436610'>a</span> <span m='4436640'>little</span>
  <span m='4436880'>bit</span> <span m='4437510'>using</span> <span m='4438270'>succinct</span>
  <span m='4438770'>dictionaries.</span> </p><p><span m='4440240'>Because</span> <span
  m='4440420'>there</span> <span m='4440510'>are</span> <span m='4440540'>very</span>
  <span m='4440780'>few</span> <span m='4441020'>ones--</span> <span m='4441800'>you</span>
  <span m='4441950'>can</span> <span m='4442070'>achieve</span> <span m='4442890'>log,</span>
  <span m='4443960'>the</span> <span m='4444050'>total</span> <span m='4444380'>number</span>
  <span m='4444620'>of</span> <span m='4444710'>things,</span> <span m='4445160'>choose</span>
  <span m='4445550'>the</span> <span m='4445640'>number</span> <span m='4445910'>of</span>
  <span m='4446030'>ones.</span> <span m='4448240'>[? Bog ?]</span> <span m='4448640'>of</span>
  <span m='4448730'>that</span> <span m='4448820'>binomial</span> <span m='4449240'>coefficient</span>
  <span m='4450410'>is</span> <span m='4450560'>the</span> <span m='4450620'>number</span>
  <span m='4450980'>of</span> <span m='4451040'>0's</span> <span m='4451460'>plus</span>
  <span m='4451750'>1's.</span> <span m='4452710'>Not</span> <span m='4452840'>going</span>
  <span m='4452990'>to</span> <span m='4453050'>work</span> <span m='4453260'>it</span>
  <span m='4453350'>out,</span> <span m='4453530'>it's</span> <span m='4453650'>worked</span>
  <span m='4453890'>out</span> <span m='4454010'>in</span> <span m='4454100'>the</span>
  <span m='4454190'>notes.</span> </p><p><span m='4455170'>But</span> <span m='4455180'>if</span>
  <span m='4455330'>you</span> <span m='4455720'>store</span> <span m='4456260'>that</span>
  <span m='4456410'>more</span> <span m='4456590'>efficient</span> <span m='4456920'>dictionary,</span>
  <span m='4457370'>which</span> <span m='4457550'>we</span> <span m='4457910'>claimed</span>
  <span m='4458330'>could</span> <span m='4458480'>be</span> <span m='4458570'>done</span>
  <span m='4458750'>last</span> <span m='4458990'>time,</span> <span m='4460010'>then</span>
  <span m='4460340'>this</span> <span m='4460610'>turns</span> <span m='4460940'>out</span>
  <span m='4461150'>to</span> <span m='4461660'>get</span> <span m='4461870'>a</span>
  <span m='4461900'>nice</span> <span m='4462200'>sort</span> <span m='4462380'>of</span>
  <span m='4462470'>cascading</span> <span m='4463040'>thing.</span> <span m='4463760'>And</span>
  <span m='4463970'>it's</span> <span m='4464120'>little</span> <span m='4464150'>of</span>
  <span m='4464450'>of</span> <span m='4464540'>n,</span> <span m='4465520'>in</span>
  <span m='4465920'>the</span> <span m='4466010'>end.</span> <span m='4467210'>So</span>
  <span m='4467330'>that</span> <span m='4467400'>gets</span> <span m='4467560'>rid</span>
  <span m='4467730'>of</span> <span m='4467810'>this</span> <span m='4467990'>term.</span>
  <span m='4468920'>And</span> <span m='4469070'>so</span> <span m='4469280'>you're</span>
  <span m='4469460'>left</span> <span m='4469730'>with</span> <span m='4469850'>just</span>
  <span m='4469985'>n</span> <span m='4470120'>times</span> <span m='4470630'>1</span>
  <span m='4470740'>over</span> <span m='4470930'>epsilon.</span> <span m='4472580'>Plus</span>
  <span m='4472940'>1,</span> <span m='4473180'>because</span> <span m='4473420'>you</span>
  <span m='4473480'>have</span> <span m='4473600'>to</span> <span m='4473690'>store</span>
  <span m='4473900'>the</span> <span m='4473990'>text</span> <span m='4474380'>also.</span>
  </p><p><span m='4477200'>Or</span> <span m='4477350'>maybe</span> <span m='4477590'>because</span>
  <span m='4477950'>of</span> <span m='4479480'>this</span> <span m='4479660'>plus</span>
  <span m='4479930'>1,</span> <span m='4481060'>anyway.</span> <span m='4483410'>Boom.</span>
  <span m='4485960'>That's</span> <span m='4486320'>all</span> <span m='4486470'>I</span>
  <span m='4486530'>want</span> <span m='4486680'>to</span> <span m='4486770'>say</span>
  <span m='4486980'>about</span> <span m='4487530'>this</span> <span m='4487630'>structure.</span>
  <span m='4488720'>So</span> <span m='4488990'>I</span> <span m='4489080'>wanted</span>
  <span m='4489320'>to</span> <span m='4489380'>focus</span> <span m='4489740'>on</span>
  <span m='4489860'>the</span> <span m='4489950'>ideas,</span> <span m='4490550'>which</span>
  <span m='4490910'>got</span> <span m='4491090'>us</span> <span m='4491310'>the</span>
  <span m='4491920'>T</span> <span m='4492080'>log</span> <span m='4492320'>log</span>
  <span m='4492500'>T.</span> <span m='4493200'>Just</span> <span m='4493510'>apply</span>
  <span m='4493700'>the</span> <span m='4493790'>same</span> <span m='4494360'>ideas,</span>
  <span m='4494940'>but</span> <span m='4495080'>much</span> <span m='4495380'>more</span>
  <span m='4495530'>sparsely.</span> </p><p><span m='4496370'>You</span> <span m='4496490'>lose</span>
  <span m='4496790'>in</span> <span m='4496880'>running</span> <span m='4497150'>time,</span>
  <span m='4497390'>instead</span> <span m='4497630'>of</span> <span m='4497690'>paying</span>
  <span m='4497910'>log</span> <span m='4498200'>log</span> <span m='4498870'>T.</span>
  <span m='4499400'>Now</span> <span m='4499580'>we</span> <span m='4499700'>pay--</span>
  <span m='4500240'>we</span> <span m='4500360'>pay</span> <span m='4500540'>log</span>
  <span m='4500780'>to</span> <span m='4500870'>the</span> <span m='4500990'>epsilon</span>
  <span m='4501410'>times</span> <span m='4501860'>log</span> <span m='4502130'>log</span>
  <span m='4502310'>T,</span> <span m='4502520'>but</span> <span m='4502640'>that's</span>
  <span m='4502790'>just</span> <span m='4502940'>log</span> <span m='4503160'>to</span>
  <span m='4503450'>some</span> <span m='4503720'>other</span> <span m='4503900'>epsilon.</span>
  <span m='4506870'>So</span> <span m='4507110'>that</span> <span m='4507290'>gives</span>
  <span m='4507530'>us</span> <span m='4508640'>better</span> <span m='4508910'>space.</span>
  <span m='4510320'>Now</span> <span m='4510560'>linear</span> <span m='4510890'>space,</span>
  <span m='4511250'>instead</span> <span m='4511520'>of</span> <span m='4511610'>n</span>
  <span m='4511865'>log</span> <span m='4511992'>log</span> <span m='4512120'>space.</span>
  <span m='4513700'>Any</span> <span m='4513940'>questions</span> <span m='4514270'>about</span>
  <span m='4514450'>that?</span> <span m='4516590'>All</span> <span m='4516690'>right.</span>
  </p><p><span m='4519310'>Now,</span> <span m='4519760'>I</span> <span m='4519970'>get</span>
  <span m='4520130'>to</span> <span m='4520270'>hurry</span> <span m='4520540'>through</span>
  <span m='4522640'>transforming</span> <span m='4523360'>suffix</span> <span m='4523810'>arrays,</span>
  <span m='4524740'>into</span> <span m='4524950'>suffix</span> <span m='4525310'>trees.</span>
  <span m='4535760'>This</span> <span m='4535910'>is</span> <span m='4536030'>actually</span>
  <span m='4536270'>a</span> <span m='4536300'>much</span> <span m='4536510'>older</span>
  <span m='4536780'>paper.</span> <span m='4537110'>It's</span> <span m='4537260'>by</span>
  <span m='4537500'>[? Monroe, ?]</span> <span m='4537950'>[? Roman, ?]</span> <span
  m='4538340'>and</span> <span m='4538470'>[? Row. ?]</span> </p><p><span m='4545710'>There's</span>
  <span m='4545890'>two</span> <span m='4546130'>versions</span> <span m='4546580'>of</span>
  <span m='4546700'>it</span> <span m='4546790'>in</span> <span m='4546910'>the</span>
  <span m='4547000'>same</span> <span m='4547240'>paper.</span> <span m='4549370'>First</span>
  <span m='4549730'>version</span> <span m='4550030'>is</span> <span m='4550090'>going</span>
  <span m='4550260'>to</span> <span m='4550330'>be</span> <span m='4550420'>compact,</span>
  <span m='4551020'>second</span> <span m='4551350'>version</span> <span m='4551680'>is</span>
  <span m='4551830'>succinct.</span> <span m='4552490'>Probably</span> <span m='4552820'>won't</span>
  <span m='4552970'>have</span> <span m='4553060'>much</span> <span m='4553300'>time</span>
  <span m='4553600'>to</span> <span m='4553660'>cover</span> <span m='4553900'>the</span>
  <span m='4554030'>succinct</span> <span m='4554410'>version,</span> <span m='4554950'>but</span>
  <span m='4556780'>here's</span> <span m='4556990'>what</span> <span m='4557110'>we</span>
  <span m='4557200'>do.</span> <span m='4557920'>Start</span> <span m='4558160'>with</span>
  <span m='4558310'>compact.</span> <span m='4560950'>Store</span> <span m='4562940'>compressed--</span>
  <span m='4564010'>we're</span> <span m='4564100'>going</span> <span m='4564220'>to</span>
  <span m='4564280'>assume</span> <span m='4564460'>binary</span> <span m='4564790'>alphabet</span>
  <span m='4565360'>again,</span> <span m='4568410'>as</span> <span m='4568630'>this</span>
  <span m='4568780'>paper</span> <span m='4569080'>does,</span> <span m='4569350'>I</span>
  <span m='4569470'>believe.</span> </p><p><span m='4572230'>Store</span> <span m='4572500'>the</span>
  <span m='4572560'>suffix</span> <span m='4572920'>tree,</span> <span m='4574210'>but</span>
  <span m='4574450'>only</span> <span m='4574780'>store</span> <span m='4575020'>the</span>
  <span m='4575140'>trie</span> <span m='4575440'>part</span> <span m='4575680'>of</span>
  <span m='4575800'>it.</span> <span m='4577090'>Suffix</span> <span m='4577510'>tree</span>
  <span m='4577720'>really</span> <span m='4577960'>consists</span> <span m='4578350'>of</span>
  <span m='4578630'>trie--</span> <span m='4579510'>binary</span> <span m='4580390'>trie,</span>
  <span m='4580900'>if</span> <span m='4581020'>it's</span> <span m='4581230'>a</span>
  <span m='4581260'>binary</span> <span m='4581530'>alphabet.</span> <span m='4582260'>Plus,</span>
  <span m='4582970'>lengths</span> <span m='4583390'>on</span> <span m='4583510'>the</span>
  <span m='4583630'>edges.</span> <span m='4585220'>Don't</span> <span m='4585430'>store</span>
  <span m='4585640'>the</span> <span m='4585750'>links.</span> <span m='4586960'>Or,</span>
  <span m='4587340'>as</span> <span m='4588280'>Ian</span> <span m='4588490'>likes</span>
  <span m='4588670'>to</span> <span m='4588760'>call</span> <span m='4588960'>it,</span>
  <span m='4589390'>skip</span> <span m='4589720'>the</span> <span m='4589840'>skips.</span>
  <span m='4590980'>The</span> <span m='4591070'>lengths</span> <span m='4591340'>of</span>
  <span m='4591460'>an</span> <span m='4591550'>edge</span> <span m='4591700'>is</span>
  <span m='4591790'>how</span> <span m='4592600'>many</span> <span m='4592780'>bits</span>
  <span m='4593050'>you're</span> <span m='4593110'>supposed</span> <span m='4593350'>to</span>
  <span m='4593440'>skip,</span> <span m='4594130'>so</span> <span m='4594280'>skip</span>
  <span m='4594550'>those.</span> </p><p><span m='4596530'>Just</span> <span m='4596830'>store</span>
  <span m='4597100'>the</span> <span m='4597220'>trie</span> <span m='4597520'>structure.</span>
  <span m='4599270'>So</span> <span m='4599980'>the</span> <span m='4600130'>trie</span>
  <span m='4600400'>structure</span> <span m='4600790'>is</span> <span m='4600940'>on</span>
  <span m='4601810'>2n</span> <span m='4602320'>plus</span> <span m='4602620'>1</span>
  <span m='4602890'>nodes,</span> <span m='4603250'>because</span> <span m='4603400'>there</span>
  <span m='4603460'>is</span> <span m='4603580'>n</span> <span m='4603760'>leaves,</span>
  <span m='4604360'>and</span> <span m='4604900'>minus</span> <span m='4605260'>1.</span>
  <span m='4605705'>Telling me</span> <span m='4606150'>it's</span> <span m='4606340'>plus</span>
  <span m='4606590'>1,</span> <span m='4606740'>I</span> <span m='4606948'>don't</span>
  <span m='4607157'>know.</span> <span m='4607991'>2n</span> <span m='4608410'>plus</span>
  <span m='4608680'>a</span> <span m='4608770'>constant</span> <span m='4609640'>nodes.</span>
  <span m='4610820'>So</span> <span m='4611050'>this</span> <span m='4611350'>is</span>
  <span m='4612220'>4n</span> <span m='4613120'>bits.</span> <span m='4615160'>We</span>
  <span m='4615310'>know</span> <span m='4615460'>how</span> <span m='4615580'>to</span>
  <span m='4615700'>do</span> <span m='4616390'>binary</span> <span m='4616750'>tries,</span>
  <span m='4617110'>finally</span> <span m='4617440'>we're</span> <span m='4617560'>using</span>
  <span m='4617890'>last</span> <span m='4618130'>lecture.</span> <span m='4619090'>We</span>
  <span m='4619230'>use</span> <span m='4619360'>rank</span> <span m='4619550'>and</span>
  <span m='4619640'>select</span> <span m='4619960'>a</span> <span m='4620020'>lot,</span>
  <span m='4620680'>but</span> <span m='4620830'>now</span> <span m='4621040'>are</span>
  <span m='4621100'>using</span> <span m='4621340'>the</span> <span m='4621580'>binary</span>
  <span m='4621970'>trie.</span> </p><p><span m='4622360'>We're</span> <span m='4622450'>going</span>
  <span m='4622570'>to</span> <span m='4622960'>store</span> <span m='4623260'>this</span>
  <span m='4623410'>using</span> <span m='4623650'>the</span> <span m='4623740'>balanced</span>
  <span m='4624100'>paren</span> <span m='4624420'>structure.</span> <span m='4625670'>OK,</span>
  <span m='4625840'>so</span> <span m='4626110'>you</span> <span m='4626230'>have</span>
  <span m='4626320'>to</span> <span m='4626410'>double</span> <span m='4626740'>that--</span>
  <span m='4627070'>this</span> <span m='4627430'>linear</span> <span m='4627790'>number</span>
  <span m='4628000'>of</span> <span m='4628060'>bits,</span> <span m='4628500'>so</span>
  <span m='4628595'>if</span> <span m='4628690'>we're</span> <span m='4628840'>just</span>
  <span m='4629050'>looking</span> <span m='4629290'>for</span> <span m='4629440'>compact,</span>
  <span m='4630010'>that's</span> <span m='4630220'>fine.</span> <span m='4631540'>Now</span>
  <span m='4631720'>the</span> <span m='4631810'>hard</span> <span m='4632050'>part</span>
  <span m='4632320'>is</span> <span m='4632500'>in</span> <span m='4632650'>a</span>
  <span m='4632710'>search,</span> <span m='4633630'>where</span> <span m='4633730'>we</span>
  <span m='4633850'>go</span> <span m='4634090'>from</span> <span m='4634330'>one</span>
  <span m='4634540'>node,</span> <span m='4635710'>to</span> <span m='4635890'>the</span>
  <span m='4636010'>next</span> <span m='4636250'>node.</span> <span m='4638630'>We</span>
  <span m='4638730'>need</span> <span m='4638770'>to</span> <span m='4638890'>know</span>
  <span m='4639040'>the</span> <span m='4639160'>length</span> <span m='4639390'>of</span>
  <span m='4639460'>this</span> <span m='4639610'>edge,</span> <span m='4640445'>we've</span>
  <span m='4640637'>got</span> <span m='4640830'>to</span> <span m='4640930'>figure</span>
  <span m='4641170'>that</span> <span m='4641380'>out.</span> </p><p><span m='4643180'>We</span>
  <span m='4643280'>need</span> <span m='4643425'>to</span> <span m='4643570'>know</span>
  <span m='4643720'>whether</span> <span m='4643900'>the</span> <span m='4644020'>pattern</span>
  <span m='4644500'>jumped</span> <span m='4644800'>off,</span> <span m='4645100'>or</span>
  <span m='4645190'>something.</span> <span m='4646690'>We</span> <span m='4646780'>need</span>
  <span m='4646900'>to</span> <span m='4647020'>know</span> <span m='4647650'>at</span>
  <span m='4647890'>position</span> <span m='4648410'>y,</span> <span m='4649930'>which</span>
  <span m='4650290'>letter</span> <span m='4650590'>of</span> <span m='4650650'>the</span>
  <span m='4650740'>pattern</span> <span m='4651190'>should</span> <span m='4651310'>we</span>
  <span m='4651430'>branch</span> <span m='4651790'>on.</span> <span m='4653620'>So</span>
  <span m='4653740'>we</span> <span m='4653800'>need</span> <span m='4653920'>to</span>
  <span m='4654040'>measure</span> <span m='4654310'>this</span> <span m='4654460'>length.</span>
  <span m='4656320'>Not</span> <span m='4656530'>too</span> <span m='4656680'>hard.</span>
  </p><p><span m='4657760'>What</span> <span m='4657880'>you</span> <span m='4657970'>do,</span>
  <span m='4658550'>you</span> <span m='4658630'>look</span> <span m='4658810'>at</span>
  <span m='4658870'>this</span> <span m='4659010'>subtree.</span> <span m='4660280'>You</span>
  <span m='4660370'>look</span> <span m='4660550'>at</span> <span m='4660640'>the</span>
  <span m='4660730'>leftmost</span> <span m='4661240'>leaf</span> <span m='4661660'>and</span>
  <span m='4661780'>the</span> <span m='4661870'>rightmost</span> <span m='4662320'>leaf.</span>
  <span m='4664330'>You</span> <span m='4664510'>look</span> <span m='4664690'>at</span>
  <span m='4664750'>their</span> <span m='4664930'>longest</span> <span m='4665320'>common</span>
  <span m='4665620'>prefix,</span> <span m='4666190'>starting</span> <span m='4666670'>from</span>
  <span m='4667030'>the</span> <span m='4667150'>character</span> <span m='4667480'>you</span>
  <span m='4667600'>care</span> <span m='4667810'>about.</span> </p><p><span m='4668470'>And</span>
  <span m='4668590'>you</span> <span m='4668890'>look</span> <span m='4669100'>at</span>
  <span m='4669190'>the</span> <span m='4669280'>longest</span> <span m='4669550'>common</span>
  <span m='4669790'>prefix</span> <span m='4670150'>with</span> <span m='4670300'>the</span>
  <span m='4670390'>pattern</span> <span m='4670720'>P.</span> <span m='4672100'>All</span>
  <span m='4672220'>sounds</span> <span m='4672490'>easy--</span> <span m='4673120'>how</span>
  <span m='4673240'>do</span> <span m='4673300'>you</span> <span m='4673390'>actually</span>
  <span m='4673690'>do</span> <span m='4673870'>it?</span> <span m='4675430'>So</span>
  <span m='4675700'>you</span> <span m='4675820'>need</span> <span m='4675970'>to</span>
  <span m='4676030'>be</span> <span m='4676090'>able</span> <span m='4676210'>to</span>
  <span m='4676300'>find</span> <span m='4676480'>the</span> <span m='4676540'>leftmost</span>
  <span m='4676990'>leaf</span> <span m='4677230'>in</span> <span m='4677310'>a</span>
  <span m='4677380'>subtree.</span> <span m='4678700'>Leaves</span> <span m='4679990'>in</span>
  <span m='4680670'>the</span> <span m='4680800'>balanced</span> <span m='4681190'>paren</span>
  <span m='4681700'>expression--</span> <span m='4682420'>I</span> <span m='4682480'>think</span>
  <span m='4682730'>last</span> <span m='4682970'>class,</span> <span m='4683260'>I</span>
  <span m='4683440'>mistakenly</span> <span m='4684490'>thought</span> <span m='4684730'>they</span>
  <span m='4684850'>were</span> <span m='4684970'>that.</span> <span m='4685270'>In</span>
  <span m='4685360'>fact,</span> <span m='4685630'>they</span> <span m='4685750'>are</span>
  <span m='4685850'>this.</span> <span m='4687190'>Think</span> <span m='4687430'>about</span>
  <span m='4687640'>it</span> <span m='4687730'>long</span> <span m='4687940'>enough.</span>
  </p><p><span m='4689080'>This</span> <span m='4689350'>was</span> <span m='4689560'>leaves</span>
  <span m='4690010'>in</span> <span m='4690250'>the</span> <span m='4691060'>rooted</span>
  <span m='4691380'>order</span> <span m='4691700'>tree,</span> <span m='4692020'>but</span>
  <span m='4692170'>what</span> <span m='4692260'>we</span> <span m='4692380'>care</span>
  <span m='4692560'>about</span> <span m='4692740'>are</span> <span m='4692800'>leaves</span>
  <span m='4693070'>in</span> <span m='4693160'>the</span> <span m='4693250'>binary</span>
  <span m='4693610'>tree.</span> <span m='4694040'>And</span> <span m='4694110'>they</span>
  <span m='4694180'>always</span> <span m='4694390'>look</span> <span m='4694510'>like</span>
  <span m='4694720'>open</span> <span m='4695050'>paren,</span> <span m='4695353'>closed</span>
  <span m='4695476'>paren,</span> <span m='4695600'>and</span> <span m='4695730'>closed</span>
  <span m='4695980'>paren.</span> <span m='4696730'>So</span> <span m='4696850'>this</span>
  <span m='4697060'>is</span> <span m='4697180'>a</span> <span m='4697240'>leaf,</span>
  <span m='4699280'>and</span> <span m='4699400'>so</span> <span m='4699550'>what</span>
  <span m='4699700'>we're</span> <span m='4699820'>asking</span> <span m='4700180'>for</span>
  <span m='4700330'>is</span> <span m='4700450'>in</span> <span m='4700600'>a</span>
  <span m='4700660'>subtree,</span> <span m='4701230'>we'll</span> <span m='4701350'>find</span>
  <span m='4701590'>the</span> <span m='4701680'>first</span> <span m='4701980'>leaf.</span>
  </p><p><span m='4702250'>That's</span> <span m='4702460'>actually</span> <span m='4702730'>just</span>
  <span m='4702970'>going</span> <span m='4703140'>to</span> <span m='4703210'>be</span>
  <span m='4703480'>right</span> <span m='4703750'>after</span> <span m='4704140'>this</span>
  <span m='4704320'>open</span> <span m='4704590'>paren.</span> <span m='4706120'>Or,</span>
  <span m='4706330'>I</span> <span m='4706390'>guess,</span> <span m='4706570'>you</span>
  <span m='4706990'>do</span> <span m='4707230'>a</span> <span m='4707680'>select,</span>
  <span m='4709150'>select</span> <span m='4710830'>sub</span> <span m='4711730'>this,</span>
  <span m='4712870'>to</span> <span m='4712990'>jump</span> <span m='4713350'>to</span>
  <span m='4713500'>the</span> <span m='4713590'>next</span> <span m='4713830'>leaf.</span>
  <span m='4714700'>Then</span> <span m='4714820'>also,</span> <span m='4715060'>you</span>
  <span m='4715180'>can</span> <span m='4715300'>jump</span> <span m='4715510'>to</span>
  <span m='4715630'>the</span> <span m='4715780'>end</span> <span m='4715960'>of</span>
  <span m='4716020'>the</span> <span m='4716220'>subtree</span> <span m='4716660'>and</span>
  <span m='4716760'>then</span> <span m='4716770'>go</span> <span m='4716890'>back</span>
  <span m='4717250'>to</span> <span m='4717370'>the</span> <span m='4717460'>previous</span>
  <span m='4717910'>leaf,</span> <span m='4718210'>using</span> <span m='4718540'>rank</span>
  <span m='4718750'>and</span> <span m='4718840'>select.</span> </p><p><span m='4719890'>So</span>
  <span m='4720310'>I</span> <span m='4720610'>won't</span> <span m='4720760'>go</span>
  <span m='4720850'>into</span> <span m='4721000'>details,</span> <span m='4721460'>but</span>
  <span m='4721560'>that's</span> <span m='4721630'>easy</span> <span m='4721840'>to</span>
  <span m='4721930'>do.</span> <span m='4722050'>So</span> <span m='4722170'>you</span>
  <span m='4722260'>can</span> <span m='4722380'>identify</span> <span m='4722980'>the</span>
  <span m='4723100'>two</span> <span m='4723270'>leaves</span> <span m='4724000'>using</span>
  <span m='4724390'>rank</span> <span m='4725490'>sub,</span> <span m='4726820'>this</span>
  <span m='4727030'>thing.</span> <span m='4727720'>I</span> <span m='4727840'>can</span>
  <span m='4727990'>identify</span> <span m='4728440'>the</span> <span m='4728560'>leaf</span>
  <span m='4728830'>number,</span> <span m='4730210'>so</span> <span m='4730360'>I</span>
  <span m='4730420'>can</span> <span m='4730600'>identify</span> <span m='4731230'>where</span>
  <span m='4731470'>these</span> <span m='4731650'>leaves</span> <span m='4731890'>are.</span>
  <span m='4733090'>Now,</span> <span m='4733360'>I</span> <span m='4733420'>have</span>
  <span m='4733660'>a</span> <span m='4733750'>suffix</span> <span m='4734170'>array.</span>
  <span m='4734950'>If</span> <span m='4735100'>I</span> <span m='4735190'>look</span>
  <span m='4735400'>up</span> <span m='4735490'>the</span> <span m='4735610'>suffix</span>
  <span m='4736030'>array</span> <span m='4736420'>of</span> <span m='4736630'>these</span>
  <span m='4736870'>two</span> <span m='4737050'>leaf</span> <span m='4737290'>numbers--</span>
  <span m='4738520'>remember</span> <span m='4738860'>leaves</span> <span m='4739120'>are</span>
  <span m='4739210'>ordered</span> <span m='4739510'>by</span> <span m='4739630'>suffix</span>
  <span m='4740770'>in</span> <span m='4740920'>sorted</span> <span m='4741250'>order</span>
  <span m='4741490'>by</span> <span m='4741640'>suffix</span> <span m='4742000'>array.</span>
  </p><p><span m='4743260'>These</span> <span m='4743440'>are</span> <span m='4743530'>really</span>
  <span m='4743770'>indices</span> <span m='4744250'>into</span> <span m='4744430'>the</span>
  <span m='4744520'>suffix</span> <span m='4744910'>array.</span> <span m='4745180'>They're</span>
  <span m='4745300'>giving</span> <span m='4745660'>me--</span> <span m='4746320'>oh,</span>
  <span m='4746470'>this</span> <span m='4746680'>is</span> <span m='4746800'>the</span>
  <span m='4746980'>i-th</span> <span m='4747190'>suffix,</span> <span m='4747580'>this</span>
  <span m='4747730'>is</span> <span m='4747820'>the</span> <span m='4747910'>j-th</span>
  <span m='4748120'>suffix.</span> <span m='4748870'>So</span> <span m='4749010'>I</span>
  <span m='4749050'>look</span> <span m='4749230'>at</span> <span m='4749290'>those</span>
  <span m='4749470'>two</span> <span m='4749620'>positions</span> <span m='4750010'>of</span>
  <span m='4750060'>the</span> <span m='4750130'>suffix</span> <span m='4750460'>array,</span>
  <span m='4750640'>I</span> <span m='4750790'>teleport</span> <span m='4751270'>over</span>
  <span m='4751560'>to</span> <span m='4751780'>the</span> <span m='4751900'>string</span>
  <span m='4752230'>T.</span> <span m='4752890'>Now</span> <span m='4753100'>I</span>
  <span m='4753160'>have</span> <span m='4753460'>the</span> <span m='4753610'>actual</span>
  <span m='4754030'>suffixes</span> <span m='4755560'>corresponding</span> <span m='4756040'>to</span>
  <span m='4756160'>this</span> <span m='4756340'>and</span> <span m='4756460'>this.</span>
  <span m='4757120'>And</span> <span m='4757210'>I</span> <span m='4757300'>just</span>
  <span m='4757480'>look</span> <span m='4757720'>at</span> <span m='4757780'>where</span>
  <span m='4757900'>they</span> <span m='4758020'>match.</span> </p><p><span m='4759160'>I</span>
  <span m='4759280'>know</span> <span m='4759550'>that</span> <span m='4760090'>if</span>
  <span m='4760350'>I've</span> <span m='4760690'>already</span> <span m='4761110'>gone</span>
  <span m='4761410'>down</span> <span m='4762190'>to</span> <span m='4762310'>depth</span>
  <span m='4762580'>d,</span> <span m='4762940'>letter</span> <span m='4763210'>depth</span>
  <span m='4763520'>d.</span> <span m='4763890'>I</span> <span m='4764260'>already</span>
  <span m='4764500'>know</span> <span m='4764710'>that</span> <span m='4764860'>they</span>
  <span m='4764980'>match</span> <span m='4765250'>the</span> <span m='4765370'>first</span>
  <span m='4765535'>d</span> <span m='4765700'>characters.</span> <span m='4766120'>I</span>
  <span m='4766180'>don't</span> <span m='4766360'>compare</span> <span m='4766660'>those.</span>
  <span m='4767110'>They're</span> <span m='4767230'>guaranteed</span> <span m='4767680'>to</span>
  <span m='4767740'>match.</span> <span m='4768460'>So</span> <span m='4768580'>I</span>
  <span m='4768640'>start at</span> <span m='4768940'>position</span> <span m='4769340'>d</span>
  <span m='4769570'>plus</span> <span m='4769800'>1.</span> <span m='4770800'>I</span>
  <span m='4770980'>know</span> <span m='4771160'>they</span> <span m='4771280'>should</span>
  <span m='4771460'>match,</span> <span m='4771720'>but</span> <span m='4771970'>one</span>
  <span m='4772120'>more</span> <span m='4772300'>letter.</span> <span m='4772960'>How</span>
  <span m='4773170'>many</span> <span m='4773350'>more</span> <span m='4773530'>letters</span>
  <span m='4773800'>do</span> <span m='4773890'>they</span> <span m='4774010'>match?</span>
  <span m='4774430'>That</span> <span m='4774640'>is</span> <span m='4774760'>the</span>
  <span m='4774880'>length</span> <span m='4775090'>of</span> <span m='4775150'>this</span>
  <span m='4775330'>thing.</span> </p><p><span m='4776900'>OK.</span> <span m='4777550'>How</span>
  <span m='4777730'>can</span> <span m='4777910'>I</span> <span m='4778000'>afford</span>
  <span m='4778270'>to</span> <span m='4778360'>pay</span> <span m='4778510'>for</span>
  <span m='4778690'>that?</span> <span m='4778790'>I'm</span> <span m='4778845'>just</span>
  <span m='4778900'>going</span> <span m='4779020'>to</span> <span m='4779080'>pen</span>
  <span m='4779380'>linear</span> <span m='4779770'>cost,</span> <span m='4780115'>the</span>
  <span m='4780460'>total</span> <span m='4780820'>number</span> <span m='4781030'>of</span>
  <span m='4781120'>characters</span> <span m='4781480'>I</span> <span m='4781570'>compare,</span>
  <span m='4781990'>is</span> <span m='4782080'>going</span> <span m='4782230'>to</span>
  <span m='4782290'>be</span> <span m='4782380'>equal</span> <span m='4782710'>to</span>
  <span m='4782830'>the</span> <span m='4782920'>length</span> <span m='4783160'>of</span>
  <span m='4783220'>the</span> <span m='4783310'>pattern.</span> <span m='4784820'>So</span>
  <span m='4784960'>we're</span> <span m='4785050'>going</span> <span m='4785220'>to</span>
  <span m='4785330'>end</span> <span m='4785560'>up</span> <span m='4785680'>getting</span>
  <span m='4786430'>length</span> <span m='4786650'>of</span> <span m='4786760'>the</span>
  <span m='4786850'>pattern,</span> <span m='4787750'>times</span> <span m='4788950'>the</span>
  <span m='4789070'>cost</span> <span m='4790090'>to</span> <span m='4790210'>do</span>
  <span m='4790390'>a</span> <span m='4790450'>suffix</span> <span m='4790840'>array</span>
  <span m='4791050'>access.</span> </p><p><span m='4791980'>Because</span> <span m='4792150'>I</span>
  <span m='4792220'>have</span> <span m='4792340'>to</span> <span m='4792400'>do</span>
  <span m='4792520'>this</span> <span m='4792730'>at</span> <span m='4792820'>every</span>
  <span m='4793120'>single</span> <span m='4793420'>step,</span> <span m='4793720'>in</span>
  <span m='4793810'>the</span> <span m='4793900'>worst</span> <span m='4794110'>case.</span>
  <span m='4795460'>So</span> <span m='4795820'>not</span> <span m='4796180'>perfect,</span>
  <span m='4796820'>but</span> <span m='4797440'>pretty</span> <span m='4797680'>good.</span>
  <span m='4798010'>Roughly</span> <span m='4798490'>P,</span> <span m='4799000'>suffix</span>
  <span m='4799420'>array</span> <span m='4799600'>access</span> <span m='4799960'>is</span>
  <span m='4800080'>like</span> <span m='4800260'>log</span> <span m='4800460'>to</span>
  <span m='4800560'>the</span> <span m='4800680'>epsilon.</span> <span m='4801910'>So</span>
  <span m='4802000'>we're</span> <span m='4802060'>getting</span> <span m='4802270'>a</span>
  <span m='4802295'>P</span> <span m='4802620'>log</span> <span m='4802850'>to</span>
  <span m='4802920'>the</span> <span m='4803050'>epsilon.</span> <span m='4803530'>Not</span>
  <span m='4803710'>quite</span> <span m='4804010'>as</span> <span m='4804130'>good</span>
  <span m='4804430'>as</span> <span m='4805240'>this</span> <span m='4805420'>bound,</span>
  <span m='4807190'>but</span> <span m='4807850'>because</span> <span m='4808060'>here</span>
  <span m='4808240'>the</span> <span m='4808330'>P</span> <span m='4808540'>is</span>
  <span m='4808660'>not</span> <span m='4808840'>multiplied</span> <span m='4809210'>by</span>
  <span m='4809320'>log</span> <span m='4809410'>to</span> <span m='4809500'>the</span>
  <span m='4809590'>epsilon.</span> <span m='4809950'>But,</span> <span m='4810400'>it's</span>
  <span m='4810550'>just</span> <span m='4810740'>log</span> <span m='4810860'>to</span>
  <span m='4810990'>the</span> <span m='4811090'>epsilon.</span> </p><p><span m='4812000'>If</span>
  <span m='4812040'>you</span> <span m='4812080'>want</span> <span m='4812200'>to</span>
  <span m='4812260'>see</span> <span m='4812930'>a</span> <span m='4813010'>better</span>
  <span m='4813280'>way</span> <span m='4813400'>to</span> <span m='4813520'>do</span>
  <span m='4813640'>it,</span> <span m='4813760'>you</span> <span m='4813850'>can</span>
  <span m='4813970'>read</span> <span m='4814120'>the</span> <span m='4814210'>Grossi-Vitter</span>
  <span m='4814710'>paper.</span> <span m='4815690'>But</span> <span m='4815710'>this</span>
  <span m='4815890'>is</span> <span m='4816010'>a</span> <span m='4816070'>decent</span>
  <span m='4816400'>way</span> <span m='4816520'>to</span> <span m='4816640'>do</span>
  <span m='4816760'>it.</span> <span m='4820900'>Now</span> <span m='4821260'>briefly,</span>
  <span m='4823990'>this</span> <span m='4824170'>is</span> <span m='4824350'>the</span>
  <span m='4825340'>compact</span> <span m='4825850'>version,</span> <span m='4826170'>and</span>
  <span m='4826240'>let</span> <span m='4826390'>me</span> <span m='4826510'>tell</span>
  <span m='4826690'>you</span> <span m='4826810'>how</span> <span m='4826930'>to</span>
  <span m='4827050'>make</span> <span m='4827260'>it</span> <span m='4827350'>succinct.</span>
  </p><p><span m='4833790'>I'm</span> <span m='4833910'>not</span> <span m='4834030'>going</span>
  <span m='4834180'>to</span> <span m='4834240'>touch</span> <span m='4834420'>the</span>
  <span m='4834510'>suffix</span> <span m='4834930'>array.</span> <span m='4835170'>Suffix</span>
  <span m='4835590'>array,</span> <span m='4835770'>to</span> <span m='4835860'>make</span>
  <span m='4836040'>that</span> <span m='4836210'>succinct</span> <span m='4836610'>is</span>
  <span m='4836730'>harder.</span> <span m='4837880'>But</span> <span m='4837930'>if</span>
  <span m='4838020'>I</span> <span m='4838110'>just</span> <span m='4838290'>want</span>
  <span m='4838440'>to</span> <span m='4838500'>make</span> <span m='4838650'>the</span>
  <span m='4838740'>suffix</span> <span m='4839160'>tree</span> <span m='4839490'>parts</span>
  <span m='4839920'>succinct,</span> <span m='4841200'>I</span> <span m='4841290'>can</span>
  <span m='4841440'>use</span> <span m='4841620'>this</span> <span m='4841710'>same</span>
  <span m='4842010'>idea,</span> <span m='4843000'>but</span> <span m='4843330'>I</span>
  <span m='4843450'>can't</span> <span m='4843870'>afford</span> <span m='4844200'>to</span>
  <span m='4844290'>store</span> <span m='4844500'>the</span> <span m='4844620'>whole</span>
  <span m='4844770'>trie.</span> <span m='4846300'>So</span> <span m='4846480'>just</span>
  <span m='4846630'>going</span> <span m='4846750'>to</span> <span m='4847110'>use</span>
  <span m='4847320'>a</span> <span m='4847350'>little</span> <span m='4847620'>bit</span>
  <span m='4847740'>of</span> <span m='4847830'>indirection.</span> <span m='4848820'>You</span>
  <span m='4848940'>can</span> <span m='4849060'>use</span> <span m='4849240'>as</span>
  <span m='4849360'>little</span> <span m='4849720'>as</span> <span m='4849840'>you</span>
  <span m='4849930'>want,</span> <span m='4850320'>this</span> <span m='4850500'>is</span>
  <span m='4850590'>the</span> <span m='4850710'>log</span> <span m='4850940'>log</span>
  <span m='4851408'>log</span> <span m='4851876'>log</span> <span m='4852344'>log</span>
  <span m='4852812'>log</span> <span m='4853280'>log</span> <span m='4853748'>n</span>
  <span m='4854220'>factor.</span> </p><p><span m='4860150'>Use</span> <span m='4860810'>the</span>
  <span m='4860900'>suffix</span> <span m='4861360'>tree</span> <span m='4868140'>above</span>
  <span m='4870540'>every</span> <span m='4872920'>b-th</span> <span m='4873510'>suffix.</span>
  <span m='4875250'>So</span> <span m='4875490'>throw</span> <span m='4875910'>away</span>
  <span m='4876930'>all</span> <span m='4877270'>but</span> <span m='4877530'>a</span>
  <span m='4877650'>1/b</span> <span m='4878070'>fraction</span> <span m='4878610'>of</span>
  <span m='4878820'>the</span> <span m='4878940'>leaves.</span> <span m='4879960'>And</span>
  <span m='4880080'>then,</span> <span m='4880470'>take</span> <span m='4880680'>the</span>
  <span m='4880800'>tree</span> <span m='4881010'>that</span> <span m='4881130'>remains.</span>
  <span m='4882600'>So</span> <span m='4882780'>once</span> <span m='4882990'>you</span>
  <span m='4883080'>do</span> <span m='4883230'>a</span> <span m='4883290'>search,</span>
  <span m='4883750'>you</span> <span m='4883770'>won't</span> <span m='4883980'>find</span>
  <span m='4884220'>exactly</span> <span m='4884850'>the</span> <span m='4884970'>leaf</span>
  <span m='4885210'>you</span> <span m='4885330'>want,</span> <span m='4885870'>but</span>
  <span m='4886020'>you'll</span> <span m='4886170'>be</span> <span m='4886350'>within</span>
  <span m='4886650'>an</span> <span m='4886770'>additive</span> <span m='4887220'>b</span>
  <span m='4887580'>of</span> <span m='4887700'>the</span> <span m='4887790'>leaf</span>
  <span m='4888030'>you</span> <span m='4888150'>want.</span> <span m='4888390'>b</span>
  <span m='4888660'>here</span> <span m='4888840'>can</span> <span m='4888990'>be</span>
  <span m='4889110'>arbitrarily</span> <span m='4889590'>small.</span> <span m='4889860'>This</span>
  <span m='4890010'>can</span> <span m='4890160'>be</span> <span m='4890310'>log</span>
  <span m='4890460'>log</span> <span m='4890874'>log</span> <span m='4891288'>log</span>
  <span m='4891702'>log</span> <span m='4892116'>n.</span> <span m='4892530'>But</span>
  <span m='4892695'>something</span> <span m='4892860'>super</span> <span m='4893160'>constant.</span>
  </p><p><span m='4894450'>Then</span> <span m='4894690'>if</span> <span m='4894870'>I</span>
  <span m='4894960'>use</span> <span m='4895200'>this</span> <span m='4895340'>structure,</span>
  <span m='4895860'>instead</span> <span m='4896190'>of</span> <span m='4896250'>being</span>
  <span m='4896970'>n--</span> <span m='4897180'>order</span> <span m='4897480'>n</span>
  <span m='4897600'>over</span> <span m='4897790'>b</span> <span m='4897960'>space--</span>
  <span m='4898580'>instead</span> <span m='4899050'>of</span> <span m='4899130'>being</span>
  <span m='4899310'>order</span> <span m='4899460'>n</span> <span m='4899640'>space,</span>
  <span m='4900000'>it's</span> <span m='4900090'>going</span> <span m='4900240'>to</span>
  <span m='4900300'>be</span> <span m='4900390'>order</span> <span m='4900660'>n</span>
  <span m='4900810'>over</span> <span m='4901020'>b</span> <span m='4901355'>bits.</span>
  <span m='4903000'>So,</span> <span m='4903370'>we</span> <span m='4903630'>win.</span>
  <span m='4904110'>The</span> <span m='4904200'>only</span> <span m='4904410'>issue</span>
  <span m='4904650'>is</span> <span m='4904770'>now,</span> <span m='4904980'>how</span>
  <span m='4905160'>do</span> <span m='4905250'>you</span> <span m='4905400'>find</span>
  <span m='4906690'>the</span> <span m='4906810'>correct</span> <span m='4907680'>leaf,</span>
  <span m='4908630'>as</span> <span m='4908700'>opposed</span> <span m='4908970'>to</span>
  <span m='4909040'>the</span> <span m='4909170'>incorrect</span> <span m='4909590'>leaf?</span>
  </p><p><span m='4913560'>I</span> <span m='4913650'>don't</span> <span m='4913740'>really</span>
  <span m='4913920'>have</span> <span m='4914070'>time</span> <span m='4914280'>to</span>
  <span m='4914340'>talk</span> <span m='4914580'>about</span> <span m='4914790'>it.</span>
  <span m='4914910'>You</span> <span m='4915030'>can</span> <span m='4915150'>look</span>
  <span m='4915300'>at</span> <span m='4915360'>the</span> <span m='4915450'>notes.</span>
  <span m='4917100'>Rough</span> <span m='4917370'>idea</span> <span m='4917700'>is,</span>
  <span m='4917970'>well,</span> <span m='4918120'>you</span> <span m='4918270'>can</span>
  <span m='4918420'>have</span> <span m='4918600'>a</span> <span m='4918660'>look-up</span>
  <span m='4918990'>table</span> <span m='4919980'>that</span> <span m='4920130'>lets</span>
  <span m='4920310'>you</span> <span m='4920400'>do</span> <span m='4920550'>whatever</span>
  <span m='4920820'>you</span> <span m='4920940'>want</span> <span m='4921220'>on</span>
  <span m='4921370'>b</span> <span m='4921540'>bits.</span> <span m='4921810'>As</span>
  <span m='4921900'>long</span> <span m='4922080'>as</span> <span m='4922200'>b</span>
  <span m='4922380'>is</span> <span m='4922500'>less</span> <span m='4922800'>than,</span>
  <span m='4923040'>like,</span> <span m='4923340'>1/2</span> <span m='4923680'>log</span>
  <span m='4924090'>n.</span> <span m='4925140'>Then</span> <span m='4925350'>you</span>
  <span m='4925500'>can</span> <span m='4926460'>encompass</span> <span m='4927330'>the</span>
  <span m='4927420'>whole</span> <span m='4928080'>trie,</span> <span m='4928530'>more</span>
  <span m='4928740'>or</span> <span m='4928770'>less.</span> </p><p><span m='4929730'>And</span>
  <span m='4929880'>just</span> <span m='4930390'>hit</span> <span m='4930540'>it</span>
  <span m='4930630'>with</span> <span m='4930780'>a</span> <span m='4930840'>big</span>
  <span m='4931050'>look-up</span> <span m='4931320'>table</span> <span m='4931620'>and</span>
  <span m='4931680'>do</span> <span m='4931740'>everything</span> <span m='4932730'>in</span>
  <span m='4932970'>constant</span> <span m='4933360'>time.</span> <span m='4933600'>It's</span>
  <span m='4933690'>not</span> <span m='4933840'>quite</span> <span m='4934230'>so</span>
  <span m='4934350'>simple,</span> <span m='4937600'>because--</span> <span m='4940320'>easy</span>
  <span m='4940850'>summary,</span> <span m='4941310'>here.</span> <span m='4952900'>Essentially,</span>
  <span m='4953800'>what</span> <span m='4954040'>you're</span> <span m='4954190'>doing</span>
  <span m='4956710'>is--</span> <span m='4958840'>these</span> <span m='4959050'>are</span>
  <span m='4959140'>the</span> <span m='4959260'>blocks.</span> <span m='4960175'>So</span>
  <span m='4960550'>this</span> <span m='4960760'>is</span> <span m='4960880'>length</span>
  <span m='4961190'>b.</span> <span m='4962410'>You're</span> <span m='4962560'>finding</span>
  <span m='4962980'>this</span> <span m='4963130'>suffix,</span> <span m='4964630'>and</span>
  <span m='4964930'>you</span> <span m='4965080'>want</span> <span m='4965290'>to</span>
  <span m='4965350'>know,</span> <span m='4965560'>which</span> <span m='4965830'>of</span>
  <span m='4965950'>these</span> <span m='4966550'>is</span> <span m='4966700'>the</span>
  <span m='4966820'>correct</span> <span m='4967180'>one.</span> <span m='4967590'>In</span>
  <span m='4967690'>some</span> <span m='4967870'>sense,</span> <span m='4968180'>you</span>
  <span m='4968280'>have</span> <span m='4968380'>to</span> <span m='4968480'>do</span>
  <span m='4968530'>the</span> <span m='4968590'>search</span> <span m='4968980'>simultaneously</span>
  <span m='4969730'>for</span> <span m='4969880'>all</span> <span m='4970090'>b</span>
  <span m='4970300'>of</span> <span m='4970390'>these</span> <span m='4970570'>guys.</span>
  </p><p><span m='4971620'>And</span> <span m='4971720'>so</span> <span m='4971740'>you</span>
  <span m='4971890'>run</span> <span m='4972160'>down</span> <span m='4972400'>the</span>
  <span m='4972460'>search</span> <span m='4972760'>again,</span> <span m='4973870'>but</span>
  <span m='4974110'>instead</span> <span m='4974410'>of</span> <span m='4974800'>searching</span>
  <span m='4975160'>for</span> <span m='4975430'>one</span> <span m='4975640'>pattern,</span>
  <span m='4975970'>you</span> <span m='4976060'>search</span> <span m='4976270'>for</span>
  <span m='4976360'>all</span> <span m='4976570'>b</span> <span m='4976750'>of</span>
  <span m='4976840'>these</span> <span m='4976990'>patterns</span> <span m='4977350'>at</span>
  <span m='4977440'>the</span> <span m='4977530'>same</span> <span m='4977740'>time.</span>
  <span m='4977980'>Now</span> <span m='4978130'>they're</span> <span m='4978250'>mostly</span>
  <span m='4978640'>the</span> <span m='4978760'>same,</span> <span m='4979570'>and</span>
  <span m='4979690'>so</span> <span m='4979870'>you</span> <span m='4980710'>can</span>
  <span m='4980830'>prove</span> <span m='4981070'>it</span> <span m='4981190'>doesn't</span>
  <span m='4981540'>hurt</span> <span m='4981730'>you</span> <span m='4981820'>much.</span>
  <span m='4982280'>Maybe</span> <span m='4982610'>it</span> <span m='4982750'>hurts</span>
  <span m='4982960'>you</span> <span m='4983070'>an</span> <span m='4983140'>additive</span>
  <span m='4983630'>b.</span> </p><p><span m='4984390'>I</span> <span m='4984460'>believe</span>
  <span m='4984670'>the</span> <span m='4984790'>correct</span> <span m='4985060'>answer</span>
  <span m='4985360'>is,</span> <span m='4986380'>in</span> <span m='4986530'>time,</span>
  <span m='4987150'>you</span> <span m='4987460'>end</span> <span m='4987640'>up</span>
  <span m='4987730'>paying</span> <span m='4988510'>quarter</span> <span m='4988850'>p</span>
  <span m='4989290'>plus</span> <span m='4989890'>b</span> <span m='4990780'>time.</span>
  <span m='4993430'>Sorry,</span> <span m='4993670'>times</span> <span m='4995050'>the</span>
  <span m='4995170'>cost</span> <span m='4995560'>of</span> <span m='4995710'>a</span>
  <span m='4995830'>suffix</span> <span m='4996220'>array</span> <span m='4996410'>access.</span>
  <span m='4997840'>OK,</span> <span m='4998020'>so</span> <span m='4998110'>we're</span>
  <span m='4998200'>still</span> <span m='4998410'>paying</span> <span m='4998630'>the</span>
  <span m='4998710'>log to</span> <span m='4998980'>the</span> <span m='4999100'>epsilon,</span>
  <span m='4999490'>because</span> <span m='4999760'>of</span> <span m='4999800'>the</span>
  <span m='4999910'>suffix</span> <span m='5000300'>array.</span> <span m='5001120'>If</span>
  <span m='5001460'>that</span> <span m='5001600'>was</span> <span m='5001770'>constant,</span>
  <span m='5002065'>it</span> <span m='5002360'>would</span> <span m='5002530'>be</span>
  <span m='5002700'>free.</span> </p><p><span m='5004310'>P</span> <span m='5004560'>plus</span>
  <span m='5005250'>b</span> <span m='5005430'>time</span> <span m='5006000'>is</span>
  <span m='5006180'>fine,</span> <span m='5006510'>if</span> <span m='5006600'>b</span>
  <span m='5006810'>is</span> <span m='5006930'>log</span> <span m='5007200'>log</span>
  <span m='5007450'>log</span> <span m='5007550'>log</span> <span m='5007650'>n.</span>
  <span m='5009160'>Or</span> <span m='5009180'>you</span> <span m='5009270'>can</span>
  <span m='5009390'>make</span> <span m='5009540'>it</span> <span m='5009630'>log</span>
  <span m='5009870'>log</span> <span m='5010080'>n.</span> <span m='5010290'>Then</span>
  <span m='5010440'>you</span> <span m='5010830'>save</span> <span m='5011160'>a</span>
  <span m='5011220'>log</span> <span m='5011490'>log</span> <span m='5011850'>n</span>
  <span m='5012030'>factor</span> <span m='5012350'>in</span> <span m='5012450'>the</span>
  <span m='5012540'>bits.</span> <span m='5013230'>You</span> <span m='5013320'>pay</span>
  <span m='5013500'>an</span> <span m='5013590'>additive</span> <span m='5013890'>log</span>
  <span m='5014130'>log</span> <span m='5014310'>n.</span> <span m='5014760'>That's</span>
  <span m='5014940'>going</span> <span m='5015090'>to</span> <span m='5015150'>be</span>
  <span m='5015210'>absorbed</span> <span m='5015540'>by</span> <span m='5015690'>the</span>
  <span m='5015780'>log</span> <span m='5015990'>to</span> <span m='5016050'>the</span>
  <span m='5016110'>epsilon</span> <span m='5016470'>anyway.</span> <span m='5016890'>So</span>
  <span m='5017700'>it's</span> <span m='5017790'>pretty</span> <span m='5018000'>efficient.</span>
  </p><p><span m='5018750'>I</span> <span m='5018810'>guess</span> <span m='5018990'>you</span>
  <span m='5019050'>can</span> <span m='5019170'>make</span> <span m='5019350'>this</span>
  <span m='5019470'>log</span> <span m='5019585'>to</span> <span m='5019700'>the</span>
  <span m='5019810'>epsilon,</span> <span m='5020180'>if</span> <span m='5020280'>you</span>
  <span m='5020370'>felt</span> <span m='5020550'>like</span> <span m='5020760'>it,</span>
  <span m='5021330'>to</span> <span m='5021420'>balance</span> <span m='5021780'>out</span>
  <span m='5022020'>here.</span> <span m='5023280'>Still</span> <span m='5023550'>would</span>
  <span m='5023715'>be</span> <span m='5023880'>P</span> <span m='5024140'>times</span>
  <span m='5024400'>log</span> <span m='5024570'>to</span> <span m='5024690'>the</span>
  <span m='5024810'>epsilon.</span> <span m='5025740'>And</span> <span m='5025860'>so</span>
  <span m='5026070'>this</span> <span m='5026610'>stuff</span> <span m='5026880'>is</span>
  <span m='5027000'>really</span> <span m='5027360'>quite</span> <span m='5027630'>cheap,</span>
  <span m='5028080'>see</span> <span m='5028380'>the</span> <span m='5028500'>notes</span>
  <span m='5028710'>for</span> <span m='5028860'>details.</span> <span m='5030360'>That</span>
  <span m='5031180'>ends</span> <span m='5031570'>our</span> <span m='5031770'>succinct</span>
  <span m='5032730'>coverage.</span> <span m='5034150'>Sorry,</span> <span m='5034260'>it</span>
  <span m='5034320'>was</span> <span m='5034410'>a</span> <span m='5034440'>little</span>
  <span m='5034620'>more</span> <span m='5034800'>succinct</span> <span m='5035290'>than</span>
  <span m='5035430'>intended.</span> <span m='5037700'>Get</span> <span m='5037920'>the</span>
  <span m='5038220'>idea.</span> </p>
type: course
uid: 08ed076386c178aa4f42b9e22c393026

---
None