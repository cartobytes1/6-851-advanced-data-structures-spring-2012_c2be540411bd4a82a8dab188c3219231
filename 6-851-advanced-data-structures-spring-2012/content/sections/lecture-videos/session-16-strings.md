---
about_this_resource_text: '<p><strong>Description:</strong> Strings: Suffix tree,
  suffix array, linear-time construction for large alphabets, suffix tray, document
  retrieval.</p> <p><strong>Speaker:</strong> Prof. Erik Demaine</p>'
course_id: 6-851-advanced-data-structures-spring-2012
embedded_media:
- id: Video-YouTube-Stream
  media_location: NinWEPPrkDQ
  parent_uid: 73a75f2eeb17f38bcd420f5902b0cea3
  title: Video-YouTube-Stream
  type: Video
  uid: 84a33455fb8addfeb0618c92b406b18a
- id: Video-iTunesU-MP4
  media_location: https://itunes.apple.com/us/itunes-u/session-16-strings/id735348884?i=169611723
  parent_uid: 73a75f2eeb17f38bcd420f5902b0cea3
  title: Video-iTunes U-MP4
  type: Video
  uid: 1d341833f154c53009c447ade51f75f9
- id: Video-InternetArchive-MP4
  media_location: http://www.archive.org/download/MIT6.851S12/MIT6_851S12_lec16_300k.mp4
  parent_uid: 73a75f2eeb17f38bcd420f5902b0cea3
  title: Video-Internet Archive-MP4
  type: Video
  uid: 13750757248f898992696d746ae08361
- id: Thumbnail-YouTube-JPG
  media_location: https://img.youtube.com/vi/NinWEPPrkDQ/default.jpg
  parent_uid: 73a75f2eeb17f38bcd420f5902b0cea3
  title: Thumbnail-YouTube-JPG
  type: Thumbnail
  uid: e4f85001804e3e621a01d56c146e1dba
- id: 3Play-3PlayYouTubeid-MP4
  media_location: NinWEPPrkDQ
  parent_uid: 73a75f2eeb17f38bcd420f5902b0cea3
  title: 3Play-3Play YouTube id
  type: 3Play
  uid: 75689abe0de2b6d5bf265323a9327f6c
- id: NinWEPPrkDQ.srt
  parent_uid: 73a75f2eeb17f38bcd420f5902b0cea3
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-851-advanced-data-structures-spring-2012/lecture-videos/session-16-strings/NinWEPPrkDQ.srt
  title: 3play caption file
  type: null
  uid: 43be189f245f4f92966106b1003bb3c9
- id: NinWEPPrkDQ.pdf
  parent_uid: 73a75f2eeb17f38bcd420f5902b0cea3
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-851-advanced-data-structures-spring-2012/lecture-videos/session-16-strings/NinWEPPrkDQ.pdf
  title: 3play pdf file
  type: null
  uid: cacd3078b593e0bd30e02d1260d2a2ae
- id: Caption-3Play YouTube id-SRT
  parent_uid: 73a75f2eeb17f38bcd420f5902b0cea3
  title: Caption-3Play YouTube id-SRT-English - US
  type: Caption
  uid: da3b10aa56e72be6fa5406340f62a960
- id: Transcript-3Play YouTube id-PDF
  parent_uid: 73a75f2eeb17f38bcd420f5902b0cea3
  title: Transcript-3Play YouTube id-PDF-English - US
  type: Transcript
  uid: 1289c33f3c1260b25c2aee4c86d02fa9
inline_embed_id: 70386951session16:strings19569829
layout: video
order_index: null
parent_uid: b66cbbb7b35e74ff17cdbf44e5fb6b1d
related_resources_text: ''
short_url: session-16-strings
technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-851-advanced-data-structures-spring-2012/lecture-videos/session-16-strings
template_type: Tabbed
title: 'Session 16: Strings'
transcript: <p><span m='90'>The</span> <span m='180'>following</span> <span m='600'>content</span>
  <span m='1200'>is</span> <span m='1320'>provided</span> <span m='1770'>under</span>
  <span m='2009'>a</span> <span m='2100'>Creative</span> <span m='2490'>Commons</span>
  <span m='2910'>license.</span> <span m='4059'>Your</span> <span m='4200'>support</span>
  <span m='4710'>will</span> <span m='4860'>help</span> <span m='5100'>MIT</span>
  <span m='5550'>OpenCourseWare</span> <span m='6330'>continue</span> <span m='6870'>to</span>
  <span m='6960'>offer</span> <span m='7410'>high</span> <span m='7620'>quality</span>
  <span m='8100'>educational</span> <span m='8730'>resources</span> <span m='9360'>for</span>
  <span m='9510'>free.</span> <span m='10720'>To</span> <span m='10740'>make</span>
  <span m='10920'>a</span> <span m='10980'>donation</span> <span m='11730'>or</span>
  <span m='11940'>view</span> <span m='12390'>additional</span> <span m='12810'>materials</span>
  <span m='13320'>from</span> <span m='13500'>hundreds</span> <span m='13920'>of</span>
  <span m='14040'>MIT</span> <span m='14460'>courses,</span> <span m='15550'>visit</span>
  <span m='15780'>MIT</span> <span m='16200'>OpenCourseWare</span> <span m='17280'>at</span>
  <span m='17430'>osw.mit.edu.</span> </p><p><span m='20610'>ERIK DEMAINE:</span>
  <span m='20640'>All</span> <span m='20670'>right.</span> <span m='20790'>Today's</span>
  <span m='21240'>lecture's</span> <span m='21720'>full</span> <span m='21930'>of</span>
  <span m='22260'>tries</span> <span m='22750'>and</span> <span m='22950'>trays,</span>
  <span m='23610'>and</span> <span m='23760'>trees.</span> <span m='24270'>Oh,</span>
  <span m='24420'>my.</span> <span m='25170'>Lots</span> <span m='25420'>of</span>
  <span m='25560'>different</span> <span m='26730'>synonyms</span> <span m='27600'>all</span>
  <span m='28170'>coming</span> <span m='28500'>from</span> <span m='28710'>trees.</span>
  <span m='30150'>In</span> <span m='30270'>particular,</span> <span m='30660'>we're</span>
  <span m='30760'>going</span> <span m='30860'>to</span> <span m='30930'>cover</span>
  <span m='31620'>suffix</span> <span m='32040'>trees</span> <span m='32280'>today</span>
  <span m='32610'>and</span> <span m='32729'>various</span> <span m='33090'>representations</span>
  <span m='33870'>of</span> <span m='33990'>them,</span> <span m='34320'>and</span>
  <span m='35010'>how</span> <span m='35190'>to</span> <span m='35280'>build</span>
  <span m='35460'>them</span> <span m='35640'>in</span> <span m='35730'>linear</span>
  <span m='36030'>time.</span> <span m='36840'>Now,</span> <span m='36930'>they</span>
  <span m='37020'>are</span> <span m='37050'>good</span> <span m='37230'>things.</span>
  <span m='37470'>Some</span> <span m='37710'>of</span> <span m='37800'>you</span>
  <span m='37920'>may</span> <span m='38040'>have</span> <span m='38130'>seen</span>
  <span m='38310'>suffix</span> <span m='38700'>trees</span> <span m='38940'>before,</span>
  <span m='39840'>but</span> <span m='40740'>hopefully,</span> <span m='41710'>haven't</span>
  <span m='42090'>actually</span> <span m='42420'>seen</span> <span m='42630'>most</span>
  <span m='42870'>of</span> <span m='42930'>the</span> <span m='43020'>things</span>
  <span m='43260'>we're</span> <span m='43350'>going</span> <span m='43470'>to</span>
  <span m='43530'>cover,</span> <span m='44130'>except</span> <span m='44510'>for</span>
  <span m='44640'>the</span> <span m='44730'>very</span> <span m='45150'>basics.</span>
  </p><p><span m='46360'>So</span> <span m='46860'>the</span> <span m='46950'>general</span>
  <span m='47370'>problem</span> <span m='48000'>we're</span> <span m='48180'>interested</span>
  <span m='48690'>in</span> <span m='48930'>solving</span> <span m='49410'>today</span>
  <span m='50580'>is</span> <span m='50820'>string</span> <span m='51180'>matching.</span>
  <span m='57660'>And</span> <span m='59520'>in</span> <span m='59940'>string</span>
  <span m='60210'>matching</span> <span m='60480'>we</span> <span m='60750'>are</span>
  <span m='60900'>given</span> <span m='61350'>two</span> <span m='61590'>strings.</span>
  <span m='62610'>One</span> <span m='62850'>of</span> <span m='62910'>them</span>
  <span m='63150'>we</span> <span m='63270'>call</span> <span m='64349'>the</span>
  <span m='64440'>text</span> <span m='65400'>T</span> <span m='66750'>and</span>
  <span m='66960'>the</span> <span m='67020'>other</span> <span m='67170'>one</span>
  <span m='67290'>we</span> <span m='67410'>call</span> <span m='67650'>a</span> <span
  m='67710'>pattern</span> <span m='68280'>P.</span> <span m='72480'>These</span>
  <span m='72690'>are</span> <span m='72780'>both</span> <span m='76800'>strings</span>
  <span m='78630'>over</span> <span m='78900'>some</span> <span m='79140'>alphabet.</span>
  <span m='80955'>And the</span> <span m='81360'>alphabet</span> <span m='81900'>we're</span>
  <span m='82020'>going</span> <span m='82170'>to</span> <span m='82530'>always</span>
  <span m='82770'>call</span> <span m='83160'>capital</span> <span m='83640'>Sigma.</span>
  </p><p><span m='85950'>Think</span> <span m='86190'>of</span> <span m='86310'>that.</span>
  <span m='86970'>It</span> <span m='87090'>could</span> <span m='87240'>be</span>
  <span m='87390'>binary--</span> <span m='87780'>0</span> <span m='88050'>and 1.</span>
  <span m='88470'>Could</span> <span m='88680'>be</span> <span m='89400'>ASCII,</span>
  <span m='90160'>so</span> <span m='90370'>there's</span> <span m='90540'>256</span>
  <span m='91320'>characters</span> <span m='91710'>in</span> <span m='91800'>there.</span>
  <span m='91950'>Could</span> <span m='92100'>be</span> <span m='92250'>Unicode--</span>
  <span m='93000'>pick</span> <span m='93180'>your</span> <span m='93300'>favorite</span>
  <span m='93720'>alphabet.</span> <span m='95280'>Then</span> <span m='95880'>it</span>
  <span m='96370'>could</span> <span m='96540'>be</span> <span m='96690'>ACGT</span>
  <span m='97480'>for</span> <span m='97680'>DNA.</span> <span m='100410'>And</span>
  <span m='101060'>their</span> <span m='101220'>goal</span> <span m='101640'>is</span>
  <span m='101880'>to</span> <span m='102030'>find</span> <span m='102690'>the</span>
  <span m='102870'>occurrences</span> <span m='103500'>of</span> <span m='103620'>the</span>
  <span m='103710'>pattern</span> <span m='104100'>in</span> <span m='104250'>the</span>
  <span m='104340'>text.</span> <span m='112960'>Could</span> <span m='113130'>be</span>
  <span m='113310'>we</span> <span m='113430'>want</span> <span m='113610'>to</span>
  <span m='113670'>find</span> <span m='113940'>some</span> <span m='114180'>of</span>
  <span m='114300'>those</span> <span m='114510'>occurrences</span> <span m='115170'>or</span>
  <span m='115290'>all</span> <span m='115530'>of</span> <span m='115620'>them,</span>
  <span m='115950'>or</span> <span m='116040'>count</span> <span m='116410'>them.</span>
  </p><p><span m='129870'>And</span> <span m='130259'>in</span> <span m='130380'>this</span>
  <span m='131009'>lecture,</span> <span m='132030'>we're</span> <span m='132180'>only</span>
  <span m='132450'>interested</span> <span m='132900'>in</span> <span m='133440'>substring</span>
  <span m='134280'>searches.</span> <span m='134930'>So</span> <span m='135030'>the</span>
  <span m='135150'>pattern</span> <span m='135540'>is</span> <span m='136410'>just</span>
  <span m='136590'>a</span> <span m='136650'>string.</span> <span m='137580'>You</span>
  <span m='137700'>want</span> <span m='137820'>to</span> <span m='137880'>know</span>
  <span m='138330'>all</span> <span m='138600'>the</span> <span m='138870'>places</span>
  <span m='142470'>where</span> <span m='142710'>P</span> <span m='143190'>occurs.</span>
  <span m='145000'>P</span> <span m='145230'>might</span> <span m='145620'>appear</span>
  <span m='145980'>multiple</span> <span m='146340'>times,</span> <span m='147420'>even</span>
  <span m='147720'>overlapping</span> <span m='148260'>itself--</span> <span m='149910'>in</span>
  <span m='150030'>those</span> <span m='150210'>two</span> <span m='150570'>positions,</span>
  <span m='151140'>whatever.</span> <span m='151740'>You</span> <span m='151850'>want</span>
  <span m='151980'>to</span> <span m='152040'>find</span> <span m='152220'>all</span>
  <span m='152370'>the</span> <span m='152490'>shifts</span> <span m='152760'>of P</span>
  <span m='153120'>where</span> <span m='153270'>it's</span> <span m='153450'>identical</span>
  <span m='153990'>to</span> <span m='154140'>T.</span> </p><p><span m='154770'>Now,</span>
  <span m='154860'>there</span> <span m='154950'>are</span> <span m='155010'>lots</span>
  <span m='155220'>of</span> <span m='155280'>variations</span> <span m='155820'>on</span>
  <span m='155910'>this</span> <span m='156030'>problem</span> <span m='156420'>which</span>
  <span m='156570'>we</span> <span m='156690'>won't</span> <span m='156900'>look</span>
  <span m='157140'>at</span> <span m='157570'>in</span> <span m='157800'>this</span>
  <span m='158160'>lecture,</span> <span m='159750'>such</span> <span m='160020'>as</span>
  <span m='160140'>when</span> <span m='160530'>the</span> <span m='160590'>pattern</span>
  <span m='160920'>has</span> <span m='161100'>wildcards</span> <span m='161700'>in</span>
  <span m='161820'>it,</span> <span m='162180'>or</span> <span m='162360'>you</span>
  <span m='162450'>could</span> <span m='162600'>imagine</span> <span m='162960'>it</span>
  <span m='163020'>being</span> <span m='163230'>a</span> <span m='163290'>regular</span>
  <span m='163620'>expression,</span> <span m='164340'>or</span> <span m='164460'>you</span>
  <span m='164520'>don't</span> <span m='164640'>want</span> <span m='164790'>to</span>
  <span m='164850'>match</span> <span m='165060'>exactly,</span> <span m='165610'>you</span>
  <span m='165720'>want</span> <span m='165870'>to</span> <span m='165960'>match</span>
  <span m='166200'>approximately,</span> <span m='166760'>you</span> <span m='166920'>could</span>
  <span m='167070'>have</span> <span m='167200'>some</span> <span m='167340'>mismatches,</span>
  <span m='168930'>or</span> <span m='169530'>it</span> <span m='169860'>could</span>
  <span m='170040'>require</span> <span m='170340'>some</span> <span m='170550'>edits</span>
  <span m='171710'>to</span> <span m='171960'>match</span> <span m='172470'>T.</span>
  <span m='172890'>We're</span> <span m='173010'>not</span> <span m='173160'>going</span>
  <span m='173280'>to</span> <span m='173340'>look</span> <span m='173520'>at</span>
  <span m='173610'>those</span> <span m='173790'>problems.</span> </p><p><span m='176920'>This</span>
  <span m='177030'>is</span> <span m='177120'>both</span> <span m='177330'>an</span>
  <span m='177420'>algorithmic</span> <span m='177870'>problem</span> <span m='178410'>and</span>
  <span m='178740'>a</span> <span m='178830'>data</span> <span m='179070'>structures</span>
  <span m='179460'>problem.</span> <span m='180780'>If</span> <span m='181050'>I</span>
  <span m='181140'>give</span> <span m='181440'>you</span> <span m='181650'>this</span>
  <span m='181890'>text</span> <span m='182210'>in</span> <span m='182280'>the</span>
  <span m='182370'>pattern,</span> <span m='182730'>I</span> <span m='182820'>just</span>
  <span m='183000'>want</span> <span m='183150'>to</span> <span m='183210'>know</span>
  <span m='183390'>the</span> <span m='183540'>answer.</span> <span m='184200'>You</span>
  <span m='184350'>can</span> <span m='184500'>do</span> <span m='184590'>that</span>
  <span m='184770'>in</span> <span m='184860'>linear</span> <span m='185160'>time--</span>
  <span m='185610'>it's</span> <span m='185880'>famous</span> <span m='186570'>Knuth-Morris-Pratt,</span>
  <span m='187830'>or</span> <span m='188220'>Boyer-Moore,</span> <span m='189510'>or</span>
  <span m='190780'>Rabin-Karp.</span> <span m='192840'>Lots</span> <span m='193110'>of</span>
  <span m='193230'>linear</span> <span m='193470'>time</span> <span m='193680'>algorithms</span>
  <span m='193980'>for</span> <span m='194130'>doing</span> <span m='194370'>that.</span>
  </p><p><span m='194610'>We're</span> <span m='194820'>interested</span> <span m='195360'>in</span>
  <span m='195720'>the</span> <span m='195840'>data</span> <span m='196080'>structure</span>
  <span m='196410'>version</span> <span m='196680'>of</span> <span m='196740'>the</span>
  <span m='196830'>problem,</span> <span m='198690'>static</span> <span m='199140'>data</span>
  <span m='199380'>structure.</span> <span m='201070'>So</span> <span m='201600'>we're</span>
  <span m='201810'>given</span> <span m='202320'>the</span> <span m='202440'>text</span>
  <span m='202920'>up</span> <span m='203080'>front,</span> <span m='204210'>given</span>
  <span m='204490'>T.</span> <span m='205210'>We</span> <span m='205380'>want</span>
  <span m='205530'>to</span> <span m='205590'>preprocess</span> <span m='206340'>T.</span>
  <span m='207660'>And</span> <span m='207810'>then</span> <span m='208380'>the</span>
  <span m='208820'>query</span> <span m='210900'>consists</span> <span m='211590'>of</span>
  <span m='211770'>the</span> <span m='211890'>pattern.</span> <span m='214110'>Imagine</span>
  <span m='214520'>T</span> <span m='214740'>being</span> <span m='214980'>very</span>
  <span m='215160'>big,</span> <span m='216020'>P</span> <span m='216300'>being</span>
  <span m='216570'>not</span> <span m='216720'>so</span> <span m='216870'>big.</span>
  <span m='217980'>And</span> <span m='218190'>we'd</span> <span m='218370'>like</span>
  <span m='218640'>to</span> <span m='218760'>spend</span> <span m='220290'>something</span>
  <span m='220800'>like</span> <span m='224460'>order</span> <span m='225400'>P</span>
  <span m='225780'>time</span> <span m='226800'>to</span> <span m='226950'>do</span>
  <span m='227310'>a</span> <span m='227370'>query.</span> <span m='231240'>That</span>
  <span m='231420'>would</span> <span m='231540'>be</span> <span m='231960'>ideal</span>
  <span m='232470'>because</span> <span m='232650'>you</span> <span m='232740'>have</span>
  <span m='232920'>to</span> <span m='232980'>at</span> <span m='233040'>least</span>
  <span m='233220'>look</span> <span m='233430'>at</span> <span m='233520'>the</span>
  <span m='233610'>query</span> <span m='234550'>and</span> <span m='234660'>you</span>
  <span m='234750'>don't</span> <span m='234930'>really</span> <span m='235170'>want</span>
  <span m='235320'>to</span> <span m='235410'>spend</span> <span m='235710'>time</span>
  <span m='235950'>looking</span> <span m='236220'>at</span> <span m='236310'>the</span>
  <span m='236400'>text.</span> </p><p><span m='237240'>You'd</span> <span m='237390'>also</span>
  <span m='237750'>like</span> <span m='238050'>something</span> <span m='238440'>like</span>
  <span m='239370'>order</span> <span m='239700'>T</span> <span m='241680'>space.</span>
  <span m='243750'>We</span> <span m='243840'>don't</span> <span m='243990'>want</span>
  <span m='244140'>the</span> <span m='244230'>space</span> <span m='244590'>of</span>
  <span m='244650'>the</span> <span m='244740'>data</span> <span m='244920'>structure</span>
  <span m='245280'>to</span> <span m='245340'>be</span> <span m='245430'>much</span>
  <span m='245670'>bigger</span> <span m='245970'>than</span> <span m='246180'>the</span>
  <span m='246300'>original</span> <span m='246690'>text.</span> <span m='247590'>So</span>
  <span m='247740'>these</span> <span m='247950'>are</span> <span m='248040'>goals</span>
  <span m='248400'>which</span> <span m='248580'>we</span> <span m='248760'>will</span>
  <span m='248940'>more</span> <span m='249330'>or</span> <span m='249360'>less</span>
  <span m='249630'>achieve,</span> <span m='250500'>depending</span> <span m='250830'>on</span>
  <span m='250920'>exactly</span> <span m='251340'>the</span> <span m='251430'>problem</span>
  <span m='251730'>you</span> <span m='251850'>want.</span> <span m='252060'>Sometimes</span>
  <span m='252450'>we'll</span> <span m='252540'>achieve</span> <span m='252840'>this,</span>
  <span m='253020'>sometimes</span> <span m='253410'>we'll</span> <span m='253500'>achieve</span>
  <span m='253740'>almost</span> <span m='254160'>this.</span> <span m='256019'>But</span>
  <span m='257940'>these</span> <span m='258060'>are</span> <span m='258149'>really</span>
  <span m='258450'>nice</span> <span m='259050'>running</span> <span m='259290'>times</span>
  <span m='260190'>and</span> <span m='260370'>space.</span> <span m='261529'>It's</span>
  <span m='261630'>all</span> <span m='261810'>optimal.</span> </p><p><span m='264710'>Before</span>
  <span m='265070'>we</span> <span m='265190'>get</span> <span m='265340'>to</span>
  <span m='265550'>that</span> <span m='265850'>problem,</span> <span m='266390'>I</span>
  <span m='266510'>want</span> <span m='266660'>to</span> <span m='266750'>solve</span>
  <span m='267110'>a</span> <span m='267200'>simpler</span> <span m='267530'>problem</span>
  <span m='268110'>which</span> <span m='268220'>is</span> <span m='268340'>necessary</span>
  <span m='269160'>to</span> <span m='269230'>solve</span> <span m='269510'>this</span>
  <span m='269690'>one.</span> <span m='272400'>We'll</span> <span m='272900'>call</span>
  <span m='273170'>it</span> <span m='273290'>a</span> <span m='273350'>warm</span>
  <span m='273620'>up.</span> <span m='276460'>And</span> <span m='276960'>that's</span>
  <span m='277170'>a</span> <span m='277250'>good</span> <span m='277430'>friend--</span>
  <span m='277670'>the</span> <span m='277760'>predecessor</span> <span m='278360'>problem,</span>
  <span m='281860'>but</span> <span m='282050'>now</span> <span m='282440'>among</span>
  <span m='282860'>strings.</span> </p><p><span m='288060'>Let's</span> <span m='288160'>say</span>
  <span m='288380'>we</span> <span m='288500'>have</span> <span m='288740'>k</span>
  <span m='289070'>strings--</span> <span m='290970'>k</span> <span m='291440'>texts--</span>
  <span m='292800'>T1</span> <span m='293200'>to</span> <span m='293270'>T</span>
  <span m='293530'>k.</span> <span m='294410'>And</span> <span m='294500'>now</span>
  <span m='294650'>the</span> <span m='294770'>query</span> <span m='295220'>is</span>
  <span m='295460'>you're</span> <span m='295550'>given</span> <span m='295790'>some</span>
  <span m='295970'>pattern</span> <span m='296330'>P</span> <span m='297200'>and</span>
  <span m='297380'>you</span> <span m='297500'>want</span> <span m='297710'>to</span>
  <span m='297770'>know</span> <span m='297950'>where</span> <span m='298310'>P</span>
  <span m='298730'>fits</span> <span m='299090'>among</span> <span m='299420'>these</span>
  <span m='299570'>strings</span> <span m='300020'>in</span> <span m='300260'>lexical</span>
  <span m='300770'>order.</span> <span m='302070'>So</span> <span m='302230'>a</span>
  <span m='302300'>regular</span> <span m='302630'>predecessor,</span> <span m='303200'>but</span>
  <span m='303320'>now</span> <span m='303590'>comparison</span> <span m='304160'>is</span>
  <span m='304370'>string</span> <span m='304640'>comparison.</span> </p><p><span
  m='306080'>Of</span> <span m='306170'>course,</span> <span m='306570'>you</span>
  <span m='306800'>could</span> <span m='306950'>try</span> <span m='307190'>to</span>
  <span m='307280'>solve</span> <span m='307940'>that</span> <span m='308240'>using</span>
  <span m='308570'>our</span> <span m='308660'>existing</span> <span m='309050'>predecessor</span>
  <span m='309530'>data</span> <span m='309740'>structures.</span> <span m='310130'>But</span>
  <span m='310250'>they</span> <span m='310400'>won't</span> <span m='310580'>do</span>
  <span m='310730'>very</span> <span m='310940'>well.</span> <span m='311510'>Even</span>
  <span m='311780'>a</span> <span m='311840'>binary</span> <span m='312170'>search</span>
  <span m='312470'>tree</span> <span m='312680'>is</span> <span m='312770'>not</span>
  <span m='312890'>going</span> <span m='313040'>to</span> <span m='313100'>do</span>
  <span m='313280'>well</span> <span m='313490'>here</span> <span m='314120'>because</span>
  <span m='314420'>comparing</span> <span m='314870'>two</span> <span m='314990'>strings</span>
  <span m='315350'>could</span> <span m='315470'>take</span> <span m='315710'>a</span>
  <span m='315770'>very</span> <span m='315980'>long</span> <span m='316190'>time</span>
  <span m='316490'>if</span> <span m='316610'>those</span> <span m='316700'>strings</span>
  <span m='317000'>are</span> <span m='317090'>long.</span> <span m='318350'>So</span>
  <span m='318680'>we</span> <span m='318770'>don't</span> <span m='318920'>want</span>
  <span m='319070'>to</span> <span m='319130'>do</span> <span m='319250'>that.</span>
  <span m='319980'>Instead,</span> <span m='320690'>we're</span> <span m='320810'>going</span>
  <span m='320930'>to</span> <span m='321020'>build</span> <span m='322130'>a</span>
  <span m='322190'>trie.</span> </p><p><span m='324470'>Now,</span> <span m='324620'>tries</span>
  <span m='325340'>we've</span> <span m='325520'>seen</span> <span m='325950'>in</span>
  <span m='327260'>fast</span> <span m='327620'>sorting</span> <span m='328010'>lecture,</span>
  <span m='329440'>when</span> <span m='329630'>w</span> <span m='329980'>is</span>
  <span m='330110'>at</span> <span m='330200'>least</span> <span m='330380'>logs</span>
  <span m='330620'>at</span> <span m='330740'>two</span> <span m='330890'>plus</span>
  <span m='331130'>epsilon</span> <span m='331490'>event.</span> <span m='334110'>We</span>
  <span m='334130'>used</span> <span m='334310'>tries</span> <span m='334670'>in</span>
  <span m='334760'>a</span> <span m='334820'>particular</span> <span m='335420'>setting</span>
  <span m='335930'>there.</span> <span m='336740'>We're</span> <span m='336890'>going</span>
  <span m='337010'>to</span> <span m='337070'>use</span> <span m='337310'>them</span>
  <span m='337670'>in</span> <span m='337880'>their</span> <span m='338330'>more</span>
  <span m='338570'>native</span> <span m='338960'>setting</span> <span m='340130'>today</span>
  <span m='341360'>a</span> <span m='341450'>lot.</span> <span m='345080'>In</span>
  <span m='345230'>this</span> <span m='345440'>setting--</span> <span m='348260'>again,</span>
  <span m='348800'>a</span> <span m='348860'>trie</span> <span m='349130'>is</span>
  <span m='349270'>a</span> <span m='349350'>rooted</span> <span m='349610'>tree.</span>
  <span m='351710'>The</span> <span m='351800'>children</span> <span m='352550'>branches</span>
  <span m='353090'>are</span> <span m='353220'>labeled.</span> <span m='360000'>And</span>
  <span m='360180'>in</span> <span m='360270'>this</span> <span m='360450'>case,</span>
  <span m='360960'>they're</span> <span m='361140'>labeled</span> <span m='361710'>with</span>
  <span m='362070'>letters</span> <span m='362640'>in</span> <span m='363120'>the</span>
  <span m='363270'>alphabet--</span> <span m='364440'>Sigma.</span> </p><p><span m='366030'>So</span>
  <span m='366170'>you</span> <span m='366240'>have</span> <span m='366450'>a</span>
  <span m='366490'>node.</span> <span m='367830'>And</span> <span m='368250'>let's</span>
  <span m='368400'>say,</span> <span m='368640'>we</span> <span m='368790'>have</span>
  <span m='371180'>the</span> <span m='371340'>English</span> <span m='371700'>alphabet--</span>
  <span m='372390'>a,</span> <span m='372720'>b,</span> <span m='373020'>up</span>
  <span m='373320'>to</span> <span m='373470'>z.</span> <span m='374586'>Those</span>
  <span m='374970'>are your</span> <span m='375090'>26</span> <span m='375690'>possible</span>
  <span m='376110'>children.</span> <span m='376560'>Some</span> <span m='376830'>of</span>
  <span m='376890'>them</span> <span m='377040'>may</span> <span m='377220'>not</span>
  <span m='377400'>exist,</span> <span m='377655'>they</span> <span m='377910'>are</span>
  <span m='378000'>null</span> <span m='378210'>pointers.</span> <span m='379200'>Others</span>
  <span m='379620'>may</span> <span m='379860'>point</span> <span m='380160'>to</span>
  <span m='380460'>actual</span> <span m='380790'>nodes.</span> <span m='383340'>That</span>
  <span m='383580'>is</span> <span m='383970'>a</span> <span m='384030'>trie</span>
  <span m='384510'>in</span> <span m='384600'>its</span> <span m='384780'>native</span>
  <span m='385110'>setting,</span> <span m='385560'>which</span> <span m='385770'>is</span>
  <span m='385920'>when</span> <span m='386190'>the</span> <span m='386340'>alphabet</span>
  <span m='387360'>is</span> <span m='387450'>something</span> <span m='387810'>you</span>
  <span m='387930'>care</span> <span m='388170'>about.</span> </p><p><span m='388750'>Now,</span>
  <span m='388800'>when</span> <span m='388950'>we</span> <span m='389280'>used</span>
  <span m='389490'>tries</span> <span m='389820'>before,</span> <span m='390570'>our</span>
  <span m='390720'>alphabet</span> <span m='391260'>just</span> <span m='391470'>represented</span>
  <span m='392040'>some</span> <span m='392250'>digit</span> <span m='392670'>in</span>
  <span m='392850'>some</span> <span m='393090'>kind</span> <span m='393240'>of</span>
  <span m='393330'>arbitrary</span> <span m='393840'>representation.</span> <span
  m='395900'>The</span> <span m='396030'>digit</span> <span m='396330'>was</span>
  <span m='396480'>made</span> <span m='396660'>up</span> <span m='396810'>of</span>
  <span m='396900'>log</span> <span m='397110'>to</span> <span m='397170'>the</span>
  <span m='397290'>epsilon</span> <span m='397650'>bits.</span> <span m='398160'>We</span>
  <span m='398220'>were</span> <span m='398340'>just</span> <span m='398490'>using
  it</span> <span m='398800'>as</span> <span m='398970'>a</span> <span m='399030'>tool.</span>
  <span m='399840'>But</span> <span m='400050'>this</span> <span m='400230'>is</span>
  <span m='400320'>where</span> <span m='400470'>tries</span> <span m='400860'>actually</span>
  <span m='401160'>come</span> <span m='401380'>from--</span> <span m='401670'>they</span>
  <span m='401880'>come</span> <span m='402120'>from</span> <span m='402810'>trying</span>
  <span m='403140'>to</span> <span m='403260'>retrieve</span> <span m='404100'>strings</span>
  <span m='405450'>out</span> <span m='405660'>of</span> <span m='407400'>some</span>
  <span m='407640'>database,</span> <span m='408035'>in</span> <span m='408430'>this</span>
  <span m='408600'>case.</span> </p><p><span m='408840'>We're</span> <span m='408930'>doing</span>
  <span m='409110'>predecessor--</span> <span m='410420'>this</span> <span m='410610'>is</span>
  <span m='410760'>a</span> <span m='410940'>practical</span> <span m='411420'>problem.</span>
  <span m='412320'>Like</span> <span m='413310'>a</span> <span m='413340'>lot</span>
  <span m='413460'>of</span> <span m='413580'>library</span> <span m='414210'>search</span>
  <span m='414510'>engines,</span> <span m='414900'>you</span> <span m='414990'>type</span>
  <span m='415260'>in</span> <span m='415380'>the</span> <span m='415500'>beginning</span>
  <span m='415890'>of</span> <span m='415950'>the</span> <span m='416070'>title</span>
  <span m='416370'>of</span> <span m='416460'>a</span> <span m='416520'>book</span>
  <span m='416850'>and</span> <span m='417330'>you</span> <span m='417900'>want</span>
  <span m='418080'>to</span> <span m='418140'>know</span> <span m='418440'>what</span>
  <span m='418620'>is</span> <span m='418800'>the</span> <span m='418920'>preceding</span>
  <span m='419550'>and</span> <span m='419640'>succeeding</span> <span m='420870'>book</span>
  <span m='421080'>title</span> <span m='421820'>of</span> <span m='422010'>what</span>
  <span m='422160'>you</span> <span m='422310'>query</span> <span m='422640'>for.</span>
  <span m='423690'>So</span> <span m='424170'>this</span> <span m='424320'>is</span>
  <span m='424530'>something</span> <span m='425460'>people</span> <span m='425730'>care</span>
  <span m='425970'>about.</span> <span m='426240'>Although</span> <span m='426450'>really</span>
  <span m='426810'>they</span> <span m='427080'>want</span> <span m='427260'>us--</span>
  <span m='427560'>typically,</span> <span m='427910'>we</span> <span m='427950'>want</span>
  <span m='428070'>to</span> <span m='428130'>solve</span> <span m='428340'>this</span>
  <span m='428520'>problem</span> <span m='429060'>because</span> <span m='429270'>it's</span>
  <span m='430080'>harder.</span> </p><p><span m='433020'>So</span> <span m='433230'>that's</span>
  <span m='433440'>a</span> <span m='433500'>trie.</span> <span m='435390'>Now,</span>
  <span m='436290'>to</span> <span m='436470'>make</span> <span m='437280'>this</span>
  <span m='437460'>actually</span> <span m='438870'>work,</span> <span m='439350'>what</span>
  <span m='439500'>we'd</span> <span m='439650'>like</span> <span m='439920'>to</span>
  <span m='440070'>do</span> <span m='443070'>is</span> <span m='443280'>represent</span>
  <span m='444180'>our</span> <span m='444330'>strings.</span> <span m='445410'>So</span>
  <span m='445560'>how</span> <span m='445650'>do</span> <span m='445740'>we</span>
  <span m='445860'>use</span> <span m='446130'>this</span> <span m='446310'>structure</span>
  <span m='446970'>to</span> <span m='447090'>represent</span> <span m='447960'>strings</span>
  <span m='448350'>T1</span> <span m='448720'>to</span> <span m='448800'>T</span>
  <span m='449250'>k?</span> <span m='453090'>We're</span> <span m='453150'>going</span>
  <span m='453270'>to</span> <span m='453360'>represent</span> <span m='453840'>those</span>
  <span m='454020'>strings</span> <span m='455960'>in</span> <span m='456180'>the</span>
  <span m='456420'>obvious</span> <span m='456900'>way,</span> <span m='457130'>which</span>
  <span m='457320'>we've</span> <span m='457500'>done</span> <span m='458070'>many</span>
  <span m='458310'>times</span> <span m='458670'>in</span> <span m='458760'>the</span>
  <span m='458850'>past</span> <span m='459780'>when</span> <span m='459920'>we were</span>
  <span m='460050'>doing</span> <span m='460260'>integer</span> <span m='460550'>data</span>
  <span m='460770'>structures--</span> <span m='461970'>as</span> <span m='462330'>root</span>
  <span m='462540'>to</span> <span m='462690'>leaf</span> <span m='463070'>paths.</span>
  <span m='468790'>Because</span> <span m='469030'>any</span> <span m='469270'>root</span>
  <span m='469450'>to</span> <span m='469570'>leaf</span> <span m='469750'>path</span>
  <span m='470140'>is</span> <span m='470260'>just</span> <span m='470440'>a</span>
  <span m='470500'>sequence</span> <span m='470890'>of</span> <span m='470980'>letters,</span>
  <span m='471370'>and</span> <span m='471460'>that's</span> <span m='471700'>a</span>
  <span m='471760'>string.</span> <span m='472120'>So</span> <span m='472420'>we</span>
  <span m='472750'>just</span> <span m='472930'>throw</span> <span m='473200'>them</span>
  <span m='473350'>in</span> <span m='473470'>there.</span> </p><p><span m='474520'>Now,</span>
  <span m='474850'>to</span> <span m='475000'>do</span> <span m='475180'>that,</span>
  <span m='475570'>we</span> <span m='475750'>need</span> <span m='475990'>to</span>
  <span m='477130'>change</span> <span m='477430'>things</span> <span m='477670'>a</span>
  <span m='477700'>little</span> <span m='477970'>bit.</span> <span m='479360'>We're</span>
  <span m='479380'>going</span> <span m='479500'>to</span> <span m='479590'>add</span>
  <span m='480130'>a</span> <span m='480370'>new</span> <span m='481930'>letter,</span>
  <span m='485260'>which</span> <span m='485470'>we</span> <span m='485580'>usually</span>
  <span m='486270'>present</span> <span m='486790'>as</span> <span m='486970'>$</span>
  <span m='487390'>sign,</span> <span m='488680'>to</span> <span m='488830'>the</span>
  <span m='489010'>end</span> <span m='489400'>of</span> <span m='489550'>every</span>
  <span m='489790'>string.</span> <span m='501550'>I</span> <span m='501640'>have</span>
  <span m='501880'>an</span> <span m='501940'>example.</span> <span m='504390'>We're</span>
  <span m='504520'>going</span> <span m='504640'>to</span> <span m='504730'>do</span>
  <span m='512470'>four</span> <span m='512679'>strings--</span> <span m='517679'>various</span>
  <span m='518049'>spellings</span> <span m='518679'>of</span> <span m='518980'>Anna</span>
  <span m='519309'>and</span> <span m='519460'>Ann.</span> <span m='521590'>And</span>
  <span m='522400'>say,</span> <span m='522830'>we'd</span> <span m='522909'>like</span>
  <span m='523090'>to</span> <span m='523210'>throw</span> <span m='523480'>these</span>
  <span m='523870'>into</span> <span m='524710'>a</span> <span m='524770'>trie.</span>
  </p><p><span m='527170'>They</span> <span m='527350'>all</span> <span m='527500'>start</span>
  <span m='527800'>with</span> <span m='528010'>a.</span> <span m='528490'>So</span>
  <span m='529390'>at</span> <span m='529600'>the</span> <span m='529720'>root,</span>
  <span m='530380'>there's</span> <span m='530530'>going</span> <span m='530670'>to</span>
  <span m='530770'>be</span> <span m='530920'>four</span> <span m='531190'>branches</span>
  <span m='531940'>corresponding</span> <span m='532600'>to</span> <span m='532900'>$</span>
  <span m='533260'>sign,</span> <span m='534280'>a,</span> <span m='534880'>e,</span>
  <span m='535360'>and</span> <span m='535780'>n.</span> <span m='535940'>I'm</span>
  <span m='536380'>supposing</span> <span m='536860'>my</span> <span m='537010'>alphabet</span>
  <span m='537400'>is</span> <span m='537520'>just</span> <span m='537730'>a,</span>
  <span m='537850'>e,</span> <span m='538360'>n</span> <span m='538450'>because</span>
  <span m='538630'>that's</span> <span m='538840'>all</span> <span m='538960'>that</span>
  <span m='539080'>appears</span> <span m='539410'>here.</span> <span m='541150'>But</span>
  <span m='541360'>everything</span> <span m='541810'>will</span> <span m='541900'>be</span>
  <span m='542110'>on</span> <span m='542230'>the a</span> <span m='542500'>branch.</span>
  <span m='544570'>And</span> <span m='544960'>then</span> <span m='545200'>from</span>
  <span m='545410'>there</span> <span m='546920'>we're</span> <span m='547060'>going</span>
  <span m='547180'>to</span> <span m='547270'>have--</span> <span m='548420'>let's</span>
  <span m='548760'>see--</span> <span m='548980'>they</span> <span m='549160'>all</span>
  <span m='549430'>go</span> <span m='549610'>to</span> <span m='549700'>n</span>
  <span m='549970'>next.</span> <span m='552710'>So</span> <span m='553150'>they</span>
  <span m='553300'>all</span> <span m='553600'>follow</span> <span m='553990'>this</span>
  <span m='554200'>branch.</span> </p><p><span m='556780'>Then</span> <span m='557860'>one</span>
  <span m='558100'>of</span> <span m='558160'>them</span> <span m='558550'>goes</span>
  <span m='558820'>to</span> <span m='558970'>a.</span> <span m='560950'>These</span>
  <span m='561250'>all</span> <span m='561430'>go</span> <span m='561590'>to</span>
  <span m='561700'>n</span> <span m='562450'>afterwards.</span> <span m='563440'>So</span>
  <span m='563710'>we've</span> <span m='563980'>got</span> <span m='564200'>$</span>
  <span m='564580'>sign,</span> <span m='565760'>a</span> <span m='566110'>we</span>
  <span m='566260'>use,</span> <span m='567586'>e,</span> <span m='567950'>n</span>
  <span m='569410'>we</span> <span m='569530'>use.</span> <span m='571240'>And</span>
  <span m='571480'>on</span> <span m='571600'>the</span> <span m='571690'>a</span>
  <span m='571930'>branch,</span> <span m='572680'>we</span> <span m='572890'>are</span>
  <span m='573130'>done.</span> <span m='573880'>This</span> <span m='574060'>corresponds</span>
  <span m='574600'>to</span> <span m='574900'>and</span> <span m='575290'>a,</span>
  <span m='575717'>n,</span> <span m='577000'>e.</span> <span m='578680'>We're</span>
  <span m='578830'>finished.</span> <span m='579310'>And</span> <span m='579610'>we</span>
  <span m='579730'>imagine</span> <span m='580090'>there</span> <span m='580180'>being</span>
  <span m='580330'>$</span> <span m='580720'>sign</span> <span m='580930'>at</span>
  <span m='580990'>the</span> <span m='581110'>end</span> <span m='581260'>of</span>
  <span m='581320'>this</span> <span m='581460'>string.</span> <span m='582670'>So</span>
  <span m='583450'>we</span> <span m='585010'>follow</span> <span m='585460'>the</span>
  <span m='585610'>$</span> <span m='585940'>sign</span> <span m='587290'>child.</span>
  <span m='588940'>The</span> <span m='589060'>others</span> <span m='589390'>are</span>
  <span m='589480'>blank.</span> <span m='590920'>And</span> <span m='591070'>this</span>
  <span m='591760'>leaf</span> <span m='592120'>here</span> <span m='592600'>corresponds</span>
  <span m='593410'>to</span> <span m='593740'>a,</span> <span m='593970'>n,</span>
  <span m='594090'>a.</span> </p><p><span m='595870'>On</span> <span m='595990'>the</span>
  <span m='596050'>other</span> <span m='596230'>hand,</span> <span m='596660'>if</span>
  <span m='596680'>we</span> <span m='596770'>could</span> <span m='596890'>do</span>
  <span m='597160'>a,</span> <span m='597460'>n,</span> <span m='597745'>n,</span>
  <span m='600790'>there's</span> <span m='601000'>three</span> <span m='601240'>options.</span>
  <span m='601630'>We</span> <span m='601720'>could</span> <span m='601900'>be</span>
  <span m='602020'>done.</span> <span m='603000'>Or</span> <span m='603200'>there</span>
  <span m='603280'>could</span> <span m='603460'>be</span> <span m='603580'>an</span>
  <span m='603700'>a</span> <span m='603970'>or</span> <span m='604060'>an</span>
  <span m='604180'>e</span> <span m='604330'>to</span> <span m='604450'>follow.</span>
  <span m='605750'>So</span> <span m='606120'>if</span> <span m='606280'>we're</span>
  <span m='606400'>done,</span> <span m='606730'>that</span> <span m='606910'>would</span>
  <span m='607120'>correspond</span> <span m='607690'>to</span> <span m='607840'>the</span>
  <span m='607990'>$</span> <span m='608320'>sign</span> <span m='609310'>pointer.</span>
  <span m='610660'>That's</span> <span m='610840'>going</span> <span m='610960'>to</span>
  <span m='611080'>be</span> <span m='611230'>a</span> <span m='611290'>leaf</span>
  <span m='612100'>corresponding</span> <span m='612730'>to</span> <span m='612850'>this</span>
  <span m='613060'>string</span> <span m='614530'>here.</span> <span m='616840'>Or</span>
  <span m='618880'>it</span> <span m='618980'>could</span> <span m='619090'>be</span>
  <span m='619360'>an</span> <span m='619640'>a</span> <span m='621391'>and</span>
  <span m='621820'>then</span> <span m='622060'>we're</span> <span m='622210'>done.</span>
  <span m='626380'>And</span> <span m='626430'>then</span> <span m='626610'>we</span>
  <span m='626760'>have</span> <span m='627150'>a</span> <span m='627250'>leaf</span>
  <span m='628260'>corresponding</span> <span m='628920'>to</span> <span m='629500'>Anna,</span>
  <span m='630435'>a,</span> <span m='630840'>n,</span> <span m='631205'>n,</span>
  <span m='631570'>a.</span> <span m='632640'>Or</span> <span m='633710'>could be</span>
  <span m='633940'>we</span> <span m='634290'>have</span> <span m='635235'>an</span>
  <span m='635610'>e</span> <span m='635970'>next</span> <span m='638580'>and</span>
  <span m='638700'>then</span> <span m='638880'>we're</span> <span m='639000'>done.</span>
  </p><p><span m='644210'>OK.</span> <span m='644970'>Not</span> <span m='645120'>very</span>
  <span m='645270'>exciting</span> <span m='645720'>but</span> <span m='645840'>that</span>
  <span m='646050'>is</span> <span m='646200'>the</span> <span m='646320'>tri</span>
  <span m='646770'>representation</span> <span m='647610'>of</span> <span m='647730'>a,</span>
  <span m='648000'>n,</span> <span m='648270'>a;</span> <span m='648540'>a,</span>
  <span m='648840'>n,</span> <span m='649170'>n;</span> <span m='649450'>a,</span>
  <span m='649620'>n,</span> <span m='649890'>n,</span> <span m='650365'>a;</span>
  <span m='650840'>a,</span> <span m='651130'>n,</span> <span m='651506'>n,</span>
  <span m='651882'>e.</span> <span m='652260'>And</span> <span m='652440'>you</span>
  <span m='652560'>can</span> <span m='652710'>see</span> <span m='652920'>there</span>
  <span m='653050'>is</span> <span m='653370'>exactly</span> <span m='653910'>one</span>
  <span m='654240'>leaf</span> <span m='655200'>per</span> <span m='656500'>word</span>
  <span m='656880'>down</span> <span m='657150'>here.</span> <span m='657930'>And</span>
  <span m='658050'>furthermore,</span> <span m='659070'>if</span> <span m='659220'>you</span>
  <span m='659310'>take</span> <span m='659790'>in</span> <span m='660060'>order</span>
  <span m='660270'>traversal</span> <span m='660840'>of</span> <span m='660930'>those</span>
  <span m='661170'>leaves,</span> <span m='662070'>you</span> <span m='662220'>get</span>
  <span m='662820'>these</span> <span m='662960'>strings</span> <span m='663360'>in</span>
  <span m='663540'>order.</span> <span m='664380'>And</span> <span m='664500'>typically,</span>
  <span m='664980'>if</span> <span m='665100'>you're</span> <span m='665220'>going</span>
  <span m='665370'>to</span> <span m='665430'>store</span> <span m='665610'>a</span>
  <span m='665640'>data</span> <span m='665850'>structure</span> <span m='666180'>like</span>
  <span m='666360'>this,</span> <span m='666540'>you</span> <span m='666660'>would</span>
  <span m='666780'>store</span> <span m='667050'>these</span> <span m='667230'>actual</span>
  <span m='667560'>pointers.</span> <span m='668530'>So</span> <span m='668550'>once</span>
  <span m='668670'>you</span> <span m='668760'>get</span> <span m='668910'>to</span>
  <span m='669060'>a</span> <span m='669090'>leaf,</span> <span m='669360'>you</span>
  <span m='669480'>know</span> <span m='669690'>which</span> <span m='669900'>word</span>
  <span m='670170'>matched.</span> <span m='673760'>So</span> <span m='673910'>that's</span>
  <span m='674090'>a</span> <span m='674150'>trie.</span> <span m='675600'>Seems</span>
  <span m='676190'>pretty</span> <span m='677930'>trivial.</span> <span m='679080'>Trievial?</span>
  </p><p><span m='683860'>But</span> <span m='684100'>it</span> <span m='684160'>turns</span>
  <span m='684400'>out</span> <span m='684520'>there's</span> <span m='684640'>something</span>
  <span m='685570'>already</span> <span m='686050'>pretty</span> <span m='686290'>interesting</span>
  <span m='687010'>about</span> <span m='687940'>this</span> <span m='688090'>data</span>
  <span m='688300'>structure.</span> <span m='690580'>How</span> <span m='690730'>do</span>
  <span m='690850'>you</span> <span m='690970'>do</span> <span m='691180'>a</span>
  <span m='691480'>predecessor</span> <span m='692170'>search?</span> <span m='692820'>If</span>
  <span m='692950'>I'm</span> <span m='693070'>searching</span> <span m='693490'>for</span>
  <span m='693700'>something</span> <span m='694180'>like,</span> <span m='696000'>I</span>
  <span m='696090'>don't</span> <span m='696180'>know,</span> <span m='696370'>a,</span>
  <span m='696580'>n,</span> <span m='696850'>e--</span> <span m='697600'>because</span>
  <span m='697810'>I</span> <span m='698170'>made</span> <span m='698380'>a</span>
  <span m='698440'>typo--</span> <span m='699850'>then</span> <span m='700030'>I</span>
  <span m='700120'>follow</span> <span m='700405'>a,</span> <span m='700690'>n,</span>
  <span m='701575'>and</span> <span m='701980'>then</span> <span m='702130'>I</span>
  <span m='702220'>follow</span> <span m='702550'>this</span> <span m='702760'>e</span>
  <span m='702970'>branch</span> <span m='703390'>here</span> <span m='704410'>and</span>
  <span m='704560'>discover--</span> <span m='704980'>whoops--</span> <span m='705490'>there's</span>
  <span m='705670'>nothing</span> <span m='706030'>here.</span> </p><p><span m='706960'>But</span>
  <span m='707170'>right</span> <span m='707380'>at</span> <span m='707470'>that</span>
  <span m='707650'>node</span> <span m='707920'>I</span> <span m='707980'>see,</span>
  <span m='708190'>OK,</span> <span m='708550'>well,</span> <span m='708700'>my</span>
  <span m='708850'>predecessor</span> <span m='709260'>is</span> <span m='709590'>going</span>
  <span m='709780'>to</span> <span m='709840'>be</span> <span m='710020'>the</span>
  <span m='710140'>max</span> <span m='710620'>in</span> <span m='710740'>this</span>
  <span m='711090'>subtree,</span> <span m='711350'>which</span> <span m='711610'>happens</span>
  <span m='711940'>to</span> <span m='712030'>be</span> <span m='712150'>a,</span>
  <span m='712360'>n,</span> <span m='712640'>a.</span> <span m='713500'>My</span>
  <span m='713680'>successor</span> <span m='714250'>is</span> <span m='714340'>going</span>
  <span m='714510'>to</span> <span m='714580'>be</span> <span m='714700'>the</span>
  <span m='714790'>min</span> <span m='715120'>in</span> <span m='715210'>this</span>
  <span m='715390'>subtree,</span> <span m='716020'>which</span> <span m='716230'>happens</span>
  <span m='716530'>to</span> <span m='716620'>be</span> <span m='716770'>a,</span>
  <span m='717070'>n,</span> <span m='717310'>n.</span> <span m='717790'>And</span>
  <span m='717880'>so</span> <span m='718060'>I</span> <span m='718150'>find</span>
  <span m='718420'>what</span> <span m='718540'>I</span> <span m='718630'>want.</span>
  </p><p><span m='719170'>How</span> <span m='719320'>long</span> <span m='719490'>does</span>
  <span m='719590'>it</span> <span m='719650'>take</span> <span m='719890'>me</span>
  <span m='720010'>to</span> <span m='720100'>do</span> <span m='720280'>that?</span>
  <span m='721010'>Well,</span> <span m='721120'>if</span> <span m='721240'>I</span>
  <span m='721330'>store</span> <span m='721840'>subtree</span> <span m='722380'>mins</span>
  <span m='722620'>and</span> <span m='722710'>maxs,</span> <span m='723970'>then</span>
  <span m='724270'>I</span> <span m='724330'>just</span> <span m='724510'>have</span>
  <span m='724660'>to</span> <span m='724780'>walk</span> <span m='725140'>down</span>
  <span m='725410'>the</span> <span m='725500'>tree.</span> <span m='725890'>That</span>
  <span m='726110'>will</span> <span m='726220'>take</span> <span m='726520'>order</span>
  <span m='726850'>P</span> <span m='727150'>time</span> <span m='727570'>to</span>
  <span m='727660'>walk</span> <span m='727930'>down.</span> <span m='729070'>And</span>
  <span m='729280'>then,</span> <span m='729460'>once</span> <span m='729700'>I'm</span>
  <span m='729850'>at</span> <span m='729970'>a</span> <span m='730030'>node,</span>
  <span m='730330'>I've</span> <span m='730450'>got</span> <span m='730570'>to</span>
  <span m='730660'>do</span> <span m='730810'>a</span> <span m='730870'>predecessor</span>
  <span m='731500'>or</span> <span m='731680'>successor</span> <span m='732250'>in</span>
  <span m='732490'>the</span> <span m='732610'>node.</span> </p><p><span m='734860'>So</span>
  <span m='735010'>there</span> <span m='735100'>are</span> <span m='735160'>two</span>
  <span m='735340'>issues.</span> <span m='735740'>One</span> <span m='735820'>is,</span>
  <span m='736390'>given</span> <span m='736660'>a</span> <span m='736720'>node,</span>
  <span m='736960'>how</span> <span m='737170'>do</span> <span m='737230'>you</span>
  <span m='737350'>know</span> <span m='737500'>which</span> <span m='737680'>way</span>
  <span m='737800'>to</span> <span m='737890'>walk</span> <span m='738130'>down?</span>
  <span m='739030'>And</span> <span m='739210'>then,</span> <span m='739660'>when</span>
  <span m='739840'>you're</span> <span m='739960'>done,</span> <span m='740890'>how</span>
  <span m='740980'>do</span> <span m='741040'>you</span> <span m='741130'>do</span>
  <span m='741250'>predecessor</span> <span m='741820'>in</span> <span m='741910'>a</span>
  <span m='741940'>node?</span> <span m='742270'>It's</span> <span m='742600'>the</span>
  <span m='742720'>fundamental</span> <span m='743260'>question.</span> <span m='743630'>Now,</span>
  <span m='743740'>this</span> <span m='743920'>is</span> <span m='743980'>something</span>
  <span m='744310'>we</span> <span m='744380'>spent</span> <span m='744610'>a</span>
  <span m='744640'>lot</span> <span m='744820'>of</span> <span m='744910'>time</span>
  <span m='745150'>doing</span> <span m='745420'>in,</span> <span m='745540'>say,</span>
  <span m='745720'>fusion</span> <span m='746080'>trees.</span> <span m='746950'>That</span>
  <span m='747130'>was</span> <span m='747310'>the</span> <span m='747400'>big</span>
  <span m='747580'>challenge.</span> <span m='748160'>So</span> <span m='748720'>this
  is</span> <span m='748870'>not</span> <span m='749140'>really</span> <span m='749620'>so</span>
  <span m='749830'>trivial--</span> <span m='750310'>how</span> <span m='750550'>do</span>
  <span m='750670'>I</span> <span m='750790'>represent</span> <span m='751270'>a</span>
  <span m='751330'>node?</span> </p><p><span m='752560'>One</span> <span m='752800'>way</span>
  <span m='752920'>to</span> <span m='753040'>make</span> <span m='753220'>it</span>
  <span m='753280'>trivial</span> <span m='753670'>is</span> <span m='753790'>to</span>
  <span m='753850'>assume</span> <span m='754420'>that</span> <span m='754690'>the</span>
  <span m='754870'>alphabet</span> <span m='755350'>is</span> <span m='755470'>constant</span>
  <span m='755920'>size,</span> <span m='756340'>like</span> <span m='756520'>two.</span>
  <span m='757300'>Then,</span> <span m='757510'>of</span> <span m='757600'>course,</span>
  <span m='757960'>there's</span> <span m='758140'>nothing</span> <span m='758440'>to</span>
  <span m='758530'>do.</span> <span m='758770'>It's</span> <span m='758920'>a</span>
  <span m='758980'>binary</span> <span m='759340'>trie.</span> <span m='760370'>You</span>
  <span m='760480'>look</span> <span m='760690'>at</span> <span m='760750'>0,</span>
  <span m='761050'>you</span> <span m='761300'>look at</span> <span m='761520'>1.</span>
  <span m='761890'>You</span> <span m='761980'>can</span> <span m='762070'>figure</span>
  <span m='762370'>out</span> <span m='762430'>anything</span> <span m='762790'>you</span>
  <span m='762880'>need</span> <span m='763030'>to</span> <span m='763150'>do</span>
  <span m='764560'>if</span> <span m='764710'>the</span> <span m='764830'>alphabet</span>
  <span m='765160'>is</span> <span m='765250'>constant.</span> <span m='765790'>But</span>
  <span m='766000'>things</span> <span m='766270'>get</span> <span m='766450'>interesting</span>
  <span m='766900'>if</span> <span m='767020'>you</span> <span m='767110'>imagine,</span>
  <span m='767530'>well,</span> <span m='767740'>the</span> <span m='767830'>alphabet
  is</span> <span m='768290'>some</span> <span m='768640'>parameter,</span> <span
  m='769150'>we</span> <span m='769240'>don't</span> <span m='769390'>know</span>
  <span m='769540'>how</span> <span m='769690'>big</span> <span m='769900'>it</span>
  <span m='769990'>is.</span> <span m='770600'>It</span> <span m='770770'>might</span>
  <span m='770920'>be</span> <span m='771040'>substantial.</span> </p><p><span m='771950'>So</span>
  <span m='772060'>let's</span> <span m='772270'>think</span> <span m='772450'>about</span>
  <span m='773350'>how</span> <span m='773560'>you</span> <span m='773740'>might</span>
  <span m='773950'>represent</span> <span m='775460'>a</span> <span m='775650'>trie</span>
  <span m='777280'>or</span> <span m='777460'>the</span> <span m='777580'>node</span>
  <span m='777850'>of</span> <span m='777970'>a</span> <span m='778030'>trie.</span>
  <span m='783790'>Let's</span> <span m='783940'>call</span> <span m='784150'>this</span>
  <span m='784360'>trie</span> <span m='784810'>node</span> <span m='787390'>representation.</span>
  <span m='791620'>Any</span> <span m='791770'>suggestions?</span> <span m='793040'>What</span>
  <span m='793180'>are</span> <span m='793270'>the</span> <span m='793420'>obvious</span>
  <span m='793750'>ways</span> <span m='793960'>to</span> <span m='794020'>represent</span>
  <span m='794440'>the</span> <span m='794530'>node</span> <span m='794710'>of</span>
  <span m='794800'>a</span> <span m='794860'>trie?</span> <span m='795550'>Nothing</span>
  <span m='795820'>fancy.</span> <span m='798220'>I</span> <span m='798280'>have</span>
  <span m='798430'>three</span> <span m='798700'>obvious</span> <span m='799000'>answers,</span>
  <span m='799360'>at</span> <span m='799450'>least.</span> </p><p><span m='799780'>AUDIENCE:</span>
  <span m='800007'>Array.</span> </p><p><span m='800690'>ERIK DEMAINE:</span> <span
  m='800862'>Array.</span> <span m='801380'>Good.</span> <span m='801570'>That</span>
  <span m='801730'>was</span> <span m='801850'>my</span> <span m='801970'>number</span>
  <span m='802210'>one.</span> <span m='805090'>Any</span> <span m='805530'>more?</span>
  <span m='806740'>That's</span> <span m='806950'>I</span> <span m='807010'>think</span>
  <span m='807190'>the</span> <span m='807280'>most</span> <span m='807520'>obvious.</span>
  </p><p><span m='808555'>AUDIENCE:</span> <span m='808772'>Tree.</span> </p><p><span
  m='808990'>ERIK DEMAINE:</span> <span m='809130'>Tree.</span> <span m='809915'>Good.</span>
  <span m='810280'>Do a</span> <span m='810730'>binary</span> <span m='811010'>search</span>
  <span m='811300'>tree.</span> <span m='812350'>Or?</span> </p><p><span m='812980'>AUDIENCE:</span>
  <span m='813100'>Hash</span> <span m='813220'>table.</span> </p><p><span m='813800'>ERIK
  DEMAINE:</span> <span m='813915'>Hash</span> <span m='814030'>table.</span> <span
  m='814360'>Good.</span> <span m='819550'>So</span> <span m='819910'>for</span> <span
  m='820060'>each</span> <span m='820270'>of</span> <span m='820330'>them</span> <span
  m='820600'>we</span> <span m='820750'>have</span> <span m='821630'>query</span>
  <span m='821950'>time</span> <span m='824470'>and</span> <span m='824620'>space.</span>
  <span m='828590'>If</span> <span m='828720'>I</span> <span m='828820'>use</span>
  <span m='829000'>an</span> <span m='829120'>array,</span> <span m='829690'>meaning</span>
  <span m='830410'>I</span> <span m='830560'>have--</span> <span m='831420'>let's</span>
  <span m='831610'>say,</span> <span m='831940'>for</span> <span m='832180'>a</span>
  <span m='832420'>through</span> <span m='832690'>z--</span> <span m='833320'>I</span>
  <span m='833440'>have</span> <span m='833710'>a</span> <span m='833740'>pointer</span>
  <span m='835300'>that</span> <span m='835960'>either</span> <span m='836270'>is</span>
  <span m='836380'>null</span> <span m='837100'>or</span> <span m='837340'>points</span>
  <span m='837730'>to</span> <span m='838060'>the</span> <span m='838150'>child.</span>
  </p><p><span m='839710'>This</span> <span m='839980'>is</span> <span m='840070'>going</span>
  <span m='840230'>to</span> <span m='840310'>be</span> <span m='840430'>really</span>
  <span m='840670'>fast</span> <span m='841420'>because</span> <span m='841680'>they're</span>
  <span m='841800'>at a</span> <span m='841870'>node.</span> <span m='842170'>If</span>
  <span m='842290'>I</span> <span m='842380'>want</span> <span m='842560'>to</span>
  <span m='842620'>know,</span> <span m='843640'>I</span> <span m='843700'>just</span>
  <span m='843850'>look</span> <span m='844060'>at</span> <span m='844150'>that</span>
  <span m='844540'>i-th</span> <span m='845040'>letter</span> <span m='845350'>in</span>
  <span m='845470'>my</span> <span m='845680'>pattern</span> <span m='846190'>P.</span>
  <span m='846610'>I say,</span> <span m='847015'>oh,</span> <span m='847420'>it's</span>
  <span m='847630'>a</span> <span m='847750'>j.</span> <span m='848560'>So</span>
  <span m='848770'>I</span> <span m='849160'>look</span> <span m='849370'>at</span>
  <span m='849460'>the j</span> <span m='849550'>position</span> <span m='849925'>and</span>
  <span m='850300'>I</span> <span m='850390'>follow</span> <span m='850780'>it.</span>
  </p><p><span m='851590'>You</span> <span m='851740'>might</span> <span m='851920'>wonder,</span>
  <span m='852160'>how</span> <span m='852340'>do</span> <span m='852370'>I</span>
  <span m='852400'>do</span> <span m='852610'>predecessor</span> <span m='852940'>and</span>
  <span m='853240'>successor?</span> <span m='853910'>Well,</span> <span m='853930'>this</span>
  <span m='854080'>is</span> <span m='854170'>a</span> <span m='854230'>static</span>
  <span m='854650'>data</span> <span m='854890'>structure.</span> <span m='855310'>So</span>
  <span m='855460'>for</span> <span m='855610'>every</span> <span m='855910'>cell,</span>
  <span m='856680'>if</span> <span m='856810'>it's</span> <span m='856980'>null,</span>
  <span m='857410'>I</span> <span m='857470'>can</span> <span m='857620'>store</span>
  <span m='857950'>the</span> <span m='858070'>predecessor</span> <span m='858580'>and</span>
  <span m='858670'>successor</span> <span m='859130'>in the</span> <span m='859240'>node.</span>
  </p><p><span m='861460'>With</span> <span m='861700'>no</span> <span m='861850'>more</span>
  <span m='862030'>space.</span> <span m='863910'>This</span> <span m='864140'>is</span>
  <span m='864280'>Sigma</span> <span m='864700'>space</span> <span m='866500'>per</span>
  <span m='866770'>node.</span> <span m='868270'>So</span> <span m='868450'>the</span>
  <span m='868570'>amount</span> <span m='868840'>of</span> <span m='868900'>space</span>
  <span m='869470'>is</span> <span m='870410'>T</span> <span m='870850'>Sigma,</span>
  <span m='872510'>which</span> <span m='873460'>is</span> <span m='873550'>not</span>
  <span m='873760'>so</span> <span m='873940'>great.</span> <span m='874570'>But</span>
  <span m='874750'>the</span> <span m='874840'>query</span> <span m='875170'>is</span>
  <span m='875290'>fast,</span> <span m='875680'>query</span> <span m='875980'>is</span>
  <span m='876190'>order</span> <span m='876520'>P</span> <span m='876890'>time.</span>
  </p><p><span m='880230'>BST.</span> <span m='880850'>The</span> <span m='880970'>idea</span>
  <span m='881200'>of</span> <span m='881260'>the</span> <span m='881360'>BST</span>
  <span m='881870'>is</span> <span m='882110'>instead</span> <span m='882530'>of</span>
  <span m='882650'>having</span> <span m='883110'>a</span> <span m='883170'>node</span>
  <span m='883490'>that</span> <span m='883640'>has</span> <span m='883970'>some</span>
  <span m='884270'>pointers,</span> <span m='884780'>some</span> <span m='884990'>of</span>
  <span m='885050'>which</span> <span m='885910'>may</span> <span m='886070'>be</span>
  <span m='886280'>absent,</span> <span m='887270'>let's</span> <span m='887480'>expand</span>
  <span m='887920'>it</span> <span m='888020'>out</span> <span m='889220'>into</span>
  <span m='893210'>something</span> <span m='893540'>like</span> <span m='893720'>this.</span>
  <span m='894050'>Actually,</span> <span m='894290'>I'll</span> <span m='894520'>use</span>
  <span m='894770'>colors.</span> <span m='895610'>This</span> <span m='896110'>will</span>
  <span m='896250'>make</span> <span m='897290'>life</span> <span m='897530'>a</span>
  <span m='897560'>little</span> <span m='897800'>bit</span> <span m='897950'>cleaner</span>
  <span m='898310'>in</span> <span m='898400'>a</span> <span m='898460'>moment.</span>
  <span m='898820'>Because</span> <span m='899000'>we</span> <span m='899140'>are</span>
  <span m='899210'>going</span> <span m='899330'>to</span> <span m='899390'>modify</span>
  <span m='899900'>this</span> <span m='900410'>approach.</span> </p><p><span m='901830'>So</span>
  <span m='901880'>let's</span> <span m='902090'>say</span> <span m='902330'>that</span>
  <span m='902600'>the</span> <span m='904400'>pointers</span> <span m='904730'>you</span>
  <span m='904820'>care</span> <span m='905090'>about</span> <span m='905330'>are</span>
  <span m='905450'>red.</span> <span m='906470'>Those</span> <span m='906710'>are</span>
  <span m='906770'>the</span> <span m='907010'>actual</span> <span m='907370'>letter</span>
  <span m='907610'>pointers</span> <span m='907920'>you</span> <span m='908000'>want</span>
  <span m='908180'>to</span> <span m='908270'>do.</span> <span m='908670'>So the</span>
  <span m='908690'>idea</span> <span m='908810'>is to</span> <span m='908960'>expand</span>
  <span m='909440'>out</span> <span m='909620'>this</span> <span m='910460'>high</span>
  <span m='910670'>degree</span> <span m='910970'>node</span> <span m='911360'>into</span>
  <span m='911690'>binary</span> <span m='912050'>nodes.</span> <span m='912950'>You</span>
  <span m='913070'>put</span> <span m='913460'>appropriate</span> <span m='913910'>keys</span>
  <span m='914210'>in</span> <span m='914300'>here</span> <span m='914450'>so</span>
  <span m='914570'>you</span> <span m='914660'>can</span> <span m='914810'>do</span>
  <span m='914900'>a</span> <span m='914930'>binary</span> <span m='915290'>search.</span>
  <span m='916150'>And</span> <span m='916250'>then,</span> <span m='916370'>eventually,</span>
  <span m='916760'>you</span> <span m='916850'>get</span> <span m='917030'>down</span>
  <span m='917300'>to</span> <span m='917480'>where</span> <span m='917630'>you</span>
  <span m='917720'>need</span> <span m='917870'>to</span> <span m='917990'>go.</span>
  </p><p><span m='920120'>This</span> <span m='920360'>structure</span> <span m='920780'>has</span>
  <span m='921200'>high</span> <span m='921620'>log</span> <span m='922220'>Sigma.</span>
  <span m='923960'>So</span> <span m='924140'>the</span> <span m='924260'>query</span>
  <span m='924590'>time</span> <span m='925010'>is</span> <span m='925100'>going</span>
  <span m='925250'>to</span> <span m='925340'>be</span> <span m='926010'>P</span>
  <span m='927170'>log</span> <span m='927500'>Sigma.</span> <span m='928110'>So</span>
  <span m='928190'>that</span> <span m='928430'>goes</span> <span m='928760'>up</span>
  <span m='928970'>a</span> <span m='929030'>little</span> <span m='929270'>bit,</span>
  <span m='930080'>not</span> <span m='930290'>perfect.</span> <span m='931310'>But</span>
  <span m='931520'>the</span> <span m='931610'>space</span> <span m='932090'>now</span>
  <span m='932300'>becomes</span> <span m='932690'>linear,</span> <span m='933300'>so</span>
  <span m='933410'>that's</span> <span m='934370'>an</span> <span m='934460'>improvement.</span>
  </p><p><span m='935210'>Ideally,</span> <span m='935540'>we'd</span> <span m='935690'>like</span>
  <span m='935840'>the</span> <span m='935960'>best</span> <span m='936230'>of</span>
  <span m='936290'>both</span> <span m='936560'>of</span> <span m='936650'>these--</span>
  <span m='938630'>optimal</span> <span m='939050'>query</span> <span m='939320'>time,</span>
  <span m='940220'>optimal</span> <span m='940700'>space,</span> <span m='941130'>linear</span>
  <span m='941450'>space.</span> <span m='942740'>And</span> <span m='942890'>hash</span>
  <span m='943130'>tables</span> <span m='943470'>achieve</span> <span m='943730'>that.</span>
  <span m='945050'>They</span> <span m='945200'>give</span> <span m='945410'>you</span>
  <span m='945620'>order</span> <span m='945910'>P</span> <span m='947960'>query</span>
  <span m='948950'>and</span> <span m='949130'>order</span> <span m='949460'>T</span>
  <span m='950330'>space.</span> </p><p><span m='951530'>Again,</span> <span m='951830'>the</span>
  <span m='951920'>issue</span> <span m='952190'>is</span> <span m='952370'>some</span>
  <span m='952640'>of</span> <span m='952730'>these</span> <span m='952910'>cells</span>
  <span m='953210'>are</span> <span m='953300'>absent</span> <span m='953720'>so</span>
  <span m='953840'>don't</span> <span m='954050'>use</span> <span m='954290'>an</span>
  <span m='954380'>array.</span> <span m='954740'>That's</span> <span m='954950'>like</span>
  <span m='955130'>a</span> <span m='955190'>direct</span> <span m='955550'>mapped</span>
  <span m='955870'>hash</span> <span m='956150'>table.</span> <span m='956840'>Use</span>
  <span m='957080'>a</span> <span m='957140'>hash</span> <span m='957380'>table,</span>
  <span m='957670'>use</span> <span m='957830'>hashing.</span> <span m='958700'>That</span>
  <span m='958850'>way</span> <span m='958970'>you</span> <span m='959150'>can</span>
  <span m='959270'>use</span> <span m='959450'>linear</span> <span m='959780'>space</span>
  <span m='960170'>per</span> <span m='960410'>node,</span> <span m='961260'>however</span>
  <span m='961430'>many</span> <span m='961880'>occupied</span> <span m='962450'>children</span>
  <span m='963350'>there</span> <span m='963530'>are.</span> </p><p><span m='964380'>What</span>
  <span m='964670'>is</span> <span m='964850'>T</span> <span m='965210'>here,</span>
  <span m='965530'>by</span> <span m='965600'>the</span> <span m='965690'>way?</span>
  <span m='966020'>T</span> <span m='966200'>is</span> <span m='967420'>the</span>
  <span m='967520'>sum</span> <span m='968180'>of</span> <span m='968330'>the</span>
  <span m='968420'>lengths</span> <span m='968780'>of</span> <span m='968900'>the</span>
  <span m='968990'>T</span> <span m='969460'>i's--</span> <span m='971120'>because</span>
  <span m='971300'>here</span> <span m='971410'>we're</span> <span m='971510'>storing</span>
  <span m='971870'>multiple</span> <span m='972290'>T</span> <span m='972590'>i's.</span>
  <span m='973220'>Or</span> <span m='973690'>it's</span> <span m='973900'>the</span>
  <span m='974150'>number</span> <span m='974480'>of</span> <span m='974570'>nodes</span>
  <span m='974870'>in</span> <span m='974960'>the</span> <span m='975050'>tree,</span>
  <span m='978530'>which,</span> <span m='979700'>if</span> <span m='979850'>your</span>
  <span m='979970'>strings</span> <span m='980270'>happen</span> <span m='980570'>to</span>
  <span m='980630'>have</span> <span m='980780'>a</span> <span m='980840'>lot</span>
  <span m='981020'>of</span> <span m='981140'>common</span> <span m='981470'>prefixes,</span>
  <span m='982160'>the</span> <span m='982280'>number</span> <span m='982490'>of</span>
  <span m='982550'>nodes</span> <span m='982760'>in</span> <span m='982820'>the</span>
  <span m='982910'>trie</span> <span m='983180'>could</span> <span m='983390'>be</span>
  <span m='983510'>smaller</span> <span m='983990'>than</span> <span m='984170'>that,</span>
  <span m='984450'>but</span> <span m='986090'>not</span> <span m='986270'>in</span>
  <span m='986330'>general.</span> </p><p><span m='988980'>What's</span> <span m='989180'>the</span>
  <span m='989300'>problem</span> <span m='989780'>with</span> <span m='990080'>the</span>
  <span m='990170'>hash</span> <span m='990440'>table?</span> <span m='991010'>Question.</span>
  </p><p><span m='991340'>AUDIENCE:</span> <span m='991581'>[INAUDIBLE]</span> </p><p><span
  m='998570'>ERIK DEMAINE:</span> <span m='998697'>Yes.</span> <span m='999080'>For</span>
  <span m='999260'>the</span> <span m='999380'>BST,</span> <span m='999890'>we</span>
  <span m='999980'>need</span> <span m='1000130'>to</span> <span m='1000220'>store</span>
  <span m='1000430'>some</span> <span m='1000760'>keys</span> <span m='1001030'>in</span>
  <span m='1001120'>this</span> <span m='1001240'>node.</span> <span m='1001570'>That</span>
  <span m='1001810'>lets</span> <span m='1002050'>you</span> <span m='1002170'>do</span>
  <span m='1002390'>a</span> <span m='1002410'>binary</span> <span m='1002770'>search.</span>
  <span m='1003100'>For</span> <span m='1003190'>example,</span> <span m='1003670'>every</span>
  <span m='1003880'>node</span> <span m='1004060'>could</span> <span m='1004210'>store</span>
  <span m='1004450'>the</span> <span m='1004540'>max</span> <span m='1004900'>in</span>
  <span m='1004990'>the</span> <span m='1005080'>left</span> <span m='1005260'>subtree--</span>
  <span m='1006220'>just</span> <span m='1006430'>within</span> <span m='1006790'>this</span>
  <span m='1007360'>little</span> <span m='1007660'>tree,</span> <span m='1007880'>though.</span>
  </p><p><span m='1008353'>AUDIENCE:</span> <span m='1008589'>[INAUDIBLE]</span> </p><p><span
  m='1013090'>ERIK DEMAINE:</span> <span m='1013165'>It</span> <span m='1013240'>is</span>
  <span m='1013450'>order</span> <span m='1013690'>T.</span> <span m='1014750'>Sorry,</span>
  <span m='1014980'>I</span> <span m='1015070'>see--</span> <span m='1015280'>why</span>
  <span m='1015430'>is</span> <span m='1015550'>it</span> <span m='1015610'>not</span>
  <span m='1015840'>O</span> <span m='1016040'>T</span> <span m='1016300'>Sigma</span>
  <span m='1016630'>space?</span> <span m='1017040'>You're</span> <span m='1017200'>only</span>
  <span m='1017440'>storing</span> <span m='1017740'>one</span> <span m='1018010'>letter</span>
  <span m='1018310'>here,</span> <span m='1018580'>so</span> <span m='1018760'>that</span>
  <span m='1019330'>fits</span> <span m='1019570'>in</span> <span m='1019660'>a</span>
  <span m='1019720'>single</span> <span m='1020020'>word,</span> <span m='1020920'>and</span>
  <span m='1021130'>two</span> <span m='1021340'>pointers.</span> <span m='1022130'>So</span>
  <span m='1022270'>every</span> <span m='1022570'>node</span> <span m='1022840'>only</span>
  <span m='1023020'>takes</span> <span m='1023230'>constant</span> <span m='1023590'>space.</span>
  <span m='1024099'>It's</span> <span m='1024220'>only</span> <span m='1024460'>T</span>
  <span m='1025880'>space,</span> <span m='1026140'>not</span> <span m='1026410'>T</span>
  <span m='1026560'>Sigma.</span> <span m='1028730'>Other</span> <span m='1028869'>questions?</span>
  <span m='1030940'>Or</span> <span m='1031060'>answers?</span> </p><p><span m='1031450'>There's</span>
  <span m='1031599'>a</span> <span m='1031660'>problem</span> <span m='1031990'>with</span>
  <span m='1032170'>hashing--</span> <span m='1033790'>doesn't</span> <span m='1034060'>actually</span>
  <span m='1034630'>solve</span> <span m='1034900'>the</span> <span m='1035020'>problem</span>
  <span m='1035619'>we</span> <span m='1035770'>want</span> <span m='1036010'>to</span>
  <span m='1036130'>solve.</span> <span m='1038260'>It</span> <span m='1038420'>doesn't</span>
  <span m='1038720'>solve</span> <span m='1039079'>predecessor.</span> <span m='1040520'>Because</span>
  <span m='1041000'>hashing</span> <span m='1041540'>mixes</span> <span m='1042020'>up</span>
  <span m='1042200'>the</span> <span m='1042290'>order</span> <span m='1042530'>of</span>
  <span m='1042619'>the</span> <span m='1042710'>nodes.</span> <span m='1042940'>This</span>
  <span m='1043069'>is</span> <span m='1043160'>the</span> <span m='1043250'>problem</span>
  <span m='1043579'>we</span> <span m='1043700'>had</span> <span m='1043970'>with--</span>
  <span m='1045010'>what's</span> <span m='1045380'>it called--</span> <span m='1047300'>signature</span>
  <span m='1047839'>sort,</span> <span m='1048890'>which</span> <span m='1049070'>hashed,</span>
  <span m='1049460'>it</span> <span m='1050060'>messed</span> <span m='1050480'>up,
  it</span> <span m='1050750'>permuted</span> <span m='1051290'>all</span> <span m='1051410'>the</span>
  <span m='1051530'>things</span> <span m='1051800'>in</span> <span m='1051870'>the</span>
  <span m='1051950'>nodes</span> <span m='1052790'>and</span> <span m='1052940'>so</span>
  <span m='1053060'>you</span> <span m='1053180'>didn't</span> <span m='1053420'>know--</span>
  <span m='1054950'>I</span> <span m='1054980'>mean,</span> <span m='1055220'>in</span>
  <span m='1055470'>a</span> <span m='1055570'>hash</span> <span m='1055790'>table,</span>
  <span m='1056030'>you</span> <span m='1056210'>can't</span> <span m='1056480'>solve</span>
  <span m='1056810'>predecessor.</span> <span m='1057410'>That's</span> <span m='1057800'>what</span>
  <span m='1057920'>the</span> <span m='1058040'>predecessor</span> <span m='1058630'>problem</span>
  <span m='1059030'>is</span> <span m='1059180'>for.</span> </p><p><span m='1060470'>I</span>
  <span m='1060530'>guess</span> <span m='1060740'>you</span> <span m='1060830'>could</span>
  <span m='1060950'>try</span> <span m='1061130'>to</span> <span m='1061220'>throw</span>
  <span m='1061430'>a</span> <span m='1061490'>predecessor</span> <span m='1062090'>data</span>
  <span m='1062330'>structure</span> <span m='1062690'>in</span> <span m='1062810'>here.</span>
  <span m='1063500'>Actually,</span> <span m='1064050'>I</span> <span m='1064850'>hadn't</span>
  <span m='1065900'>thought</span> <span m='1066110'>of</span> <span m='1066230'>that</span>
  <span m='1066410'>before.</span> <span m='1066960'>So</span> <span m='1067040'>we</span>
  <span m='1067160'>could</span> <span m='1067560'>use</span> <span m='1067790'>y-fast</span>
  <span m='1068300'>tries</span> <span m='1068570'>or</span> <span m='1068660'>something.</span>
  <span m='1069680'>And</span> <span m='1069830'>we</span> <span m='1069980'>would</span>
  <span m='1070100'>get</span> <span m='1071420'>order</span> <span m='1071780'>T</span>
  <span m='1073040'>space</span> <span m='1074570'>and--</span> <span m='1075650'>I</span>
  <span m='1075950'>guess,</span> <span m='1076160'>with</span> <span m='1076310'>high</span>
  <span m='1076490'>probability,</span> <span m='1078350'>this</span> <span m='1078510'>is</span>
  <span m='1078590'>also</span> <span m='1078860'>with</span> <span m='1078980'>high</span>
  <span m='1079130'>probability--</span> <span m='1080990'>we</span> <span m='1081170'>get</span>
  <span m='1081410'>order</span> <span m='1081710'>P</span> <span m='1083120'>log</span>
  <span m='1083450'>log</span> <span m='1083670'>Sigma,</span> <span m='1084380'>I</span>
  <span m='1084440'>guess.</span> <span m='1086180'>Because</span> <span m='1086830'>I</span>
  <span m='1086910'>use</span> <span m='1087140'>Van Emde</span> <span m='1087440'>Boas.</span>
  <span m='1089270'>I'm</span> <span m='1089660'>going</span> <span m='1089810'>to</span>
  <span m='1089870'>have</span> <span m='1090050'>to</span> <span m='1090110'>call</span>
  <span m='1090320'>it</span> <span m='1090460'>3.5,</span> <span m='1092515'>Van</span>
  <span m='1092930'>Emde</span> <span m='1093120'>Boas.</span> <span m='1095840'>So</span>
  <span m='1096110'>that</span> <span m='1096320'>would</span> <span m='1096470'>be</span>
  <span m='1096590'>another</span> <span m='1096890'>approach.</span> <span m='1097280'>So</span>
  <span m='1097730'>hashing</span> <span m='1098750'>will</span> <span m='1099170'>not</span>
  <span m='1099680'>do</span> <span m='1100490'>a</span> <span m='1100650'>predecessor.</span>
  </p><p><span m='1102800'>We'll</span> <span m='1102950'>do</span> <span m='1103070'>exact</span>
  <span m='1103460'>search,</span> <span m='1103920'>which</span> <span m='1103970'>is</span>
  <span m='1104030'>still</span> <span m='1104210'>an</span> <span m='1104300'>interesting</span>
  <span m='1104660'>problem.</span> <span m='1104950'>Might</span> <span m='1105050'>give</span>
  <span m='1105200'>you</span> <span m='1105290'>some</span> <span m='1105470'>strings</span>
  <span m='1105870'>I</span> <span m='1105980'>want</span> <span m='1106140'>to</span>
  <span m='1106220'>know--</span> <span m='1106490'>is</span> <span m='1106670'>this</span>
  <span m='1106820'>string</span> <span m='1107180'>in</span> <span m='1107330'>your</span>
  <span m='1107480'>set?</span> <span m='1109640'>But</span> <span m='1109820'>it</span>
  <span m='1109880'>won't</span> <span m='1110900'>solve</span> <span m='1111170'>the</span>
  <span m='1111260'>predecessor</span> <span m='1111800'>problem.</span> <span m='1112790'>So</span>
  <span m='1112910'>this</span> <span m='1113120'>is</span> <span m='1113300'>an</span>
  <span m='1113420'>interesting</span> <span m='1113780'>solution--</span> <span m='1114200'>hashing--</span>
  <span m='1114650'>but</span> <span m='1115190'>not</span> <span m='1115340'>quite</span>
  <span m='1115580'>what</span> <span m='1115780'>we</span> <span m='1115860'>want.</span>
  </p><p><span m='1116070'>And</span> <span m='1116290'>Van</span> <span m='1116370'>Emde</span>
  <span m='1116440'>Boas</span> <span m='1116690'>doesn't</span> <span m='1116930'>quite</span>
  <span m='1117140'>do</span> <span m='1117230'>what</span> <span m='1117320'>we</span>
  <span m='1117440'>want</span> <span m='1117620'>either.</span> <span m='1117950'>It</span>
  <span m='1118040'>improves</span> <span m='1118640'>over</span> <span m='1119450'>the</span>
  <span m='1119540'>BST</span> <span m='1120020'>approach</span> <span m='1120620'>but</span>
  <span m='1121610'>we</span> <span m='1121760'>get</span> <span m='1121910'>another</span>
  <span m='1122210'>log</span> <span m='1122510'>in</span> <span m='1122600'>there.</span>
  <span m='1122900'>But</span> <span m='1123020'>it's</span> <span m='1123100'>still</span>
  <span m='1123320'>not</span> <span m='1123500'>order</span> <span m='1123690'>P.</span>
  <span m='1124000'>I</span> <span m='1124310'>kind</span> <span m='1124520'>of</span>
  <span m='1124760'>like</span> <span m='1125030'>order</span> <span m='1125300'>P.</span>
  <span m='1126080'>Or</span> <span m='1126230'>at</span> <span m='1126290'>least,</span>
  <span m='1126830'>instead</span> <span m='1127130'>of</span> <span m='1127190'>order</span>
  <span m='1127430'>P</span> <span m='1127700'>times</span> <span m='1128270'>log</span>
  <span m='1128570'>log</span> <span m='1128780'>Sigma,</span> <span m='1129360'>I</span>
  <span m='1129580'>kind</span> <span m='1129770'>of</span> <span m='1129830'>like</span>
  <span m='1130010'>order</span> <span m='1130250'>P</span> <span m='1132380'>plus</span>
  <span m='1132830'>log</span> <span m='1133140'>Sigma.</span> </p><p><span m='1134030'>And</span>
  <span m='1134240'>order</span> <span m='1134510'>P</span> <span m='1134750'>plus</span>
  <span m='1135230'>log</span> <span m='1135470'>Sigma</span> <span m='1135770'>is</span>
  <span m='1136010'>known.</span> <span m='1136470'>So</span> <span m='1136730'>that's</span>
  <span m='1137630'>what</span> <span m='1137780'>I</span> <span m='1137870'>want</span>
  <span m='1138020'>to</span> <span m='1138080'>tell</span> <span m='1138290'>you</span>
  <span m='1138380'>about.</span> <span m='1141010'>And</span> <span m='1141670'>this</span>
  <span m='1141910'>is</span> <span m='1142090'>normally</span> <span m='1142600'>done</span>
  <span m='1142840'>with</span> <span m='1143020'>a</span> <span m='1143260'>structure</span>
  <span m='1143710'>called</span> <span m='1144940'>trays,</span> <span m='1146650'>which</span>
  <span m='1146890'>is</span> <span m='1147100'>a</span> <span m='1148630'>portamento,</span>
  <span m='1149260'>I</span> <span m='1149320'>guess,</span> <span m='1149740'>of</span>
  <span m='1150250'>tree</span> <span m='1151120'>and</span> <span m='1151300'>array.</span>
  <span m='1152410'>Somewhere</span> <span m='1152770'>in</span> <span m='1152860'>there</span>
  <span m='1153130'>there's</span> <span m='1153370'>a</span> <span m='1153430'>tree</span>
  <span m='1154010'>and</span> <span m='1154100'>an</span> <span m='1154260'>array,</span>
  <span m='1155140'>so</span> <span m='1155490'>it's</span> <span m='1156010'>a</span>
  <span m='1156070'>bit</span> <span m='1156220'>of</span> <span m='1156340'>an</span>
  <span m='1156850'>awkward</span> <span m='1157180'>word.</span> <span m='1158630'>But</span>
  <span m='1159760'>Those</span> <span m='1160060'>are</span> <span m='1160150'>developed</span>
  <span m='1160480'>by</span> <span m='1161230'>Koplowitz</span> <span m='1162220'>and</span>
  <span m='1162610'>Lewenstein,</span> <span m='1163690'>in</span> <span m='1163780'>2006,</span>
  <span m='1164620'>a</span> <span m='1164710'>fairly</span> <span m='1165010'>recent</span>
  <span m='1165880'>innovation.</span> </p><p><span m='1168460'>I'll</span> <span
  m='1168730'>have</span> <span m='1169020'>this</span> <span m='1169300'>number</span>
  <span m='1169640'>6--</span> <span m='1171240'>trays,</span> <span m='1173200'>achieve</span>
  <span m='1175270'>order</span> <span m='1175530'>P</span> <span m='1176290'>plus</span>
  <span m='1177220'>log</span> <span m='1177850'>Sigma</span> <span m='1180020'>and</span>
  <span m='1180130'>order</span> <span m='1180390'>T</span> <span m='1180640'>space.</span>
  <span m='1181900'>So</span> <span m='1181970'>this</span> <span m='1182170'>is</span>
  <span m='1182260'>pretty</span> <span m='1182530'>good.</span> <span m='1182870'>And
  they</span> <span m='1182920'>will</span> <span m='1183160'>do</span> <span m='1183760'>predecessor</span>
  <span m='1184270'>and</span> <span m='1184360'>successor--</span> <span m='1185290'>definitely</span>
  <span m='1185680'>an</span> <span m='1185770'>improvement</span> <span m='1186160'>over</span>
  <span m='1186340'>the</span> <span m='1186580'>BST.</span> </p><p><span m='1190690'>It's</span>
  <span m='1191140'>open</span> <span m='1191950'>whether</span> <span m='1192220'>you</span>
  <span m='1192400'>could</span> <span m='1192580'>do</span> <span m='1193420'>order</span>
  <span m='1193750'>P</span> <span m='1194140'>plus</span> <span m='1194560'>log</span>
  <span m='1194890'>log</span> <span m='1195050'>Sigma.</span> <span m='1195460'>This
  is as</span> <span m='1195640'>far</span> <span m='1195820'>as</span> <span m='1195970'>I</span>
  <span m='1196120'>can</span> <span m='1196300'>tell,</span> <span m='1197170'>no</span>
  <span m='1197320'>one</span> <span m='1197500'>has</span> <span m='1197680'>worked</span>
  <span m='1197920'>on</span> <span m='1198070'>this.</span> <span m='1198530'>Maybe</span>
  <span m='1198850'>we</span> <span m='1199000'>will</span> <span m='1199780'>work</span>
  <span m='1200020'>on</span> <span m='1200170'>it</span> <span m='1201280'>today.</span>
  <span m='1203920'>So</span> <span m='1204070'>something</span> <span m='1204430'>to</span>
  <span m='1204520'>think</span> <span m='1204730'>about--</span> <span m='1205360'>whether</span>
  <span m='1205510'>you</span> <span m='1205600'>could</span> <span m='1205720'>get</span>
  <span m='1205870'>the</span> <span m='1205960'>best</span> <span m='1206260'>of</span>
  <span m='1206350'>all</span> <span m='1206530'>of</span> <span m='1206620'>these</span>
  <span m='1206800'>worlds</span> <span m='1208030'>for</span> <span m='1208150'>predecessor.</span>
  </p><p><span m='1209380'>There's</span> <span m='1209560'>a</span> <span m='1209620'>lower</span>
  <span m='1209920'>bound--</span> <span m='1210170'>you</span> <span m='1210280'>need</span>
  <span m='1210520'>to</span> <span m='1210640'>spend</span> <span m='1210910'>at</span>
  <span m='1210970'>least</span> <span m='1211150'>log</span> <span m='1211390'>log</span>
  <span m='1211590'>Sigma</span> <span m='1211840'>time.</span> <span m='1212170'>Because</span>
  <span m='1212320'>even</span> <span m='1212560'>if</span> <span m='1212680'>you</span>
  <span m='1212770'>try</span> <span m='1213020'>as</span> <span m='1213130'>a</span>
  <span m='1213190'>single</span> <span m='1213580'>node,</span> <span m='1214570'>you</span>
  <span m='1214720'>have</span> <span m='1214870'>the</span> <span m='1214960'>predecessor</span>
  <span m='1215470'>lower</span> <span m='1215680'>bound.</span> <span m='1215860'>And</span>
  <span m='1215950'>we</span> <span m='1216040'>know</span> <span m='1216250'>log</span>
  <span m='1216500'>log</span> <span m='1217200'>universe</span> <span m='1217530'>size</span>
  <span m='1217870'>is</span> <span m='1218020'>the</span> <span m='1218140'>best</span>
  <span m='1218380'>you</span> <span m='1218470'>can</span> <span m='1218620'>do</span>
  <span m='1218830'>in</span> <span m='1218920'>this</span> <span m='1219520'>regime.</span>
  <span m='1223320'>So</span> <span m='1225480'>that's</span> <span m='1225660'>where</span>
  <span m='1225780'>we're</span> <span m='1225900'>going.</span> </p><p><span m='1226560'>Instead</span>
  <span m='1226920'>of</span> <span m='1227040'>describing</span> <span m='1227520'>trays,</span>
  <span m='1227940'>though,</span> <span m='1228180'>I'm</span> <span m='1228270'>going</span>
  <span m='1228390'>to</span> <span m='1228450'>describe</span> <span m='1228840'>a</span>
  <span m='1228930'>new</span> <span m='1229140'>way</span> <span m='1229260'>to</span>
  <span m='1229380'>do</span> <span m='1229500'>it,</span> <span m='1229690'>which</span>
  <span m='1229770'>has</span> <span m='1229920'>never</span> <span m='1230280'>been</span>
  <span m='1230490'>seen</span> <span m='1230820'>before</span> <span m='1232200'>in</span>
  <span m='1232410'>any</span> <span m='1232680'>class</span> <span m='1233130'>or</span>
  <span m='1233220'>anywhere.</span> <span m='1233610'>Because</span> <span m='1233820'>it's</span>
  <span m='1233940'>brand</span> <span m='1234210'>new.</span> <span m='1234410'>It's</span>
  <span m='1234540'>developed</span> <span m='1234900'>by</span> <span m='1235080'>Martin</span>
  <span m='1235390'>Farach-Colton,</span> <span m='1236060'>who</span> <span m='1237720'>did</span>
  <span m='1237870'>the</span> <span m='1237990'>LCA</span> <span m='1238860'>and</span>
  <span m='1239110'>the</span> <span m='1239310'>level</span> <span m='1239690'>ancestor</span>
  <span m='1240810'>structures</span> <span m='1241290'>that</span> <span m='1241410'>we</span>
  <span m='1241500'>saw in</span> <span m='1241680'>last</span> <span m='1241950'>class.</span>
  <span m='1243480'>And</span> <span m='1244230'>he</span> <span m='1244350'>just</span>
  <span m='1244560'>told</span> <span m='1244830'>it</span> <span m='1244890'>to</span>
  <span m='1245040'>me</span> <span m='1245250'>and</span> <span m='1245370'>it's</span>
  <span m='1245640'>really</span> <span m='1245850'>cool</span> <span m='1246160'>so</span>
  <span m='1246330'>we're</span> <span m='1246420'>going</span> <span m='1246570'>to</span>
  <span m='1247230'>cover</span> <span m='1247470'>it.</span> <span m='1251640'>A</span>
  <span m='1251820'>simpler</span> <span m='1252240'>way</span> <span m='1252480'>to</span>
  <span m='1252630'>get</span> <span m='1252810'>this</span> <span m='1252970'>same</span>
  <span m='1253350'>bound</span> <span m='1254250'>of</span> <span m='1254460'>trays.</span>
  </p><p><span m='1258990'>And</span> <span m='1259140'>the</span> <span m='1259260'>first</span>
  <span m='1259530'>thing</span> <span m='1259710'>we're</span> <span m='1259770'>going</span>
  <span m='1259890'>to</span> <span m='1259980'>do</span> <span m='1260670'>is</span>
  <span m='1260910'>use</span> <span m='1261180'>a</span> <span m='1261240'>weight</span>
  <span m='1261540'>balanced</span> <span m='1262130'>BST.</span> <span m='1267040'>This</span>
  <span m='1267310'>will</span> <span m='1267460'>achieve</span> <span m='1271020'>P</span>
  <span m='1271540'>plus</span> <span m='1272110'>log</span> <span m='1273350'>k</span>
  <span m='1274360'>query</span> <span m='1275710'>and</span> <span m='1275860'>linear</span>
  <span m='1276190'>space.</span> <span m='1280650'>k,</span> <span m='1281620'>remember,</span>
  <span m='1281890'>is</span> <span m='1282160'>the</span> <span m='1282280'>number</span>
  <span m='1282700'>of</span> <span m='1282760'>strings</span> <span m='1283210'>that</span>
  <span m='1283330'>we're</span> <span m='1283450'>storing,</span> <span m='1283850'>so</span>
  <span m='1283930'>it's</span> <span m='1284020'>the</span> <span m='1284110'>number</span>
  <span m='1284410'>of</span> <span m='1284500'>leaves</span> <span m='1284950'>in</span>
  <span m='1285160'>the</span> <span m='1285280'>trie.</span> <span m='1286670'>So</span>
  <span m='1286770'>it's</span> <span m='1286870'>not</span> <span m='1287110'>quite</span>
  <span m='1287500'>as</span> <span m='1287590'>good</span> <span m='1287770'>as</span>
  <span m='1287890'>P</span> <span m='1288060'>plus</span> <span m='1288310'>log</span>
  <span m='1288520'>Sigma</span> <span m='1288880'>but</span> <span m='1289000'>it's</span>
  <span m='1289150'>going</span> <span m='1289310'>to</span> <span m='1289360'>be</span>
  <span m='1289480'>a</span> <span m='1289540'>warm</span> <span m='1289840'>up.</span>
  <span m='1290080'>We're</span> <span m='1290490'>going to</span> <span m='1290650'>to</span>
  <span m='1290710'>do</span> <span m='1290860'>this</span> <span m='1291070'>and</span>
  <span m='1291160'>then</span> <span m='1291310'>we're</span> <span m='1291400'>going</span>
  <span m='1291520'>to</span> <span m='1291580'>improve</span> <span m='1291910'>it.</span>
  </p><p><span m='1294550'>Remember</span> <span m='1294970'>weight</span> <span m='1295300'>balanced</span>
  <span m='1297100'>trees,</span> <span m='1297580'>we</span> <span m='1297700'>talked</span>
  <span m='1297970'>about</span> <span m='1298240'>them</span> <span m='1299050'>way</span>
  <span m='1299230'>back</span> <span m='1299470'>in</span> <span m='1299590'>lecture</span>
  <span m='1299920'>3,</span> <span m='1300320'>I</span> <span m='1300370'>believe.</span>
  <span m='1301550'>There</span> <span m='1302150'>is</span> <span m='1302320'>an</span>
  <span m='1302410'>issue</span> <span m='1302800'>of</span> <span m='1303130'>what</span>
  <span m='1303430'>is</span> <span m='1303610'>the</span> <span m='1303760'>weight.</span>
  <span m='1304690'>And</span> <span m='1304900'>typically,</span> <span m='1305320'>you</span>
  <span m='1305440'>say,</span> <span m='1305620'>the</span> <span m='1305740'>weight</span>
  <span m='1306130'>of</span> <span m='1306310'>a</span> <span m='1306370'>subtree</span>
  <span m='1306850'>is</span> <span m='1306970'>the</span> <span m='1307030'>number</span>
  <span m='1307270'>of</span> <span m='1307360'>nodes</span> <span m='1307600'>in</span>
  <span m='1307690'>the</span> <span m='1307780'>subtree.</span> </p><p><span m='1308780'>I'm</span>
  <span m='1308860'>going</span> <span m='1309010'>to</span> <span m='1309070'>change</span>
  <span m='1309430'>that</span> <span m='1309640'>slightly</span> <span m='1310150'>and</span>
  <span m='1310240'>say,</span> <span m='1310420'>the</span> <span m='1310540'>weight</span>
  <span m='1311170'>of</span> <span m='1311320'>a</span> <span m='1311380'>subtree</span>
  <span m='1312010'>is</span> <span m='1312310'>the</span> <span m='1312520'>number</span>
  <span m='1312850'>of</span> <span m='1312940'>descendant</span> <span m='1313360'>leaves</span>
  <span m='1313900'>in</span> <span m='1314020'>the</span> <span m='1314110'>subtree,</span>
  <span m='1315550'>not</span> <span m='1315760'>the</span> <span m='1315820'>number</span>
  <span m='1316090'>of</span> <span m='1316180'>nodes,</span> <span m='1319300'>because</span>
  <span m='1320950'>it's</span> <span m='1321070'>log</span> <span m='1321330'>k.</span>
  <span m='1321890'>We</span> <span m='1322040'>really</span> <span m='1322330'>care</span>
  <span m='1322570'>about</span> <span m='1323410'>the</span> <span m='1323500'>number</span>
  <span m='1323680'>of</span> <span m='1323770'>leaves</span> <span m='1324070'>down</span>
  <span m='1324310'>there.</span> <span m='1324490'>There</span> <span m='1324610'>could</span>
  <span m='1324790'>be</span> <span m='1324910'>long</span> <span m='1325240'>paths</span>
  <span m='1325570'>here</span> <span m='1325750'>which</span> <span m='1325960'>we</span>
  <span m='1326590'>are</span> <span m='1326710'>not</span> <span m='1327100'>so</span>
  <span m='1327310'>excited</span> <span m='1327700'>about.</span> <span m='1328690'>We</span>
  <span m='1328840'>really</span> <span m='1329080'>care</span> <span m='1329230'>about</span>
  <span m='1329380'>how</span> <span m='1329530'>many</span> <span m='1329740'>leaves</span>
  <span m='1330040'>are</span> <span m='1330130'>down</span> <span m='1330340'>there.</span>
  <span m='1331150'>Like</span> <span m='1331330'>the</span> <span m='1331450'>weight</span>
  <span m='1332170'>of</span> <span m='1332350'>this</span> <span m='1332560'>node</span>
  <span m='1332890'>here</span> <span m='1333340'>is</span> <span m='1334260'>three--</span>
  <span m='1334975'>there's</span> <span m='1335330'>three</span> <span m='1335550'>leaves</span>
  <span m='1335830'>below</span> <span m='1336080'>it.</span> </p><p><span m='1341410'>You</span>
  <span m='1341590'>may</span> <span m='1341770'>recall</span> <span m='1342280'>weight</span>
  <span m='1342520'>balanced</span> <span m='1342980'>BSTs</span> <span m='1343800'>trying</span>
  <span m='1344140'>to</span> <span m='1344260'>make</span> <span m='1344470'>the</span>
  <span m='1344560'>weight</span> <span m='1344800'>of</span> <span m='1345010'>the</span>
  <span m='1345100'>left</span> <span m='1345350'>subtree</span> <span m='1345910'>within</span>
  <span m='1346150'>a</span> <span m='1346210'>constant</span> <span m='1346540'>factor</span>
  <span m='1346990'>of</span> <span m='1347110'>the</span> <span m='1347230'>weight</span>
  <span m='1347440'>of</span> <span m='1347560'>the</span> <span m='1347680'>right</span>
  <span m='1347890'>subtree.</span> <span m='1348860'>Because</span> <span m='1349060'>we're</span>
  <span m='1349180'>static,</span> <span m='1349720'>we</span> <span m='1349840'>can</span>
  <span m='1349990'>be</span> <span m='1350530'>even</span> <span m='1350800'>simpler</span>
  <span m='1351130'>and</span> <span m='1351220'>say,</span> <span m='1351430'>find</span>
  <span m='1351730'>the</span> <span m='1352000'>optimal</span> <span m='1352510'>partition.</span>
  </p><p><span m='1357190'>So</span> <span m='1358000'>we're</span> <span m='1358150'>thinking</span>
  <span m='1358390'>about</span> <span m='1358840'>this</span> <span m='1359110'>approach--</span>
  <span m='1360430'>idea</span> <span m='1360700'>of</span> <span m='1360790'>expanding</span>
  <span m='1361360'>a</span> <span m='1361480'>large</span> <span m='1361780'>degree</span>
  <span m='1362020'>node</span> <span m='1362320'>into</span> <span m='1362740'>some</span>
  <span m='1363010'>binary</span> <span m='1363460'>tree.</span> <span m='1364570'>We</span>
  <span m='1364660'>have</span> <span m='1364780'>a</span> <span m='1364840'>choice</span>
  <span m='1365140'>of</span> <span m='1365230'>what</span> <span m='1365380'>binary</span>
  <span m='1365770'>tree</span> <span m='1365950'>to</span> <span m='1366040'>use.</span>
  <span m='1366610'>With</span> <span m='1367210'>three</span> <span m='1367450'>nodes</span>
  <span m='1367820'>it</span> <span m='1368070'>may be not</span> <span m='1368380'>many</span>
  <span m='1368620'>choices--</span> <span m='1369010'>that</span> <span m='1369100'>could</span>
  <span m='1369250'>be</span> <span m='1369400'>this</span> <span m='1369700'>or it</span>
  <span m='1369830'>could</span> <span m='1369970'>be</span> <span m='1370090'>a</span>
  <span m='1370150'>straight</span> <span m='1370390'>this way</span> <span m='1370660'>or</span>
  <span m='1370820'>a</span> <span m='1370900'>straight</span> <span m='1371110'>line</span>
  <span m='1371290'>that</span> <span m='1371440'>way.</span> <span m='1372130'>Those</span>
  <span m='1372310'>are</span> <span m='1372370'>different.</span> <span m='1372790'>And</span>
  <span m='1372940'>if</span> <span m='1373090'>one</span> <span m='1373240'>of</span>
  <span m='1373300'>these</span> <span m='1374200'>guys</span> <span m='1374560'>is</span>
  <span m='1374680'>really</span> <span m='1374980'>heavy,</span> <span m='1375430'>one</span>
  <span m='1375550'>of</span> <span m='1375610'>these</span> <span m='1375790'>children</span>
  <span m='1376180'>is</span> <span m='1376300'>really</span> <span m='1376510'>heavy,</span>
  <span m='1376750'>you</span> <span m='1376870'>want</span> <span m='1377020'>to</span>
  <span m='1377080'>put</span> <span m='1377230'>it</span> <span m='1377320'>closer</span>
  <span m='1377650'>to</span> <span m='1377770'>the</span> <span m='1377890'>root.</span>
  <span m='1379190'>So</span> <span m='1379240'>that's</span> <span m='1379450'>what</span>
  <span m='1379540'>we're</span> <span m='1379600'>going</span> <span m='1379720'>to</span>
  <span m='1379810'>do.</span> </p><p><span m='1384060'>Let</span> <span m='1384210'>me</span>
  <span m='1384310'>draw</span> <span m='1384530'>it</span> <span m='1384580'>this</span>
  <span m='1384760'>way.</span> <span m='1386720'>That's</span> <span m='1386860'>kind</span>
  <span m='1387040'>of</span> <span m='1387130'>an</span> <span m='1387220'>array.</span>
  <span m='1389270'>But</span> <span m='1389670'>what</span> <span m='1389890'>this</span>
  <span m='1390310'>array</span> <span m='1390610'>represents</span> <span m='1391390'>is</span>
  <span m='1391870'>for</span> <span m='1392110'>a</span> <span m='1392170'>node--</span>
  <span m='1393490'>so</span> <span m='1393590'>here's</span> <span m='1393820'>my</span>
  <span m='1393940'>node,</span> <span m='1394180'>it</span> <span m='1394240'>has</span>
  <span m='1394390'>lots</span> <span m='1394600'>of</span> <span m='1394660'>children.</span>
  <span m='1396040'>Some</span> <span m='1396340'>of</span> <span m='1396400'>these</span>
  <span m='1396850'>are</span> <span m='1397240'>heavy,</span> <span m='1398200'>some</span>
  <span m='1398470'>of</span> <span m='1398560'>them</span> <span m='1398800'>are</span>
  <span m='1399010'>light,</span> <span m='1400420'>lighter</span> <span m='1400720'>than</span>
  <span m='1400870'>others.</span> <span m='1401890'>We</span> <span m='1401980'>don't</span>
  <span m='1402130'>know</span> <span m='1402280'>how</span> <span m='1402430'>they're</span>
  <span m='1402550'>distributed.</span> <span m='1403150'>But</span> <span m='1403270'>they're</span>
  <span m='1403390'>ordered,</span> <span m='1403930'>we</span> <span m='1404020'>have</span>
  <span m='1404110'>to</span> <span m='1404200'>preserve</span> <span m='1404560'>the</span>
  <span m='1404680'>order.</span> </p><p><span m='1407400'>What</span> <span m='1407620'>this</span>
  <span m='1407930'>is</span> <span m='1408040'>supposed</span> <span m='1408280'>to</span>
  <span m='1408370'>represent</span> <span m='1408790'>is</span> <span m='1408880'>the</span>
  <span m='1408970'>total</span> <span m='1409360'>number</span> <span m='1409630'>of</span>
  <span m='1409720'>leaves</span> <span m='1410200'>in</span> <span m='1410380'>this</span>
  <span m='1410560'>subtree.</span> <span m='1411890'>So</span> <span m='1412930'>the</span>
  <span m='1413140'>total</span> <span m='1413470'>number</span> <span m='1413770'>of</span>
  <span m='1413860'>leaves</span> <span m='1414850'>here.</span> <span m='1416050'>And</span>
  <span m='1416170'>then</span> <span m='1416830'>I'm</span> <span m='1417010'>going</span>
  <span m='1417220'>to</span> <span m='1417310'>partition</span> <span m='1417970'>this</span>
  <span m='1418840'>rectangle</span> <span m='1419890'>into</span> <span m='1420130'>groups</span>
  <span m='1420490'>corresponding</span> <span m='1421060'>to</span> <span m='1421150'>these</span>
  <span m='1421330'>sizes.</span> <span m='1423430'>So</span> <span m='1423670'>these</span>
  <span m='1424170'>are</span> <span m='1424210'>small,</span> <span m='1424720'>medium,</span>
  <span m='1425230'>small,</span> <span m='1426370'>little</span> <span m='1426850'>less</span>
  <span m='1427090'>than</span> <span m='1427210'>medium,</span> <span m='1428230'>big,</span>
  <span m='1430030'>and</span> <span m='1430300'>then</span> <span m='1430570'>small.</span>
  <span m='1431290'>Something</span> <span m='1431680'>like</span> <span m='1431890'>that.</span>
  <span m='1432550'>So</span> <span m='1432910'>these</span> <span m='1433600'>horizontal</span>
  <span m='1434110'>lengths</span> <span m='1434440'>correspond</span> <span m='1434950'>to</span>
  <span m='1435070'>the</span> <span m='1435520'>number</span> <span m='1435850'>of</span>
  <span m='1435940'>leaves</span> <span m='1436770'>in</span> <span m='1436900'>these</span>
  <span m='1437050'>things,</span> <span m='1437260'>correspond</span> <span m='1437650'>to</span>
  <span m='1437740'>the</span> <span m='1437860'>weight</span> <span m='1438160'>of</span>
  <span m='1438310'>my</span> <span m='1438460'>children.</span> </p><p><span m='1440260'>So</span>
  <span m='1440410'>I</span> <span m='1440440'>look</span> <span m='1440650'>at</span>
  <span m='1440710'>that</span> <span m='1440890'>and</span> <span m='1440980'>I</span>
  <span m='1441040'>say,</span> <span m='1441280'>well,</span> <span m='1441640'>what</span>
  <span m='1441790'>I'd</span> <span m='1441910'>really</span> <span m='1442240'>like</span>
  <span m='1442450'>to</span> <span m='1442570'>do</span> <span m='1443530'>is</span>
  <span m='1443680'>split</span> <span m='1443950'>this</span> <span m='1444160'>in</span>
  <span m='1444250'>the</span> <span m='1444340'>middle,</span> <span m='1444820'>which</span>
  <span m='1445195'>is,</span> <span m='1445570'>maybe,</span> <span m='1445810'>here.</span>
  <span m='1446690'>I</span> <span m='1447180'>say,</span> <span m='1447360'>OK,</span>
  <span m='1447640'>well,</span> <span m='1447850'>then</span> <span m='1448120'>I'll</span>
  <span m='1448240'>split</span> <span m='1448510'>here.</span> <span m='1448730'>That's</span>
  <span m='1449020'>pretty</span> <span m='1449290'>close</span> <span m='1449560'>to</span>
  <span m='1449680'>the</span> <span m='1449770'>middle.</span> <span m='1451090'>So</span>
  <span m='1451270'>my</span> <span m='1451420'>left</span> <span m='1451850'>subtree</span>
  <span m='1452110'>will</span> <span m='1452230'>consist</span> <span m='1452590'>of</span>
  <span m='1452710'>these</span> <span m='1452890'>guys,</span> <span m='1453640'>my</span>
  <span m='1453790'>right</span> <span m='1453970'>subtree</span> <span m='1454350'>will</span>
  <span m='1454550'>consist</span> <span m='1454900'>of</span> <span m='1454990'>these</span>
  <span m='1455170'>guys.</span> <span m='1455380'>And</span> <span m='1455470'>then</span>
  <span m='1455590'>I</span> <span m='1455650'>recurse--</span> <span m='1456760'>over</span>
  <span m='1456970'>here</span> <span m='1457550'>I've</span> <span m='1458140'>split</span>
  <span m='1458500'>at</span> <span m='1458590'>the</span> <span m='1458680'>middle,</span>
  <span m='1459490'>I</span> <span m='1459580'>find</span> <span m='1459790'>the</span>
  <span m='1459880'>thing</span> <span m='1460020'>that's</span> <span m='1460150'>closest</span>
  <span m='1460570'>to</span> <span m='1460630'>the</span> <span m='1460750'>middle.</span>
  <span m='1461440'>Over</span> <span m='1461640'>here</span> <span m='1461890'>I've</span>
  <span m='1461950'>split</span> <span m='1462340'>at the</span> <span m='1462460'>middle,</span>
  <span m='1462745'>I</span> <span m='1463030'>find</span> <span m='1463160'>the</span>
  <span m='1463210'>thing</span> <span m='1463370'>that's</span> <span m='1463480'>closest</span>
  <span m='1463870'>to</span> <span m='1463990'>the</span> <span m='1464080'>middle.</span>
  <span m='1466890'>It's</span> <span m='1467110'>pretty</span> <span m='1467320'>much</span>
  <span m='1467470'>determined.</span> </p><p><span m='1467890'>So</span> <span m='1468040'>my</span>
  <span m='1468190'>root</span> <span m='1468430'>node</span> <span m='1468670'>corresponds</span>
  <span m='1469180'>to</span> <span m='1469300'>this</span> <span m='1469480'>one.</span>
  <span m='1470670'>It's</span> <span m='1470820'>going</span> <span m='1470970'>to</span>
  <span m='1471040'>partition</span> <span m='1471550'>here.</span> <span m='1471850'>So</span>
  <span m='1472060'>over</span> <span m='1472300'>on</span> <span m='1472390'>the</span>
  <span m='1472510'>right,</span> <span m='1473360'>there's</span> <span m='1473440'>going</span>
  <span m='1473590'>to</span> <span m='1473680'>be--</span> <span m='1477250'>here's</span>
  <span m='1477490'>going</span> <span m='1477640'>to</span> <span m='1477730'>be</span>
  <span m='1477910'>the</span> <span m='1478030'>big</span> <span m='1478240'>tree</span>
  <span m='1479020'>and</span> <span m='1479140'>then</span> <span m='1479290'>here</span>
  <span m='1479470'>is</span> <span m='1479600'>the</span> <span m='1479680'>small</span>
  <span m='1479980'>tree.</span> <span m='1480400'>So</span> <span m='1480640'>this</span>
  <span m='1480870'>small</span> <span m='1481120'>tree</span> <span m='1481330'>corresponds</span>
  <span m='1481720'>to</span> <span m='1481780'>this</span> <span m='1481960'>one.</span>
  <span m='1482170'>This</span> <span m='1482320'>big</span> <span m='1482500'>tree</span>
  <span m='1482650'>corresponds</span> <span m='1483100'>to</span> <span m='1483190'>this</span>
  <span m='1483370'>interval.</span> <span m='1484270'>Then</span> <span m='1484330'>on</span>
  <span m='1484390'>the</span> <span m='1484450'>left</span> <span m='1484720'>we've</span>
  <span m='1484870'>got</span> <span m='1485110'>four</span> <span m='1486430'>things</span>
  <span m='1486700'>we</span> <span m='1486790'>need</span> <span m='1486910'>to</span>
  <span m='1487030'>store.</span> <span m='1487390'>So</span> <span m='1487570'>these</span>
  <span m='1487780'>are</span> <span m='1487870'>the</span> <span m='1488500'>red</span>
  <span m='1488740'>pointers</span> <span m='1489190'>that</span> <span m='1489280'>we</span>
  <span m='1489400'>had</span> <span m='1489550'>before.</span> </p><p><span m='1491970'>Then</span>
  <span m='1492190'>over</span> <span m='1492430'>on</span> <span m='1492520'>the</span>
  <span m='1492610'>left,</span> <span m='1493590'>we're</span> <span m='1493660'>going</span>
  <span m='1493780'>to</span> <span m='1493840'>have</span> <span m='1494020'>a</span>
  <span m='1494200'>partition.</span> <span m='1494960'>And</span> <span m='1495100'>then</span>
  <span m='1495220'>there's</span> <span m='1495370'>going</span> <span m='1495480'>to</span>
  <span m='1495580'>be</span> <span m='1495730'>two</span> <span m='1496000'>guys</span>
  <span m='1496390'>here.</span> <span m='1497250'>It</span> <span m='1497720'>doesn't</span>
  <span m='1498010'>really</span> <span m='1498310'>matter</span> <span m='1498640'>how</span>
  <span m='1498820'>we</span> <span m='1498940'>store</span> <span m='1499240'>them.</span>
  <span m='1499810'>It's</span> <span m='1500110'>something</span> <span m='1500500'>like</span>
  <span m='1500680'>this.</span> <span m='1503050'>There</span> <span m='1504010'>is</span>
  <span m='1505150'>medium</span> <span m='1507640'>and</span> <span m='1507790'>small.</span>
  <span m='1510280'>And</span> <span m='1510430'>then</span> <span m='1510640'>over</span>
  <span m='1510820'>on</span> <span m='1510910'>the</span> <span m='1511000'>left,</span>
  <span m='1511240'>we</span> <span m='1511360'>also</span> <span m='1511600'>have</span>
  <span m='1511840'>two</span> <span m='1511990'>guys.</span> <span m='1512255'>So</span>
  <span m='1512520'>it's</span> <span m='1512650'>going</span> <span m='1512770'>to</span>
  <span m='1512860'>be,</span> <span m='1514580'>again,</span> <span m='1514910'>something</span>
  <span m='1515140'>like</span> <span m='1515320'>this.</span> <span m='1520440'>You</span>
  <span m='1520600'>got</span> <span m='1521050'>medium</span> <span m='1521800'>and</span>
  <span m='1522070'>small.</span> <span m='1523370'>So</span> <span m='1523810'>you</span>
  <span m='1524160'>see</span> <span m='1524410'>how</span> <span m='1524620'>that</span>
  <span m='1525040'>worked.</span> </p><p><span m='1525880'>Our</span> <span m='1526000'>main</span>
  <span m='1526330'>goal</span> <span m='1526720'>was</span> <span m='1526930'>to</span>
  <span m='1527050'>make</span> <span m='1527230'>this</span> <span m='1527440'>big</span>
  <span m='1527680'>guy</span> <span m='1528460'>as</span> <span m='1528610'>close</span>
  <span m='1528850'>to</span> <span m='1528970'>the</span> <span m='1529090'>root</span>
  <span m='1529270'>as</span> <span m='1529390'>possible.</span> <span m='1530580'>It</span>
  <span m='1530650'>was</span> <span m='1530800'>the</span> <span m='1530860'>biggest</span>
  <span m='1531340'>and</span> <span m='1531460'>that's</span> <span m='1531640'>basically</span>
  <span m='1531940'>what</span> <span m='1532090'>happened.</span> <span m='1532390'>This</span>
  <span m='1532540'>one</span> <span m='1532700'>is</span> <span m='1532810'>really</span>
  <span m='1533020'>big.</span> <span m='1534230'>And</span> <span m='1534340'>we</span>
  <span m='1534460'>couldn't</span> <span m='1534730'>quite</span> <span m='1535060'>put</span>
  <span m='1535270'>it</span> <span m='1535330'>as</span> <span m='1535480'>a</span>
  <span m='1535540'>child</span> <span m='1535960'>of</span> <span m='1536050'>the</span>
  <span m='1536140'>root</span> <span m='1536330'>because</span> <span m='1536500'>it</span>
  <span m='1536590'>appeared</span> <span m='1536860'>in</span> <span m='1536980'>the</span>
  <span m='1537070'>middle,</span> <span m='1537790'>but</span> <span m='1537910'>we</span>
  <span m='1538060'>could</span> <span m='1538180'>put</span> <span m='1538390'>it</span>
  <span m='1538510'>as</span> <span m='1539260'>a</span> <span m='1539380'>grandchild</span>
  <span m='1540190'>at</span> <span m='1540280'>the</span> <span m='1540400'>root.</span>
  <span m='1541480'>In</span> <span m='1541570'>general,</span> <span m='1541940'>if</span>
  <span m='1542040'>you</span> <span m='1542140'>have</span> <span m='1542240'>a</span>
  <span m='1542340'>super</span> <span m='1542530'>heavy</span> <span m='1542860'>child,</span>
  <span m='1543400'>it</span> <span m='1543490'>will</span> <span m='1543660'>always</span>
  <span m='1543880'>become</span> <span m='1544240'>a</span> <span m='1544390'>child</span>
  <span m='1544690'>or</span> <span m='1544810'>grandchild</span> <span m='1545350'>of</span>
  <span m='1545470'>the</span> <span m='1545590'>root.</span> <span m='1547150'>So</span>
  <span m='1547450'>in</span> <span m='1547600'>constant</span> <span m='1548170'>number</span>
  <span m='1548440'>of</span> <span m='1548530'>traversals</span> <span m='1549010'>you'll</span>
  <span m='1549160'>get</span> <span m='1549340'>there.</span> </p><p><span m='1550250'>Now</span>
  <span m='1550270'>again,</span> <span m='1550640'>you</span> <span m='1550660'>fill</span>
  <span m='1550900'>in</span> <span m='1551020'>these</span> <span m='1551200'>nodes</span>
  <span m='1551500'>with</span> <span m='1551620'>some</span> <span m='1551830'>keys</span>
  <span m='1552190'>so you</span> <span m='1552340'>can</span> <span m='1552460'>do</span>
  <span m='1552580'>a</span> <span m='1552610'>binary</span> <span m='1552940'>search.</span>
  <span m='1553780'>But</span> <span m='1553930'>now</span> <span m='1554200'>the</span>
  <span m='1554290'>binary</span> <span m='1554590'>search</span> <span m='1555250'>might</span>
  <span m='1556570'>go</span> <span m='1556750'>faster</span> <span m='1557950'>than</span>
  <span m='1558740'>log</span> <span m='1559270'>Sigma,</span> <span m='1559970'>which</span>
  <span m='1560020'>is</span> <span m='1560140'>what</span> <span m='1560260'>we</span>
  <span m='1560380'>had</span> <span m='1560560'>before.</span> <span m='1561490'>And</span>
  <span m='1561610'>indeed,</span> <span m='1561910'>you</span> <span m='1562060'>can</span>
  <span m='1562240'>prove</span> <span m='1563140'>that</span> <span m='1563260'>this</span>
  <span m='1563530'>really</span> <span m='1563800'>works</span> <span m='1564040'>well.</span>
  </p><p><span m='1572410'>So</span> <span m='1572770'>what's</span> <span m='1573010'>the</span>
  <span m='1573130'>claim?</span> <span m='1577030'>Claim</span> <span m='1577430'>is</span>
  <span m='1578860'>every</span> <span m='1581050'>two</span> <span m='1581530'>edges</span>
  <span m='1583420'>you</span> <span m='1583570'>follow</span> <span m='1586450'>either</span>
  <span m='1592950'>advance</span> <span m='1594300'>one</span> <span m='1594540'>letter</span>
  <span m='1594950'>in</span> <span m='1595190'>P--</span> <span m='1598440'>these</span>
  <span m='1598680'>are</span> <span m='1598830'>the</span> <span m='1599190'>red</span>
  <span m='1599880'>edges</span> <span m='1600360'>that</span> <span m='1600480'>we</span>
  <span m='1600600'>want</span> <span m='1600780'>to</span> <span m='1600870'>follow.</span>
  <span m='1601360'>So</span> <span m='1601380'>if</span> <span m='1601470'>we</span>
  <span m='1601530'>follow</span> <span m='1601920'>a</span> <span m='1601980'>red</span>
  <span m='1602190'>edge,</span> <span m='1602460'>then</span> <span m='1602610'>we've</span>
  <span m='1602760'>made</span> <span m='1602940'>progress</span> <span m='1603480'>to</span>
  <span m='1603600'>the</span> <span m='1603690'>next</span> <span m='1603930'>node.</span>
  <span m='1605020'>So</span> <span m='1605100'>this</span> <span m='1605250'>would</span>
  <span m='1605340'>be</span> <span m='1605490'>following</span> <span m='1605970'>a</span>
  <span m='1606030'>red</span> <span m='1606240'>edge.</span> <span m='1608730'>Or</span>
  <span m='1611250'>we</span> <span m='1612720'>reduce</span> <span m='1615420'>the</span>
  <span m='1615510'>number</span> <span m='1615990'>of</span> <span m='1616440'>candidate</span>
  <span m='1617910'>to</span> <span m='1618050'>T</span> <span m='1618610'>i's</span>
  <span m='1620910'>by</span> <span m='1622020'>2/3</span> <span m='1624270'>or,</span>
  <span m='1624450'>I guess,</span> <span m='1624670'>to</span> <span m='1624970'>2/3</span>
  <span m='1626820'>of</span> <span m='1626940'>its</span> <span m='1627090'>original</span>
  <span m='1627480'>value.</span> <span m='1628110'>So</span> <span m='1628290'>we</span>
  <span m='1628380'>lose</span> <span m='1628710'>a</span> <span m='1628770'>third</span>
  <span m='1629040'>of</span> <span m='1629160'>the</span> <span m='1629250'>strings.</span>
  <span m='1630210'>That's</span> <span m='1630390'>what</span> <span m='1630540'>I'd</span>
  <span m='1630630'>like</span> <span m='1630780'>to</span> <span m='1630870'>claim.</span>
  </p><p><span m='1632100'>And</span> <span m='1632700'>it's</span> <span m='1632940'>not</span>
  <span m='1633120'>too</span> <span m='1633420'>hard</span> <span m='1633630'>to</span>
  <span m='1633750'>see</span> <span m='1633960'>this.</span> <span m='1634450'>You</span>
  <span m='1634550'>have</span> <span m='1634830'>to</span> <span m='1634950'>imagine</span>
  <span m='1635940'>all</span> <span m='1636180'>of</span> <span m='1636300'>these</span>
  <span m='1636600'>possible</span> <span m='1637230'>partitions.</span> <span m='1637685'>It's</span>
  <span m='1638140'>a</span> <span m='1638200'>little</span> <span m='1638460'>bit</span>
  <span m='1638610'>awkward.</span> <span m='1639720'>The</span> <span m='1639780'>idea</span>
  <span m='1639990'>is</span> <span m='1640080'>the</span> <span m='1640170'>following.</span>
  <span m='1640890'>If</span> <span m='1640980'>you</span> <span m='1641070'>take</span>
  <span m='1641430'>one</span> <span m='1641580'>of</span> <span m='1641640'>these</span>
  <span m='1641820'>arrays--</span> <span m='1643170'>this</span> <span m='1643410'>view</span>
  <span m='1643710'>of</span> <span m='1643830'>all</span> <span m='1643980'>the</span>
  <span m='1644070'>leaves</span> <span m='1644490'>just</span> <span m='1644850'>laid</span>
  <span m='1645090'>out</span> <span m='1645330'>on</span> <span m='1645420'>the</span>
  <span m='1645510'>line--</span> <span m='1646630'>you</span> <span m='1646710'>say,</span>
  <span m='1646890'>well,</span> <span m='1648840'>I'd</span> <span m='1649170'>like</span>
  <span m='1649350'>to</span> <span m='1649440'>split</span> <span m='1649710'>in</span>
  <span m='1649890'>half</span> <span m='1650100'>and</span> <span m='1650280'>half.</span>
  <span m='1650800'>But</span> <span m='1650820'>that</span> <span m='1650940'>will</span>
  <span m='1651060'>never</span> <span m='1651360'>happen</span> <span m='1652090'>unless</span>
  <span m='1652200'>I'm</span> <span m='1652350'>really</span> <span m='1652590'>lucky.</span>
  </p><p><span m='1653490'>So</span> <span m='1653610'>let's</span> <span m='1653790'>think</span>
  <span m='1653970'>about</span> <span m='1654750'>this</span> <span m='1654960'>one</span>
  <span m='1655230'>third</span> <span m='1655500'>splitting.</span> <span m='1657540'>If</span>
  <span m='1657690'>I</span> <span m='1657780'>were</span> <span m='1657900'>able</span>
  <span m='1658050'>to</span> <span m='1658140'>cut</span> <span m='1658440'>anywhere</span>
  <span m='1658860'>in</span> <span m='1658980'>here,</span> <span m='1660810'>then</span>
  <span m='1661050'>in</span> <span m='1661170'>one</span> <span m='1661470'>step,</span>
  <span m='1661830'>actually,</span> <span m='1662280'>I</span> <span m='1662400'>would</span>
  <span m='1662550'>achieve</span> <span m='1663930'>this</span> <span m='1664230'>2/3</span>
  <span m='1664740'>reduction.</span> <span m='1665430'>I'd</span> <span m='1665550'>lose</span>
  <span m='1665850'>a</span> <span m='1665880'>third</span> <span m='1666150'>of</span>
  <span m='1666210'>the</span> <span m='1666330'>nodes.</span> <span m='1670530'>If</span>
  <span m='1670710'>I</span> <span m='1671010'>end</span> <span m='1671280'>up</span>
  <span m='1671460'>cutting</span> <span m='1673320'>here,</span> <span m='1674490'>for</span>
  <span m='1674610'>example,</span> <span m='1675690'>then</span> <span m='1675870'>either</span>
  <span m='1676110'>I</span> <span m='1676170'>go</span> <span m='1676290'>to</span>
  <span m='1676380'>the</span> <span m='1676470'>left</span> <span m='1676800'>and</span>
  <span m='1676870'>I</span> <span m='1676920'>lost</span> <span m='1677430'>almost</span>
  <span m='1677700'>2/3</span> <span m='1678120'>of the</span> <span m='1678200'>nodes,</span>
  <span m='1678420'>or</span> <span m='1678510'>I</span> <span m='1678570'>go</span>
  <span m='1678690'>to</span> <span m='1678750'>the</span> <span m='1678870'>right</span>
  <span m='1679070'>and I</span> <span m='1679200'>at</span> <span m='1679260'>least</span>
  <span m='1679530'>lost</span> <span m='1679800'>this</span> <span m='1679980'>one</span>
  <span m='1680180'>third</span> <span m='1680370'>of</span> <span m='1680430'>the</span>
  <span m='1680520'>notes</span> <span m='1681270'>or</span> <span m='1681510'>one</span>
  <span m='1681690'>third</span> <span m='1681870'>of</span> <span m='1681960'>the</span>
  <span m='1682050'>leaves,</span> <span m='1682410'>I</span> <span m='1682470'>should</span>
  <span m='1682650'>say.</span> </p><p><span m='1684300'>So</span> <span m='1685030'>that</span>
  <span m='1685230'>would</span> <span m='1685350'>be</span> <span m='1685440'>a</span>
  <span m='1685500'>good</span> <span m='1685710'>situation</span> <span m='1686250'>if</span>
  <span m='1686400'>I</span> <span m='1686460'>got</span> <span m='1686760'>some</span>
  <span m='1687000'>cut</span> <span m='1687170'>in</span> <span m='1687300'>here.</span>
  <span m='1687610'>But</span> <span m='1687660'>it</span> <span m='1688110'>might</span>
  <span m='1688395'>be</span> <span m='1688470'>there</span> <span m='1688650'>is</span>
  <span m='1688800'>no</span> <span m='1689040'>possible</span> <span m='1689550'>cut</span>
  <span m='1689820'>I</span> <span m='1689910'>can</span> <span m='1690060'>make</span>
  <span m='1690300'>in</span> <span m='1690360'>here</span> <span m='1690570'>because</span>
  <span m='1691890'>there's</span> <span m='1692070'>a</span> <span m='1692160'>giant</span>
  <span m='1694260'>child</span> <span m='1694980'>in</span> <span m='1695130'>here</span>
  <span m='1695370'>that</span> <span m='1695490'>has</span> <span m='1696420'>more</span>
  <span m='1696720'>than</span> <span m='1696870'>one</span> <span m='1697060'>third</span>
  <span m='1697260'>of the</span> <span m='1697380'>nodes.</span> <span m='1697670'>It</span>
  <span m='1697740'>would</span> <span m='1697830'>have</span> <span m='1698010'>to</span>
  <span m='1698100'>span</span> <span m='1699120'>all</span> <span m='1699330'>the</span>
  <span m='1699450'>way</span> <span m='1699540'>across</span> <span m='1699990'>here.</span>
  <span m='1700710'>So</span> <span m='1700950'>I</span> <span m='1701040'>can't</span>
  <span m='1701400'>make</span> <span m='1701610'>any</span> <span m='1701820'>cuts,</span>
  <span m='1702210'>I</span> <span m='1702270'>can</span> <span m='1702420'>only</span>
  <span m='1702630'>cut</span> <span m='1702900'>between</span> <span m='1703230'>child</span>
  <span m='1703500'>boundaries.</span> </p><p><span m='1705060'>In</span> <span m='1705360'>that</span>
  <span m='1705600'>situation,</span> <span m='1707460'>you</span> <span m='1707580'>make</span>
  <span m='1707970'>this--</span> <span m='1709880'>well,</span> <span m='1709990'>this</span>
  <span m='1710220'>is</span> <span m='1710340'>when</span> <span m='1710520'>I</span>
  <span m='1710580'>need</span> <span m='1710760'>to</span> <span m='1710880'>follow</span>
  <span m='1711180'>two</span> <span m='1711450'>edges,</span> <span m='1711810'>not</span>
  <span m='1712020'>one.</span> <span m='1714180'>When</span> <span m='1714420'>there's</span>
  <span m='1714600'>a</span> <span m='1714660'>super</span> <span m='1715050'>big</span>
  <span m='1715350'>child</span> <span m='1715710'>like</span> <span m='1715890'>that,</span>
  <span m='1716100'>as</span> <span m='1716250'>we</span> <span m='1716310'>said,</span>
  <span m='1716550'>it</span> <span m='1716610'>will</span> <span m='1716760'>become</span>
  <span m='1717630'>a</span> <span m='1717720'>grandchild</span> <span m='1718380'>of</span>
  <span m='1718470'>the</span> <span m='1718590'>root.</span> <span m='1719280'>So</span>
  <span m='1719520'>it</span> <span m='1719610'>will</span> <span m='1719760'>be--</span>
  <span m='1720720'>there's</span> <span m='1721000'>the</span> <span m='1721080'>root</span>
  <span m='1721830'>and</span> <span m='1721950'>then</span> <span m='1722100'>here</span>
  <span m='1722520'>is</span> <span m='1722730'>the</span> <span m='1722850'>giant</span>
  <span m='1723480'>tree.</span> <span m='1725070'>And</span> <span m='1725190'>then</span>
  <span m='1725610'>there's</span> <span m='1725790'>going</span> <span m='1725920'>to</span>
  <span m='1726000'>be</span> <span m='1726120'>the</span> <span m='1726240'>other</span>
  <span m='1726450'>stuff</span> <span m='1729090'>here</span> <span m='1729450'>and</span>
  <span m='1729600'>here.</span> </p><p><span m='1730270'>So</span> <span m='1730290'>after</span>
  <span m='1730530'>I</span> <span m='1730620'>go</span> <span m='1730770'>down</span>
  <span m='1731010'>to</span> <span m='1731550'>either</span> <span m='1731880'>one</span>
  <span m='1732120'>step</span> <span m='1732510'>or</span> <span m='1732810'>two</span>
  <span m='1733020'>steps,</span> <span m='1733890'>I</span> <span m='1734010'>will</span>
  <span m='1734160'>either</span> <span m='1734490'>get</span> <span m='1734730'>here--</span>
  <span m='1737390'>sorry,</span> <span m='1738930'>more</span> <span m='1739350'>red</span>
  <span m='1740130'>chalk,</span> <span m='1742020'>this</span> <span m='1742260'>was</span>
  <span m='1742380'>a</span> <span m='1742470'>red</span> <span m='1742710'>point.</span>
  <span m='1743020'>Now,</span> <span m='1743100'>this</span> <span m='1743280'>is</span>
  <span m='1743400'>going</span> <span m='1743700'>to</span> <span m='1743820'>a</span>
  <span m='1743880'>child.</span> <span m='1744840'>So</span> <span m='1745020'>if</span>
  <span m='1745230'>I</span> <span m='1745350'>went</span> <span m='1745560'>there,</span>
  <span m='1745890'>I'm</span> <span m='1746070'>happy</span> <span m='1746460'>in</span>
  <span m='1746580'>two</span> <span m='1746760'>steps.</span> <span m='1747090'>I</span>
  <span m='1748530'>advance</span> <span m='1748890'>one</span> <span m='1749070'>letter</span>
  <span m='1749310'>in</span> <span m='1749430'>P.</span> <span m='1750360'>Or</span>
  <span m='1750840'>in</span> <span m='1750990'>two</span> <span m='1751140'>steps,</span>
  <span m='1751430'>I</span> <span m='1751500'>went</span> <span m='1751680'>here</span>
  <span m='1752260'>or</span> <span m='1752430'>I</span> <span m='1752460'>went</span>
  <span m='1752700'>here.</span> <span m='1753060'>And</span> <span m='1753180'>this</span>
  <span m='1753390'>was</span> <span m='1753840'>a</span> <span m='1753900'>huge</span>
  <span m='1754200'>amount</span> <span m='1754440'>of</span> <span m='1754500'>the</span>
  <span m='1754590'>nodes,</span> <span m='1754780'>this</span> <span m='1754940'>is</span>
  <span m='1755070'>at</span> <span m='1755160'>least</span> <span m='1755370'>a</span>
  <span m='1755430'>third</span> <span m='1755640'>of</span> <span m='1755700'>the</span>
  <span m='1755790'>nodes.</span> <span m='1756180'>Again,</span> <span m='1756510'>if</span>
  <span m='1756630'>I</span> <span m='1756720'>end</span> <span m='1756870'>up</span>
  <span m='1756990'>here</span> <span m='1757590'>or</span> <span m='1757680'>end</span>
  <span m='1757800'>up</span> <span m='1757920'>here,</span> <span m='1758220'>I</span>
  <span m='1758340'>lost</span> <span m='1759180'>2/3</span> <span m='1759780'>of</span>
  <span m='1759930'>the</span> <span m='1760020'>candidate</span> <span m='1760530'>leaves.</span>
  <span m='1760990'>I</span> <span m='1761485'>mean,</span> <span m='1761980'>I</span>
  <span m='1762120'>lost</span> <span m='1762330'>one</span> <span m='1762550'>third</span>
  <span m='1762780'>of</span> <span m='1762840'>the</span> <span m='1762930'>candidate</span>
  <span m='1763260'>leaves,</span> <span m='1763740'>leaving</span> <span m='1764880'>2/3</span>
  <span m='1765330'>of</span> <span m='1765420'>them.</span> </p><p><span m='1768840'>If</span>
  <span m='1769020'>this</span> <span m='1769230'>happens,</span> <span m='1769950'>I</span>
  <span m='1770100'>charged</span> <span m='1770730'>to</span> <span m='1771930'>this</span>
  <span m='1772140'>order</span> <span m='1772430'>P</span> <span m='1772710'>term.</span>
  <span m='1773340'>And</span> <span m='1773490'>if</span> <span m='1773580'>the</span>
  <span m='1773700'>other</span> <span m='1773850'>situation</span> <span m='1774390'>happens,</span>
  <span m='1774810'>I</span> <span m='1774960'>charge</span> <span m='1775270'>the</span>
  <span m='1775350'>log</span> <span m='1775640'>k</span> <span m='1775920'>term--</span>
  <span m='1776190'>because</span> <span m='1776430'>I</span> <span m='1776490'>can</span>
  <span m='1776640'>only</span> <span m='1776820'>reduce</span> <span m='1777120'>k</span>
  <span m='1777360'>by</span> <span m='1777540'>a</span> <span m='1777570'>factor</span>
  <span m='1778050'>of</span> <span m='1779130'>2/3--</span> <span m='1781260'>order</span>
  <span m='1781500'>log</span> <span m='1781670'>k</span> <span m='1781970'>times.</span>
  <span m='1784110'>This</span> <span m='1784320'>implies</span> <span m='1785580'>order</span>
  <span m='1785840'>p</span> <span m='1786390'>plus</span> <span m='1786900'>log</span>
  <span m='1787710'>k</span> <span m='1788400'>search.</span> </p><p><span m='1790720'>So</span>
  <span m='1790910'>a</span> <span m='1790940'>very</span> <span m='1791120'>simple</span>
  <span m='1791450'>idea.</span> <span m='1792440'>Just</span> <span m='1792620'>change</span>
  <span m='1793100'>the</span> <span m='1793190'>way</span> <span m='1793340'>we</span>
  <span m='1793460'>do</span> <span m='1793600'>BSTs.</span> <span m='1794900'>And</span>
  <span m='1794990'>we</span> <span m='1795110'>get,</span> <span m='1795560'>in</span>
  <span m='1795860'>some</span> <span m='1796160'>cases,</span> <span m='1796580'>a</span>
  <span m='1796640'>better</span> <span m='1796880'>bound.</span> <span m='1797210'>But</span>
  <span m='1797390'>not</span> <span m='1797600'>in</span> <span m='1797690'>all</span>
  <span m='1797870'>cases</span> <span m='1798380'>because</span> <span m='1798560'>maybe</span>
  <span m='1799940'>P</span> <span m='1800130'>plus</span> <span m='1800450'>log</span>
  <span m='1800660'>k</span> <span m='1800900'>might</span> <span m='1801230'>be</span>
  <span m='1801350'>bigger</span> <span m='1801590'>than</span> <span m='1801740'>P</span>
  <span m='1801980'>times</span> <span m='1802400'>log</span> <span m='1802670'>Sigma.</span>
  <span m='1803240'>And</span> <span m='1803330'>k</span> <span m='1803600'>and</span>
  <span m='1803720'>Sigma</span> <span m='1804020'>are</span> <span m='1804170'>kind</span>
  <span m='1804350'>of incomparable,</span> <span m='1805580'>so</span> <span m='1805730'>we</span>
  <span m='1805790'>don't</span> <span m='1805940'>know.</span> </p><p><span m='1806620'>That's</span>
  <span m='1806900'>where</span> <span m='1807620'>method</span> <span m='1807980'>5</span>
  <span m='1808340'>comes</span> <span m='1808640'>in,</span> <span m='1813180'>which</span>
  <span m='1813350'>is</span> <span m='1813560'>our</span> <span m='1813680'>good</span>
  <span m='1813890'>friend</span> <span m='1814250'>from</span> <span m='1814460'>last</span>
  <span m='1814730'>class--</span> <span m='1815620'>leaf</span> <span m='1815870'>trimming</span>
  <span m='1817210'>and</span> <span m='1817700'>indirection.</span> <span m='1822200'>So</span>
  <span m='1823160'>we're</span> <span m='1823340'>going</span> <span m='1823450'>to</span>
  <span m='1823550'>use</span> <span m='1823730'>this</span> <span m='1823880'>idea</span>
  <span m='1824930'>of</span> <span m='1825200'>finding--</span> <span m='1826640'>we're</span>
  <span m='1826700'>going</span> <span m='1826820'>to</span> <span m='1826880'>cut</span>
  <span m='1827840'>below</span> <span m='1828800'>maximally</span> <span m='1829490'>deep</span>
  <span m='1829760'>nodes</span> <span m='1833750'>with</span> <span m='1834080'>the</span>
  <span m='1834200'>right</span> <span m='1834470'>number</span> <span m='1834890'>of</span>
  <span m='1835340'>descendants</span> <span m='1835900'>in</span> <span m='1836010'>them.</span>
  <span m='1843820'>So</span> <span m='1845030'>we</span> <span m='1845120'>need</span>
  <span m='1845300'>at</span> <span m='1845360'>least</span> <span m='1845840'>Sigma</span>
  <span m='1847920'>descendants.</span> <span m='1853820'>It</span> <span m='1853940'>could</span>
  <span m='1854120'>just</span> <span m='1854270'>be</span> <span m='1854390'>descendants</span>
  <span m='1855050'>or</span> <span m='1855170'>descendant</span> <span m='1855620'>leaves,</span>
  <span m='1856100'>doesn't</span> <span m='1856430'>actually</span> <span m='1856760'>matter.</span>
  <span m='1862890'>Let</span> <span m='1862960'>me</span> <span m='1863140'>draw</span>
  <span m='1863440'>a</span> <span m='1863470'>picture,</span> <span m='1863830'>maybe.</span>
  </p><p><span m='1866490'>This</span> <span m='1866650'>is</span> <span m='1866800'>pretty</span>
  <span m='1867070'>much</span> <span m='1867250'>what</span> <span m='1867370'>we</span>
  <span m='1867460'>did</span> <span m='1867580'>before,</span> <span m='1868040'>except</span>
  <span m='1868210'>before</span> <span m='1868810'>this</span> <span m='1869320'>magic</span>
  <span m='1869650'>number</span> <span m='1869920'>was</span> <span m='1870160'>log</span>
  <span m='1870490'>n</span> <span m='1870970'>that</span> <span m='1871150'>we</span>
  <span m='1871300'>needed</span> <span m='1872040'>or</span> <span m='1872230'>1/2</span>
  <span m='1872500'>log</span> <span m='1872980'>n or</span> <span m='1873070'>something.</span>
  <span m='1873820'>Now</span> <span m='1874000'>it's</span> <span m='1874120'>going</span>
  <span m='1874240'>to</span> <span m='1874330'>be</span> <span m='1874480'>Sigma</span>
  <span m='1875020'>that</span> <span m='1875170'>we</span> <span m='1875290'>need.</span>
  <span m='1876260'>So</span> <span m='1876430'>it</span> <span m='1876550'>is</span>
  <span m='1876700'>we</span> <span m='1876820'>find</span> <span m='1877090'>these</span>
  <span m='1877240'>maximally</span> <span m='1877780'>deep</span> <span m='1878000'>nodes--</span>
  <span m='1878815'>these</span> <span m='1879070'>dots--</span> <span m='1880210'>that</span>
  <span m='1880360'>have</span> <span m='1881380'>at</span> <span m='1881470'>least--</span>
  <span m='1882880'>I</span> <span m='1882970'>guess,</span> <span m='1883230'>there</span>
  <span m='1883620'>is</span> <span m='1883810'>really</span> <span m='1884050'>multiple</span>
  <span m='1884440'>things</span> <span m='1884740'>hanging</span> <span m='1885070'>off</span>
  <span m='1885310'>here.</span> <span m='1885970'>In</span> <span m='1886300'>general,</span>
  <span m='1887490'>it</span> <span m='1887860'>could</span> <span m='1888010'>be</span>
  <span m='1888130'>several</span> <span m='1888490'>things</span> <span m='1888730'>hanging</span>
  <span m='1889050'>off.</span> <span m='1889990'>But</span> <span m='1890200'>the</span>
  <span m='1890320'>total</span> <span m='1890680'>number</span> <span m='1890890'>of</span>
  <span m='1890980'>descendants</span> <span m='1891490'>of</span> <span m='1891580'>each</span>
  <span m='1891730'>of</span> <span m='1891790'>these</span> <span m='1891970'>nodes</span>
  <span m='1892300'>is</span> <span m='1892450'>at</span> <span m='1892540'>least</span>
  <span m='1893290'>Sigma.</span> </p><p><span m='1895970'>So</span> <span m='1896050'>what</span>
  <span m='1896200'>that</span> <span m='1896350'>implies</span> <span m='1897130'>is</span>
  <span m='1897280'>that</span> <span m='1897400'>the</span> <span m='1897520'>number</span>
  <span m='1897880'>of</span> <span m='1898000'>these</span> <span m='1898450'>dots,</span>
  <span m='1898990'>the</span> <span m='1899080'>number</span> <span m='1899410'>of</span>
  <span m='1899590'>the</span> <span m='1899740'>leaves</span> <span m='1900310'>in</span>
  <span m='1900430'>the</span> <span m='1900520'>top</span> <span m='1900880'>tree--</span>
  <span m='1903420'>so</span> <span m='1903810'>up</span> <span m='1904030'>here--</span>
  <span m='1904980'>number</span> <span m='1905230'>of</span> <span m='1905350'>leaves</span>
  <span m='1907470'>is</span> <span m='1907730'>at</span> <span m='1907830'>most</span>
  <span m='1909500'>T</span> <span m='1910210'>over</span> <span m='1910570'>Sigma.</span>
  <span m='1911890'>Because</span> <span m='1912070'>we</span> <span m='1912160'>can</span>
  <span m='1912310'>charge</span> <span m='1912610'>each</span> <span m='1912760'>of</span>
  <span m='1912820'>these</span> <span m='1912970'>nodes</span> <span m='1913300'>to</span>
  <span m='1913990'>Sigma</span> <span m='1914890'>descendants</span> <span m='1916690'>in</span>
  <span m='1916780'>each</span> <span m='1916930'>of</span> <span m='1916990'>them.</span>
  </p><p><span m='1918490'>So</span> <span m='1918670'>that's</span> <span m='1918910'>good</span>
  <span m='1919720'>because</span> <span m='1920530'>it</span> <span m='1920680'>says</span>
  <span m='1921010'>we</span> <span m='1921160'>can</span> <span m='1921340'>use</span>
  <span m='1921610'>method</span> <span m='1921970'>1--</span> <span m='1923160'>the</span>
  <span m='1923290'>simple</span> <span m='1923650'>array</span> <span m='1923890'>method--</span>
  <span m='1924250'>which</span> <span m='1924430'>is</span> <span m='1924580'>fast</span>
  <span m='1925600'>but</span> <span m='1925780'>spacious.</span> <span m='1926830'>But</span>
  <span m='1927730'>if</span> <span m='1927910'>our</span> <span m='1928030'>new</span>
  <span m='1928390'>size</span> <span m='1928900'>of</span> <span m='1929400'>the</span>
  <span m='1929560'>trie</span> <span m='1930340'>gets</span> <span m='1930520'>divided</span>
  <span m='1930940'>by</span> <span m='1931090'>a</span> <span m='1931120'>Sigma</span>
  <span m='1931450'>factor,</span> <span m='1931870'>then</span> <span m='1932020'>this</span>
  <span m='1932170'>turns</span> <span m='1932380'>out</span> <span m='1932530'>to</span>
  <span m='1932590'>be</span> <span m='1932740'>linear.</span> <span m='1934100'>So</span>
  <span m='1934180'>up</span> <span m='1934360'>here</span> <span m='1934750'>we</span>
  <span m='1934900'>use</span> <span m='1935140'>method</span> <span m='1935470'>1.</span>
  </p><p><span m='1938980'>Now,</span> <span m='1939340'>you</span> <span m='1939640'>got</span>
  <span m='1939850'>to</span> <span m='1939910'>be</span> <span m='1940030'>a</span>
  <span m='1940060'>little</span> <span m='1940300'>careful</span> <span m='1940630'>because</span>
  <span m='1940810'>we</span> <span m='1940930'>can't</span> <span m='1941170'>use</span>
  <span m='1941320'>method</span> <span m='1941620'>1</span> <span m='1941830'>on</span>
  <span m='1941980'>all</span> <span m='1942220'>the</span> <span m='1942340'>nodes.</span>
  <span m='1943390'>We</span> <span m='1943480'>can</span> <span m='1943630'>definitely</span>
  <span m='1943900'>use</span> <span m='1944050'>it</span> <span m='1944140'>on</span>
  <span m='1944260'>the</span> <span m='1944320'>leaves</span> <span m='1944710'>because</span>
  <span m='1944890'>there</span> <span m='1945040'>aren't</span> <span m='1945160'>too</span>
  <span m='1945340'>many</span> <span m='1945550'>leaves.</span> <span m='1946600'>That</span>
  <span m='1946780'>means</span> <span m='1947020'>we</span> <span m='1947170'>can</span>
  <span m='1947320'>also</span> <span m='1947740'>use</span> <span m='1948010'>it</span>
  <span m='1948130'>on</span> <span m='1948460'>the</span> <span m='1948580'>number</span>
  <span m='1949000'>of</span> <span m='1949510'>branching</span> <span m='1949990'>nodes.</span>
  <span m='1952910'>Number</span> <span m='1953300'>of</span> <span m='1953710'>branching</span>
  <span m='1954190'>nodes</span> <span m='1954580'>is</span> <span m='1954730'>also</span>
  <span m='1955000'>going</span> <span m='1955150'>to</span> <span m='1955240'>be,</span>
  <span m='1955960'>at</span> <span m='1956110'>most,</span> <span m='1956890'>T</span>
  <span m='1957160'>over</span> <span m='1957400'>Sigma</span> <span m='1957940'>because</span>
  <span m='1959080'>it's</span> <span m='1959230'>actually</span> <span m='1959530'>one</span>
  <span m='1959740'>fewer</span> <span m='1960010'>branching</span> <span m='1960400'>node</span>
  <span m='1960550'>than</span> <span m='1960700'>there</span> <span m='1960850'>are</span>
  <span m='1961420'>leaves.</span> </p><p><span m='1963310'>So</span> <span m='1964750'>great,</span>
  <span m='1966610'>I</span> <span m='1966700'>can</span> <span m='1966910'>use</span>
  <span m='1967510'>arrays</span> <span m='1968530'>on</span> <span m='1968680'>the</span>
  <span m='1968770'>leaves,</span> <span m='1969340'>I</span> <span m='1969460'>can</span>
  <span m='1969610'>use</span> <span m='1969790'>arrays</span> <span m='1970240'>on</span>
  <span m='1970360'>the</span> <span m='1970450'>branching</span> <span m='1970870'>nodes.</span>
  <span m='1972340'>I</span> <span m='1972430'>can't</span> <span m='1972880'>use</span>
  <span m='1973120'>it</span> <span m='1973270'>on</span> <span m='1973450'>the</span>
  <span m='1973570'>non-branching</span> <span m='1974290'>nodes.</span> <span m='1974950'>Non-branching</span>
  <span m='1975460'>nodes</span> <span m='1975760'>are</span> <span m='1975880'>nodes</span>
  <span m='1976270'>with</span> <span m='1976450'>a</span> <span m='1976570'>single</span>
  <span m='1977660'>descendant</span> <span m='1978220'>and</span> <span m='1978490'>everything</span>
  <span m='1978940'>else</span> <span m='1979190'>is</span> <span m='1979390'>null.</span>
  </p><p><span m='1980650'>What do</span> <span m='1980830'>I</span> <span m='1980920'>do</span>
  <span m='1981070'>for</span> <span m='1981190'>those</span> <span m='1981430'>nodes?</span>
  <span m='1983490'>Very</span> <span m='1983710'>difficult.</span> <span m='1984640'>I</span>
  <span m='1984730'>just</span> <span m='1984940'>store</span> <span m='1985180'>that</span>
  <span m='1985390'>one</span> <span m='1985600'>pointer</span> <span m='1985900'>in</span>
  <span m='1986050'>a</span> <span m='1986110'>storage</span> <span m='1986470'>label.</span>
  <span m='1987340'>I</span> <span m='1987400'>guess</span> <span m='1987640'>you</span>
  <span m='1987730'>could</span> <span m='1987880'>think</span> <span m='1988060'>of</span>
  <span m='1988150'>that</span> <span m='1988390'>as</span> <span m='1988510'>method</span>
  <span m='1988860'>2</span> <span m='1989670'>in</span> <span m='1989830'>a</span>
  <span m='1989890'>very</span> <span m='1990100'>trivial</span> <span m='1990580'>case.</span>
  <span m='1991360'>You</span> <span m='1991450'>see--</span> <span m='1991690'>is</span>
  <span m='1991840'>this</span> <span m='1992020'>the</span> <span m='1992110'>right</span>
  <span m='1992290'>label?</span> <span m='1993670'>Yes</span> <span m='1993910'>or</span>
  <span m='1994000'>no.</span> <span m='1995310'>So</span> <span m='1995820'>this</span>
  <span m='1996060'>is</span> <span m='1996250'>the</span> <span m='1997030'>non-branching</span>
  <span m='1997690'>nodes.</span> <span m='2002730'>Non-branching</span> <span m='2003450'>top</span>
  <span m='2003840'>nodes--</span> <span m='2005910'>I</span> <span m='2006090'>will</span>
  <span m='2006240'>use</span> <span m='2006480'>method</span> <span m='2006810'>2.</span>
  <span m='2008430'>So</span> <span m='2008550'>I</span> <span m='2008610'>guess</span>
  <span m='2008800'>this</span> <span m='2008940'>is</span> <span m='2009030'>really--</span>
  <span m='2010260'>well,</span> <span m='2010410'>for</span> <span m='2010560'>these</span>
  <span m='2010770'>guys</span> <span m='2011210'>I</span> <span m='2011340'>use</span>
  <span m='2011520'>method</span> <span m='2011820'>1,</span> <span m='2012510'>for</span>
  <span m='2012630'>these</span> <span m='2012840'>guys</span> <span m='2013200'>I</span>
  <span m='2013260'>use</span> <span m='2013440'>method</span> <span m='2013740'>1.</span>
  </p><p><span m='2015930'>So</span> <span m='2016110'>I</span> <span m='2016140'>can</span>
  <span m='2016290'>afford</span> <span m='2016620'>all</span> <span m='2016770'>this.</span>
  <span m='2017160'>This</span> <span m='2017320'>will</span> <span m='2017470'>take</span>
  <span m='2017730'>order</span> <span m='2018000'>T</span> <span m='2018270'>space.</span>
  <span m='2023070'>And</span> <span m='2023370'>it</span> <span m='2023430'>will</span>
  <span m='2023580'>be</span> <span m='2023760'>fast</span> <span m='2024300'>because</span>
  <span m='2025080'>either</span> <span m='2025470'>I'm</span> <span m='2025560'>using</span>
  <span m='2025790'>arrays</span> <span m='2026280'>or</span> <span m='2026460'>I</span>
  <span m='2026520'>really</span> <span m='2026730'>don't</span> <span m='2026880'>have</span>
  <span m='2027030'>any</span> <span m='2027180'>work</span> <span m='2027390'>to</span>
  <span m='2027510'>do,</span> <span m='2028230'>and</span> <span m='2028440'>so</span>
  <span m='2028560'>it</span> <span m='2028620'>doesn't</span> <span m='2028860'>really</span>
  <span m='2029040'>matter</span> <span m='2029280'>what</span> <span m='2029460'>I</span>
  <span m='2029520'>do.</span> <span m='2030510'>But</span> <span m='2030900'>except</span>
  <span m='2031200'>I</span> <span m='2031260'>can't</span> <span m='2031470'>use</span>
  <span m='2031590'>arrays</span> <span m='2031920'>because</span> <span m='2032070'>they</span>
  <span m='2032190'>would</span> <span m='2032280'>be</span> <span m='2032400'>too</span>
  <span m='2032550'>spacious.</span> </p><p><span m='2033990'>So</span> <span m='2034110'>that</span>
  <span m='2034290'>handles</span> <span m='2034590'>the</span> <span m='2034680'>top.</span>
  <span m='2035170'>Now,</span> <span m='2035280'>the</span> <span m='2035370'>issue</span>
  <span m='2035570'>is,</span> <span m='2035670'>what</span> <span m='2035850'>about</span>
  <span m='2036090'>these</span> <span m='2036270'>bottom</span> <span m='2036570'>structures?</span>
  <span m='2037530'>The</span> <span m='2037650'>bottom</span> <span m='2037980'>structures--</span>
  <span m='2038580'>what</span> <span m='2038730'>do</span> <span m='2038790'>we</span>
  <span m='2038940'>know?</span> <span m='2039540'>They</span> <span m='2039660'>have</span>
  <span m='2039900'>to</span> <span m='2040020'>have</span> <span m='2040410'>less</span>
  <span m='2040860'>than</span> <span m='2041130'>Sigma</span> <span m='2042390'>nodes,</span>
  <span m='2043450'>less</span> <span m='2043710'>than</span> <span m='2043860'>Sigma</span>
  <span m='2044220'>descendants.</span> <span m='2045660'>Also</span> <span m='2046050'>less</span>
  <span m='2046230'>than</span> <span m='2046400'>Sigma</span> <span m='2046950'>leaves.</span>
  </p><p><span m='2049260'>So</span> <span m='2049440'>in</span> <span m='2049530'>other</span>
  <span m='2049650'>words,</span> <span m='2050230'>in</span> <span m='2050280'>these</span>
  <span m='2050909'>trees</span> <span m='2055889'>we</span> <span m='2056190'>have</span>
  <span m='2056489'>k</span> <span m='2057120'>less</span> <span m='2057420'>than</span>
  <span m='2057570'>Sigma.</span> <span m='2059100'>Well,</span> <span m='2059250'>then</span>
  <span m='2059520'>we</span> <span m='2059639'>can</span> <span m='2059760'>afford</span>
  <span m='2060090'>to</span> <span m='2060239'>use</span> <span m='2060449'>method</span>
  <span m='2060780'>4.</span> <span m='2061889'>Because</span> <span m='2062070'>our</span>
  <span m='2062159'>whole</span> <span m='2062400'>goal</span> <span m='2062719'>is</span>
  <span m='2062850'>to</span> <span m='2062969'>get</span> <span m='2063150'>k</span>
  <span m='2063510'>down to</span> <span m='2063699'>Sigma</span> <span m='2064159'>in</span>
  <span m='2064350'>this</span> <span m='2064590'>bound.</span> <span m='2065530'>So</span>
  <span m='2065909'>in</span> <span m='2066060'>the</span> <span m='2066150'>bottom</span>
  <span m='2066540'>trees,</span> <span m='2067620'>we</span> <span m='2067710'>use</span>
  <span m='2068040'>method</span> <span m='2068850'>4.</span> </p><p><span m='2071730'>Method</span>
  <span m='2071969'>4</span> <span m='2072159'>was</span> <span m='2072330'>always</span>
  <span m='2072600'>linear</span> <span m='2072900'>space.</span> <span m='2073500'>And</span>
  <span m='2073620'>the</span> <span m='2073710'>issue</span> <span m='2073980'>was</span>
  <span m='2074280'>we</span> <span m='2074400'>paid</span> <span m='2074670'>P plus</span>
  <span m='2075030'>log</span> <span m='2075420'>k.</span> <span m='2076260'>But</span>
  <span m='2076440'>now</span> <span m='2076800'>in</span> <span m='2076949'>here,</span>
  <span m='2077699'>k</span> <span m='2078210'>is</span> <span m='2079860'>less</span>
  <span m='2080250'>than</span> <span m='2081000'>Sigma</span> <span m='2082850'>in</span>
  <span m='2083100'>these</span> <span m='2083310'>trees.</span> <span m='2084239'>So</span>
  <span m='2084389'>that</span> <span m='2084600'>means</span> <span m='2085440'>we</span>
  <span m='2085560'>get</span> <span m='2086310'>order</span> <span m='2086639'>P</span>
  <span m='2087719'>plus</span> <span m='2088050'>log</span> <span m='2088889'>Sigma</span>
  <span m='2090120'>query</span> <span m='2090449'>time.</span> <span m='2093659'>And</span>
  <span m='2093840'>that's</span> <span m='2094080'>the</span> <span m='2094170'>best</span>
  <span m='2094409'>we</span> <span m='2094500'>know</span> <span m='2094620'>how</span>
  <span m='2094739'>to</span> <span m='2094860'>do</span> <span m='2095100'>if</span>
  <span m='2095280'>you</span> <span m='2095400'>want</span> <span m='2095580'>predecessor</span>
  <span m='2096550'>at</span> <span m='2096870'>the</span> <span m='2096960'>nodes.</span>
  </p><p><span m='2097780'>So</span> <span m='2098160'>it</span> <span m='2098330'>matches</span>
  <span m='2098760'>this</span> <span m='2098910'>tray</span> <span m='2099180'>bound</span>
  <span m='2100440'>in</span> <span m='2100950'>pretty</span> <span m='2101220'>easy</span>
  <span m='2101550'>way.</span> <span m='2101830'>Just</span> <span m='2101970'>to</span>
  <span m='2102050'>apply</span> <span m='2102330'>weight</span> <span m='2102540'>balanced,</span>
  <span m='2103380'>clean</span> <span m='2103620'>things</span> <span m='2103830'>up</span>
  <span m='2103980'>a</span> <span m='2104040'>little</span> <span m='2104250'>bit.</span>
  <span m='2104790'>But</span> <span m='2104970'>only</span> <span m='2105180'>do</span>
  <span m='2105360'>that</span> <span m='2105660'>at</span> <span m='2105870'>the</span>
  <span m='2105960'>leaves</span> <span m='2106920'>and</span> <span m='2107160'>everywhere</span>
  <span m='2107640'>up</span> <span m='2107800'>here,</span> <span m='2108220'>basically.</span>
  <span m='2109120'>Except</span> <span m='2109250'>the</span> <span m='2109430'>non-branching</span>
  <span m='2109920'>nodes</span> <span m='2110130'>use</span> <span m='2110310'>arrays.</span>
  <span m='2111350'>So</span> <span m='2111660'>for</span> <span m='2111750'>the</span>
  <span m='2111840'>most</span> <span m='2112020'>part</span> <span m='2112200'>arrays</span>
  <span m='2112560'>and</span> <span m='2112650'>then,</span> <span m='2112770'>at</span>
  <span m='2112830'>the</span> <span m='2112920'>bottom,</span> <span m='2113280'>you</span>
  <span m='2113370'>use</span> <span m='2113550'>weight</span> <span m='2113730'>balance.</span>
  </p><p><span m='2116400'>This</span> <span m='2116610'>is</span> <span m='2116760'>how</span>
  <span m='2117690'>you</span> <span m='2117960'>ought</span> <span m='2118200'>to</span>
  <span m='2118320'>represent</span> <span m='2118830'>a</span> <span m='2118890'>trie.</span>
  <span m='2119340'>If</span> <span m='2119550'>you</span> <span m='2119700'>want</span>
  <span m='2119910'>to</span> <span m='2119970'>preserve</span> <span m='2120450'>the</span>
  <span m='2120570'>order</span> <span m='2121570'>of</span> <span m='2121710'>the</span>
  <span m='2121800'>children,</span> <span m='2122350'>this</span> <span m='2122430'>is</span>
  <span m='2122580'>the</span> <span m='2122670'>best</span> <span m='2122970'>we</span>
  <span m='2123060'>know</span> <span m='2123150'>how</span> <span m='2123240'>to</span>
  <span m='2123360'>do.</span> <span m='2123630'>If</span> <span m='2123900'>you</span>
  <span m='2123960'>don't</span> <span m='2124110'>want</span> <span m='2124260'>to</span>
  <span m='2124320'>preserve</span> <span m='2124620'>order,</span> <span m='2124860'>just</span>
  <span m='2125040'>use</span> <span m='2125180'>a</span> <span m='2125250'>hash</span>
  <span m='2125460'>table.</span> <span m='2126330'>So</span> <span m='2126540'>it</span>
  <span m='2126600'>depends</span> <span m='2126930'>on</span> <span m='2127020'>the</span>
  <span m='2127110'>application.</span> </p><p><span m='2132110'>One</span> <span
  m='2132500'>fun</span> <span m='2132830'>application</span> <span m='2133520'>of</span>
  <span m='2133610'>this</span> <span m='2135110'>is</span> <span m='2135590'>string</span>
  <span m='2135920'>sorting.</span> <span m='2139370'>It's</span> <span m='2139790'>not</span>
  <span m='2140000'>a</span> <span m='2140060'>data</span> <span m='2140240'>structures</span>
  <span m='2140600'>problem</span> <span m='2140930'>so</span> <span m='2141050'>I</span>
  <span m='2141080'>don't</span> <span m='2141230'>want</span> <span m='2141350'>to</span>
  <span m='2141440'>spend</span> <span m='2141680'>too</span> <span m='2141770'>much</span>
  <span m='2141980'>time</span> <span m='2142250'>on</span> <span m='2142370'>it.</span>
  <span m='2142520'>But</span> <span m='2143440'>you</span> <span m='2143570'>use</span>
  <span m='2143810'>this</span> <span m='2143930'>trie</span> <span m='2144240'>data</span>
  <span m='2144480'>structure</span> <span m='2145130'>to</span> <span m='2145280'>sort</span>
  <span m='2145550'>strings.</span> <span m='2145910'>You</span> <span m='2146000'>just</span>
  <span m='2146180'>throw</span> <span m='2146420'>in</span> <span m='2146510'>a</span>
  <span m='2146540'>string</span> <span m='2146870'>and</span> <span m='2146960'>then</span>
  <span m='2147080'>throw</span> <span m='2147230'>in</span> <span m='2147320'>a</span>
  <span m='2147350'>string.</span> <span m='2147590'>We</span> <span m='2147680'>didn't</span>
  <span m='2147830'>talk</span> <span m='2148040'>about</span> <span m='2148250'>dynamic</span>
  <span m='2148700'>tries</span> <span m='2150230'>but</span> <span m='2150650'>it</span>
  <span m='2150800'>can</span> <span m='2151070'>be</span> <span m='2151160'>done.</span>
  </p><p><span m='2152670'>And</span> <span m='2152780'>if</span> <span m='2152900'>you</span>
  <span m='2153020'>throw</span> <span m='2153440'>it,</span> <span m='2153860'>you</span>
  <span m='2154040'>just</span> <span m='2154160'>sort</span> <span m='2154340'>of</span>
  <span m='2154400'>find</span> <span m='2154670'>where</span> <span m='2155000'>you</span>
  <span m='2155240'>fall</span> <span m='2155600'>off</span> <span m='2155900'>and</span>
  <span m='2155990'>then</span> <span m='2156170'>add</span> <span m='2156470'>the</span>
  <span m='2156560'>thing.</span> <span m='2157220'>Now,</span> <span m='2157340'>you</span>
  <span m='2157430'>have</span> <span m='2157550'>to</span> <span m='2157640'>maintain</span>
  <span m='2158090'>all</span> <span m='2158270'>this</span> <span m='2159170'>funky</span>
  <span m='2159500'>stuff</span> <span m='2159770'>but</span> <span m='2159890'>weight</span>
  <span m='2160040'>balanced</span> <span m='2160340'>trees</span> <span m='2160550'>can</span>
  <span m='2160760'>be</span> <span m='2161060'>made</span> <span m='2161240'>dynamic</span>
  <span m='2161900'>and</span> <span m='2162710'>indirection</span> <span m='2163370'>can</span>
  <span m='2163580'>be</span> <span m='2163730'>made</span> <span m='2163880'>dynamic.</span>
  </p><p><span m='2165030'>So</span> <span m='2165080'>you</span> <span m='2165260'>end</span>
  <span m='2165410'>up</span> <span m='2165560'>with</span> <span m='2166920'>this</span>
  <span m='2167420'>sort</span> <span m='2167610'>of</span> <span m='2167840'>simple</span>
  <span m='2168230'>incremental</span> <span m='2169130'>scheme.</span> <span m='2169880'>You</span>
  <span m='2170030'>end</span> <span m='2170210'>up</span> <span m='2170390'>with</span>
  <span m='2170660'>T</span> <span m='2171050'>plus</span> <span m='2172230'>k</span>
  <span m='2172760'>log</span> <span m='2173690'>Sigma</span> <span m='2174410'>to</span>
  <span m='2174530'>sort</span> <span m='2175220'>k</span> <span m='2175490'>strings</span>
  <span m='2176390'>of</span> <span m='2176540'>total</span> <span m='2176870'>size</span>
  <span m='2177230'>T</span> <span m='2179660'>with</span> <span m='2180050'>alphabet</span>
  <span m='2180500'>size</span> <span m='2181220'>Sigma.</span> <span m='2181790'>This</span>
  <span m='2182000'>is</span> <span m='2182120'>good.</span> <span m='2182720'>If</span>
  <span m='2182900'>I</span> <span m='2183020'>used,</span> <span m='2183320'>for</span>
  <span m='2183410'>example,</span> <span m='2184220'>merge</span> <span m='2184490'>sort</span>
  <span m='2184940'>to</span> <span m='2185090'>sort</span> <span m='2185480'>strings,</span>
  <span m='2186320'>it's</span> <span m='2186440'>going</span> <span m='2186550'>to</span>
  <span m='2186650'>be</span> <span m='2186740'>very</span> <span m='2186920'>bad.</span>
  <span m='2187160'>It's</span> <span m='2187280'>going</span> <span m='2187400'>to</span>
  <span m='2187550'>be</span> <span m='2187730'>something</span> <span m='2188090'>like</span>
  <span m='2190210'>T</span> <span m='2190520'>times</span> <span m='2191090'>k</span>
  <span m='2191900'>times</span> <span m='2192230'>log</span> <span m='2192530'>something.</span>
  <span m='2192980'>We</span> <span m='2193280'>didn't</span> <span m='2193370'>really</span>
  <span m='2193550'>care</span> <span m='2193730'>about</span> <span m='2193880'>the</span>
  <span m='2193970'>log.</span> <span m='2194150'>T</span> <span m='2194330'>times</span>
  <span m='2194600'>k</span> <span m='2194840'>is</span> <span m='2194990'>bad.</span>
  <span m='2195420'>That's</span> <span m='2196130'>because</span> <span m='2196370'>comparing</span>
  <span m='2196910'>strings</span> <span m='2197300'>could</span> <span m='2197430'>potentially</span>
  <span m='2197900'>take</span> <span m='2198110'>T</span> <span m='2198270'>time.</span>
  <span m='2199400'>And</span> <span m='2199490'>then</span> <span m='2199670'>there's</span>
  <span m='2199850'>k</span> <span m='2200060'>of</span> <span m='2200180'>them.</span>
  </p><p><span m='2200915'>But</span> <span m='2201320'>this</span> <span m='2201590'>is</span>
  <span m='2201860'>linear.</span> <span m='2202290'>This</span> <span m='2202370'>is</span>
  <span m='2202970'>the</span> <span m='2203060'>sum</span> <span m='2203390'>of</span>
  <span m='2203510'>the</span> <span m='2203600'>lengths</span> <span m='2203900'>of</span>
  <span m='2204050'>the</span> <span m='2204230'>strings.</span> <span m='2204870'>There's</span>
  <span m='2204950'>this</span> <span m='2205100'>extra</span> <span m='2205430'>little</span>
  <span m='2205670'>term.</span> <span m='2206510'>But</span> <span m='2207050'>most</span>
  <span m='2207320'>of</span> <span m='2207380'>the</span> <span m='2207440'>time</span>
  <span m='2207710'>that's</span> <span m='2207890'>going</span> <span m='2208010'>to</span>
  <span m='2208100'>be</span> <span m='2208190'>dominated</span> <span m='2208670'>by</span>
  <span m='2208880'>the</span> <span m='2209090'>length</span> <span m='2209330'>of</span>
  <span m='2209390'>the</span> <span m='2209510'>strings.</span> <span m='2211600'>So</span>
  <span m='2211690'>that's</span> <span m='2212160'>a</span> <span m='2212220'>good</span>
  <span m='2212340'>way</span> <span m='2212460'>to</span> <span m='2212550'>sort</span>
  <span m='2212730'>strings</span> <span m='2213660'>using</span> <span m='2213900'>tries.</span>
  <span m='2215310'>Tries</span> <span m='2215610'>by</span> <span m='2215730'>themselves,</span>
  <span m='2216270'>I</span> <span m='2216330'>mean</span> <span m='2216480'>this</span>
  <span m='2216600'>is</span> <span m='2216660'>about</span> <span m='2216870'>all</span>
  <span m='2216990'>there</span> <span m='2217140'>is</span> <span m='2217260'>to</span>
  <span m='2217380'>say.</span> </p><p><span m='2217800'>So</span> <span m='2218160'>let's</span>
  <span m='2218430'>move</span> <span m='2218670'>on</span> <span m='2218940'>to</span>
  <span m='2220110'>suffix</span> <span m='2220520'>trees</span> <span m='2221040'>and</span>
  <span m='2221220'>compressed</span> <span m='2222210'>tries.</span> <span m='2222870'>Now,</span>
  <span m='2223050'>we</span> <span m='2223110'>actually</span> <span m='2223350'>did</span>
  <span m='2223530'>compressed</span> <span m='2223950'>tries</span> <span m='2224880'>in</span>
  <span m='2225120'>the</span> <span m='2225930'>signature</span> <span m='2226420'>sort</span>
  <span m='2226760'>lecture.</span> <span m='2234510'>Actually,</span> <span m='2234900'>why</span>
  <span m='2235020'>don't</span> <span m='2235200'>I</span> <span m='2235260'>go</span>
  <span m='2235470'>over</span> <span m='2235650'>here?</span> </p><p><span m='2245210'>So</span>
  <span m='2245440'>tries--</span> <span m='2246850'>branches</span> <span m='2247300'>were</span>
  <span m='2247390'>labeled</span> <span m='2247720'>with</span> <span m='2247810'>letters.</span>
  <span m='2248230'>That's</span> <span m='2248430'>still</span> <span m='2248620'>going</span>
  <span m='2248740'>to</span> <span m='2248830'>be</span> <span m='2248980'>true</span>
  <span m='2249280'>for a</span> <span m='2249490'>compressed</span> <span m='2249910'>trie.</span>
  <span m='2252160'>But</span> <span m='2252340'>as</span> <span m='2252580'>we</span>
  <span m='2252700'>saw</span> <span m='2252985'>in</span> <span m='2253270'>that</span>
  <span m='2253450'>lecture,</span> <span m='2253990'>in</span> <span m='2254440'>compressed</span>
  <span m='2254890'>trie</span> <span m='2255190'>we're</span> <span m='2255280'>going</span>
  <span m='2255400'>to</span> <span m='2256210'>get</span> <span m='2256360'>rid</span>
  <span m='2256540'>of</span> <span m='2256630'>the</span> <span m='2256750'>non-branching</span>
  <span m='2257410'>nodes.</span> </p><p><span m='2261650'>So</span> <span m='2261790'>idea</span>
  <span m='2262070'>with</span> <span m='2262190'>the</span> <span m='2262270'>compressed</span>
  <span m='2262620'>trie is</span> <span m='2262930'>very</span> <span m='2263110'>simple--</span>
  <span m='2264010'>just</span> <span m='2264190'>contract</span> <span m='2266900'>non-branching</span>
  <span m='2267760'>paths</span> <span m='2268420'>into</span> <span m='2268660'>a</span>
  <span m='2268690'>single</span> <span m='2269110'>edge.</span> <span m='2283580'>This</span>
  <span m='2283820'>is</span> <span m='2283940'>our</span> <span m='2284030'>example</span>
  <span m='2284480'>of</span> <span m='2284570'>a</span> <span m='2284630'>trie.</span>
  <span m='2285800'>We're</span> <span m='2285860'>just</span> <span m='2286010'>going</span>
  <span m='2286130'>to</span> <span m='2286220'>modify</span> <span m='2286820'>it</span>
  <span m='2286970'>to</span> <span m='2287120'>make</span> <span m='2287480'>a</span>
  <span m='2287690'>compressed</span> <span m='2288140'>trie.</span> </p><p><span
  m='2294890'>Here</span> <span m='2295250'>we</span> <span m='2295400'>have</span>
  <span m='2295910'>a</span> <span m='2296060'>non-branching</span> <span m='2296930'>path.</span>
  <span m='2297920'>We</span> <span m='2298160'>have</span> <span m='2298460'>to</span>
  <span m='2298580'>follow</span> <span m='2298880'>an a,</span> <span m='2299070'>and</span>
  <span m='2299180'>then</span> <span m='2299330'>we</span> <span m='2299420'>have</span>
  <span m='2299660'>to</span> <span m='2299750'>follow</span> <span m='2300040'>an</span>
  <span m='2300150'>n.</span> <span m='2300770'>There's</span> <span m='2300890'>no</span>
  <span m='2301040'>point</span> <span m='2301430'>in</span> <span m='2301580'>having</span>
  <span m='2301910'>this</span> <span m='2302060'>node.</span> <span m='2302330'>You</span>
  <span m='2302390'>might</span> <span m='2302570'>as</span> <span m='2302660'>well</span>
  <span m='2302750'>just</span> <span m='2302900'>have</span> <span m='2303080'>a</span>
  <span m='2303140'>single</span> <span m='2303530'>edge</span> <span m='2303770'>that</span>
  <span m='2303890'>says</span> <span m='2304310'>a-n</span> <span m='2304730'>on</span>
  <span m='2304910'>it.</span> </p><p><span m='2306560'>So</span> <span m='2306800'>we</span>
  <span m='2306950'>go</span> <span m='2307835'>from</span> <span m='2308330'>here,</span>
  <span m='2308910'>from</span> <span m='2309020'>the</span> <span m='2309110'>root.</span>
  <span m='2309470'>We're</span> <span m='2309825'>going</span> <span m='2310180'>to</span>
  <span m='2310340'>have</span> <span m='2311510'>an</span> <span m='2311630'>edge</span>
  <span m='2311900'>that</span> <span m='2311990'>says</span> <span m='2312920'>a-n.</span>
  <span m='2317230'>And</span> <span m='2317410'>in</span> <span m='2317470'>some</span>
  <span m='2317680'>sense,</span> <span m='2317950'>the</span> <span m='2318070'>key</span>
  <span m='2318370'>of</span> <span m='2318520'>this</span> <span m='2318970'>child</span>
  <span m='2319480'>is</span> <span m='2319720'>a.</span> <span m='2320560'>If</span>
  <span m='2321280'>you're</span> <span m='2321370'>starting</span> <span m='2321730'>up</span>
  <span m='2321910'>here</span> <span m='2322030'>and</span> <span m='2322120'>you</span>
  <span m='2322210'>want</span> <span m='2322360'>to</span> <span m='2322420'>know</span>
  <span m='2322540'>which</span> <span m='2322750'>way</span> <span m='2322930'>should</span>
  <span m='2323110'>I</span> <span m='2323200'>go,</span> <span m='2324700'>you</span>
  <span m='2324910'>should</span> <span m='2325090'>only</span> <span m='2325270'>go</span>
  <span m='2325390'>this</span> <span m='2325570'>way</span> <span m='2325820'>if</span>
  <span m='2325840'>your</span> <span m='2325960'>first</span> <span m='2326350'>letter</span>
  <span m='2326680'>is</span> <span m='2326850'>a.</span> <span m='2327700'>After</span>
  <span m='2328000'>that,</span> <span m='2328180'>your</span> <span m='2328330'>next</span>
  <span m='2328540'>letter</span> <span m='2328750'>better</span> <span m='2329050'>be</span>
  <span m='2329230'>n,</span> <span m='2329410'>otherwise</span> <span m='2329770'>you</span>
  <span m='2329860'>fell</span> <span m='2330070'>off</span> <span m='2330220'>the</span>
  <span m='2330310'>tree.</span> <span m='2331420'>So</span> <span m='2331540'>that's</span>
  <span m='2331780'>the</span> <span m='2331910'>compression</span> <span m='2332350'>we're</span>
  <span m='2332440'>doing.</span> </p><p><span m='2333280'>Now,</span> <span m='2333460'>here</span>
  <span m='2333790'>we</span> <span m='2333910'>have--</span> <span m='2334240'>this</span>
  <span m='2334420'>is</span> <span m='2334510'>a</span> <span m='2334570'>branching</span>
  <span m='2334990'>node,</span> <span m='2335310'>so</span> <span m='2335410'>that</span>
  <span m='2335560'>node</span> <span m='2335830'>we</span> <span m='2336070'>keep</span>
  <span m='2336410'>intact.</span> <span m='2340490'>This is an</span> <span m='2340990'>n,</span>
  <span m='2341440'>this</span> <span m='2341620'>is</span> <span m='2341780'>an</span>
  <span m='2341860'>a</span> <span m='2343160'>here.</span> <span m='2343840'>But</span>
  <span m='2344020'>here</span> <span m='2344290'>it's</span> <span m='2344470'>non-branching.</span>
  <span m='2346370'>Let</span> <span m='2346450'>me</span> <span m='2346740'>draw</span>
  <span m='2346920'>this</span> <span m='2347080'>a</span> <span m='2347110'>little</span>
  <span m='2347290'>bit</span> <span m='2347440'>longer.</span> <span m='2348320'>In</span>
  <span m='2348630'>reality, it's</span> <span m='2348940'>just</span> <span m='2349120'>a</span>
  <span m='2349150'>single</span> <span m='2349480'>edge.</span> <span m='2350350'>And</span>
  <span m='2350500'>again,</span> <span m='2350740'>the</span> <span m='2350830'>key</span>
  <span m='2351190'>is</span> <span m='2351480'>a,</span> <span m='2351770'>and</span>
  <span m='2352000'>then</span> <span m='2352120'>you</span> <span m='2352240'>must</span>
  <span m='2352510'>have a</span> <span m='2352630'>$ sign</span> <span m='2353000'>on</span>
  <span m='2353140'>afterwards.</span> <span m='2354070'>Then</span> <span m='2354280'>you</span>
  <span m='2354400'>reach</span> <span m='2354850'>a</span> <span m='2354920'>leaf,</span>
  <span m='2355390'>the</span> <span m='2355510'>first</span> <span m='2355780'>leaf.</span>
  </p><p><span m='2356730'>If</span> <span m='2356910'>we</span> <span m='2356980'>follow</span>
  <span m='2357250'>the</span> <span m='2357400'>n</span> <span m='2357610'>branch--</span>
  <span m='2358420'>this</span> <span m='2358720'>is</span> <span m='2358930'>branching,</span>
  <span m='2359560'>so</span> <span m='2360700'>that</span> <span m='2360880'>node</span>
  <span m='2361150'>is</span> <span m='2361270'>preserved.</span> <span m='2365560'>If</span>
  <span m='2365740'>I</span> <span m='2365830'>go</span> <span m='2365980'>this</span>
  <span m='2366160'>way,</span> <span m='2366490'>it's a</span> <span m='2366670'>$</span>
  <span m='2367030'>sign</span> <span m='2367390'>and</span> <span m='2367480'>I</span>
  <span m='2367540'>reach</span> <span m='2367750'>a</span> <span m='2367810'>leaf.</span>
  <span m='2368730'>If</span> <span m='2368830'>I</span> <span m='2368920'>go</span>
  <span m='2369100'>this</span> <span m='2369310'>way</span> <span m='2369580'>it's</span>
  <span m='2369790'>an</span> <span m='2369970'>a</span> <span m='2370390'>that</span>
  <span m='2370540'>must</span> <span m='2370840'>be</span> <span m='2370990'>followed</span>
  <span m='2371410'>by</span> <span m='2371620'>a</span> <span m='2371720'>$</span>
  <span m='2371980'>sign,</span> <span m='2373030'>so</span> <span m='2373210'>that's</span>
  <span m='2373420'>a</span> <span m='2373480'>leaf.</span> <span m='2374020'>And</span>
  <span m='2374200'>if</span> <span m='2374320'>I</span> <span m='2374380'>go</span>
  <span m='2374530'>this</span> <span m='2374680'>way,</span> <span m='2374860'>it</span>
  <span m='2374950'>must</span> <span m='2375160'>be</span> <span m='2375380'>an e,</span>
  <span m='2375530'>followed</span> <span m='2376210'>by</span> <span m='2376420'>a</span>
  <span m='2376520'>$</span> <span m='2376780'>sign,</span> <span m='2377635'>which</span>
  <span m='2378130'>is</span> <span m='2378300'>a leaf.</span> <span m='2379780'>Again,</span>
  <span m='2380180'>these</span> <span m='2380260'>four</span> <span m='2380440'>leaves</span>
  <span m='2380770'>can</span> <span m='2380950'>point</span> <span m='2381250'>to</span>
  <span m='2382000'>these</span> <span m='2382180'>places.</span> </p><p><span m='2383080'>That's</span>
  <span m='2383310'>a</span> <span m='2383380'>compressed</span> <span m='2383710'>trie.</span>
  <span m='2384640'>Pretty</span> <span m='2384910'>obvious.</span> <span m='2386020'>The</span>
  <span m='2386110'>nice</span> <span m='2386290'>thing</span> <span m='2386440'>about</span>
  <span m='2386630'>the</span> <span m='2386680'>compressed</span> <span m='2387040'>trie</span>
  <span m='2387460'>is</span> <span m='2387640'>the</span> <span m='2387730'>number--</span>
  <span m='2388300'>here</span> <span m='2388600'>we</span> <span m='2388690'>knew</span>
  <span m='2388810'>the</span> <span m='2388900'>number</span> <span m='2389140'>of</span>
  <span m='2389230'>non-branching</span> <span m='2389440'>nodes,</span> <span m='2390010'>it</span>
  <span m='2390150'>was</span> <span m='2390280'>at</span> <span m='2390340'>most</span>
  <span m='2390680'>the</span> <span m='2390780'>number</span> <span m='2390850'>of</span>
  <span m='2390940'>leaves.</span> <span m='2391780'>Over</span> <span m='2391990'>here,</span>
  <span m='2392380'>the</span> <span m='2392500'>number</span> <span m='2392800'>of</span>
  <span m='2392890'>internal</span> <span m='2393280'>nodes</span> <span m='2393510'>is</span>
  <span m='2393610'>at</span> <span m='2393700'>most</span> <span m='2393890'>the</span>
  <span m='2393960'>number</span> <span m='2394150'>of</span> <span m='2394210'>leaves.</span>
  </p><p><span m='2394470'>So</span> <span m='2394610'>this</span> <span m='2395170'>structure</span>
  <span m='2395590'>has</span> <span m='2395950'>order</span> <span m='2396330'>k</span>
  <span m='2397480'>nodes</span> <span m='2397990'>in</span> <span m='2398140'>total</span>
  <span m='2399540'>because</span> <span m='2399730'>we</span> <span m='2399820'>got</span>
  <span m='2400030'>rid</span> <span m='2400240'>of</span> <span m='2400360'>all</span>
  <span m='2400510'>the</span> <span m='2400600'>non-branching</span> <span m='2401170'>nodes.</span>
  <span m='2402160'>I</span> <span m='2402220'>guess</span> <span m='2402430'>except</span>
  <span m='2402760'>the</span> <span m='2402870'>root,</span> <span m='2403180'>the</span>
  <span m='2403300'>root</span> <span m='2403510'>might</span> <span m='2403690'>not</span>
  <span m='2403840'>be</span> <span m='2403990'>branching.</span> <span m='2407500'>We've</span>
  <span m='2407850'>got</span> <span m='2408020'>a big</span> <span m='2408190'>O</span>
  <span m='2408430'>there</span> <span m='2408610'>to</span> <span m='2408730'>cover</span>
  <span m='2409030'>us.</span> <span m='2412000'>And</span> <span m='2412300'>all</span>
  <span m='2412540'>the</span> <span m='2412630'>things</span> <span m='2412870'>we</span>
  <span m='2412990'>said</span> <span m='2413200'>about</span> <span m='2413410'>representing</span>
  <span m='2414010'>tries</span> <span m='2414460'>here,</span> <span m='2414790'>you</span>
  <span m='2414940'>can</span> <span m='2415090'>do</span> <span m='2415210'>the</span>
  <span m='2415330'>same</span> <span m='2415690'>thing</span> <span m='2416560'>with</span>
  <span m='2416710'>a</span> <span m='2416770'>compressed</span> <span m='2417220'>trie.</span>
  <span m='2418300'>I</span> <span m='2418690'>need</span> <span m='2419080'>to</span>
  <span m='2419200'>write</span> <span m='2419380'>down</span> <span m='2419620'>that</span>
  <span m='2419860'>3.5</span> <span m='2422550'>here.</span> </p><p><span m='2433980'>And</span>
  <span m='2434160'>in</span> <span m='2434250'>fact,</span> <span m='2434520'>these</span>
  <span m='2434670'>results</span> <span m='2435000'>get</span> <span m='2435150'>better</span>
  <span m='2435600'>because</span> <span m='2435990'>before</span> <span m='2437340'>order</span>
  <span m='2437810'>T</span> <span m='2438085'>meant</span> <span m='2438840'>the</span>
  <span m='2439590'>number</span> <span m='2439920'>of</span> <span m='2440010'>nodes</span>
  <span m='2440250'>in</span> <span m='2440340'>the</span> <span m='2440480'>trie.</span>
  <span m='2440880'>Now</span> <span m='2441180'>order</span> <span m='2441390'>T</span>
  <span m='2441720'>will</span> <span m='2441870'>be</span> <span m='2442050'>the</span>
  <span m='2442140'>number</span> <span m='2442410'>of</span> <span m='2442500'>nodes</span>
  <span m='2442730'>in</span> <span m='2442800'>the</span> <span m='2442890'>compressed</span>
  <span m='2443370'>trie,</span> <span m='2443700'>which</span> <span m='2443880'>is</span>
  <span m='2443970'>actually</span> <span m='2444270'>order</span> <span m='2444510'>k.</span>
  <span m='2445770'>So</span> <span m='2448470'>life</span> <span m='2448680'>gets</span>
  <span m='2448860'>really</span> <span m='2449100'>good</span> <span m='2450240'>in</span>
  <span m='2450300'>this</span> <span m='2450450'>world.</span> </p><p><span m='2451200'>I</span>
  <span m='2451320'>did</span> <span m='2451560'>it</span> <span m='2451650'>in</span>
  <span m='2451710'>the</span> <span m='2451800'>trie</span> <span m='2452040'>setting</span>
  <span m='2452340'>because</span> <span m='2452520'>it's</span> <span m='2452610'>just</span>
  <span m='2452730'>simpler</span> <span m='2453030'>to</span> <span m='2453120'>think</span>
  <span m='2453330'>about.</span> <span m='2453760'>But</span> <span m='2454170'>really,</span>
  <span m='2454500'>you</span> <span m='2454650'>would</span> <span m='2454770'>always</span>
  <span m='2455010'>store a</span> <span m='2455250'>compressed</span> <span m='2455640'>trie.</span>
  <span m='2455900'>There's</span> <span m='2456060'>no</span> <span m='2456210'>point</span>
  <span m='2456450'>in</span> <span m='2456570'>storing</span> <span m='2456960'>a</span>
  <span m='2457020'>trie.</span> <span m='2457942'>You</span> <span m='2458280'>can</span>
  <span m='2458400'>still</span> <span m='2458610'>do</span> <span m='2458730'>the</span>
  <span m='2458850'>same</span> <span m='2459450'>kinds</span> <span m='2459720'>of</span>
  <span m='2459780'>searches.</span> </p><p><span m='2464010'>But</span> <span m='2464190'>really,</span>
  <span m='2464580'>compressed</span> <span m='2465060'>tries</span> <span m='2465970'>are</span>
  <span m='2466140'>warm</span> <span m='2466450'>up</span> <span m='2466650'>for</span>
  <span m='2467010'>suffix</span> <span m='2467430'>trees.</span> <span m='2469150'>So</span>
  <span m='2469260'>let's</span> <span m='2469440'>talk</span> <span m='2469680'>about</span>
  <span m='2469920'>suffix</span> <span m='2470340'>trees.</span> <span m='2474720'>Suffix</span>
  <span m='2475290'>trees</span> <span m='2476820'>are</span> <span m='2477120'>a</span>
  <span m='2477420'>compressed</span> <span m='2477840'>trie.</span> <span m='2478910'>So</span>
  <span m='2479040'>really</span> <span m='2479310'>they</span> <span m='2479430'>should</span>
  <span m='2479580'>be</span> <span m='2479700'>called</span> <span m='2481320'>suffix</span>
  <span m='2481740'>tries.</span> <span m='2482790'>And</span> <span m='2483150'>occasionally,</span>
  <span m='2483750'>people</span> <span m='2484130'>will</span> <span m='2484200'>call</span>
  <span m='2484440'>them</span> <span m='2486120'>suffix</span> <span m='2486600'>tries.</span>
  <span m='2487050'>But</span> <span m='2487200'>most</span> <span m='2487540'>people</span>
  <span m='2487800'>call</span> <span m='2487980'>them</span> <span m='2488100'>suffix</span>
  <span m='2488460'>trees,</span> <span m='2488745'>so</span> <span m='2489030'>for</span>
  <span m='2489240'>consistency</span> <span m='2489660'>I'll</span> <span m='2490080'>call</span>
  <span m='2490290'>them</span> <span m='2490440'>trees</span> <span m='2490710'>as</span>
  <span m='2490830'>well.</span> <span m='2491550'>But</span> <span m='2491670'>they</span>
  <span m='2491820'>are</span> <span m='2492000'>tries.</span> <span m='2502542'>I'm</span>
  <span m='2503030'>going to</span> <span m='2503520'>introduce</span> <span m='2503970'>some</span>
  <span m='2504180'>notation</span> <span m='2504750'>here.</span> </p><p><span m='2513590'>With</span>
  <span m='2513710'>tries,</span> <span m='2514110'>we</span> <span m='2514180'>are</span>
  <span m='2514260'>thinking</span> <span m='2514560'>about</span> <span m='2514740'>lots</span>
  <span m='2515040'>of</span> <span m='2515100'>different</span> <span m='2515430'>strings.</span>
  <span m='2516240'>In</span> <span m='2516360'>this</span> <span m='2516510'>case,</span>
  <span m='2517290'>we're</span> <span m='2517350'>going</span> <span m='2517590'>back</span>
  <span m='2517860'>to</span> <span m='2518070'>our</span> <span m='2518640'>string</span>
  <span m='2518910'>matching</span> <span m='2519270'>problem.</span> <span m='2519590'>We</span>
  <span m='2519690'>have</span> <span m='2519810'>a</span> <span m='2519870'>single</span>
  <span m='2520290'>text</span> <span m='2520860'>and</span> <span m='2521270'>we</span>
  <span m='2521390'>want</span> <span m='2521530'>to</span> <span m='2521590'>preprocess</span>
  <span m='2522180'>that</span> <span m='2522330'>text.</span> <span m='2523290'>But</span>
  <span m='2523440'>we're</span> <span m='2523530'>going</span> <span m='2523650'>to</span>
  <span m='2523710'>turn</span> <span m='2523950'>it</span> <span m='2524040'>into</span>
  <span m='2524250'>multiple</span> <span m='2524580'>strings</span> <span m='2524940'>by</span>
  <span m='2525090'>looking</span> <span m='2525390'>at</span> <span m='2525450'>all</span>
  <span m='2525630'>suffixes</span> <span m='2526530'>of</span> <span m='2526800'>the</span>
  <span m='2526920'>string.</span> <span m='2527970'>This</span> <span m='2528180'>is</span>
  <span m='2528330'>Python</span> <span m='2528720'>notation</span> <span m='2529230'>for</span>
  <span m='2529470'>everything</span> <span m='2529860'>from</span> <span m='2530020'>letter</span>
  <span m='2530280'>i</span> <span m='2530550'>onwards.</span> <span m='2532590'>And</span>
  <span m='2532740'>we</span> <span m='2532830'>do</span> <span m='2532920'>that</span>
  <span m='2533070'>for</span> <span m='2533250'>all</span> <span m='2533460'>i,</span>
  <span m='2533780'>so</span> <span m='2534180'>that's</span> <span m='2534360'>a</span>
  <span m='2534420'>lot</span> <span m='2534630'>of</span> <span m='2534720'>strings.</span>
  <span m='2535440'>And</span> <span m='2535590'>we</span> <span m='2535710'>build</span>
  <span m='2536160'>the</span> <span m='2536310'>compressed</span> <span m='2536820'>trie</span>
  <span m='2537300'>over</span> <span m='2537570'>them.</span> </p><p><span m='2538920'>That's</span>
  <span m='2539070'>the</span> <span m='2539160'>idea.</span> <span m='2539490'>And</span>
  <span m='2539730'>to</span> <span m='2540030'>make</span> <span m='2540300'>it</span>
  <span m='2540450'>work</span> <span m='2540750'>out--</span> <span m='2541080'>because</span>
  <span m='2541440'>you</span> <span m='2541560'>remember,</span> <span m='2542340'>with</span>
  <span m='2542460'>tries</span> <span m='2542820'>we</span> <span m='2542910'>had</span>
  <span m='2543000'>to</span> <span m='2543190'>append</span> <span m='2543360'>$</span>
  <span m='2543660'>sign</span> <span m='2543870'>to</span> <span m='2543930'>every</span>
  <span m='2545010'>string.</span> <span m='2545790'>In</span> <span m='2545880'>this</span>
  <span m='2546060'>case,</span> <span m='2546370'>we'd</span> <span m='2546380'>just</span>
  <span m='2546570'>have</span> <span m='2546720'>to</span> <span m='2546810'>append</span>
  <span m='2547050'>$</span> <span m='2547320'>sign</span> <span m='2547680'>to</span>
  <span m='2547830'>T,</span> <span m='2548700'>and</span> <span m='2548790'>then</span>
  <span m='2548910'>all</span> <span m='2549060'>suffixes</span> <span m='2549600'>will</span>
  <span m='2549810'>end</span> <span m='2550080'>with</span> <span m='2550290'>a</span>
  <span m='2550390'>$</span> <span m='2550530'>sign.</span> <span m='2551220'>So</span>
  <span m='2552190'>that</span> <span m='2552330'>covers</span> <span m='2552690'>us.</span>
  <span m='2552930'>$</span> <span m='2553320'>sign,</span> <span m='2553380'>again,</span>
  <span m='2553590'>is</span> <span m='2553710'>a</span> <span m='2553770'>character</span>
  <span m='2554130'>not</span> <span m='2554340'>appearing</span> <span m='2554670'>in</span>
  <span m='2554760'>the</span> <span m='2554850'>alphabet.</span> <span m='2556510'>And</span>
  <span m='2556950'>that's</span> <span m='2557190'>it.</span> <span m='2557530'>So</span>
  <span m='2557550'>that's a</span> <span m='2557760'>definition.</span> <span m='2558330'>Let's</span>
  <span m='2558540'>do</span> <span m='2558780'>an</span> <span m='2558870'>example.</span>
  </p><p><span m='2569240'>At</span> <span m='2569330'>this</span> <span m='2569480'>point,</span>
  <span m='2569690'>we</span> <span m='2569810'>going</span> <span m='2570080'>for</span>
  <span m='2570230'>this</span> <span m='2570410'>goal</span> <span m='2570830'>of</span>
  <span m='2571010'>order</span> <span m='2571250'>P</span> <span m='2571430'>query,</span>
  <span m='2571880'>order</span> <span m='2572150'>T</span> <span m='2572370'>space.</span>
  <span m='2574010'>Suffix</span> <span m='2574430'>trees</span> <span m='2574730'>will</span>
  <span m='2574880'>be</span> <span m='2576080'>a</span> <span m='2576170'>way</span>
  <span m='2576320'>to</span> <span m='2576470'>achieve</span> <span m='2576740'>that</span>
  <span m='2576920'>goal.</span> <span m='2583820'>Let's</span> <span m='2584120'>do</span>
  <span m='2585800'>my</span> <span m='2585980'>favorite</span> <span m='2586580'>example</span>
  <span m='2588200'>which</span> <span m='2588440'>is</span> <span m='2590090'>banana.</span>
  <span m='2593540'>I</span> <span m='2593570'>had</span> <span m='2593780'>a</span>
  <span m='2593840'>friend</span> <span m='2594200'>who</span> <span m='2594430'>said,</span>
  <span m='2596240'>I</span> <span m='2596330'>know</span> <span m='2596480'>how</span>
  <span m='2596570'>to</span> <span m='2596660'>spell</span> <span m='2596900'>banana,</span>
  <span m='2597650'>I</span> <span m='2597740'>just</span> <span m='2597890'>don't</span>
  <span m='2598010'>know</span> <span m='2598130'>when</span> <span m='2598220'>to</span>
  <span m='2598310'>stop.</span> <span m='2599900'>There's</span> <span m='2600320'>nice</span>
  <span m='2600530'>pattern</span> <span m='2600920'>to</span> <span m='2601100'>it</span>
  <span m='2601770'>and</span> <span m='2601910'>a</span> <span m='2601970'>lot</span>
  <span m='2602150'>of</span> <span m='2602210'>repeated</span> <span m='2602630'>letters</span>
  <span m='2602990'>and</span> <span m='2603080'>so</span> <span m='2603200'>on.</span>
  </p><p><span m='2604700'>I've</span> <span m='2604790'>got</span> <span m='2604940'>to</span>
  <span m='2605000'>number</span> <span m='2605390'>the</span> <span m='2605540'>characters.</span>
  <span m='2606230'>He</span> <span m='2606350'>said</span> <span m='2606500'>that</span>
  <span m='2606650'>when</span> <span m='2606740'>he</span> <span m='2606800'>was</span>
  <span m='2606890'>like</span> <span m='2607070'>six,</span> <span m='2607490'>not</span>
  <span m='2607750'>when</span> <span m='2607930'>he</span> <span m='2608320'>was</span>
  <span m='2608660'>older.</span> <span m='2611700'>It's</span> <span m='2611990'>a</span>
  <span m='2612050'>little</span> <span m='2612290'>harder</span> <span m='2612530'>when</span>
  <span m='2612650'>you're</span> <span m='2612740'>writing</span> <span m='2613010'>it</span>
  <span m='2613090'>on</span> <span m='2613190'>the</span> <span m='2613280'>board</span>
  <span m='2613610'>but</span> <span m='2614260'>we</span> <span m='2614400'>all</span>
  <span m='2614550'>know</span> <span m='2614660'>how</span> <span m='2614720'>to</span>
  <span m='2614810'>spell</span> <span m='2615020'>banana,</span> <span m='2615380'>I</span>
  <span m='2615470'>hope.</span> <span m='2616580'>I'd</span> <span m='2616840'>got</span>
  <span m='2617030'>it</span> <span m='2617140'>right,</span> <span m='2617320'>right?</span>
  <span m='2617790'>It</span> <span m='2617920'>should</span> <span m='2618140'>be</span>
  <span m='2618260'>7</span> <span m='2618590'>letters,</span> <span m='2619610'>including</span>
  <span m='2620000'>the</span> <span m='2620060'>$</span> <span m='2620360'>sign.</span>
  </p><p><span m='2623420'>There</span> <span m='2623630'>they</span> <span m='2623780'>are.</span>
  <span m='2624020'>So</span> <span m='2624230'>there's</span> <span m='2624440'>a</span>
  <span m='2624500'>suffix</span> <span m='2625040'>which</span> <span m='2625220'>is</span>
  <span m='2625430'>the</span> <span m='2625550'>whole</span> <span m='2625700'>string.</span>
  <span m='2626190'>There's</span> <span m='2626270'>a</span> <span m='2626330'>suffix</span>
  <span m='2626720'>which</span> <span m='2626870'>is</span> <span m='2626990'>a,</span>
  <span m='2627470'>n,</span> <span m='2627860'>a,</span> <span m='2628150'>n, a,</span>
  <span m='2628470'>$ sign.</span> <span m='2628670'>There</span> <span m='2628760'>is</span>
  <span m='2628850'>a</span> <span m='2628910'>suffix</span> <span m='2629270'>which</span>
  <span m='2629420'>is</span> <span m='2629510'>n,</span> <span m='2629840'>a,</span>
  <span m='2630110'>n, a,</span> <span m='2630380'>$ sign.</span> <span m='2630710'>There's
  a</span> <span m='2630770'>suffix</span> <span m='2631100'>which</span> <span m='2631220'>is</span>
  <span m='2631340'>a,</span> <span m='2631700'>n, a,</span> <span m='2632060'>$ sign.</span>
  <span m='2632300'>Suffix</span> <span m='2632630'>n,</span> <span m='2632890'>a,</span>
  <span m='2633090'>$ sign.</span> <span m='2633350'>a,</span> <span m='2633740'>$
  sign.</span> <span m='2633890'>And</span> <span m='2633980'>$</span> <span m='2634280'>sign.</span>
  <span m='2635140'>And</span> <span m='2635270'>empty,</span> <span m='2635570'>I</span>
  <span m='2635660'>suppose,</span> <span m='2636140'>but</span> <span m='2636320'>we're</span>
  <span m='2636440'>not</span> <span m='2636560'>going</span> <span m='2636710'>to</span>
  <span m='2636770'>store</span> <span m='2636950'>that</span> <span m='2637130'>one.</span>
  <span m='2638340'>You</span> <span m='2638430'>don't</span> <span m='2638540'>need</span>
  <span m='2638690'>to.</span> <span m='2641210'>Cool.</span> </p><p><span m='2642530'>I'm</span>
  <span m='2642710'>going</span> <span m='2642860'>to</span> <span m='2642920'>cheat</span>
  <span m='2643130'>a</span> <span m='2643190'>little</span> <span m='2643370'>bit</span>
  <span m='2643550'>and</span> <span m='2643910'>look</span> <span m='2644030'>at</span>
  <span m='2644090'>my</span> <span m='2644270'>figure</span> <span m='2644630'>because</span>
  <span m='2644870'>it</span> <span m='2644960'>is</span> <span m='2645830'>a</span>
  <span m='2645890'>little</span> <span m='2646100'>bit</span> <span m='2646250'>of</span>
  <span m='2646340'>thinking.</span> <span m='2647350'>One</span> <span m='2647720'>The</span>
  <span m='2648140'>final</span> <span m='2648440'>challenge</span> <span m='2648695'>of</span>
  <span m='2648950'>this</span> <span m='2649070'>lecture</span> <span m='2649400'>will</span>
  <span m='2649580'>be</span> <span m='2651080'>construct</span> <span m='2651560'>this</span>
  <span m='2651740'>diagram</span> <span m='2652310'>in</span> <span m='2652520'>linear</span>
  <span m='2652790'>time.</span> <span m='2654560'>But</span> <span m='2655110'>I'm,</span>
  <span m='2655440'>just</span> <span m='2655640'>for</span> <span m='2655880'>now,</span>
  <span m='2657380'>going</span> <span m='2657650'>to</span> <span m='2657740'>cheat</span>
  <span m='2678280'>because</span> <span m='2678490'>it's</span> <span m='2678640'>a</span>
  <span m='2678670'>little</span> <span m='2678910'>tricky</span> <span m='2679210'>to</span>
  <span m='2679330'>do</span> <span m='2679480'>it</span> <span m='2679600'>and</span>
  <span m='2679810'>get</span> <span m='2679990'>all</span> <span m='2680140'>the</span>
  <span m='2680230'>nodes</span> <span m='2680500'>in</span> <span m='2680590'>sorted</span>
  <span m='2680950'>order.</span> <span m='2697980'>So</span> <span m='2698060'>that</span>
  <span m='2698270'>should</span> <span m='2698450'>give</span> <span m='2698660'>it</span>
  <span m='2698720'>to</span> <span m='2698960'>us.</span> <span m='2699320'>And</span>
  <span m='2699470'>then</span> <span m='2700100'>the</span> <span m='2700430'>suffixes.</span>
  <span m='2702155'>Here</span> <span m='2702480'>is</span> <span m='2703010'>another</span>
  <span m='2703290'>color.</span> <span m='2704630'>6,</span> <span m='2706130'>5,</span>
  <span m='2707130'>3,</span> <span m='2708630'>1,</span> <span m='2710116'>0,</span>
  <span m='2711574'>4,</span> <span m='2713140'>2.</span> <span m='2714810'>Cool.</span>
  </p><p><span m='2716420'>This</span> <span m='2716630'>I</span> <span m='2716720'>claim</span>
  <span m='2716960'>is</span> <span m='2717070'>a</span> <span m='2717110'>suffix</span>
  <span m='2717470'>tree</span> <span m='2717620'>of</span> <span m='2717680'>banana.</span>
  <span m='2718580'>You</span> <span m='2718670'>see</span> <span m='2719110'>the</span>
  <span m='2719230'>banana</span> <span m='2719900'>substring.</span> <span m='2720530'>Than</span>
  <span m='2720710'>the</span> <span m='2720770'>next</span> <span m='2721010'>one</span>
  <span m='2721220'>is</span> <span m='2721490'>a, n,</span> <span m='2721960'>a,</span>
  <span m='2722240'>n,</span> <span m='2722580'>a,</span> <span m='2722900'>$</span>
  <span m='2723320'>sign.</span> <span m='2724670'>Then</span> <span m='2724970'>the</span>
  <span m='2725060'>next</span> <span m='2725270'>one</span> <span m='2725420'>is</span>
  <span m='2725840'>n,</span> <span m='2726140'>a,</span> <span m='2726380'>n,</span>
  <span m='2726530'>a,</span> <span m='2726800'>$</span> <span m='2727220'>sign.</span>
  <span m='2727700'>Then</span> <span m='2727940'>the</span> <span m='2728030'>next</span>
  <span m='2728300'>one</span> <span m='2728480'>is</span> <span m='2728900'>a,</span>
  <span m='2729400'>n,</span> <span m='2729810'>a,</span> <span m='2730120'>$</span>
  <span m='2730640'>sign.</span> <span m='2731570'>Next</span> <span m='2731810'>one</span>
  <span m='2731990'>is</span> <span m='2732490'>n, a,</span> <span m='2732740'>$</span>
  <span m='2733280'>sign.</span> <span m='2734380'>Next</span> <span m='2734560'>one</span>
  <span m='2734720'>is</span> <span m='2734960'>a,</span> <span m='2735230'>$</span>
  <span m='2735500'>sign.</span> <span m='2735840'>And then</span> <span m='2735950'>$</span>
  <span m='2736190'>sign.</span> <span m='2737710'>So</span> <span m='2737900'>that's</span>
  <span m='2738260'>a</span> <span m='2738530'>nice,</span> <span m='2738890'>clean</span>
  <span m='2739280'>representation</span> <span m='2739940'>of</span> <span m='2740030'>all</span>
  <span m='2740120'>the</span> <span m='2740210'>suffixes.</span> </p><p><span m='2740750'>And</span>
  <span m='2740840'>you</span> <span m='2740960'>can</span> <span m='2741080'>see
  that</span> <span m='2741350'>if</span> <span m='2741530'>you</span> <span m='2741680'>wanted</span>
  <span m='2741950'>to</span> <span m='2742070'>search</span> <span m='2742840'>from</span>
  <span m='2743000'>the</span> <span m='2743090'>middle</span> <span m='2743360'>of</span>
  <span m='2743530'>this</span> <span m='2744070'>string--</span> <span m='2744370'>suppose</span>
  <span m='2744680'>I</span> <span m='2744770'>want</span> <span m='2744950'>to</span>
  <span m='2745010'>search</span> <span m='2745250'>for</span> <span m='2745340'>a</span>
  <span m='2745430'>nan--</span> <span m='2746510'>then</span> <span m='2746870'>it's</span>
  <span m='2747020'>right</span> <span m='2747200'>there.</span> <span m='2747490'>Just</span>
  <span m='2747680'>do</span> <span m='2748060'>n,</span> <span m='2748290'>a,</span>
  <span m='2748730'>n,</span> <span m='2750770'>then</span> <span m='2750920'>I'm</span>
  <span m='2751070'>done.</span> <span m='2751700'>This</span> <span m='2752480'>virtual</span>
  <span m='2753020'>node</span> <span m='2753290'>in</span> <span m='2753380'>the</span>
  <span m='2753470'>middle</span> <span m='2753800'>here</span> <span m='2754130'>along</span>
  <span m='2754520'>the</span> <span m='2755000'>one</span> <span m='2755270'>third</span>
  <span m='2755540'>of</span> <span m='2755600'>the</span> <span m='2755690'>way</span>
  <span m='2755810'>down</span> <span m='2756020'>the</span> <span m='2756170'>edge,</span>
  <span m='2756980'>that</span> <span m='2757760'>represents</span> <span m='2758750'>n-a-n.</span>
  <span m='2760100'>And</span> <span m='2760250'>indeed,</span> <span m='2760680'>if</span>
  <span m='2760760'>you</span> <span m='2760970'>look</span> <span m='2761180'>at</span>
  <span m='2761330'>the</span> <span m='2761420'>descendant</span> <span m='2761840'>leaf,</span>
  <span m='2762170'>that</span> <span m='2762500'>corresponds</span> <span m='2763130'>to</span>
  <span m='2763400'>an</span> <span m='2763520'>occurrence</span> <span m='2764030'>of</span>
  <span m='2764170'>n-a-n.</span> </p><p><span m='2765470'>If</span> <span m='2765620'>I</span>
  <span m='2765710'>was</span> <span m='2765890'>going</span> <span m='2766010'>to</span>
  <span m='2766070'>look</span> <span m='2766250'>for</span> <span m='2766880'>a-n,</span>
  <span m='2768680'>I</span> <span m='2768830'>would</span> <span m='2768980'>do</span>
  <span m='2769400'>a,</span> <span m='2769773'>n,</span> <span m='2770520'>so</span>
  <span m='2771080'>halfway</span> <span m='2771530'>down</span> <span m='2771740'>this</span>
  <span m='2771920'>edge.</span> <span m='2772880'>And</span> <span m='2773030'>then</span>
  <span m='2773210'>this</span> <span m='2773390'>subtree</span> <span m='2774590'>represents</span>
  <span m='2775310'>all</span> <span m='2775610'>the</span> <span m='2775760'>occurrences</span>
  <span m='2776510'>of</span> <span m='2776660'>a-n.</span> <span m='2777920'>Think</span>
  <span m='2778100'>about</span> <span m='2778400'>it.</span> <span m='2779210'>There's</span>
  <span m='2780170'>two</span> <span m='2780380'>of</span> <span m='2780500'>them--</span>
  <span m='2781220'>One</span> <span m='2781910'>that</span> <span m='2781990'>starts</span>
  <span m='2782190'>at</span> <span m='2782270'>position</span> <span m='2782660'>3,</span>
  <span m='2783320'>one</span> <span m='2783470'>that</span> <span m='2783560'>starts</span>
  <span m='2783800'>at</span> <span m='2783860'>position</span> <span m='2784280'>1.</span>
  <span m='2785450'>Here's</span> <span m='2785690'>one</span> <span m='2785840'>occurrence</span>
  <span m='2786260'>of</span> <span m='2786380'>a-n,</span> <span m='2786870'>here's</span>
  <span m='2787100'>another</span> <span m='2787410'>occurrence of</span> <span m='2787780'>a-n.</span>
  </p><p><span m='2788150'>This</span> <span m='2788300'>works</span> <span m='2788570'>even</span>
  <span m='2788810'>when</span> <span m='2788930'>they're</span> <span m='2789020'>overlapping.</span>
  <span m='2789630'>If</span> <span m='2789740'>I</span> <span m='2789800'>search</span>
  <span m='2790040'>for</span> <span m='2790160'>a-n-a,</span> <span m='2791120'>I</span>
  <span m='2791260'>would</span> <span m='2791390'>get</span> <span m='2791540'>here.</span>
  <span m='2792780'>And</span> <span m='2792950'>then</span> <span m='2793160'>these</span>
  <span m='2793370'>are</span> <span m='2793460'>the</span> <span m='2793580'>two</span>
  <span m='2793790'>occurrences</span> <span m='2794300'>of</span> <span m='2794420'>a-n-a</span>
  <span m='2794675'>and</span> <span m='2794930'>they</span> <span m='2795050'>actually</span>
  <span m='2795320'>overlap</span> <span m='2795770'>each</span> <span m='2795920'>other--</span>
  <span m='2796400'>this</span> <span m='2796580'>one</span> <span m='2797270'>and</span>
  <span m='2797360'>this</span> <span m='2797540'>one.</span> <span m='2798870'>So</span>
  <span m='2798920'>this</span> <span m='2799130'>is</span> <span m='2799250'>a</span>
  <span m='2799310'>great</span> <span m='2799580'>data</span> <span m='2799820'>structure,</span>
  <span m='2800180'>it</span> <span m='2800300'>solves</span> <span m='2801320'>what</span>
  <span m='2801500'>we</span> <span m='2801590'>need.</span> <span m='2803940'>It's</span>
  <span m='2804150'>all</span> <span m='2804350'>substrings</span> <span m='2805520'>searching.</span>
  </p><p><span m='2821460'>Applications</span> <span m='2822300'>of</span> <span m='2822460'>suffix</span>
  <span m='2822870'>trees.</span> <span m='2838570'>Just</span> <span m='2838740'>do</span>
  <span m='2838950'>a</span> <span m='2839010'>search</span> <span m='2839460'>in</span>
  <span m='2839580'>the</span> <span m='2839700'>trie</span> <span m='2840090'>for</span>
  <span m='2840360'>a</span> <span m='2840400'>particular</span> <span m='2840840'>pattern.</span>
  <span m='2841860'>We</span> <span m='2841980'>get</span> <span m='2842440'>subtree</span>
  <span m='2842910'>representing</span> <span m='2843930'>all</span> <span m='2844320'>of</span>
  <span m='2844440'>the</span> <span m='2844560'>occurrences</span> <span m='2855660'>of</span>
  <span m='2855900'>P</span> <span m='2858210'>and</span> <span m='2858450'>T.</span>
  <span m='2862800'>So</span> <span m='2862950'>this</span> <span m='2863130'>is</span>
  <span m='2863220'>great.</span> <span m='2864150'>In</span> <span m='2864270'>order</span>
  <span m='2864480'>P</span> <span m='2864670'>time,</span> <span m='2865890'>walking</span>
  <span m='2866250'>down</span> <span m='2866460'>this</span> <span m='2866790'>structure,</span>
  <span m='2867690'>I</span> <span m='2867780'>can</span> <span m='2867930'>figure</span>
  <span m='2868290'>out</span> <span m='2868800'>all</span> <span m='2869010'>the</span>
  <span m='2869130'>occurrences.</span> <span m='2869820'>And</span> <span m='2870150'>then,</span>
  <span m='2870420'>if</span> <span m='2870570'>I</span> <span m='2870660'>want</span>
  <span m='2870900'>to</span> <span m='2871230'>know</span> <span m='2871410'>how</span>
  <span m='2871560'>many</span> <span m='2871830'>there</span> <span m='2871980'>were,</span>
  <span m='2872190'>I</span> <span m='2872250'>could</span> <span m='2872370'>just</span>
  <span m='2872520'>store</span> <span m='2872760'>subtree</span> <span m='2873150'>sizes--</span>
  <span m='2874110'>number</span> <span m='2874350'>of</span> <span m='2874440'>leaves</span>
  <span m='2874740'>below</span> <span m='2875040'>every</span> <span m='2875250'>node.</span>
  <span m='2875940'>If</span> <span m='2876090'>I</span> <span m='2876180'>wanted</span>
  <span m='2876450'>to</span> <span m='2877470'>list</span> <span m='2877740'>them,</span>
  <span m='2878250'>I</span> <span m='2878340'>could</span> <span m='2878490'>just</span>
  <span m='2879270'>do</span> <span m='2879450'>an</span> <span m='2879510'>in-order</span>
  <span m='2879780'>traversal.</span> <span m='2880890'>And</span> <span m='2881070'>I'll</span>
  <span m='2881190'>even</span> <span m='2881400'>get</span> <span m='2881550'>them</span>
  <span m='2881730'>in</span> <span m='2881880'>order.</span> </p><p><span m='2883230'>So</span>
  <span m='2883390'>in</span> <span m='2883470'>particular,</span> <span m='2885940'>if</span>
  <span m='2886080'>I</span> <span m='2886140'>wanted</span> <span m='2886350'>to</span>
  <span m='2886440'>list</span> <span m='2886680'>the</span> <span m='2886770'>first</span>
  <span m='2887460'>10</span> <span m='2887710'>occurrences,</span> <span m='2888900'>I</span>
  <span m='2888990'>could</span> <span m='2889140'>store</span> <span m='2890100'>the</span>
  <span m='2890250'>left-most</span> <span m='2890490'>leaf</span> <span m='2890940'>from</span>
  <span m='2891150'>every</span> <span m='2891360'>node,</span> <span m='2892050'>teleport</span>
  <span m='2892560'>down</span> <span m='2892800'>to</span> <span m='2892920'>the</span>
  <span m='2893010'>first</span> <span m='2893280'>occurrence</span> <span m='2893700'>in</span>
  <span m='2893820'>constant</span> <span m='2894160'>time.</span> <span m='2894870'>And</span>
  <span m='2895050'>then</span> <span m='2895320'>I</span> <span m='2895440'>could</span>
  <span m='2895560'>just</span> <span m='2895740'>have</span> <span m='2895920'>a</span>
  <span m='2895980'>linked</span> <span m='2896190'>list</span> <span m='2896490'>of</span>
  <span m='2896580'>all</span> <span m='2896760'>the</span> <span m='2896850'>leaves.</span>
  <span m='2897600'>So</span> <span m='2897750'>once</span> <span m='2897930'>I</span>
  <span m='2897990'>find</span> <span m='2898350'>the</span> <span m='2898530'>first</span>
  <span m='2898830'>one,</span> <span m='2899040'>I</span> <span m='2899100'>can</span>
  <span m='2899220'>just</span> <span m='2899760'>follow</span> <span m='2900240'>until</span>
  <span m='2900510'>I</span> <span m='2900600'>find,</span> <span m='2900870'>oh,</span>
  <span m='2900990'>that's</span> <span m='2901200'>not</span> <span m='2901380'>an</span>
  <span m='2901500'>occurrence</span> <span m='2901870'>of</span> <span m='2901980'>P.</span>
  </p><p><span m='2902880'>So</span> <span m='2902970'>I</span> <span m='2903030'>can</span>
  <span m='2903150'>list</span> <span m='2903300'>the</span> <span m='2903390'>first</span>
  <span m='2903630'>k</span> <span m='2903840'>of</span> <span m='2903960'>them</span>
  <span m='2904140'>in</span> <span m='2904230'>order</span> <span m='2904410'>k</span>
  <span m='2904620'>time</span> <span m='2905520'>once</span> <span m='2905760'>I've</span>
  <span m='2905880'>done</span> <span m='2906090'>the</span> <span m='2906180'>search</span>
  <span m='2906690'>of</span> <span m='2906810'>order</span> <span m='2906990'>P</span>
  <span m='2907170'>time.</span> <span m='2908160'>So</span> <span m='2908280'>this</span>
  <span m='2908430'>is</span> <span m='2908580'>really</span> <span m='2908940'>good</span>
  <span m='2909810'>searching.</span> <span m='2910110'>And</span> <span m='2910290'>It's</span>
  <span m='2910620'>the</span> <span m='2910770'>ideal</span> <span m='2911190'>situation.</span>
  <span m='2912360'>You</span> <span m='2912380'>can</span> <span m='2912510'>list</span>
  <span m='2912690'>any</span> <span m='2913230'>information</span> <span m='2913740'>you</span>
  <span m='2913830'>want</span> <span m='2914070'>about</span> <span m='2914310'>all</span>
  <span m='2914520'>of</span> <span m='2914610'>the</span> <span m='2914730'>answers</span>
  <span m='2915680'>in</span> <span m='2915960'>the</span> <span m='2916200'>optimal</span>
  <span m='2916740'>time</span> <span m='2917010'>and</span> <span m='2917340'>size
  of</span> <span m='2917670'>the</span> <span m='2917790'>output.</span> </p><p><span
  m='2920670'>How</span> <span m='2920970'>big</span> <span m='2921270'>is</span>
  <span m='2921390'>this</span> <span m='2921540'>data</span> <span m='2921780'>structure?</span>
  <span m='2923640'>Well,</span> <span m='2924870'>there</span> <span m='2925020'>are</span>
  <span m='2925080'>T</span> <span m='2925320'>suffixes,</span> <span m='2926580'>so</span>
  <span m='2926790'>k</span> <span m='2927510'>is</span> <span m='2927840'>the</span>
  <span m='2927930'>size</span> <span m='2928800'>of</span> <span m='2928920'>T.</span>
  <span m='2931008'>And</span> <span m='2931440'>when</span> <span m='2931860'>we</span>
  <span m='2931980'>look</span> <span m='2932190'>at</span> <span m='2932310'>our</span>
  <span m='2932520'>trie</span> <span m='2932820'>representations,</span> <span m='2933630'>our</span>
  <span m='2933720'>general</span> <span m='2934020'>goal</span> <span m='2934290'>was</span>
  <span m='2934470'>to</span> <span m='2934590'>get--</span> <span m='2935730'>here,</span>
  <span m='2936270'>capital</span> <span m='2936750'>T</span> <span m='2937080'>was</span>
  <span m='2938190'>the</span> <span m='2938370'>sum</span> <span m='2939060'>of</span>
  <span m='2939300'>the</span> <span m='2939420'>lengths.</span> <span m='2939990'>Well,</span>
  <span m='2940290'>sum</span> <span m='2940470'>of</span> <span m='2940530'>the</span>
  <span m='2940620'>lengths</span> <span m='2940920'>is</span> <span m='2941010'>not</span>
  <span m='2941220'>good--</span> <span m='2941400'>that</span> <span m='2941550'>would</span>
  <span m='2941640'>be</span> <span m='2941760'>quadratic--</span> <span m='2942960'>sum</span>
  <span m='2943140'>of</span> <span m='2943200'>the</span> <span m='2943260'>lengths</span>
  <span m='2943470'>of</span> <span m='2943520'>the</span> <span m='2943620'>suffixes.</span>
  </p><p><span m='2944160'>But</span> <span m='2944310'>we</span> <span m='2944460'>also</span>
  <span m='2944700'>said,</span> <span m='2944940'>or</span> <span m='2945660'>the</span>
  <span m='2945780'>number</span> <span m='2946020'>of</span> <span m='2946140'>nodes</span>
  <span m='2946470'>in</span> <span m='2946650'>the</span> <span m='2946750'>trie.</span>
  <span m='2948420'>And</span> <span m='2948780'>we</span> <span m='2949020'>know</span>
  <span m='2949350'>the</span> <span m='2949470'>number</span> <span m='2949710'>of</span>
  <span m='2949830'>leaves</span> <span m='2950220'>in</span> <span m='2950340'>this</span>
  <span m='2950490'>trie</span> <span m='2950745'>is</span> <span m='2951000'>exactly</span>
  <span m='2951510'>the</span> <span m='2951630'>size</span> <span m='2951930'>of</span>
  <span m='2952020'>T.</span> <span m='2952830'>And</span> <span m='2952950'>so</span>
  <span m='2953370'>because</span> <span m='2953760'>it's</span> <span m='2953880'>a</span>
  <span m='2954250'>compressed</span> <span m='2954870'>trie,</span> <span m='2955740'>the</span>
  <span m='2955800'>number</span> <span m='2956010'>of</span> <span m='2956070'>internal</span>
  <span m='2956320'>[INAUDIBLE]</span> <span m='2956470'>is</span> <span m='2956760'>also</span>
  <span m='2957600'>less</span> <span m='2957840'>than</span> <span m='2957960'>the</span>
  <span m='2958020'>size</span> <span m='2958320'>of</span> <span m='2958380'>T.</span>
  <span m='2958680'>So the</span> <span m='2958740'>total</span> <span m='2959040'>number</span>
  <span m='2959280'>of</span> <span m='2959370'>nodes</span> <span m='2959640'>here</span>
  <span m='2960270'>is</span> <span m='2960570'>order</span> <span m='2960860'>T</span>
  <span m='2964100'>And</span> <span m='2964230'>so</span> <span m='2964350'>if</span>
  <span m='2964440'>we</span> <span m='2964530'>use</span> <span m='2964710'>any</span>
  <span m='2964890'>of</span> <span m='2964950'>the</span> <span m='2965040'>reasonable</span>
  <span m='2965460'>representations,</span> <span m='2966750'>we</span> <span m='2966900'>get</span>
  <span m='2967140'>order</span> <span m='2967400'>T</span> <span m='2967640'>space.</span>
  </p><p><span m='2973020'>Now,</span> <span m='2973260'>there's</span> <span m='2973440'>one</span>
  <span m='2973590'>issue</span> <span m='2973890'>which</span> <span m='2974100'>is,</span>
  <span m='2974640'>how</span> <span m='2974880'>long</span> <span m='2975120'>does</span>
  <span m='2975240'>a</span> <span m='2975330'>search</span> <span m='2975630'>for</span>
  <span m='2975780'>P</span> <span m='2976020'>cost?</span> <span m='2976950'>And</span>
  <span m='2977040'>it</span> <span m='2977130'>depends</span> <span m='2977760'>on</span>
  <span m='2977850'>our</span> <span m='2977940'>representation,</span> <span m='2978630'>it</span>
  <span m='2978930'>depends</span> <span m='2979290'>how</span> <span m='2979440'>quickly</span>
  <span m='2979830'>we</span> <span m='2979950'>can</span> <span m='2980100'>traverse</span>
  <span m='2980460'>a</span> <span m='2980520'>node.</span> <span m='2981180'>If</span>
  <span m='2981330'>we</span> <span m='2981420'>use</span> <span m='2981660'>hashing--</span>
  <span m='2982860'>method</span> <span m='2983220'>3--</span> <span m='2985500'>use</span>
  <span m='2985950'>hashing,</span> <span m='2987300'>then</span> <span m='2987600'>we</span>
  <span m='2987750'>get</span> <span m='2989790'>order</span> <span m='2990120'>P</span>
  <span m='2991350'>time.</span> </p><p><span m='2995310'>But</span> <span m='2995940'>the</span>
  <span m='2996090'>trouble</span> <span m='2996420'>with</span> <span m='2996540'>hashing</span>
  <span m='2996930'>is</span> <span m='2997050'>it</span> <span m='2997350'>permutes</span>
  <span m='2998100'>the</span> <span m='2999000'>children</span> <span m='2999420'>of</span>
  <span m='2999540'>every</span> <span m='2999780'>node.</span> <span m='3000650'>So</span>
  <span m='3000800'>in</span> <span m='3000890'>that</span> <span m='3001100'>situation,</span>
  <span m='3001640'>the</span> <span m='3001700'>leaves</span> <span m='3002000'>will</span>
  <span m='3002120'>not</span> <span m='3002360'>be</span> <span m='3002540'>ordered</span>
  <span m='3003500'>in</span> <span m='3003650'>the</span> <span m='3003770'>same</span>
  <span m='3004160'>way</span> <span m='3004490'>that</span> <span m='3004610'>they're</span>
  <span m='3004730'>ordered</span> <span m='3005090'>in</span> <span m='3005240'>the</span>
  <span m='3005300'>string.</span> <span m='3005880'>So</span> <span m='3005900'>if</span>
  <span m='3006020'>you</span> <span m='3006110'>really</span> <span m='3006320'>want</span>
  <span m='3006500'>to</span> <span m='3006560'>be</span> <span m='3006620'>able</span>
  <span m='3006740'>to</span> <span m='3006830'>find</span> <span m='3007070'>the</span>
  <span m='3007160'>first</span> <span m='3007820'>five</span> <span m='3008090'>occurrences</span>
  <span m='3008630'>of</span> <span m='3008750'>the</span> <span m='3008810'>pattern</span>
  <span m='3009470'>P,</span> <span m='3009770'>you</span> <span m='3009860'>can't</span>
  <span m='3010100'>use</span> <span m='3010250'>hashing.</span> <span m='3011060'>You</span>
  <span m='3011150'>can</span> <span m='3011300'>find</span> <span m='3011600'>some</span>
  <span m='3011930'>five</span> <span m='3012200'>occurrences</span> <span m='3012680'>but</span>
  <span m='3012770'>you</span> <span m='3012830'>will</span> <span m='3012950'>find</span>
  <span m='3013190'>the</span> <span m='3013340'>first</span> <span m='3014240'>in</span>
  <span m='3014360'>the</span> <span m='3014450'>usual</span> <span m='3014840'>ordering</span>
  <span m='3015200'>of</span> <span m='3015330'>the</span> <span m='3015440'>string.</span>
  </p><p><span m='3016770'>So</span> <span m='3017630'>if</span> <span m='3017780'>you</span>
  <span m='3017900'>really</span> <span m='3018110'>want</span> <span m='3018350'>the</span>
  <span m='3018470'>first</span> <span m='3018800'>five</span> <span m='3019280'>and</span>
  <span m='3019520'>you</span> <span m='3019610'>want</span> <span m='3019790'>them</span>
  <span m='3019940'>in</span> <span m='3020030'>order,</span> <span m='3020840'>then</span>
  <span m='3021020'>you</span> <span m='3021140'>should</span> <span m='3021320'>use</span>
  <span m='3022090'>trays--</span> <span m='3023750'>this</span> <span m='3023930'>method</span>
  <span m='3025280'>6</span> <span m='3025610'>that</span> <span m='3025730'>we</span>
  <span m='3025830'>used.</span> <span m='3026100'>6?</span> <span m='3026780'>5.</span>
  <span m='3028220'>If</span> <span m='3028380'>we</span> <span m='3028590'>use</span>
  <span m='3028810'>trays,</span> <span m='3029420'>then</span> <span m='3029660'>it</span>
  <span m='3029750'>will</span> <span m='3029870'>be</span> <span m='3030140'>order</span>
  <span m='3030620'>P</span> <span m='3033050'>times</span> <span m='3034300'>log</span>
  <span m='3034770'>Sigma--</span> <span m='3038050'>sorry,</span> <span m='3038360'>order</span>
  <span m='3038640'>P</span> <span m='3038920'>plus</span> <span m='3039190'>log</span>
  <span m='3039400'>Sigma.</span> <span m='3040640'>That</span> <span m='3040760'>was</span>
  <span m='3040940'>our</span> <span m='3041976'>query</span> <span m='3042360'>time.</span>
  <span m='3043720'>Here,</span> <span m='3044000'>P</span> <span m='3044390'>plus</span>
  <span m='3044560'>log</span> <span m='3044770'>Sigma.</span> <span m='3047030'>Small</span>
  <span m='3047390'>penalty</span> <span m='3047900'>to</span> <span m='3047990'>pay</span>
  <span m='3048740'>but</span> <span m='3048950'>the</span> <span m='3049040'>nice</span>
  <span m='3049250'>thing</span> <span m='3049400'>is</span> <span m='3049520'>then</span>
  <span m='3049670'>your</span> <span m='3049790'>answers</span> <span m='3050240'>are</span>
  <span m='3050420'>represented</span> <span m='3050960'>in</span> <span m='3051110'>order.</span>
  <span m='3052310'>No</span> <span m='3052460'>permutation,</span> <span m='3053720'>no</span>
  <span m='3053900'>hashing,</span> <span m='3054320'>no</span> <span m='3054410'>randomization.</span>
  </p><p><span m='3056840'>This</span> <span m='3057050'>is</span> <span m='3057380'>the</span>
  <span m='3057500'>reason</span> <span m='3057830'>suffix</span> <span m='3058220'>trees</span>
  <span m='3058460'>were</span> <span m='3058520'>invented--</span> <span m='3058940'>they</span>
  <span m='3059090'>let</span> <span m='3059240'>you</span> <span m='3059360'>do</span>
  <span m='3059510'>searches</span> <span m='3060200'>fast.</span> <span m='3060680'>But</span>
  <span m='3060890'>actually,</span> <span m='3061220'>they</span> <span m='3061340'>let</span>
  <span m='3061460'>you</span> <span m='3061580'>do</span> <span m='3061730'>a</span>
  <span m='3061820'>ton</span> <span m='3062180'>of</span> <span m='3062300'>things</span>
  <span m='3062570'>fast.</span> <span m='3063500'>And</span> <span m='3064280'>I</span>
  <span m='3064430'>want</span> <span m='3064580'>to</span> <span m='3064670'>quickly</span>
  <span m='3065120'>give</span> <span m='3065300'>you</span> <span m='3065390'>an</span>
  <span m='3065480'>overview</span> <span m='3065930'>of</span> <span m='3066020'>the</span>
  <span m='3066140'>zillions</span> <span m='3066770'>of</span> <span m='3066860'>things</span>
  <span m='3067250'>you</span> <span m='3067370'>can</span> <span m='3067520'>do</span>
  <span m='3068120'>with</span> <span m='3068270'>the</span> <span m='3068330'>suffix</span>
  <span m='3068750'>tree.</span> <span m='3069320'>And</span> <span m='3069440'>then</span>
  <span m='3069590'>I</span> <span m='3069650'>want</span> <span m='3069800'>to</span>
  <span m='3069860'>get</span> <span m='3070010'>to</span> <span m='3070190'>how</span>
  <span m='3070340'>to</span> <span m='3070430'>build</span> <span m='3070640'>them</span>
  <span m='3070790'>in</span> <span m='3070910'>linear</span> <span m='3071180'>time,</span>
  <span m='3071860'>which</span> <span m='3072220'>has</span> <span m='3072350'>some</span>
  <span m='3072650'>interesting</span> <span m='3075260'>algorithms/data structures.</span>
  </p><p><span m='3079500'>I</span> <span m='3079560'>already</span> <span m='3079760'>talked</span>
  <span m='3080060'>about</span> <span m='3080300'>if</span> <span m='3080390'>you</span>
  <span m='3080450'>want</span> <span m='3080600'>to</span> <span m='3080660'>find</span>
  <span m='3080810'>the</span> <span m='3080900'>first</span> <span m='3081110'>k</span>
  <span m='3081290'>occurrences,</span> <span m='3081890'>you</span> <span m='3081980'>can</span>
  <span m='3082100'>do</span> <span m='3082220'>that</span> <span m='3082370'>in</span>
  <span m='3082460'>order</span> <span m='3082640'>k</span> <span m='3082820'>time.</span>
  <span m='3083150'>If</span> <span m='3083240'>you</span> <span m='3083360'>want</span>
  <span m='3083540'>to</span> <span m='3084080'>find</span> <span m='3084260'>the</span>
  <span m='3084380'>number</span> <span m='3084680'>of</span> <span m='3084770'>occurrences,</span>
  <span m='3085280'>you</span> <span m='3085370'>can</span> <span m='3085490'>do</span>
  <span m='3085580'>that</span> <span m='3085730'>in</span> <span m='3085790'>constant</span>
  <span m='3086180'>time,</span> <span m='3086390'>just</span> <span m='3086540'>by</span>
  <span m='3086690'>augmenting</span> <span m='3087140'>the</span> <span m='3087220'>subtree</span>
  <span m='3087590'>sizes.</span> </p><p><span m='3089310'>Here's</span> <span m='3089480'>another</span>
  <span m='3089750'>thing</span> <span m='3090110'>you</span> <span m='3090290'>could</span>
  <span m='3090440'>do.</span> <span m='3090590'>Suppose</span> <span m='3090980'>you</span>
  <span m='3091070'>have</span> <span m='3091250'>a</span> <span m='3091310'>very</span>
  <span m='3091670'>long</span> <span m='3092090'>string.</span> <span m='3092990'>I</span>
  <span m='3093050'>mean</span> <span m='3093170'>think</span> <span m='3093380'>of</span>
  <span m='3093500'>T</span> <span m='3093770'>as</span> <span m='3093950'>an</span>
  <span m='3094070'>entire</span> <span m='3094580'>document.</span> <span m='3095160'>You</span>
  <span m='3095260'>know, it</span> <span m='3095400'>could</span> <span m='3095570'>be</span>
  <span m='3096770'>the</span> <span m='3096980'>Merriam-Webster</span> <span m='3097670'>dictionary</span>
  <span m='3098360'>or</span> <span m='3098490'>it</span> <span m='3098540'>could</span>
  <span m='3098720'>be</span> <span m='3099470'>the</span> <span m='3099590'>web.</span>
  <span m='3101320'>We're</span> <span m='3101510'>imagining</span> <span m='3101970'>T</span>
  <span m='3102290'>to</span> <span m='3102340'>be the</span> <span m='3102560'>huge</span>
  <span m='3103580'>data</span> <span m='3103760'>structure.</span> <span m='3104250'>And</span>
  <span m='3104350'>then</span> <span m='3104420'>we're</span> <span m='3104600'>able</span>
  <span m='3104780'>to</span> <span m='3104870'>search</span> <span m='3105350'>for</span>
  <span m='3105500'>substrings</span> <span m='3106040'>within</span> <span m='3106280'>that</span>
  <span m='3106430'>data</span> <span m='3106610'>structure</span> <span m='3107000'>very</span>
  <span m='3107180'>fast.</span> <span m='3110130'>So</span> <span m='3111640'>that's</span>
  <span m='3111790'>cool.</span> </p><p><span m='3112430'>Here's</span> <span m='3112660'>an</span>
  <span m='3112750'>interesting</span> <span m='3113050'>puzzle.</span> <span m='3113680'>What</span>
  <span m='3113920'>is</span> <span m='3114130'>the</span> <span m='3114580'>longest</span>
  <span m='3115920'>substring--</span> <span m='3116680'>what</span> <span m='3116860'>is</span>
  <span m='3116950'>the</span> <span m='3117070'>longest</span> <span m='3117400'>string</span>
  <span m='3117670'>that</span> <span m='3117790'>appears</span> <span m='3118210'>twice</span>
  <span m='3118750'>on</span> <span m='3118930'>the</span> <span m='3119050'>web?</span>
  <span m='3120280'>This</span> <span m='3120430'>is</span> <span m='3120520'>called</span>
  <span m='3120760'>the</span> <span m='3120850'>longest</span> <span m='3121240'>repeated</span>
  <span m='3121660'>substring.</span> <span m='3122260'>Could</span> <span m='3122410'>be</span>
  <span m='3122560'>overlapping,</span> <span m='3123250'>maybe</span> <span m='3123460'>not.</span>
  <span m='3124610'>Well,</span> <span m='3125150'>you</span> <span m='3125470'>take</span>
  <span m='3125740'>the</span> <span m='3125830'>web,</span> <span m='3126100'>you</span>
  <span m='3126160'>throw</span> <span m='3126430'>it</span> <span m='3126520'>in</span>
  <span m='3126610'>the</span> <span m='3126670'>suffix</span> <span m='3127060'>tree--</span>
  <span m='3127690'>not</span> <span m='3127810'>sure</span> <span m='3127990'>anyone</span>
  <span m='3128260'>could</span> <span m='3128680'>actually</span> <span m='3129010'>do</span>
  <span m='3129130'>that--</span> <span m='3129500'>but</span> <span m='3129970'>small</span>
  <span m='3130600'>part</span> <span m='3130870'>of</span> <span m='3131040'>the</span>
  <span m='3131200'>web.</span> <span m='3131770'>Dictionary--</span> <span m='3132340'>this</span>
  <span m='3132700'>would</span> <span m='3132820'>be</span> <span m='3132910'>no</span>
  <span m='3133060'>problem.</span> <span m='3137260'>Wikipedia</span> <span m='3137860'>would</span>
  <span m='3138010'>be</span> <span m='3138100'>feasible.</span> <span m='3138560'>You</span>
  <span m='3138610'>take</span> <span m='3138790'>Wikipedia,</span> <span m='3139330'>you</span>
  <span m='3139450'>throw</span> <span m='3139720'>it</span> <span m='3140130'>in</span>
  <span m='3140200'>the</span> <span m='3140260'>suffix</span> <span m='3140620'>tree.</span>
  </p><p><span m='3141280'>And</span> <span m='3143350'>what</span> <span m='3143530'>I'm</span>
  <span m='3143620'>interested</span> <span m='3144010'>in</span> <span m='3144160'>is,</span>
  <span m='3144280'>basically,</span> <span m='3144820'>a</span> <span m='3144910'>node</span>
  <span m='3146030'>that</span> <span m='3146200'>has</span> <span m='3146560'>two,</span>
  <span m='3147460'>at</span> <span m='3147580'>least</span> <span m='3147790'>two</span>
  <span m='3148000'>descendant</span> <span m='3148430'>leaves.</span> <span m='3149230'>And</span>
  <span m='3149320'>if</span> <span m='3149440'>I'm</span> <span m='3149560'>counting</span>
  <span m='3149980'>the</span> <span m='3150040'>number</span> <span m='3150280'>of</span>
  <span m='3150340'>leaves</span> <span m='3150580'>at</span> <span m='3150670'>every</span>
  <span m='3151390'>node,</span> <span m='3151750'>I</span> <span m='3151810'>could</span>
  <span m='3151930'>just</span> <span m='3152080'>do</span> <span m='3152320'>one</span>
  <span m='3152560'>pass</span> <span m='3152950'>over</span> <span m='3153130'>this</span>
  <span m='3153280'>data</span> <span m='3153490'>structure</span> <span m='3153790'>and</span>
  <span m='3153880'>find</span> <span m='3154510'>what</span> <span m='3154750'>are</span>
  <span m='3154810'>all</span> <span m='3154930'>the</span> <span m='3155050'>nodes</span>
  <span m='3155260'>that</span> <span m='3155380'>have</span> <span m='3155560'>at</span>
  <span m='3155650'>least</span> <span m='3155890'>two</span> <span m='3156120'>descendant</span>
  <span m='3156520'>leaves.</span> <span m='3156820'>That's</span> <span m='3157210'>all</span>
  <span m='3157450'>the</span> <span m='3157570'>internal</span> <span m='3157930'>nodes.</span>
  </p><p><span m='3159520'>And</span> <span m='3159640'>then</span> <span m='3159760'>among</span>
  <span m='3160060'>them</span> <span m='3160240'>I'd</span> <span m='3160450'>also</span>
  <span m='3160780'>like</span> <span m='3160990'>to</span> <span m='3161110'>know</span>
  <span m='3161290'>how</span> <span m='3161620'>deep</span> <span m='3162010'>is</span>
  <span m='3162160'>it.</span> <span m='3162280'>Because</span> <span m='3162580'>the</span>
  <span m='3162700'>depth</span> <span m='3163120'>corresponds</span> <span m='3163930'>to</span>
  <span m='3165040'>how</span> <span m='3165250'>long</span> <span m='3165550'>the</span>
  <span m='3165640'>string</span> <span m='3165940'>is.</span> <span m='3166330'>This</span>
  <span m='3166540'>one</span> <span m='3166780'>is</span> <span m='3166930'>a-n-a</span>
  <span m='3167285'>so</span> <span m='3167640'>this</span> <span m='3167830'>one</span>
  <span m='3168010'>has,</span> <span m='3168280'>I</span> <span m='3168670'>call</span>
  <span m='3168850'>it,</span> <span m='3168910'>a</span> <span m='3168970'>letter</span>
  <span m='3169270'>depth</span> <span m='3169630'>of</span> <span m='3169750'>3.</span>
  <span m='3171070'>This</span> <span m='3171260'>one</span> <span m='3171370'>has</span>
  <span m='3171520'>a</span> <span m='3171550'>letter</span> <span m='3171730'>depth</span>
  <span m='3171940'>of</span> <span m='3172060'>1.</span> <span m='3172410'>This</span>
  <span m='3172540'>one</span> <span m='3172660'>has</span> <span m='3172810'>a</span>
  <span m='3172840'>letter</span> <span m='3173020'>depth</span> <span m='3173230'>of</span>
  <span m='3173350'>2.</span> <span m='3173980'>So</span> <span m='3174100'>I</span>
  <span m='3174160'>just</span> <span m='3174310'>want</span> <span m='3174460'>to</span>
  <span m='3174520'>find</span> <span m='3174700'>the</span> <span m='3174790'>deepest</span>
  <span m='3175180'>node</span> <span m='3175420'>that</span> <span m='3175540'>has</span>
  <span m='3175750'>at</span> <span m='3175840'>least</span> <span m='3176050'>two</span>
  <span m='3176590'>descendant</span> <span m='3176890'>leaves.</span> </p><p><span
  m='3177130'>In</span> <span m='3177250'>linear</span> <span m='3177580'>time,</span>
  <span m='3178330'>I</span> <span m='3178420'>could</span> <span m='3178540'>find</span>
  <span m='3178780'>the</span> <span m='3178840'>longest</span> <span m='3179230'>repeated</span>
  <span m='3179560'>substring.</span> <span m='3180380'>Or</span> <span m='3180580'>I</span>
  <span m='3180610'>could</span> <span m='3180730'>find</span> <span m='3180940'>the</span>
  <span m='3181000'>longest</span> <span m='3181330'>substring</span> <span m='3181780'>that</span>
  <span m='3181900'>appears</span> <span m='3182200'>five</span> <span m='3182470'>times</span>
  <span m='3182830'>or</span> <span m='3182920'>whatever.</span> <span m='3183520'>I</span>
  <span m='3183580'>just</span> <span m='3184240'>do</span> <span m='3184450'>one</span>
  <span m='3184660'>pass</span> <span m='3185020'>over</span> <span m='3185170'>this</span>
  <span m='3185320'>thing,</span> <span m='3185530'>find</span> <span m='3185710'>the</span>
  <span m='3185800'>deepest</span> <span m='3186130'>node</span> <span m='3186310'>that</span>
  <span m='3186430'>has</span> <span m='3186610'>my</span> <span m='3186760'>threshold</span>
  <span m='3187300'>of</span> <span m='3187510'>leaves.</span> <span m='3188530'>So</span>
  <span m='3188620'>that's</span> <span m='3188770'>kind</span> <span m='3188920'>of</span>
  <span m='3189010'>a</span> <span m='3189070'>neat</span> <span m='3189250'>thing</span>
  <span m='3189460'>you</span> <span m='3189580'>can</span> <span m='3189670'>do</span>
  <span m='3189790'>in</span> <span m='3189880'>linear</span> <span m='3190390'>time</span>
  <span m='3190930'>on</span> <span m='3191080'>a</span> <span m='3191140'>string.</span>
  </p><p><span m='3194780'>Here's</span> <span m='3194990'>another</span> <span m='3195230'>fun</span>
  <span m='3195440'>one.</span> <span m='3196580'>Suppose</span> <span m='3197180'>I</span>
  <span m='3197270'>have</span> <span m='3197450'>this</span> <span m='3197600'>giant</span>
  <span m='3197960'>string.</span> <span m='3198920'>And</span> <span m='3199100'>I</span>
  <span m='3199190'>just</span> <span m='3199370'>want</span> <span m='3199520'>to</span>
  <span m='3199580'>compare</span> <span m='3200180'>two</span> <span m='3200450'>substrings</span>
  <span m='3201080'>in</span> <span m='3201200'>it.</span> <span m='3201930'>So</span>
  <span m='3203480'>here's</span> <span m='3203720'>my</span> <span m='3203990'>giant</span>
  <span m='3204440'>string.</span> <span m='3205730'>And</span> <span m='3206780'>suppose</span>
  <span m='3207200'>I</span> <span m='3207410'>want</span> <span m='3207560'>to</span>
  <span m='3207650'>measure</span> <span m='3207980'>how</span> <span m='3208250'>long</span>
  <span m='3208730'>is</span> <span m='3208880'>the</span> <span m='3208950'>repeated</span>
  <span m='3209360'>substring.</span> <span m='3210290'>So</span> <span m='3210380'>I</span>
  <span m='3210420'>say,</span> <span m='3210740'>well,</span> <span m='3210930'>I've</span>
  <span m='3210950'>got</span> <span m='3211130'>position</span> <span m='3211580'>i,</span>
  <span m='3211940'>I've</span> <span m='3212420'>got</span> <span m='3212630'>position</span>
  <span m='3213050'>j.</span> <span m='3213220'>Let's</span> <span m='3213380'>say</span>
  <span m='3213570'>I</span> <span m='3213830'>already</span> <span m='3214070'>know</span>
  <span m='3214250'>that</span> <span m='3214370'>they</span> <span m='3214490'>match</span>
  <span m='3214790'>for</span> <span m='3214910'>a</span> <span m='3214940'>little</span>
  <span m='3215150'>bit.</span> <span m='3215360'>I</span> <span m='3215450'>want</span>
  <span m='3215630'>to</span> <span m='3215690'>know,</span> <span m='3216110'>how</span>
  <span m='3216350'>long</span> <span m='3216620'>do</span> <span m='3216740'>they</span>
  <span m='3216890'>match?</span> <span m='3217220'>How</span> <span m='3217580'>far</span>
  <span m='3218000'>can</span> <span m='3218150'>I</span> <span m='3218210'>go</span>
  <span m='3218390'>to</span> <span m='3218480'>the</span> <span m='3218570'>right</span>
  <span m='3219260'>and</span> <span m='3219410'>have</span> <span m='3219680'>them</span>
  <span m='3220040'>still</span> <span m='3220310'>match?</span> </p><p><span m='3223310'>How</span>
  <span m='3223430'>could</span> <span m='3223580'>I</span> <span m='3223670'>do</span>
  <span m='3223820'>that?</span> <span m='3224050'>Well,</span> <span m='3224600'>I</span>
  <span m='3224690'>could</span> <span m='3224870'>look</span> <span m='3225020'>at</span>
  <span m='3225080'>the</span> <span m='3225170'>suffix</span> <span m='3225530'>starting</span>
  <span m='3225920'>at</span> <span m='3226040'>i.</span> <span m='3226580'>That</span>
  <span m='3226760'>corresponds</span> <span m='3227330'>to</span> <span m='3227450'>a</span>
  <span m='3227510'>leaf</span> <span m='3227840'>over</span> <span m='3228050'>here.</span>
  <span m='3228510'>And</span> <span m='3228770'>I</span> <span m='3228830'>could</span>
  <span m='3228980'>look</span> <span m='3229130'>at</span> <span m='3229190'>the</span>
  <span m='3229280'>suffix</span> <span m='3230210'>starting</span> <span m='3230570'>at</span>
  <span m='3230660'>j.</span> <span m='3231380'>That</span> <span m='3231500'>corresponds</span>
  <span m='3232040'>to</span> <span m='3232130'>some</span> <span m='3232340'>other</span>
  <span m='3232550'>leaf.</span> <span m='3235100'>And</span> <span m='3235550'>what</span>
  <span m='3235940'>is</span> <span m='3236210'>the</span> <span m='3236420'>length</span>
  <span m='3236810'>of</span> <span m='3236900'>the</span> <span m='3237020'>longest</span>
  <span m='3237500'>common</span> <span m='3237890'>prefix</span> <span m='3239000'>of</span>
  <span m='3239150'>those</span> <span m='3239360'>two</span> <span m='3239510'>suffixes</span>
  <span m='3241660'>in</span> <span m='3241850'>the</span> <span m='3241930'>suffix</span>
  <span m='3242350'>tree?</span> </p><p><span m='3247040'>Three</span> <span m='3247400'>letters--</span>
  <span m='3250020'>LCA.</span> <span m='3252150'>If</span> <span m='3252340'>I</span>
  <span m='3252430'>take</span> <span m='3252760'>the</span> <span m='3252910'>LCA</span>
  <span m='3253480'>of</span> <span m='3253600'>those</span> <span m='3253810'>two</span>
  <span m='3253990'>leaves--</span> <span m='3254470'>for</span> <span m='3254560'>example,</span>
  <span m='3256110'>I</span> <span m='3256210'>take</span> <span m='3256750'>these</span>
  <span m='3257140'>two</span> <span m='3257500'>leaves--</span> <span m='3259270'>the</span>
  <span m='3259510'>LCA</span> <span m='3260140'>gives</span> <span m='3260410'>me</span>
  <span m='3260710'>the</span> <span m='3260800'>longest</span> <span m='3261220'>common</span>
  <span m='3261520'>prefix.</span> <span m='3261970'>Then</span> <span m='3262180'>they</span>
  <span m='3262300'>branch.</span> <span m='3263500'>So</span> <span m='3263650'>longest</span>
  <span m='3263980'>common</span> <span m='3264220'>prefix</span> <span m='3264610'>of</span>
  <span m='3264700'>these</span> <span m='3264940'>two</span> <span m='3265180'>suffixes</span>
  <span m='3265780'>is</span> <span m='3266140'>the</span> <span m='3266260'>letter</span>
  <span m='3266550'>a,</span> <span m='3266800'>so</span> <span m='3266960'>it's</span>
  <span m='3267030'>just</span> <span m='3267190'>length</span> <span m='3267460'>1.</span>
  <span m='3268360'>And</span> <span m='3268480'>again,</span> <span m='3268690'>if</span>
  <span m='3268810'>I</span> <span m='3268900'>label</span> <span m='3269260'>every</span>
  <span m='3269470'>node</span> <span m='3269710'>with</span> <span m='3269890'>the</span>
  <span m='3269980'>letter</span> <span m='3270190'>depth,</span> <span m='3271030'>I</span>
  <span m='3271120'>can</span> <span m='3271270'>figure</span> <span m='3271540'>out</span>
  <span m='3271660'>exactly</span> <span m='3272170'>how</span> <span m='3272410'>long</span>
  <span m='3272650'>these</span> <span m='3272830'>guys</span> <span m='3273040'>match,</span>
  <span m='3273340'>even</span> <span m='3273610'>if</span> <span m='3273730'>they</span>
  <span m='3273880'>overlap.</span> </p><p><span m='3275450'>So</span> <span m='3275530'>in</span>
  <span m='3275800'>constant</span> <span m='3276370'>time--</span> <span m='3276670'>because</span>
  <span m='3276850'>we</span> <span m='3276940'>already</span> <span m='3277150'>have</span>
  <span m='3277360'>a</span> <span m='3277420'>constant</span> <span m='3277870'>time</span>
  <span m='3278110'>LCA</span> <span m='3278500'>query.</span> <span m='3279670'>Linear</span>
  <span m='3279940'>space,</span> <span m='3280360'>constant</span> <span m='3280750'>time</span>
  <span m='3280930'>query.</span> <span m='3281590'>Given</span> <span m='3281830'>any</span>
  <span m='3282040'>two</span> <span m='3282220'>positions</span> <span m='3282640'>i</span>
  <span m='3282730'>and j,</span> <span m='3283000'>I can</span> <span m='3283120'>tell</span>
  <span m='3283270'>you</span> <span m='3283390'>how</span> <span m='3283600'>long</span>
  <span m='3283810'>they</span> <span m='3283900'>match</span> <span m='3284170'>for</span>
  <span m='3284380'>in</span> <span m='3284530'>constant</span> <span m='3285010'>time.</span>
  <span m='3285280'>Boom--</span> <span m='3286270'>instantaneously.</span> <span
  m='3287740'>It's</span> <span m='3287830'>kind</span> <span m='3287980'>of</span>
  <span m='3288040'>crazy.</span> <span m='3288340'>So</span> <span m='3288460'>you</span>
  <span m='3288580'>can</span> <span m='3288730'>do</span> <span m='3288850'>tons</span>
  <span m='3289180'>of</span> <span m='3289240'>these</span> <span m='3289420'>queries</span>
  <span m='3290380'>instantly.</span> <span m='3291310'>That's</span> <span m='3291520'>one</span>
  <span m='3291670'>reason</span> <span m='3291970'>why</span> <span m='3292120'>people</span>
  <span m='3292390'>care</span> <span m='3292510'>about</span> <span m='3292720'>LCAs,</span>
  <span m='3293830'>there</span> <span m='3294010'>are</span> <span m='3294100'>other</span>
  <span m='3294280'>reasons.</span> <span m='3294770'>But</span> <span m='3295720'>mostly</span>
  <span m='3296620'>LCAs</span> <span m='3297010'>were</span> <span m='3297130'>developed</span>
  <span m='3297550'>for</span> <span m='3297880'>suffix</span> <span m='3298300'>trees</span>
  <span m='3298630'>to</span> <span m='3298750'>answer</span> <span m='3299050'>queries</span>
  <span m='3299410'>like</span> <span m='3299620'>that.</span> </p><p><span m='3302650'>Got</span>
  <span m='3302800'>some</span> <span m='3302950'>more.</span> <span m='3308940'>Why</span>
  <span m='3309040'>don't</span> <span m='3309320'>I</span> <span m='3309450'>just</span>
  <span m='3309690'>write--</span> <span m='3311010'>LCP</span> <span m='3312750'>of</span>
  <span m='3313410'>one</span> <span m='3313680'>suffix</span> <span m='3315540'>and</span>
  <span m='3315690'>another</span> <span m='3316050'>suffix</span> <span m='3319620'>is</span>
  <span m='3319980'>equivalent</span> <span m='3320490'>to</span> <span m='3320730'>an</span>
  <span m='3320850'>LCA</span> <span m='3321390'>query.</span> <span m='3322250'>And</span>
  <span m='3322380'>so</span> <span m='3322560'>we</span> <span m='3322650'>can</span>
  <span m='3322800'>do</span> <span m='3322890'>that</span> <span m='3323580'>in</span>
  <span m='3323720'>constant</span> <span m='3324210'>time</span> <span m='3325050'>after</span>
  <span m='3325360'>pre-processing.</span> </p><p><span m='3338600'>Here's</span>
  <span m='3338900'>another</span> <span m='3339170'>one.</span> <span m='3339920'>Suppose</span>
  <span m='3340460'>I</span> <span m='3340550'>want</span> <span m='3340700'>to</span>
  <span m='3340790'>find</span> <span m='3341270'>all</span> <span m='3342470'>occurrences</span>
  <span m='3347620'>of</span> <span m='3349850'>T</span> <span m='3351124'>i</span>
  <span m='3351506'>to</span> <span m='3351890'>j.</span> <span m='3355810'>So</span>
  <span m='3355990'>I</span> <span m='3356260'>give</span> <span m='3356560'>you</span>
  <span m='3356680'>a</span> <span m='3356740'>substring</span> <span m='3357310'>and</span>
  <span m='3357400'>I</span> <span m='3357490'>want</span> <span m='3357670'>to</span>
  <span m='3357730'>know</span> <span m='3358540'>where</span> <span m='3358780'>does</span>
  <span m='3358960'>that</span> <span m='3359050'>occur.</span> <span m='3360070'>The</span>
  <span m='3360190'>substring</span> <span m='3360760'>is</span> <span m='3360910'>restricted</span>
  <span m='3361570'>to</span> <span m='3361720'>come</span> <span m='3362020'>from</span>
  <span m='3362290'>the</span> <span m='3362410'>text.</span> </p><p><span m='3363800'>Now,</span>
  <span m='3363820'>this</span> <span m='3364030'>is</span> <span m='3364210'>a</span>
  <span m='3364270'>little</span> <span m='3364510'>subtle.</span> <span m='3365080'>Of</span>
  <span m='3365170'>course,</span> <span m='3365480'>I</span> <span m='3365580'>could</span>
  <span m='3365650'>solve</span> <span m='3366040'>it in</span> <span m='3366160'>j</span>
  <span m='3366370'>minus</span> <span m='3366760'>i</span> <span m='3367150'>plus</span>
  <span m='3367420'>1</span> <span m='3367660'>time.</span> <span m='3368860'>I</span>
  <span m='3368950'>just</span> <span m='3369250'>do</span> <span m='3369430'>the</span>
  <span m='3369520'>search.</span> <span m='3370660'>But</span> <span m='3370780'>what</span>
  <span m='3370930'>if</span> <span m='3371050'>I</span> <span m='3371140'>want</span>
  <span m='3371320'>to</span> <span m='3371380'>do</span> <span m='3371560'>it</span>
  <span m='3371650'>in</span> <span m='3372190'>constant</span> <span m='3372730'>time?</span>
  </p><p><span m='3374470'>Maybe</span> <span m='3374740'>this</span> <span m='3374890'>is</span>
  <span m='3375010'>a</span> <span m='3375070'>really</span> <span m='3375430'>big</span>
  <span m='3375610'>substring.</span> <span m='3376435'>But</span> <span m='3376480'>I</span>
  <span m='3376570'>still</span> <span m='3376810'>know</span> <span m='3376990'>it</span>
  <span m='3377080'>appears</span> <span m='3377410'>multiple</span> <span m='3377770'>times.</span>
  <span m='3378740'>I</span> <span m='3378840'>want</span> <span m='3378880'>to</span>
  <span m='3378940'>know</span> <span m='3379090'>how</span> <span m='3379240'>many</span>
  <span m='3379420'>times</span> <span m='3379690'>does</span> <span m='3379810'>it</span>
  <span m='3379900'>appear.</span> <span m='3381120'>I</span> <span m='3381250'>claim</span>
  <span m='3381610'>I</span> <span m='3381670'>can</span> <span m='3381820'>do</span>
  <span m='3381880'>this</span> <span m='3382060'>in</span> <span m='3382180'>constant</span>
  <span m='3382590'>time.</span> <span m='3384100'>How?</span> </p><p><span m='3386320'>This</span>
  <span m='3386620'>is</span> <span m='3387450'>a</span> <span m='3387540'>level</span>
  <span m='3387880'>ancestor</span> <span m='3388390'>query.</span> <span m='3390040'>Why</span>
  <span m='3390390'>is</span> <span m='3390520'>it</span> <span m='3390610'>a</span>
  <span m='3390670'>level</span> <span m='3390970'>ancestor</span> <span m='3391420'>query?</span>
  <span m='3392050'>If</span> <span m='3392260'>I</span> <span m='3392410'>look</span>
  <span m='3392740'>at</span> <span m='3393610'>the</span> <span m='3393810'>suffix</span>
  <span m='3394270'>starting</span> <span m='3394720'>at</span> <span m='3394900'>i,</span>
  <span m='3395380'>and</span> <span m='3395470'>then</span> <span m='3395590'>I</span>
  <span m='3395650'>just</span> <span m='3395830'>want</span> <span m='3395950'>to</span>
  <span m='3396040'>trim</span> <span m='3396400'>off,</span> <span m='3397150'>I</span>
  <span m='3397240'>want</span> <span m='3397360'>to</span> <span m='3397450'>stop.</span>
  <span m='3398470'>Or</span> <span m='3398800'>I</span> <span m='3398890'>don't</span>
  <span m='3399130'>care</span> <span m='3399310'>about</span> <span m='3399460'>the</span>
  <span m='3399550'>entire</span> <span m='3400030'>suffix,</span> <span m='3400510'>I</span>
  <span m='3400600'>just</span> <span m='3400780'>want</span> <span m='3400950'>to</span>
  <span m='3401770'>do</span> <span m='3402130'>that</span> <span m='3402410'>j.</span>
  </p><p><span m='3403330'>It's</span> <span m='3403540'>like</span> <span m='3403750'>saying,</span>
  <span m='3404020'>well,</span> <span m='3404890'>suppose</span> <span m='3405250'>I'm</span>
  <span m='3405340'>looking</span> <span m='3405580'>for</span> <span m='3405760'>occurrences</span>
  <span m='3406210'>of</span> <span m='3406330'>a-n-a.</span> <span m='3407590'>So</span>
  <span m='3407710'>I</span> <span m='3407800'>go</span> <span m='3408040'>and</span>
  <span m='3408940'>I</span> <span m='3409060'>start</span> <span m='3409510'>at</span>
  <span m='3410050'>the</span> <span m='3410140'>first</span> <span m='3410380'>occurrence</span>
  <span m='3410650'>of</span> <span m='3411010'>a-n-a,</span> <span m='3411520'>which</span>
  <span m='3411670'>is</span> <span m='3411790'>a-n-a-n-a-$,</span> <span m='3413170'>so</span>
  <span m='3413620'>this</span> <span m='3413770'>is</span> <span m='3413920'>the</span>
  <span m='3414010'>leaf</span> <span m='3414430'>corresponding</span> <span m='3414930'>to</span>
  <span m='3415363'>a-n-a.</span> <span m='3416230'>And</span> <span m='3416320'>then</span>
  <span m='3416440'>if</span> <span m='3416560'>I</span> <span m='3416620'>want</span>
  <span m='3416800'>to</span> <span m='3416860'>find</span> <span m='3417070'>all</span>
  <span m='3417310'>occurrences</span> <span m='3417760'>of</span> <span m='3417880'>a-n-a,</span>
  <span m='3418140'>I</span> <span m='3418280'>just</span> <span m='3418420'>need</span>
  <span m='3418570'>to</span> <span m='3418660'>go</span> <span m='3419200'>up</span>
  <span m='3420310'>to</span> <span m='3420490'>the</span> <span m='3420670'>ancestor</span>
  <span m='3421330'>that</span> <span m='3421450'>represents</span> <span m='3422020'>a-n-a.</span>
  </p><p><span m='3423910'>This</span> <span m='3424120'>is</span> <span m='3424240'>what</span>
  <span m='3424420'>I</span> <span m='3424540'>call</span> <span m='3425970'>a</span>
  <span m='3426100'>weighted</span> <span m='3427930'>level</span> <span m='3428230'>ancestor.</span>
  <span m='3429800'>That's</span> <span m='3429910'>not</span> <span m='3430090'>quite</span>
  <span m='3430510'>the</span> <span m='3430630'>problem</span> <span m='3430900'>we</span>
  <span m='3431020'>solved</span> <span m='3431370'>in</span> <span m='3431440'>the</span>
  <span m='3431500'>last</span> <span m='3431740'>lecture,</span> <span m='3433900'>lecture</span>
  <span m='3434260'>15,</span> <span m='3436360'>because</span> <span m='3436720'>now</span>
  <span m='3436990'>it's</span> <span m='3437170'>weighted.</span> <span m='3438490'>So</span>
  <span m='3438730'>it's</span> <span m='3439930'>level</span> <span m='3440200'>ancestor</span>
  <span m='3440800'>j</span> <span m='3441290'>minus</span> <span m='3441760'>i</span>
  <span m='3443300'>of</span> <span m='3444480'>the</span> <span m='3444820'>T</span>
  <span m='3444950'>i</span> <span m='3445427'>suffix</span> <span m='3446860'>leaf.</span>
  <span m='3448620'>So</span> <span m='3448720'>I</span> <span m='3448810'>find</span>
  <span m='3449080'>this</span> <span m='3449260'>leaf,</span> <span m='3449540'>which</span>
  <span m='3449800'>I</span> <span m='3449860'>just</span> <span m='3450040'>have</span>
  <span m='3450160'>an</span> <span m='3450250'>array</span> <span m='3450550'>of</span>
  <span m='3450850'>all</span> <span m='3451000'>the</span> <span m='3451120'>leaves.</span>
  <span m='3451450'>Given</span> <span m='3451780'>a</span> <span m='3451990'>suffix,</span>
  <span m='3452500'>tell</span> <span m='3452680'>me</span> <span m='3452800'>what</span>
  <span m='3452950'>leaf</span> <span m='3453190'>it</span> <span m='3453280'>is</span>
  <span m='3453430'>in</span> <span m='3453520'>the</span> <span m='3453580'>suffix</span>
  <span m='3453970'>tree.</span> </p><p><span m='3454780'>And</span> <span m='3454870'>then</span>
  <span m='3454990'>I</span> <span m='3455050'>want</span> <span m='3455200'>to</span>
  <span m='3455260'>find</span> <span m='3455470'>the</span> <span m='3455530'>j</span>
  <span m='3455740'>minus</span> <span m='3456040'>i-th</span> <span m='3456310'>ancestor,</span>
  <span m='3456820'>except</span> <span m='3457570'>the</span> <span m='3457720'>edges</span>
  <span m='3458080'>don't</span> <span m='3458290'>just</span> <span m='3458500'>have</span>
  <span m='3458710'>unit</span> <span m='3459040'>length.</span> <span m='3459820'>So</span>
  <span m='3459940'>here</span> <span m='3460120'>I</span> <span m='3460210'>want</span>
  <span m='3460360'>to</span> <span m='3460450'>find</span> <span m='3460870'>the</span>
  <span m='3461260'>third</span> <span m='3461620'>ancestor,</span> <span m='3462160'>except</span>
  <span m='3462460'>it's</span> <span m='3462580'>really</span> <span m='3463000'>the</span>
  <span m='3463180'>ancestor</span> <span m='3463720'>in</span> <span m='3463810'>the</span>
  <span m='3463900'>compressed</span> <span m='3464320'>trie.</span> <span m='3465190'>I</span>
  <span m='3465310'>want</span> <span m='3465570'>to</span> <span m='3465670'>do</span>
  <span m='3465880'>the</span> <span m='3466000'>j</span> <span m='3466180'>minus</span>
  <span m='3466530'>i-th</span> <span m='3466720'>ancestor</span> <span m='3467240'>in</span>
  <span m='3467440'>the</span> <span m='3467560'>suffix</span> <span m='3468460'>in</span>
  <span m='3468580'>the</span> <span m='3468670'>trie,</span> <span m='3469630'>but</span>
  <span m='3469780'>what</span> <span m='3469900'>I</span> <span m='3469990'>have</span>
  <span m='3470380'>is</span> <span m='3470500'>a</span> <span m='3470560'>compressed</span>
  <span m='3471010'>tree.</span> <span m='3471850'>And</span> <span m='3471970'>so</span>
  <span m='3472570'>these</span> <span m='3472810'>edges</span> <span m='3473260'>are</span>
  <span m='3473410'>labeled</span> <span m='3473890'>with</span> <span m='3474040'>how</span>
  <span m='3474220'>many</span> <span m='3474430'>characters</span> <span m='3474880'>are</span>
  <span m='3474970'>on</span> <span m='3475120'>them</span> <span m='3475920'>and
  I</span> <span m='3476030'>got</span> <span m='3476150'>to</span> <span m='3476210'>deal</span>
  <span m='3476440'>with</span> <span m='3476560'>that.</span> </p><p><span m='3478000'>Fortunately,</span>
  <span m='3478690'>the</span> <span m='3478810'>data</span> <span m='3479050'>structure</span>
  <span m='3479440'>we</span> <span m='3479590'>gave</span> <span m='3479920'>for</span>
  <span m='3480170'>a</span> <span m='3480190'>level</span> <span m='3480460'>ancestor--</span>
  <span m='3480980'>which</span> <span m='3481030'>was</span> <span m='3481150'>constant</span>
  <span m='3481450'>time</span> <span m='3481750'>query,</span> <span m='3481990'>linear</span>
  <span m='3482290'>space--</span> <span m='3483040'>can</span> <span m='3483250'>be</span>
  <span m='3483370'>fairly</span> <span m='3483700'>easily</span> <span m='3484120'>adapted</span>
  <span m='3484540'>to</span> <span m='3484700'>weights.</span> <span m='3488170'>Not</span>
  <span m='3488440'>quite</span> <span m='3488710'>in</span> <span m='3488800'>constant</span>
  <span m='3489170'>time</span> <span m='3489410'>though.</span> <span m='3490710'>It</span>
  <span m='3490930'>can</span> <span m='3491080'>be</span> <span m='3491200'>solved</span>
  <span m='3491650'>in</span> <span m='3492400'>log</span> <span m='3492700'>log</span>
  <span m='3493080'>n</span> <span m='3493180'>time.</span> </p><p><span m='3494860'>And</span>
  <span m='3494980'>I</span> <span m='3495070'>think</span> <span m='3495430'>that's</span>
  <span m='3495820'>optimal.</span> <span m='3497440'>Because</span> <span m='3499090'>if</span>
  <span m='3499270'>your</span> <span m='3499600'>thing</span> <span m='3499900'>is</span>
  <span m='3500050'>a</span> <span m='3500140'>single</span> <span m='3500500'>path</span>
  <span m='3502870'>with</span> <span m='3503080'>maybe</span> <span m='3503710'>the</span>
  <span m='3503860'>occasional</span> <span m='3504370'>branch,</span> <span m='3505870'>then</span>
  <span m='3506290'>finding</span> <span m='3507520'>your</span> <span m='3507670'>i-th</span>
  <span m='3507910'>ancestor</span> <span m='3508450'>here</span> <span m='3508720'>is</span>
  <span m='3508870'>like</span> <span m='3509050'>solving</span> <span m='3509380'>a</span>
  <span m='3509440'>predecessor</span> <span m='3510040'>problem.</span> <span m='3511430'>Because</span>
  <span m='3511600'>you</span> <span m='3511690'>say,</span> <span m='3512050'>well,</span>
  <span m='3514570'>from</span> <span m='3514750'>the</span> <span m='3514840'>i-th</span>
  <span m='3515110'>position</span> <span m='3515590'>up,</span> <span m='3516190'>I</span>
  <span m='3516280'>want</span> <span m='3516490'>to</span> <span m='3516550'>know</span>
  <span m='3516790'>what</span> <span m='3517030'>is</span> <span m='3517240'>the</span>
  <span m='3517690'>previous--</span> <span m='3520150'>I</span> <span m='3520270'>want</span>
  <span m='3520420'>to</span> <span m='3520480'>round</span> <span m='3520810'>up
  or</span> <span m='3520990'>round</span> <span m='3521320'>down.</span> <span m='3521980'>So</span>
  <span m='3522100'>I</span> <span m='3522130'>want</span> <span m='3522260'>to</span>
  <span m='3522330'>do a</span> <span m='3522430'>predecessor</span> <span m='3523030'>or
  a</span> <span m='3523150'>successor</span> <span m='3523720'>on</span> <span m='3523930'>this</span>
  <span m='3524650'>straight</span> <span m='3524920'>line.</span> <span m='3525600'>And</span>
  <span m='3525820'>so for a</span> <span m='3526300'>predecessor</span> <span m='3526870'>you</span>
  <span m='3526990'>need</span> <span m='3527200'>log</span> <span m='3527440'>log</span>
  <span m='3528320'>time</span> <span m='3530710'>for</span> <span m='3530830'>the</span>
  <span m='3530920'>right</span> <span m='3531070'>parameters</span> <span m='3531610'>and</span>
  <span m='3531940'>this</span> <span m='3532090'>can</span> <span m='3532300'>be</span>
  <span m='3532420'>achieved.</span> </p><p><span m='3533230'>And</span> <span m='3533320'>the</span>
  <span m='3533410'>basic</span> <span m='3533710'>idea</span> <span m='3533980'>is</span>
  <span m='3534100'>you</span> <span m='3534150'>use</span> <span m='3534340'>ladder</span>
  <span m='3534610'>decomposition,</span> <span m='3535330'>just</span> <span m='3535540'>like</span>
  <span m='3535720'>before.</span> <span m='3536440'>But</span> <span m='3536560'>now</span>
  <span m='3536800'>a</span> <span m='3536830'>ladder</span> <span m='3537160'>can't</span>
  <span m='3537400'>be</span> <span m='3537490'>represented</span> <span m='3538060'>by</span>
  <span m='3538240'>an</span> <span m='3538330'>array</span> <span m='3538840'>because</span>
  <span m='3539170'>there</span> <span m='3539290'>are</span> <span m='3539320'>lots</span>
  <span m='3539620'>of</span> <span m='3539770'>absent</span> <span m='3540280'>places</span>
  <span m='3540730'>in</span> <span m='3540850'>the</span> <span m='3540940'>array.</span>
  <span m='3541760'>Now</span> <span m='3541960'>instead,</span> <span m='3542350'>use</span>
  <span m='3542590'>a</span> <span m='3542650'>predecessor,</span> <span m='3543180'>use</span>
  <span m='3543370'>a</span> <span m='3543460'>Van</span> <span m='3543650'>Emde</span>
  <span m='3543930'>Boas</span> <span m='3544540'>to</span> <span m='3544630'>represent</span>
  <span m='3545080'>a</span> <span m='3545140'>ladder.</span> <span m='3546260'>So</span>
  <span m='3546280'>that's</span> <span m='3546490'>basically</span> <span m='3546940'>all</span>
  <span m='3547030'>you</span> <span m='3547150'>do.</span> <span m='3547870'>Van</span>
  <span m='3548080'>Emde</span> <span m='3548500'>Boas</span> <span m='3549700'>represents</span>
  <span m='3551200'>a</span> <span m='3551290'>ladder.</span> </p><p><span m='3553630'>That's</span>
  <span m='3553930'>what</span> <span m='3554110'>you</span> <span m='3554200'>do</span>
  <span m='3554440'>in</span> <span m='3554560'>the</span> <span m='3554650'>top</span>
  <span m='3555010'>structure.</span> <span m='3555560'>Remember,</span> <span m='3555820'>we</span>
  <span m='3555910'>had</span> <span m='3556030'>indirection,</span> <span m='3556690'>leaf</span>
  <span m='3556900'>trimming,</span> <span m='3557350'>top</span> <span m='3557680'>was</span>
  <span m='3557920'>this</span> <span m='3558100'>thing,</span> <span m='3558600'>ladder</span>
  <span m='3558810'>decomposition.</span> <span m='3558980'>You</span> <span m='3559540'>Bottom</span>
  <span m='3559990'>was</span> <span m='3560260'>look</span> <span m='3560440'>up</span>
  <span m='3560560'>tables.</span> <span m='3561550'>The</span> <span m='3561640'>other</span>
  <span m='3561790'>problem</span> <span m='3562060'>is</span> <span m='3562180'>you</span>
  <span m='3562240'>can't</span> <span m='3562450'>use</span> <span m='3562600'>lookup</span>
  <span m='3562870'>tables</span> <span m='3563200'>anymore</span> <span m='3563650'>because</span>
  <span m='3564640'>in</span> <span m='3564880'>one</span> <span m='3565060'>of</span>
  <span m='3565120'>these</span> <span m='3565270'>tiny</span> <span m='3565630'>trees</span>
  <span m='3566530'>you</span> <span m='3566620'>could</span> <span m='3566770'>have</span>
  <span m='3566890'>a</span> <span m='3566950'>super</span> <span m='3567310'>long</span>
  <span m='3567610'>path.</span> <span m='3568030'>It's</span> <span m='3568210'>non-branching,</span>
  <span m='3568780'>they</span> <span m='3568870'>got</span> <span m='3569050'>compressed.</span>
  <span m='3570040'>And</span> <span m='3570130'>you</span> <span m='3570220'>can't</span>
  <span m='3570520'>afford</span> <span m='3570880'>to</span> <span m='3570970'>enumerate</span>
  <span m='3571420'>all</span> <span m='3571570'>possible</span> <span m='3571990'>situations.</span>
  <span m='3573410'>It's</span> <span m='3573490'>kind</span> <span m='3573700'>of</span>
  <span m='3573760'>annoying.</span> </p><p><span m='3575380'>So</span> <span m='3575480'>instead</span>
  <span m='3575740'>of</span> <span m='3575830'>using</span> <span m='3576100'>lookup</span>
  <span m='3576370'>tables--</span> <span m='3576700'>this</span> <span m='3576850'>was</span>
  <span m='3577000'>actually</span> <span m='3577300'>an</span> <span m='3577390'>idea</span>
  <span m='3577720'>from</span> <span m='3579310'>some</span> <span m='3579520'>students</span>
  <span m='3579880'>in</span> <span m='3580030'>this</span> <span m='3580150'>class</span>
  <span m='3580570'>last</span> <span m='3580780'>time</span> <span m='3580960'>I</span>
  <span m='3581050'>taught</span> <span m='3581290'>this</span> <span m='3581470'>material--</span>
  <span m='3582460'>they</span> <span m='3582550'>said,</span> <span m='3582790'>oh,</span>
  <span m='3583090'>well,</span> <span m='3583420'>instead</span> <span m='3583750'>of</span>
  <span m='3583840'>using</span> <span m='3584050'>a</span> <span m='3584110'>lookup</span>
  <span m='3584350'>table,</span> <span m='3584770'>you</span> <span m='3584920'>can</span>
  <span m='3585070'>use</span> <span m='3585280'>ladder</span> <span m='3585640'>decomposition.</span>
  <span m='3587180'>So</span> <span m='3587720'>down</span> <span m='3588070'>here,</span>
  <span m='3588610'>in</span> <span m='3588730'>the</span> <span m='3588820'>compressed</span>
  <span m='3589240'>tree,</span> <span m='3589960'>we</span> <span m='3590140'>have</span>
  <span m='3590480'>log</span> <span m='3590890'>n</span> <span m='3591070'>different</span>
  <span m='3591340'>nodes.</span> <span m='3592240'>If</span> <span m='3592390'>you</span>
  <span m='3592450'>use</span> <span m='3592670'>ladder</span> <span m='3593080'>decomposition</span>
  <span m='3593800'>on</span> <span m='3593920'>that</span> <span m='3594100'>thing--</span>
  <span m='3594370'>but</span> <span m='3594850'>not</span> <span m='3595090'>the</span>
  <span m='3595210'>hybrid</span> <span m='3595570'>structure.</span> <span m='3596030'>Remember,</span>
  <span m='3596110'>we</span> <span m='3596200'>used</span> <span m='3596350'>jump</span>
  <span m='3596590'>pointers</span> <span m='3596950'>plus</span> <span m='3597220'>ladders.</span>
  <span m='3598360'>Jump</span> <span m='3598570'>pointers</span> <span m='3598840'>still</span>
  <span m='3599020'>work</span> <span m='3599290'>here,</span> <span m='3599600'>just</span>
  <span m='3599890'>you</span> <span m='3599980'>have</span> <span m='3600070'>to
  round</span> <span m='3600490'>them</span> <span m='3600670'>to</span> <span m='3600820'>a</span>
  <span m='3600850'>different</span> <span m='3601120'>place.</span> </p><p><span
  m='3603160'>Down</span> <span m='3603460'>here,</span> <span m='3603640'>I'm</span>
  <span m='3603730'>not</span> <span m='3603910'>going</span> <span m='3604030'>to</span>
  <span m='3604090'>try</span> <span m='3604240'>to</span> <span m='3604330'>do</span>
  <span m='3604750'>jump</span> <span m='3605050'>pointers</span> <span m='3605410'>plus</span>
  <span m='3605710'>ladders.</span> <span m='3606010'>I'll</span> <span m='3606100'>just</span>
  <span m='3606310'>do</span> <span m='3606460'>ladders.</span> <span m='3607210'>And</span>
  <span m='3607310'>remember,</span> <span m='3607630'>just</span> <span m='3607900'>ladders</span>
  <span m='3608320'>gave</span> <span m='3608530'>us</span> <span m='3608650'>a</span>
  <span m='3608710'>log</span> <span m='3609070'>n</span> <span m='3609220'>query</span>
  <span m='3609520'>time.</span> <span m='3610120'>But</span> <span m='3610240'>now</span>
  <span m='3610490'>n</span> <span m='3610800'>is</span> <span m='3614560'>log</span>
  <span m='3614860'>T.</span> <span m='3615580'>And</span> <span m='3615700'>so</span>
  <span m='3615850'>we</span> <span m='3615940'>get</span> <span m='3616120'>log</span>
  <span m='3616390'>log</span> <span m='3616630'>T</span> <span m='3617230'>query</span>
  <span m='3617500'>time.</span> <span m='3618660'>And</span> <span m='3618760'>that's,</span>
  <span m='3618970'>basically,</span> <span m='3619490'>all</span> <span m='3619510'>you</span>
  <span m='3619600'>have</span> <span m='3619780'>to</span> <span m='3619870'>do.</span>
  </p><p><span m='3622960'>So</span> <span m='3623100'>you're</span> <span m='3623170'>always</span>
  <span m='3623380'>jumping</span> <span m='3623740'>to</span> <span m='3623800'>the</span>
  <span m='3623890'>top</span> <span m='3624130'>of</span> <span m='3624210'>a</span>
  <span m='3624280'>ladder.</span> <span m='3624960'>You'll</span> <span m='3625090'>only</span>
  <span m='3625360'>have</span> <span m='3625540'>to</span> <span m='3625660'>traverse</span>
  <span m='3626020'>log</span> <span m='3626350'>log</span> <span m='3626560'>T</span>
  <span m='3626810'>ladders.</span> <span m='3627550'>The</span> <span m='3627700'>very</span>
  <span m='3627910'>last</span> <span m='3628210'>ladder</span> <span m='3628450'>you</span>
  <span m='3628540'>might have to</span> <span m='3628810'>do</span> <span m='3628860'>a</span>
  <span m='3628930'>predecessor</span> <span m='3629440'>query</span> <span m='3629710'>that</span>
  <span m='3629860'>will</span> <span m='3629980'>cost</span> <span m='3630250'>you</span>
  <span m='3630400'>log</span> <span m='3630790'>log</span> <span m='3631180'>log</span>
  <span m='3631630'>T.</span> <span m='3632500'>But</span> <span m='3632680'>overall,</span>
  <span m='3633130'>it</span> <span m='3633190'>will</span> <span m='3633280'>be</span>
  <span m='3633400'>log</span> <span m='3633640'>log T</span> <span m='3634030'>time</span>
  <span m='3634840'>just</span> <span m='3635050'>by</span> <span m='3635410'>this</span>
  <span m='3635590'>kind</span> <span m='3635800'>of</span> <span m='3636370'>tweak</span>
  <span m='3637030'>to</span> <span m='3637390'>our</span> <span m='3638230'>level</span>
  <span m='3638470'>ancestor</span> <span m='3638890'>data</span> <span m='3639070'>structure.</span>
  <span m='3639730'>So</span> <span m='3639850'>I</span> <span m='3639910'>thought</span>
  <span m='3640090'>that</span> <span m='3640180'>was</span> <span m='3640300'>kind</span>
  <span m='3640450'>of</span> <span m='3640540'>a</span> <span m='3640630'>fun</span>
  <span m='3641440'>connection.</span> </p><p><span m='3643120'>This</span> <span
  m='3643810'>is</span> <span m='3643960'>the</span> <span m='3644110'>reason,</span>
  <span m='3644500'>essentially,</span> <span m='3644950'>level</span> <span m='3645280'>ancestors</span>
  <span m='3645820'>were</span> <span m='3645940'>developed.</span> <span m='3646450'>And</span>
  <span m='3646540'>people</span> <span m='3646810'>use</span> <span m='3647020'>them</span>
  <span m='3647710'>because</span> <span m='3648130'>you</span> <span m='3648280'>can</span>
  <span m='3648460'>do</span> <span m='3648640'>these</span> <span m='3648820'>kinds</span>
  <span m='3649060'>of</span> <span m='3649150'>things</span> <span m='3649750'>in</span>
  <span m='3649990'>nearly</span> <span m='3650530'>constant</span> <span m='3651010'>time,</span>
  <span m='3651800'>even</span> <span m='3652110'>if</span> <span m='3652260'>the</span>
  <span m='3652400'>substring</span> <span m='3652930'>is</span> <span m='3653080'>huge.</span>
  <span m='3654530'>So</span> <span m='3655900'>maybe</span> <span m='3656230'>I</span>
  <span m='3656290'>know</span> <span m='3656590'>ahead</span> <span m='3656770'>of</span>
  <span m='3656860'>time</span> <span m='3657130'>all</span> <span m='3657310'>the</span>
  <span m='3657400'>queries</span> <span m='3657760'>I</span> <span m='3657850'>might</span>
  <span m='3658030'>want</span> <span m='3658210'>to</span> <span m='3658270'>do.</span>
  <span m='3659860'>I</span> <span m='3659950'>just</span> <span m='3660100'>throw</span>
  <span m='3660400'>them</span> <span m='3660550'>into</span> <span m='3660850'>the</span>
  <span m='3660970'>text,</span> <span m='3662100'>just</span> <span m='3662560'>add</span>
  <span m='3662770'>them</span> <span m='3662920'>in</span> <span m='3663010'>there.</span>
  <span m='3663310'>Then</span> <span m='3663490'>I've</span> <span m='3663590'>cut</span>
  <span m='3663790'>these</span> <span m='3663940'>substrings,</span> <span m='3665410'>they're</span>
  <span m='3665560'>now</span> <span m='3665770'>represented</span> <span m='3666320'>in</span>
  <span m='3666400'>the</span> <span m='3666520'>suffix</span> <span m='3666880'>tree.</span>
  </p><p><span m='3667200'>Now</span> <span m='3667390'>any</span> <span m='3667660'>substring</span>
  <span m='3668080'>I</span> <span m='3668170'>want</span> <span m='3668290'>to</span>
  <span m='3668350'>query</span> <span m='3669220'>in</span> <span m='3669430'>log</span>
  <span m='3669730'>log</span> <span m='3669940'>n</span> <span m='3670090'>time,</span>
  <span m='3670480'>I</span> <span m='3670630'>can</span> <span m='3670810'>find</span>
  <span m='3671350'>all</span> <span m='3671560'>the</span> <span m='3671650'>occurrences</span>
  <span m='3672190'>of</span> <span m='3672280'>that</span> <span m='3672860'>string,</span>
  <span m='3673960'>even</span> <span m='3674230'>if</span> <span m='3674320'>the</span>
  <span m='3674410'>substring</span> <span m='3674830'>is</span> <span m='3674980'>huge.</span>
  <span m='3676670'>So</span> <span m='3676720'>if</span> <span m='3676810'>you</span>
  <span m='3676930'>know</span> <span m='3678310'>what</span> <span m='3678460'>queries</span>
  <span m='3678760'>you</span> <span m='3678820'>want,</span> <span m='3679060'>you</span>
  <span m='3679210'>can</span> <span m='3679330'>preprocess</span> <span m='3679900'>them</span>
  <span m='3680140'>and</span> <span m='3680500'>solve</span> <span m='3680770'>them</span>
  <span m='3680980'>even</span> <span m='3681250'>faster</span> <span m='3681670'>than</span>
  <span m='3681820'>order</span> <span m='3682020'>P</span> <span m='3682210'>time.</span>
  <span m='3684430'>Cool.</span> </p><p><span m='3685900'>Another</span> <span m='3686140'>thing</span>
  <span m='3686320'>you</span> <span m='3686410'>can</span> <span m='3686530'>do</span>
  <span m='3688570'>is</span> <span m='3690340'>represent</span> <span m='3690820'>multiple</span>
  <span m='3691810'>documents.</span> <span m='3692480'>And</span> <span m='3692580'>that's</span>
  <span m='3692680'>what</span> <span m='3692890'>I</span> <span m='3692920'>was</span>
  <span m='3693040'>sort</span> <span m='3693190'>of</span> <span m='3693280'>getting</span>
  <span m='3693580'>at</span> <span m='3693730'>there.</span> <span m='3695580'>If</span>
  <span m='3695700'>you</span> <span m='3695800'>have</span> <span m='3695890'>multiple</span>
  <span m='3696340'>documents--</span> <span m='3696790'>say,</span> <span m='3697270'>you're</span>
  <span m='3697510'>storing</span> <span m='3697960'>the</span> <span m='3698050'>entire</span>
  <span m='3698410'>web</span> <span m='3698800'>or</span> <span m='3698890'>Wikipedia.</span>
  <span m='3699670'>Like</span> <span m='3699850'>there's</span> <span m='3700030'>multiple</span>
  <span m='3700450'>pages.</span> <span m='3701560'>You</span> <span m='3701650'>want</span>
  <span m='3701830'>to</span> <span m='3701890'>separate</span> <span m='3702370'>them.</span>
  </p><p><span m='3703480'>All</span> <span m='3703690'>you</span> <span m='3703750'>need</span>
  <span m='3703900'>to</span> <span m='3704020'>do</span> <span m='3704740'>is</span>
  <span m='3704800'>say,</span> <span m='3705140'>OK,</span> <span m='3706120'>I'll</span>
  <span m='3706240'>take</span> <span m='3706480'>my</span> <span m='3706660'>first</span>
  <span m='3706900'>string</span> <span m='3707860'>and</span> <span m='3707980'>then</span>
  <span m='3708130'>put</span> <span m='3708310'>a</span> <span m='3708370'>special</span>
  <span m='3708760'>$</span> <span m='3709060'>sign</span> <span m='3709270'>after</span>
  <span m='3709570'>it.</span> <span m='3709990'>Then</span> <span m='3710110'>take</span>
  <span m='3710290'>my</span> <span m='3710380'>second</span> <span m='3710710'>string,</span>
  <span m='3711070'>put</span> <span m='3711280'>a</span> <span m='3711340'>special</span>
  <span m='3711730'>$</span> <span m='3712000'>sign</span> <span m='3712210'>after</span>
  <span m='3712480'>it.</span> <span m='3712980'>And</span> <span m='3713380'>take</span>
  <span m='3713590'>my</span> <span m='3713710'>k-th</span> <span m='3713980'>string</span>
  <span m='3714250'>and</span> <span m='3714340'>put</span> <span m='3714490'>a</span>
  <span m='3714550'>special</span> <span m='3714910'>$</span> <span m='3715180'>sign</span>
  <span m='3715360'>after</span> <span m='3715630'>it.</span> <span m='3716860'>Just</span>
  <span m='3717010'>concatenate</span> <span m='3717610'>them</span> <span m='3717760'>with</span>
  <span m='3718390'>different</span> <span m='3718750'>$</span> <span m='3718990'>signs</span>
  <span m='3719260'>in</span> <span m='3719350'>between</span> <span m='3719710'>them.</span>
  <span m='3720460'>Then</span> <span m='3720610'>build</span> <span m='3720770'>the</span>
  <span m='3720840'>suffix</span> <span m='3721210'>tree</span> <span m='3721390'>on</span>
  <span m='3721540'>this</span> <span m='3721780'>thing</span> <span m='3722020'>which</span>
  <span m='3722170'>I'll</span> <span m='3722290'>call</span> <span m='3722670'>T</span>
  </p><p><span m='3724030'>So</span> <span m='3724150'>you</span> <span m='3724270'>can</span>
  <span m='3724360'>use</span> <span m='3724510'>the</span> <span m='3724600'>same</span>
  <span m='3724960'>suffix</span> <span m='3725350'>tree</span> <span m='3725500'>data</span>
  <span m='3725680'>structure,</span> <span m='3726010'>but</span> <span m='3726160'>now,</span>
  <span m='3726430'>in</span> <span m='3726550'>some</span> <span m='3726760'>sense,</span>
  <span m='3727000'>you're</span> <span m='3727120'>representing</span> <span m='3728140'>all</span>
  <span m='3728380'>of</span> <span m='3728470'>these</span> <span m='3728620'>documents</span>
  <span m='3729550'>and</span> <span m='3729820'>all</span> <span m='3730090'>the</span>
  <span m='3730210'>ways</span> <span m='3730480'>they</span> <span m='3730660'>interweave.</span>
  <span m='3731970'>Because</span> <span m='3732250'>there</span> <span m='3732370'>are</span>
  <span m='3732410'>some</span> <span m='3732640'>shared</span> <span m='3733060'>substrings</span>
  <span m='3733630'>here</span> <span m='3733810'>that</span> <span m='3733900'>are</span>
  <span m='3733990'>shared</span> <span m='3734260'>by</span> <span m='3734440'>this,</span>
  <span m='3734770'>and</span> <span m='3734890'>this,</span> <span m='3735130'>and</span>
  <span m='3735220'>whatever.</span> <span m='3735590'>And</span> <span m='3735690'>those</span>
  <span m='3735790'>will</span> <span m='3735880'>be</span> <span m='3736030'>represented</span>
  <span m='3736570'>in</span> <span m='3736750'>the</span> <span m='3736840'>same</span>
  <span m='3737140'>structure.</span> <span m='3738070'>Or</span> <span m='3738400'>I</span>
  <span m='3738460'>can</span> <span m='3738580'>do</span> <span m='3738700'>a</span>
  <span m='3738730'>search</span> <span m='3739180'>and</span> <span m='3739270'>then</span>
  <span m='3739390'>I've</span> <span m='3739510'>effectively</span> <span m='3740050'>found</span>
  <span m='3740890'>all</span> <span m='3741100'>the</span> <span m='3741220'>documents</span>
  <span m='3741700'>that</span> <span m='3741820'>contain</span> <span m='3742210'>it.</span>
  </p><p><span m='3743500'>One</span> <span m='3743710'>issue,</span> <span m='3744010'>though.</span>
  <span m='3745570'>Suppose,</span> <span m='3745990'>I</span> <span m='3746050'>want</span>
  <span m='3746200'>to</span> <span m='3746260'>find</span> <span m='3746500'>all</span>
  <span m='3746740'>the</span> <span m='3746830'>documents</span> <span m='3747310'>containing</span>
  <span m='3747820'>the</span> <span m='3747910'>word</span> <span m='3749170'>MIT</span>
  <span m='3749920'>or</span> <span m='3749980'>something.</span> <span m='3751390'>Maybe</span>
  <span m='3751765'>all</span> <span m='3752140'>k</span> <span m='3752550'>of</span>
  <span m='3752650'>them</span> <span m='3752740'>match,</span> <span m='3753070'>maybe</span>
  <span m='3753580'>one</span> <span m='3753830'>document</span> <span m='3754180'>matches,</span>
  <span m='3754960'>maybe</span> <span m='3755170'>two</span> <span m='3755350'>documents</span>
  <span m='3755790'>match.</span> <span m='3756010'>Suppose,</span> <span m='3756400'>two</span>
  <span m='3756610'>documents</span> <span m='3757120'>match.</span> </p><p><span
  m='3757930'>The</span> <span m='3758050'>first</span> <span m='3758320'>document</span>
  <span m='3758800'>mentions</span> <span m='3759190'>MIT</span> <span m='3759790'>a</span>
  <span m='3759820'>billion</span> <span m='3760240'>times.</span> <span m='3760990'>The</span>
  <span m='3761080'>second</span> <span m='3761380'>document</span> <span m='3763060'>has</span>
  <span m='3763480'>MIT</span> <span m='3763870'>in</span> <span m='3763960'>it</span>
  <span m='3764050'>once.</span> <span m='3766330'>Then</span> <span m='3766570'>suffix</span>
  <span m='3766940'>trees</span> <span m='3767110'>are</span> <span m='3767170'>kind</span>
  <span m='3767470'>of</span> <span m='3767560'>annoying</span> <span m='3767980'>because</span>
  <span m='3768400'>they</span> <span m='3768610'>will</span> <span m='3768760'>find</span>
  <span m='3769120'>that</span> <span m='3769540'>billion</span> <span m='3769930'>and</span>
  <span m='3770050'>one</span> <span m='3770230'>matches</span> <span m='3770980'>as</span>
  <span m='3771130'>a</span> <span m='3771190'>subtree.</span> <span m='3772120'>But</span>
  <span m='3772240'>if</span> <span m='3772360'>I</span> <span m='3772420'>just</span>
  <span m='3772570'>want</span> <span m='3772750'>to</span> <span m='3772810'>know</span>
  <span m='3772960'>the</span> <span m='3773110'>answer,</span> <span m='3773400'>oh,</span>
  <span m='3773560'>these</span> <span m='3773770'>two</span> <span m='3773980'>documents</span>
  <span m='3774490'>match,</span> <span m='3775360'>I'd</span> <span m='3775480'>like</span>
  <span m='3775660'>to</span> <span m='3775750'>do</span> <span m='3775870'>that</span>
  <span m='3776050'>in</span> <span m='3776170'>order</span> <span m='3776470'>2</span>
  <span m='3776740'>time,</span> <span m='3777070'>not</span> <span m='3777310'>order</span>
  <span m='3777580'>billion</span> <span m='3777970'>time,</span> <span m='3779500'>to</span>
  <span m='3779710'>use</span> <span m='3779980'>technical</span> <span m='3780400'>terms.</span>
  </p><p><span m='3782230'>And</span> <span m='3782440'>that</span> <span m='3782740'>is</span>
  <span m='3783040'>called</span> <span m='3783400'>the</span> <span m='3783610'>document</span>
  <span m='3784090'>retrieval</span> <span m='3784600'>problem</span> <span m='3787480'>or</span>
  <span m='3787670'>a</span> <span m='3787690'>document</span> <span m='3788080'>retrieval</span>
  <span m='3788470'>data</span> <span m='3788710'>structure.</span> <span m='3789830'>This</span>
  <span m='3789930'>is</span> <span m='3790030'>a</span> <span m='3790130'>problem</span>
  <span m='3790390'>considered</span> <span m='3790780'>by</span> <span m='3791300'>M.</span>
  <span m='3791540'>Krishnan</span> <span m='3791970'>in</span> <span m='3792400'>2002.</span>
  <span m='3794320'>Document</span> <span m='3794740'>retrieval</span> <span m='3795320'>you</span>
  <span m='3795490'>can</span> <span m='3795610'>do</span> <span m='3795790'>an</span>
  <span m='3795910'>order</span> <span m='3796210'>P</span> <span m='3796630'>plus</span>
  <span m='3801950'>number</span> <span m='3802510'>of</span> <span m='3803140'>documents</span>
  <span m='3804940'>matching.</span> </p><p><span m='3806150'>So</span> <span m='3806170'>if</span>
  <span m='3806290'>I</span> <span m='3806380'>want</span> <span m='3806500'>to</span>
  <span m='3806590'>list</span> <span m='3807520'>all</span> <span m='3807700'>the</span>
  <span m='3807790'>documents</span> <span m='3808240'>that</span> <span m='3808360'>match,</span>
  <span m='3810550'>I</span> <span m='3810640'>could</span> <span m='3810760'>do</span>
  <span m='3810900'>an</span> <span m='3811030'>order</span> <span m='3811330'>the</span>
  <span m='3811420'>number</span> <span m='3811660'>of</span> <span m='3811750'>documents</span>
  <span m='3812320'>that</span> <span m='3812440'>match,</span> <span m='3812740'>not</span>
  <span m='3812980'>the</span> <span m='3813100'>order</span> <span m='3813430'>of</span>
  <span m='3813530'>a</span> <span m='3813820'>number</span> <span m='3814180'>of</span>
  <span m='3814270'>occurrences</span> <span m='3815650'>of</span> <span m='3815920'>the</span>
  <span m='3816040'>string.</span> <span m='3817270'>So</span> <span m='3817360'>I</span>
  <span m='3817420'>still</span> <span m='3817630'>got</span> <span m='3817740'>to</span>
  <span m='3817840'>do</span> <span m='3817960'>the P</span> <span m='3818230'>search</span>
  <span m='3818500'>in</span> <span m='3818590'>the</span> <span m='3818650'>beginning,</span>
  <span m='3819760'>and</span> <span m='3819910'>then</span> <span m='3820210'>this</span>
  <span m='3820450'>is</span> <span m='3820690'>better.</span> </p><p><span m='3821920'>And</span>
  <span m='3822070'>the</span> <span m='3822160'>funny</span> <span m='3822340'>thing</span>
  <span m='3822550'>is</span> <span m='3823150'>the</span> <span m='3823300'>solution</span>
  <span m='3823750'>to</span> <span m='3823870'>this</span> <span m='3824080'>data</span>
  <span m='3824280'>structure</span> <span m='3825340'>uses</span> <span m='3826010'>RMQ,</span>
  <span m='3827730'>range</span> <span m='3828510'>minimum</span> <span m='3828680'>queries,</span>
  <span m='3829090'>from</span> <span m='3829300'>last</span> <span m='3829510'>lecture.</span>
  <span m='3829820'>So</span> <span m='3829930'>let</span> <span m='3830050'>me</span>
  <span m='3830140'>tell</span> <span m='3830320'>you</span> <span m='3830440'>how</span>
  <span m='3830530'>it</span> <span m='3830590'>works.</span> <span m='3831050'>It's</span>
  <span m='3831150'>actually</span> <span m='3831280'>very</span> <span m='3831490'>simple.</span>
  <span m='3836730'>And</span> <span m='3836920'>then</span> <span m='3837050'>I</span>
  <span m='3837110'>think</span> <span m='3837320'>we'll</span> <span m='3837620'>move</span>
  <span m='3837830'>on</span> <span m='3838050'>to</span> <span m='3838760'>how</span>
  <span m='3838940'>to</span> <span m='3839030'>build</span> <span m='3839300'>a</span>
  <span m='3839360'>suffix</span> <span m='3839750'>tree.</span> </p><p><span m='3841460'>So</span>
  <span m='3842090'>document</span> <span m='3842840'>retrieval.</span> <span m='3848570'>Here's</span>
  <span m='3848810'>what</span> <span m='3848930'>we're</span> <span m='3849020'>going</span>
  <span m='3849140'>to</span> <span m='3849200'>do.</span> <span m='3865040'>Remember,</span>
  <span m='3865310'>these</span> <span m='3865490'>different</span> <span m='3865790'>$</span>
  <span m='3866030'>signs</span> <span m='3866300'>i</span> <span m='3866450'>represent</span>
  <span m='3867170'>different</span> <span m='3867530'>documents.</span> <span m='3870230'>I</span>
  <span m='3870350'>want</span> <span m='3870470'>to</span> <span m='3870560'>remember</span>
  <span m='3871460'>which</span> <span m='3871760'>suffixes</span> <span m='3872450'>came</span>
  <span m='3872690'>from</span> <span m='3872870'>the</span> <span m='3872960'>same</span>
  <span m='3873350'>document.</span> <span m='3875060'>So</span> <span m='3875820'>at</span>
  <span m='3876040'>every</span> <span m='3876350'>$</span> <span m='3876680'>sign</span>
  <span m='3877010'>i,</span> <span m='3878381'>I</span> <span m='3878840'>want</span>
  <span m='3879470'>to</span> <span m='3879620'>store</span> <span m='3880010'>the</span>
  <span m='3880160'>number</span> <span m='3880790'>of</span> <span m='3881180'>the</span>
  <span m='3881990'>previous</span> <span m='3882920'>$</span> <span m='3883190'>sign</span>
  <span m='3883460'>i.</span> </p><p><span m='3884990'>Let's</span> <span m='3885170'>suppose,</span>
  <span m='3885950'>the</span> <span m='3886070'>suffixes,</span> <span m='3887210'>when</span>
  <span m='3887360'>they</span> <span m='3887450'>get</span> <span m='3887630'>to</span>
  <span m='3887750'>one</span> <span m='3887870'>of</span> <span m='3887930'>the</span>
  <span m='3888020'>$</span> <span m='3888260'>signs,</span> <span m='3888520'>I</span>
  <span m='3888590'>can</span> <span m='3888740'>just</span> <span m='3889250'>stop,</span>
  <span m='3889630'>I</span> <span m='3889760'>don't</span> <span m='3889970'>have</span>
  <span m='3890060'>to</span> <span m='3890180'>store</span> <span m='3890360'>the</span>
  <span m='3890480'>rest,</span> <span m='3891780'>I'm</span> <span m='3891840'>going</span>
  <span m='3891950'>to</span> <span m='3892010'>throw</span> <span m='3892280'>away.</span>
  <span m='3892490'>Whenever</span> <span m='3892790'>I</span> <span m='3892820'>hit
  a</span> <span m='3892940'>$</span> <span m='3893270'>sign,</span> <span m='3893590'>I</span>
  <span m='3893690'>will</span> <span m='3893810'>stop</span> <span m='3894110'>the</span>
  <span m='3894230'>suffix</span> <span m='3894590'>tree.</span> <span m='3895490'>That</span>
  <span m='3895610'>way,</span> <span m='3895730'>the</span> <span m='3895820'>$</span>
  <span m='3896060'>signs</span> <span m='3896300'>really</span> <span m='3896540'>are</span>
  <span m='3896740'>leaves,</span> <span m='3897410'>all</span> <span m='3897620'>of</span>
  <span m='3897740'>them</span> <span m='3898340'>now</span> <span m='3898490'>become</span>
  <span m='3899090'>leaves.</span> <span m='3899880'>So</span> <span m='3900110'>I</span>
  <span m='3900170'>don't</span> <span m='3900320'>really</span> <span m='3900620'>care</span>
  <span m='3900830'>about</span> <span m='3900980'>a</span> <span m='3901040'>suffix</span>
  <span m='3901400'>that</span> <span m='3901490'>goes</span> <span m='3901670'>all</span>
  <span m='3901850'>the</span> <span m='3901940'>way</span> <span m='3902030'>through</span>
  <span m='3902240'>here.</span> <span m='3902480'>I</span> <span m='3902540'>just</span>
  <span m='3902690'>want</span> <span m='3902840'>the</span> <span m='3902930'>suffix</span>
  <span m='3903350'>to</span> <span m='3903470'>the</span> <span m='3903560'>$</span>
  <span m='3903830'>sign,</span> <span m='3904040'>as</span> <span m='3904480'>it</span>
  <span m='3904790'>represents the</span> <span m='3905210'>individual</span> <span
  m='3905660'>documents.</span> </p><p><span m='3906960'>So</span> <span m='3907070'>$</span>
  <span m='3907320'>sign i's</span> <span m='3907700'>are</span> <span m='3907790'>leaves.</span>
  <span m='3908810'>And</span> <span m='3909170'>I</span> <span m='3909290'>want</span>
  <span m='3909470'>each</span> <span m='3909680'>of</span> <span m='3909740'>them</span>
  <span m='3909890'>just</span> <span m='3910070'>to</span> <span m='3910160'>store</span>
  <span m='3910700'>a</span> <span m='3910760'>pointer,</span> <span m='3911180'>basically,</span>
  <span m='3911600'>to</span> <span m='3911690'>the</span> <span m='3911810'>previous</span>
  <span m='3912230'>one</span> <span m='3912890'>of</span> <span m='3913040'>the</span>
  <span m='3913160'>same</span> <span m='3913580'>type,</span> <span m='3914040'>the</span>
  <span m='3914060'>same</span> <span m='3914300'>$</span> <span m='3914550'>sign</span>
  <span m='3914760'>i.</span> <span m='3914930'>It</span> <span m='3915380'>came</span>
  <span m='3915530'>from</span> <span m='3915650'>the</span> <span m='3915740'>same</span>
  <span m='3915980'>document.</span> </p><p><span m='3922860'>Now,</span> <span m='3926240'>here's</span>
  <span m='3926420'>the</span> <span m='3926510'>idea.</span> <span m='3926990'>I</span>
  <span m='3927590'>did</span> <span m='3927800'>a</span> <span m='3927860'>search,</span>
  <span m='3928640'>I</span> <span m='3928760'>got</span> <span m='3929000'>down</span>
  <span m='3929210'>to</span> <span m='3929360'>a</span> <span m='3929420'>node,</span>
  <span m='3930470'>and</span> <span m='3930590'>now</span> <span m='3930800'>there's</span>
  <span m='3930980'>this</span> <span m='3931130'>big</span> <span m='3931450'>subtree</span>
  <span m='3931700'>here.</span> <span m='3932570'>And</span> <span m='3933920'>this</span>
  <span m='3934090'>subtree</span> <span m='3935420'>has</span> <span m='3935630'>a</span>
  <span m='3935660'>bunch</span> <span m='3935840'>of</span> <span m='3935900'>leaves</span>
  <span m='3936200'>in</span> <span m='3936320'>it,</span> <span m='3936400'>those</span>
  <span m='3936590'>represent</span> <span m='3936980'>all</span> <span m='3937130'>the</span>
  <span m='3937250'>occurrences</span> <span m='3937790'>of</span> <span m='3937890'>the</span>
  <span m='3937940'>pattern</span> <span m='3938270'>P.</span> <span m='3940460'>And</span>
  <span m='3940790'>let's</span> <span m='3941030'>suppose</span> <span m='3941960'>that</span>
  <span m='3942110'>those</span> <span m='3942320'>leaves</span> <span m='3942680'>are</span>
  <span m='3942800'>numbered.</span> <span m='3943120'>I'm</span> <span m='3943440'>numbering
  the</span> <span m='3943850'>leaves</span> <span m='3944240'>from</span> <span m='3944780'>1</span>
  <span m='3945110'>to</span> <span m='3945270'>n,</span> <span m='3946580'>I</span>
  <span m='3946670'>guess.</span> </p><p><span m='3948620'>Then</span> <span m='3948860'>in</span>
  <span m='3949010'>here,</span> <span m='3949370'>the</span> <span m='3949460'>leaves</span>
  <span m='3949730'>will</span> <span m='3949940'>be</span> <span m='3950120'>an</span>
  <span m='3950240'>interval--</span> <span m='3951440'>interval</span> <span m='3952300'>l,</span>
  <span m='3952550'>comma,</span> <span m='3952910'>n.</span> <span m='3954710'>And</span>
  <span m='3954980'>the</span> <span m='3955100'>trouble</span> <span m='3955430'>is</span>
  <span m='3955550'>a</span> <span m='3955610'>lot</span> <span m='3955880'>of</span>
  <span m='3955970'>these</span> <span m='3956210'>have</span> <span m='3956420'>the</span>
  <span m='3956510'>same</span> <span m='3956900'>label</span> <span m='3957260'>$</span>
  <span m='3957560'>sign</span> <span m='3957800'>i.</span> <span m='3958640'>And</span>
  <span m='3958800'>I</span> <span m='3958910'>just</span> <span m='3959060'>want</span>
  <span m='3959210'>to</span> <span m='3959270'>find</span> <span m='3959490'>the</span>
  <span m='3959690'>unique</span> <span m='3960080'>ones.</span> <span m='3961370'>How</span>
  <span m='3961520'>do</span> <span m='3961640'>I</span> <span m='3961710'>do</span>
  <span m='3961910'>that?</span> </p><p><span m='3967760'>What</span> <span m='3967910'>we</span>
  <span m='3968030'>do</span> <span m='3968960'>is</span> <span m='3969170'>find</span>
  <span m='3970700'>the</span> <span m='3970820'>first</span> <span m='3971570'>occurrence</span>
  <span m='3973160'>of</span> <span m='3973340'>$</span> <span m='3973640'>sign</span>
  <span m='3973920'>i</span> <span m='3974892'>for</span> <span m='3975260'>each</span>
  <span m='3975560'>i.</span> <span m='3977090'>I</span> <span m='3977180'>could</span>
  <span m='3977320'>just</span> <span m='3977450'>find</span> <span m='3977630'>the</span>
  <span m='3977750'>first</span> <span m='3978110'>occurrence</span> <span m='3978560'>of</span>
  <span m='3978620'>$</span> <span m='3978850'>sign</span> <span m='3979080'>i</span>
  <span m='3979370'>for</span> <span m='3979840'>each i.</span> <span m='3980060'>I'd</span>
  <span m='3980260'>then</span> <span m='3980810'>only</span> <span m='3981080'>have</span>
  <span m='3981260'>to</span> <span m='3981350'>pay</span> <span m='3981620'>order</span>
  <span m='3982670'>number</span> <span m='3983120'>of</span> <span m='3983210'>distinct</span>
  <span m='3983630'>documents,</span> <span m='3984370'>then</span> <span m='3984440'>we'll</span>
  <span m='3984560'>have</span> <span m='3984710'>to</span> <span m='3984800'>pay</span>
  <span m='3984950'>for</span> <span m='3985100'>every</span> <span m='3985370'>match</span>
  <span m='3985670'>within</span> <span m='3985910'>the</span> <span m='3986000'>document.</span>
  </p><p><span m='3987170'>Now,</span> <span m='3987380'>one</span> <span m='3987590'>way</span>
  <span m='3987740'>to</span> <span m='3987890'>define</span> <span m='3988340'>the</span>
  <span m='3988490'>first</span> <span m='3988820'>$</span> <span m='3989170'>sign</span>
  <span m='3989610'>i</span> <span m='3990470'>is--</span> <span m='3990860'>that's
  a</span> <span m='3991160'>$</span> <span m='3991520'>sign</span> <span m='3991790'>i</span>
  <span m='3993100'>whose</span> <span m='3993560'>stored</span> <span m='3994130'>value--</span>
  <span m='3995690'>we</span> <span m='3995780'>said</span> <span m='3995990'>we</span>
  <span m='3996110'>store</span> <span m='3996440'>the</span> <span m='3996560'>leaf</span>
  <span m='3996800'>number</span> <span m='3997070'>of</span> <span m='3997160'>the</span>
  <span m='3997250'>previous</span> <span m='3997670'>$</span> <span m='3997910'>sign</span>
  <span m='3998120'>i--</span> <span m='3998620'>whose</span> <span m='4000250'>stored</span>
  <span m='4000670'>value</span> <span m='4002200'>is</span> <span m='4002350'>less</span>
  <span m='4002770'>than</span> <span m='4003180'>l.</span> <span m='4005470'>So</span>
  <span m='4005590'>we</span> <span m='4005710'>find</span> <span m='4005950'>some</span>
  <span m='4006100'>position</span> <span m='4006430'>here.</span> <span m='4006550'>If</span>
  <span m='4006640'>the</span> <span m='4006700'>previous</span> <span m='4007060'>guy</span>
  <span m='4007210'>is</span> <span m='4007300'>less</span> <span m='4007570'>than</span>
  <span m='4007720'>l,</span> <span m='4008300'>that</span> <span m='4008410'>means</span>
  <span m='4008620'>it</span> <span m='4008710'>was</span> <span m='4008860'>the</span>
  <span m='4008980'>first</span> <span m='4009340'>of</span> <span m='4009430'>that</span>
  <span m='4009610'>type.</span> <span m='4011950'>If</span> <span m='4012070'>we</span>
  <span m='4012160'>store</span> <span m='4012370'>this,</span> <span m='4012740'>that's</span>
  <span m='4013450'>definition</span> <span m='4013990'>of</span> <span m='4014050'>being</span>
  <span m='4014260'>first.</span> </p><p><span m='4016330'>So</span> <span m='4017800'>in</span>
  <span m='4017980'>this</span> <span m='4018190'>interval,</span> <span m='4019150'>I</span>
  <span m='4019270'>want</span> <span m='4019510'>to</span> <span m='4019630'>find</span>
  <span m='4020200'>$</span> <span m='4020470'>sign</span> <span m='4020755'>i's</span>
  <span m='4021040'>that</span> <span m='4021160'>have</span> <span m='4021370'>very</span>
  <span m='4021610'>small</span> <span m='4022120'>stored</span> <span m='4022510'>values.</span>
  <span m='4024070'>How</span> <span m='4024460'>would</span> <span m='4024640'>I</span>
  <span m='4024730'>find</span> <span m='4025030'>the</span> <span m='4025150'>very</span>
  <span m='4025330'>best</span> <span m='4025600'>one?</span> <span m='4026050'>Range</span>
  <span m='4026350'>minimum</span> <span m='4026710'>query.</span> <span m='4027430'>So</span>
  <span m='4027850'>we</span> <span m='4028270'>do a</span> <span m='4028690'>range</span>
  <span m='4029110'>minimum</span> <span m='4029200'>query</span> <span m='4030105'>on</span>
  <span m='4030470'>l,</span> <span m='4030850'>comma,</span> <span m='4031360'>n.</span>
  <span m='4032560'>If</span> <span m='4032710'>there's</span> <span m='4033040'>any</span>
  <span m='4033480'>firsts</span> <span m='4033850'>in</span> <span m='4033970'>there,</span>
  <span m='4034480'>this</span> <span m='4034720'>will</span> <span m='4034810'>find</span>
  <span m='4035110'>it.</span> </p><p><span m='4038580'>Find,</span> <span m='4039510'>let's</span>
  <span m='4039770'>say,</span> <span m='4039830'>a</span> <span m='4040090'>position</span>
  <span m='4041490'>m</span> <span m='4043480'>with</span> <span m='4043720'>the</span>
  <span m='4043840'>smallest</span> <span m='4044470'>possible</span> <span m='4045010'>stored</span>
  <span m='4045340'>value.</span> <span m='4057430'>If</span> <span m='4058270'>the</span>
  <span m='4058480'>stored</span> <span m='4060530'>number</span> <span m='4061730'>is</span>
  <span m='4061910'>less</span> <span m='4062180'>than</span> <span m='4062360'>l,</span>
  <span m='4063080'>then</span> <span m='4063350'>output</span> <span m='4063980'>that</span>
  <span m='4064190'>answer.</span> <span m='4068480'>And</span> <span m='4068660'>then</span>
  <span m='4068870'>recurse</span> <span m='4072710'>on</span> <span m='4072980'>the</span>
  <span m='4073070'>remaining</span> <span m='4073460'>intervals.</span> <span m='4073890'>So</span>
  <span m='4074090'>there's</span> <span m='4074300'>going</span> <span m='4074450'>to</span>
  <span m='4074510'>be</span> <span m='4074660'>from</span> <span m='4074900'>l</span>
  <span m='4075225'>to</span> <span m='4075970'>m</span> <span m='4076140'>minus</span>
  <span m='4076490'>1</span> <span m='4078050'>and</span> <span m='4078320'>m</span>
  <span m='4078590'>plus</span> <span m='4078920'>1</span> <span m='4080090'>to</span>
  <span m='4080480'>n.</span> </p><p><span m='4081860'>So</span> <span m='4081980'>we</span>
  <span m='4082070'>find</span> <span m='4082580'>the</span> <span m='4082700'>best</span>
  <span m='4083240'>candidate,</span> <span m='4084590'>the</span> <span m='4084680'>minimum.</span>
  <span m='4085390'>That's</span> <span m='4085640'>minimum</span> <span m='4085940'>sorted</span>
  <span m='4086180'>value.</span> <span m='4086450'>If</span> <span m='4086650'>anything</span>
  <span m='4086970'>is</span> <span m='4087110'>going</span> <span m='4087260'>to</span>
  <span m='4087320'>be</span> <span m='4087380'>less</span> <span m='4087640'>than</span>
  <span m='4087770'>l,</span> <span m='4088100'>that</span> <span m='4088340'>would</span>
  <span m='4088460'>be</span> <span m='4088640'>it.</span> <span m='4089210'>If</span>
  <span m='4089360'>it</span> <span m='4089450'>is</span> <span m='4089570'>less</span>
  <span m='4089760'>than</span> <span m='4089820'>l,</span> <span m='4090080'>we</span>
  <span m='4090260'>output</span> <span m='4090650'>it,</span> <span m='4091160'>then</span>
  <span m='4091310'>we</span> <span m='4091430'>recurse</span> <span m='4091940'>over</span>
  <span m='4092210'>here</span> <span m='4092540'>and</span> <span m='4092660'>we</span>
  <span m='4092780'>recurse</span> <span m='4093140'>over</span> <span m='4093320'>here.</span>
  <span m='4093500'>At</span> <span m='4093620'>some</span> <span m='4093830'>point</span>
  <span m='4094070'>this</span> <span m='4094190'>will</span> <span m='4094310'>stop</span>
  <span m='4094880'>finding</span> <span m='4095480'>things.</span> <span m='4095750'>We're</span>
  <span m='4095840'>going</span> <span m='4095960'>to</span> <span m='4096020'>do</span>
  <span m='4096109'>another</span> <span m='4096470'>RMQ</span> <span m='4096950'>over</span>
  <span m='4097130'>here.</span> <span m='4097910'>Might</span> <span m='4098090'>not</span>
  <span m='4098210'>find</span> <span m='4098420'>anything,</span> <span m='4099000'>then</span>
  <span m='4099050'>we</span> <span m='4099170'>just</span> <span m='4099290'>stop</span>
  <span m='4099560'>that</span> <span m='4099710'>recursion.</span> </p><p><span m='4101189'>But</span>
  <span m='4101300'>the</span> <span m='4101479'>number</span> <span m='4101810'>of</span>
  <span m='4101899'>recursions</span> <span m='4102350'>we</span> <span m='4102439'>have</span>
  <span m='4102560'>to</span> <span m='4102649'>do</span> <span m='4103250'>is</span>
  <span m='4103340'>going</span> <span m='4103490'>to</span> <span m='4103550'>be</span>
  <span m='4103700'>equal</span> <span m='4104000'>to</span> <span m='4104149'>the</span>
  <span m='4104270'>number</span> <span m='4104569'>of</span> <span m='4104660'>documents</span>
  <span m='4105109'>that</span> <span m='4105229'>match,</span> <span m='4105560'>maybe</span>
  <span m='4105800'>plus</span> <span m='4106080'>1.</span> <span m='4107810'>So</span>
  <span m='4107990'>we</span> <span m='4108050'>achieved</span> <span m='4108350'>this</span>
  <span m='4108529'>bound</span> <span m='4109069'>using</span> <span m='4109370'>RMQ</span>
  <span m='4109760'>because</span> <span m='4109950'>RMQ</span> <span m='4110660'>we</span>
  <span m='4110779'>can</span> <span m='4110870'>do</span> <span m='4110990'>in</span>
  <span m='4111080'>constant</span> <span m='4111439'>time</span> <span m='4111770'>with</span>
  <span m='4111930'>appropriate</span> <span m='4112330'>pre-processing.</span> </p><p><span
  m='4113689'>Now,</span> <span m='4114170'>the</span> <span m='4114350'>RMQ</span>
  <span m='4114890'>is</span> <span m='4115040'>over</span> <span m='4115340'>an</span>
  <span m='4115430'>array.</span> <span m='4115770'>It's</span> <span m='4115939'>over</span>
  <span m='4116210'>this</span> <span m='4116390'>array</span> <span m='4116660'>of</span>
  <span m='4116779'>stored</span> <span m='4117140'>values</span> <span m='4118069'>indexed</span>
  <span m='4118580'>by</span> <span m='4118850'>leaves.</span> <span m='4120590'>And</span>
  <span m='4120800'>this</span> <span m='4120979'>idea</span> <span m='4121279'>of</span>
  <span m='4121370'>taking</span> <span m='4121760'>the</span> <span m='4121850'>leaves</span>
  <span m='4122330'>and</span> <span m='4122479'>writing</span> <span m='4122779'>them</span>
  <span m='4122899'>down</span> <span m='4123140'>in</span> <span m='4123260'>order</span>
  <span m='4124399'>is</span> <span m='4125029'>actually</span> <span m='4125359'>something</span>
  <span m='4125720'>we</span> <span m='4125840'>need.</span> <span m='4126290'>It's</span>
  <span m='4126410'>called</span> <span m='4126830'>a</span> <span m='4126870'>suffix</span>
  <span m='4127810'>array.</span> <span m='4136970'>We're</span> <span m='4137060'>going</span>
  <span m='4137180'>to</span> <span m='4137270'>use</span> <span m='4137479'>this</span>
  <span m='4138109'>alternate</span> <span m='4138560'>representation</span> <span
  m='4139340'>of</span> <span m='4139430'>suffix</span> <span m='4139819'>trees</span>
  <span m='4140149'>in</span> <span m='4140270'>order</span> <span m='4140479'>to</span>
  <span m='4140750'>compute</span> <span m='4141300'>them.</span> </p><p><span m='4142640'>Suffix</span>
  <span m='4143029'>arrays</span> <span m='4143390'>in</span> <span m='4143479'>some</span>
  <span m='4143660'>sense</span> <span m='4143899'>are</span> <span m='4143990'>easier</span>
  <span m='4144380'>to</span> <span m='4144470'>think</span> <span m='4144649'>about.</span>
  <span m='4156410'>The</span> <span m='4156500'>idea</span> <span m='4156770'>with</span>
  <span m='4156870'>the</span> <span m='4156950'>suffix</span> <span m='4157350'>array</span>
  <span m='4158510'>is</span> <span m='4158750'>to</span> <span m='4159080'>write</span>
  <span m='4159350'>down</span> <span m='4159590'>all</span> <span m='4159710'>the</span>
  <span m='4159800'>suffixes,</span> <span m='4160850'>sort</span> <span m='4161180'>them.</span>
  <span m='4165979'>This</span> <span m='4166160'>is</span> <span m='4166250'>conceptual.</span>
  <span m='4167090'>Imagine</span> <span m='4167510'>you</span> <span m='4167600'>take</span>
  <span m='4167960'>all</span> <span m='4168109'>these</span> <span m='4168279'>suffixes.</span>
  <span m='4168710'>Their</span> <span m='4168800'>total</span> <span m='4169100'>size</span>
  <span m='4169340'>is</span> <span m='4169460'>quadratic</span> <span m='4170029'>in</span>
  <span m='4170140'>T</span> <span m='4170370'>so</span> <span m='4170450'>you'd</span>
  <span m='4170550'>never</span> <span m='4170810'>actually</span> <span m='4171080'>want</span>
  <span m='4171260'>to</span> <span m='4171319'>do</span> <span m='4171439'>this.</span>
  <span m='4172340'>But</span> <span m='4172520'>just</span> <span m='4172670'>imagine</span>
  <span m='4173029'>writing</span> <span m='4173240'>them</span> <span m='4173359'>down,</span>
  <span m='4173600'>sorting</span> <span m='4173990'>them</span> <span m='4174109'>lexically</span>
  <span m='4174590'>using</span> <span m='4174950'>our</span> <span m='4175069'>string</span>
  <span m='4175370'>sorting</span> <span m='4175790'>algorithms.</span> </p><p><span
  m='4177560'>And</span> <span m='4177770'>then</span> <span m='4178520'>we</span>
  <span m='4178640'>can't</span> <span m='4178850'>represent</span> <span m='4179660'>them</span>
  <span m='4179930'>explicitly</span> <span m='4180560'>because</span> <span m='4180740'>it</span>
  <span m='4180830'>would</span> <span m='4180920'>be</span> <span m='4181069'>too</span>
  <span m='4181250'>big.</span> <span m='4181850'>Just</span> <span m='4182060'>write</span>
  <span m='4182270'>down</span> <span m='4182569'>their</span> <span m='4182720'>index,</span>
  <span m='4184939'>just</span> <span m='4186170'>store</span> <span m='4187790'>the</span>
  <span m='4187939'>indices.</span> <span m='4191779'>Let's</span> <span m='4191960'>do</span>
  <span m='4192080'>this</span> <span m='4192229'>for</span> <span m='4192359'>banana.</span>
  <span m='4195350'>Banana's</span> <span m='4195830'>over</span> <span m='4196070'>here.</span>
  <span m='4198545'>It'll</span> <span m='4198980'>make</span> <span m='4199180'>my</span>
  <span m='4199310'>life</span> <span m='4199520'>a</span> <span m='4199550'>little</span>
  <span m='4199730'>harder.</span> </p><p><span m='4217090'>Actually,</span> <span
  m='4217430'>they're</span> <span m='4217990'>already</span> <span m='4218260'>here</span>
  <span m='4218500'>in</span> <span m='4218620'>sorted</span> <span m='4218950'>order.</span>
  <span m='4219640'>If</span> <span m='4219970'>dollar</span> <span m='4220240'>sign,</span>
  <span m='4220720'>I'm</span> <span m='4220910'>supposing,</span> <span m='4221630'>is</span>
  <span m='4221800'>first,</span> <span m='4222260'>first</span> <span m='4222720'>suffix</span>
  <span m='4223050'>is</span> <span m='4223180'>$,</span> <span m='4223720'>then</span>
  <span m='4223960'>a-$,</span> <span m='4224690'>then</span> <span m='4224830'>a-n-a-$,</span>
  <span m='4225770'>then</span> <span m='4225940'>a-n-a-n-a-$,</span> <span m='4227470'>then</span>
  <span m='4227650'>banana,</span> <span m='4228460'>then</span> <span m='4228730'>n-a-$,</span>
  <span m='4229720'>then</span> <span m='4229840'>n-a-n-a-$.</span> <span m='4231880'>I'll</span>
  <span m='4232280'>just</span> <span m='4232450'>write</span> <span m='4232650'>that</span>
  <span m='4232750'>down</span> <span m='4233020'>over</span> <span m='4233230'>here.</span>
  <span m='4233980'>$,</span> <span m='4235240'>a-$,</span> <span m='4239290'>a-n-a-$,</span>
  <span m='4245250'>a-n-a-n-a-$,</span> <span m='4247620'>then</span> <span m='4247980'>banana,</span>
  <span m='4251460'>then</span> <span m='4252920'>n-a-$,</span> <span m='4256580'>then</span>
  <span m='4257220'>n-a-n-a-$.</span> <span m='4259420'>If</span> <span m='4259500'>you</span>
  <span m='4259560'>look</span> <span m='4259740'>at</span> <span m='4259830'>these,</span>
  <span m='4260200'>they're</span> <span m='4260400'>indeed</span> <span m='4260790'>in</span>
  <span m='4260910'>sorted</span> <span m='4261270'>order--</span> <span m='4261650'>$,</span>
  <span m='4262220'>a's,</span> <span m='4262890'>b's,</span> <span m='4263510'>n's.</span>
  <span m='4264330'>Everything</span> <span m='4264720'>is</span> <span m='4264840'>sorted</span>
  <span m='4265230'>here</span> <span m='4265380'>lexically.</span> </p><p><span m='4266740'>Now,</span>
  <span m='4267130'>I</span> <span m='4267360'>can't</span> <span m='4267600'>store</span>
  <span m='4267870'>this</span> <span m='4268050'>because</span> <span m='4268260'>it's</span>
  <span m='4268380'>quadratic</span> <span m='4268800'>size.</span> <span m='4269160'>Instead,</span>
  <span m='4269520'>I</span> <span m='4269610'>just</span> <span m='4269760'>write</span>
  <span m='4269940'>down</span> <span m='4270150'>the</span> <span m='4270240'>numbers</span>
  <span m='4270690'>that</span> <span m='4270810'>are</span> <span m='4270900'>down</span>
  <span m='4271140'>there.</span> <span m='4271740'>This</span> <span m='4271890'>was</span>
  <span m='4272100'>the</span> <span m='4272550'>sixth</span> <span m='4272820'>suffix,</span>
  <span m='4273280'>it</span> <span m='4273390'>was</span> <span m='4273480'>starting</span>
  <span m='4273820'>at</span> <span m='4273860'>position</span> <span m='4274260'>6.</span>
  <span m='4274620'>Then</span> <span m='4274860'>5,</span> <span m='4276090'>then</span>
  <span m='4277290'>3,</span> <span m='4278190'>then</span> <span m='4278610'>1,</span>
  <span m='4280160'>then</span> <span m='4280410'>0--</span> <span m='4281370'>that's</span>
  <span m='4281730'>everything--</span> <span m='4283380'>then</span> <span m='4283770'>4,</span>
  <span m='4285150'>then</span> <span m='4285360'>2.</span> <span m='4287010'>This</span>
  <span m='4287310'>thing</span> <span m='4288900'>is</span> <span m='4289060'>the</span>
  <span m='4289140'>suffix</span> <span m='4289590'>array.</span> <span m='4291810'>It</span>
  <span m='4291960'>also</span> <span m='4292260'>has</span> <span m='4292560'>linear</span>
  <span m='4292860'>size.</span> <span m='4293550'>It's</span> <span m='4293700'>just</span>
  <span m='4294300'>a</span> <span m='4294330'>permutation</span> <span m='4295200'>on</span>
  <span m='4295350'>the</span> <span m='4295440'>suffix</span> <span m='4295890'>labels,</span>
  <span m='4296880'>suffix</span> <span m='4297270'>indices.</span> <span m='4306115'>I</span>
  <span m='4306600'>still</span> <span m='4306930'>want</span> <span m='4307060'>to</span>
  <span m='4307120'>tell</span> <span m='4307300'>you</span> <span m='4307390'>about</span>
  <span m='4307630'>it.</span> </p><p><span m='4308920'>There's</span> <span m='4309070'>some</span>
  <span m='4309250'>other</span> <span m='4309430'>information</span> <span m='4309970'>that's</span>
  <span m='4310240'>helpful</span> <span m='4310630'>to</span> <span m='4310720'>write</span>
  <span m='4310930'>down</span> <span m='4311200'>about</span> <span m='4312250'>the</span>
  <span m='4314710'>suffix</span> <span m='4315130'>array.</span> <span m='4315630'>It's</span>
  <span m='4315760'>called</span> <span m='4316670'>longest</span> <span m='4317020'>common</span>
  <span m='4317350'>prefix</span> <span m='4317830'>information,</span> <span m='4318340'>LCP.</span>
  <span m='4319600'>The</span> <span m='4319690'>idea</span> <span m='4319930'>is</span>
  <span m='4320020'>to</span> <span m='4320110'>look</span> <span m='4320320'>at</span>
  <span m='4320410'>adjacent</span> <span m='4322120'>elements</span> <span m='4322630'>in</span>
  <span m='4322720'>the</span> <span m='4322810'>suffix</span> <span m='4323170'>array.</span>
  <span m='4323580'>In</span> <span m='4323650'>some</span> <span m='4323860'>sense,</span>
  <span m='4324170'>this</span> <span m='4324190'>represents</span> <span m='4324670'>the</span>
  <span m='4324760'>same</span> <span m='4324970'>information,</span> <span m='4325510'>right?</span>
  </p><p><span m='4326080'>Our</span> <span m='4326290'>whole</span> <span m='4326560'>goal</span>
  <span m='4327010'>is</span> <span m='4327190'>to</span> <span m='4327310'>sort</span>
  <span m='4327580'>the</span> <span m='4327670'>suffixes.</span> <span m='4328360'>If</span>
  <span m='4328840'>we</span> <span m='4328930'>could</span> <span m='4329080'>do</span>
  <span m='4329200'>this,</span> <span m='4330920'>then,</span> <span m='4331660'>as</span>
  <span m='4331870'>we'll</span> <span m='4331990'>see,</span> <span m='4332200'>we</span>
  <span m='4332350'>can</span> <span m='4332470'>also</span> <span m='4332770'>build</span>
  <span m='4332980'>this.</span> <span m='4333430'>And</span> <span m='4333520'>this</span>
  <span m='4333700'>is</span> <span m='4333760'>sort</span> <span m='4333940'>of</span>
  <span m='4334030'>what</span> <span m='4334150'>we</span> <span m='4334240'>really</span>
  <span m='4334480'>want.</span> <span m='4335500'>The</span> <span m='4335560'>suffix</span>
  <span m='4335950'>array</span> <span m='4336160'>by</span> <span m='4336310'>itself</span>
  <span m='4336610'>is</span> <span m='4336730'>pretty</span> <span m='4336940'>good</span>
  <span m='4337180'>if</span> <span m='4337360'>you</span> <span m='4337570'>add</span>
  <span m='4337900'>in</span> <span m='4338260'>LCP</span> <span m='4338680'>information.</span>
  </p><p><span m='4339130'>LCP</span> <span m='4339550'>is--</span> <span m='4339640'>what</span>
  <span m='4339790'>is</span> <span m='4339910'>the</span> <span m='4340000'>longest</span>
  <span m='4340300'>common</span> <span m='4340600'>prefix</span> <span m='4341080'>of</span>
  <span m='4341170'>these</span> <span m='4341350'>two</span> <span m='4341500'>suffixes?</span>
  <span m='4341815'>In</span> <span m='4342130'>this</span> <span m='4342610'>case,</span>
  <span m='4343020'>0.</span> <span m='4343960'>In</span> <span m='4344050'>this</span>
  <span m='4344230'>case,</span> <span m='4345250'>one</span> <span m='4345490'>letter.</span>
  <span m='4346090'>In</span> <span m='4346210'>this</span> <span m='4346390'>case,</span>
  <span m='4347440'>three</span> <span m='4347860'>letters</span> <span m='4348220'>match.</span>
  <span m='4350770'>So</span> <span m='4351040'>here</span> <span m='4351430'>the</span>
  <span m='4351755'>value</span> <span m='4352080'>is</span> <span m='4352450'>3.</span>
  <span m='4353440'>And the</span> <span m='4353710'>next</span> <span m='4353980'>one,</span>
  <span m='4354670'>zero</span> <span m='4354970'>letters</span> <span m='4355270'>match.</span>
  <span m='4356320'>Next</span> <span m='4356560'>one,</span> <span m='4357370'>zero</span>
  <span m='4357730'>letters</span> <span m='4358030'>match.</span> <span m='4359660'>Next</span>
  <span m='4360470'>one,</span> <span m='4362110'>two</span> <span m='4362350'>letters</span>
  <span m='4362710'>match.</span> <span m='4365380'>So</span> <span m='4365530'>this</span>
  <span m='4365710'>is</span> <span m='4365830'>another</span> <span m='4366220'>array</span>
  <span m='4366490'>you</span> <span m='4366580'>could</span> <span m='4366730'>store</span>
  <span m='4367030'>here--</span> <span m='4367720'>0,</span> <span m='4367990'>1,</span>
  <span m='4368260'>3,</span> <span m='4368610'>0,</span> <span m='4368880'>0,</span>
  <span m='4369100'>2.</span> </p><p><span m='4369805'>AUDIENCE:</span> <span m='4370022'>Longest</span>
  <span m='4370240'>common</span> <span m='4370675'>prefix?</span> </p><p><span m='4371980'>ERIK
  DEMAINE:</span> <span m='4372130'>Longest</span> <span m='4372280'>common</span>
  <span m='4372610'>prefix</span> <span m='4373690'>of</span> <span m='4373870'>the</span>
  <span m='4373990'>suffixes.</span> <span m='4376270'>Because</span> <span m='4376480'>each</span>
  <span m='4376660'>of</span> <span m='4376720'>these</span> <span m='4376930'>is</span>
  <span m='4377050'>a</span> <span m='4377140'>suffix</span> <span m='4377740'>but</span>
  <span m='4377920'>here</span> <span m='4378200'>we're</span> <span m='4378400'>interested</span>
  <span m='4378760'>in</span> <span m='4378820'>how</span> <span m='4379030'>long</span>
  <span m='4379300'>they</span> <span m='4379420'>match</span> <span m='4379690'>for.</span>
  </p><p><span m='4381400'>I</span> <span m='4381490'>claim</span> <span m='4381820'>if</span>
  <span m='4381940'>you</span> <span m='4382030'>have</span> <span m='4382300'>this</span>
  <span m='4382450'>suffix</span> <span m='4382840'>array</span> <span m='4383290'>and</span>
  <span m='4383470'>this</span> <span m='4383620'>LCP</span> <span m='4384100'>information,</span>
  <span m='4385360'>you</span> <span m='4385540'>can</span> <span m='4385720'>build</span>
  <span m='4386445'>this</span> <span m='4386750'>structure.</span> <span m='4388570'>Anyone</span>
  <span m='4388970'>wants</span> <span m='4389090'>to</span> <span m='4389140'>tell</span>
  <span m='4389380'>me</span> <span m='4389680'>how</span> <span m='4390040'>to</span>
  <span m='4390190'>build</span> <span m='4391120'>this</span> <span m='4391960'>using</span>
  <span m='4392290'>this?</span> <span m='4392680'>It's</span> <span m='4393055'>a</span>
  <span m='4393430'>one</span> <span m='4394120'>word</span> <span m='4394660'>or</span>
  <span m='4394930'>two</span> <span m='4395140'>word</span> <span m='4395380'>answer</span>
  <span m='4396610'>that</span> <span m='4396730'>we</span> <span m='4396850'>saw,</span>
  <span m='4397600'>I</span> <span m='4397720'>think,</span> <span m='4397930'>last</span>
  <span m='4398200'>class.</span> <span m='4399480'>But</span> <span m='4399730'>we</span>
  <span m='4399880'>saw</span> <span m='4399950'>a</span> <span m='4400020'>lot</span>
  <span m='4400180'>of</span> <span m='4400240'>things</span> <span m='4400510'>last</span>
  <span m='4400750'>class,</span> <span m='4401130'>so</span> <span m='4401310'>it's</span>
  <span m='4401675'>maybe</span> <span m='4402040'>not</span> <span m='4402240'>obvious.</span>
  <span m='4410530'>Magic</span> <span m='4410800'>words</span> <span m='4411160'>are</span>
  <span m='4411760'>Cartesian</span> <span m='4412540'>tree.</span> </p><p><span m='4415570'>Cartesian</span>
  <span m='4416170'>tree</span> <span m='4416440'>was</span> <span m='4416590'>how</span>
  <span m='4416830'>we</span> <span m='4416980'>converted</span> <span m='4419190'>RMQ</span>
  <span m='4420400'>into</span> <span m='4420670'>LCA,</span> <span m='4421970'>I</span>
  <span m='4422020'>think.</span> <span m='4422630'>Yeah?</span> <span m='4423250'>Which</span>
  <span m='4423400'>was</span> <span m='4423610'>you</span> <span m='4423730'>take</span>
  <span m='4423940'>the</span> <span m='4424030'>minimum</span> <span m='4424540'>value</span>
  <span m='4424960'>in</span> <span m='4425080'>the</span> <span m='4425230'>array,</span>
  <span m='4425890'>make</span> <span m='4426100'>that</span> <span m='4426310'>the</span>
  <span m='4426430'>root,</span> <span m='4427270'>and</span> <span m='4427390'>then</span>
  <span m='4427510'>recurse</span> <span m='4427930'>on</span> <span m='4428020'>the</span>
  <span m='4428110'>two</span> <span m='4428260'>sides.</span> <span m='4430480'>So</span>
  <span m='4430640'>a</span> <span m='4430660'>Cartesian</span> <span m='4431170'>tree</span>
  <span m='4431890'>of</span> <span m='4432250'>the</span> <span m='4432430'>LCP</span>
  <span m='4433180'>array,</span> <span m='4434110'>basically,</span> <span m='4434710'>gives</span>
  <span m='4434920'>you</span> <span m='4435010'>this</span> <span m='4435160'>transformation.</span>
  </p><p><span m='4437800'>The</span> <span m='4437920'>minimum</span> <span m='4438220'>values</span>
  <span m='4438550'>here</span> <span m='4438790'>are</span> <span m='4439030'>the</span>
  <span m='4439150'>0's.</span> <span m='4439930'>Now,</span> <span m='4440200'>before</span>
  <span m='4440560'>we</span> <span m='4440800'>just</span> <span m='4441070'>broke</span>
  <span m='4441340'>ties,</span> <span m='4441700'>we</span> <span m='4441820'>picked</span>
  <span m='4442030'>an</span> <span m='4442120'>arbitrary</span> <span m='4442540'>0,</span>
  <span m='4442990'>put</span> <span m='4443170'>it</span> <span m='4443260'>at</span>
  <span m='4443360'>the</span> <span m='4443450'>root.</span> <span m='4444050'>Now</span>
  <span m='4444100'>I</span> <span m='4444160'>want</span> <span m='4444340'>to</span>
  <span m='4444400'>take</span> <span m='4444670'>all</span> <span m='4444910'>the</span>
  <span m='4445000'>0's,</span> <span m='4445870'>put</span> <span m='4446020'>them</span>
  <span m='4446170'>at</span> <span m='4446290'>the</span> <span m='4446380'>root.</span>
  <span m='4447500'>If</span> <span m='4447600'>I</span> <span m='4447700'>do</span>
  <span m='4447760'>that,</span> <span m='4448700'>I</span> <span m='4448720'>get</span>
  <span m='4450310'>three</span> <span m='4450640'>0's</span> <span m='4451120'>at</span>
  <span m='4451240'>the</span> <span m='4451360'>root</span> <span m='4453130'>and</span>
  <span m='4453220'>then</span> <span m='4453370'>I</span> <span m='4453460'>have</span>
  <span m='4454210'>everything</span> <span m='4454660'>in</span> <span m='4454780'>between.</span>
  <span m='4456170'>So</span> <span m='4456220'>there's</span> <span m='4456400'>nothing</span>
  <span m='4456760'>left</span> <span m='4457000'>of</span> <span m='4457060'>the</span>
  <span m='4457150'>first</span> <span m='4457420'>0.</span> <span m='4459430'>Then</span>
  <span m='4459760'>next</span> <span m='4460060'>one,</span> <span m='4460900'>there's</span>
  <span m='4461080'>these</span> <span m='4461320'>guys</span> <span m='4461740'>and</span>
  <span m='4462080'>the</span> <span m='4462390'>mins are</span> <span m='4462690'>going</span>
  <span m='4462830'>to</span> <span m='4462910'>be</span> <span m='4463000'>1</span>
  <span m='4463270'>and</span> <span m='4463380'>then</span> <span m='4463540'>3.</span>
  <span m='4464320'>So</span> <span m='4464440'>here</span> <span m='4464800'>I'm</span>
  <span m='4464890'>going</span> <span m='4465040'>to</span> <span m='4465100'>get</span>
  <span m='4465260'>a</span> <span m='4465400'>1</span> <span m='4466230'>when</span>
  <span m='4466380'>I</span> <span m='4466460'>recurse</span> <span m='4466900'>and</span>
  <span m='4467080'>then</span> <span m='4467440'>3.</span> <span m='4474910'>There's</span>
  <span m='4475090'>nothing</span> <span m='4475390'>in</span> <span m='4475450'>between</span>
  <span m='4475750'>these</span> <span m='4475930'>0's.</span> <span m='4476740'>And</span>
  <span m='4476970'>after</span> <span m='4477280'>the</span> <span m='4477370'>last</span>
  <span m='4477640'>0,</span> <span m='4477850'>there's</span> <span m='4478040'>a</span>
  <span m='4478120'>2.</span> </p><p><span m='4479380'>So</span> <span m='4479500'>this</span>
  <span m='4479710'>would</span> <span m='4479830'>be</span> <span m='4479950'>the</span>
  <span m='4480070'>Cartesian</span> <span m='4480640'>tree,</span> <span m='4481150'>a</span>
  <span m='4481210'>slightly</span> <span m='4481540'>different</span> <span m='4481840'>version</span>
  <span m='4482260'>where</span> <span m='4482920'>we</span> <span m='4483010'>don't</span>
  <span m='4483190'>break</span> <span m='4483400'>ties,</span> <span m='4483760'>we</span>
  <span m='4483820'>take</span> <span m='4484030'>all</span> <span m='4484270'>the</span>
  <span m='4484380'>mins</span> <span m='4484600'>simultaneously,</span> <span m='4485800'>put</span>
  <span m='4485950'>them</span> <span m='4486100'>at</span> <span m='4486190'>the</span>
  <span m='4486280'>root.</span> <span m='4487670'>Now,</span> <span m='4487720'>does</span>
  <span m='4487900'>that</span> <span m='4488080'>look</span> <span m='4488260'>like</span>
  <span m='4488470'>this</span> <span m='4488710'>thing?</span> <span m='4490300'>Yeah.</span>
  <span m='4491140'>Everything</span> <span m='4491500'>except</span> <span m='4491740'>the</span>
  <span m='4491830'>leaves.</span> <span m='4492085'>[INAUDIBLE]</span> <span m='4492340'>are</span>
  <span m='4492580'>missing</span> <span m='4492880'>at</span> <span m='4492940'>the</span>
  <span m='4493060'>leaves.</span> <span m='4493960'>The</span> <span m='4494050'>leaves</span>
  <span m='4494380'>are</span> <span m='4494440'>represented</span> <span m='4494920'>by</span>
  <span m='4495070'>these</span> <span m='4495280'>values.</span> <span m='4497170'>Just</span>
  <span m='4498040'>visit</span> <span m='4498370'>them</span> <span m='4498550'>in</span>
  <span m='4498670'>order</span> <span m='4498940'>here,</span> <span m='4499510'>do</span>
  <span m='4499630'>an</span> <span m='4499720'>inner</span> <span m='4499990'>traversal</span>
  <span m='4500410'>of</span> <span m='4500500'>the</span> <span m='4500590'>missing</span>
  <span m='4501250'>pointers</span> <span m='4501610'>here.</span> <span m='4502270'>We're</span>
  <span m='4502390'>going</span> <span m='4502510'>to</span> <span m='4502600'>get</span>
  <span m='4502900'>6,</span> <span m='4504250'>and</span> <span m='4504370'>then</span>
  <span m='4505420'>5,</span> <span m='4506680'>and</span> <span m='4506830'>then</span>
  <span m='4507910'>3</span> <span m='4508936'>and</span> <span m='4509392'>then</span>
  <span m='4510760'>1,</span> <span m='4512260'>and</span> <span m='4512760'>then</span>
  <span m='4514260'>0,</span> <span m='4515760'>and</span> <span m='4516213'>then</span>
  <span m='4516666'>4,</span> <span m='4518050'>and</span> <span m='4518200'>then</span>
  <span m='4518470'>2.</span> </p><p><span m='4519730'>Now,</span> <span m='4519850'>the</span>
  <span m='4519940'>meaning</span> <span m='4520300'>of</span> <span m='4520390'>these</span>
  <span m='4520810'>values</span> <span m='4521230'>is</span> <span m='4521320'>slightly</span>
  <span m='4521650'>different.</span> <span m='4521900'>Maybe</span> <span m='4522130'>I</span>
  <span m='4522190'>should</span> <span m='4522340'>circle</span> <span m='4522640'>them</span>
  <span m='4522790'>in</span> <span m='4522910'>red.</span> <span m='4524740'>These</span>
  <span m='4525670'>leaves</span> <span m='4526310'>are</span> <span m='4526490'>just</span>
  <span m='4526870'>like</span> <span m='4527080'>these</span> <span m='4527290'>leaves.</span>
  <span m='4527570'>They're</span> <span m='4527640'>exactly</span> <span m='4528070'>the</span>
  <span m='4528160'>labels</span> <span m='4528490'>we</span> <span m='4528620'>wrote</span>
  <span m='4528790'>down</span> <span m='4529510'>in</span> <span m='4529600'>the</span>
  <span m='4529660'>same</span> <span m='4529930'>order.</span> <span m='4530630'>These</span>
  <span m='4530770'>numbers</span> <span m='4531190'>are</span> <span m='4531280'>slightly</span>
  <span m='4531640'>different.</span> <span m='4531930'>What</span> <span m='4532060'>they</span>
  <span m='4532210'>represent</span> <span m='4532660'>are</span> <span m='4532870'>letter</span>
  <span m='4533170'>depths.</span> <span m='4534220'>The</span> <span m='4534310'>letter</span>
  <span m='4534510'>depth of</span> <span m='4534690'>this</span> <span m='4534870'>node
  is</span> <span m='4535030'>0,</span> <span m='4535390'>letter</span> <span m='4535670'>depth
  of</span> <span m='4535840'>this</span> <span m='4535990'>node is</span> <span m='4536230'>1,</span>
  <span m='4536530'>letter</span> <span m='4536800'>depth of</span> <span m='4537010'>this</span>
  <span m='4537160'>node</span> <span m='4537250'>is</span> <span m='4537380'>3.</span>
  <span m='4537670'>That's</span> <span m='4537880'>what</span> <span m='4538000'>I</span>
  <span m='4538060'>wrote</span> <span m='4538240'>here--</span> <span m='4538420'>1,</span>
  <span m='4539080'>3,</span> <span m='4539950'>2.</span> <span m='4540804'>This</span>
  <span m='4541231'>one</span> <span m='4541660'>says,</span> <span m='4541950'>2.</span>
  <span m='4542240'>These</span> <span m='4542440'>LCPs</span> <span m='4542725'>are</span>
  <span m='4543010'>exactly</span> <span m='4543490'>the</span> <span m='4543590'>letter</span>
  <span m='4543830'>depth.</span> <span m='4544000'>That's</span> <span m='4544150'>how</span>
  <span m='4544450'>far</span> <span m='4544690'>down</span> <span m='4544930'>the</span>
  <span m='4545020'>tree</span> <span m='4545230'>you</span> <span m='4545410'>are.</span>
  </p><p><span m='4546130'>Once</span> <span m='4546370'>you</span> <span m='4546460'>have</span>
  <span m='4546670'>this</span> <span m='4546790'>structure</span> <span m='4547240'>and</span>
  <span m='4547420'>the</span> <span m='4547510'>letter</span> <span m='4547750'>depth,</span>
  <span m='4548050'>you</span> <span m='4548140'>can</span> <span m='4548290'>very</span>
  <span m='4548470'>easily</span> <span m='4548860'>put</span> <span m='4549040'>in</span>
  <span m='4549250'>these</span> <span m='4549430'>labels.</span> <span m='4550265'>I</span>
  <span m='4550590'>won't</span> <span m='4550690'>say</span> <span m='4550840'>how</span>
  <span m='4550990'>to</span> <span m='4551080'>do</span> <span m='4551200'>that.</span>
  <span m='4551410'>But</span> <span m='4551950'>in</span> <span m='4552070'>linear</span>
  <span m='4552340'>time,</span> <span m='4552670'>if</span> <span m='4552790'>I</span>
  <span m='4552880'>could</span> <span m='4553000'>build</span> <span m='4553210'>the</span>
  <span m='4553270'>suffix</span> <span m='4553720'>array</span> <span m='4554290'>plus</span>
  <span m='4554530'>the</span> <span m='4554620'>LCPs,</span> <span m='4555940'>I</span>
  <span m='4556060'>could</span> <span m='4556240'>build</span> <span m='4556990'>suffix</span>
  <span m='4557380'>tree.</span> <span m='4559030'>So</span> <span m='4559210'>our</span>
  <span m='4559330'>real</span> <span m='4559600'>goal</span> <span m='4559900'>is</span>
  <span m='4560050'>to</span> <span m='4560170'>build</span> <span m='4561010'>this</span>
  <span m='4561220'>information,</span> <span m='4561760'>these</span> <span m='4561970'>two</span>
  <span m='4562180'>arrays.</span> <span m='4562580'>If</span> <span m='4562690'>we</span>
  <span m='4562750'>could</span> <span m='4562860'>do</span> <span m='4563020'>it</span>
  <span m='4563110'>in</span> <span m='4563170'>linear</span> <span m='4563440'>time,</span>
  <span m='4564300'>we'd</span> <span m='4564480'>get</span> <span m='4564640'>a</span>
  <span m='4564700'>suffix</span> <span m='4565090'>tree</span> <span m='4565270'>in</span>
  <span m='4565360'>linear</span> <span m='4565630'>time.</span> <span m='4567470'>So</span>
  <span m='4568100'>that</span> <span m='4568330'>is</span> <span m='4569050'>what</span>
  <span m='4569230'>remains</span> <span m='4569530'>to</span> <span m='4569650'>be</span>
  <span m='4569740'>done.</span> </p><p><span m='4577570'>We're</span> <span m='4577660'>going</span>
  <span m='4577780'>to</span> <span m='4577870'>do--</span> <span m='4584565'>not</span>
  <span m='4584950'>quite</span> <span m='4585400'>linear</span> <span m='4585670'>time.</span>
  <span m='4587200'>If</span> <span m='4587380'>you</span> <span m='4587530'>want</span>
  <span m='4587760'>a</span> <span m='4587830'>nicely</span> <span m='4588520'>sorted</span>
  <span m='4590110'>suffix</span> <span m='4590620'>tree</span> <span m='4590890'>where</span>
  <span m='4591100'>all</span> <span m='4591250'>the</span> <span m='4591430'>children</span>
  <span m='4591850'>are</span> <span m='4591940'>labeled</span> <span m='4592360'>here--</span>
  <span m='4593830'>so</span> <span m='4594070'>in</span> <span m='4594160'>particular,</span>
  <span m='4594860'>if</span> <span m='4594910'>I</span> <span m='4594970'>just</span>
  <span m='4595150'>had</span> <span m='4595270'>a</span> <span m='4595300'>single</span>
  <span m='4595630'>node,</span> <span m='4596020'>I</span> <span m='4596140'>have</span>
  <span m='4596380'>to</span> <span m='4596500'>be</span> <span m='4596590'>able</span>
  <span m='4596740'>to</span> <span m='4596860'>sort</span> <span m='4597310'>the</span>
  <span m='4597430'>letters</span> <span m='4597700'>in</span> <span m='4597790'>the</span>
  <span m='4597910'>alphabet.</span> <span m='4599650'>However</span> <span m='4599920'>long</span>
  <span m='4600130'>that</span> <span m='4600310'>takes.</span> <span m='4601090'>Maybe</span>
  <span m='4601390'>it's</span> <span m='4601530'>a</span> <span m='4601570'>small</span>
  <span m='4601870'>alphabet</span> <span m='4602145'>and</span> <span m='4602420'>you</span>
  <span m='4602560'>can</span> <span m='4602680'>do</span> <span m='4602780'>linear</span>
  <span m='4603040'>time</span> <span m='4603250'>sorting</span> <span m='4603610'>by</span>
  <span m='4603730'>radix</span> <span m='4604030'>sort</span> <span m='4604270'>or</span>
  <span m='4604330'>whatever.</span> <span m='4605500'>However</span> <span m='4605770'>long</span>
  <span m='4605950'>that</span> <span m='4606070'>takes,</span> <span m='4606280'>we</span>
  <span m='4606340'>do</span> <span m='4606460'>it</span> <span m='4606520'>once.</span>
  <span m='4607260'>Then</span> <span m='4607390'>the</span> <span m='4607480'>rest</span>
  <span m='4607750'>will</span> <span m='4607870'>be</span> <span m='4608050'>order</span>
  <span m='4608290'>T</span> <span m='4608970'>time.</span> </p><p><span m='4610460'>Here's</span>
  <span m='4610510'>how</span> <span m='4610600'>we</span> <span m='4610720'>do</span>
  <span m='4610840'>it.</span> <span m='4611210'>First</span> <span m='4611320'>step--</span>
  <span m='4612010'>sort</span> <span m='4612280'>the</span> <span m='4612370'>alphabet.</span>
  <span m='4614430'>This</span> <span m='4614590'>will</span> <span m='4614710'>turn</span>
  <span m='4614920'>out</span> <span m='4615010'>to</span> <span m='4615070'>be</span>
  <span m='4615190'>more</span> <span m='4615340'>interesting</span> <span m='4615940'>than</span>
  <span m='4616180'>you</span> <span m='4616300'>might</span> <span m='4616480'>think.</span>
  <span m='4617170'>I'll</span> <span m='4617260'>come</span> <span m='4617440'>back</span>
  <span m='4617650'>to</span> <span m='4617770'>it.</span> <span m='4618430'>Second</span>
  <span m='4618760'>step--</span> <span m='4619990'>replace</span> <span m='4620410'>each</span>
  <span m='4620560'>letter</span> <span m='4621250'>by</span> <span m='4621400'>its</span>
  <span m='4621550'>index</span> <span m='4621940'>in</span> <span m='4622030'>the</span>
  <span m='4622090'>sorted</span> <span m='4622420'>order.</span> <span m='4623920'>This</span>
  <span m='4624070'>sounds</span> <span m='4624700'>boring</span> <span m='4625390'>but</span>
  <span m='4625660'>it</span> <span m='4625750'>will</span> <span m='4625930'>be</span>
  <span m='4626050'>useful</span> <span m='4626650'>for</span> <span m='4626830'>later.</span>
  <span m='4635710'>Third</span> <span m='4635950'>step--</span> <span m='4637030'>the</span>
  <span m='4637150'>big</span> <span m='4637330'>idea.</span> <span m='4639670'>This</span>
  <span m='4639850'>is</span> <span m='4639970'>an</span> <span m='4640060'>algorithm</span>
  <span m='4640480'>by</span> <span m='4641160'>Karkkainen</span> <span m='4642010'>and</span>
  <span m='4642250'>Sanders,</span> <span m='4643180'>from</span> <span m='4643480'>2003.</span>
  </p><p><span m='4645750'>The</span> <span m='4645810'>problem</span> <span m='4646090'>was</span>
  <span m='4646270'>first</span> <span m='4646600'>solved</span> <span m='4647080'>in</span>
  <span m='4647200'>this</span> <span m='4647380'>running</span> <span m='4647650'>time</span>
  <span m='4647950'>by</span> <span m='4648100'>Martin</span> <span m='4648380'>Farach-Colton,</span>
  <span m='4649240'>our</span> <span m='4649390'>good</span> <span m='4649570'>friend.</span>
  <span m='4651640'>But</span> <span m='4651820'>then</span> <span m='4652090'>it</span>
  <span m='4652180'>got</span> <span m='4652390'>simplified.</span> <span m='4653260'>So</span>
  <span m='4654010'>I'll</span> <span m='4654100'>tell</span> <span m='4654280'>you</span>
  <span m='4654370'>a</span> <span m='4654400'>little</span> <span m='4654580'>bit</span>
  <span m='4654700'>about</span> <span m='4654940'>that</span> <span m='4655270'>in</span>
  <span m='4655585'>a</span> <span m='4655900'>moment.</span> <span m='4658750'>And</span>
  <span m='4659280'>there</span> <span m='4659540'>going to</span> <span m='4659680'>be</span>
  <span m='4659860'>a</span> <span m='4659920'>lot</span> <span m='4660190'>of</span>
  <span m='4660370'>writing</span> <span m='4660850'>here.</span> </p><p><span m='4672880'>The</span>
  <span m='4673000'>idea</span> <span m='4673300'>here</span> <span m='4673660'>is</span>
  <span m='4673980'>we're going to</span> <span m='4674080'>take</span> <span m='4674470'>the</span>
  <span m='4674710'>3i-th</span> <span m='4675160'>letter,</span> <span m='4675410'>3i
  plus</span> <span m='4675880'>first,</span> <span m='4676120'>3i plus</span> <span
  m='4676290'>second</span> <span m='4676840'>letter,</span> <span m='4677440'>concatenate</span>
  <span m='4678100'>them</span> <span m='4678250'>into</span> <span m='4678490'>a</span>
  <span m='4678550'>single</span> <span m='4679030'>triple</span> <span m='4679360'>letter--</span>
  <span m='4680020'>think</span> <span m='4680200'>of</span> <span m='4680260'>it</span>
  <span m='4680320'>as</span> <span m='4680440'>a</span> <span m='4680500'>single</span>
  <span m='4680800'>letter.</span> <span m='4681800'>And</span> <span m='4681850'>then</span>
  <span m='4682030'>just</span> <span m='4682360'>do</span> <span m='4682510'>that</span>
  <span m='4682660'>for</span> <span m='4682840'>all</span> <span m='4683050'>i.</span>
  <span m='4683540'>So</span> <span m='4683860'>it's</span> <span m='4683950'>like</span>
  <span m='4684190'>I</span> <span m='4684280'>take</span> <span m='4684460'>these</span>
  <span m='4684640'>guys,</span> <span m='4684850'>make</span> <span m='4685020'>them</span>
  <span m='4685110'>one</span> <span m='4685300'>letter,</span> <span m='4685510'>these</span>
  <span m='4685690'>guys,</span> <span m='4685900'>make</span> <span m='4686080'>them</span>
  <span m='4686190'>one</span> <span m='4686350'>letter.</span> </p><p><span m='4687070'>Now,</span>
  <span m='4687190'>I</span> <span m='4687250'>could</span> <span m='4687490'>start</span>
  <span m='4687760'>at</span> <span m='4687850'>0,</span> <span m='4688630'>or</span>
  <span m='4688870'>I</span> <span m='4688930'>could</span> <span m='4689080'>start</span>
  <span m='4689290'>at</span> <span m='4689380'>1,</span> <span m='4690100'>or</span>
  <span m='4690330'>I</span> <span m='4690430'>could</span> <span m='4690550'>start
  at</span> <span m='4690820'>2.</span> <span m='4692230'>Do</span> <span m='4692380'>them</span>
  <span m='4692530'>all.</span> <span m='4694260'>So</span> <span m='4695560'>this</span>
  <span m='4695740'>is</span> <span m='4695860'>going</span> <span m='4696010'>to</span>
  <span m='4696100'>be</span> <span m='4696540'>3i</span> <span m='4696970'>plus</span>
  <span m='4697480'>1,</span> <span m='4698920'>3i</span> <span m='4699370'>plus</span>
  <span m='4699790'>2,</span> <span m='4700990'>3i</span> <span m='4701410'>plus</span>
  <span m='4701710'>3.</span> <span m='4702910'>And</span> <span m='4703000'>this
  one</span> <span m='4703240'>is</span> <span m='4703300'>going</span> <span m='4703480'>to</span>
  <span m='4703540'>be</span> <span m='4703780'>3i</span> <span m='4704350'>plus</span>
  <span m='4704980'>2,</span> <span m='4706000'>3i</span> <span m='4706720'>plus</span>
  <span m='4707210'>3,</span> <span m='4708280'>3i</span> <span m='4708970'>plus</span>
  <span m='4709570'>4.</span> <span m='4712390'>We're</span> <span m='4712480'>going</span>
  <span m='4712590'>to</span> <span m='4712660'>do</span> <span m='4712780'>this</span>
  <span m='4712930'>to</span> <span m='4713080'>recurse.</span> </p><p><span m='4713860'>But</span>
  <span m='4714100'>the</span> <span m='4714220'>point</span> <span m='4714460'>is,</span>
  <span m='4715240'>if</span> <span m='4715390'>I</span> <span m='4715450'>want</span>
  <span m='4715720'>to</span> <span m='4715870'>represent</span> <span m='4716320'>all</span>
  <span m='4716560'>the</span> <span m='4716650'>suffixes</span> <span m='4717160'>of</span>
  <span m='4717280'>T,</span> <span m='4718000'>suffix</span> <span m='4718420'>could</span>
  <span m='4718750'>start</span> <span m='4719110'>at</span> <span m='4719230'>a</span>
  <span m='4719290'>position</span> <span m='4719680'>0</span> <span m='4719950'>mod</span>
  <span m='4720160'>3,</span> <span m='4720430'>or</span> <span m='4720640'>position</span>
  <span m='4721030'>1</span> <span m='4721240'>mod</span> <span m='4721390'>3,</span>
  <span m='4721600'>or</span> <span m='4721810'>position</span> <span m='4722470'>2</span>
  <span m='4722620'>mod</span> <span m='4722830'>3.</span> <span m='4723800'>So</span>
  <span m='4723820'>if</span> <span m='4723910'>I</span> <span m='4724000'>could</span>
  <span m='4724480'>sort</span> <span m='4724810'>all</span> <span m='4724960'>the</span>
  <span m='4725050'>suffixes</span> <span m='4725530'>of</span> <span m='4725650'>these</span>
  <span m='4725830'>guys,</span> <span m='4726250'>I</span> <span m='4726370'>would</span>
  <span m='4726520'>effectively</span> <span m='4727030'>sort</span> <span m='4727330'>all</span>
  <span m='4727480'>the</span> <span m='4727540'>suffixes</span> <span m='4728050'>of</span>
  <span m='4728110'>the</span> <span m='4728170'>original</span> <span m='4728530'>T.</span>
  <span m='4729120'>This</span> <span m='4729280'>tripling</span> <span m='4729730'>up</span>
  <span m='4729880'>doesn't</span> <span m='4730120'>really</span> <span m='4730330'>change</span>
  <span m='4730630'>things,</span> <span m='4731800'>up</span> <span m='4732010'>to</span>
  <span m='4732220'>like</span> <span m='4732550'>plus</span> <span m='4733240'>1</span>
  <span m='4733480'>or</span> <span m='4733580'>2.</span> </p><p><span m='4743500'>Next,</span>
  <span m='4743830'>I</span> <span m='4743890'>believe,</span> <span m='4744280'>is</span>
  <span m='4744520'>recursion.</span> <span m='4753726'>I'm</span> <span m='4754120'>going</span>
  <span m='4754240'>to</span> <span m='4754300'>take</span> <span m='4754490'>T0</span>
  <span m='4755230'>and</span> <span m='4755380'>T1</span> <span m='4755980'>and</span>
  <span m='4756100'>concatenate</span> <span m='4756760'>them.</span> <span m='4758320'>This</span>
  <span m='4758530'>thing</span> <span m='4758740'>has</span> <span m='4759040'>size</span>
  <span m='4759670'>2/3</span> <span m='4760300'>n.</span> <span m='4761320'>It</span>
  <span m='4761850'>has</span> <span m='4762090'>number</span> <span m='4762340'>of</span>
  <span m='4762460'>characters</span> <span m='4763030'>2/3</span> <span m='4763480'>n</span>
  <span m='4763750'>because</span> <span m='4764110'>each</span> <span m='4764260'>of</span>
  <span m='4764320'>them</span> <span m='4764500'>has</span> <span m='4764710'>a</span>
  <span m='4765010'>third</span> <span m='4765250'>of</span> <span m='4765370'>the</span>
  <span m='4765640'>number</span> <span m='4765910'>of</span> <span m='4766000'>characters.</span>
  <span m='4766420'>Of</span> <span m='4766480'>course,</span> <span m='4766690'>all</span>
  <span m='4766780'>the</span> <span m='4766870'>information</span> <span m='4767350'>is</span>
  <span m='4767410'>still</span> <span m='4767620'>there,</span> <span m='4768020'>which</span>
  <span m='4768040'>is</span> <span m='4768130'>kind</span> <span m='4768280'>of</span>
  <span m='4768340'>weird.</span> </p><p><span m='4768620'>But</span> <span m='4769070'>if</span>
  <span m='4769150'>we</span> <span m='4769210'>treat</span> <span m='4769420'>this</span>
  <span m='4769630'>as</span> <span m='4770320'>a</span> <span m='4770380'>single</span>
  <span m='4770680'>character,</span> <span m='4771550'>which</span> <span m='4771680'>then</span>
  <span m='4771820'>has</span> <span m='4771970'>a</span> <span m='4772030'>1/3</span>
  <span m='4772300'>n,</span> <span m='4772450'>we</span> <span m='4772570'>can't</span>
  <span m='4772840'>afford</span> <span m='4773290'>to</span> <span m='4773440'>recurse</span>
  <span m='4774340'>on</span> <span m='4774490'>all</span> <span m='4774670'>three.</span>
  <span m='4775435'>We</span> <span m='4775690'>can</span> <span m='4775810'>only</span>
  <span m='4776110'>afford</span> <span m='4776440'>to</span> <span m='4776560'>recurse</span>
  <span m='4776890'>on</span> <span m='4777040'>two</span> <span m='4777280'>out</span>
  <span m='4777370'>of</span> <span m='4777430'>the</span> <span m='4777580'>three</span>
  <span m='4777850'>because</span> <span m='4778090'>then</span> <span m='4778270'>we're</span>
  <span m='4778360'>going</span> <span m='4778480'>to</span> <span m='4778570'>get</span>
  <span m='4778740'>a</span> <span m='4779170'>recurrence</span> <span m='4779740'>of</span>
  <span m='4779800'>the</span> <span m='4779920'>form</span> <span m='4780290'>T of</span>
  <span m='4780570'>n</span> <span m='4780850'>is</span> <span m='4781900'>T</span>
  <span m='4782350'>of</span> <span m='4782590'>2/3</span> <span m='4783190'>n</span>
  <span m='4784420'>plus</span> <span m='4784780'>order</span> <span m='4785020'>n.</span>
  <span m='4786370'>And</span> <span m='4786520'>this</span> <span m='4786700'>is</span>
  <span m='4786820'>geometric,</span> <span m='4787225'>so</span> <span m='4787630'>it's</span>
  <span m='4787840'>order</span> <span m='4788110'>n.</span> <span m='4788950'>That's</span>
  <span m='4789150'>how</span> <span m='4789280'>we're</span> <span m='4789400'>going</span>
  <span m='4789530'>to</span> <span m='4789570'>get</span> <span m='4789730'>linear</span>
  <span m='4790000'>time</span> <span m='4790390'>after</span> <span m='4790720'>the</span>
  <span m='4790870'>first</span> <span m='4791110'>sort.</span> <span m='4793630'>If</span>
  <span m='4793810'>this</span> <span m='4793960'>was</span> <span m='4794050'>3/3</span>
  <span m='4794590'>n,</span> <span m='4794830'>then</span> <span m='4794950'>this</span>
  <span m='4795100'>would</span> <span m='4795190'>be</span> <span m='4795300'>n</span>
  <span m='4795430'>log</span> <span m='4795660'>n.</span> <span m='4796000'>We</span>
  <span m='4796120'>don't</span> <span m='4796240'>want</span> <span m='4796360'>to</span>
  <span m='4796420'>do</span> <span m='4796540'>that.</span> </p><p><span m='4798310'>So</span>
  <span m='4798430'>that's</span> <span m='4798640'>what</span> <span m='4798790'>I</span>
  <span m='4798850'>can</span> <span m='4799000'>afford.</span> <span m='4800050'>Now</span>
  <span m='4800230'>I've</span> <span m='4800290'>got</span> <span m='4800410'>to</span>
  <span m='4800500'>deal</span> <span m='4800740'>with</span> <span m='4800920'>it.</span>
  <span m='4801040'>What</span> <span m='4801190'>this</span> <span m='4801340'>tells</span>
  <span m='4801640'>me</span> <span m='4801790'>is,</span> <span m='4801970'>the</span>
  <span m='4802090'>sorted</span> <span m='4802420'>order</span> <span m='4802660'>of</span>
  <span m='4802780'>all</span> <span m='4803020'>the</span> <span m='4803110'>suffixes</span>
  <span m='4803680'>of</span> <span m='4803790'>T0</span> <span m='4804130'>and</span>
  <span m='4804310'>T1,</span> <span m='4804670'>all</span> <span m='4804820'>the</span>
  <span m='4804910'>suffixes</span> <span m='4805420'>starting</span> <span m='4805930'>at</span>
  <span m='4806620'>positions</span> <span m='4807010'>that</span> <span m='4807130'>are</span>
  <span m='4807190'>0</span> <span m='4807520'>or</span> <span m='4807700'>1</span>
  <span m='4807970'>mod</span> <span m='4808270'>3.</span> </p><p><span m='4812140'>Next</span>
  <span m='4812350'>thing</span> <span m='4812500'>we'd</span> <span m='4812590'>like</span>
  <span m='4812770'>to</span> <span m='4812860'>do</span> <span m='4813670'>is</span>
  <span m='4814570'>sort</span> <span m='4815020'>the</span> <span m='4815110'>suffixes</span>
  <span m='4815740'>of</span> <span m='4816330'>T2.</span> <span m='4817840'>We</span>
  <span m='4817900'>can</span> <span m='4818050'>do</span> <span m='4818170'>that,</span>
  <span m='4818370'>I</span> <span m='4818440'>claim,</span> <span m='4819220'>by</span>
  <span m='4819460'>radix</span> <span m='4819820'>sort.</span> <span m='4826160'>How</span>
  <span m='4826250'>do</span> <span m='4826340'>we</span> <span m='4826430'>do</span>
  <span m='4826580'>that?</span> <span m='4827190'>Well,</span> <span m='4827390'>if</span>
  <span m='4827480'>you</span> <span m='4827600'>look</span> <span m='4827840'>at</span>
  <span m='4828010'>a</span> <span m='4828110'>suffix</span> <span m='4828660'>T</span>
  <span m='4828840'>2i,</span> <span m='4830240'>this</span> <span m='4830480'>is</span>
  <span m='4830720'>the</span> <span m='4830840'>same</span> <span m='4831140'>thing</span>
  <span m='4832130'>as</span> <span m='4832560'>T</span> <span m='4833060'>from</span>
  <span m='4833480'>3i</span> <span m='4834050'>plus</span> <span m='4834530'>2</span>
  <span m='4835070'>onwards.</span> <span m='4837320'>Which</span> <span m='4837560'>we</span>
  <span m='4837710'>can</span> <span m='4837860'>think</span> <span m='4838130'>of</span>
  <span m='4838340'>as</span> <span m='4838670'>that</span> <span m='4838880'>first</span>
  <span m='4839150'>character,</span> <span m='4841670'>comma,</span> <span m='4843180'>the</span>
  <span m='4843280'>next</span> <span m='4843560'>character</span> <span m='4844010'>onwards.</span>
  <span m='4848840'>Sorry,</span> <span m='4849170'>that's</span> <span m='4849450'>the</span>
  <span m='4850130'>angle</span> <span m='4850430'>bracket.</span> </p><p><span m='4851150'>And</span>
  <span m='4851270'>this</span> <span m='4851480'>thing</span> <span m='4851810'>is,</span>
  <span m='4851930'>basically,</span> <span m='4852410'>T0</span> <span m='4853570'>of</span>
  <span m='4853780'>i</span> <span m='4853940'>plus</span> <span m='4854240'>1</span>
  <span m='4855020'>onwards.</span> <span m='4856680'>So</span> <span m='4856910'>if</span>
  <span m='4857030'>I</span> <span m='4857120'>strip</span> <span m='4857480'>off</span>
  <span m='4857630'>the</span> <span m='4857750'>first</span> <span m='4857960'>letter,</span>
  <span m='4858260'>then</span> <span m='4858500'>I</span> <span m='4858590'>get</span>
  <span m='4858740'>a</span> <span m='4858800'>suffix</span> <span m='4859190'>that</span>
  <span m='4859340'>I</span> <span m='4859400'>know</span> <span m='4859640'>about.</span>
  <span m='4860000'>I</span> <span m='4860090'>know</span> <span m='4860390'>the</span>
  <span m='4860480'>sorted</span> <span m='4860810'>order</span> <span m='4860990'>of</span>
  <span m='4861080'>all</span> <span m='4861230'>the</span> <span m='4861290'>T0</span>
  <span m='4861710'>suffixes.</span> <span m='4862910'>So</span> <span m='4863030'>this</span>
  <span m='4863270'>is</span> <span m='4863360'>really</span> <span m='4863630'>just</span>
  <span m='4863880'>a--</span> <span m='4864230'>you</span> <span m='4864350'>can</span>
  <span m='4864500'>think</span> <span m='4864620'>of</span> <span m='4864680'>this</span>
  <span m='4864830'>as</span> <span m='4864920'>a</span> <span m='4865010'>two</span>
  <span m='4865220'>character</span> <span m='4866180'>value.</span> </p><p><span
  m='4866780'>There's</span> <span m='4866930'>a</span> <span m='4866990'>single</span>
  <span m='4867290'>character</span> <span m='4867650'>from</span> <span m='4867860'>Sigma</span>
  <span m='4868220'>here,</span> <span m='4869690'>which</span> <span m='4869930'>we've</span>
  <span m='4870140'>already</span> <span m='4870650'>reduced</span> <span m='4871190'>down</span>
  <span m='4871550'>to--</span> <span m='4872660'>this</span> <span m='4872840'>is</span>
  <span m='4872960'>an</span> <span m='4873080'>integer</span> <span m='4874040'>between</span>
  <span m='4874550'>0</span> <span m='4875450'>and</span> <span m='4875720'>Sigma</span>
  <span m='4876080'>minus</span> <span m='4876410'>1.</span> <span m='4878210'>This</span>
  <span m='4878420'>thing</span> <span m='4878810'>you</span> <span m='4878960'>can</span>
  <span m='4879110'>do</span> <span m='4879620'>the</span> <span m='4879770'>same</span>
  <span m='4880040'>thing</span> <span m='4880280'>with</span> <span m='4880400'>these</span>
  <span m='4880700'>recursive</span> <span m='4881150'>values.</span> <span m='4882110'>So</span>
  <span m='4882230'>you've</span> <span m='4882350'>just</span> <span m='4882530'>got</span>
  <span m='4882710'>two</span> <span m='4882950'>values.</span> <span m='4884210'>Small.</span>
  <span m='4884810'>You</span> <span m='4884930'>can</span> <span m='4885080'>radix</span>
  <span m='4885330'>sort</span> <span m='4885530'>them</span> <span m='4885650'>in</span>
  <span m='4885770'>linear</span> <span m='4886010'>time.</span> <span m='4887540'>And</span>
  <span m='4887690'>then</span> <span m='4887900'>we</span> <span m='4888200'>will</span>
  <span m='4888380'>have</span> <span m='4888590'>sorted</span> <span m='4889120'>T2</span>
  <span m='4889520'>suffixes</span> <span m='4890180'>because</span> <span m='4890510'>we</span>
  <span m='4890630'>already</span> <span m='4890990'>knew</span> <span m='4891230'>the</span>
  <span m='4891380'>order</span> <span m='4891620'>of</span> <span m='4891680'>these</span>
  <span m='4891890'>guys.</span> </p><p><span m='4894800'>One</span> <span m='4894980'>more</span>
  <span m='4895100'>thing,</span> <span m='4896130'>which</span> <span m='4896270'>we</span>
  <span m='4896330'>have</span> <span m='4896480'>to</span> <span m='4896570'>merge</span>
  <span m='4898880'>suffixes</span> <span m='4899810'>of</span> <span m='4902910'>T0</span>
  <span m='4904010'>and</span> <span m='4904290'>T1</span> <span m='4905780'>with</span>
  <span m='4906860'>suffixes</span> <span m='4911290'>of</span> <span m='4911430'>T2.</span>
  <span m='4912470'>And</span> <span m='4912590'>this</span> <span m='4912830'>is</span>
  <span m='4912950'>where</span> <span m='4915520'>we</span> <span m='4915670'>use</span>
  <span m='4915820'>the</span> <span m='4915910'>fact</span> <span m='4916150'>that</span>
  <span m='4916240'>there</span> <span m='4916390'>are</span> <span m='4916450'>three</span>
  <span m='4916720'>of</span> <span m='4916810'>these</span> <span m='4916990'>things</span>
  <span m='4917230'>and</span> <span m='4917320'>not</span> <span m='4917530'>two</span>
  <span m='4917770'>of</span> <span m='4917860'>them.</span> <span m='4918130'>This</span>
  <span m='4918160'>is</span> <span m='4918280'>a</span> <span m='4918340'>weird</span>
  <span m='4918610'>case</span> <span m='4918910'>where</span> <span m='4919070'>three
  way</span> <span m='4919570'>divide</span> <span m='4919840'>and</span> <span m='4919930'>conquer</span>
  <span m='4920290'>works.</span> <span m='4921040'>Two</span> <span m='4921280'>way</span>
  <span m='4921400'>divide</span> <span m='4921670'>and</span> <span m='4921760'>conquer</span>
  <span m='4922270'>is</span> <span m='4922720'>what</span> <span m='4923080'>Farach-Colton</span>
  <span m='4923620'>did</span> <span m='4923740'>originally.</span> <span m='4924160'>It's</span>
  <span m='4924280'>much</span> <span m='4924580'>more</span> <span m='4924730'>complicated</span>
  <span m='4925360'>because</span> <span m='4925750'>of</span> <span m='4925840'>this</span>
  <span m='4925990'>merge</span> <span m='4926290'>step.</span> <span m='4927070'>Merge</span>
  <span m='4927370'>gets</span> <span m='4927520'>painful.</span> </p><p><span m='4929050'>I</span>
  <span m='4929140'>claim</span> <span m='4929470'>this</span> <span m='4929680'>merging</span>
  <span m='4930070'>is</span> <span m='4930190'>easy</span> <span m='4930730'>because</span>
  <span m='4933160'>merging</span> <span m='4933490'>is</span> <span m='4933580'>linear</span>
  <span m='4933820'>time,</span> <span m='4934060'>provided</span> <span m='4934420'>your</span>
  <span m='4934540'>comparison</span> <span m='4935080'>is</span> <span m='4935200'>constant</span>
  <span m='4935640'>time.</span> <span m='4936500'>So</span> <span m='4936520'>if</span>
  <span m='4936610'>I</span> <span m='4936670'>need</span> <span m='4936820'>to</span>
  <span m='4936910'>compare</span> <span m='4937570'>a</span> <span m='4938020'>T0</span>
  <span m='4938650'>suffix</span> <span m='4939130'>with</span> <span m='4939330'>a</span>
  <span m='4939390'>T2</span> <span m='4939850'>suffix,</span> <span m='4941610'>if</span>
  <span m='4941935'>I</span> <span m='4942260'>want</span> <span m='4942430'>to</span>
  <span m='4942490'>do</span> <span m='4942640'>that</span> <span m='4942790'>comparison,</span>
  <span m='4943750'>I</span> <span m='4943840'>strip</span> <span m='4944170'>off</span>
  <span m='4944350'>the</span> <span m='4944440'>first</span> <span m='4944770'>letter</span>
  <span m='4944980'>from</span> <span m='4945160'>this</span> <span m='4945340'>one.</span>
  <span m='4946030'>It</span> <span m='4946120'>turns</span> <span m='4946420'>into</span>
  <span m='4946860'>a</span> <span m='4946900'>T1</span> <span m='4947350'>suffix,</span>
  <span m='4948640'>the</span> <span m='4948730'>first</span> <span m='4948970'>character</span>
  <span m='4949330'>plus</span> <span m='4949600'>a</span> <span m='4949660'>T1</span>
  <span m='4949840'>suffix.</span> <span m='4950155'>If</span> <span m='4950470'>I</span>
  <span m='4950530'>strip</span> <span m='4950770'>out</span> <span m='4950890'>the</span>
  <span m='4950950'>first</span> <span m='4951160'>character of</span> <span m='4951460'>this</span>
  <span m='4951640'>one,</span> <span m='4951880'>it</span> <span m='4952360'>turns</span>
  <span m='4952570'>into</span> <span m='4952870'>the</span> <span m='4952990'>first</span>
  <span m='4953230'>character</span> <span m='4953650'>and</span> <span m='4953770'>then</span>
  <span m='4953920'>a</span> <span m='4954140'>T0</span> <span m='4954490'>suffix.</span>
  <span m='4955810'>And</span> <span m='4955930'>these</span> <span m='4956140'>things</span>
  <span m='4956380'>I</span> <span m='4956440'>know</span> <span m='4956590'>how</span>
  <span m='4956680'>to</span> <span m='4956770'>compare</span> <span m='4957550'>because</span>
  <span m='4957820'>I</span> <span m='4957910'>already</span> <span m='4958150'>sorted</span>
  <span m='4958790'>T0,</span> <span m='4959170'>comma,</span> <span m='4959410'>T1.</span>
  </p><p><span m='4960970'>If</span> <span m='4961150'>I</span> <span m='4961240'>need</span>
  <span m='4961390'>to</span> <span m='4961510'>compare</span> <span m='4961920'>T1</span>
  <span m='4962440'>suffix</span> <span m='4963640'>with</span> <span m='4963800'>the</span>
  <span m='4963880'>T2</span> <span m='4964300'>suffix,</span> <span m='4967900'>how</span>
  <span m='4967990'>do</span> <span m='4968110'>I</span> <span m='4968170'>do</span>
  <span m='4968350'>it?</span> <span m='4968830'>I</span> <span m='4968890'>strip</span>
  <span m='4969190'>off</span> <span m='4969340'>the</span> <span m='4969430'>first</span>
  <span m='4969820'>two</span> <span m='4970090'>letters</span> <span m='4970450'>of</span>
  <span m='4970570'>this</span> <span m='4970750'>one,</span> <span m='4971440'>I</span>
  <span m='4971530'>get</span> <span m='4971710'>a</span> <span m='4971800'>T0</span>
  <span m='4972310'>suffix.</span> <span m='4972850'>I</span> <span m='4972910'>strip</span>
  <span m='4973170'>off</span> <span m='4973300'>the</span> <span m='4973390'>first</span>
  <span m='4973660'>two</span> <span m='4973900'>letters</span> <span m='4974230'>of</span>
  <span m='4974320'>this</span> <span m='4974500'>one,</span> <span m='4975340'>I</span>
  <span m='4975430'>get</span> <span m='4975700'>a</span> <span m='4975850'>T1</span>
  <span m='4976180'>suffix.</span> </p><p><span m='4977380'>I</span> <span m='4977440'>can't</span>
  <span m='4977680'>strip</span> <span m='4977920'>off</span> <span m='4978070'>one</span>
  <span m='4978250'>letter</span> <span m='4978430'>because</span> <span m='4978700'>this</span>
  <span m='4978850'>would</span> <span m='4978970'>turn it</span> <span m='4979120'>into</span>
  <span m='4979330'>a</span> <span m='4979390'>T2</span> <span m='4979840'>and</span>
  <span m='4979930'>I</span> <span m='4979990'>don't</span> <span m='4980110'>know</span>
  <span m='4980230'>how</span> <span m='4980290'>to</span> <span m='4980410'>compare</span>
  <span m='4980710'>T2</span> <span m='4980920'>to</span> <span m='4981130'>other</span>
  <span m='4981340'>things,</span> <span m='4981610'>that's</span> <span m='4981760'>the</span>
  <span m='4981850'>whole</span> <span m='4982000'>point.</span> <span m='4982960'>I</span>
  <span m='4983080'>guess,</span> <span m='4983380'>it's</span> <span m='4983560'>a</span>
  <span m='4983650'>T2</span> <span m='4984100'>versus</span> <span m='4984460'>a</span>
  <span m='4984530'>T0,</span> <span m='4985240'>if</span> <span m='4985360'>I</span>
  <span m='4985420'>did</span> <span m='4985570'>that,</span> <span m='4985750'>which</span>
  <span m='4985930'>is</span> <span m='4986020'>this</span> <span m='4986230'>case.</span>
  <span m='4987330'>But</span> <span m='4987460'>here,</span> <span m='4987860'>I</span>
  <span m='4987940'>strip</span> <span m='4988240'>off</span> <span m='4988360'>two</span>
  <span m='4988540'>letters,</span> <span m='4989200'>I</span> <span m='4989290'>get</span>
  <span m='4989410'>something</span> <span m='4989710'>I</span> <span m='4989800'>know</span>
  <span m='4989950'>how</span> <span m='4990070'>to</span> <span m='4990160'>compare.</span>
  <span m='4990850'>This</span> <span m='4991180'>technique</span> <span m='4991630'>does</span>
  <span m='4991780'>not</span> <span m='4991990'>work</span> <span m='4992230'>if</span>
  <span m='4992350'>you</span> <span m='4992410'>only</span> <span m='4992590'>have</span>
  <span m='4992740'>two</span> <span m='4992920'>things.</span> <span m='4993290'>It</span>
  <span m='4993340'>only</span> <span m='4993580'>works</span> <span m='4993810'>if
  you have</span> <span m='4993990'>three</span> <span m='4994240'>things</span> <span
  m='4995140'>because</span> <span m='4995320'>they're</span> <span m='4995440'>sort</span>
  <span m='4995590'>of</span> <span m='4995710'>these</span> <span m='4995980'>situations.</span>
  </p><p><span m='4997700'>So</span> <span m='4997900'>constant</span> <span m='4998350'>time.</span>
  <span m='4998950'>By</span> <span m='4999070'>comparing</span> <span m='4999470'>these</span>
  <span m='4999670'>little</span> <span m='5000360'>tuples,</span> <span m='5000780'>the</span>
  <span m='5000870'>first</span> <span m='5001140'>character</span> <span m='5001620'>or</span>
  <span m='5001680'>two</span> <span m='5002520'>plus</span> <span m='5003660'>the</span>
  <span m='5003780'>remaining</span> <span m='5004200'>suffix,</span> <span m='5005030'>I</span>
  <span m='5005130'>can</span> <span m='5005280'>do</span> <span m='5005370'>the</span>
  <span m='5005490'>comparator</span> <span m='5006000'>and</span> <span m='5006180'>merge.</span>
  <span m='5007980'>And</span> <span m='5008160'>then</span> <span m='5008460'>if</span>
  <span m='5008580'>I</span> <span m='5008640'>can</span> <span m='5008790'>do</span>
  <span m='5008880'>that,</span> <span m='5009210'>everything</span> <span m='5009720'>is</span>
  <span m='5009840'>linear</span> <span m='5010170'>time.</span> </p><p><span m='5011010'>The</span>
  <span m='5011130'>only</span> <span m='5011370'>interesting</span> <span m='5011790'>thing</span>
  <span m='5012060'>is</span> <span m='5012300'>how</span> <span m='5012510'>do</span>
  <span m='5012660'>I</span> <span m='5012750'>sort</span> <span m='5013020'>the</span>
  <span m='5013140'>alphabet</span> <span m='5013710'>when</span> <span m='5013890'>I</span>
  <span m='5013980'>recurse?</span> <span m='5014970'>And</span> <span m='5015090'>for</span>
  <span m='5015240'>that,</span> <span m='5015530'>you</span> <span m='5015920'>use</span>
  <span m='5016040'>radix</span> <span m='5016230'>sort.</span> <span m='5018690'>So</span>
  <span m='5018840'>the</span> <span m='5018960'>first</span> <span m='5019260'>time,</span>
  <span m='5022230'>you</span> <span m='5022390'>pay</span> <span m='5023430'>sort</span>
  <span m='5023880'>of</span> <span m='5024090'>Sigma.</span> <span m='5024780'>We</span>
  <span m='5024870'>don't</span> <span m='5025020'>know</span> <span m='5025200'>how</span>
  <span m='5025380'>long</span> <span m='5025590'>that</span> <span m='5025740'>takes,</span>
  <span m='5025980'>depends</span> <span m='5026250'>on</span> <span m='5026400'>your</span>
  <span m='5026520'>alphabet.</span> <span m='5027330'>But</span> <span m='5027540'>every</span>
  <span m='5027870'>following</span> <span m='5028320'>recursion</span> <span m='5029040'>it's</span>
  <span m='5029190'>a radix</span> <span m='5029540'>sort</span> <span m='5029790'>because</span>
  <span m='5030060'>you</span> <span m='5030120'>have</span> <span m='5030210'>a</span>
  <span m='5030270'>triple</span> <span m='5030670'>of</span> <span m='5030720'>values,</span>
  <span m='5031170'>each</span> <span m='5031380'>of</span> <span m='5031470'>which</span>
  <span m='5031650'>is</span> <span m='5031740'>small.</span> <span m='5032990'>And</span>
  <span m='5033120'>so</span> <span m='5033270'>you</span> <span m='5033390'>can</span>
  <span m='5033540'>do</span> <span m='5033660'>it</span> <span m='5033750'>in</span>
  <span m='5033870'>linear</span> <span m='5034200'>time.</span> <span m='5034650'>Because
  there's</span> <span m='5034800'>only</span> <span m='5036510'>three</span> <span
  m='5036780'>digits</span> <span m='5037440'>to</span> <span m='5037560'>the</span>
  <span m='5037680'>thing</span> <span m='5037860'>you're</span> <span m='5037980'>sorting.</span>
  </p><p><span m='5039000'>So</span> <span m='5039180'>overall,</span> <span m='5040260'>this</span>
  <span m='5040440'>is</span> <span m='5040620'>a</span> <span m='5040920'>recursive</span>
  <span m='5041370'>algorithm.</span> <span m='5041880'>It</span> <span m='5042120'>gives</span>
  <span m='5042300'>you</span> <span m='5042390'>linear</span> <span m='5042720'>time</span>
  <span m='5043800'>because</span> <span m='5044100'>you're</span> <span m='5045000'>making</span>
  <span m='5045360'>one</span> <span m='5045600'>recursive</span> <span m='5046020'>call</span>
  <span m='5046350'>of</span> <span m='5046530'>2/3</span> <span m='5047290'>the</span>
  <span m='5047490'>size.</span> <span m='5047910'>Pretty</span> <span m='5048120'>clever</span>
  <span m='5049260'>and</span> <span m='5050490'>simple.</span> <span m='5051840'>And</span>
  <span m='5051960'>that's</span> <span m='5052440'>suffix</span> <span m='5052880'>trees</span>
  <span m='5053100'>and</span> <span m='5053250'>how</span> <span m='5053370'>you</span>
  <span m='5053460'>build</span> <span m='5053670'>them.</span> <span m='5054330'>Versus</span>
  <span m='5054640'>you</span> <span m='5054750'>get</span> <span m='5054900'>suffix</span>
  <span m='5055260'>arrays,</span> <span m='5056180'>you</span> <span m='5056500'>can</span>
  <span m='5056610'>do</span> <span m='5056700'>the</span> <span m='5056820'>same</span>
  <span m='5057090'>thing</span> <span m='5057270'>and</span> <span m='5057360'>get</span>
  <span m='5057990'>LCP</span> <span m='5058530'>information</span> <span m='5059430'>at</span>
  <span m='5059580'>the</span> <span m='5059670'>same</span> <span m='5059910'>time,</span>
  <span m='5060330'>it's</span> <span m='5060990'>written</span> <span m='5061200'>in</span>
  <span m='5061290'>the</span> <span m='5061380'>nodes.</span> <span m='5062220'>Then</span>
  <span m='5062370'>you</span> <span m='5062430'>get</span> <span m='5062730'>suffix</span>
  <span m='5063030'>trees.</span> <span m='5063330'>And then</span> <span m='5063630'>you're</span>
  <span m='5064230'>done.</span> </p>
type: course
uid: 73a75f2eeb17f38bcd420f5902b0cea3

---
None