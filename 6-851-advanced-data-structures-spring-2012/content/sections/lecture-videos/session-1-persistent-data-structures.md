---
about_this_resource_text: <p><strong>Description:</strong> &quot;Persistence&quot;&ndash;remembering
  all past versions of a data structure (&quot;partial persistence&quot;), being able
  to modify them&mdash;forking off new ones (&quot;full persistence&quot;), and  merging
  different versions into one (&quot;confluent persistence&quot;).</p>  <p><strong>Speaker:</strong>
  Prof. Erik Demaine</p>
course_id: 6-851-advanced-data-structures-spring-2012
embedded_media:
- id: Video-YouTube-Stream
  media_location: T0yzrZL1py0
  parent_uid: b2dfac404f367dde437aad378ea69bdb
  title: Video-YouTube-Stream
  type: Video
  uid: 962ee1ddefdc5f50bd270d0537f2fe34
- id: Video-iTunesU-MP4
  media_location: https://itunes.apple.com/us/itunes-u/session-1-persistent-data/id735348884?i=169609840
  parent_uid: b2dfac404f367dde437aad378ea69bdb
  title: Video-iTunes U-MP4
  type: Video
  uid: 0187502743e6b509cc7adfbd31bd71d7
- id: Video-InternetArchive-MP4
  media_location: http://www.archive.org/download/MIT6.851S12/MIT6_851S12_lec01_300k.mp4
  parent_uid: b2dfac404f367dde437aad378ea69bdb
  title: Video-Internet Archive-MP4
  type: Video
  uid: a2128ea3142f1ddc2b23f6312c5a35b4
- id: Thumbnail-YouTube-JPG
  media_location: https://img.youtube.com/vi/T0yzrZL1py0/default.jpg
  parent_uid: b2dfac404f367dde437aad378ea69bdb
  title: Thumbnail-YouTube-JPG
  type: Thumbnail
  uid: 1e470ff8e9f75eccb955c53159c1e699
- id: 3Play-3PlayYouTubeid-MP4
  media_location: T0yzrZL1py0
  parent_uid: b2dfac404f367dde437aad378ea69bdb
  title: 3Play-3Play YouTube id
  type: 3Play
  uid: ea73642abe04fae5ace4038fec6c2346
- id: T0yzrZL1py0.srt
  parent_uid: b2dfac404f367dde437aad378ea69bdb
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-851-advanced-data-structures-spring-2012/lecture-videos/session-1-persistent-data-structures/T0yzrZL1py0.srt
  title: 3play caption file
  type: null
  uid: 49d29ee13095bff85abba41e7081aaa8
- id: T0yzrZL1py0.pdf
  parent_uid: b2dfac404f367dde437aad378ea69bdb
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-851-advanced-data-structures-spring-2012/lecture-videos/session-1-persistent-data-structures/T0yzrZL1py0.pdf
  title: 3play pdf file
  type: null
  uid: d3cca795855400281720a24a1e27002e
- id: Caption-3Play YouTube id-SRT
  parent_uid: b2dfac404f367dde437aad378ea69bdb
  title: Caption-3Play YouTube id-SRT-English - US
  type: Caption
  uid: 2736caaa936fe34a82d8edc91d775c9b
- id: Transcript-3Play YouTube id-PDF
  parent_uid: b2dfac404f367dde437aad378ea69bdb
  title: Transcript-3Play YouTube id-PDF-English - US
  type: Transcript
  uid: 8aa10505c00f1ec1536d5f3343b5a27e
inline_embed_id: 13432609session1:persistentdatastructures1735986
layout: video
order_index: null
parent_uid: b66cbbb7b35e74ff17cdbf44e5fb6b1d
related_resources_text: ''
short_url: session-1-persistent-data-structures
technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-851-advanced-data-structures-spring-2012/lecture-videos/session-1-persistent-data-structures
template_type: Tabbed
title: 'Session 1: Persistent Data Structures'
transcript: <p><span m='90'>The</span> <span m='180'>following</span> <span m='630'>content</span>
  <span m='1200'>is</span> <span m='1320'>provided</span> <span m='1770'>under</span>
  <span m='2009'>a</span> <span m='2070'>Creative</span> <span m='2490'>Commons</span>
  <span m='2910'>license.</span> <span m='4030'>Your</span> <span m='4200'>support</span>
  <span m='4710'>will</span> <span m='4860'>help</span> <span m='5100'>MIT</span>
  <span m='5550'>OpenCourseWare</span> <span m='6360'>continue</span> <span m='6870'>to</span>
  <span m='6960'>offer</span> <span m='7380'>high</span> <span m='7620'>quality</span>
  <span m='8100'>educational</span> <span m='8730'>resources</span> <span m='9360'>for</span>
  <span m='9510'>free.</span> <span m='10720'>To</span> <span m='10740'>make</span>
  <span m='10920'>a</span> <span m='10980'>donation</span> <span m='11730'>or</span>
  <span m='11940'>view</span> <span m='12390'>additional</span> <span m='12810'>materials</span>
  <span m='13320'>from</span> <span m='13500'>hundreds</span> <span m='13920'>of</span>
  <span m='14040'>MIT</span> <span m='14460'>courses,</span> <span m='15550'>visit</span>
  <span m='15780'>MIT</span> <span m='16200'>OpenCourseWare</span> <span m='17280'>at</span>
  <span m='17430'>ocw.mit.edu.</span> </p><p><span m='21056'>ERIK DEMAINE:</span>
  <span m='21303'>Welcome</span> <span m='22320'>to 6.851</span> <span m='22700'>Advanced</span>
  <span m='24080'>Data</span> <span m='24350'>Structures.</span> <span m='25280'>I</span>
  <span m='25535'>am</span> <span m='25790'>Erik</span> <span m='26060'>Demaine.</span>
  <span m='26420'>You</span> <span m='26780'>can call</span> <span m='26930'>me</span>
  <span m='27365'>Erik.</span> <span m='28170'>We</span> <span m='28250'>have</span>
  <span m='28400'>two</span> <span m='28700'>TAs,</span> <span m='29420'>Tom</span>
  <span m='29660'>Morgan</span> <span m='30140'>and</span> <span m='30440'>Justin</span>
  <span m='30760'>Zhang.</span> <span m='31600'>Tom's</span> <span m='31930'>back</span>
  <span m='32140'>there.</span> <span m='32900'>Justin</span> <span m='33860'>is</span>
  <span m='33980'>late.</span> </p><p><span m='36260'>And</span> <span m='36680'>this</span>
  <span m='36950'>class</span> <span m='37400'>is</span> <span m='37520'>about</span>
  <span m='37790'>all</span> <span m='38150'>kinds</span> <span m='38600'>of</span>
  <span m='38690'>very</span> <span m='38960'>cool</span> <span m='39320'>data</span>
  <span m='39560'>structures.</span> <span m='40610'>You</span> <span m='40760'>should</span>
  <span m='40910'>have</span> <span m='41030'>already</span> <span m='41300'>seen</span>
  <span m='41600'>basic</span> <span m='41930'>data</span> <span m='42140'>structures</span>
  <span m='42650'>like</span> <span m='43490'>balance</span> <span m='43920'>binary</span>
  <span m='44270'>search</span> <span m='44540'>trees</span> <span m='44900'>and</span>
  <span m='44990'>things</span> <span m='45200'>like</span> <span m='45350'>that,</span>
  <span m='45920'>log</span> <span m='46160'>n</span> <span m='46310'>time</span>
  <span m='46640'>to</span> <span m='46760'>do</span> <span m='47780'>wherever</span>
  <span m='48140'>you</span> <span m='48320'>want</span> <span m='48860'>in</span>
  <span m='49220'>one</span> <span m='49400'>dimension.</span> <span m='50420'>And</span>
  <span m='50570'>here</span> <span m='50750'>we're</span> <span m='50840'>going</span>
  <span m='50970'>to</span> <span m='51080'>turn</span> <span m='51380'>all</span>
  <span m='51530'>those</span> <span m='51710'>data</span> <span m='51890'>structures</span>
  <span m='52310'>on</span> <span m='52430'>their</span> <span m='52550'>head</span>
  <span m='52850'>and</span> <span m='52940'>consider</span> <span m='53300'>them</span>
  <span m='53450'>in</span> <span m='53540'>all</span> <span m='53660'>sorts</span>
  <span m='53870'>of</span> <span m='53930'>different</span> <span m='54200'>models</span>
  <span m='54980'>and</span> <span m='55310'>additional</span> <span m='55760'>cool</span>
  <span m='55970'>problems.</span> </p><p><span m='56930'>Today</span> <span m='57350'>we're</span>
  <span m='57470'>going</span> <span m='57590'>to</span> <span m='57650'>talk</span>
  <span m='57860'>about</span> <span m='58040'>time</span> <span m='58370'>travel</span>
  <span m='58850'>or</span> <span m='58940'>temporal</span> <span m='59390'>data</span>
  <span m='59630'>structures,</span> <span m='60590'>where</span> <span m='60770'>you're</span>
  <span m='61010'>manipulating</span> <span m='61790'>time</span> <span m='62770'>as</span>
  <span m='62930'>any</span> <span m='63080'>good</span> <span m='63230'>time</span>
  <span m='63500'>traveler</span> <span m='64280'>should.</span> <span m='65510'>Then</span>
  <span m='65810'>we'll</span> <span m='65930'>do</span> <span m='66200'>geometry</span>
  <span m='66890'>where</span> <span m='67040'>we</span> <span m='67130'>have</span>
  <span m='67280'>higher</span> <span m='67490'>dimensional</span> <span m='67940'>data,</span>
  <span m='68210'>more</span> <span m='68390'>than</span> <span m='68540'>one</span>
  <span m='68690'>dimension.</span> <span m='69620'>Then</span> <span m='69800'>we'll</span>
  <span m='69890'>look</span> <span m='70100'>at</span> <span m='70610'>a</span> <span
  m='70640'>problem</span> <span m='70910'>called</span> <span m='71120'>dynamic</span>
  <span m='71570'>optimality,</span> <span m='72260'>which</span> <span m='72500'>is,</span>
  <span m='72770'>is</span> <span m='73010'>there</span> <span m='73310'>one</span>
  <span m='73770'>best</span> <span m='74180'>binary</span> <span m='74600'>search</span>
  <span m='74900'>tree</span> <span m='75110'>that</span> <span m='75230'>rules</span>
  <span m='75500'>them</span> <span m='75650'>all?</span> <span m='76850'>Then</span>
  <span m='77060'>we'll</span> <span m='77150'>look</span> <span m='77330'>at</span>
  <span m='77420'>something</span> <span m='77780'>called</span> <span m='78020'>memory</span>
  <span m='78410'>hierarchy,</span> <span m='79020'>which</span> <span m='79100'>is</span>
  <span m='79730'>a</span> <span m='79790'>way</span> <span m='79970'>to</span> <span
  m='80270'>model</span> <span m='80600'>more</span> <span m='80810'>realistic</span>
  <span m='81230'>computers</span> <span m='81650'>which</span> <span m='81800'>have</span>
  <span m='82040'>cache</span> <span m='82580'>and</span> <span m='82670'>then</span>
  <span m='82820'>more</span> <span m='83000'>cache</span> <span m='83325'>and</span>
  <span m='83650'>then</span> <span m='84020'>main</span> <span m='84230'>memory</span>
  <span m='84560'>and</span> <span m='84650'>then</span> <span m='84980'>dish</span>
  <span m='85280'>and all</span> <span m='85400'>these</span> <span m='85520'>different</span>
  <span m='85790'>levels.</span> <span m='86630'>How</span> <span m='86780'>do</span>
  <span m='86870'>you</span> <span m='87050'>optimize</span> <span m='87500'>for</span>
  <span m='87620'>that?</span> </p><p><span m='88580'>Hashing</span> <span m='89300'>is</span>
  <span m='89390'>probably</span> <span m='89750'>the</span> <span m='89870'>most</span>
  <span m='90170'>famous,</span> <span m='90680'>and</span> <span m='90770'>most</span>
  <span m='91100'>popular,</span> <span m='91770'>most</span> <span m='91970'>used</span>
  <span m='92420'>data</span> <span m='92660'>structure</span> <span m='93050'>in</span>
  <span m='93140'>computer</span> <span m='93410'>science.</span> <span m='93670'>We'll</span>
  <span m='93930'>do</span> <span m='94100'>a</span> <span m='94130'>little</span>
  <span m='94310'>bit</span> <span m='94850'>on</span> <span m='95000'>that.</span>
  <span m='95960'>Integers,</span> <span m='97200'>when</span> <span m='97280'>you</span>
  <span m='97370'>know</span> <span m='97580'>that</span> <span m='97700'>your</span>
  <span m='97820'>data</span> <span m='98090'>is</span> <span m='98330'>integers</span>
  <span m='98780'>and</span> <span m='98870'>not</span> <span m='99050'>just</span>
  <span m='99260'>arbitrary</span> <span m='99710'>black</span> <span m='99990'>boxes</span>
  <span m='100430'>that</span> <span m='100550'>you</span> <span m='100640'>can</span>
  <span m='100790'>compare</span> <span m='101075'>or</span> <span m='101360'>do</span>
  <span m='101480'>whatever,</span> <span m='102470'>you</span> <span m='102560'>can</span>
  <span m='102680'>do</span> <span m='102770'>a</span> <span m='102800'>lot</span>
  <span m='103010'>better</span> <span m='103220'>with</span> <span m='103340'>integers.</span>
  <span m='103730'>You usually</span> <span m='104060'>beat</span> <span m='104300'>log</span>
  <span m='104600'>n</span> <span m='104750'>time.</span> <span m='105140'>Often</span>
  <span m='105440'>you</span> <span m='105530'>can</span> <span m='105620'>get</span>
  <span m='105800'>constant</span> <span m='106220'>time.</span> </p><p><span m='107100'>For</span>
  <span m='107120'>example,</span> <span m='107550'>if</span> <span m='107570'>you</span>
  <span m='107660'>want</span> <span m='107780'>to</span> <span m='107870'>do</span>
  <span m='107990'>priority</span> <span m='108590'>queues,</span> <span m='109130'>you</span>
  <span m='109250'>can</span> <span m='109430'>do</span> <span m='109640'>square</span>
  <span m='110120'>root</span> <span m='110390'>log</span> <span m='110750'>log</span>
  <span m='111110'>n</span> <span m='111320'>time.</span> <span m='111800'>That's</span>
  <span m='112010'>the</span> <span m='112100'>best</span> <span m='112370'>known</span>
  <span m='113060'>randomized.</span> <span m='115100'>Dynamic</span> <span m='115550'>graphs,</span>
  <span m='116180'>you</span> <span m='116300'>have</span> <span m='116900'>a</span>
  <span m='116960'>graph</span> <span m='117320'>you</span> <span m='117410'>want</span>
  <span m='117560'>to</span> <span m='117620'>store,</span> <span m='118010'>and</span>
  <span m='118130'>the</span> <span m='118250'>edges</span> <span m='118610'>are</span>
  <span m='118700'>being</span> <span m='118940'>added</span> <span m='119240'>and</span>
  <span m='119390'>maybe</span> <span m='119660'>deleted,</span> <span m='121040'>like</span>
  <span m='121280'>you're</span> <span m='121500'>representing</span> <span m='121970'>a</span>
  <span m='122030'>social</span> <span m='122330'>network.</span> <span m='122690'>And</span>
  <span m='122780'>people</span> <span m='122990'>are</span> <span m='123050'>friending</span>
  <span m='123380'>and</span> <span m='123470'>de-friending.</span> <span m='124040'>You</span>
  <span m='124130'>want</span> <span m='124280'>to</span> <span m='124340'>maintain</span>
  <span m='124790'>some</span> <span m='125150'>interesting</span> <span m='125600'>information</span>
  <span m='126050'>about</span> <span m='126260'>that</span> <span m='126440'>graph.</span>
  </p><p><span m='127760'>Strings,</span> <span m='128960'>you</span> <span m='129080'>have</span>
  <span m='129860'>a</span> <span m='129979'>piece</span> <span m='130220'>of</span>
  <span m='130310'>text,</span> <span m='130669'>such</span> <span m='131030'>as</span>
  <span m='131330'>the</span> <span m='131420'>entire</span> <span m='131930'>worldwide</span>
  <span m='132350'>web.</span> <span m='132770'>And</span> <span m='132920'>you</span>
  <span m='133010'>want</span> <span m='133130'>to</span> <span m='133190'>search</span>
  <span m='133460'>for</span> <span m='133580'>a</span> <span m='133610'>substring.</span>
  <span m='134180'>How</span> <span m='134270'>do</span> <span m='134360'>you</span>
  <span m='134480'>do</span> <span m='134630'>that</span> <span m='135170'>efficiently?</span>
  <span m='135540'>It's</span> <span m='135910'>sort</span> <span m='136130'>of</span>
  <span m='136190'>the</span> <span m='136310'>Google</span> <span m='136610'>problem.</span>
  <span m='137420'>Or</span> <span m='137630'>you</span> <span m='137690'>searching</span>
  <span m='138020'>through</span> <span m='138140'>DNA</span> <span m='138590'>for</span>
  <span m='138770'>patterns,</span> <span m='139210'>whenever.</span> </p><p><span
  m='140540'>And</span> <span m='140750'>finally</span> <span m='141160'>succinct</span>
  <span m='141560'>data</span> <span m='141800'>structures,</span> <span m='142350'>which</span>
  <span m='142430'>is</span> <span m='142550'>all</span> <span m='142700'>about</span>
  <span m='142940'>taking</span> <span m='143510'>what</span> <span m='143690'>we</span>
  <span m='143810'>normally</span> <span m='144170'>consider</span> <span m='144530'>optimal</span>
  <span m='144950'>space</span> <span m='145400'>or</span> <span m='145670'>n</span>
  <span m='145910'>space</span> <span m='146660'>and</span> <span m='146780'>reducing</span>
  <span m='147230'>it</span> <span m='147290'>down</span> <span m='147500'>to</span>
  <span m='147620'>the</span> <span m='147770'>very</span> <span m='148190'>bare</span>
  <span m='148490'>minimum</span> <span m='148910'>of</span> <span m='149030'>bits</span>
  <span m='149750'>of</span> <span m='149870'>space.</span> <span m='150440'>Usually</span>
  <span m='151220'>if</span> <span m='151340'>you</span> <span m='151460'>want</span>
  <span m='151610'>to</span> <span m='151670'>store</span> <span m='152240'>something</span>
  <span m='152960'>where</span> <span m='153140'>there's</span> <span m='153320'>2</span>
  <span m='153470'>to</span> <span m='153560'>the n</span> <span m='153740'>possibilities,</span>
  <span m='154370'>you</span> <span m='154430'>want</span> <span m='154580'>to</span>
  <span m='154640'>get</span> <span m='154730'>away</span> <span m='154910'>with</span>
  <span m='155120'>n</span> <span m='155390'>bits</span> <span m='155690'>of</span>
  <span m='155750'>space,</span> <span m='156620'>maybe</span> <span m='156890'>plus</span>
  <span m='157610'>square</span> <span m='157710'>root</span> <span m='157950'>of</span>
  <span m='158090'>n</span> <span m='158300'>or</span> <span m='158390'>something</span>
  <span m='158750'>very</span> <span m='158960'>tiny.</span> <span m='160030'>So</span>
  <span m='160270'>that's</span> <span m='160520'>the</span> <span m='160610'>sync</span>
  <span m='160910'>data</span> <span m='161120'>structures.</span> </p><p><span m='162740'>So</span>
  <span m='162920'>that's</span> <span m='163130'>an</span> <span m='163190'>overview</span>
  <span m='163580'>of</span> <span m='163670'>the</span> <span m='163760'>entire</span>
  <span m='164090'>class.</span> <span m='164790'>And</span> <span m='164890'>these</span>
  <span m='164960'>are</span> <span m='165020'>sort</span> <span m='165170'>of</span>
  <span m='165230'>the</span> <span m='165320'>sections</span> <span m='165770'>we'll</span>
  <span m='165920'>be</span> <span m='166070'>following.</span> <span m='167970'>Let</span>
  <span m='168080'>me</span> <span m='168200'>give</span> <span m='168380'>you</span>
  <span m='168500'>a</span> <span m='168560'>quick</span> <span m='169250'>administrative</span>
  <span m='169940'>overview</span> <span m='170930'>of</span> <span m='171110'>what</span>
  <span m='171290'>we're</span> <span m='171410'>doing.</span> <span m='174350'>Requirements</span>
  <span m='174950'>for</span> <span m='175040'>the</span> <span m='175130'>class--</span>
  <span m='175520'>I</span> <span m='175580'>guess,</span> <span m='175790'>first,</span>
  <span m='176750'>attending</span> <span m='177140'>lecture.</span> <span m='178580'>Obviously</span>
  <span m='178910'>if</span> <span m='179000'>you</span> <span m='179090'>don't</span>
  <span m='179330'>attend</span> <span m='179600'>lecture,</span> <span m='179900'>there'll</span>
  <span m='180050'>be</span> <span m='180170'>videos</span> <span m='180530'>online.</span>
  <span m='180950'>So</span> <span m='181160'>that's</span> <span m='182210'>resolvable.</span>
  <span m='182810'>But</span> <span m='182990'>let</span> <span m='183110'>me</span>
  <span m='183230'>know</span> <span m='183470'>if</span> <span m='183560'>you're</span>
  <span m='183650'>not</span> <span m='183770'>going</span> <span m='183890'>to</span>
  <span m='183950'>make</span> <span m='184160'>it.</span> </p><p><span m='185000'>We're</span>
  <span m='185120'>going</span> <span m='185240'>to</span> <span m='185300'>have</span>
  <span m='185420'>problems</span> <span m='185760'>sets</span> <span m='186260'>roughly</span>
  <span m='186710'>every</span> <span m='187070'>week.</span> <span m='187410'>If</span>
  <span m='187550'>you're</span> <span m='187640'>taking</span> <span m='187940'>the</span>
  <span m='187970'>class</span> <span m='188240'>for</span> <span m='188360'>credit,</span>
  <span m='189390'>they</span> <span m='189440'>have</span> <span m='189560'>a</span>
  <span m='189620'>very</span> <span m='189800'>simple</span> <span m='190160'>rule</span>
  <span m='190430'>of</span> <span m='190580'>one</span> <span m='190790'>page</span>
  <span m='191120'>in,</span> <span m='191290'>one</span> <span m='191480'>page</span>
  <span m='191780'>out.</span> <span m='192500'>This</span> <span m='192680'>is</span>
  <span m='192800'>more</span> <span m='193070'>constraint</span> <span m='193580'>on</span>
  <span m='193790'>us</span> <span m='194090'>to</span> <span m='194270'>write</span>
  <span m='194870'>problems</span> <span m='195170'>that</span> <span m='195290'>have</span>
  <span m='195650'>easy</span> <span m='196130'>or</span> <span m='196280'>short</span>
  <span m='196580'>answers.</span> <span m='196880'>You</span> <span m='197180'>probably</span>
  <span m='197480'>need</span> <span m='197630'>to</span> <span m='197690'>think</span>
  <span m='197900'>about</span> <span m='198110'>them</span> <span m='198260'>a</span>
  <span m='198290'>little</span> <span m='198500'>bit</span> <span m='198680'>before</span>
  <span m='198980'>they're</span> <span m='199760'>transparent,</span> <span m='200340'>but</span>
  <span m='200480'>then</span> <span m='201200'>easy</span> <span m='201410'>to</span>
  <span m='201530'>write</span> <span m='201710'>up.</span> </p><p><span m='203060'>And</span>
  <span m='203240'>then</span> <span m='203810'>scribing</span> <span m='204440'>lectures--</span>
  <span m='204950'>so</span> <span m='205160'>we</span> <span m='205250'>have</span>
  <span m='205430'>a</span> <span m='205460'>scribe</span> <span m='205790'>for</span>
  <span m='205940'>today,</span> <span m='206430'>I</span> <span m='206530'>hope.</span>
  <span m='207580'>Here?</span> <span m='208550'>Yes,</span> <span m='208950'>good.</span>
  <span m='210170'>So</span> <span m='211010'>most</span> <span m='211380'>of</span>
  <span m='211460'>the</span> <span m='211520'>lectures</span> <span m='211880'>have</span>
  <span m='211970'>already</span> <span m='212210'>been</span> <span m='212360'>scribed</span>
  <span m='213140'>in</span> <span m='213260'>some</span> <span m='213500'>version,</span>
  <span m='214010'>and</span> <span m='214190'>your</span> <span m='214370'>goal</span>
  <span m='214580'>is</span> <span m='214730'>to</span> <span m='214910'>revise</span>
  <span m='215930'>that</span> <span m='216330'>scribe</span> <span m='216740'>notes</span>
  <span m='217280'>that</span> <span m='217670'>if</span> <span m='217910'>you</span>
  <span m='218000'>don't</span> <span m='218210'>like</span> <span m='218420'>handwritten</span>
  <span m='218810'>notes,</span> <span m='219240'>which</span> <span m='219320'>are</span>
  <span m='219590'>also</span> <span m='219890'>online,</span> <span m='220850'>then</span>
  <span m='221780'>easier</span> <span m='222110'>for</span> <span m='222230'>people</span>
  <span m='222440'>to</span> <span m='222530'>read.</span> </p><p><span m='224320'>Let's</span>
  <span m='224510'>see.</span> <span m='225160'>Listeners</span> <span m='225650'>welcome.</span>
  <span m='226580'>We're</span> <span m='226640'>going</span> <span m='226760'>to</span>
  <span m='226850'>have</span> <span m='227030'>an</span> <span m='227120'>open</span>
  <span m='227390'>problem</span> <span m='227690'>session.</span> <span m='228020'>I</span>
  <span m='228080'>really</span> <span m='228290'>like</span> <span m='228500'>open</span>
  <span m='228740'>problems.</span> <span m='229230'>I</span> <span m='229330'>really</span>
  <span m='229400'>like</span> <span m='229580'>solving</span> <span m='229970'>open</span>
  <span m='230180'>problems.</span> <span m='230670'>So</span> <span m='230750'>we've</span>
  <span m='230900'>done</span> <span m='231080'>this</span> <span m='231290'>every</span>
  <span m='232250'>time</span> <span m='232490'>this</span> <span m='232640'>class</span>
  <span m='232940'>has</span> <span m='233030'>been</span> <span m='233180'>offered.</span>
  <span m='233870'>So</span> <span m='234050'>if</span> <span m='234200'>you're</span>
  <span m='234290'>interested</span> <span m='234590'>in</span> <span m='234710'>also</span>
  <span m='235010'>solving</span> <span m='235360'>open</span> <span m='235490'>problems,</span>
  <span m='235790'>it's</span> <span m='235910'>optional.</span> </p><p><span m='236910'>I</span>
  <span m='237320'>will</span> <span m='237740'>organize--</span> <span m='238430'>in</span>
  <span m='238640'>a</span> <span m='238700'>couple</span> <span m='238970'>of</span>
  <span m='239090'>weeks,</span> <span m='239480'>we'll</span> <span m='240560'>have
  a</span> <span m='240980'>weekly</span> <span m='241430'>open</span> <span m='241670'>problem</span>
  <span m='241970'>session</span> <span m='243110'>and</span> <span m='243710'>try</span>
  <span m='243920'>to</span> <span m='244010'>solve</span> <span m='244430'>all</span>
  <span m='244550'>the</span> <span m='244700'>things</span> <span m='245000'>that</span>
  <span m='246440'>push</span> <span m='246740'>the</span> <span m='246920'>frontier</span>
  <span m='247550'>of</span> <span m='247910'>advanced</span> <span m='248270'>data</span>
  <span m='248480'>structures.</span> <span m='249080'>So</span> <span m='249550'>in</span>
  <span m='249630'>classes,</span> <span m='250310'>we'll</span> <span m='250460'>see</span>
  <span m='251060'>the</span> <span m='251120'>state</span> <span m='251360'>of</span>
  <span m='251420'>the</span> <span m='251570'>art.</span> <span m='251810'>And</span>
  <span m='251960'>then</span> <span m='252200'>we'll</span> <span m='252320'>change</span>
  <span m='252680'>the</span> <span m='252770'>state</span> <span m='252980'>of</span>
  <span m='253100'>the</span> <span m='253220'>art</span> <span m='253400'>in</span>
  <span m='253550'>those</span> <span m='253730'>sessions.</span> </p><p><span m='255890'>I</span>
  <span m='255920'>think</span> <span m='256100'>that's</span> <span m='256310'>it.</span>
  <span m='256420'>Any</span> <span m='256579'>questions</span> <span m='257000'>about</span>
  <span m='257209'>the</span> <span m='257300'>class</span> <span m='258440'>before</span>
  <span m='258829'>we</span> <span m='258920'>get</span> <span m='259070'>into</span>
  <span m='259279'>the</span> <span m='259399'>fun</span> <span m='259640'>stuff?</span>
  <span m='262980'>All</span> <span m='263090'>right.</span> <span m='263900'>Let's</span>
  <span m='264110'>do</span> <span m='264230'>some</span> <span m='264380'>time</span>
  <span m='264620'>traveling.</span> </p><p><span m='267320'>Before I</span> <span
  m='267380'>get</span> <span m='267500'>to</span> <span m='267620'>time</span> <span
  m='267830'>traveling,</span> <span m='268190'>though,</span> <span m='268730'>I</span>
  <span m='268850'>need</span> <span m='269030'>to</span> <span m='269150'>define</span>
  <span m='269750'>our</span> <span m='269930'>model</span> <span m='270230'>of</span>
  <span m='270350'>computation.</span> <span m='272420'>A</span> <span m='272540'>theme</span>
  <span m='272900'>in</span> <span m='273020'>this</span> <span m='273200'>class</span>
  <span m='273920'>is</span> <span m='274220'>that</span> <span m='274460'>the</span>
  <span m='274580'>model</span> <span m='275030'>of</span> <span m='275120'>computation</span>
  <span m='275690'>you're</span> <span m='275810'>working</span> <span m='276080'>with</span>
  <span m='276230'>matters.</span> <span m='276590'>Models</span> <span m='277010'>matter.</span>
  <span m='278060'>And</span> <span m='278660'>there's</span> <span m='278840'>lots</span>
  <span m='279080'>of</span> <span m='279140'>different</span> <span m='279380'>models</span>
  <span m='279650'>of</span> <span m='279740'>computation.</span> <span m='280430'>We'll</span>
  <span m='280550'>see</span> <span m='281350'>a</span> <span m='281390'>few</span>
  <span m='281600'>of</span> <span m='281720'>the</span> <span m='281810'>main</span>
  <span m='282080'>ones</span> <span m='284420'>in</span> <span m='284600'>this</span>
  <span m='284750'>class.</span> <span m='285890'>And</span> <span m='286100'>the</span>
  <span m='286460'>starting</span> <span m='286880'>point,</span> <span m='288200'>and</span>
  <span m='288320'>the</span> <span m='288410'>one</span> <span m='288580'>we'll</span>
  <span m='288680'>be</span> <span m='288770'>using</span> <span m='289160'>throughout</span>
  <span m='289520'>today,</span> <span m='290270'>is</span> <span m='290480'>called</span>
  <span m='290660'>a</span> <span m='290720'>pointer</span> <span m='291020'>machine.</span>
  <span m='293100'>It's</span> <span m='293240'>an old</span> <span m='293510'>one</span>
  <span m='293780'>from</span> <span m='294050'>the</span> <span m='294200'>'80s.</span>
  <span m='297320'>And</span> <span m='297500'>it</span> <span m='297560'>corresponds</span>
  <span m='298160'>to</span> <span m='298280'>what</span> <span m='298430'>you</span>
  <span m='298550'>might</span> <span m='298760'>think</span> <span m='299000'>about</span>
  <span m='299240'>if</span> <span m='299330'>you've</span> <span m='299450'>done</span>
  <span m='299750'>a</span> <span m='299840'>lot</span> <span m='300110'>of</span>
  <span m='300230'>object-oriented</span> <span m='300920'>programming,</span> <span
  m='302090'>and</span> <span m='302300'>before</span> <span m='302630'>that,</span>
  <span m='303410'>structure-oriented</span> <span m='304370'>programming,</span>
  <span m='304950'>I</span> <span m='305050'>guess.</span> </p><p><span m='305760'>So</span>
  <span m='306260'>you</span> <span m='306380'>have</span> <span m='306530'>a</span>
  <span m='306590'>bunch</span> <span m='306830'>of</span> <span m='306950'>nodes.</span>
  <span m='308660'>They</span> <span m='308780'>have</span> <span m='308930'>some</span>
  <span m='309110'>fields</span> <span m='309500'>in</span> <span m='309620'>them,</span>
  <span m='310150'>a</span> <span m='310480'>constant</span> <span m='310910'>number</span>
  <span m='311180'>of</span> <span m='311240'>fields.</span> <span m='313970'>You</span>
  <span m='314150'>can</span> <span m='314270'>think</span> <span m='314420'>of</span>
  <span m='314510'>these</span> <span m='314750'>as</span> <span m='314930'>objects</span>
  <span m='315530'>or</span> <span m='315770'>strucs</span> <span m='316610'>in</span>
  <span m='316760'>c</span> <span m='317950'>It</span> <span m='318270'>used</span>
  <span m='318520'>to</span> <span m='318650'>be</span> <span m='318740'>records</span>
  <span m='319220'>back</span> <span m='319460'>in</span> <span m='319550'>Pascal</span>
  <span m='319970'>days,</span> <span m='320270'>so a</span> <span m='320330'>lot</span>
  <span m='320480'>of</span> <span m='320550'>the</span> <span m='320590'>papers</span>
  <span m='320900'>call</span> <span m='321060'>them</span> <span m='321200'>records.</span>
  </p><p><span m='322210'>You could</span> <span m='322400'>just</span> <span m='322550'>have</span>
  <span m='322670'>a</span> <span m='322730'>constant</span> <span m='323060'>number</span>
  <span m='323360'>of</span> <span m='323720'>fields.</span> <span m='324170'>You</span>
  <span m='324230'>could</span> <span m='324350'>think</span> <span m='324500'>of</span>
  <span m='324560'>those</span> <span m='324770'>numbered,</span> <span m='325130'>labeled.
  It</span> <span m='325470'>doesn't</span> <span m='325670'>really</span> <span m='325850'>matter</span>
  <span m='326180'>because</span> <span m='326330'>there's</span> <span m='326480'>only</span>
  <span m='326690'>a</span> <span m='326720'>constant</span> <span m='327080'>number</span>
  <span m='327320'>of</span> <span m='327410'>them.</span> </p><p><span m='328550'>Each</span>
  <span m='328790'>of</span> <span m='328850'>the</span> <span m='328970'>fields</span>
  <span m='329330'>could</span> <span m='329540'>be</span> <span m='329720'>a</span>
  <span m='329870'>pointer</span> <span m='330350'>to</span> <span m='330560'>another</span>
  <span m='330860'>node,</span> <span m='332240'>could</span> <span m='332420'>be</span>
  <span m='332690'>a</span> <span m='332750'>null</span> <span m='332990'>pointer,</span>
  <span m='333990'>or</span> <span m='334240'>could</span> <span m='334400'>have</span>
  <span m='334520'>some</span> <span m='334700'>data</span> <span m='335030'>in</span>
  <span m='335180'>it.</span> <span m='335550'>So</span> <span m='335630'>I'll</span>
  <span m='335780'>just</span> <span m='336170'>assume</span> <span m='336470'>that</span>
  <span m='336590'>all</span> <span m='336710'>my</span> <span m='336830'>data</span>
  <span m='337100'>is</span> <span m='337370'>integers.</span> <span m='343130'>You</span>
  <span m='343280'>can</span> <span m='343430'>have</span> <span m='343730'>a</span>
  <span m='343790'>pointer</span> <span m='344090'>to</span> <span m='344210'>yourself.</span>
  <span m='345090'>You</span> <span m='345370'>can have</span> <span m='345530'>a</span>
  <span m='345590'>pointer</span> <span m='345920'>over</span> <span m='346100'>here,</span>
  <span m='346970'>whatever</span> <span m='347180'>you</span> <span m='347300'>want.</span>
  </p><p><span m='348440'>A</span> <span m='348990'>pointer</span> <span m='349370'>machine</span>
  <span m='349850'>would</span> <span m='350000'>look</span> <span m='350180'>something</span>
  <span m='350480'>like</span> <span m='350660'>this.</span> <span m='352640'>In</span>
  <span m='352820'>any</span> <span m='353090'>moment,</span> <span m='353630'>this</span>
  <span m='353840'>is</span> <span m='353930'>the</span> <span m='354020'>state</span>
  <span m='354290'>of</span> <span m='354380'>the</span> <span m='354500'>pointer</span>
  <span m='354740'>machine.</span> <span m='355040'>So</span> <span m='355160'>you</span>
  <span m='355220'>think</span> <span m='355520'>this</span> <span m='355700'>as</span>
  <span m='356090'>the</span> <span m='356870'>memory</span> <span m='357380'>of</span>
  <span m='357500'>your</span> <span m='357680'>computer</span> <span m='358160'>storing.</span>
  <span m='359300'>And</span> <span m='359450'>then</span> <span m='359720'>you</span>
  <span m='359870'>have</span> <span m='361070'>some</span> <span m='361340'>operations</span>
  <span m='362210'>that</span> <span m='362420'>you're</span> <span m='362600'>allowed</span>
  <span m='362870'>to</span> <span m='362990'>do.</span> <span m='363660'>That's</span>
  <span m='364940'>the</span> <span m='365420'>computation</span> <span m='366050'>part</span>
  <span m='366320'>of</span> <span m='366440'>the</span> <span m='366530'>model.</span>
  <span m='367800'>You can</span> <span m='367880'>think of</span> <span m='367970'>this</span>
  <span m='368150'>as</span> <span m='368270'>the</span> <span m='368360'>memory</span>
  <span m='368660'>model.</span> </p><p><span m='370570'>What</span> <span m='370730'>you're</span>
  <span m='370840'>allowed</span> <span m='371060'>to</span> <span m='371150'>do</span>
  <span m='371540'>are</span> <span m='372110'>create</span> <span m='372440'>nodes.</span>
  <span m='373100'>You</span> <span m='373160'>can</span> <span m='373550'>say</span>
  <span m='373760'>something</span> <span m='374060'>like,</span> <span m='374270'>x</span>
  <span m='374940'>equals</span> <span m='375230'>new</span> <span m='375410'>node.</span>
  <span m='379910'>You can,</span> <span m='381230'>I</span> <span m='381290'>don't</span>
  <span m='381410'>know,</span> <span m='383570'>look</span> <span m='383840'>at</span>
  <span m='384170'>fields.</span> <span m='384990'>You</span> <span m='385090'>can</span>
  <span m='385100'>do</span> <span m='385220'>x</span> <span m='385460'>equals</span>
  <span m='385790'>y.field.</span> <span m='388070'>You</span> <span m='388280'>can</span>
  <span m='388460'>set</span> <span m='388730'>fields,</span> <span m='389330'>x.field</span>
  <span m='391622'>equals</span> <span m='392510'>y.</span> </p><p><span m='393560'>You</span>
  <span m='393770'>can</span> <span m='393920'>compute</span> <span m='394550'>on</span>
  <span m='394850'>these</span> <span m='395090'>data,</span> <span m='395430'>so</span>
  <span m='395570'>you</span> <span m='395740'>can</span> <span m='395930'>add</span>
  <span m='396290'>5</span> <span m='396680'>and</span> <span m='396800'>7,</span>
  <span m='397400'>do</span> <span m='397520'>things</span> <span m='397790'>like</span>
  <span m='397970'>that.</span> <span m='399110'>I'm</span> <span m='399230'>not</span>
  <span m='399350'>going</span> <span m='399500'>to</span> <span m='399620'>worry</span>
  <span m='400070'>about--</span> <span m='400990'>I'll</span> <span m='401150'>just</span>
  <span m='401330'>write</span> <span m='401500'>et cetera.</span> <span m='403700'>This</span>
  <span m='403910'>is</span> <span m='404030'>more</span> <span m='404240'>a</span>
  <span m='404270'>model</span> <span m='404570'>about</span> <span m='404780'>how</span>
  <span m='405260'>everything's</span> <span m='405680'>organized</span> <span m='406700'>in</span>
  <span m='406850'>memory,</span> <span m='407210'>not</span> <span m='407390'>so</span>
  <span m='407510'>much</span> <span m='407720'>about</span> <span m='407900'>what</span>
  <span m='408080'>you're</span> <span m='408200'>allowed</span> <span m='408380'>to</span>
  <span m='408530'>do</span> <span m='408650'>to</span> <span m='408740'>the</span>
  <span m='408860'>data</span> <span m='409070'>items.</span> <span m='409620'>In</span>
  <span m='409730'>this</span> <span m='409850'>lecture,</span> <span m='410150'>it</span>
  <span m='410510'>won't</span> <span m='410660'>matter</span> <span m='410810'>what
  you're</span> <span m='410930'>doing</span> <span m='411140'>to</span> <span m='411230'>the</span>
  <span m='411320'>data</span> <span m='411560'>items.</span> <span m='411770'>We</span>
  <span m='411860'>never</span> <span m='412100'>touch</span> <span m='412370'>them.</span>
  <span m='413930'>We</span> <span m='414020'>just</span> <span m='414170'>copy</span>
  <span m='414500'>them</span> <span m='414620'>around.</span> </p><p><span m='416840'>So</span>
  <span m='418160'>am</span> <span m='418250'>I</span> <span m='418310'>missing</span>
  <span m='418580'>anything?</span> <span m='419870'>Probably.</span> <span m='421100'>I</span>
  <span m='421190'>guess</span> <span m='421370'>you</span> <span m='421490'>could</span>
  <span m='421700'>destroy</span> <span m='422210'>nodes</span> <span m='422570'>if</span>
  <span m='422660'>you</span> <span m='422780'>felt</span> <span m='423020'>like</span>
  <span m='423260'>it.</span> <span m='423950'>But</span> <span m='424940'>we</span>
  <span m='425090'>won't</span> <span m='425240'>have</span> <span m='425450'>to</span>
  <span m='426080'>today,</span> <span m='426500'>because</span> <span m='426740'>we</span>
  <span m='426830'>don't</span> <span m='426920'>want</span> <span m='427040'>to</span>
  <span m='427100'>throw</span> <span m='427280'>anything</span> <span m='427640'>away</span>
  <span m='427940'>when</span> <span m='428120'>you're</span> <span m='428240'>time</span>
  <span m='428480'>traveling.</span> <span m='429200'>It's</span> <span m='429320'>too</span>
  <span m='429470'>dangerous.</span> </p><p><span m='432740'>And</span> <span m='432920'>then</span>
  <span m='433070'>the</span> <span m='433190'>one</span> <span m='434120'>catch</span>
  <span m='434540'>here</span> <span m='435230'>is,</span> <span m='435350'>what</span>
  <span m='435530'>are</span> <span m='435620'>x</span> <span m='435920'>and</span>
  <span m='436040'>y?</span> <span m='438570'>There's</span> <span m='438770'>going</span>
  <span m='438920'>to</span> <span m='438980'>be</span> <span m='439160'>one</span>
  <span m='439490'>node</span> <span m='439850'>in</span> <span m='439970'>this</span>
  <span m='440240'>data</span> <span m='440480'>structure</span> <span m='441280'>or</span>
  <span m='441440'>in</span> <span m='441530'>your</span> <span m='441650'>memory</span>
  <span m='442430'>called</span> <span m='442670'>the</span> <span m='442760'>root</span>
  <span m='442970'>node.</span> <span m='444740'>And</span> <span m='444860'>you</span>
  <span m='444950'>could</span> <span m='445070'>think</span> <span m='445250'>of</span>
  <span m='445320'>that</span> <span m='445500'>as</span> <span m='445580'>that's</span>
  <span m='445910'>the</span> <span m='446000'>thing</span> <span m='446180'>you</span>
  <span m='446270'>always</span> <span m='446600'>have</span> <span m='446810'>in</span>
  <span m='446900'>your</span> <span m='447020'>head.</span> <span m='447800'>This</span>
  <span m='447980'>is</span> <span m='448190'>like</span> <span m='448370'>your</span>
  <span m='448490'>cache,</span> <span m='448940'>if</span> <span m='449060'>you</span>
  <span m='449150'>will.</span> <span m='449390'>It's</span> <span m='449510'>just</span>
  <span m='449660'>got</span> <span m='449810'>a</span> <span m='449840'>constant</span>
  <span m='450170'>number</span> <span m='450410'>of</span> <span m='450500'>things,</span>
  <span m='450770'>just</span> <span m='450980'>like</span> <span m='451160'>any</span>
  <span m='451370'>other</span> <span m='451550'>node.</span> </p><p><span m='452470'>And</span>
  <span m='452630'>x</span> <span m='452900'>and</span> <span m='453020'>y</span>
  <span m='453470'>are</span> <span m='453770'>fields</span> <span m='457010'>of</span>
  <span m='457160'>the</span> <span m='457280'>root.</span> <span m='460520'>So</span>
  <span m='460730'>that</span> <span m='460940'>sort</span> <span m='461090'>of</span>
  <span m='461210'>ties</span> <span m='461570'>things</span> <span m='461810'>down.</span>
  <span m='462530'>You're</span> <span m='462680'>always</span> <span m='463040'>working</span>
  <span m='463340'>relative</span> <span m='463760'>to</span> <span m='463880'>the</span>
  <span m='464000'>root.</span> <span m='465200'>But</span> <span m='465380'>you</span>
  <span m='465560'>can</span> <span m='466670'>look</span> <span m='466880'>at</span>
  <span m='466970'>the</span> <span m='467060'>data,</span> <span m='467480'>basically</span>
  <span m='467930'>follow</span> <span m='468380'>this</span> <span m='468590'>pointer,</span>
  <span m='470030'>by</span> <span m='471200'>looking</span> <span m='471530'>at</span>
  <span m='471740'>the</span> <span m='471830'>field.</span> <span m='473040'>You</span>
  <span m='473570'>could</span> <span m='473720'>set</span> <span m='473960'>one</span>
  <span m='474140'>of</span> <span m='474200'>these</span> <span m='475160'>pointers--</span>
  <span m='475850'>I</span> <span m='475940'>think</span> <span m='476150'>I</span>
  <span m='476240'>probably</span> <span m='476570'>need</span> <span m='477110'>another</span>
  <span m='477410'>operation</span> <span m='477920'>here,</span> <span m='478160'>like</span>
  <span m='478970'>x</span> <span m='479270'>equals</span> <span m='479750'>y.field1,</span>
  <span m='481580'>field2,</span> <span m='482570'>that</span> <span m='482660'>sort</span>
  <span m='482810'>of</span> <span m='482900'>thing,</span> <span m='483936'>and</span>
  <span m='484470'>maybe</span> <span m='484730'>the</span> <span m='484820'>reverse.</span>
  </p><p><span m='486800'>But</span> <span m='487130'>you</span> <span m='487340'>can</span>
  <span m='487700'>manipulate</span> <span m='488420'>all</span> <span m='488660'>nodes</span>
  <span m='489020'>sort</span> <span m='489200'>of</span> <span m='489260'>via</span>
  <span m='489590'>the</span> <span m='489790'>root</span> <span m='490100'>is</span>
  <span m='490360'>the idea.</span> <span m='490770'>You follow</span> <span m='491090'>pointers,</span>
  <span m='491540'>do</span> <span m='491660'>whatever.</span> <span m='492710'>So</span>
  <span m='492890'>pretty</span> <span m='493220'>obvious,</span> <span m='494090'>slightly</span>
  <span m='494510'>annoying</span> <span m='494780'>to</span> <span m='494870'>write</span>
  <span m='495020'>down</span> <span m='495230'>formally.</span> <span m='496250'>But</span>
  <span m='496670'>that</span> <span m='496880'>is</span> <span m='498050'>pointer</span>
  <span m='498290'>machine.</span> </p><p><span m='503460'>And</span> <span m='503730'>what</span>
  <span m='503940'>we're</span> <span m='504090'>going</span> <span m='504160'>to</span>
  <span m='504300'>be</span> <span m='504450'>talking</span> <span m='504810'>about</span>
  <span m='505020'>today</span> <span m='506320'>in</span> <span m='506490'>time</span>
  <span m='506730'>travel</span> <span m='507060'>is</span> <span m='507180'>suppose</span>
  <span m='508380'>someone</span> <span m='508830'>gives</span> <span m='509130'>me</span>
  <span m='509300'>a</span> <span m='509370'>pointer</span> <span m='509670'>machine</span>
  <span m='509940'>data</span> <span m='510120'>structure,</span> <span m='510480'>for</span>
  <span m='510600'>example,</span> <span m='511120'>balanced</span> <span m='511500'>binary</span>
  <span m='511770'>search</span> <span m='512039'>tree,</span> <span m='512429'>linked</span>
  <span m='512640'>list.</span> <span m='513510'>A</span> <span m='513570'>lot</span>
  <span m='513809'>of</span> <span m='513870'>data</span> <span m='514110'>structures,</span>
  <span m='515200'>especially</span> <span m='515490'>classic</span> <span m='515850'>data</span>
  <span m='516030'>structures,</span> <span m='516419'>follow</span> <span m='517280'>pointer</span>
  <span m='517830'>machine</span> <span m='518130'>model.</span> <span m='519240'>What</span>
  <span m='519450'>we'd</span> <span m='519570'>like</span> <span m='519720'>to</span>
  <span m='519840'>do</span> <span m='519990'>is</span> <span m='520080'>transform</span>
  <span m='520740'>that</span> <span m='520890'>data</span> <span m='521100'>structure</span>
  <span m='521400'>or</span> <span m='521429'>make</span> <span m='521640'>a</span>
  <span m='521700'>new</span> <span m='521940'>pointer</span> <span m='522260'>machine</span>
  <span m='522570'>data</span> <span m='522780'>structure</span> <span m='523110'>that</span>
  <span m='523230'>does</span> <span m='523440'>extra</span> <span m='523830'>cool</span>
  <span m='524070'>things,</span> <span m='525120'>namely</span> <span m='525900'>travel</span>
  <span m='526200'>through</span> <span m='526350'>time.</span> <span m='527470'>So</span>
  <span m='527670'>that's</span> <span m='530490'>what</span> <span m='530640'>we're</span>
  <span m='530760'>going</span> <span m='530920'>to</span> <span m='531010'>do.</span>
  </p><p><span m='533340'>There's</span> <span m='533850'>two</span> <span m='534240'>senses</span>
  <span m='534690'>of</span> <span m='535080'>time</span> <span m='535380'>travel</span>
  <span m='536340'>or</span> <span m='536460'>temporal</span> <span m='537630'>data</span>
  <span m='537870'>structures</span> <span m='538860'>that</span> <span m='538980'>we're</span>
  <span m='539070'>going</span> <span m='539220'>to</span> <span m='539280'>cover</span>
  <span m='539550'>in</span> <span m='539640'>this</span> <span m='539790'>class.</span>
  <span m='542200'>The</span> <span m='542220'>one</span> <span m='542430'>for</span>
  <span m='542610'>today</span> <span m='542970'>is</span> <span m='543060'>called</span>
  <span m='543300'>persistence,</span> <span m='545400'>where</span> <span m='545850'>you</span>
  <span m='545970'>don't</span> <span m='546210'>forget</span> <span m='546510'>anything,</span>
  <span m='547110'>like</span> <span m='547260'>an</span> <span m='547320'>elephant.</span>
  <span m='548310'>And</span> <span m='548580'>the</span> <span m='548700'>other</span>
  <span m='548940'>one</span> <span m='549210'>is</span> <span m='550170'>retroactivity.</span>
  </p><p><span m='555240'>Persistence</span> <span m='555780'>will</span> <span m='555870'>be</span>
  <span m='556020'>today.</span> <span m='556800'>Retroactivity</span> <span m='557490'>is</span>
  <span m='557610'>next</span> <span m='557850'>class.</span> <span m='559260'>Basically,</span>
  <span m='559770'>these</span> <span m='559920'>correspond</span> <span m='560340'>to</span>
  <span m='560460'>two</span> <span m='560670'>models</span> <span m='561000'>of</span>
  <span m='561090'>time</span> <span m='561300'>travel.</span> <span m='561670'>Persistence</span>
  <span m='562350'>is</span> <span m='562590'>the</span> <span m='562710'>branching</span>
  <span m='563160'>universe</span> <span m='563550'>time</span> <span m='563790'>travel</span>
  <span m='564120'>model,</span> <span m='564450'>where</span> <span m='564600'>if</span>
  <span m='564720'>you</span> <span m='564810'>make</span> <span m='564990'>a</span>
  <span m='565050'>change</span> <span m='565320'>in</span> <span m='565380'>the</span>
  <span m='565470'>past,</span> <span m='565800'>you</span> <span m='565890'>get</span>
  <span m='566010'>a</span> <span m='566070'>new</span> <span m='566220'>universe.</span>
  <span m='567350'>You</span> <span m='567420'>never</span> <span m='567690'>destroy</span>
  <span m='568140'>old</span> <span m='568290'>universes.</span> <span m='569460'>Retroactivity</span>
  <span m='570930'>is</span> <span m='571800'>more</span> <span m='572040'>like</span>
  <span m='572220'><i>Back</i></span> <span m='572430'><i>to</i></span> <span m='572520'><i>the</i></span>
  <span m='572640'><i>Future,</i></span> <span m='573420'>when</span> <span m='573570'>you</span>
  <span m='573720'>go</span> <span m='573900'>back,</span> <span m='574260'>make</span>
  <span m='574470'>a</span> <span m='574530'>change,</span> <span m='574860'>and</span>
  <span m='574950'>then</span> <span m='575040'>you</span> <span m='575130'>can</span>
  <span m='575250'>return</span> <span m='575580'>to</span> <span m='575670'>the</span>
  <span m='575790'>present</span> <span m='576150'>and</span> <span m='576240'>see</span>
  <span m='576420'>what</span> <span m='576570'>happened.</span> </p><p><span m='577920'>This</span>
  <span m='578130'>is</span> <span m='578220'>a</span> <span m='578280'>lot</span>
  <span m='578460'>harder</span> <span m='578760'>to</span> <span m='578880'>do.</span>
  <span m='579710'>And</span> <span m='579840'>we'll</span> <span m='580260'>work</span>
  <span m='580470'>on</span> <span m='580560'>that</span> <span m='580920'>next</span>
  <span m='581100'>class.</span> <span m='582150'>Persistence</span> <span m='582810'>is</span>
  <span m='582990'>what</span> <span m='583200'>we</span> <span m='583350'>will</span>
  <span m='584130'>do</span> <span m='584250'>today.</span> <span m='586360'>So</span>
  <span m='587920'>persistence.</span> </p><p><span m='597940'>The</span> <span m='598030'>general</span>
  <span m='598330'>idea</span> <span m='598540'>of</span> <span m='598660'>persistence</span>
  <span m='599290'>is</span> <span m='599410'>to</span> <span m='599500'>remember</span>
  <span m='599860'>everything--</span> <span m='601810'>the</span> <span m='601930'>general</span>
  <span m='602230'>goal,</span> <span m='602650'>I</span> <span m='602700'>would</span>
  <span m='602800'>say.</span> <span m='605110'>And</span> <span m='605200'>by</span>
  <span m='605350'>everything,</span> <span m='605890'>I</span> <span m='606040'>mean</span>
  <span m='606610'>different</span> <span m='606970'>versions</span> <span m='607360'>of</span>
  <span m='607450'>the</span> <span m='607540'>data</span> <span m='607750'>structure.</span>
  <span m='608800'>So</span> <span m='609160'>you're</span> <span m='609310'>doing</span>
  <span m='610300'>data</span> <span m='610510'>structures</span> <span m='610900'>in</span>
  <span m='610990'>general.</span> <span m='611290'>We</span> <span m='611410'>have</span>
  <span m='611680'>update</span> <span m='612040'>operations</span> <span m='612700'>and</span>
  <span m='612790'>query</span> <span m='613150'>operations.</span> <span m='614550'>We're</span>
  <span m='614770'>mainly</span> <span m='614950'>concerned</span> <span m='615310'>about</span>
  <span m='615520'>updates</span> <span m='615940'>here.</span> <span m='616690'>Every</span>
  <span m='616900'>time</span> <span m='617110'>you</span> <span m='617170'>do</span>
  <span m='617290'>an</span> <span m='617380'>update,</span> <span m='617710'>you</span>
  <span m='617800'>think</span> <span m='618040'>of</span> <span m='618130'>it</span>
  <span m='618220'>as</span> <span m='618340'>taking</span> <span m='618880'>a</span>
  <span m='618940'>version</span> <span m='619360'>of</span> <span m='619420'>the</span>
  <span m='619510'>data</span> <span m='619720'>structure and</span> <span m='620190'>making</span>
  <span m='620410'>a</span> <span m='620470'>new</span> <span m='620650'>one.</span>
  <span m='621730'>And</span> <span m='621850'>you</span> <span m='621940'>never</span>
  <span m='622210'>want</span> <span m='622360'>to</span> <span m='622420'>destroy</span>
  <span m='622840'>old</span> <span m='623020'>versions.</span> <span m='623800'>So</span>
  <span m='623950'>even</span> <span m='624160'>though</span> <span m='624240'>an</span>
  <span m='624370'>update</span> <span m='624700'>like</span> <span m='624850'>an</span>
  <span m='624940'>insert</span> <span m='625300'>or</span> <span m='625360'>something</span>
  <span m='626230'>changes</span> <span m='626620'>the</span> <span m='626680'>data</span>
  <span m='626890'>structure,</span> <span m='627670'>we</span> <span m='627820'>want</span>
  <span m='627940'>to</span> <span m='628000'>remember</span> <span m='628360'>that</span>
  <span m='628540'>past</span> <span m='628950'>data</span> <span m='629230'>as</span>
  <span m='629350'>well.</span> </p><p><span m='630770'>And</span> <span m='631120'>then</span>
  <span m='632350'>let's</span> <span m='632530'>make</span> <span m='632740'>this</span>
  <span m='633100'>reasonable.</span> <span m='634030'>All</span> <span m='634270'>data</span>
  <span m='634510'>structure</span> <span m='634960'>operations</span> <span m='636220'>are</span>
  <span m='636370'>relative</span> <span m='637120'>to</span> <span m='637270'>a</span>
  <span m='637300'>specified</span> <span m='637900'>version.</span> <span m='647200'>So</span>
  <span m='648790'>an</span> <span m='649000'>update</span> <span m='652810'>makes</span>
  <span m='654370'>and</span> <span m='654580'>returns</span> <span m='656590'>a</span>
  <span m='656680'>new</span> <span m='656800'>version.</span> </p><p><span m='665690'>So</span>
  <span m='665870'>when</span> <span m='665990'>you</span> <span m='666050'>do</span>
  <span m='666170'>an</span> <span m='666260'>insert,</span> <span m='666950'>you</span>
  <span m='667010'>specify</span> <span m='668750'>a</span> <span m='668780'>version</span>
  <span m='669200'>of</span> <span m='669290'>your</span> <span m='669380'>data</span>
  <span m='669590'>structure</span> <span m='670430'>and</span> <span m='670610'>the</span>
  <span m='670700'>thing</span> <span m='670850'>you</span> <span m='670970'>want</span>
  <span m='671090'>to</span> <span m='671150'>insert.</span> <span m='671960'>And</span>
  <span m='672080'>the</span> <span m='672200'>output</span> <span m='672560'>is</span>
  <span m='672710'>a</span> <span m='672770'>new</span> <span m='672890'>version.</span>
  <span m='673850'>So</span> <span m='673970'>then</span> <span m='674120'>you</span>
  <span m='674210'>could</span> <span m='674450'>insert</span> <span m='674840'>into</span>
  <span m='674990'>that</span> <span m='675110'>new</span> <span m='675260'>version,</span>
  <span m='675650'>keep</span> <span m='675830'>going,</span> <span m='676550'>or</span>
  <span m='676790'>maybe</span> <span m='677000'>go</span> <span m='677120'>back</span>
  <span m='677300'>to</span> <span m='677390'>the</span> <span m='677510'>old</span>
  <span m='677660'>version,</span> <span m='678050'>modify</span> <span m='678410'>that.</span>
  </p><p><span m='680210'>I</span> <span m='680270'>haven't</span> <span m='680510'>said</span>
  <span m='680960'>exactly</span> <span m='681380'>what's</span> <span m='681560'>allowed</span>
  <span m='681860'>here,</span> <span m='682450'>but</span> <span m='682570'>this</span>
  <span m='682700'>is sort</span> <span m='682880'>of</span> <span m='682940'>the</span>
  <span m='683030'>general</span> <span m='683870'>goal.</span> <span m='685460'>And</span>
  <span m='685580'>then</span> <span m='685820'>there</span> <span m='686090'>are</span>
  <span m='687290'>four</span> <span m='687740'>levels</span> <span m='689240'>of</span>
  <span m='689390'>persistence</span> <span m='690950'>that</span> <span m='691070'>you</span>
  <span m='691220'>might</span> <span m='691460'>want</span> <span m='691700'>to</span>
  <span m='691790'>get.</span> </p><p><span m='693020'>First</span> <span m='693290'>level</span>
  <span m='694700'>is</span> <span m='694790'>called</span> <span m='695000'>partial</span>
  <span m='695420'>persistence.</span> <span m='697530'>This</span> <span m='697610'>is</span>
  <span m='697700'>the</span> <span m='697820'>easiest</span> <span m='698270'>to</span>
  <span m='698420'>obtain.</span> <span m='704300'>And</span> <span m='706490'>in
  partial</span> <span m='706910'>persistence,</span> <span m='707450'>you're</span>
  <span m='707630'>only</span> <span m='708020'>allowed</span> <span m='708560'>to</span>
  <span m='708710'>update</span> <span m='710000'>the</span> <span m='710090'>latest</span>
  <span m='710540'>version,</span> <span m='715250'>which</span> <span m='715460'>means</span>
  <span m='717940'>the</span> <span m='718040'>versions</span> <span m='718520'>are</span>
  <span m='718640'>linearly</span> <span m='719120'>ordered.</span> </p><p><span m='721670'>This
  is</span> <span m='721850'>the</span> <span m='721940'>easiest</span> <span m='722300'>to</span>
  <span m='722390'>think</span> <span m='722600'>about.</span> <span m='723770'>And</span>
  <span m='724130'>time</span> <span m='724340'>travel</span> <span m='724670'>can</span>
  <span m='724820'>easily</span> <span m='725120'>get</span> <span m='725270'>confusing,</span>
  <span m='725970'>so</span> <span m='726620'>start</span> <span m='726890'>simple.</span>
  <span m='729300'>We</span> <span m='729380'>have</span> <span m='730820'>a</span>
  <span m='730880'>timeline</span> <span m='732070'>of</span> <span m='732280'>various</span>
  <span m='732560'>versions</span> <span m='732980'>on</span> <span m='733130'>it.</span>
  <span m='734780'>This</span> <span m='735050'>is</span> <span m='735170'>the</span>
  <span m='735290'>latest.</span> <span m='737420'>And</span> <span m='737570'>what</span>
  <span m='737690'>we</span> <span m='737810'>can</span> <span m='737930'>do</span>
  <span m='738080'>is</span> <span m='738230'>update</span> <span m='738620'>that</span>
  <span m='739010'>version.</span> <span m='739850'>We'll</span> <span m='740120'>get</span>
  <span m='740270'>a</span> <span m='740330'>new</span> <span m='740480'>version,</span>
  <span m='741080'>and</span> <span m='741170'>then</span> <span m='741320'>our</span>
  <span m='741410'>latest</span> <span m='741800'>is</span> <span m='741890'>this</span>
  <span m='742070'>one.</span> </p><p><span m='743750'>What</span> <span m='743990'>this</span>
  <span m='744140'>allows</span> <span m='744620'>is</span> <span m='744770'>looking</span>
  <span m='745160'>back</span> <span m='745820'>at</span> <span m='745970'>the</span>
  <span m='746090'>past</span> <span m='747020'>to</span> <span m='747200'>an</span>
  <span m='747290'>old</span> <span m='747470'>version</span> <span m='747950'>and</span>
  <span m='748100'>querying</span> <span m='748610'>that</span> <span m='748790'>version.</span>
  <span m='749310'>So</span> <span m='749410'>you</span> <span m='749510'>can</span>
  <span m='749610'>still</span> <span m='749720'>ask</span> <span m='749930'>questions</span>
  <span m='750410'>about</span> <span m='750620'>the</span> <span m='750740'>old</span>
  <span m='750920'>version,</span> <span m='751490'>if</span> <span m='751720'>you</span>
  <span m='751820'>want</span> <span m='751940'>to</span> <span m='752000'>be</span>
  <span m='752060'>able</span> <span m='752180'>to</span> <span m='752240'>do</span>
  <span m='752360'>a</span> <span m='752390'>search</span> <span m='752810'>on</span>
  <span m='752900'>any</span> <span m='753020'>of</span> <span m='753080'>these</span>
  <span m='753650'>data</span> <span m='753830'>structures.</span> <span m='754280'>But</span>
  <span m='754400'>you</span> <span m='754490'>can't</span> <span m='754760'>change</span>
  <span m='755120'>them.</span> <span m='755600'>You</span> <span m='755690'>can</span>
  <span m='755810'>only</span> <span m='756080'>change</span> <span m='756410'>the</span>
  <span m='756500'>most</span> <span m='756740'>recent</span> <span m='757040'>version.</span>
  <span m='758180'>So</span> <span m='758300'>that's</span> <span m='758510'>nice.</span>
  <span m='759470'>It's</span> <span m='759680'>kind</span> <span m='759980'>of</span>
  <span m='760070'>like</span> <span m='761390'>time</span> <span m='761750'>machine</span>
  <span m='762170'>on</span> <span m='762290'>Mac,</span> <span m='762620'>I</span>
  <span m='762680'>guess.</span> </p><p><span m='764690'>If</span> <span m='764750'>you've</span>
  <span m='764870'>ever</span> <span m='765050'>seen</span> <span m='765230'>the</span>
  <span m='765320'>movie</span> <span m='765560'><i>Deja</i></span> <span m='765920'><i>Vu,</i></span>
  <span m='766340'>which</span> <span m='766520'>is</span> <span m='766730'>not</span>
  <span m='766970'>very</span> <span m='767120'>common,</span> <span m='767510'>but</span>
  <span m='767630'>it's</span> <span m='767720'>a</span> <span m='767780'>good</span>
  <span m='767930'>time</span> <span m='768170'>travel</span> <span m='768470'>movie,</span>
  <span m='769250'>in</span> <span m='769340'>the</span> <span m='769460'>first</span>
  <span m='769790'>half</span> <span m='770060'>of</span> <span m='770120'>the</span>
  <span m='770210'>movie,</span> <span m='770810'>all</span> <span m='771080'>they</span>
  <span m='771230'>can</span> <span m='771380'>do</span> <span m='771500'>is</span>
  <span m='771590'>look</span> <span m='771800'>back</span> <span m='772040'>at</span>
  <span m='772100'>the</span> <span m='772190'>past.</span> <span m='772550'>Later</span>
  <span m='773300'>they</span> <span m='773420'>discover</span> <span m='773840'>that</span>
  <span m='773960'>actually</span> <span m='774560'>they</span> <span m='774710'>have</span>
  <span m='774920'>a</span> <span m='775010'>full</span> <span m='775220'>persistence</span>
  <span m='775760'>model.</span> <span m='777850'>It</span> <span m='778180'>takes</span>
  <span m='778430'>a</span> <span m='778570'>while</span> <span m='779030'>for</span>
  <span m='779210'>dramatic</span> <span m='779660'>effect.</span> </p><p><span m='784250'>In</span>
  <span m='784460'>full</span> <span m='784700'>persistence,</span> <span m='786170'>you</span>
  <span m='786320'>can</span> <span m='786440'>update</span> <span m='786710'>anything</span>
  <span m='787040'>you</span> <span m='787130'>want--</span> <span m='788750'>so</span>
  <span m='790220'>update</span> <span m='790520'>any</span> <span m='790760'>version.</span>
  <span m='798070'>and</span> <span m='798680'>so</span> <span m='799190'>then</span>
  <span m='799700'>the</span> <span m='799820'>versions</span> <span m='803480'>form</span>
  <span m='803690'>a</span> <span m='803750'>tree.</span> <span m='808020'>OK.</span>
  <span m='808460'>So</span> <span m='808610'>in</span> <span m='808700'>this</span>
  <span m='808850'>model,</span> <span m='809580'>maybe</span> <span m='809730'>you</span>
  <span m='809780'>initially</span> <span m='810200'>have</span> <span m='810740'>a</span>
  <span m='810800'>nice</span> <span m='811640'>line</span> <span m='811940'>of</span>
  <span m='812000'>versions.</span> <span m='812420'>But</span> <span m='812540'>now</span>
  <span m='812720'>if</span> <span m='812810'>I</span> <span m='812900'>go</span>
  <span m='813050'>back</span> <span m='813320'>to</span> <span m='813410'>this</span>
  <span m='813590'>version</span> <span m='813890'>and</span> <span m='814010'>update</span>
  <span m='814430'>it,</span> <span m='814860'>I</span> <span m='815000'>branch,</span>
  <span m='815930'>get</span> <span m='816110'>a</span> <span m='816170'>new</span>
  <span m='816350'>version</span> <span m='816740'>here.</span> <span m='817340'>And</span>
  <span m='817460'>then</span> <span m='817610'>I</span> <span m='817710'>might</span>
  <span m='817870'>keep</span> <span m='818060'>modifying</span> <span m='818540'>that</span>
  <span m='818660'>version</span> <span m='819020'>sometimes.</span> <span m='820400'>Any</span>
  <span m='820610'>of</span> <span m='820670'>these</span> <span m='820880'>guys</span>
  <span m='821240'>can</span> <span m='821390'>branch.</span> </p><p><span m='824240'>So</span>
  <span m='824360'>this</span> <span m='824570'>is</span> <span m='824690'>why</span>
  <span m='824990'>I</span> <span m='825110'>call</span> <span m='825350'>it</span>
  <span m='825440'>the</span> <span m='825560'>branching</span> <span m='825950'>universe</span>
  <span m='826310'>model,</span> <span m='827360'>when</span> <span m='827480'>you</span>
  <span m='827600'>update</span> <span m='829320'>your</span> <span m='829430'>branch.</span>
  <span m='832520'>So</span> <span m='832670'>no</span> <span m='832850'>version</span>
  <span m='833240'>ever</span> <span m='833420'>gets</span> <span m='833630'>destroyed</span>
  <span m='834050'>here.</span> <span m='834380'>Again,</span> <span m='834650'>you</span>
  <span m='834770'>can</span> <span m='834920'>query</span> <span m='835310'>all</span>
  <span m='835490'>versions.</span> <span m='836720'>But</span> <span m='836930'>now</span>
  <span m='837230'>you</span> <span m='837350'>can</span> <span m='837470'>also</span>
  <span m='837710'>update</span> <span m='838370'>any</span> <span m='838610'>version.</span>
  <span m='839360'>But</span> <span m='839540'>you</span> <span m='839660'>just</span>
  <span m='839870'>make</span> <span m='840140'>a</span> <span m='840200'>new</span>
  <span m='840350'>version.</span> <span m='840710'>It's</span> <span m='840860'>a</span>
  <span m='841150'>totally</span> <span m='841490'>new</span> <span m='841640'>world.</span>
  </p><p><span m='842660'>When</span> <span m='842810'>I</span> <span m='842900'>update</span>
  <span m='843200'>this</span> <span m='843380'>version,</span> <span m='843890'>this</span>
  <span m='844160'>version</span> <span m='844490'>knows</span> <span m='844670'>nothing</span>
  <span m='845150'>about</span> <span m='845540'>all</span> <span m='845870'>the--</span>
  <span m='846410'>this</span> <span m='846770'>doesn't</span> <span m='847070'>know</span>
  <span m='847160'>about</span> <span m='847370'>this</span> <span m='847550'>future.</span>
  <span m='847940'>It's</span> <span m='848270'>created</span> <span m='848630'>its</span>
  <span m='848780'>own</span> <span m='848960'>future.</span> <span m='850890'>There's</span>
  <span m='851030'>no</span> <span m='851210'>way</span> <span m='851330'>to</span>
  <span m='851450'>sort</span> <span m='851630'>of</span> <span m='851720'>merge</span>
  <span m='852050'>those</span> <span m='852260'>universes</span> <span m='852770'>together.</span>
  <span m='854310'>It's</span> <span m='854420'>kind</span> <span m='854570'>of</span>
  <span m='854660'>sad.</span> </p><p><span m='856910'>That's</span> <span m='857150'>why</span>
  <span m='858590'>we</span> <span m='858710'>have</span> <span m='858890'>the</span>
  <span m='859010'>third</span> <span m='859310'>level</span> <span m='859610'>of</span>
  <span m='859700'>persistence,</span> <span m='862220'>which</span> <span m='862430'>lets</span>
  <span m='862700'>us</span> <span m='862880'>merge</span> <span m='863360'>timelines.</span>
  <span m='864680'>It's</span> <span m='864800'>great</span> <span m='865160'>for</span>
  <span m='866420'>lots</span> <span m='866630'>of</span> <span m='866690'>fiction</span>
  <span m='867480'>out</span> <span m='867640'>there.</span> <span m='875880'>If</span>
  <span m='876055'>you've</span> <span m='876230'>seen the</span> <span m='876350'>old</span>
  <span m='876530'>TV</span> <span m='876800'>show</span> <span m='877040'><i>Sliders,</i></span>
  <span m='878360'>that</span> <span m='878570'>would</span> <span m='878720'>be</span>
  <span m='879410'>confluent</span> <span m='879890'>persistence.</span> </p><p><span
  m='890830'>So</span> <span m='891040'>confluent</span> <span m='891400'>persistence,</span>
  <span m='891980'>you</span> <span m='892220'>can</span> <span m='892580'>combine</span>
  <span m='893680'>two</span> <span m='893840'>versions</span> <span m='901790'>to</span>
  <span m='901910'>create</span> <span m='902450'>a</span> <span m='902510'>new</span>
  <span m='902660'>version.</span> <span m='909220'>And</span> <span m='909410'>in</span>
  <span m='909470'>this</span> <span m='909680'>case,</span> <span m='911360'>again,</span>
  <span m='911570'>you</span> <span m='911660'>can't</span> <span m='911900'>destroy</span>
  <span m='912350'>old</span> <span m='912500'>versions.</span> <span m='913720'>In</span>
  <span m='913880'>persistence,</span> <span m='914360'>you</span> <span m='914450'>never</span>
  <span m='914660'>destroy</span> <span m='914990'>versions.</span> <span m='916260'>So</span>
  <span m='916310'>now</span> <span m='916670'>the</span> <span m='916790'>versions</span>
  <span m='917450'>form</span> <span m='918760'>a</span> <span m='918830'>DAG,</span>
  <span m='919400'>directed</span> <span m='919940'>acyclic</span> <span m='920420'>graph.</span>
  </p><p><span m='922520'>So</span> <span m='922700'>now</span> <span m='923150'>we're</span>
  <span m='923390'>allowing--</span> <span m='924010'>OK,</span> <span m='924370'>you
  make</span> <span m='924580'>some</span> <span m='924740'>changes,</span> <span
  m='925160'>whatever.</span> <span m='925520'>You</span> <span m='925640'>branch</span>
  <span m='926060'>your</span> <span m='926240'>universe,</span> <span m='927530'>make</span>
  <span m='927710'>some</span> <span m='927920'>changes.</span> <span m='930560'>And</span>
  <span m='930680'>now</span> <span m='930830'>I</span> <span m='930860'>can</span>
  <span m='931040'>say,</span> <span m='931350'>OK,</span> <span m='931520'>take</span>
  <span m='931730'>this</span> <span m='931910'>version</span> <span m='932180'>of
  the</span> <span m='932310'>data</span> <span m='932440'>structure</span> <span
  m='932810'>and</span> <span m='932990'>this</span> <span m='933170'>version</span>
  <span m='933920'>and</span> <span m='934100'>recombine</span> <span m='934790'>them.</span>
  <span m='935510'>Get</span> <span m='935660'>a</span> <span m='935720'>new</span>
  <span m='935870'>version,</span> <span m='936290'>and</span> <span m='936440'>then</span>
  <span m='936590'>maybe</span> <span m='936860'>make</span> <span m='937040'>some</span>
  <span m='937190'>more</span> <span m='937340'>changes.</span> </p><p><span m='938730'>OK,</span>
  <span m='939440'>what</span> <span m='939590'>does</span> <span m='939710'>combine</span>
  <span m='940190'>mean?</span> <span m='941000'>Well,</span> <span m='941090'>it</span>
  <span m='941160'>depends</span> <span m='941480'>on</span> <span m='941570'>your</span>
  <span m='941660'>data</span> <span m='941900'>structure.</span> <span m='942320'>A</span>
  <span m='942350'>lot</span> <span m='942590'>of</span> <span m='942680'>data</span>
  <span m='942830'>structures</span> <span m='943220'>have</span> <span m='943490'>combine</span>
  <span m='943850'>operations</span> <span m='944420'>like</span> <span m='945600'>if</span>
  <span m='945720'>you</span> <span m='945780'>have</span> <span m='945920'>linked</span>
  <span m='946160'>lists,</span> <span m='947240'>you</span> <span m='947300'>have</span>
  <span m='947390'>two</span> <span m='947570'>linked</span> <span m='947750'>lists,</span>
  <span m='948050'>you</span> <span m='948170'>can</span> <span m='948290'>concatenate</span>
  <span m='948860'>them.</span> <span m='949070'>That's</span> <span m='949250'>an</span>
  <span m='949340'>easy</span> <span m='949580'>operation.</span> <span m='950180'>Even</span>
  <span m='950360'>if</span> <span m='950480'>you</span> <span m='950540'>have</span>
  <span m='950660'>binary</span> <span m='950990'>search</span> <span m='951260'>trees,</span>
  <span m='951530'>you</span> <span m='951650'>can</span> <span m='951800'>concatenate</span>
  <span m='952400'>them</span> <span m='952940'>reasonably</span> <span m='953450'>easy</span>
  <span m='953750'>and</span> <span m='953840'>combine it</span> <span m='954270'>into</span>
  <span m='954500'>one</span> <span m='954740'>big</span> <span m='954980'>binary</span>
  <span m='955310'>search</span> <span m='955580'>tree.</span> </p><p><span m='956670'>So</span>
  <span m='957140'>if</span> <span m='957320'>your</span> <span m='957410'>data</span>
  <span m='957620'>structure</span> <span m='957950'>has</span> <span m='958280'>an</span>
  <span m='958370'>operation</span> <span m='958940'>that</span> <span m='959060'>takes</span>
  <span m='959330'>as</span> <span m='959450'>input</span> <span m='959840'>two</span>
  <span m='960140'>data</span> <span m='960380'>structures,</span> <span m='961850'>then</span>
  <span m='962060'>what</span> <span m='962210'>we're</span> <span m='962300'>saying</span>
  <span m='962600'>is</span> <span m='962690'>now</span> <span m='963020'>it</span>
  <span m='963080'>can</span> <span m='963230'>take</span> <span m='963470'>two</span>
  <span m='963650'>versions,</span> <span m='965130'>which</span> <span m='965150'>is</span>
  <span m='965240'>more</span> <span m='965420'>general.</span> <span m='966430'>So</span>
  <span m='966530'>I</span> <span m='966590'>could</span> <span m='966710'>take</span>
  <span m='966890'>the</span> <span m='966980'>same</span> <span m='967220'>data</span>
  <span m='967430'>structure,</span> <span m='968240'>make</span> <span m='968390'>some</span>
  <span m='968570'>changes</span> <span m='969140'>in</span> <span m='969260'>one</span>
  <span m='969470'>way,</span> <span m='969740'>separately</span> <span m='970250'>make</span>
  <span m='970430'>some</span> <span m='970580'>changes</span> <span m='970910'>in</span>
  <span m='970970'>a</span> <span m='971000'>different</span> <span m='971270'>way,</span>
  <span m='971420'>and</span> <span m='971570'>then</span> <span m='971750'>try</span>
  <span m='971900'>to</span> <span m='971990'>concatenate</span> <span m='972530'>them</span>
  <span m='972740'>or</span> <span m='972830'>do</span> <span m='972950'>something</span>
  <span m='973280'>crazy.</span> </p><p><span m='974660'>This</span> <span m='974930'>is</span>
  <span m='975140'>hard</span> <span m='975470'>to</span> <span m='975590'>do,</span>
  <span m='975800'>and</span> <span m='976070'>most</span> <span m='976370'>of</span>
  <span m='976460'>it</span> <span m='976550'>is</span> <span m='976640'>an</span>
  <span m='976700'>open</span> <span m='976940'>problem</span> <span m='977510'>whether</span>
  <span m='977750'>it</span> <span m='977810'>can</span> <span m='977960'>be</span>
  <span m='978050'>done.</span> <span m='979090'>But</span> <span m='980360'>I'll</span>
  <span m='980510'>tell</span> <span m='980690'>you</span> <span m='980750'>about</span>
  <span m='981020'>it.</span> <span m='981590'>Then</span> <span m='981860'>there's</span>
  <span m='982130'>another</span> <span m='982580'>level</span> <span m='982940'>even</span>
  <span m='983300'>more</span> <span m='984160'>than</span> <span m='984320'>confluent</span>
  <span m='984860'>persistence.</span> <span m='986550'>This</span> <span m='986630'>is</span>
  <span m='987050'>hard</span> <span m='987260'>to</span> <span m='987380'>interpret</span>
  <span m='988190'>in</span> <span m='988550'>the</span> <span m='989180'>time</span>
  <span m='989420'>travel</span> <span m='989780'>world,</span> <span m='990590'>but</span>
  <span m='990920'>it</span> <span m='991070'>would</span> <span m='991190'>be</span>
  <span m='991310'>functional</span> <span m='991790'>data</span> <span m='992000'>structures.</span>
  <span m='992430'>If</span> <span m='992570'>you've ever</span> <span m='992780'>programmed</span>
  <span m='993200'>in</span> <span m='993290'>a</span> <span m='993350'>functional</span>
  <span m='993710'>programming</span> <span m='994130'>language,</span> <span m='995240'>it's</span>
  <span m='995420'>a</span> <span m='995480'>little</span> <span m='995690'>bit</span>
  <span m='995840'>annoying</span> <span m='996200'>from</span> <span m='996350'>an</span>
  <span m='996410'>algorithm's</span> <span m='996800'>perspective,</span> <span m='997310'>because</span>
  <span m='997520'>it</span> <span m='997580'>constrains</span> <span m='998180'>you</span>
  <span m='998960'>to</span> <span m='999320'>work</span> <span m='999650'>in</span>
  <span m='1000550'>a</span> <span m='1000610'>purely</span> <span m='1000940'>functional</span>
  <span m='1001330'>world.</span> <span m='1003220'>You</span> <span m='1003370'>can</span>
  <span m='1003520'>never</span> <span m='1003820'>modify</span> <span m='1004240'>anything.</span>
  <span m='1006020'>OK.</span> </p><p><span m='1006400'>Now,</span> <span m='1007030'>we</span>
  <span m='1007180'>don't</span> <span m='1007360'>want</span> <span m='1007480'>to</span>
  <span m='1007570'>modify</span> <span m='1008530'>versions.</span> <span m='1009220'>That's</span>
  <span m='1009400'>fine.</span> <span m='1009830'>But</span> <span m='1009910'>in</span>
  <span m='1010060'>a</span> <span m='1010120'>functional</span> <span m='1010570'>data</span>
  <span m='1010750'>structure,</span> <span m='1011050'>you're</span> <span m='1011200'>not</span>
  <span m='1011350'>allowed</span> <span m='1011590'>to</span> <span m='1011650'>modify</span>
  <span m='1012100'>any</span> <span m='1012340'>nodes</span> <span m='1012700'>ever.</span>
  <span m='1014110'>All</span> <span m='1014350'>you</span> <span m='1014500'>can</span>
  <span m='1014620'>do</span> <span m='1014740'>is</span> <span m='1014860'>make</span>
  <span m='1015070'>new</span> <span m='1015220'>notes.</span> <span m='1023670'>This</span>
  <span m='1023910'>is</span> <span m='1024390'>constraining,</span> <span m='1025109'>and</span>
  <span m='1026790'>you</span> <span m='1026849'>can't</span> <span m='1027119'>always</span>
  <span m='1027329'>get</span> <span m='1027510'>optimal</span> <span m='1027839'>running</span>
  <span m='1028079'>times</span> <span m='1028349'>in</span> <span m='1028410'>the</span>
  <span m='1028470'>functional</span> <span m='1028829'>world.</span> <span m='1029400'>But</span>
  <span m='1029550'>if</span> <span m='1029670'>you</span> <span m='1029790'>can</span>
  <span m='1029910'>get</span> <span m='1030089'>a</span> <span m='1030150'>functional</span>
  <span m='1030510'>data</span> <span m='1030720'>structure,</span> <span m='1031020'>you</span>
  <span m='1031140'>have</span> <span m='1031260'>all</span> <span m='1031560'>these</span>
  <span m='1031800'>things,</span> <span m='1032130'>because</span> <span m='1033119'>you</span>
  <span m='1033300'>can't</span> <span m='1033599'>destroy</span> <span m='1034020'>anything.</span>
  <span m='1034480'>If you</span> <span m='1034560'>can't</span> <span m='1034740'>destroy</span>
  <span m='1035010'>nodes,</span> <span m='1035200'>then</span> <span m='1035349'>in</span>
  <span m='1035460'>particular,</span> <span m='1035950'>you</span> <span m='1036050'>can't</span>
  <span m='1036180'>destroy</span> <span m='1036480'>versions.</span> <span m='1037430'>And</span>
  <span m='1037560'>all</span> <span m='1037710'>of</span> <span m='1037800'>these</span>
  <span m='1037980'>things</span> <span m='1038190'>just</span> <span m='1038339'>work</span>
  <span m='1038520'>for</span> <span m='1038640'>free.</span> </p><p><span m='1039930'>And</span>
  <span m='1040185'>so</span> <span m='1040720'>a</span> <span m='1040780'>bunch</span>
  <span m='1041190'>of</span> <span m='1041369'>special</span> <span m='1041760'>cases</span>
  <span m='1042119'>are</span> <span m='1042200'>known,</span> <span m='1042990'>interesting</span>
  <span m='1043380'>special</span> <span m='1043680'>cases,</span> <span m='1044010'>like</span>
  <span m='1044190'>search</span> <span m='1044420'>trees</span> <span m='1044790'>you</span>
  <span m='1044940'>can</span> <span m='1045060'>do</span> <span m='1045180'>in</span>
  <span m='1045270'>the</span> <span m='1045329'>functional</span> <span m='1045690'>world.</span>
  <span m='1046470'>And</span> <span m='1046589'>that</span> <span m='1046710'>makes</span>
  <span m='1046920'>all</span> <span m='1047069'>of</span> <span m='1047160'>these</span>
  <span m='1047310'>things</span> <span m='1047550'>easy.</span> <span m='1049050'>So</span>
  <span m='1049410'>the</span> <span m='1049500'>rest</span> <span m='1049740'>of</span>
  <span m='1049800'>this</span> <span m='1050160'>lecture</span> <span m='1050580'>is</span>
  <span m='1050670'>going</span> <span m='1050790'>to</span> <span m='1050880'>be</span>
  <span m='1051150'>general</span> <span m='1051600'>techniques</span> <span m='1052020'>for</span>
  <span m='1052140'>doing</span> <span m='1052470'>partial</span> <span m='1052920'>full</span>
  <span m='1053100'>persistence,</span> <span m='1054270'>what</span> <span m='1054480'>we</span>
  <span m='1054600'>know</span> <span m='1054750'>about</span> <span m='1054970'>confluent,</span>
  <span m='1055980'>and</span> <span m='1056130'>what</span> <span m='1056250'>we</span>
  <span m='1056340'>know</span> <span m='1056460'>about</span> <span m='1056640'>functional,</span>
  <span m='1058920'>brief</span> <span m='1059700'>overview.</span> <span m='1061060'>Any</span>
  <span m='1061230'>questions</span> <span m='1061590'>about</span> <span m='1061860'>those</span>
  <span m='1062880'>goals,</span> <span m='1063570'>problem</span> <span m='1063900'>definitions?</span>
  <span m='1067640'>Yeah.</span> </p><p><span m='1068191'>AUDIENCE:</span> <span m='1068672'>I'm
  still</span> <span m='1069153'>confused</span> <span m='1069634'>about functional,</span>
  <span m='1070115'>because--</span> </p><p><span m='1071080'>ERIK DEMAINE:</span>
  <span m='1071155'>What</span> <span m='1071230'>does</span> <span m='1071380'>functional</span>
  <span m='1071770'>mean?</span> </p><p><span m='1072500'>AUDIENCE:</span> <span m='1072653'>[INAUDIBLE]</span>
  </p><p><span m='1075260'>ERIK DEMAINE:</span> <span m='1075415'>Yeah,</span> <span
  m='1075790'>I</span> <span m='1075910'>guess</span> <span m='1076580'>you'll</span>
  <span m='1076760'>see</span> <span m='1077080'>what--</span> <span m='1077680'>functional</span>
  <span m='1078100'>looks</span> <span m='1078370'>like</span> <span m='1078530'>all</span>
  <span m='1078640'>the</span> <span m='1078760'>other</span> <span m='1078940'>things,</span>
  <span m='1079210'>I</span> <span m='1079300'>agree.</span> <span m='1080200'>You'll</span>
  <span m='1080380'>see</span> <span m='1080560'>in</span> <span m='1080650'>a</span>
  <span m='1080710'>moment</span> <span m='1081100'>how</span> <span m='1081340'>we</span>
  <span m='1081490'>actually</span> <span m='1081940'>implement</span> <span m='1082360'>partial
  and</span> <span m='1082660'>persistence.</span> <span m='1083380'>We're</span>
  <span m='1083500'>going</span> <span m='1083620'>to</span> <span m='1083710'>be</span>
  <span m='1083860'>changing</span> <span m='1084340'>nodes</span> <span m='1084610'>a</span>
  <span m='1084670'>lot.</span> <span m='1087490'>As</span> <span m='1087640'>long</span>
  <span m='1087850'>as</span> <span m='1087940'>we</span> <span m='1088030'>still</span>
  <span m='1088390'>represent</span> <span m='1088960'>the</span> <span m='1089080'>same</span>
  <span m='1090160'>data</span> <span m='1090670'>in</span> <span m='1090850'>the</span>
  <span m='1090970'>old</span> <span m='1091180'>versions,</span> <span m='1092110'>we</span>
  <span m='1092200'>don't</span> <span m='1092350'>have</span> <span m='1092470'>to</span>
  <span m='1092560'>represent</span> <span m='1092920'>it</span> <span m='1093040'>in</span>
  <span m='1093190'>the</span> <span m='1093280'>same</span> <span m='1093550'>way.</span>
  <span m='1094360'>That</span> <span m='1094540'>lets</span> <span m='1094780'>us</span>
  <span m='1094870'>do</span> <span m='1095020'>things</span> <span m='1095200'>more</span>
  <span m='1095350'>efficiently.</span> <span m='1095830'>Whereas</span> <span m='1096030'>in</span>
  <span m='1096130'>functional,</span> <span m='1096940'>you</span> <span m='1097000'>have</span>
  <span m='1097120'>to</span> <span m='1097210'>represent</span> <span m='1097720'>all</span>
  <span m='1097930'>the</span> <span m='1098050'>old</span> <span m='1098230'>versions</span>
  <span m='1098620'>in</span> <span m='1098740'>exactly</span> <span m='1099190'>the</span>
  <span m='1099310'>way</span> <span m='1099430'>you</span> <span m='1099520'>used</span>
  <span m='1099730'>to</span> <span m='1099850'>represent</span> <span m='1100300'>them.</span>
  <span m='1100930'>Here</span> <span m='1101140'>we</span> <span m='1101230'>can</span>
  <span m='1101350'>kind</span> <span m='1101530'>of</span> <span m='1101620'>mangle</span>
  <span m='1101920'>things</span> <span m='1102160'>around</span> <span m='1102460'>and
  it</span> <span m='1102550'>makes</span> <span m='1102790'>things</span> <span m='1102970'>faster.</span>
  <span m='1103400'>Yeah,</span> <span m='1104020'>good</span> <span m='1104170'>question.</span>
  </p><p><span m='1105490'>So</span> <span m='1105700'>it</span> <span m='1105880'>seems</span>
  <span m='1106300'>almost</span> <span m='1106600'>the</span> <span m='1106690'>same,</span>
  <span m='1107530'>but</span> <span m='1107680'>it's</span> <span m='1107830'>nodes</span>
  <span m='1108220'>versus</span> <span m='1109480'>versions.</span> <span m='1110140'>I</span>
  <span m='1110230'>haven't</span> <span m='1110410'>really</span> <span m='1110590'>defined</span>
  <span m='1110890'>a</span> <span m='1110950'>version.</span> <span m='1111340'>But</span>
  <span m='1111520'>it's</span> <span m='1111610'>just</span> <span m='1112240'>that</span>
  <span m='1112390'>all</span> <span m='1112600'>the</span> <span m='1112720'>queries</span>
  <span m='1113320'>answer</span> <span m='1113650'>the</span> <span m='1113740'>same</span>
  <span m='1114010'>way.</span> <span m='1114580'>That's</span> <span m='1114790'>what</span>
  <span m='1114940'>you</span> <span m='1115030'>need</span> <span m='1115240'>for</span>
  <span m='1116350'>persistence.</span> <span m='1118580'>Other</span> <span m='1118750'>questions?</span>
  <span m='1120780'>All</span> <span m='1121020'>right.</span> </p><p><span m='1123620'>Well,</span>
  <span m='1123770'>let's</span> <span m='1123980'>do</span> <span m='1124100'>some</span>
  <span m='1124280'>real</span> <span m='1124460'>data</span> <span m='1124700'>structures.</span>
  <span m='1129660'>We</span> <span m='1129750'>start</span> <span m='1129990'>with</span>
  <span m='1130110'>partial</span> <span m='1130530'>persistence.</span> <span m='1136150'>This</span>
  <span m='1136200'>is</span> <span m='1136320'>the</span> <span m='1136410'>easiest.</span>
  <span m='1139680'>For</span> <span m='1139890'>both</span> <span m='1140130'>partial</span>
  <span m='1140550'>and</span> <span m='1140640'>full</span> <span m='1140820'>persistence,</span>
  <span m='1142080'>there</span> <span m='1142260'>is</span> <span m='1143520'>the</span>
  <span m='1143610'>following</span> <span m='1144000'>result.</span> <span m='1145290'>Any</span>
  <span m='1145560'>pointer</span> <span m='1145880'>machine</span> <span m='1146190'>data</span>
  <span m='1146400'>structure,</span> <span m='1153270'>one</span> <span m='1153450'>catch</span>
  <span m='1154890'>with</span> <span m='1155370'>a</span> <span m='1155430'>constant</span>
  <span m='1156090'>number</span> <span m='1158940'>of</span> <span m='1159090'>pointers</span>
  <span m='1159660'>to</span> <span m='1159780'>any</span> <span m='1159990'>node--</span>
  <span m='1162220'>so</span> <span m='1162270'>this</span> <span m='1162540'>is</span>
  <span m='1163200'>constant</span> <span m='1163680'>n</span> <span m='1163890'>degree.</span>
  </p><p><span m='1168150'>In</span> <span m='1168270'>a</span> <span m='1168330'>pointer</span>
  <span m='1168600'>machine,</span> <span m='1168960'>you</span> <span m='1169110'>always</span>
  <span m='1169380'>have</span> <span m='1169530'>a</span> <span m='1169590'>constant</span>
  <span m='1169875'>number of</span> <span m='1170160'>pointers</span> <span m='1170580'>out</span>
  <span m='1170820'>of</span> <span m='1170910'>a</span> <span m='1170970'>node</span>
  <span m='1171660'>at</span> <span m='1171750'>most.</span> <span m='1172540'>But</span>
  <span m='1173320'>for</span> <span m='1173490'>this</span> <span m='1173640'>result</span>
  <span m='1173910'>to</span> <span m='1174000'>hold,</span> <span m='1174180'>we</span>
  <span m='1174300'>also</span> <span m='1174540'>need</span> <span m='1174750'>a</span>
  <span m='1174810'>constant</span> <span m='1175390'>number</span> <span m='1175590'>of</span>
  <span m='1175680'>pointers</span> <span m='1176040'>into</span> <span m='1176370'>any</span>
  <span m='1176520'>node.</span> <span m='1177280'>So</span> <span m='1177510'>this
  is an</span> <span m='1177630'>extra</span> <span m='1177900'>constraint.</span>
  </p><p><span m='1182910'>Can</span> <span m='1183300'>be</span> <span m='1184860'>transformed</span>
  <span m='1185400'>into</span> <span m='1185550'>another</span> <span m='1185820'>data</span>
  <span m='1186030'>structure</span> <span m='1187140'>that</span> <span m='1187320'>is</span>
  <span m='1187650'>partially</span> <span m='1188090'>persistent</span> <span m='1190800'>and</span>
  <span m='1190970'>does</span> <span m='1191160'>all</span> <span m='1191320'>the</span>
  <span m='1191400'>things</span> <span m='1191670'>it</span> <span m='1191760'>used</span>
  <span m='1191940'>to</span> <span m='1192060'>do--</span> <span m='1193770'>so</span>
  <span m='1193920'>I'll</span> <span m='1193980'>just</span> <span m='1194160'>say,</span>
  <span m='1194370'>can</span> <span m='1194550'>be</span> <span m='1194670'>made</span>
  <span m='1194850'>partially</span> <span m='1195240'>persistent.</span> <span m='1200300'>You</span>
  <span m='1200430'>have</span> <span m='1200520'>to</span> <span m='1200610'>pay</span>
  <span m='1200820'>something,</span> <span m='1201450'>but</span> <span m='1201630'>you</span>
  <span m='1201780'>have</span> <span m='1201870'>to</span> <span m='1201960'>pay</span>
  <span m='1202110'>very</span> <span m='1202320'>little--</span> <span m='1203550'>constant</span>
  <span m='1206220'>amortized</span> <span m='1211140'>factor</span> <span m='1211680'>overhead,</span>
  <span m='1212550'>multiplicative</span> <span m='1213180'>overhead</span> <span
  m='1218170'>and</span> <span m='1220510'>constant</span> <span m='1221020'>amount</span>
  <span m='1221860'>of</span> <span m='1223270'>additive</span> <span m='1223610'>space</span>
  <span m='1225880'>per</span> <span m='1226780'>change</span> <span m='1227440'>in</span>
  <span m='1227530'>the</span> <span m='1227620'>data</span> <span m='1227830'>structure.</span>
  </p><p><span m='1230290'>So</span> <span m='1230410'>every</span> <span m='1230680'>time</span>
  <span m='1231730'>you</span> <span m='1231880'>do</span> <span m='1232030'>a</span>
  <span m='1232090'>modification</span> <span m='1233140'>in</span> <span m='1233260'>your</span>
  <span m='1233380'>pointer</span> <span m='1233660'>machine--</span> <span m='1234040'>you</span>
  <span m='1234160'>set</span> <span m='1234430'>one</span> <span m='1234580'>of</span>
  <span m='1234640'>the</span> <span m='1234730'>fields</span> <span m='1235030'>to</span>
  <span m='1235150'>something--</span> <span m='1236260'>you</span> <span m='1236380'>have</span>
  <span m='1236470'>to</span> <span m='1236560'>store</span> <span m='1236800'>that</span>
  <span m='1236980'>forever.</span> <span m='1237830'>So,</span> <span m='1238150'>I</span>
  <span m='1238210'>mean,</span> <span m='1238360'>this</span> <span m='1238510'>is</span>
  <span m='1238630'>the</span> <span m='1238720'>best</span> <span m='1238990'>you</span>
  <span m='1239050'>could</span> <span m='1239170'>hope</span> <span m='1239350'>to</span>
  <span m='1239440'>do.</span> <span m='1239980'>You've</span> <span m='1240280'>got</span>
  <span m='1240400'>to</span> <span m='1240460'>store</span> <span m='1240670'>everything</span>
  <span m='1240970'>that</span> <span m='1241090'>happened.</span> <span m='1243250'>You
  pay a</span> <span m='1243370'>constant</span> <span m='1243700'>factor</span> <span
  m='1243970'>overhead,</span> <span m='1244440'>eh.</span> <span m='1245760'>We're</span>
  <span m='1246130'>theoreticians.</span> <span m='1246670'>That</span> <span m='1246760'>doesn't</span>
  <span m='1246940'>matter.</span> <span m='1248170'>Then</span> <span m='1248500'>you</span>
  <span m='1248680'>get</span> <span m='1249160'>any</span> <span m='1249400'>data</span>
  <span m='1249640'>structure</span> <span m='1250060'>in</span> <span m='1250150'>this</span>
  <span m='1250330'>world</span> <span m='1250840'>can</span> <span m='1251050'>be</span>
  <span m='1251200'>made</span> <span m='1251380'>partially</span> <span m='1251740'>persistent.</span>
  <span m='1253270'>That's</span> <span m='1253480'>nice.</span> <span m='1254110'>Let's</span>
  <span m='1254260'>prove</span> <span m='1254500'>it.</span> </p><p><span m='1260330'>OK,</span>
  <span m='1260490'>the</span> <span m='1260610'>idea</span> <span m='1261090'>is</span>
  <span m='1261630'>pretty</span> <span m='1261870'>simple.</span> <span m='1264780'>Pointer</span>
  <span m='1265050'>machines</span> <span m='1265380'>are</span> <span m='1265470'>all</span>
  <span m='1265590'>about</span> <span m='1265830'>nodes</span> <span m='1266250'>and</span>
  <span m='1266370'>fields.</span> <span m='1266790'>So</span> <span m='1267810'>we</span>
  <span m='1267870'>just</span> <span m='1268020'>need</span> <span m='1268170'>to</span>
  <span m='1268260'>simulate</span> <span m='1268740'>whatever</span> <span m='1269070'>the</span>
  <span m='1269190'>data</span> <span m='1269370'>structure</span> <span m='1269730'>is</span>
  <span m='1269820'>doing</span> <span m='1270180'>to</span> <span m='1270300'>those</span>
  <span m='1270690'>nodes</span> <span m='1270930'>and</span> <span m='1271050'>fields</span>
  <span m='1271410'>in</span> <span m='1271530'>a</span> <span m='1271590'>way</span>
  <span m='1271710'>that</span> <span m='1271830'>we</span> <span m='1271950'>don't</span>
  <span m='1272130'>lose</span> <span m='1272430'>all</span> <span m='1272580'>the</span>
  <span m='1272640'>information</span> <span m='1273540'>and</span> <span m='1273690'>we</span>
  <span m='1273780'>can</span> <span m='1273900'>still</span> <span m='1274200'>search</span>
  <span m='1274470'>it</span> <span m='1274530'>very</span> <span m='1274740'>quickly.</span>
  <span m='1277320'>First</span> <span m='1277650'>idea</span> <span m='1278010'>is</span>
  <span m='1278310'>to</span> <span m='1278670'>store</span> <span m='1279030'>back</span>
  <span m='1279420'>pointers.</span> <span m='1281190'>And</span> <span m='1281280'>this</span>
  <span m='1281460'>is</span> <span m='1281550'>why</span> <span m='1281760'>we</span>
  <span m='1281880'>need</span> <span m='1282090'>the</span> <span m='1282300'>constant</span>
  <span m='1282720'>n</span> <span m='1282900'>degree</span> <span m='1283800'>constraint.</span>
  </p><p><span m='1287530'>So</span> <span m='1287670'>if</span> <span m='1287820'>we</span>
  <span m='1287940'>have</span> <span m='1289260'>a</span> <span m='1289320'>node--</span>
  <span m='1291075'>how do</span> <span m='1291500'>I</span> <span m='1291590'>want</span>
  <span m='1291710'>to</span> <span m='1291800'>draw</span> <span m='1292040'>a</span>
  <span m='1292070'>node</span> <span m='1292370'>here?</span> <span m='1295640'>So</span>
  <span m='1295760'>maybe</span> <span m='1296000'>these</span> <span m='1296180'>are</span>
  <span m='1296240'>the</span> <span m='1296540'>three</span> <span m='1296840'>fields</span>
  <span m='1297260'>of</span> <span m='1297380'>the</span> <span m='1297470'>node.</span>
  <span m='1298700'>I</span> <span m='1298820'>want</span> <span m='1298970'>to</span>
  <span m='1299060'>also</span> <span m='1299450'>store</span> <span m='1300950'>some</span>
  <span m='1301340'>back</span> <span m='1301640'>pointers.</span> <span m='1302930'>Whenever</span>
  <span m='1303350'>there</span> <span m='1303650'>is</span> <span m='1303890'>a</span>
  <span m='1304010'>node</span> <span m='1306410'>that</span> <span m='1306560'>points</span>
  <span m='1306950'>to</span> <span m='1307040'>this</span> <span m='1307250'>node,</span>
  <span m='1308480'>I</span> <span m='1308600'>want</span> <span m='1308750'>to</span>
  <span m='1308810'>have</span> <span m='1308930'>a</span> <span m='1308990'>back</span>
  <span m='1309260'>pointer</span> <span m='1310370'>that</span> <span m='1310670'>points</span>
  <span m='1311000'>back</span> <span m='1311930'>so</span> <span m='1312050'>I</span>
  <span m='1312140'>know</span> <span m='1312320'>where</span> <span m='1312410'>all</span>
  <span m='1312500'>the</span> <span m='1312620'>pointers</span> <span m='1312920'>came</span>
  <span m='1313160'>from.</span> </p><p><span m='1314210'>If</span> <span m='1314510'>there's</span>
  <span m='1314750'>only</span> <span m='1315130'>p</span> <span m='1315440'>pointers,</span>
  <span m='1317000'>then</span> <span m='1317120'>this</span> <span m='1317270'>is</span>
  <span m='1317390'>fine.</span> <span m='1317600'>There'll</span> <span m='1317750'>be</span>
  <span m='1318680'>p</span> <span m='1318950'>fields</span> <span m='1319430'>here.</span>
  <span m='1320960'>So</span> <span m='1321170'>still</span> <span m='1321350'>constant,</span>
  <span m='1321800'>still</span> <span m='1322040'>in</span> <span m='1322110'>the</span>
  <span m='1322190'>pointier</span> <span m='1322420'>machine</span> <span m='1322720'>model.</span>
  <span m='1324200'>OK,</span> <span m='1324470'>I'm going to</span> <span m='1324590'>need</span>
  <span m='1324790'>some</span> <span m='1324950'>other</span> <span m='1325130'>stuff</span>
  <span m='1325400'>too.</span> </p><p><span m='1328670'>So</span> <span m='1328790'>this</span>
  <span m='1328970'>is</span> <span m='1329060'>a</span> <span m='1329090'>simple</span>
  <span m='1329420'>thing,</span> <span m='1329780'>definitely</span> <span m='1330110'>want</span>
  <span m='1330320'>this.</span> <span m='1331310'>Because</span> <span m='1331910'>if</span>
  <span m='1332120'>my</span> <span m='1332270'>nodes</span> <span m='1332540'>ever</span>
  <span m='1332810'>move</span> <span m='1333020'>around,</span> <span m='1333470'>I've</span>
  <span m='1333590'>got</span> <span m='1333680'>to</span> <span m='1333800'>update</span>
  <span m='1334130'>the</span> <span m='1334220'>pointers</span> <span m='1334580'>to</span>
  <span m='1334700'>them.</span> <span m='1335330'>And</span> <span m='1335510'>where</span>
  <span m='1335690'>are</span> <span m='1335780'>those</span> <span m='1335960'>pointers?</span>
  <span m='1336380'>Well,</span> <span m='1336720'>the back</span> <span m='1337010'>pointers</span>
  <span m='1337310'>tell</span> <span m='1337490'>you</span> <span m='1337580'>where</span>
  <span m='1337700'>they</span> <span m='1337850'>are.</span> <span m='1340030'>Nodes</span>
  <span m='1340310'>will</span> <span m='1340400'>still</span> <span m='1340970'>be</span>
  <span m='1341210'>constant</span> <span m='1341600'>size,</span> <span m='1342410'>remain</span>
  <span m='1342810'>in</span> <span m='1342890'>pointer</span> <span m='1343130'>machine</span>
  <span m='1343450'>data</span> <span m='1343610'>structure.</span> </p><p><span m='1345500'>OK.</span>
  <span m='1346340'>That's</span> <span m='1346580'>idea</span> <span m='1346880'>one.</span>
  <span m='1348230'>Idea</span> <span m='1348530'>two</span> <span m='1350180'>is</span>
  <span m='1353100'>this</span> <span m='1353300'>part.</span> <span m='1355080'>This</span>
  <span m='1355260'>is</span> <span m='1355320'>going</span> <span m='1355470'>to</span>
  <span m='1355530'>store</span> <span m='1355830'>something</span> <span m='1356160'>called</span>
  <span m='1356610'>mods.</span> <span m='1359485'>It</span> <span m='1359910'>could</span>
  <span m='1360340'>stand</span> <span m='1360570'>for</span> <span m='1360690'>something,</span>
  <span m='1361110'>but</span> <span m='1361440'>I'll</span> <span m='1361530'>leave</span>
  <span m='1361710'>it</span> <span m='1361770'>as</span> <span m='1361890'>mods.</span>
  <span m='1364020'>So</span> <span m='1364530'>these</span> <span m='1364860'>are</span>
  <span m='1371810'>two</span> <span m='1372100'>of</span> <span m='1372300'>the</span>
  <span m='1372410'>fields</span> <span m='1374430'>of</span> <span m='1375350'>the</span>
  <span m='1375440'>data</span> <span m='1375660'>structure.</span> </p><p><span m='1376530'>Ah,</span>
  <span m='1376890'>one</span> <span m='1377880'>convenience</span> <span m='1378480'>here</span>
  <span m='1379500'>is</span> <span m='1379740'>for</span> <span m='1379890'>back</span>
  <span m='1380250'>pointers,</span> <span m='1381480'>I'm</span> <span m='1381660'>only</span>
  <span m='1381990'>going</span> <span m='1382230'>to</span> <span m='1382320'>store</span>
  <span m='1382680'>it</span> <span m='1383100'>for</span> <span m='1383550'>the</span>
  <span m='1383670'>latest</span> <span m='1384090'>version</span> <span m='1384420'>of</span>
  <span m='1384540'>the</span> <span m='1384630'>data</span> <span m='1384840'>structure.</span>
  <span m='1396580'>Sorry.</span> <span m='1396810'>I forgot</span> <span m='1397080'>about</span>
  <span m='1397300'>that.</span> <span m='1399610'>We'll</span> <span m='1399760'>come</span>
  <span m='1399940'>back</span> <span m='1400090'>to</span> <span m='1400210'>that</span>
  <span m='1400330'>later.</span> </p><p><span m='1401500'>And</span> <span m='1401680'>then</span>
  <span m='1401860'>the</span> <span m='1402070'>idea</span> <span m='1402220'>is
  to</span> <span m='1402310'>store</span> <span m='1402520'>these</span> <span m='1402640'>modifications.</span>
  <span m='1403480'>How</span> <span m='1403690'>many</span> <span m='1403870'>modifications?</span>
  <span m='1405730'>Let's</span> <span m='1405970'>say</span> <span m='1406390'>up</span>
  <span m='1406630'>to</span> <span m='1407590'>p,</span> <span m='1408850'>twice</span>
  <span m='1409350'>p.</span> <span m='1414835'>p</span> <span m='1415310'>was</span>
  <span m='1415740'>the</span> <span m='1416450'>bound</span> <span m='1416870'>on</span>
  <span m='1417020'>the n</span> <span m='1417290'>degree</span> <span m='1417560'>of</span>
  <span m='1417650'>a</span> <span m='1417980'>node.</span> <span m='1418640'>So</span>
  <span m='1418880'>I'm</span> <span m='1418940'>going</span> <span m='1419060'>to</span>
  <span m='1419180'>allow</span> <span m='1420110'>2p</span> <span m='1421760'>modifications</span>
  <span m='1422510'>over</span> <span m='1422720'>here.</span> <span m='1423870'>And</span>
  <span m='1423890'>what's</span> <span m='1424070'>a</span> <span m='1424130'>modification</span>
  <span m='1424820'>look</span> <span m='1425000'>like?</span> </p><p><span m='1428780'>It's</span>
  <span m='1428990'>going</span> <span m='1429140'>to</span> <span m='1429320'>consist</span>
  <span m='1429740'>of</span> <span m='1429830'>three</span> <span m='1430010'>things--</span>
  <span m='1430770'>get</span> <span m='1430940'>them</span> <span m='1431060'>in</span>
  <span m='1431150'>the</span> <span m='1431210'>right</span> <span m='1431390'>order--</span>
  <span m='1433700'>the</span> <span m='1433820'>version</span> <span m='1434300'>in</span>
  <span m='1434420'>which</span> <span m='1435050'>something</span> <span m='1435360'>was</span>
  <span m='1435500'>changed,</span> <span m='1436850'>the</span> <span m='1436970'>field</span>
  <span m='1438400'>that</span> <span m='1438530'>got</span> <span m='1438710'>changed,</span>
  <span m='1439700'>and</span> <span m='1439820'>the</span> <span m='1439910'>value</span>
  <span m='1440360'>it go</span> <span m='1440510'>changed</span> <span m='1440900'>to.</span>
  <span m='1442830'>So</span> <span m='1443060'>the</span> <span m='1443150'>idea</span>
  <span m='1443480'>is</span> <span m='1443720'>that</span> <span m='1444830'>these</span>
  <span m='1445070'>are</span> <span m='1445130'>the</span> <span m='1445250'>fields</span>
  <span m='1445790'>here.</span> <span m='1447920'>We're</span> <span m='1448070'>not</span>
  <span m='1448280'>going</span> <span m='1448430'>to</span> <span m='1448760'>touch</span>
  <span m='1449030'>those.</span> <span m='1449870'>Once</span> <span m='1450080'>they're</span>
  <span m='1450170'>set</span> <span m='1450410'>to</span> <span m='1450500'>something--</span>
  <span m='1451850'>or, I</span> <span m='1451910'>mean,</span> <span m='1452090'>whatever</span>
  <span m='1452390'>they</span> <span m='1452510'>are</span> <span m='1452570'>initially,</span>
  <span m='1453450'>they</span> <span m='1453470'>will</span> <span m='1453590'>stay</span>
  <span m='1453830'>that</span> <span m='1454010'>way.</span> </p><p><span m='1455370'>And</span>
  <span m='1455390'>so</span> <span m='1455480'>instead</span> <span m='1455870'>of</span>
  <span m='1456200'>actually</span> <span m='1456680'>changing</span> <span m='1457280'>things</span>
  <span m='1458180'>like</span> <span m='1458390'>the</span> <span m='1458510'>data</span>
  <span m='1458690'>structure</span> <span m='1459000'>normally</span> <span m='1459380'>would,</span>
  <span m='1459680'>we're</span> <span m='1459770'>just</span> <span m='1459920'>going</span>
  <span m='1460040'>to</span> <span m='1460130'>add</span> <span m='1460430'>modifications</span>
  <span m='1461180'>here</span> <span m='1461330'>to</span> <span m='1461420'>say,</span>
  <span m='1461630'>oh,</span> <span m='1461810'>well</span> <span m='1462030'>at</span>
  <span m='1462110'>this</span> <span m='1462290'>time,</span> <span m='1462920'>this</span>
  <span m='1463100'>field</span> <span m='1463370'>changed</span> <span m='1463700'>to</span>
  <span m='1463910'>the value of</span> <span m='1464250'>5.</span> <span m='1465410'>And</span>
  <span m='1465590'>then</span> <span m='1465800'>later</span> <span m='1466130'>on,</span>
  <span m='1466520'>it</span> <span m='1466670'>changed</span> <span m='1466970'>to
  the</span> <span m='1467060'>value</span> <span m='1467270'>7.</span> <span m='1467720'>And</span>
  <span m='1467810'>then</span> <span m='1467990'>later</span> <span m='1468290'>on,</span>
  <span m='1468590'>this</span> <span m='1468860'>one</span> <span m='1469070'>changed</span>
  <span m='1469660'>to</span> <span m='1469820'>the</span> <span m='1469880'>value</span>
  <span m='1470180'>23,</span> <span m='1471380'>whatever.</span> <span m='1472320'>So</span>
  <span m='1472400'>that's</span> <span m='1473450'>what</span> <span m='1473570'>they'll</span>
  <span m='1473680'>look</span> <span m='1473870'>like.</span> </p><p><span m='1476330'>There's</span>
  <span m='1476540'>a</span> <span m='1476600'>limit</span> <span m='1476870'>to</span>
  <span m='1476960'>how</span> <span m='1477080'>many--</span> <span m='1477500'>we</span>
  <span m='1477620'>can</span> <span m='1477740'>only</span> <span m='1477920'>store</span>
  <span m='1478130'>a</span> <span m='1478160'>constant</span> <span m='1478550'>number</span>
  <span m='1478820'>of</span> <span m='1478910'>mods</span> <span m='1479360'>to</span>
  <span m='1479780'>each</span> <span m='1480050'>node.</span> <span m='1480920'>And</span>
  <span m='1481160'>our</span> <span m='1481310'>constant</span> <span m='1481730'>will</span>
  <span m='1481850'>be</span> <span m='1482000'>2p.</span> <span m='1484860'>OK.</span>
  <span m='1485080'>Those</span> <span m='1485320'>are</span> <span m='1485380'>the</span>
  <span m='1485470'>ideas,</span> <span m='1485840'>and</span> <span m='1485920'>now</span>
  <span m='1486130'>it's</span> <span m='1486220'>just</span> <span m='1486400'>a</span>
  <span m='1486460'>matter</span> <span m='1486670'>of</span> <span m='1486730'>making</span>
  <span m='1487030'>this</span> <span m='1487180'>all</span> <span m='1487330'>work</span>
  <span m='1487630'>and</span> <span m='1487720'>analyzing</span> <span m='1488350'>that</span>
  <span m='1488500'>it's</span> <span m='1488650'>constant</span> <span m='1489040'>amortized</span>
  <span m='1490030'>overhead.</span> </p><p><span m='1493260'>So</span> <span m='1494300'>first</span>
  <span m='1494630'>thing</span> <span m='1494960'>is</span> <span m='1495440'>if</span>
  <span m='1495680'>you</span> <span m='1495800'>want</span> <span m='1495980'>to</span>
  <span m='1496070'>read</span> <span m='1496940'>a</span> <span m='1497000'>field,</span>
  <span m='1506230'>how would</span> <span m='1506440'>I</span> <span m='1506530'>read</span>
  <span m='1506740'>a</span> <span m='1506800'>field?</span> <span m='1508090'>This</span>
  <span m='1508270'>is</span> <span m='1508360'>really</span> <span m='1508570'>easy.</span>
  <span m='1511720'>First</span> <span m='1511930'>you</span> <span m='1512050'>look</span>
  <span m='1512260'>at</span> <span m='1512410'>what</span> <span m='1512710'>the</span>
  <span m='1512800'>field</span> <span m='1513070'>is</span> <span m='1513310'>in</span>
  <span m='1514690'>the</span> <span m='1514780'>node</span> <span m='1515010'>itself.</span>
  <span m='1515920'>But</span> <span m='1516070'>then</span> <span m='1516220'>it</span>
  <span m='1516280'>might</span> <span m='1516460'>have</span> <span m='1516550'>been</span>
  <span m='1516670'>changed.</span> <span m='1517960'>And</span> <span m='1518050'>so</span>
  <span m='1518170'>remember</span> <span m='1518470'>when</span> <span m='1518650'>I</span>
  <span m='1518710'>say</span> <span m='1518950'>read</span> <span m='1519190'>the</span>
  <span m='1519280'>field,</span> <span m='1519580'>I</span> <span m='1519700'>actually</span>
  <span m='1520030'>mean</span> <span m='1520250'>while</span> <span m='1520350'>I'm</span>
  <span m='1520450'>given</span> <span m='1520780'>some</span> <span m='1520990'>version,</span>
  <span m='1521600'>v,</span> <span m='1522340'>I</span> <span m='1522430'>want</span>
  <span m='1522580'>to</span> <span m='1522640'>know</span> <span m='1522790'>what</span>
  <span m='1523030'>is</span> <span m='1523450'>the</span> <span m='1523570'>value</span>
  <span m='1523900'>of</span> <span m='1523990'>this</span> <span m='1524110'>field</span>
  <span m='1524380'>at version</span> <span m='1524655'>v,</span> <span m='1525160'>because</span>
  <span m='1526450'>I</span> <span m='1526540'>want</span> <span m='1526720'>to</span>
  <span m='1526780'>be</span> <span m='1526840'>able</span> <span m='1526960'>to</span>
  <span m='1527020'>look</span> <span m='1527320'>at</span> <span m='1527530'>any</span>
  <span m='1527710'>of</span> <span m='1527770'>the</span> <span m='1527860'>old</span>
  <span m='1528040'>data</span> <span m='1528280'>structures</span> <span m='1528700'>too.</span>
  </p><p><span m='1529630'>So</span> <span m='1529780'>this</span> <span m='1529960'>would</span>
  <span m='1530030'>be</span> <span m='1531190'>at</span> <span m='1532870'>version</span>
  <span m='1534530'>v.</span> <span m='1537070'>I</span> <span m='1537190'>just</span>
  <span m='1537370'>look</span> <span m='1537610'>through</span> <span m='1537880'>all</span>
  <span m='1538090'>the</span> <span m='1538210'>modifications.</span> <span m='1538840'>There's</span>
  <span m='1538990'>constantly</span> <span m='1539560'>many,</span> <span m='1539830'>so</span>
  <span m='1540010'>it takes</span> <span m='1540160'>constant</span> <span m='1540540'>time</span>
  <span m='1540810'>to</span> <span m='1540880'>just</span> <span m='1541030'>flip</span>
  <span m='1541270'>through</span> <span m='1541450'>them</span> <span m='1541600'>and</span>
  <span m='1541690'>say,</span> <span m='1542510'>well,</span> <span m='1542770'>what</span>
  <span m='1543220'>changes</span> <span m='1543730'>have</span> <span m='1543910'>happened</span>
  <span m='1544540'>up</span> <span m='1544750'>to</span> <span m='1544930'>version</span>
  <span m='1545320'>v?</span> <span m='1546160'>So</span> <span m='1546670'>I</span>
  <span m='1546880'>look</span> <span m='1547240'>at</span> <span m='1549470'>mods</span>
  <span m='1552460'>with</span> <span m='1554050'>version</span> <span m='1556240'>less</span>
  <span m='1556570'>than</span> <span m='1556750'>or</span> <span m='1556840'>equal</span>
  <span m='1557140'>to</span> <span m='1557290'>v.</span> <span m='1557680'>That</span>
  <span m='1557830'>will</span> <span m='1557950'>be</span> <span m='1558100'>all</span>
  <span m='1558220'>the</span> <span m='1558340'>changes</span> <span m='1558730'>that</span>
  <span m='1558850'>happened</span> <span m='1559300'>up</span> <span m='1559450'>to</span>
  <span m='1559570'>this</span> <span m='1559750'>point.</span> </p><p><span m='1560770'>I</span>
  <span m='1560860'>see,</span> <span m='1561010'>did</span> <span m='1561190'>this</span>
  <span m='1561340'>field</span> <span m='1561610'>change?</span> <span m='1562060'>I</span>
  <span m='1562120'>look</span> <span m='1562300'>at</span> <span m='1562390'>the</span>
  <span m='1562540'>latest</span> <span m='1562960'>one.</span> <span m='1563710'>That</span>
  <span m='1563890'>will</span> <span m='1564010'>be</span> <span m='1564340'>how
  I</span> <span m='1564550'>read</span> <span m='1565480'>the</span> <span m='1565720'>field</span>
  <span m='1566500'>of</span> <span m='1566650'>the</span> <span m='1566740'>node,</span>
  <span m='1567070'>so</span> <span m='1567250'>constant</span> <span m='1567565'>time.</span>
  <span m='1568690'>There's</span> <span m='1568900'>lots</span> <span m='1569170'>of</span>
  <span m='1569260'>ways</span> <span m='1569410'>to</span> <span m='1569500'>make</span>
  <span m='1569680'>this</span> <span m='1569890'>efficient</span> <span m='1570280'>in</span>
  <span m='1570370'>practice.</span> <span m='1570850'>But</span> <span m='1572230'>for</span>
  <span m='1572380'>our</span> <span m='1572470'>purposes,</span> <span m='1573050'>it</span>
  <span m='1573150'>doesn't</span> <span m='1573190'>matter.</span> <span m='1573730'>It's</span>
  <span m='1573880'>constant.</span> </p><p><span m='1576010'>The</span> <span m='1576100'>hard</span>
  <span m='1576280'>part</span> <span m='1576460'>is</span> <span m='1576550'>how</span>
  <span m='1576640'>do</span> <span m='1576730'>you</span> <span m='1576820'>change</span>
  <span m='1577100'>a</span> <span m='1577180'>field?</span> <span m='1578890'>Because</span>
  <span m='1579460'>there</span> <span m='1579610'>might</span> <span m='1579730'>not</span>
  <span m='1579910'>be</span> <span m='1579970'>any</span> <span m='1580150'>room</span>
  <span m='1580450'>in</span> <span m='1580570'>the</span> <span m='1580810'>mod</span>
  <span m='1581490'>structure.</span> <span m='1595850'>So</span> <span m='1596370'>to</span>
  <span m='1596530'>modify,</span> <span m='1599450'>say</span> <span m='1599680'>we</span>
  <span m='1599800'>want</span> <span m='1599950'>to</span> <span m='1600010'>set</span>
  <span m='1600310'>node.field</span> <span m='1603730'>equal</span> <span m='1604030'>to</span>
  <span m='1604240'>x.</span> <span m='1607240'>What</span> <span m='1607390'>we</span>
  <span m='1607540'>do</span> <span m='1608590'>is</span> <span m='1611750'>first</span>
  <span m='1612050'>we</span> <span m='1612170'>check,</span> <span m='1612440'>is</span>
  <span m='1612620'>there</span> <span m='1612740'>any</span> <span m='1613010'>space</span>
  <span m='1613490'>in</span> <span m='1613610'>the</span> <span m='1613700'>mod</span>
  <span m='1613910'>structure?</span> <span m='1614270'>If</span> <span m='1614360'>there's</span>
  <span m='1614510'>any</span> <span m='1614690'>blank</span> <span m='1615250'>mods,</span>
  <span m='1616550'>so</span> <span m='1616730'>if</span> <span m='1617180'>the</span>
  <span m='1617480'>node</span> <span m='1618890'>is</span> <span m='1619100'>not</span>
  <span m='1619520'>full,</span> <span m='1623080'>we</span> <span m='1623210'>just</span>
  <span m='1623420'>add</span> <span m='1623780'>a</span> <span m='1624230'>mod.</span>
  <span m='1626630'>So a mod</span> <span m='1626990'>will</span> <span m='1627110'>look</span>
  <span m='1627350'>like</span> <span m='1628100'>now</span> <span m='1629800'>field</span>
  <span m='1631930'>x.</span> </p><p><span m='1633106'>Just</span> <span m='1633500'>throw</span>
  <span m='1633830'>that</span> <span m='1634010'>in</span> <span m='1634130'>there.</span>
  <span m='1635810'>Because</span> <span m='1636200'>right</span> <span m='1636470'>at</span>
  <span m='1636560'>this</span> <span m='1636710'>moment--</span> <span m='1637650'>so</span>
  <span m='1637730'>we</span> <span m='1637880'>maintain</span> <span m='1638240'>a</span>
  <span m='1638300'>time</span> <span m='1638540'>counter,</span> <span m='1638990'>just</span>
  <span m='1639170'>increment</span> <span m='1639560'>it ever</span> <span m='1639740'>time</span>
  <span m='1639950'>we</span> <span m='1640010'>do</span> <span m='1640130'>a</span>
  <span m='1640160'>change.</span> <span m='1641930'>This</span> <span m='1642110'>field</span>
  <span m='1642350'>changed</span> <span m='1642650'>that</span> <span m='1642800'>value.</span>
  <span m='1643320'>So</span> <span m='1643370'>that's</span> <span m='1643520'>the</span>
  <span m='1643580'>easy</span> <span m='1643850'>case.</span> <span m='1644540'>The</span>
  <span m='1644630'>trouble,</span> <span m='1645000'>of</span> <span m='1645100'>course,</span>
  <span m='1645450'>is</span> <span m='1645770'>if</span> <span m='1646130'>the</span>
  <span m='1646460'>node</span> <span m='1646880'>is</span> <span m='1647150'>full--</span>
  <span m='1649340'>the</span> <span m='1649400'>moment</span> <span m='1649670'>you've</span>
  <span m='1649820'>all</span> <span m='1649940'>been</span> <span m='1650090'>waiting</span>
  <span m='1650330'>for.</span> </p><p><span m='1651300'>So</span> <span m='1651530'>what</span>
  <span m='1651680'>we're</span> <span m='1651770'>going</span> <span m='1651900'>to</span>
  <span m='1651980'>do</span> <span m='1652160'>here</span> <span m='1652370'>is</span>
  <span m='1652490'>make</span> <span m='1652700'>a</span> <span m='1652760'>new</span>
  <span m='1652910'>node.</span> <span m='1653150'>We've</span> <span m='1653300'>ran</span>
  <span m='1653510'>out</span> <span m='1653630'>of</span> <span m='1653690'>space.</span>
  <span m='1654690'>So</span> <span m='1654790'>we</span> <span m='1654800'>need</span>
  <span m='1654950'>to</span> <span m='1655190'>make</span> <span m='1655460'>a</span>
  <span m='1655520'>new</span> <span m='1655700'>node.</span> <span m='1656450'>We're</span>
  <span m='1656540'>not</span> <span m='1656660'>going</span> <span m='1656840'>to</span>
  <span m='1656900'>touch</span> <span m='1657110'>the</span> <span m='1657220'>old</span>
  <span m='1657360'>node,</span> <span m='1657560'>just</span> <span m='1657710'>going</span>
  <span m='1657860'>to</span> <span m='1657920'>let</span> <span m='1658070'>it</span>
  <span m='1658160'>sit.</span> <span m='1658730'>It</span> <span m='1658890'>still</span>
  <span m='1659120'>maintains</span> <span m='1659540'>all</span> <span m='1659660'>those</span>
  <span m='1659840'>old</span> <span m='1660050'>versions.</span> <span m='1660530'>Now</span>
  <span m='1660710'>we</span> <span m='1660800'>want</span> <span m='1660950'>a</span>
  <span m='1661000'>new</span> <span m='1661150'>node</span> <span m='1661430'>that</span>
  <span m='1661520'>represents</span> <span m='1662810'>the</span> <span m='1662900'>latest</span>
  <span m='1663230'>and</span> <span m='1663320'>greatest</span> <span m='1663710'>of</span>
  <span m='1663800'>this</span> <span m='1663980'>node.</span> <span m='1664970'>OK.</span>
  </p><p><span m='1665490'>So</span> <span m='1666680'>make</span> <span m='1667010'>a</span>
  <span m='1667070'>new</span> <span m='1667250'>node.</span> <span m='1671420'>I'll</span>
  <span m='1671510'>call</span> <span m='1671750'>it</span> <span m='1671840'>node</span>
  <span m='1672160'>prime</span> <span m='1672740'>to</span> <span m='1673120'>distinguish</span>
  <span m='1673640'>from</span> <span m='1673820'>node,</span> <span m='1675710'>where</span>
  <span m='1677060'>with</span> <span m='1678350'>all</span> <span m='1679010'>the</span>
  <span m='1679930'>mods,</span> <span m='1682460'>and</span> <span m='1682670'>this</span>
  <span m='1683300'>modification</span> <span m='1683900'>in</span> <span m='1683990'>particular,</span>
  <span m='1684920'>applied.</span> </p><p><span m='1687770'>OK,</span> <span m='1688130'>so
  we</span> <span m='1688250'>make</span> <span m='1688460'>a</span> <span m='1688550'>new</span>
  <span m='1688820'>version</span> <span m='1690080'>of</span> <span m='1690200'>this</span>
  <span m='1690410'>node.</span> <span m='1691160'>It's</span> <span m='1691280'>going</span>
  <span m='1691430'>to</span> <span m='1691490'>have</span> <span m='1691970'>some</span>
  <span m='1692450'>different</span> <span m='1692900'>fields,</span> <span m='1694970'>whatever</span>
  <span m='1695370'>was</span> <span m='1695540'>the</span> <span m='1695660'>latest</span>
  <span m='1696440'>version</span> <span m='1696950'>represented</span> <span m='1697460'>by</span>
  <span m='1697610'>those</span> <span m='1697790'>mods.</span> <span m='1698730'>It's</span>
  <span m='1699350'>still</span> <span m='1699650'>going</span> <span m='1699770'>to</span>
  <span m='1699830'>have</span> <span m='1699950'>back</span> <span m='1700220'>pointers,</span>
  <span m='1700525'>so</span> <span m='1701300'>we</span> <span m='1701570'>have</span>
  <span m='1701690'>to</span> <span m='1701810'>maintain</span> <span m='1702530'>all</span>
  <span m='1702740'>those</span> <span m='1702950'>back</span> <span m='1703170'>pointers.</span>
  </p><p><span m='1704810'>And</span> <span m='1704930'>now</span> <span m='1705110'>the</span>
  <span m='1705200'>mod,</span> <span m='1705620'>initially,</span> <span m='1706070'>is</span>
  <span m='1706160'>going</span> <span m='1706400'>to</span> <span m='1706490'>be</span>
  <span m='1706640'>empty,</span> <span m='1707750'>because</span> <span m='1708050'>we</span>
  <span m='1708290'>just</span> <span m='1708500'>applied</span> <span m='1708820'>them</span>
  <span m='1708950'>all.</span> <span m='1709340'>So</span> <span m='1709490'>this</span>
  <span m='1709670'>new</span> <span m='1709820'>node</span> <span m='1710030'>doesn't</span>
  <span m='1710300'>have</span> <span m='1710540'>any</span> <span m='1711050'>recent</span>
  <span m='1711410'>mods.</span> <span m='1712460'>Old</span> <span m='1712670'>node</span>
  <span m='1712880'>represents</span> <span m='1713270'>the</span> <span m='1713330'>old</span>
  <span m='1713480'>versions.</span> <span m='1714320'>This</span> <span m='1714610'>node</span>
  <span m='1714860'>is</span> <span m='1715010'>going to</span> <span m='1715070'>represent</span>
  <span m='1715580'>the</span> <span m='1715670'>new</span> <span m='1715790'>versions.</span>
  <span m='1717935'>What's</span> <span m='1718040'>wrong</span> <span m='1718250'>with</span>
  <span m='1718370'>this</span> <span m='1718520'>picture?</span> </p><p><span m='1719420'>AUDIENCE:</span>
  <span m='1719645'>Update</span> <span m='1719870'>pointers.</span> </p><p><span
  m='1720770'>ERIK DEMAINE:</span> <span m='1720935'>Update</span> <span m='1721100'>pointers.</span>
  <span m='1722120'>Yeah,</span> <span m='1722330'>there's</span> <span m='1722900'>pointers</span>
  <span m='1723260'>to</span> <span m='1723320'>the</span> <span m='1723440'>old</span>
  <span m='1723590'>version</span> <span m='1723890'>of</span> <span m='1723950'>the</span>
  <span m='1724040'>node,</span> <span m='1724910'>which</span> <span m='1725210'>are</span>
  <span m='1725360'>fine</span> <span m='1725900'>for</span> <span m='1726170'>the</span>
  <span m='1726470'>old</span> <span m='1726770'>versions</span> <span m='1727220'>of</span>
  <span m='1727310'>the</span> <span m='1727400'>data</span> <span m='1727580'>structure.</span>
  <span m='1728510'>But</span> <span m='1728690'>for</span> <span m='1728870'>the</span>
  <span m='1728960'>latest</span> <span m='1729290'>version</span> <span m='1729530'>of</span>
  <span m='1729590'>the</span> <span m='1729650'>data</span> <span m='1729890'>structure,</span>
  <span m='1730300'>this</span> <span m='1730820'>node</span> <span m='1731030'>has</span>
  <span m='1731210'>moved</span> <span m='1731750'>to</span> <span m='1731900'>this</span>
  <span m='1732050'>new</span> <span m='1732200'>location.</span> </p><p><span m='1733560'>So</span>
  <span m='1733670'>if</span> <span m='1733760'>there</span> <span m='1733910'>are</span>
  <span m='1734060'>any</span> <span m='1734300'>old</span> <span m='1734510'>pointers</span>
  <span m='1735170'>to</span> <span m='1735410'>that</span> <span m='1735680'>node,</span>
  <span m='1736070'>we've</span> <span m='1736190'>got</span> <span m='1736340'>to</span>
  <span m='1736520'>update</span> <span m='1736910'>them</span> <span m='1737060'>in</span>
  <span m='1737180'>the</span> <span m='1737270'>current</span> <span m='1737660'>version.</span>
  <span m='1738440'>We</span> <span m='1738530'>have</span> <span m='1738620'>to</span>
  <span m='1738710'>update</span> <span m='1739070'>them</span> <span m='1739190'>to</span>
  <span m='1739280'>point</span> <span m='1739460'>to</span> <span m='1739550'>this</span>
  <span m='1739730'>node</span> <span m='1739930'>instead.</span> <span m='1740270'>The</span>
  <span m='1740390'>old</span> <span m='1740480'>versions</span> <span m='1740810'>are</span>
  <span m='1740900'>fine,</span> <span m='1741830'>but the</span> <span m='1741950'>new</span>
  <span m='1742100'>version</span> <span m='1742580'>is</span> <span m='1742760'>in</span>
  <span m='1742850'>trouble.</span> <span m='1744060'>Other</span> <span m='1744170'>questions</span>
  <span m='1744790'>or</span> <span m='1745270'>all</span> <span m='1745400'>the</span>
  <span m='1745490'>same</span> <span m='1745670'>answer?</span> <span m='1746120'>Yeah.</span>
  </p><p><span m='1746791'>AUDIENCE:</span> <span m='1747036'>So</span> <span m='1748264'>if</span>
  <span m='1748755'>you wanted to</span> <span m='1749246'>read</span> <span m='1749737'>an
  old</span> <span m='1750228'>version</span> <span m='1750719'>but you just have</span>
  <span m='1751210'>the new</span> <span m='1751701'>version,</span> <span m='1753174'>[INAUDIBLE]?</span>
  </p><p><span m='1755630'>ERIK DEMAINE:</span> <span m='1755780'>OK--</span> </p><p><span
  m='1756590'>AUDIENCE:</span> <span m='1756800'>[INAUDIBLE]</span> </p><p><span m='1757430'>ERIK
  DEMAINE:</span> <span m='1757610'>The question</span> <span m='1757790'>is</span>
  <span m='1757880'>essentially,</span> <span m='1758330'>how</span> <span m='1758570'>do</span>
  <span m='1758690'>we</span> <span m='1759170'>hold</span> <span m='1759470'>on</span>
  <span m='1759670'>to</span> <span m='1759770'>versions?</span> <span m='1762290'>Essentially,</span>
  <span m='1762680'>you</span> <span m='1762770'>can</span> <span m='1762890'>think</span>
  <span m='1763100'>of</span> <span m='1763220'>a</span> <span m='1763310'>version</span>
  <span m='1763790'>of</span> <span m='1763880'>the</span> <span m='1763970'>data</span>
  <span m='1764180'>structure</span> <span m='1764600'>as</span> <span m='1764990'>where</span>
  <span m='1765290'>the</span> <span m='1765470'>root</span> <span m='1765770'>node</span>
  <span m='1766010'>is.</span> <span m='1766640'>That's</span> <span m='1766760'>probably</span>
  <span m='1767030'>the</span> <span m='1767090'>easiest.</span> <span m='1767570'>I</span>
  <span m='1767630'>mean,</span> <span m='1767730'>in</span> <span m='1767780'>general,</span>
  <span m='1768080'>we're</span> <span m='1768200'>representing</span> <span m='1768590'>versions</span>
  <span m='1768950'>by</span> <span m='1769160'>a</span> <span m='1769220'>number,</span>
  <span m='1769620'>v.</span> <span m='1770810'>But</span> <span m='1770990'>we</span>
  <span m='1771140'>always</span> <span m='1771320'>start</span> <span m='1771710'>at</span>
  <span m='1771890'>the</span> <span m='1772010'>root.</span> </p><p><span m='1773120'>And</span>
  <span m='1773330'>so</span> <span m='1774240'>you've</span> <span m='1774410'>given</span>
  <span m='1774680'>the</span> <span m='1774770'>data</span> <span m='1774980'>structure,</span>
  <span m='1775440'>which</span> <span m='1775490'>is</span> <span m='1775580'>represented</span>
  <span m='1776000'>by</span> <span m='1776120'>the</span> <span m='1776240'>root</span>
  <span m='1776390'>node.</span> <span m='1776660'>And</span> <span m='1776750'>you</span>
  <span m='1776810'>say,</span> <span m='1778370'>search</span> <span m='1778820'>for</span>
  <span m='1779150'>the</span> <span m='1779240'>value</span> <span m='1779570'>5.</span>
  <span m='1780020'>Is</span> <span m='1780170'>it</span> <span m='1780260'>in</span>
  <span m='1780410'>this</span> <span m='1781280'>binary</span> <span m='1781580'>search</span>
  <span m='1781850'>tree</span> <span m='1782030'>or</span> <span m='1782090'>whatever?</span>
  <span m='1783410'>And</span> <span m='1783530'>then</span> <span m='1783650'>you</span>
  <span m='1783740'>just</span> <span m='1783860'>start</span> <span m='1784070'>navigating</span>
  <span m='1784610'>from</span> <span m='1784820'>the</span> <span m='1784940'>root,</span>
  <span m='1785330'>but</span> <span m='1785450'>you</span> <span m='1785570'>know</span>
  <span m='1785990'>I'm</span> <span m='1786230'>inversion</span> <span m='1787010'>a</span>
  <span m='1787070'>million</span> <span m='1787490'>or</span> <span m='1787580'>whatever.</span>
  <span m='1789560'>I</span> <span m='1789650'>know</span> <span m='1789800'>what</span>
  <span m='1789920'>version</span> <span m='1790160'>I'm</span> <span m='1790220'>looking</span>
  <span m='1790490'>for.</span> <span m='1791340'>So</span> <span m='1791440'>you</span>
  <span m='1791540'>start</span> <span m='1791720'>with</span> <span m='1791900'>the</span>
  <span m='1791990'>root,</span> <span m='1792240'>which</span> <span m='1793520'>never</span>
  <span m='1793790'>changes,</span> <span m='1794260'>let's</span> <span m='1794430'>say.</span>
  </p><p><span m='1796040'>And</span> <span m='1796190'>then</span> <span m='1796400'>you</span>
  <span m='1796550'>follow</span> <span m='1797480'>pointers</span> <span m='1797960'>that</span>
  <span m='1798320'>essentially</span> <span m='1798770'>tell</span> <span m='1798980'>you</span>
  <span m='1799370'>for</span> <span m='1799580'>that</span> <span m='1799730'>version</span>
  <span m='1800060'>where</span> <span m='1800240'>you</span> <span m='1800330'>should</span>
  <span m='1800480'>be</span> <span m='1800570'>going.</span> <span m='1801380'>I</span>
  <span m='1801410'>guess</span> <span m='1801590'>at</span> <span m='1801680'>the
  root</span> <span m='1801800'>version,</span> <span m='1802220'>it's</span> <span
  m='1802370'>a</span> <span m='1802430'>little</span> <span m='1802640'>trickier.</span>
  <span m='1803780'>You</span> <span m='1803930'>probably</span> <span m='1804500'>want</span>
  <span m='1806000'>a</span> <span m='1806030'>little</span> <span m='1806300'>array</span>
  <span m='1806690'>that</span> <span m='1806810'>says</span> <span m='1807080'>for</span>
  <span m='1807200'>this</span> <span m='1807380'>version,</span> <span m='1807710'>here's</span>
  <span m='1807950'>the</span> <span m='1808100'>root</span> <span m='1808260'>node.</span>
  <span m='1808900'>But</span> <span m='1809030'>that's</span> <span m='1809480'>a</span>
  <span m='1809510'>special</span> <span m='1809870'>case.</span> <span m='1811130'>Yeah.</span>
  <span m='1811670'>Another</span> <span m='1811850'>question?</span> </p><p><span
  m='1813234'>AUDIENCE:</span> <span m='1813482'>So</span> <span m='1813731'>on the
  new</span> <span m='1814228'>node that</span> <span m='1814725'>you</span> <span
  m='1815222'>created,</span> <span m='1816216'>the</span> <span m='1816713'>fields
  that</span> <span m='1817210'>you</span> <span m='1817707'>copied,</span> <span
  m='1818204'>you</span> <span m='1818701'>also</span> <span m='1819198'>have to have</span>
  <span m='1819695'>a version for</span> <span m='1820192'>them, right?</span> <span
  m='1820689'>Because</span> <span m='1821186'>[INAUDIBLE]?</span> </p><p><span m='1826670'>ERIK
  DEMAINE:</span> <span m='1826812'>These--</span> </p><p><span m='1827731'>AUDIENCE:</span>
  <span m='1827976'>Or</span> <span m='1828222'>do you version the</span> <span m='1828713'>whole
  node?</span> </p><p><span m='1830190'>ERIK DEMAINE:</span> <span m='1830310'>Here</span>
  <span m='1830430'>we're</span> <span m='1830580'>versioning</span> <span m='1831060'>the</span>
  <span m='1831180'>whole</span> <span m='1831450'>node.</span> <span m='1832650'>The</span>
  <span m='1832980'>original</span> <span m='1833400'>field</span> <span m='1833640'>values</span>
  <span m='1834060'>represent</span> <span m='1834600'>what</span> <span m='1834780'>was</span>
  <span m='1834900'>originally</span> <span m='1835320'>there,</span> <span m='1836220'>whenever</span>
  <span m='1836520'>this</span> <span m='1836700'>node</span> <span m='1836880'>was</span>
  <span m='1837000'>created.</span> <span m='1837940'>Then</span> <span m='1837960'>the</span>
  <span m='1838080'>mods</span> <span m='1838390'>specify</span> <span m='1838770'>what</span>
  <span m='1838920'>time</span> <span m='1839280'>the</span> <span m='1839400'>fields</span>
  <span m='1839730'>change.</span> <span m='1840250'>So</span> <span m='1840460'>I</span>
  <span m='1840640'>don't</span> <span m='1840810'>think</span> <span m='1840960'>we</span>
  <span m='1841050'>need</span> <span m='1841200'>times</span> <span m='1841650'>here.</span>
  <span m='1844200'>All</span> <span m='1844260'>right.</span> </p><p><span m='1845330'>So</span>
  <span m='1845420'>we've</span> <span m='1845510'>got</span> <span m='1845630'>to</span>
  <span m='1845720'>update</span> <span m='1846260'>two</span> <span m='1846440'>kinds</span>
  <span m='1846680'>of</span> <span m='1846770'>pointers.</span> <span m='1847200'>There's</span>
  <span m='1847790'>regular</span> <span m='1848210'>pointers,</span> <span m='1848510'>which</span>
  <span m='1848660'>live</span> <span m='1848810'>in</span> <span m='1848900'>the</span>
  <span m='1848990'>fields,</span> <span m='1849980'>which</span> <span m='1850130'>are</span>
  <span m='1850610'>things</span> <span m='1850880'>pointing</span> <span m='1851240'>to</span>
  <span m='1851360'>the</span> <span m='1851450'>node.</span> <span m='1852230'>But</span>
  <span m='1852350'>then</span> <span m='1852470'>there's</span> <span m='1852620'>also</span>
  <span m='1852860'>back</span> <span m='1853160'>pointers.</span> <span m='1853640'>Because</span>
  <span m='1854330'>if</span> <span m='1854480'>this</span> <span m='1854690'>is</span>
  <span m='1854780'>a</span> <span m='1854840'>pointer</span> <span m='1855230'>to</span>
  <span m='1855440'>a</span> <span m='1855500'>node,</span> <span m='1856250'>then</span>
  <span m='1856400'>there'll</span> <span m='1856550'>be</span> <span m='1856610'>a</span>
  <span m='1856670'>back</span> <span m='1856910'>pointer</span> <span m='1857270'>back</span>
  <span m='1857510'>to</span> <span m='1857600'>the</span> <span m='1857720'>node.</span>
  <span m='1857950'>And</span> <span m='1858140'>all</span> <span m='1858350'>of</span>
  <span m='1858410'>those</span> <span m='1858620'>have</span> <span m='1858770'>to</span>
  <span m='1858860'>change.</span> </p><p><span m='1860620'>Conveniently,</span> <span
  m='1862020'>the</span> <span m='1862350'>back</span> <span m='1862670'>pointers</span>
  <span m='1863150'>are</span> <span m='1863480'>easy.</span> <span m='1871700'>So</span>
  <span m='1871850'>if</span> <span m='1871910'>they're</span> <span m='1872060'>back</span>
  <span m='1872280'>pointers</span> <span m='1872600'>to</span> <span m='1872720'>the</span>
  <span m='1872840'>node,</span> <span m='1873740'>we</span> <span m='1873830'>change</span>
  <span m='1874130'>them</span> <span m='1874240'>to</span> <span m='1874340'>the</span>
  <span m='1874430'>node</span> <span m='1874620'>prime.</span> <span m='1874910'>How</span>
  <span m='1875030'>do</span> <span m='1875120'>we</span> <span m='1875210'>find</span>
  <span m='1875450'>the</span> <span m='1875540'>back</span> <span m='1875750'>pointers?</span>
  <span m='1876080'>Well,</span> <span m='1876170'>we</span> <span m='1876260'>just</span>
  <span m='1876410'>follow</span> <span m='1876710'>all</span> <span m='1876830'>the</span>
  <span m='1876920'>pointers</span> <span m='1877490'>and</span> <span m='1877580'>then</span>
  <span m='1878240'>there</span> <span m='1878360'>will</span> <span m='1878480'>be</span>
  <span m='1878600'>back</span> <span m='1878810'>pointers</span> <span m='1879140'>there.</span>
  </p><p><span m='1881330'>Because</span> <span m='1881810'>I</span> <span m='1881900'>said</span>
  <span m='1882240'>we're</span> <span m='1882290'>only</span> <span m='1882590'>maintaining</span>
  <span m='1883040'>backed</span> <span m='1883280'>pointers</span> <span m='1883670'>for</span>
  <span m='1883910'>the</span> <span m='1884030'>latest</span> <span m='1884570'>version,</span>
  <span m='1885650'>I</span> <span m='1885740'>don't</span> <span m='1885980'>need</span>
  <span m='1886160'>to</span> <span m='1887690'>preserve</span> <span m='1888030'>the</span>
  <span m='1888140'>old</span> <span m='1888290'>versions</span> <span m='1888620'>of</span>
  <span m='1888710'>those</span> <span m='1888860'>backed</span> <span m='1889080'>pointers.</span>
  <span m='1889340'>So</span> <span m='1889460'>I</span> <span m='1889520'>just</span>
  <span m='1889700'>go</span> <span m='1889910'>in</span> <span m='1890060'>and</span>
  <span m='1890180'>I</span> <span m='1890360'>change</span> <span m='1890690'>them.</span>
  <span m='1891520'>It</span> <span m='1891590'>takes</span> <span m='1891830'>constant</span>
  <span m='1892220'>time,</span> <span m='1892430'>because</span> <span m='1892580'>the</span>
  <span m='1892670'>constant</span> <span m='1892970'>number</span> <span m='1893150'>of</span>
  <span m='1893210'>things</span> <span m='1893400'>I</span> <span m='1893480'>point</span>
  <span m='1893750'>to,</span> <span m='1894350'>each</span> <span m='1894470'>one</span>
  <span m='1894590'>as</span> <span m='1894680'>a</span> <span m='1894740'>back</span>
  <span m='1894950'>pointer.</span> <span m='1895700'>So</span> <span m='1895790'>this</span>
  <span m='1895970'>is</span> <span m='1896780'>cheap.</span> <span m='1897130'>There's</span>
  <span m='1897170'>no</span> <span m='1897320'>persistence</span> <span m='1897860'>here.</span>
  <span m='1899210'>That's</span> <span m='1899930'>an</span> <span m='1900050'>advantage</span>
  <span m='1900440'>of</span> <span m='1900500'>partial</span> <span m='1900800'>persistence.</span>
  </p><p><span m='1901940'>The</span> <span m='1902060'>hard</span> <span m='1902240'>part</span>
  <span m='1902660'>is</span> <span m='1902960'>updating</span> <span m='1903770'>the</span>
  <span m='1903860'>pointers</span> <span m='1904370'>because</span> <span m='1904640'>those</span>
  <span m='1904820'>live</span> <span m='1904970'>in</span> <span m='1905060'>fields.</span>
  <span m='1905990'>I</span> <span m='1906080'>need</span> <span m='1906230'>to</span>
  <span m='1906320'>remember</span> <span m='1906620'>the</span> <span m='1906710'>old</span>
  <span m='1906860'>versions</span> <span m='1907220'>of</span> <span m='1907280'>those</span>
  <span m='1907490'>fields.</span> <span m='1907850'>And</span> <span m='1908000'>that</span>
  <span m='1908150'>we</span> <span m='1908270'>do</span> <span m='1908450'>recursively.</span>
  </p><p><span m='1918770'>Because</span> <span m='1919220'>to</span> <span m='1919340'>change</span>
  <span m='1919610'>those</span> <span m='1919760'>pointers,</span> <span m='1920120'>that's</span>
  <span m='1920360'>a</span> <span m='1920420'>field</span> <span m='1920720'>update.</span>
  <span m='1921170'>That's</span> <span m='1921470'>something</span> <span m='1921830'>exactly</span>
  <span m='1922280'>of</span> <span m='1922370'>this</span> <span m='1922520'>form.</span>
  <span m='1922940'>So</span> <span m='1923210'>that's</span> <span m='1923450'>the</span>
  <span m='1923540'>same</span> <span m='1923810'>operation</span> <span m='1924350'>but</span>
  <span m='1924500'>on</span> <span m='1924620'>a</span> <span m='1924680'>different</span>
  <span m='1924950'>node.</span> <span m='1925970'>So</span> <span m='1926060'>I</span>
  <span m='1926120'>just</span> <span m='1926270'>do</span> <span m='1926420'>that.</span>
  <span m='1927440'>I</span> <span m='1927530'>claim</span> <span m='1927770'>this</span>
  <span m='1927920'>is</span> <span m='1928040'>good.</span> <span m='1928760'>That's</span>
  <span m='1928910'>the</span> <span m='1929030'>end</span> <span m='1929180'>of</span>
  <span m='1929300'>the</span> <span m='1930080'>algorithm.</span> <span m='1931400'>Now</span>
  <span m='1931670'>we</span> <span m='1931760'>need</span> <span m='1931910'>to</span>
  <span m='1932030'>analyze</span> <span m='1932450'>it.</span> </p><p><span m='1944950'>How</span>
  <span m='1945070'>do</span> <span m='1945160'>we</span> <span m='1945280'>analyze</span>
  <span m='1945640'>it?</span> <span m='1945760'>Any</span> <span m='1945970'>guesses?</span>
  </p><p><span m='1949498'>AUDIENCE:</span> <span m='1949747'>Amortize it.</span>
  </p><p><span m='1950500'>ERIK DEMAINE:</span> <span m='1950627'>Amortized</span>
  <span m='1951010'>analysis,</span> <span m='1951610'>exactly</span> <span m='1952060'>the</span>
  <span m='1952180'>answer</span> <span m='1952390'>I</span> <span m='1952420'>was</span>
  <span m='1952510'>looking</span> <span m='1952780'>for.</span> <span m='1953620'>OK.</span>
  <span m='1954580'>[INAUDIBLE]</span> <span m='1954940'>amortization.</span> <span
  m='1956290'>The</span> <span m='1956380'>most</span> <span m='1956740'>powerful</span>
  <span m='1957250'>technique</span> <span m='1957600'>in</span> <span m='1957670'>amortization</span>
  <span m='1958330'>is</span> <span m='1958420'>probably</span> <span m='1958900'>the</span>
  <span m='1959020'>potential</span> <span m='1959470'>method.</span> <span m='1960460'>So</span>
  <span m='1960730'>we're</span> <span m='1960820'>going</span> <span m='1960940'>to</span>
  <span m='1961000'>use</span> <span m='1961150'>that.</span> <span m='1962370'>There's</span>
  <span m='1962590'>a</span> <span m='1962920'>sort</span> <span m='1963190'>of</span>
  <span m='1963340'>more--</span> <span m='1964360'>you'll</span> <span m='1964540'>see</span>
  <span m='1964720'>a</span> <span m='1964780'>charging</span> <span m='1965650'>argument</span>
  <span m='1967450'>in</span> <span m='1967570'>a</span> <span m='1967630'>moment.</span>
  </p><p><span m='1971000'>We</span> <span m='1971170'>want</span> <span m='1971380'>the</span>
  <span m='1971470'>potential</span> <span m='1971860'>function</span> <span m='1972190'>to</span>
  <span m='1972250'>represent</span> <span m='1972700'>when</span> <span m='1972940'>this</span>
  <span m='1973120'>data</span> <span m='1973330'>structure</span> <span m='1973750'>is</span>
  <span m='1973960'>in</span> <span m='1974110'>a</span> <span m='1974140'>bad</span>
  <span m='1974470'>state.</span> <span m='1975300'>Intuitively,</span> <span m='1975820'>it's</span>
  <span m='1975940'>in</span> <span m='1976060'>a</span> <span m='1976120'>bad</span>
  <span m='1976390'>state</span> <span m='1977230'>when</span> <span m='1977710'>a</span>
  <span m='1977800'>lot</span> <span m='1978010'>of</span> <span m='1978100'>nodes</span>
  <span m='1978370'>are</span> <span m='1978430'>full.</span> <span m='1978970'>Because</span>
  <span m='1979270'>then</span> <span m='1979720'>as</span> <span m='1979780'>soon</span>
  <span m='1980020'>as</span> <span m='1980110'>you</span> <span m='1980200'>make</span>
  <span m='1980380'>a</span> <span m='1980410'>change</span> <span m='1980680'>in</span>
  <span m='1980740'>them,</span> <span m='1980890'>they</span> <span m='1981040'>will</span>
  <span m='1981130'>burst,</span> <span m='1981580'>and</span> <span m='1981700'>you</span>
  <span m='1981850'>have</span> <span m='1982000'>to</span> <span m='1982150'>do</span>
  <span m='1982450'>all</span> <span m='1982630'>this</span> <span m='1982780'>crazy</span>
  <span m='1983170'>recursion</span> <span m='1983680'>and</span> <span m='1983800'>stuff.</span>
  </p><p><span m='1984580'>This</span> <span m='1984760'>case</span> <span m='1985120'>is</span>
  <span m='1985270'>nice</span> <span m='1985600'>and</span> <span m='1985690'>cheap.</span>
  <span m='1985990'>We</span> <span m='1986080'>just</span> <span m='1986350'>add</span>
  <span m='1986480'>a</span> <span m='1986620'>modification,</span> <span m='1987810'>constant</span>
  <span m='1988115'>time.</span> <span m='1988720'>This</span> <span m='1988900'>case,</span>
  <span m='1989140'>not</span> <span m='1989290'>so</span> <span m='1989410'>nice</span>
  <span m='1989620'>because</span> <span m='1989800'>we</span> <span m='1989920'>recurse.</span>
  <span m='1990430'>And</span> <span m='1990520'>then</span> <span m='1990700'>that's</span>
  <span m='1990970'>going</span> <span m='1991120'>to</span> <span m='1991650'>cause</span>
  <span m='1991960'>more</span> <span m='1992140'>recursions</span> <span m='1992740'>and</span>
  <span m='1992830'>all</span> <span m='1993010'>sorts</span> <span m='1993280'>of</span>
  <span m='1994090'>chaos</span> <span m='1994480'>could</span> <span m='1994630'>happen.</span>
  </p><p><span m='1996040'>So</span> <span m='1997460'>there's</span> <span m='1997660'>probably</span>
  <span m='1997900'>a</span> <span m='1997930'>few</span> <span m='1998140'>different</span>
  <span m='1998800'>potential</span> <span m='1999160'>functions</span> <span m='2000030'>that</span>
  <span m='2000120'>would</span> <span m='2000240'>work</span> <span m='2000450'>here.</span>
  <span m='2001080'>And</span> <span m='2001230'>an</span> <span m='2001290'>old</span>
  <span m='2001410'>version</span> <span m='2001680'>of</span> <span m='2001740'>these</span>
  <span m='2001920'>nodes</span> <span m='2002190'>I</span> <span m='2002280'>said</span>
  <span m='2003150'>should</span> <span m='2003300'>be</span> <span m='2003420'>the</span>
  <span m='2003540'>number</span> <span m='2003900'>of</span> <span m='2003960'>full</span>
  <span m='2004200'>nodes.</span> <span m='2005070'>But</span> <span m='2005250'>I</span>
  <span m='2005310'>think</span> <span m='2005520'>we</span> <span m='2005640'>can</span>
  <span m='2005760'>make</span> <span m='2005970'>life</span> <span m='2006270'>a</span>
  <span m='2006330'>little</span> <span m='2006600'>bit</span> <span m='2006720'>easier</span>
  <span m='2007680'>by</span> <span m='2008680'>the</span> <span m='2009480'>following.</span>
  <span m='2012390'>Basically,</span> <span m='2012720'>the</span> <span m='2012900'>total</span>
  <span m='2013410'>number</span> <span m='2013710'>of</span> <span m='2013770'>modifications--</span>
  <span m='2016674'>not</span> <span m='2017160'>quite</span> <span m='2017400'>the</span>
  <span m='2017490'>total,</span> <span m='2018240'>almost</span> <span m='2018540'>the</span>
  <span m='2018630'>total.</span> </p><p><span m='2019800'>So</span> <span m='2020070'>I'm</span>
  <span m='2020150'>going</span> <span m='2020260'>to</span> <span m='2020380'>do</span>
  <span m='2020610'>c</span> <span m='2020940'>times</span> <span m='2022030'>the
  sum</span> <span m='2023280'>of</span> <span m='2024030'>the</span> <span m='2024120'>number</span>
  <span m='2024590'>of</span> <span m='2026460'>mods</span> <span m='2029760'>in</span>
  <span m='2031880'>latest</span> <span m='2033360'>version</span> <span m='2035910'>nodes.</span>
  <span m='2039160'>OK.</span> <span m='2040530'>So</span> <span m='2041730'>because</span>
  <span m='2041910'>we</span> <span m='2042390'>sort</span> <span m='2042630'>of</span>
  <span m='2042690'>really</span> <span m='2042960'>only</span> <span m='2043140'>care</span>
  <span m='2043320'>about--</span> <span m='2043740'>we're</span> <span m='2043860'>only</span>
  <span m='2044040'>changing</span> <span m='2044370'>the</span> <span m='2044460'>latest</span>
  <span m='2044730'>version,</span> <span m='2045150'>so</span> <span m='2045300'>I</span>
  <span m='2045360'>really</span> <span m='2045600'>only</span> <span m='2045780'>care</span>
  <span m='2045930'>about</span> <span m='2046110'>nodes</span> <span m='2046950'>that</span>
  <span m='2047070'>live</span> <span m='2047340'>in</span> <span m='2047430'>the</span>
  <span m='2047520'>latest</span> <span m='2047790'>version.</span> </p><p><span m='2048570'>What</span>
  <span m='2048659'>do</span> <span m='2048780'>I</span> <span m='2048870'>mean</span>
  <span m='2049080'>by</span> <span m='2049230'>this?</span> <span m='2049659'>Well,</span>
  <span m='2049770'>when</span> <span m='2049920'>I</span> <span m='2050010'>made</span>
  <span m='2050250'>this</span> <span m='2050400'>new</span> <span m='2050610'>node</span>
  <span m='2050880'>prime,</span> <span m='2051909'>this</span> <span m='2051989'>becomes</span>
  <span m='2052409'>the</span> <span m='2052500'>new</span> <span m='2052620'>representation</span>
  <span m='2053280'>of</span> <span m='2053340'>that</span> <span m='2053699'>node.</span>
  <span m='2054000'>The</span> <span m='2054210'>old</span> <span m='2054420'>version</span>
  <span m='2055110'>is</span> <span m='2055260'>dead.</span> <span m='2055690'>We</span>
  <span m='2055770'>will</span> <span m='2055889'>never</span> <span m='2056429'>change</span>
  <span m='2056760'>it</span> <span m='2056820'>again.</span> <span m='2058560'>If</span>
  <span m='2058710'>we're</span> <span m='2058800'>modifying,</span> <span m='2059409'>we</span>
  <span m='2059520'>will</span> <span m='2059610'>never</span> <span m='2059850'>even</span>
  <span m='2060060'>look</span> <span m='2060300'>at</span> <span m='2060449'>it</span>
  <span m='2060570'>again.</span> <span m='2061080'>Because</span> <span m='2061260'>now</span>
  <span m='2061440'>everything</span> <span m='2061949'>points</span> <span m='2062280'>to</span>
  <span m='2062400'>here.</span> </p><p><span m='2065020'>So</span> <span m='2065199'>I</span>
  <span m='2065260'>don't</span> <span m='2065350'>really</span> <span m='2065590'>care</span>
  <span m='2065770'>about</span> <span m='2066010'>that</span> <span m='2066159'>node.</span>
  <span m='2066429'>It's</span> <span m='2066550'>got</span> <span m='2066699'>a</span>
  <span m='2066760'>ton</span> <span m='2066969'>of</span> <span m='2067060'>mods.</span>
  <span m='2067690'>But</span> <span m='2067900'>what's</span> <span m='2068320'>nice</span>
  <span m='2068650'>is</span> <span m='2068770'>that</span> <span m='2068980'>when</span>
  <span m='2069159'>I</span> <span m='2069250'>create</span> <span m='2069520'>this</span>
  <span m='2069670'>new</span> <span m='2069820'>node,</span> <span m='2070000'>now</span>
  <span m='2070380'>the</span> <span m='2070540'>mod</span> <span m='2070810'>list</span>
  <span m='2071080'>is</span> <span m='2071170'>empty.</span> <span m='2072219'>So</span>
  <span m='2072340'>I</span> <span m='2072400'>start</span> <span m='2072610'>from</span>
  <span m='2072760'>scratch,</span> <span m='2073120'>just</span> <span m='2073239'>like</span>
  <span m='2073360'>reinstalling</span> <span m='2073840'>your</span> <span m='2073960'>operating</span>
  <span m='2074290'>system.</span> <span m='2074870'>It's</span> <span m='2074980'>a</span>
  <span m='2075250'>good</span> <span m='2075610'>feeling.</span> </p><p><span m='2078010'>And</span>
  <span m='2078219'>so</span> <span m='2078370'>the</span> <span m='2078429'>potential</span>
  <span m='2078850'>goes</span> <span m='2079060'>down</span> <span m='2079929'>by,</span>
  <span m='2082719'>I</span> <span m='2082790'>guess,</span> <span m='2082920'>c</span>
  <span m='2083679'>times</span> <span m='2084010'>2</span> <span m='2084190'>times</span>
  <span m='2084570'>p.</span> <span m='2085090'>When</span> <span m='2085239'>I</span>
  <span m='2085330'>do</span> <span m='2085480'>this</span> <span m='2085630'>change,</span>
  <span m='2086440'>potential</span> <span m='2086710'>goes</span> <span m='2086949'>down</span>
  <span m='2087280'>by</span> <span m='2088030'>basically</span> <span m='2088389'>p.</span>
  </p><p><span m='2089764'>AUDIENCE:</span> <span m='2089887'>Is</span> <span m='2090010'>c</span>
  <span m='2090256'>any</span> <span m='2090748'>constant</span> <span m='2091240'>or--</span>
  </p><p><span m='2092230'>ERIK DEMAINE:</span> <span m='2092305'>c</span> <span m='2092380'>will
  be</span> <span m='2092560'>a</span> <span m='2092679'>constant</span> <span m='2093040'>to</span>
  <span m='2093130'>be</span> <span m='2093250'>determined.</span> <span m='2095440'>I</span>
  <span m='2095530'>mean,</span> <span m='2096290'>it</span> <span m='2096489'>could</span>
  <span m='2096610'>be</span> <span m='2096730'>1.</span> <span m='2097180'>It</span>
  <span m='2097240'>depends</span> <span m='2097570'>how</span> <span m='2097660'>you</span>
  <span m='2097780'>want</span> <span m='2097930'>to</span> <span m='2097990'>define</span>
  <span m='2098320'>it.</span> <span m='2098770'>I'm</span> <span m='2098920'>going</span>
  <span m='2099070'>to</span> <span m='2099130'>use</span> <span m='2099340'>the</span>
  <span m='2099540'>CLRS</span> <span m='2099940'>notion</span> <span m='2100660'>of</span>
  <span m='2100780'>amortized</span> <span m='2101410'>cost,</span> <span m='2101890'>which</span>
  <span m='2102130'>is</span> <span m='2103090'>actual</span> <span m='2103480'>cost</span>
  <span m='2104380'>plus</span> <span m='2104740'>change</span> <span m='2105010'>in</span>
  <span m='2105100'>potential.</span> <span m='2106840'>And</span> <span m='2106990'>then</span>
  <span m='2107230'>I</span> <span m='2107290'>need</span> <span m='2107470'>a</span>
  <span m='2107530'>constant</span> <span m='2107920'>here,</span> <span m='2108070'>because</span>
  <span m='2108400'>I'm</span> <span m='2108610'>measuring</span> <span m='2109030'>a</span>
  <span m='2109090'>running</span> <span m='2109390'>time</span> <span m='2109720'>versus</span>
  <span m='2110620'>some</span> <span m='2111930'>combinatorial</span> <span m='2112350'>quantity.</span>
  <span m='2112850'>So</span> <span m='2112930'>this</span> <span m='2113110'>will</span>
  <span m='2113200'>be</span> <span m='2113530'>to</span> <span m='2113620'>match</span>
  <span m='2113890'>the</span> <span m='2114030'>running</span> <span m='2114280'>time</span>
  <span m='2114490'>that</span> <span m='2114610'>we'll</span> <span m='2114730'>get</span>
  <span m='2114880'>to.</span> </p><p><span m='2117410'>OK.</span> <span m='2117990'>So</span>
  <span m='2119200'>what</span> <span m='2119500'>is</span> <span m='2119710'>amortized</span>
  <span m='2120520'>cost?</span> <span m='2122290'>There's</span> <span m='2122500'>sort</span>
  <span m='2122650'>of</span> <span m='2122740'>two</span> <span m='2123280'>cases</span>
  <span m='2124000'>modification.</span> <span m='2124920'>There's</span> <span m='2125080'>the</span>
  <span m='2125190'>cheap</span> <span m='2125410'>case</span> <span m='2126490'>and</span>
  <span m='2126700'>the</span> <span m='2126790'>not</span> <span m='2126970'>so</span>
  <span m='2127120'>cheap</span> <span m='2127360'>case.</span> <span m='2128440'>In</span>
  <span m='2128620'>general,</span> <span m='2130090'>amortized</span> <span m='2130660'>cost--</span>
  <span m='2134980'>in</span> <span m='2135100'>both</span> <span m='2135340'>cases,</span>
  <span m='2135860'>it's</span> <span m='2135960'>going</span> <span m='2136060'>to</span>
  <span m='2136180'>be</span> <span m='2136270'>at</span> <span m='2136330'>most--</span>
  <span m='2137920'>well,</span> <span m='2138100'>first</span> <span m='2138340'>of</span>
  <span m='2138430'>all,</span> <span m='2138520'>we</span> <span m='2138670'>do</span>
  <span m='2138850'>some</span> <span m='2139060'>constant</span> <span m='2139540'>work</span>
  <span m='2139810'>just</span> <span m='2140030'>to</span> <span m='2140650'>figure</span>
  <span m='2140980'>out</span> <span m='2141100'>all</span> <span m='2141250'>this</span>
  <span m='2141400'>stuff,</span> <span m='2141730'>make</span> <span m='2141940'>copies,</span>
  <span m='2142630'>whatever.</span> <span m='2144640'>So</span> <span m='2145600'>that's</span>
  <span m='2145840'>some</span> <span m='2146740'>constant</span> <span m='2147820'>time.</span>
  <span m='2149680'>That's</span> <span m='2149860'>the</span> <span m='2149950'>part</span>
  <span m='2150160'>that</span> <span m='2150430'>I</span> <span m='2150520'>don't</span>
  <span m='2150700'>want</span> <span m='2150820'>to</span> <span m='2150880'>try</span>
  <span m='2151030'>to</span> <span m='2151150'>measure.</span> </p><p><span m='2152920'>Then</span>
  <span m='2153670'>potentially,</span> <span m='2154240'>we</span> <span m='2154390'>add</span>
  <span m='2154630'>a</span> <span m='2154690'>new</span> <span m='2154880'>mod.</span>
  <span m='2155140'>If</span> <span m='2155260'>we</span> <span m='2155410'>add</span>
  <span m='2155620'>a</span> <span m='2155680'>mod,</span> <span m='2156010'>that</span>
  <span m='2156190'>increases</span> <span m='2156670'>the</span> <span m='2156760'>potential</span>
  <span m='2157300'>by</span> <span m='2158230'>c.</span> <span m='2159430'>Because</span>
  <span m='2159610'>we're</span> <span m='2159670'>just</span> <span m='2159820'>counting</span>
  <span m='2160180'>mods,</span> <span m='2160480'>multiplying</span> <span m='2160960'>by</span>
  <span m='2161080'>c.</span> <span m='2162070'>So</span> <span m='2162280'>we</span>
  <span m='2162430'>might</span> <span m='2162790'>get</span> <span m='2163690'>plus</span>
  <span m='2164020'>1</span> <span m='2164510'>mod.</span> <span m='2164800'>This</span>
  <span m='2164980'>is</span> <span m='2165040'>going</span> <span m='2165160'>to</span>
  <span m='2165250'>be</span> <span m='2165490'>an</span> <span m='2165640'>upper</span>
  <span m='2165910'>bound.</span> <span m='2166160'>We</span> <span m='2166240'>don't</span>
  <span m='2166450'>always</span> <span m='2166750'>add</span> <span m='2166910'>1,</span>
  <span m='2167800'>but</span> <span m='2168220'>worst</span> <span m='2168490'>case,</span>
  <span m='2168700'>we</span> <span m='2169140'>always</span> <span m='2169410'>had</span>
  <span m='2169560'>1,</span> <span m='2169720'>let's</span> <span m='2169810'>say.</span>
  </p><p><span m='2171880'>And</span> <span m='2172000'>then</span> <span m='2172390'>there's</span>
  <span m='2172630'>this</span> <span m='2172810'>annoying</span> <span m='2173110'>part.</span>
  <span m='2174220'>And</span> <span m='2174400'>this</span> <span m='2174640'>might</span>
  <span m='2174880'>happen,</span> <span m='2175210'>might</span> <span m='2175390'>not</span>
  <span m='2175570'>happen.</span> <span m='2176500'>So</span> <span m='2176740'>then</span>
  <span m='2176920'>there's</span> <span m='2177070'>a</span> <span m='2177130'>plus</span>
  <span m='2177910'>maybe.</span> <span m='2180340'>If</span> <span m='2180550'>this</span>
  <span m='2180730'>happens,</span> <span m='2182080'>we</span> <span m='2182260'>decrease</span>
  <span m='2182740'>the</span> <span m='2182830'>potential</span> <span m='2183310'>because</span>
  <span m='2183580'>we</span> <span m='2183730'>empty</span> <span m='2184120'>out</span>
  <span m='2184270'>the</span> <span m='2184360'>mods</span> <span m='2184720'>for</span>
  <span m='2184840'>that</span> <span m='2185020'>node</span> <span m='2186010'>in</span>
  <span m='2186130'>terms</span> <span m='2186310'>of</span> <span m='2186370'>the</span>
  <span m='2186490'>latest</span> <span m='2186820'>version.</span> <span m='2187720'>So</span>
  <span m='2187870'>then</span> <span m='2188020'>we</span> <span m='2188110'>get</span>
  <span m='2188290'>a</span> <span m='2188350'>negative</span> <span m='2190060'>2cp,</span>
  <span m='2192100'>change</span> <span m='2192430'>in</span> <span m='2192520'>potential.</span>
  <span m='2194500'>And</span> <span m='2194650'>then</span> <span m='2194860'>we'd</span>
  <span m='2194980'>have</span> <span m='2195160'>to</span> <span m='2195250'>pay</span>
  <span m='2198370'>I</span> <span m='2198490'>guess</span> <span m='2198730'>up</span>
  <span m='2198970'>to</span> <span m='2199990'>p</span> <span m='2201370'>recursions.</span>
  </p><p><span m='2209250'>Because</span> <span m='2209880'>we</span> <span m='2210030'>have</span>
  <span m='2210240'>to--</span> <span m='2211520'>how</span> <span m='2211710'>many</span>
  <span m='2212040'>pointers</span> <span m='2212580'>are</span> <span m='2212700'>there</span>
  <span m='2212850'>to</span> <span m='2213060'>me?</span> <span m='2213360'>Well,</span>
  <span m='2213570'>at</span> <span m='2213660'>most</span> <span m='2213900'>p</span>
  <span m='2214110'>of</span> <span m='2214200'>them,</span> <span m='2214410'>because</span>
  <span m='2214660'>there are</span> <span m='2217190'>at</span> <span m='2217520'>most</span>
  <span m='2217760'>p</span> <span m='2217950'>pointers</span> <span m='2218490'>to</span>
  <span m='2218790'>any</span> <span m='2219000'>node.</span> <span m='2222750'>OK.</span>
  </p><p><span m='2223350'>This</span> <span m='2223530'>is</span> <span m='2224010'>kind</span>
  <span m='2224280'>of</span> <span m='2224370'>a</span> <span m='2224460'>weird--</span>
  <span m='2225110'>it's</span> <span m='2225240'>not</span> <span m='2225360'>exactly</span>
  <span m='2225870'>algebra</span> <span m='2226260'>here.</span> <span m='2226510'>I</span>
  <span m='2226530'>have</span> <span m='2226710'>this</span> <span m='2226920'>thing,</span>
  <span m='2227440'>recursions.</span> <span m='2229770'>But</span> <span m='2230040'>if</span>
  <span m='2230250'>you</span> <span m='2230340'>think</span> <span m='2230520'>about</span>
  <span m='2230700'>how</span> <span m='2230850'>this</span> <span m='2231030'>would</span>
  <span m='2231150'>expand,</span> <span m='2231610'>all right,</span> <span m='2231790'>this</span>
  <span m='2232040'>is</span> <span m='2232110'>constant</span> <span m='2232560'>time.</span>
  <span m='2233160'>That's</span> <span m='2233340'>good.</span> <span m='2234070'>And</span>
  <span m='2234090'>then</span> <span m='2234270'>if</span> <span m='2234510'>we</span>
  <span m='2234630'>do</span> <span m='2234780'>this--</span> <span m='2235020'>I'll</span>
  <span m='2235110'>put</span> <span m='2235290'>a</span> <span m='2235440'>question</span>
  <span m='2235800'>mark</span> <span m='2236010'>here.</span> <span m='2236160'>It</span>
  <span m='2236220'>might</span> <span m='2236370'>be</span> <span m='2236490'>here.</span>
  <span m='2236730'>It might</span> <span m='2236910'>not.</span> </p><p><span m='2238110'>If</span>
  <span m='2238230'>it's</span> <span m='2238350'>not</span> <span m='2238530'>here,</span>
  <span m='2238740'>find</span> <span m='2239080'>constant.</span> <span m='2239820'>If</span>
  <span m='2239970'>it</span> <span m='2240030'>is</span> <span m='2240210'>here,</span>
  <span m='2241260'>then</span> <span m='2241710'>this</span> <span m='2241950'>gets</span>
  <span m='2242160'>expanded</span> <span m='2242730'>into</span> <span m='2243000'>this</span>
  <span m='2243240'>thing.</span> <span m='2244280'>It's</span> <span m='2244490'>a</span>
  <span m='2244580'>weird</span> <span m='2245140'>way</span> <span m='2245280'>to</span>
  <span m='2245520'>write a</span> <span m='2245580'>recurrence.</span> <span m='2246130'>But</span>
  <span m='2246600'>we</span> <span m='2246690'>get</span> <span m='2246840'>p</span>
  <span m='2247080'>times</span> <span m='2248100'>whatever</span> <span m='2248580'>is</span>
  <span m='2248940'>in</span> <span m='2249450'>this</span> <span m='2249720'>right</span>
  <span m='2249900'>hand</span> <span m='2250050'>side.</span> <span m='2250890'>OK.</span>
  </p><p><span m='2251040'>But</span> <span m='2251160'>then</span> <span m='2251280'>there's</span>
  <span m='2251430'>this</span> <span m='2251550'>minus</span> <span m='2251910'>2cp.</span>
  <span m='2253440'>So</span> <span m='2253560'>we're</span> <span m='2253630'>going</span>
  <span m='2253700'>to</span> <span m='2253800'>get</span> <span m='2253980'>p</span>
  <span m='2254670'>times</span> <span m='2255030'>2c</span> <span m='2255660'>here.</span>
  <span m='2256560'>That's</span> <span m='2256830'>the</span> <span m='2257040'>initial</span>
  <span m='2257400'>cost.</span> <span m='2257850'>So</span> <span m='2258000'>that</span>
  <span m='2258210'>will</span> <span m='2258330'>cancel</span> <span m='2258780'>with</span>
  <span m='2258940'>this.</span> <span m='2260040'>And</span> <span m='2260190'>then</span>
  <span m='2260340'>we</span> <span m='2260490'>might</span> <span m='2260730'>get</span>
  <span m='2261000'>another</span> <span m='2261270'>recursion.</span> <span m='2262240'>But</span>
  <span m='2262290'>every</span> <span m='2262530'>time</span> <span m='2262740'>we</span>
  <span m='2262800'>get</span> <span m='2262910'>a</span> <span m='2262950'>recursion,</span>
  <span m='2263340'>all</span> <span m='2263520'>the</span> <span m='2263640'>terms</span>
  <span m='2263910'>cancel.</span> <span m='2265290'>So</span> <span m='2265470'>it</span>
  <span m='2265530'>doesn't</span> <span m='2265740'>matter</span> <span m='2265980'>whether</span>
  <span m='2266160'>this</span> <span m='2266310'>is</span> <span m='2266430'>here</span>
  <span m='2266610'>or</span> <span m='2266640'>not.</span> <span m='2266940'>You</span>
  <span m='2267060'>get</span> <span m='2267210'>0,</span> <span m='2268890'>which</span>
  <span m='2269040'>is great.</span> <span m='2269610'>And</span> <span m='2269850'>you're</span>
  <span m='2269970'>left</span> <span m='2270240'>with</span> <span m='2270360'>the</span>
  <span m='2270450'>original</span> <span m='2270810'>2c.</span> <span m='2273400'>Constant.</span>
  <span m='2275410'>OK.</span> </p><p><span m='2276300'>[INAUDIBLE]</span> <span m='2276480'>potential</span>
  <span m='2276870'>functions</span> <span m='2277260'>are</span> <span m='2277350'>always</span>
  <span m='2277620'>a</span> <span m='2277680'>little</span> <span m='2278520'>crazy.</span>
  <span m='2279120'>What's</span> <span m='2279600'>happening</span> <span m='2280050'>here</span>
  <span m='2280650'>is</span> <span m='2280860'>that,</span> <span m='2282370'>OK,</span>
  <span m='2282600'>maybe</span> <span m='2282810'>you</span> <span m='2282940'>add
  a</span> <span m='2283235'>mod.</span> <span m='2283530'>That's</span> <span m='2283740'>cheap.</span>
  <span m='2285150'>But</span> <span m='2285810'>when</span> <span m='2286140'>we</span>
  <span m='2286260'>have</span> <span m='2286440'>to</span> <span m='2286560'>do</span>
  <span m='2286740'>this</span> <span m='2286950'>work</span> <span m='2287250'>and</span>
  <span m='2287370'>we</span> <span m='2287460'>have</span> <span m='2287640'>to</span>
  <span m='2287760'>do</span> <span m='2288000'>this</span> <span m='2288150'>recursion--</span>
  <span m='2288790'>this</span> <span m='2288840'>is</span> <span m='2288990'>up</span>
  <span m='2289230'>to</span> <span m='2289440'>2p</span> <span m='2292110'>updates</span>
  <span m='2293250'>or</span> <span m='2293340'>recursions--</span> <span m='2294390'>we</span>
  <span m='2294570'>are</span> <span m='2294660'>charging</span> <span m='2295260'>it</span>
  <span m='2295350'>to</span> <span m='2295680'>the</span> <span m='2295890'>emptying</span>
  <span m='2296400'>of</span> <span m='2296490'>this</span> <span m='2296670'>node.</span>
  <span m='2297270'>The</span> <span m='2297390'>number</span> <span m='2297660'>of
  mods</span> <span m='2298020'>went</span> <span m='2298230'>from</span> <span m='2298930'>2p</span>
  <span m='2299850'>down</span> <span m='2300060'>to</span> <span m='2300150'>0.</span>
  </p><p><span m='2301110'>And</span> <span m='2301200'>so</span> <span m='2301320'>we're</span>
  <span m='2301410'>just</span> <span m='2301530'>charging</span> <span m='2301920'>this</span>
  <span m='2302070'>update</span> <span m='2302340'>cost</span> <span m='2302940'>to</span>
  <span m='2303060'>that</span> <span m='2303300'>modification.</span> <span m='2304170'>So</span>
  <span m='2304290'>if</span> <span m='2304380'>you</span> <span m='2304500'>like</span>
  <span m='2304680'>charging</span> <span m='2305010'>schemes,</span> <span m='2305260'>this
  is</span> <span m='2305350'>much</span> <span m='2305520'>more</span> <span m='2305670'>intuitive.</span>
  <span m='2306600'>But</span> <span m='2306750'>with charging</span> <span m='2307230'>schemes,</span>
  <span m='2307440'>it's</span> <span m='2307560'>always</span> <span m='2307740'>a</span>
  <span m='2307800'>little</span> <span m='2308070'>careful.</span> <span m='2308500'>You</span>
  <span m='2308580'>have</span> <span m='2308700'>to</span> <span m='2308820'>make</span>
  <span m='2308970'>sure</span> <span m='2309150'>you're</span> <span m='2309330'>not</span>
  <span m='2309810'>double</span> <span m='2310020'>charging.</span> <span m='2310860'>Here</span>
  <span m='2311130'>it's</span> <span m='2312090'>obvious</span> <span m='2312660'>that</span>
  <span m='2312960'>you're</span> <span m='2313110'>not</span> <span m='2313300'>double</span>
  <span m='2313560'>charging.</span> <span m='2314790'>Kind</span> <span m='2315060'>of</span>
  <span m='2315130'>a</span> <span m='2315240'>cool</span> <span m='2315630'>and</span>
  <span m='2315750'>magical.</span> </p><p><span m='2317070'>This</span> <span m='2317280'>is</span>
  <span m='2317400'>a</span> <span m='2317460'>paper</span> <span m='2317820'>by</span>
  <span m='2319230'>Driscoll,</span> <span m='2320820'>Sarnak,</span> <span m='2321540'>Sleator,</span>
  <span m='2322010'>Tarjan</span> <span m='2322560'>from</span> <span m='2322770'>1989.</span>
  <span m='2323820'>So</span> <span m='2323910'>it's</span> <span m='2324090'>very</span>
  <span m='2324360'>early</span> <span m='2324600'>days</span> <span m='2324840'>of</span>
  <span m='2324930'>amortization.</span> <span m='2325620'>But</span> <span m='2326370'>they</span>
  <span m='2326460'>knew</span> <span m='2326580'>how</span> <span m='2326700'>to</span>
  <span m='2326790'>do</span> <span m='2326940'>it.</span> <span m='2327760'>Question?</span>
  </p><p><span m='2328521'>AUDIENCE:</span> <span m='2328756'>[INAUDIBLE]</span> </p><p><span
  m='2331350'>ERIK DEMAINE:</span> <span m='2331440'>What</span> <span m='2331530'>happens</span>
  <span m='2331800'>if</span> <span m='2331890'>you</span> <span m='2331960'>overflow</span>
  <span m='2332340'>the</span> <span m='2332430'>root?</span> <span m='2332670'>Yeah,</span>
  <span m='2332880'>I</span> <span m='2332940'>never</span> <span m='2333300'>thought</span>
  <span m='2333540'>about</span> <span m='2333870'>the</span> <span m='2333990'>root
  before</span> <span m='2334260'>today.</span> <span m='2334650'>But</span> <span
  m='2335430'>I</span> <span m='2335550'>think</span> <span m='2335820'>the</span>
  <span m='2335940'>way</span> <span m='2336060'>to</span> <span m='2336180'>fix</span>
  <span m='2336450'>the</span> <span m='2336540'>root</span> <span m='2337200'>is</span>
  <span m='2337350'>just</span> <span m='2337680'>you</span> <span m='2337830'>have</span>
  <span m='2338160'>one</span> <span m='2338460'>big</span> <span m='2338700'>table</span>
  <span m='2339150'>that</span> <span m='2339300'>says,</span> <span m='2339780'>for</span>
  <span m='2340200'>a</span> <span m='2340260'>given</span> <span m='2340620'>version--</span>
  <span m='2342780'>I</span> <span m='2342990'>guess</span> <span m='2343200'>a</span>
  <span m='2343260'>simple</span> <span m='2343590'>way</span> <span m='2344010'>would</span>
  <span m='2344160'>be</span> <span m='2344250'>to</span> <span m='2344340'>say,</span>
  <span m='2344620'>not</span> <span m='2344730'>only</span> <span m='2344910'>is</span>
  <span m='2345000'>a</span> <span m='2345060'>version</span> <span m='2345330'>a</span>
  <span m='2345390'>number,</span> <span m='2345720'>but</span> <span m='2345840'>it's</span>
  <span m='2345930'>also</span> <span m='2346200'>a</span> <span m='2346230'>pointer</span>
  <span m='2346560'>to</span> <span m='2346680'>the</span> <span m='2346770'>root.</span>
  <span m='2347130'>There</span> <span m='2347280'>we</span> <span m='2347370'>go.</span>
  <span m='2347520'>Pointer</span> <span m='2347760'>machine.</span> </p><p><span
  m='2349320'>So</span> <span m='2349500'>that</span> <span m='2349650'>way</span>
  <span m='2349740'>you're</span> <span m='2349860'>just</span> <span m='2350070'>always</span>
  <span m='2350430'>explicitly</span> <span m='2350970'>maintaining</span> <span m='2351450'>the</span>
  <span m='2351570'>root</span> <span m='2352050'>copy</span> <span m='2353760'>or</span>
  <span m='2353880'>the</span> <span m='2354150'>pointer.</span> <span m='2355110'>Because</span>
  <span m='2355320'>otherwise,</span> <span m='2356700'>you're</span> <span m='2356820'>in</span>
  <span m='2356910'>trouble.</span> </p><p><span m='2358710'>AUDIENCE:</span> <span
  m='2358945'>Then</span> <span m='2359180'>can you go</span> <span m='2359650'>back
  to</span> <span m='2360120'>[INAUDIBLE].</span> </p><p><span m='2361530'>ERIK DEMAINE:</span>
  <span m='2361570'>So</span> <span m='2362960'>in</span> <span m='2363080'>order</span>
  <span m='2363260'>to</span> <span m='2363380'>refer</span> <span m='2363740'>to</span>
  <span m='2363830'>an</span> <span m='2363920'>old</span> <span m='2364040'>version,</span>
  <span m='2364310'>you</span> <span m='2364430'>have</span> <span m='2364610'>to</span>
  <span m='2364730'>have</span> <span m='2364880'>the</span> <span m='2365000'>pointer</span>
  <span m='2365360'>to</span> <span m='2365540'>that</span> <span m='2365720'>root</span>
  <span m='2365900'>node.</span> <span m='2366750'>If</span> <span m='2366770'>you</span>
  <span m='2366890'>want</span> <span m='2367040'>to</span> <span m='2367100'>do</span>
  <span m='2367220'>it</span> <span m='2367310'>just</span> <span m='2367580'>from</span>
  <span m='2367730'>a</span> <span m='2367760'>version</span> <span m='2368090'>number,</span>
  <span m='2369650'>look</span> <span m='2369860'>at</span> <span m='2369920'>the</span>
  <span m='2370010'>data</span> <span m='2370190'>structure.</span> <span m='2370460'>Just</span>
  <span m='2370610'>from</span> <span m='2370690'>a</span> <span m='2370730'>version</span>
  <span m='2371000'>number,</span> <span m='2371210'>you</span> <span m='2371330'>would</span>
  <span m='2371450'>need</span> <span m='2371660'>some</span> <span m='2371810'>kind</span>
  <span m='2371990'>of</span> <span m='2372080'>lookup</span> <span m='2372350'>table,</span>
  <span m='2373160'>which</span> <span m='2373340'>is</span> <span m='2373460'>outside</span>
  <span m='2373790'>the</span> <span m='2373910'>pointer</span> <span m='2374180'>machine.</span>
  <span m='2374540'>So</span> <span m='2374660'>you</span> <span m='2374750'>could</span>
  <span m='2374900'>do</span> <span m='2375050'>it</span> <span m='2375140'>in</span>
  <span m='2375260'>a</span> <span m='2375320'>real</span> <span m='2375890'>computer,</span>
  <span m='2376280'>but a</span> <span m='2376460'>pointer</span> <span m='2376700'>machine</span>
  <span m='2376940'>is</span> <span m='2377030'>not</span> <span m='2377300'>technically</span>
  <span m='2377780'>allowed.</span> <span m='2379210'>So</span> <span m='2379680'>it's</span>
  <span m='2379780'>slightly</span> <span m='2380090'>awkward.</span> <span m='2380570'>No</span>
  <span m='2380960'>arrays</span> <span m='2381290'>are</span> <span m='2381380'>allowed</span>
  <span m='2381650'>in</span> <span m='2381770'>pointer</span> <span m='2382010'>machines,</span>
  <span m='2382400'>in case that</span> <span m='2382670'>wasn't</span> <span m='2382840'>clear.</span>
  <span m='2383270'>Another</span> <span m='2383420'>question?</span> </p><p><span
  m='2384274'>AUDIENCE:</span> <span m='2384521'>[INAUDIBLE]</span> <span m='2385756'>constant</span>
  <span m='2386744'>space to</span> <span m='2387238'>store</span> <span m='2387732'>for</span>
  <span m='2388226'>[INAUDIBLE].</span> <span m='2388720'>And</span> <span m='2389214'>also,</span>
  <span m='2389708'>what if</span> <span m='2390202'>we have really</span> <span m='2390696'>big</span>
  <span m='2391190'>numbers</span> <span m='2391690'>[INAUDIBLE]?</span> </p><p><span
  m='2394550'>ERIK DEMAINE:</span> <span m='2394700'>In</span> <span m='2394850'>this</span>
  <span m='2395030'>model,</span> <span m='2395630'>in</span> <span m='2395750'>the</span>
  <span m='2395840'>pointer</span> <span m='2396020'>machine</span> <span m='2396320'>model,</span>
  <span m='2396710'>we're</span> <span m='2396920'>assuming</span> <span m='2397250'>that</span>
  <span m='2397370'>whatever</span> <span m='2397730'>the</span> <span m='2397850'>data</span>
  <span m='2398150'>is</span> <span m='2398390'>in</span> <span m='2398480'>the</span>
  <span m='2398570'>items</span> <span m='2398930'>take</span> <span m='2399350'>constant</span>
  <span m='2399740'>space</span> <span m='2400010'>each.</span> <span m='2401480'>If</span>
  <span m='2401690'>you</span> <span m='2401780'>want</span> <span m='2401900'>to</span>
  <span m='2401960'>know</span> <span m='2402110'>about</span> <span m='2402560'>bigger</span>
  <span m='2402890'>things</span> <span m='2403280'>in</span> <span m='2403370'>here,</span>
  <span m='2403670'>then</span> <span m='2404300'>refer</span> <span m='2404570'>to</span>
  <span m='2404690'>future</span> <span m='2405020'>lectures.</span> <span m='2405450'>This
  is</span> <span m='2405620'>time</span> <span m='2405860'>travel,</span> <span m='2406130'>after</span>
  <span m='2406370'>all.</span> <span m='2406910'>Just</span> <span m='2407090'>go</span>
  <span m='2407240'>to</span> <span m='2407300'>a</span> <span m='2407360'>future</span>
  <span m='2407630'>class</span> <span m='2408020'>and</span> <span m='2408110'>then</span>
  <span m='2408230'>come</span> <span m='2408410'>back.</span> <span m='2409200'>[LAUGHS]</span>
  <span m='2410580'>So</span> <span m='2410630'>we'll</span> <span m='2410750'>get</span>
  <span m='2410930'>there,</span> <span m='2411300'>but</span> <span m='2411380'>right</span>
  <span m='2411560'>now,</span> <span m='2411920'>we're</span> <span m='2412070'>not</span>
  <span m='2412550'>thinking</span> <span m='2412970'>about</span> <span m='2413210'>what's</span>
  <span m='2413420'>in</span> <span m='2413510'>here.</span> </p><p><span m='2415310'>Whatever</span>
  <span m='2415850'>big</span> <span m='2416090'>thing</span> <span m='2416270'>you're</span>
  <span m='2416360'>trying</span> <span m='2416540'>to</span> <span m='2416630'>store,</span>
  <span m='2416870'>you</span> <span m='2416990'>reduce</span> <span m='2417380'>it</span>
  <span m='2417470'>down</span> <span m='2418280'>to</span> <span m='2418430'>constant</span>
  <span m='2418790'>size</span> <span m='2419090'>things.</span> <span m='2419810'>And</span>
  <span m='2419930'>then</span> <span m='2420090'>you</span> <span m='2420500'>spread</span>
  <span m='2420830'>them</span> <span m='2420950'>around</span> <span m='2421310'>nodes</span>
  <span m='2421550'>of</span> <span m='2421670'>a</span> <span m='2421730'>pointer</span>
  <span m='2421970'>machine.</span> <span m='2422840'>How</span> <span m='2423000'>you</span>
  <span m='2423110'>do</span> <span m='2423230'>that,</span> <span m='2423500'>that's</span>
  <span m='2423680'>up</span> <span m='2423800'>to</span> <span m='2423890'>the</span>
  <span m='2424010'>data</span> <span m='2424220'>structure.</span> <span m='2425250'>We're</span>
  <span m='2425270'>just</span> <span m='2425420'>transforming</span> <span m='2425960'>the</span>
  <span m='2426050'>data</span> <span m='2426200'>structure</span> <span m='2426530'>to</span>
  <span m='2426650'>be</span> <span m='2426770'>persistent.</span> <span m='2428000'>OK,</span>
  <span m='2428130'>you</span> <span m='2428210'>could</span> <span m='2428360'>ask</span>
  <span m='2428570'>about</span> <span m='2428810'>other</span> <span m='2429050'>models</span>
  <span m='2429390'>than</span> <span m='2429530'>pointer</span> <span m='2429750'>machines,</span>
  <span m='2430130'>but</span> <span m='2430280'>we're</span> <span m='2430370'>going</span>
  <span m='2430490'>to</span> <span m='2430580'>stick</span> <span m='2430820'>to</span>
  <span m='2431660'>pointer</span> <span m='2431930'>machines</span> <span m='2432320'>here.</span>
  </p><p><span m='2434530'>All</span> <span m='2434800'>right.</span> <span m='2436220'>That
  was</span> <span m='2436460'>partial</span> <span m='2436790'>persistence.</span>
  <span m='2438110'>Let's</span> <span m='2438380'>do</span> <span m='2438620'>full</span>
  <span m='2438830'>persistence.</span> <span m='2441540'>That</span> <span m='2441790'>was</span>
  <span m='2441890'>too</span> <span m='2442040'>easy.</span> <span m='2446300'>Same</span>
  <span m='2446600'>paper</span> <span m='2447750'>does</span> <span m='2448550'>full</span>
  <span m='2448760'>persistence.</span> <span m='2448970'>Systems</span> <span m='2449240'>That</span>
  <span m='2449390'>was</span> <span m='2449510'>just</span> <span m='2449690'>a</span>
  <span m='2449750'>warm</span> <span m='2450020'>up.</span> <span m='2450560'>Full</span>
  <span m='2450800'>persistence</span> <span m='2451070'>is</span> <span m='2451340'>actually</span>
  <span m='2451640'>not</span> <span m='2451820'>that</span> <span m='2451940'>much</span>
  <span m='2452120'>harder.</span> <span m='2455070'>So</span> <span m='2455180'>let</span>
  <span m='2455300'>me</span> <span m='2455420'>tell</span> <span m='2455660'>you</span>
  <span m='2456650'>basically</span> <span m='2457040'>what</span> <span m='2457310'>changes.</span>
  </p><p><span m='2464240'>There</span> <span m='2464460'>are</span> <span m='2464490'>two</span>
  <span m='2464790'>issues.</span> <span m='2465550'>One</span> <span m='2465720'>is</span>
  <span m='2465840'>that</span> <span m='2466710'>everything</span> <span m='2467070'>here</span>
  <span m='2467220'>has</span> <span m='2467400'>to</span> <span m='2467490'>change</span>
  <span m='2468450'>and</span> <span m='2468760'>not</span> <span m='2468930'>by</span>
  <span m='2469080'>much.</span> <span m='2469440'>We're</span> <span m='2469560'>still</span>
  <span m='2469770'>going</span> <span m='2469910'>to</span> <span m='2469950'>use</span>
  <span m='2470070'>back</span> <span m='2470310'>pointers.</span> <span m='2471370'>We're</span>
  <span m='2471420'>still</span> <span m='2471480'>going</span> <span m='2471600'>to</span>
  <span m='2471660'>have</span> <span m='2471840'>my</span> <span m='2472270'>mods.</span>
  <span m='2472860'>The</span> <span m='2472950'>number</span> <span m='2473220'>of</span>
  <span m='2473310'>mods</span> <span m='2473610'>is</span> <span m='2473670'>going</span>
  <span m='2473790'>to</span> <span m='2473880'>be</span> <span m='2473940'>slightly</span>
  <span m='2474270'>different</span> <span m='2474690'>but</span> <span m='2475350'>basically</span>
  <span m='2475680'>the</span> <span m='2475770'>same.</span> <span m='2476910'>Back</span>
  <span m='2477180'>pointers</span> <span m='2477540'>no</span> <span m='2477690'>longer</span>
  <span m='2477990'>just</span> <span m='2478140'>refer</span> <span m='2478410'>to</span>
  <span m='2478500'>the</span> <span m='2478680'>latest</span> <span m='2479190'>version.</span>
  <span m='2479520'>We</span> <span m='2479610'>have</span> <span m='2479730'>to</span>
  <span m='2479850'>maintain</span> <span m='2480150'>back</span> <span m='2480290'>pointers</span>
  <span m='2480690'>in</span> <span m='2480810'>all</span> <span m='2480990'>versions.</span>
  <span m='2481410'>So</span> <span m='2481560'>that's</span> <span m='2482400'>annoying.</span>
  <span m='2482970'>But</span> <span m='2483210'>hey,</span> <span m='2483810'>that's</span>
  <span m='2483910'>life.</span> <span m='2484440'>The</span> <span m='2484530'>amortization,</span>
  <span m='2485250'>the</span> <span m='2485340'>potential</span> <span m='2485670'>function</span>
  <span m='2485940'>will</span> <span m='2486060'>change</span> <span m='2486450'>slightly</span>
  <span m='2487080'>but</span> <span m='2487290'>basically</span> <span m='2487650'>not</span>
  <span m='2487800'>much.</span> </p><p><span m='2490850'>Sort</span> <span m='2491070'>of</span>
  <span m='2491130'>the</span> <span m='2491250'>bigger</span> <span m='2491520'>issue</span>
  <span m='2491830'>you</span> <span m='2491910'>might</span> <span m='2492180'>first</span>
  <span m='2492450'>wonder</span> <span m='2492690'>about,</span> <span m='2493180'>and</span>
  <span m='2493230'>it's</span> <span m='2493560'>actually</span> <span m='2493890'>the</span>
  <span m='2493980'>most</span> <span m='2494220'>challenging</span> <span m='2494730'>technically,</span>
  <span m='2495240'>is</span> <span m='2495900'>versions</span> <span m='2496230'>are</span>
  <span m='2496320'>no</span> <span m='2496470'>longer</span> <span m='2496740'>numbers.</span>
  <span m='2497490'>Because</span> <span m='2497700'>it's</span> <span m='2497850'>not</span>
  <span m='2498030'>a</span> <span m='2498250'>line.</span> <span m='2499140'>Versions</span>
  <span m='2499680'>are</span> <span m='2500010'>nodes</span> <span m='2500400'>in</span>
  <span m='2500490'>a</span> <span m='2500550'>tree.</span> <span m='2501810'>You</span>
  <span m='2501870'>should probably</span> <span m='2502110'>call</span> <span m='2502230'>them</span>
  <span m='2502350'>vertices</span> <span m='2502830'>in</span> <span m='2502920'>a</span>
  <span m='2502980'>tree</span> <span m='2503190'>to</span> <span m='2503310'>distinguish</span>
  <span m='2503790'>them</span> <span m='2503910'>from</span> <span m='2504120'>nodes</span>
  <span m='2504420'>in</span> <span m='2504510'>the</span> <span m='2504630'>pointer</span>
  <span m='2504900'>machine.</span> </p><p><span m='2506580'>OK, so</span> <span m='2506700'>you've</span>
  <span m='2506820'>got</span> <span m='2506940'>this</span> <span m='2507090'>tree</span>
  <span m='2507360'>of</span> <span m='2507450'>versions.</span> <span m='2508530'>And</span>
  <span m='2508680'>then</span> <span m='2509220'>versions</span> <span m='2509580'>are</span>
  <span m='2509670'>just</span> <span m='2509820'>some</span> <span m='2510090'>point</span>
  <span m='2510480'>on</span> <span m='2512040'>that</span> <span m='2512190'>tree.</span>
  <span m='2513930'>This</span> <span m='2514140'>is</span> <span m='2514410'>annoying</span>
  <span m='2515280'>because</span> <span m='2515700'>we</span> <span m='2515850'>like</span>
  <span m='2516600'>lines.</span> <span m='2517020'>We</span> <span m='2517170'>don't</span>
  <span m='2517350'>like</span> <span m='2517530'>trees</span> <span m='2517830'>as</span>
  <span m='2517950'>much.</span> <span m='2518860'>So</span> <span m='2518970'>what</span>
  <span m='2519150'>we're</span> <span m='2519240'>going</span> <span m='2519320'>to</span>
  <span m='2519420'>do</span> <span m='2519660'>is</span> <span m='2519840'>linearize</span>
  <span m='2520380'>the</span> <span m='2520500'>tree.</span> <span m='2524320'>Like,</span>
  <span m='2524700'>when</span> <span m='2524850'>in</span> <span m='2524970'>doubt,</span>
  <span m='2525510'>cheat.</span> </p><p><span m='2532200'>How</span> <span m='2532410'>do</span>
  <span m='2532500'>we</span> <span m='2532590'>do</span> <span m='2532710'>this?</span>
  <span m='2533880'>With</span> <span m='2534150'>tree</span> <span m='2534360'>traversal.</span>
  <span m='2535310'>Imagine</span> <span m='2535860'>I'm</span> <span m='2535920'>going</span>
  <span m='2536040'>to</span> <span m='2536100'>draw</span> <span m='2536820'>a</span>
  <span m='2536910'>super</span> <span m='2537330'>complicated</span> <span m='2537960'>tree</span>
  <span m='2538240'>of</span> <span m='2538340'>versions.</span> <span m='2539370'>Say</span>
  <span m='2539580'>there</span> <span m='2539760'>are</span> <span m='2539820'>three</span>
  <span m='2540150'>versions.</span> <span m='2541660'>OK.</span> <span m='2543270'>I</span>
  <span m='2543360'>don't</span> <span m='2543480'>want</span> <span m='2543630'>to</span>
  <span m='2543690'>number</span> <span m='2544140'>them,</span> <span m='2544350'>because</span>
  <span m='2544530'>that</span> <span m='2544680'>would</span> <span m='2544770'>be</span>
  <span m='2544890'>kind</span> <span m='2545130'>of</span> <span m='2545340'>begging</span>
  <span m='2545670'>the</span> <span m='2545790'>question.</span> <span m='2546330'>So</span>
  <span m='2546600'>let's</span> <span m='2546780'>just</span> <span m='2546930'>call</span>
  <span m='2547140'>them</span> <span m='2548160'>x,</span> <span m='2549180'>y,</span>
  <span m='2550140'>and</span> <span m='2550290'>z.</span> </p><p><span m='2553080'>All</span>
  <span m='2553140'>right.</span> <span m='2554640'>I</span> <span m='2554700'>mean,</span>
  <span m='2554790'>it's</span> <span m='2554880'>a</span> <span m='2554940'>directed</span>
  <span m='2555360'>tree,</span> <span m='2555660'>because</span> <span m='2555930'>we</span>
  <span m='2556050'>have</span> <span m='2556230'>the</span> <span m='2557010'>older</span>
  <span m='2557250'>versions.</span> <span m='2557940'>This is like</span> <span m='2558090'>the</span>
  <span m='2558180'>original</span> <span m='2558480'>version.</span> <span m='2558880'>And</span>
  <span m='2558980'>we</span> <span m='2559080'>made</span> <span m='2559140'>a</span>
  <span m='2559170'>change.</span> <span m='2559560'>We</span> <span m='2559650'>made</span>
  <span m='2559800'>a</span> <span m='2559860'>different</span> <span m='2560100'>change</span>
  <span m='2560310'>on</span> <span m='2560430'>the</span> <span m='2560520'>same</span>
  <span m='2560730'>version.</span> </p><p><span m='2562690'>What</span> <span m='2562890'>I'd</span>
  <span m='2562980'>like</span> <span m='2563100'>to</span> <span m='2563220'>do</span>
  <span m='2563400'>is</span> <span m='2564200'>a</span> <span m='2564450'>traversal</span>
  <span m='2564930'>of</span> <span m='2565020'>that</span> <span m='2565170'>tree,</span>
  <span m='2565520'>like</span> <span m='2565680'>a</span> <span m='2565740'>regular,</span>
  <span m='2566670'>as</span> <span m='2566790'>if</span> <span m='2566910'>you're</span>
  <span m='2567000'>going</span> <span m='2567120'>to</span> <span m='2567180'>sort</span>
  <span m='2567420'>those</span> <span m='2567660'>nodes.</span> <span m='2568170'>Actually,</span>
  <span m='2568440'>let</span> <span m='2568560'>me</span> <span m='2569850'>use</span>
  <span m='2570030'>color,</span> <span m='2571300'>high</span> <span m='2571680'>def</span>
  <span m='2571980'>here.</span> <span m='2573420'>So</span> <span m='2574000'>here's</span>
  <span m='2574560'>our</span> <span m='2574800'>traversal</span> <span m='2575310'>of</span>
  <span m='2575430'>the</span> <span m='2575520'>tree.</span> <span m='2579030'>And</span>
  <span m='2579570'>I</span> <span m='2579660'>want</span> <span m='2579840'>to</span>
  <span m='2579900'>look</span> <span m='2580050'>at</span> <span m='2580140'>the</span>
  <span m='2580260'>first</span> <span m='2580860'>and</span> <span m='2580980'>the</span>
  <span m='2581070'>last</span> <span m='2581400'>time</span> <span m='2581700'>I</span>
  <span m='2581790'>visit</span> <span m='2582030'>each</span> <span m='2582210'>node.</span>
  </p><p><span m='2582730'>So</span> <span m='2583080'>here's</span> <span m='2583410'>the</span>
  <span m='2583530'>first</span> <span m='2583770'>time</span> <span m='2583980'>I</span>
  <span m='2584040'>visit</span> <span m='2584310'>x.</span> <span m='2585360'>So</span>
  <span m='2585710'>I'll</span> <span m='2585830'>write</span> <span m='2586530'>this</span>
  <span m='2586710'>is</span> <span m='2586770'>the</span> <span m='2586890'>beginning</span>
  <span m='2587340'>of</span> <span m='2587500'>x.</span> <span m='2589250'>Capital</span>
  <span m='2589630'>X.</span> <span m='2591150'>Then</span> <span m='2591720'>this</span>
  <span m='2591870'>is</span> <span m='2591930'>the</span> <span m='2592050'>first</span>
  <span m='2592320'>time</span> <span m='2592620'>I</span> <span m='2592710'>visit</span>
  <span m='2593070'>y,</span> <span m='2593550'>so</span> <span m='2593820'>it's beginning</span>
  <span m='2594090'>of</span> <span m='2594360'>y.</span> <span m='2595530'>And</span>
  <span m='2595680'>then</span> <span m='2595860'>this</span> <span m='2596010'>is</span>
  <span m='2596100'>the</span> <span m='2596190'>last</span> <span m='2596490'>time</span>
  <span m='2596720'>I</span> <span m='2596820'>visit</span> <span m='2597080'>y,</span>
  <span m='2597540'>so it's</span> <span m='2597690'>the end</span> <span m='2597990'>of</span>
  <span m='2598140'>y.</span> <span m='2599070'>And</span> <span m='2599250'>then,</span>
  <span m='2600000'>don't</span> <span m='2600120'>care.</span> <span m='2600770'>Then</span>
  <span m='2600930'>this</span> <span m='2601140'>is</span> <span m='2601530'>the</span>
  <span m='2601980'>beginning</span> <span m='2603270'>of</span> <span m='2603810'>z.</span>
  <span m='2604800'>And</span> <span m='2605010'>this</span> <span m='2605160'>is</span>
  <span m='2605340'>the</span> <span m='2605580'>end</span> <span m='2606060'>of</span>
  <span m='2606360'>z.</span> <span m='2607230'>And</span> <span m='2607320'>then</span>
  <span m='2607440'>this</span> <span m='2607590'>is</span> <span m='2607710'>the</span>
  <span m='2607860'>end</span> <span m='2608590'>x.</span> </p><p><span m='2609480'>If</span>
  <span m='2609630'>I</span> <span m='2609720'>write</span> <span m='2609930'>those</span>
  <span m='2610170'>sequentially,</span> <span m='2610860'>I</span> <span m='2611010'>get</span>
  <span m='2612050'>bxbyeybzez,</span> <span m='2618830'>because</span> <span m='2619050'>this</span>
  <span m='2619200'>is</span> <span m='2619260'>so</span> <span m='2619470'>easy,</span>
  <span m='2620880'>ex.</span> <span m='2622400'>OK,</span> <span m='2622550'>you</span>
  <span m='2622650'>can</span> <span m='2622770'>think</span> <span m='2622920'>of</span>
  <span m='2623010'>these</span> <span m='2623190'>as</span> <span m='2623340'>parentheses,</span>
  <span m='2624120'>right?</span> <span m='2625530'>For</span> <span m='2625710'>whatever</span>
  <span m='2625980'>reason</span> <span m='2626190'>I</span> <span m='2626250'>chose</span>
  <span m='2626490'>b</span> <span m='2626700'>and e</span> <span m='2626820'>for</span>
  <span m='2627180'>beginning</span> <span m='2627540'>and</span> <span m='2627630'>ending,</span>
  <span m='2628460'>but this</span> <span m='2628620'>is</span> <span m='2628770'>like</span>
  <span m='2628980'>open</span> <span m='2629250'>parens,</span> <span m='2629610'>close</span>
  <span m='2629840'>parens.</span> </p><p><span m='2630360'>This</span> <span m='2630570'>is</span>
  <span m='2630660'>easy</span> <span m='2630900'>to</span> <span m='2630990'>do</span>
  <span m='2631230'>in</span> <span m='2631380'>linear</span> <span m='2631620'>time.</span>
  <span m='2632310'>I think you</span> <span m='2632470'>all know</span> <span m='2632720'>how.</span>
  <span m='2633690'>Except</span> <span m='2634050'>it's</span> <span m='2634200'>not</span>
  <span m='2634320'>a</span> <span m='2634380'>static</span> <span m='2634710'>problem.</span>
  <span m='2635180'>Versions</span> <span m='2635550'>are</span> <span m='2635640'>changing</span>
  <span m='2636030'>all</span> <span m='2636150'>the</span> <span m='2636240'>time.</span>
  <span m='2636510'>We're</span> <span m='2636600'>adding</span> <span m='2636870'>versions.</span>
  <span m='2637500'>We're</span> <span m='2637590'>never</span> <span m='2637770'>deleting</span>
  <span m='2638100'>versions,</span> <span m='2638490'>but</span> <span m='2638640'>we're</span>
  <span m='2638760'>always</span> <span m='2638940'>adding</span> <span m='2639210'>stuff</span>
  <span m='2639510'>to</span> <span m='2639600'>here.</span> <span m='2640700'>It's</span>
  <span m='2640810'>a</span> <span m='2640860'>little</span> <span m='2641070'>awkward,</span>
  <span m='2641370'>but</span> <span m='2641520'>the</span> <span m='2641640'>idea</span>
  <span m='2641880'>is</span> <span m='2642090'>I</span> <span m='2642180'>want</span>
  <span m='2642300'>to</span> <span m='2642360'>maintain</span> <span m='2643470'>this</span>
  <span m='2643680'>order,</span> <span m='2645840'>maintain</span> <span m='2648900'>the</span>
  <span m='2648990'>begin</span> <span m='2651120'>and</span> <span m='2652020'>the</span>
  <span m='2652170'>end</span> <span m='2654030'>of</span> <span m='2654270'>each</span>
  <span m='2655920'>you</span> <span m='2656010'>might</span> <span m='2656160'>say</span>
  <span m='2656310'>subtree</span> <span m='2656940'>of</span> <span m='2657030'>versions.</span>
  </p><p><span m='2663520'>This</span> <span m='2663700'>string,</span> <span m='2664120'>from</span>
  <span m='2664330'>bx</span> <span m='2664780'>to</span> <span m='2664870'>ex,</span>
  <span m='2665260'>represents</span> <span m='2665770'>all</span> <span m='2666100'>of</span>
  <span m='2666190'>the</span> <span m='2666310'>stuff</span> <span m='2666670'>in</span>
  <span m='2666940'>x's</span> <span m='2667300'>subtree,</span> <span m='2668350'>in</span>
  <span m='2668770'>the</span> <span m='2668860'>rooted</span> <span m='2669160'>tree</span>
  <span m='2669820'>starting</span> <span m='2670210'>at</span> <span m='2670270'>x.</span>
  <span m='2673890'>How</span> <span m='2674000'>do</span> <span m='2674150'>I</span>
  <span m='2674240'>maintain</span> <span m='2674720'>that?</span> <span m='2680550'>Using</span>
  <span m='2680760'>a</span> <span m='2680820'>data</span> <span m='2681030'>structure.</span>
  </p><p><span m='2696490'>So</span> <span m='2697080'>we're</span> <span m='2697140'>going</span>
  <span m='2697260'>to</span> <span m='2697320'>use</span> <span m='2697500'>something,</span>
  <span m='2699450'>a</span> <span m='2699510'>data</span> <span m='2699750'>structure</span>
  <span m='2700200'>we</span> <span m='2700380'>haven't</span> <span m='2700650'>yet</span>
  <span m='2700830'>seen.</span> <span m='2702210'>It</span> <span m='2702390'>will</span>
  <span m='2702510'>be</span> <span m='2702840'>in</span> <span m='2703500'>lecture</span>
  <span m='2703890'>8.</span> <span m='2705120'>This</span> <span m='2705300'>is</span>
  <span m='2705380'>a</span> <span m='2705450'>time</span> <span m='2705690'>travel</span>
  <span m='2705960'>data</span> <span m='2706140'>structure,</span> <span m='2706440'>so</span>
  <span m='2706920'>I'm</span> <span m='2707100'>allowed</span> <span m='2707340'>to</span>
  <span m='2707400'>do</span> <span m='2707550'>that.</span> <span m='2710280'>So</span>
  <span m='2710760'>order</span> <span m='2711090'>maintenance</span> <span m='2711540'>data</span>
  <span m='2711750'>structure.</span> </p><p><span m='2714150'>You</span> <span m='2714300'>can</span>
  <span m='2714420'>think</span> <span m='2714600'>of</span> <span m='2714660'>this</span>
  <span m='2714870'>as</span> <span m='2715020'>a</span> <span m='2715110'>magical</span>
  <span m='2715710'>linked</span> <span m='2716010'>list.</span> <span m='2716970'>Let</span>
  <span m='2717060'>me</span> <span m='2717180'>tell</span> <span m='2717330'>you</span>
  <span m='2717420'>what</span> <span m='2717570'>the</span> <span m='2717660'>magical</span>
  <span m='2718020'>linked</span> <span m='2718230'>list</span> <span m='2718410'>can</span>
  <span m='2718560'>do.</span> <span m='2719520'>You</span> <span m='2719700'>can</span>
  <span m='2720450'>insert--</span> <span m='2723020'>I'm</span> <span m='2723110'>going</span>
  <span m='2723300'>to</span> <span m='2723360'>call</span> <span m='2723540'>it</span>
  <span m='2723630'>an</span> <span m='2723720'>item,</span> <span m='2724110'>because</span>
  <span m='2724320'>node</span> <span m='2724620'>would</span> <span m='2724730'>be</span>
  <span m='2724860'>kind</span> <span m='2725100'>of</span> <span m='2725250'>confusing</span>
  <span m='2725850'>given</span> <span m='2726090'>where</span> <span m='2726240'>we</span>
  <span m='2726840'>are</span> <span m='2726990'>right</span> <span m='2727140'>now.</span>
  <span m='2728640'>You</span> <span m='2728730'>can</span> <span m='2729300'>insert</span>
  <span m='2729600'>a</span> <span m='2729660'>new</span> <span m='2729840'>item</span>
  <span m='2730080'>in</span> <span m='2730140'>the</span> <span m='2730230'>list</span>
  <span m='2731190'>immediately</span> <span m='2731730'>before</span> <span m='2732480'>or</span>
  <span m='2732600'>after</span> <span m='2734010'>a</span> <span m='2734130'>given</span>
  <span m='2734400'>item.</span> </p><p><span m='2737500'>OK.</span> <span m='2737910'>This</span>
  <span m='2738090'>is</span> <span m='2738210'>like</span> <span m='2738390'>a</span>
  <span m='2738450'>regular</span> <span m='2738750'>linked</span> <span m='2738960'>list.</span>
  <span m='2741390'>Here's</span> <span m='2741600'>a</span> <span m='2741690'>regular</span>
  <span m='2741930'>linked</span> <span m='2742140'>list.</span> <span m='2744750'>And</span>
  <span m='2745590'>if</span> <span m='2745800'>I'm</span> <span m='2746250'>given</span>
  <span m='2746730'>a</span> <span m='2746820'>particular</span> <span m='2747360'>item</span>
  <span m='2747660'>like</span> <span m='2747810'>this</span> <span m='2747990'>one,</span>
  <span m='2748290'>I</span> <span m='2748650'>can</span> <span m='2748770'>say,</span>
  <span m='2748950'>well,</span> <span m='2749100'>insert</span> <span m='2749610'>a</span>
  <span m='2749670'>new</span> <span m='2749940'>item</span> <span m='2750240'>right</span>
  <span m='2750390'>here.</span> <span m='2751190'>You</span> <span m='2751260'>say,</span>
  <span m='2751440'>OK.</span> <span m='2751830'>Fine.</span> <span m='2752220'>I'll</span>
  <span m='2752310'>just</span> <span m='2752460'>make</span> <span m='2752640'>a</span>
  <span m='2752700'>new</span> <span m='2752790'>node</span> <span m='2753750'>and</span>
  <span m='2754350'>relink</span> <span m='2755090'>here,</span> <span m='2756080'>relink</span>
  <span m='2756490'>there.</span> <span m='2757060'>Constant</span> <span m='2757360'>time,</span>
  <span m='2757660'>right?</span> </p><p><span m='2758190'>So</span> <span m='2758850'>in</span>
  <span m='2759010'>an</span> <span m='2759090'>order</span> <span m='2759270'>maintenance</span>
  <span m='2759570'>data</span> <span m='2759720'>structure,</span> <span m='2760050'>you</span>
  <span m='2760170'>can</span> <span m='2760290'>do</span> <span m='2760380'>this</span>
  <span m='2760590'>in</span> <span m='2760740'>constant</span> <span m='2761220'>time.</span>
  <span m='2761940'>Wow!</span> <span m='2762900'>So</span> <span m='2763170'>amazing.</span>
  <span m='2765180'>OK,</span> <span m='2765450'>catch</span> <span m='2766280'>is</span>
  <span m='2766440'>the</span> <span m='2766530'>second</span> <span m='2766830'>operation</span>
  <span m='2767340'>you</span> <span m='2767460'>can</span> <span m='2767610'>do.</span>
  <span m='2768540'>Maybe</span> <span m='2768780'>I'll</span> <span m='2768850'>number</span>
  <span m='2769170'>these.</span> <span m='2769410'>This</span> <span m='2769620'>is</span>
  <span m='2769710'>the</span> <span m='2769860'>update.</span> <span m='2770970'>Then</span>
  <span m='2771120'>there's</span> <span m='2771270'>the</span> <span m='2771390'>query.</span>
  </p><p><span m='2773490'>The</span> <span m='2773610'>query</span> <span m='2774120'>is,</span>
  <span m='2774450'>what</span> <span m='2774780'>is</span> <span m='2775140'>the</span>
  <span m='2775260'>relative</span> <span m='2775830'>order</span> <span m='2777990'>of</span>
  <span m='2778170'>two</span> <span m='2778350'>notes,</span> <span m='2779670'>of</span>
  <span m='2779790'>two</span> <span m='2780090'>items?</span> <span m='2784700'>x</span>
  <span m='2785000'>and</span> <span m='2785120'>y.</span> <span m='2787090'>So</span>
  <span m='2787430'>now</span> <span m='2787730'>I</span> <span m='2787790'>give</span>
  <span m='2788000'>you</span> <span m='2788120'>this</span> <span m='2788390'>node</span>
  <span m='2788660'>and</span> <span m='2788780'>this</span> <span m='2789000'>node.</span>
  <span m='2789980'>And</span> <span m='2790130'>I</span> <span m='2790220'>say,</span>
  <span m='2790580'>which</span> <span m='2790820'>is</span> <span m='2790940'>to</span>
  <span m='2791090'>the</span> <span m='2791210'>left?</span> <span m='2792420'>Which</span>
  <span m='2792470'>is</span> <span m='2792590'>earlier</span> <span m='2793010'>in</span>
  <span m='2793130'>the</span> <span m='2793220'>order?</span> <span m='2794030'>I</span>
  <span m='2794090'>want</span> <span m='2794210'>to</span> <span m='2794270'>know,</span>
  <span m='2794450'>is</span> <span m='2794660'>x</span> <span m='2794990'>basically</span>
  <span m='2795290'>less</span> <span m='2795620'>than</span> <span m='2795770'>y</span>
  <span m='2796070'>in</span> <span m='2796160'>terms</span> <span m='2796370'>of</span>
  <span m='2796430'>the</span> <span m='2796550'>order</span> <span m='2796820'>in</span>
  <span m='2796910'>the</span> <span m='2796970'>list?</span> <span m='2797690'>Or</span>
  <span m='2797840'>is</span> <span m='2797960'>y</span> <span m='2798200'>less</span>
  <span m='2798440'>than</span> <span m='2798540'>x?</span> </p><p><span m='2801410'>And
  an</span> <span m='2801650'>order</span> <span m='2801890'>maintenance</span> <span
  m='2802250'>data</span> <span m='2802430'>structure</span> <span m='2802760'>can</span>
  <span m='2802910'>do</span> <span m='2803000'>this</span> <span m='2803240'>in</span>
  <span m='2803810'>constant</span> <span m='2804230'>time.</span> <span m='2805910'>Now</span>
  <span m='2806180'>it</span> <span m='2806240'>doesn't</span> <span m='2806480'>look</span>
  <span m='2806810'>like</span> <span m='2808010'>your</span> <span m='2808780'>mother's</span>
  <span m='2809120'>linked</span> <span m='2809330'>list,</span> <span m='2809750'>I</span>
  <span m='2809840'>guess.</span> <span m='2810530'>It's</span> <span m='2810650'>not</span>
  <span m='2810830'>the</span> <span m='2810890'>link</span> <span m='2811050'>list</span>
  <span m='2811310'>you</span> <span m='2811400'>learned</span> <span m='2811610'>in</span>
  <span m='2811700'>school.</span> <span m='2812360'>It's</span> <span m='2812510'>a</span>
  <span m='2812570'>magical</span> <span m='2812885'>linked</span> <span m='2813200'>list</span>
  <span m='2813890'>that</span> <span m='2814040'>can</span> <span m='2814220'>somehow</span>
  <span m='2814700'>answer</span> <span m='2814970'>these</span> <span m='2815150'>queries.</span>
  <span m='2815810'>How?</span> <span m='2816510'>Go</span> <span m='2816700'>to</span>
  <span m='2816800'>lecture</span> <span m='2817070'>7.</span> <span m='2818801'>OK.</span>
  <span m='2819270'>Forward</span> <span m='2819830'>reference,</span> <span m='2820850'>lecture</span>
  <span m='2821120'>8,</span> <span m='2821300'>sorry.</span> </p><p><span m='2823460'>For</span>
  <span m='2823610'>now,</span> <span m='2823850'>we're</span> <span m='2823940'>just</span>
  <span m='2824090'>going</span> <span m='2824210'>to</span> <span m='2824270'>assume</span>
  <span m='2824510'>that</span> <span m='2824660'>this</span> <span m='2825020'>magical</span>
  <span m='2825410'>data</span> <span m='2825590'>structure</span> <span m='2825920'>exists.</span>
  <span m='2826740'>So</span> <span m='2826790'>in</span> <span m='2826880'>constant</span>
  <span m='2827270'>time,</span> <span m='2828770'>this</span> <span m='2828920'>is</span>
  <span m='2829020'>great.</span> <span m='2829340'>Because</span> <span m='2829610'>if
  we're</span> <span m='2829760'>maintaining</span> <span m='2830270'>these</span>
  <span m='2830930'>b's</span> <span m='2831200'>and</span> <span m='2831340'>e's,</span>
  <span m='2831590'>we</span> <span m='2831680'>want</span> <span m='2831860'>to</span>
  <span m='2831920'>maintain</span> <span m='2832940'>the</span> <span m='2833030'>order</span>
  <span m='2834830'>that</span> <span m='2835010'>these</span> <span m='2835190'>things</span>
  <span m='2835370'>appear</span> <span m='2835700'>in.</span> <span m='2836090'>If</span>
  <span m='2836300'>we</span> <span m='2836360'>want</span> <span m='2836570'>to</span>
  <span m='2836630'>create</span> <span m='2836960'>a</span> <span m='2837020'>new</span>
  <span m='2837170'>version,</span> <span m='2837620'>like</span> <span m='2837740'>suppose</span>
  <span m='2838070'>we</span> <span m='2838130'>were</span> <span m='2838250'>just</span>
  <span m='2838550'>creating</span> <span m='2838970'>version</span> <span m='2839330'>z,</span>
  <span m='2840410'>well,</span> <span m='2840590'>it</span> <span m='2840650'>used</span>
  <span m='2840860'>to</span> <span m='2840950'>be</span> <span m='2841100'>everything</span>
  <span m='2841580'>without</span> <span m='2841970'>this</span> <span m='2842150'>bz,</span>
  <span m='2842390'>ez.</span> <span m='2843140'>And</span> <span m='2843280'>we'd</span>
  <span m='2843410'>just</span> <span m='2843620'>insert</span> <span m='2844040'>two</span>
  <span m='2844790'>items</span> <span m='2845210'>in</span> <span m='2845300'>here,</span>
  <span m='2845450'>bz</span> <span m='2845610'>and</span> <span m='2845930'>ez.</span>
  </p><p><span m='2847590'>They're</span> <span m='2847700'>right</span> <span m='2847880'>next</span>
  <span m='2848060'>to</span> <span m='2848120'>each</span> <span m='2848270'>other.</span>
  <span m='2848590'>And</span> <span m='2848600'>if</span> <span m='2848720'>we</span>
  <span m='2848820'>were</span> <span m='2848900'>given</span> <span m='2849380'>version</span>
  <span m='2849770'>x,</span> <span m='2850250'>we</span> <span m='2850340'>could</span>
  <span m='2850460'>just</span> <span m='2850610'>say,</span> <span m='2850820'>oh,</span>
  <span m='2851030'>we'll</span> <span m='2851180'>look</span> <span m='2851420'>at</span>
  <span m='2851550'>ex</span> <span m='2852620'>and</span> <span m='2852740'>insert</span>
  <span m='2853010'>two</span> <span m='2853220'>items</span> <span m='2853460'>right</span>
  <span m='2853670'>before</span> <span m='2854090'>it.</span> <span m='2854300'>Or</span>
  <span m='2854450'>you</span> <span m='2854540'>can</span> <span m='2854660'>put</span>
  <span m='2854810'>them</span> <span m='2854930'>right</span> <span m='2855110'>after</span>
  <span m='2855850'>bx.</span> <span m='2856280'>I</span> <span m='2856340'>mean,</span>
  <span m='2856430'>there's</span> <span m='2856550'>no</span> <span m='2856700'>actual</span>
  <span m='2856970'>order</span> <span m='2857240'>here.</span> <span m='2857610'>So</span>
  <span m='2857660'>it</span> <span m='2857720'>could</span> <span m='2857870'>have</span>
  <span m='2857960'>been</span> <span m='2858260'>y</span> <span m='2858530'>first</span>
  <span m='2858830'>and</span> <span m='2858920'>then</span> <span m='2859070'>z</span>
  <span m='2859900'>or</span> <span m='2860030'>z</span> <span m='2860210'>first</span>
  <span m='2860480'>and</span> <span m='2860570'>then</span> <span m='2860690'>y.</span>
  </p><p><span m='2862070'>So</span> <span m='2862190'>it's</span> <span m='2862280'>really</span>
  <span m='2862520'>easy</span> <span m='2862760'>to</span> <span m='2862970'>add</span>
  <span m='2863180'>a</span> <span m='2863240'>new</span> <span m='2863390'>version</span>
  <span m='2863900'>in</span> <span m='2864020'>constant</span> <span m='2864380'>time.</span>
  <span m='2864610'>You</span> <span m='2864680'>just</span> <span m='2864860'>do</span>
  <span m='2865070'>two</span> <span m='2865340'>of</span> <span m='2865430'>these</span>
  <span m='2865640'>insert</span> <span m='2865970'>operations.</span> <span m='2867590'>And</span>
  <span m='2867710'>now</span> <span m='2868490'>you</span> <span m='2868580'>have</span>
  <span m='2868670'>this</span> <span m='2868790'>magical</span> <span m='2869210'>order</span>
  <span m='2869540'>operation,</span> <span m='2870440'>which</span> <span m='2870680'>if</span>
  <span m='2870860'>I'm</span> <span m='2871070'>given</span> <span m='2871400'>two</span>
  <span m='2871640'>versions--</span> <span m='2874500'>I</span> <span m='2874600'>don't</span>
  <span m='2874700'>know,</span> <span m='2874850'>v</span> <span m='2875150'>and</span>
  <span m='2875260'>w--</span> <span m='2876800'>and</span> <span m='2876980'>I</span>
  <span m='2877040'>want</span> <span m='2877220'>to</span> <span m='2877280'>know</span>
  <span m='2877610'>is</span> <span m='2877910'>v</span> <span m='2878180'>an</span>
  <span m='2878300'>ancestor</span> <span m='2878960'>of</span> <span m='2879050'>w,</span>
  <span m='2880250'>now</span> <span m='2880430'>I</span> <span m='2880520'>can</span>
  <span m='2880700'>do</span> <span m='2880820'>it</span> <span m='2880880'>in</span>
  <span m='2881000'>constant</span> <span m='2881420'>time.</span> <span m='2882390'>So</span>
  <span m='2882470'>this</span> <span m='2882680'>lets</span> <span m='2882980'>me</span>
  <span m='2883130'>do</span> <span m='2883520'>a</span> <span m='2884000'>third</span>
  <span m='2884300'>operation,</span> <span m='2885980'>which</span> <span m='2886280'>is,</span>
  <span m='2888290'>is</span> <span m='2889220'>version</span> <span m='2889700'>v</span>
  <span m='2893690'>an</span> <span m='2893810'>ancestor</span> <span m='2898150'>of</span>
  <span m='2898970'>version</span> <span m='2899390'>w?</span> </p><p><span m='2901850'>Because</span>
  <span m='2902750'>that's</span> <span m='2902960'>going</span> <span m='2903070'>to</span>
  <span m='2903140'>be</span> <span m='2903230'>true</span> <span m='2903650'>if</span>
  <span m='2903860'>and</span> <span m='2903950'>only</span> <span m='2904220'>if</span>
  <span m='2904880'>bv</span> <span m='2906350'>is</span> <span m='2907980'>an</span>
  <span m='2908310'>ev</span> <span m='2912550'>nest</span> <span m='2913120'>around</span>
  <span m='2914480'>bw</span> <span m='2916540'>and</span> <span m='2916900'>ew.</span>
  <span m='2919710'>OK.</span> <span m='2920290'>So</span> <span m='2920440'>that's</span>
  <span m='2920650'>just</span> <span m='2921280'>three</span> <span m='2921550'>tests.</span>
  <span m='2921920'>They're</span> <span m='2922210'>probably</span> <span m='2922480'>not</span>
  <span m='2922630'>all</span> <span m='2922770'>even</span> <span m='2922960'>necessary.</span>
  <span m='2923980'>This</span> <span m='2924160'>one</span> <span m='2924310'>always</span>
  <span m='2924580'>holds.</span> <span m='2925390'>But</span> <span m='2925570'>if</span>
  <span m='2926560'>these</span> <span m='2926800'>guys</span> <span m='2927220'>fit</span>
  <span m='2927490'>in</span> <span m='2927600'>between</span> <span m='2928450'>these</span>
  <span m='2928660'>guys,</span> <span m='2929530'>then</span> <span m='2929800'>you</span>
  <span m='2929920'>know--</span> <span m='2930670'>now,</span> <span m='2931000'>what</span>
  <span m='2931180'>this</span> <span m='2931330'>tells</span> <span m='2931690'>us,</span>
  <span m='2932900'>what</span> <span m='2933160'>we</span> <span m='2933280'>care</span>
  <span m='2933490'>about</span> <span m='2933760'>here,</span> <span m='2934810'>is</span>
  <span m='2935830'>reading</span> <span m='2936640'>fields.</span> </p><p><span m='2938020'>When</span>
  <span m='2938170'>we</span> <span m='2938260'>read</span> <span m='2938440'>a</span>
  <span m='2938530'>field,</span> <span m='2938860'>we</span> <span m='2938950'>said,</span>
  <span m='2939190'>oh,</span> <span m='2939370'>we'll</span> <span m='2940300'>apply</span>
  <span m='2940750'>all</span> <span m='2940870'>the</span> <span m='2940960'>modifications</span>
  <span m='2941710'>that</span> <span m='2941950'>apply</span> <span m='2942250'>to</span>
  <span m='2942370'>version</span> <span m='2942670'>v.</span> <span m='2943240'>Before</span>
  <span m='2943600'>that,</span> <span m='2943690'>that was</span> <span m='2943830'>a</span>
  <span m='2943910'>linear</span> <span m='2944140'>order.</span> <span m='2944510'>So</span>
  <span m='2944560'>it's</span> <span m='2944650'>just</span> <span m='2944800'>all</span>
  <span m='2944980'>versions</span> <span m='2945340'>less</span> <span m='2945520'>than
  or</span> <span m='2945690'>equal</span> <span m='2945880'>to v.</span> <span m='2946540'>Now</span>
  <span m='2946900'>it's</span> <span m='2947080'>all</span> <span m='2947290'>versions</span>
  <span m='2947680'>that</span> <span m='2947830'>are</span> <span m='2948070'>ancestors</span>
  <span m='2948435'>of</span> <span m='2948800'>v.</span> <span m='2950090'>Given</span>
  <span m='2950470'>a</span> <span m='2950540'>mod,</span> <span m='2950800'>we</span>
  <span m='2950890'>need</span> <span m='2951070'>to</span> <span m='2951130'>know,</span>
  <span m='2951310'>does</span> <span m='2951580'>this</span> <span m='2951790'>mod</span>
  <span m='2952135'>apply</span> <span m='2952480'>to</span> <span m='2952600'>my</span>
  <span m='2952810'>version?</span> </p><p><span m='2953830'>And</span> <span m='2953950'>now</span>
  <span m='2954250'>I</span> <span m='2954310'>tell</span> <span m='2954550'>you,</span>
  <span m='2954730'>I</span> <span m='2954820'>can</span> <span m='2954940'>do</span>
  <span m='2955060'>that</span> <span m='2955180'>in</span> <span m='2955240'>constant</span>
  <span m='2955630'>time</span> <span m='2956560'>through</span> <span m='2956800'>magic.</span>
  <span m='2957610'>I</span> <span m='2957760'>just</span> <span m='2958150'>test</span>
  <span m='2958990'>these</span> <span m='2959230'>order</span> <span m='2959770'>relations.</span>
  <span m='2960340'>If</span> <span m='2960520'>they</span> <span m='2960640'>hold,</span>
  <span m='2961120'>then</span> <span m='2961300'>that</span> <span m='2961600'>mod</span>
  <span m='2961890'>applies</span> <span m='2962680'>to</span> <span m='2962800'>my</span>
  <span m='2962980'>version.</span> <span m='2964360'>So</span> <span m='2965920'>w's</span>
  <span m='2966370'>the</span> <span m='2966430'>version</span> <span m='2966700'>we're</span>
  <span m='2966820'>testing.</span> <span m='2967360'>v</span> <span m='2967590'>is</span>
  <span m='2967720'>some</span> <span m='2968020'>version</span> <span m='2968380'>in</span>
  <span m='2968530'>the</span> <span m='2968620'>mod.</span> <span m='2969430'>And</span>
  <span m='2969580'>I</span> <span m='2969630'>want</span> <span m='2969790'>to</span>
  <span m='2969850'>know,</span> <span m='2970370'>am</span> <span m='2970480'>descendant</span>
  <span m='2971230'>of</span> <span m='2971440'>that</span> <span m='2971620'>version?</span>
  <span m='2972070'>If</span> <span m='2972160'>so,</span> <span m='2972850'>the</span>
  <span m='2972940'>mod</span> <span m='2973140'>applies.</span> <span m='2974100'>And</span>
  <span m='2974290'>I</span> <span m='2974380'>update</span> <span m='2975720'>what</span>
  <span m='2975850'>the</span> <span m='2975940'>field</span> <span m='2976240'>is.</span>
  </p><p><span m='2976630'>I</span> <span m='2976720'>can</span> <span m='2976870'>do</span>
  <span m='2977020'>all</span> <span m='2977200'>pairwise</span> <span m='2977830'>ancestor</span>
  <span m='2978310'>checks</span> <span m='2978610'>and</span> <span m='2978730'>figure</span>
  <span m='2978940'>out,</span> <span m='2979030'>what</span> <span m='2979150'>is</span>
  <span m='2979270'>the</span> <span m='2980110'>most</span> <span m='2980560'>recent</span>
  <span m='2980980'>version</span> <span m='2981370'>in</span> <span m='2981490'>my</span>
  <span m='2981700'>ancestor</span> <span m='2982210'>history</span> <span m='2983200'>that</span>
  <span m='2983320'>modified</span> <span m='2983830'>a</span> <span m='2983890'>given</span>
  <span m='2984130'>field?</span> <span m='2984850'>That</span> <span m='2984970'>lets</span>
  <span m='2985150'>me</span> <span m='2985300'>read</span> <span m='2985450'>a</span>
  <span m='2985480'>field</span> <span m='2986140'>in</span> <span m='2986320'>constant</span>
  <span m='2986830'>time.</span> <span m='2987370'>Constants</span> <span m='2987760'>are</span>
  <span m='2987850'>getting</span> <span m='2988090'>kind</span> <span m='2988240'>of</span>
  <span m='2988330'>big</span> <span m='2988540'>at</span> <span m='2988630'>this</span>
  <span m='2988780'>point,</span> <span m='2989080'>but</span> <span m='2989290'>it</span>
  <span m='2989560'>can</span> <span m='2989740'>be</span> <span m='2989830'>done.</span>
  </p><p><span m='2993270'>Clear?</span> <span m='2994550'>A</span> <span m='2994870'>little</span>
  <span m='2995080'>bit</span> <span m='2995170'>of</span> <span m='2995260'>a</span>
  <span m='2995290'>black</span> <span m='2995560'>box</span> <span m='2996190'>here.</span>
  <span m='2996850'>But</span> <span m='2997900'>now</span> <span m='2998950'>we've</span>
  <span m='2999220'>gotten</span> <span m='2999490'>as</span> <span m='2999610'>far</span>
  <span m='2999760'>as</span> <span m='2999880'>reading.</span> <span m='3001920'>And</span>
  <span m='3002130'>we</span> <span m='3002220'>don't</span> <span m='3002370'>need</span>
  <span m='3002490'>to</span> <span m='3002580'>change</span> <span m='3003270'>much</span>
  <span m='3003510'>else.</span> <span m='3004750'>So</span> <span m='3005010'>this</span>
  <span m='3005170'>is</span> <span m='3005340'>good</span> <span m='3005520'>news</span>
  </p><p><span m='3011780'>Maybe I'll</span> <span m='3011850'>give</span> <span m='3012030'>you</span>
  <span m='3012090'>a</span> <span m='3012150'>bit</span> <span m='3012270'>of</span>
  <span m='3012390'>a</span> <span m='3012450'>diff.</span> <span m='3015280'>So</span>
  <span m='3016980'>full</span> <span m='3017370'>persistence,</span> <span m='3021770'>fully</span>
  <span m='3022160'>persistent</span> <span m='3025680'>theorem--</span> <span m='3026340'>done.</span>
  <span m='3027210'>OK.</span> <span m='3027710'>Same</span> <span m='3028010'>theorem</span>
  <span m='3028640'>just</span> <span m='3028820'>with</span> <span m='3028910'>full</span>
  <span m='3029090'>persistence.</span> </p><p><span m='3030080'>How</span> <span
  m='3030200'>do</span> <span m='3030320'>we</span> <span m='3030410'>do</span> <span
  m='3030590'>it?</span> <span m='3031230'>We</span> <span m='3031330'>store</span>
  <span m='3031460'>back</span> <span m='3031730'>pointers</span> <span m='3032540'>now</span>
  <span m='3032810'>for</span> <span m='3032990'>all</span> <span m='3033170'>versions.</span>
  <span m='3035542'>It's</span> <span m='3036000'>a</span> <span m='3036040'>little</span>
  <span m='3036260'>bit</span> <span m='3036380'>annoying.</span> <span m='3036870'>But</span>
  <span m='3037610'>how</span> <span m='3037790'>many</span> <span m='3038030'>mods</span>
  <span m='3038480'>do</span> <span m='3038600'>we</span> <span m='3038720'>use?</span>
  <span m='3041090'>There's</span> <span m='3041240'>lots</span> <span m='3041450'>of</span>
  <span m='3041510'>ways</span> <span m='3041690'>to</span> <span m='3041780'>get</span>
  <span m='3041930'>this</span> <span m='3042080'>to</span> <span m='3042200'>work,</span>
  <span m='3042540'>but</span> <span m='3042740'>I'm</span> <span m='3042980'>going</span>
  <span m='3043220'>to</span> <span m='3043340'>change</span> <span m='3043730'>this</span>
  <span m='3043940'>number</span> <span m='3044890'>to</span> <span m='3047870'>2</span>
  <span m='3048170'>times</span> <span m='3048590'>d</span> <span m='3049070'>plus</span>
  <span m='3049640'>p</span> <span m='3050150'>plus</span> <span m='3050820'>1.</span>
  <span m='3051702'>Wait,</span> <span m='3052194'>what's</span> <span m='3052686'>d?</span>
  <span m='3053180'>d</span> <span m='3053450'>is</span> <span m='3053600'>the</span>
  <span m='3053780'>number</span> <span m='3054080'>of</span> <span m='3054140'>fields</span>
  <span m='3054650'>here.</span> <span m='3056450'>OK.</span> <span m='3057140'>We</span>
  <span m='3057290'>said</span> <span m='3057470'>it</span> <span m='3057530'>was</span>
  <span m='3057680'>constant</span> <span m='3058370'>number</span> <span m='3058650'>fields.</span>
  <span m='3059150'>I</span> <span m='3059210'>never</span> <span m='3059450'>said</span>
  <span m='3059600'>what</span> <span m='3059690'>that</span> <span m='3059840'>constant</span>
  <span m='3060170'>is.</span> <span m='3060350'>d</span> <span m='3060620'>for</span>
  <span m='3060905'>out</span> <span m='3061190'>degree,</span> <span m='3061640'>I</span>
  <span m='3061700'>guess.</span> </p><p><span m='3063680'>So</span> <span m='3063830'>p</span>
  <span m='3064040'>is</span> <span m='3064160'>in</span> <span m='3064280'>degree,</span>
  <span m='3064940'>max in</span> <span m='3065270'>degree.</span> <span m='3065600'>d</span>
  <span m='3065900'>is</span> <span m='3066710'>max</span> <span m='3066950'>out</span>
  <span m='3067130'>degree.</span> <span m='3069470'>So</span> <span m='3069650'>just</span>
  <span m='3069830'>slightly</span> <span m='3070160'>more--</span> <span m='3070370'>that</span>
  <span m='3070520'>main</span> <span m='3070790'>reason</span> <span m='3071000'>for</span>
  <span m='3071120'>this</span> <span m='3071330'>is</span> <span m='3071420'>because</span>
  <span m='3071750'>back</span> <span m='3071990'>pointers</span> <span m='3072380'>now</span>
  <span m='3072650'>are</span> <span m='3072740'>treated</span> <span m='3073010'>like</span>
  <span m='3073190'>everyone</span> <span m='3073520'>else.</span> <span m='3074450'>We</span>
  <span m='3074600'>have</span> <span m='3074690'>to</span> <span m='3074810'>treat</span>
  <span m='3075800'>both</span> <span m='3076040'>the</span> <span m='3076190'>out</span>
  <span m='3076370'>pointers</span> <span m='3076730'>and</span> <span m='3076880'>the
  in</span> <span m='3077090'>pointers</span> <span m='3077480'>as</span> <span m='3077570'>basically</span>
  <span m='3077930'>the</span> <span m='3078020'>same.</span> <span m='3078350'>So</span>
  <span m='3078580'>instead</span> <span m='3078700'>of p,</span> <span m='3079040'>we</span>
  <span m='3079160'>have</span> <span m='3079310'>d plus</span> <span m='3079670'>p.</span>
  <span m='3079880'>And</span> <span m='3079970'>there's</span> <span m='3080120'>a</span>
  <span m='3080180'>plus</span> <span m='3080450'>1</span> <span m='3080660'>just</span>
  <span m='3080810'>for</span> <span m='3081530'>safety.</span> <span m='3083231'>It</span>
  <span m='3084140'>gets</span> <span m='3084350'>my</span> <span m='3084510'>amortization</span>
  <span m='3085070'>to</span> <span m='3085190'>work,</span> <span m='3086350'>hopefully.</span>
  </p><p><span m='3088330'>OK.</span> <span m='3089320'>Not</span> <span m='3089660'>much</span>
  <span m='3089870'>else--</span> <span m='3090440'>this</span> <span m='3090920'>page</span>
  <span m='3091250'>is</span> <span m='3091340'>all</span> <span m='3091490'>the</span>
  <span m='3091610'>same.</span> <span m='3092430'>Mods</span> <span m='3092820'>are</span>
  <span m='3092930'>still,</span> <span m='3093350'>you give</span> <span m='3093720'>versions,</span>
  <span m='3094250'>fields,</span> <span m='3094580'>values,</span> <span m='3095830'>reading.</span>
  <span m='3096620'>OK,</span> <span m='3096860'>well,</span> <span m='3098240'>this</span>
  <span m='3098420'>is</span> <span m='3098510'>no</span> <span m='3098630'>longer</span>
  <span m='3098840'>less than or</span> <span m='3099100'>equal</span> <span m='3099310'>to</span>
  <span m='3099500'>v.</span> <span m='3100310'>But</span> <span m='3101030'>this</span>
  <span m='3101240'>is</span> <span m='3101330'>now</span> <span m='3101510'>with</span>
  <span m='3101630'>a</span> <span m='3101690'>version,</span> <span m='3102980'>sort</span>
  <span m='3103160'>of</span> <span m='3103250'>the</span> <span m='3103640'>nearest</span>
  <span m='3104000'>version,</span> <span m='3106820'>that's</span> <span m='3107060'>an</span>
  <span m='3107180'>ancestor</span> <span m='3107780'>of</span> <span m='3107840'>v.</span>
  </p><p><span m='3110660'>That's</span> <span m='3110900'>what</span> <span m='3110990'>we</span>
  <span m='3111140'>were</span> <span m='3111260'>just</span> <span m='3111380'>talking</span>
  <span m='3111710'>about.</span> <span m='3112860'>So</span> <span m='3112930'>that</span>
  <span m='3113060'>can</span> <span m='3113210'>be</span> <span m='3113300'>done</span>
  <span m='3113450'>in</span> <span m='3113540'>constant</span> <span m='3113900'>time.</span>
  <span m='3114260'>Check</span> <span m='3114500'>it</span> <span m='3114560'>for</span>
  <span m='3114710'>all</span> <span m='3114830'>of</span> <span m='3114890'>them,</span>
  <span m='3115130'>constant</span> <span m='3115520'>work.</span> <span m='3117400'>OK.</span>
  <span m='3118130'>That</span> <span m='3118490'>was</span> <span m='3119870'>the</span>
  <span m='3119960'>first</span> <span m='3120200'>part.</span> </p><p><span m='3124710'>Now</span>
  <span m='3124840'>we</span> <span m='3124930'>get</span> <span m='3125050'>to</span>
  <span m='3125140'>the</span> <span m='3125230'>hard</span> <span m='3125410'>part,</span>
  <span m='3125620'>which</span> <span m='3125800'>is</span> <span m='3125920'>modification.</span>
  <span m='3127550'>This</span> <span m='3127690'>is</span> <span m='3127840'>going</span>
  <span m='3127990'>to</span> <span m='3128050'>be</span> <span m='3128110'>different.</span>
  <span m='3128410'>Maybe</span> <span m='3128650'>you</span> <span m='3128770'>I
  should</span> <span m='3128920'>just</span> <span m='3129160'>erase--</span> <span
  m='3130810'>yeah,</span> <span m='3131050'>I</span> <span m='3131080'>think</span>
  <span m='3131260'>I'll</span> <span m='3131380'>erase</span> <span m='3131650'>everything,</span>
  <span m='3133690'>except</span> <span m='3133930'>the</span> <span m='3134290'>first</span>
  <span m='3134580'>clause.</span> </p><p><span m='3144270'>OK.</span> <span m='3144890'>If</span>
  <span m='3145110'>a</span> <span m='3145280'>node</span> <span m='3145470'>is</span>
  <span m='3145730'>not</span> <span m='3146030'>full,</span> <span m='3146450'>we'll</span>
  <span m='3146630'>just</span> <span m='3146910'>add a mod,</span> <span m='3147410'>just</span>
  <span m='3147620'>like</span> <span m='3147770'>before.</span> <span m='3148460'>What</span>
  <span m='3148610'>changes</span> <span m='3149180'>is</span> <span m='3149390'>when</span>
  <span m='3149810'>a</span> <span m='3149870'>node</span> <span m='3150590'>is</span>
  <span m='3150780'>full.</span> <span m='3156000'>Here</span> <span m='3156150'>we</span>
  <span m='3156270'>have</span> <span m='3156390'>to</span> <span m='3156480'>do</span>
  <span m='3156630'>something</span> <span m='3156990'>completely</span> <span m='3157380'>different.</span>
  <span m='3158220'>Why?</span> <span m='3158910'>Because</span> <span m='3159210'>if</span>
  <span m='3159360'>we</span> <span m='3159480'>just</span> <span m='3160080'>make</span>
  <span m='3160350'>a</span> <span m='3160500'>new</span> <span m='3160770'>version</span>
  <span m='3161070'>of</span> <span m='3161160'>this</span> <span m='3161280'>node</span>
  <span m='3161520'>that</span> <span m='3161850'>has</span> <span m='3162060'>empty</span>
  <span m='3162390'>mods,</span> <span m='3163560'>this</span> <span m='3163740'>one's</span>
  <span m='3163870'>still</span> <span m='3164130'>full.</span> <span m='3165050'>And</span>
  <span m='3165180'>I</span> <span m='3165290'>can</span> <span m='3165520'>keep</span>
  <span m='3166500'>modifying</span> <span m='3167100'>the</span> <span m='3167190'>same</span>
  <span m='3167610'>version.</span> <span m='3168810'>This</span> <span m='3169330'>new</span>
  <span m='3169500'>node</span> <span m='3169740'>that</span> <span m='3169980'>I</span>
  <span m='3170070'>just</span> <span m='3170310'>erased</span> <span m='3171060'>represents</span>
  <span m='3171660'>some</span> <span m='3171960'>new</span> <span m='3172110'>version.</span>
  <span m='3172830'>But</span> <span m='3172920'>if</span> <span m='3173010'>I</span>
  <span m='3173070'>keep</span> <span m='3173280'>modifying</span> <span m='3173790'>an</span>
  <span m='3173880'>old</span> <span m='3174090'>version,</span> <span m='3174540'>which</span>
  <span m='3174720'>I</span> <span m='3174780'>can</span> <span m='3174930'>do</span>
  <span m='3175050'>in</span> <span m='3175140'>full</span> <span m='3175320'>persistence,</span>
  <span m='3176320'>this</span> <span m='3176370'>node</span> <span m='3176580'>keeps</span>
  <span m='3176880'>being</span> <span m='3177120'>full.</span> <span m='3177760'>And
  I</span> <span m='3177930'>keep</span> <span m='3178140'>paying</span> <span m='3178560'>potentially</span>
  <span m='3178980'>huge</span> <span m='3179280'>cost.</span> </p><p><span m='3180240'>If</span>
  <span m='3180360'>all</span> <span m='3180540'>the</span> <span m='3180630'>nodes</span>
  <span m='3180840'>were</span> <span m='3180960'>full,</span> <span m='3181260'>and</span>
  <span m='3181380'>when</span> <span m='3181500'>I</span> <span m='3181590'>make</span>
  <span m='3181740'>this</span> <span m='3181890'>change</span> <span m='3182310'>every</span>
  <span m='3182610'>node</span> <span m='3183450'>gets</span> <span m='3183630'>copied,</span>
  <span m='3184680'>and</span> <span m='3184770'>then</span> <span m='3184890'>I</span>
  <span m='3184950'>make</span> <span m='3185130'>a</span> <span m='3185160'>change</span>
  <span m='3185430'>to</span> <span m='3185490'>the</span> <span m='3185610'>same</span>
  <span m='3185850'>version,</span> <span m='3186180'>every</span> <span m='3186420'>node</span>
  <span m='3186600'>gets</span> <span m='3186750'>copied</span> <span m='3187050'>again.</span>
  <span m='3187380'>This</span> <span m='3187530'>is</span> <span m='3187620'>going</span>
  <span m='3187770'>to</span> <span m='3187830'>take</span> <span m='3187950'>linear</span>
  <span m='3188280'>time</span> <span m='3188640'>per</span> <span m='3188910'>operation.</span>
  <span m='3189860'>So</span> <span m='3189960'>I</span> <span m='3189990'>can't</span>
  <span m='3190260'>do</span> <span m='3190440'>the</span> <span m='3190530'>old</span>
  <span m='3190680'>strategy.</span> <span m='3191940'>I</span> <span m='3192030'>need</span>
  <span m='3192270'>to</span> <span m='3192390'>somehow</span> <span m='3192780'>make</span>
  <span m='3193020'>this</span> <span m='3193320'>node</span> <span m='3193740'>less</span>
  <span m='3194220'>full.</span> <span m='3195480'>This</span> <span m='3195660'>is</span>
  <span m='3195750'>where</span> <span m='3195870'>we're</span> <span m='3195990'>definitely</span>
  <span m='3196350'>not</span> <span m='3196620'>functional.</span> <span m='3197220'>None</span>
  <span m='3197400'>of</span> <span m='3197490'>this</span> <span m='3197670'>was</span>
  <span m='3197760'>functional,</span> <span m='3198180'>but</span> <span m='3198330'>now</span>
  <span m='3198930'>I'm</span> <span m='3199050'>going</span> <span m='3199170'>to</span>
  <span m='3199260'>change</span> <span m='3199590'>an</span> <span m='3199680'>old</span>
  <span m='3199800'>node,</span> <span m='3201030'>not</span> <span m='3201240'>just</span>
  <span m='3201390'>make</span> <span m='3201600'>a</span> <span m='3201660'>new</span>
  <span m='3201810'>one</span> <span m='3203850'>in</span> <span m='3204000'>a</span>
  <span m='3204060'>more</span> <span m='3204240'>drastic</span> <span m='3204690'>way.</span>
  </p><p><span m='3205860'>Before</span> <span m='3206130'>I</span> <span m='3206190'>was</span>
  <span m='3206310'>adding</span> <span m='3206650'>a</span> <span m='3206800'>mod.</span>
  <span m='3207060'>That's</span> <span m='3207300'>not</span> <span m='3207450'>a</span>
  <span m='3207510'>functional</span> <span m='3207840'>operation.</span> <span m='3208560'>Now</span>
  <span m='3208950'>I'm</span> <span m='3209070'>actually</span> <span m='3209310'>going</span>
  <span m='3209430'>to</span> <span m='3209490'>remove</span> <span m='3209850'>mods</span>
  <span m='3210210'>from</span> <span m='3210390'>a</span> <span m='3210430'>node</span>
  <span m='3212430'>to</span> <span m='3212670'>rebalance.</span> <span m='3213870'>So</span>
  <span m='3214020'>what I'd</span> <span m='3214140'>like</span> <span m='3214320'>to</span>
  <span m='3214440'>do</span> <span m='3215190'>is</span> <span m='3215340'>split</span>
  <span m='3215760'>the</span> <span m='3215880'>node</span> <span m='3218820'>into</span>
  <span m='3220260'>two</span> <span m='3220360'>halves.</span> <span m='3223240'>OK.</span>
  <span m='3223550'>So</span> <span m='3223650'>I</span> <span m='3223710'>had</span>
  <span m='3223920'>some</span> <span m='3224130'>big</span> <span m='3224340'>node</span>
  <span m='3225210'>that</span> <span m='3225360'>was--</span> <span m='3226295'>I'll
  draw it--</span> <span m='3227190'>completely</span> <span m='3227850'>full.</span>
  <span m='3230190'>Now</span> <span m='3230580'>I'm</span> <span m='3230700'>going</span>
  <span m='3230850'>to</span> <span m='3230940'>make</span> <span m='3231180'>two</span>
  <span m='3231390'>nodes.</span> <span m='3232890'>Here we</span> <span m='3233355'>go.</span>
  </p><p><span m='3239020'>This</span> <span m='3239220'>one</span> <span m='3239300'>is</span>
  <span m='3239370'>going</span> <span m='3239490'>to</span> <span m='3239580'>be</span>
  <span m='3239700'>half</span> <span m='3239970'>full.</span> <span m='3241030'>This</span>
  <span m='3241190'>one's</span> <span m='3241290'>going</span> <span m='3241440'>to</span>
  <span m='3241500'>be</span> <span m='3241590'>half</span> <span m='3241860'>full</span>
  <span m='3242310'>of</span> <span m='3242490'>mods.</span> <span m='3244930'>OK.</span>
  <span m='3245460'>The</span> <span m='3245580'>only</span> <span m='3245790'>question</span>
  <span m='3246150'>left</span> <span m='3246420'>is,</span> <span m='3246510'>what</span>
  <span m='3246660'>do</span> <span m='3246750'>I</span> <span m='3246840'>do</span>
  <span m='3247080'>with</span> <span m='3247230'>all</span> <span m='3247440'>these</span>
  <span m='3247650'>things?</span> <span m='3252150'>Basically</span> <span m='3252540'>what</span>
  <span m='3252690'>I'd</span> <span m='3252780'>like</span> <span m='3252930'>to</span>
  <span m='3253020'>do</span> <span m='3253260'>is</span> <span m='3253620'>have</span>
  <span m='3253980'>the--</span> <span m='3254700'>on</span> <span m='3254940'>the</span>
  <span m='3255030'>one</span> <span m='3255180'>hand,</span> <span m='3255430'>I</span>
  <span m='3255530'>want</span> <span m='3255540'>to</span> <span m='3255600'>have</span>
  <span m='3255750'>the</span> <span m='3255870'>old</span> <span m='3256080'>node.</span>
  <span m='3258720'>It's</span> <span m='3259110'>just</span> <span m='3259350'>where</span>
  <span m='3259470'>it</span> <span m='3259530'>used</span> <span m='3259740'>to</span>
  <span m='3259860'>be.</span> <span m='3260550'>I've</span> <span m='3260640'>just</span>
  <span m='3260790'>removed</span> <span m='3261300'>half</span> <span m='3261540'>of</span>
  <span m='3261630'>the</span> <span m='3261750'>mods,</span> <span m='3262590'>the</span>
  <span m='3262770'>second</span> <span m='3263160'>half,</span> <span m='3263820'>the</span>
  <span m='3263910'>later</span> <span m='3264210'>half.</span> <span m='3265710'>What
  does</span> <span m='3265800'>that</span> <span m='3265950'>mean?</span> <span m='3266740'>I</span>
  <span m='3266770'>don't know.</span> <span m='3267420'>Figure</span> <span m='3267690'>it</span>
  <span m='3267780'>out.</span> <span m='3269320'>It's</span> <span m='3269540'>linearized.</span>
  <span m='3271050'>I</span> <span m='3271140'>haven't</span> <span m='3271410'>thought</span>
  <span m='3271590'>deeply</span> <span m='3271890'>about</span> <span m='3272070'>that.</span>
  </p><p><span m='3272710'>Now</span> <span m='3272910'>we're</span> <span m='3273000'>going</span>
  <span m='3273120'>to</span> <span m='3273210'>make</span> <span m='3273390'>a</span>
  <span m='3273450'>new</span> <span m='3273640'>node</span> <span m='3275460'>with</span>
  <span m='3275730'>the</span> <span m='3275820'>second</span> <span m='3276120'>half</span>
  <span m='3276300'>of</span> <span m='3276360'>the</span> <span m='3276450'>mods.</span>
  <span m='3280160'>It's</span> <span m='3280290'>more</span> <span m='3280470'>painful</span>
  <span m='3280830'>than</span> <span m='3280980'>I</span> <span m='3281040'>thought.</span>
  <span m='3281640'>In</span> <span m='3281790'>reality,</span> <span m='3282390'>these</span>
  <span m='3282630'>mods</span> <span m='3282960'>represent</span> <span m='3283470'>a</span>
  <span m='3283530'>tree</span> <span m='3283860'>of</span> <span m='3283950'>modifications.</span>
  <span m='3285180'>And</span> <span m='3285330'>what</span> <span m='3285510'>you</span>
  <span m='3285600'>need</span> <span m='3285750'>to</span> <span m='3285870'>do</span>
  <span m='3286020'>is</span> <span m='3286140'>find</span> <span m='3286620'>a</span>
  <span m='3287370'>partition</span> <span m='3287940'>of</span> <span m='3288030'>that</span>
  <span m='3288180'>tree</span> <span m='3288450'>into</span> <span m='3288650'>two</span>
  <span m='3288900'>roughly</span> <span m='3289290'>equal</span> <span m='3289590'>halves.</span>
  <span m='3291000'>You</span> <span m='3291120'>can</span> <span m='3291240'>actually</span>
  <span m='3291570'>do</span> <span m='3291690'>a</span> <span m='3291780'>one third,</span>
  <span m='3292190'>2/3</span> <span m='3292580'>split.</span> <span m='3292870'>That's</span>
  <span m='3293070'>also</span> <span m='3293400'>in</span> <span m='3293520'>a</span>
  <span m='3293580'>future</span> <span m='3293950'>lecture,</span> <span m='3294790'>which</span>
  <span m='3295110'>whose</span> <span m='3295260'>number</span> <span m='3295560'>I</span>
  <span m='3295710'>forget.</span> </p><p><span m='3297120'>So</span> <span m='3297420'>really,</span>
  <span m='3297720'>you're</span> <span m='3297840'>splitting</span> <span m='3298230'>this</span>
  <span m='3298350'>tree</span> <span m='3298590'>into</span> <span m='3298770'>two</span>
  <span m='3299070'>roughly</span> <span m='3299370'>balanced</span> <span m='3300360'>halves.</span>
  <span m='3301440'>And</span> <span m='3301530'>so</span> <span m='3301680'>this</span>
  <span m='3301950'>2</span> <span m='3302220'>might</span> <span m='3302430'>actually</span>
  <span m='3302670'>need</span> <span m='3302820'>to</span> <span m='3302910'>change</span>
  <span m='3303240'>to</span> <span m='3303330'>a 3,</span> <span m='3303750'>but</span>
  <span m='3304460'>it's</span> <span m='3304770'>a</span> <span m='3304830'>constant.</span>
  <span m='3306330'>OK.</span> <span m='3307590'>What</span> <span m='3307770'>I</span>
  <span m='3307860'>want</span> <span m='3308130'>is</span> <span m='3308280'>for</span>
  <span m='3308400'>this</span> <span m='3308610'>to</span> <span m='3308700'>represent</span>
  <span m='3309330'>a</span> <span m='3309390'>subtree</span> <span m='3309900'>of</span>
  <span m='3309990'>versions.</span> <span m='3310350'>Let</span> <span m='3310470'>me</span>
  <span m='3310560'>draw</span> <span m='3310780'>the</span> <span m='3310860'>picture.</span>
  </p><p><span m='3311860'>So</span> <span m='3311910'>here's</span> <span m='3312150'>a</span>
  <span m='3312210'>tree</span> <span m='3312510'>of</span> <span m='3312570'>versions</span>
  <span m='3313020'>represented</span> <span m='3313620'>by</span> <span m='3313800'>the</span>
  <span m='3313950'>old</span> <span m='3314160'>mods.</span> <span m='3315180'>I'd</span>
  <span m='3315300'>like</span> <span m='3315480'>to</span> <span m='3315600'>cut</span>
  <span m='3315960'>out</span> <span m='3316320'>a</span> <span m='3316380'>subtree</span>
  <span m='3317160'>rooted</span> <span m='3317460'>at</span> <span m='3317550'>some</span>
  <span m='3317760'>node.</span> <span m='3318580'>So</span> <span m='3319230'>let's</span>
  <span m='3319500'>just</span> <span m='3319680'>assume</span> <span m='3320040'>for</span>
  <span m='3320190'>now</span> <span m='3320730'>this</span> <span m='3320940'>has</span>
  <span m='3321120'>exactly</span> <span m='3321540'>half</span> <span m='3321840'>the</span>
  <span m='3321930'>nodes.</span> <span m='3322890'>And</span> <span m='3322980'>this</span>
  <span m='3323190'>has</span> <span m='3323430'>half</span> <span m='3323670'>the</span>
  <span m='3323790'>nodes.</span> <span m='3325470'>In</span> <span m='3325990'>reality,</span>
  <span m='3326440'>I</span> <span m='3326500'>think</span> <span m='3326680'>it</span>
  <span m='3326740'>can</span> <span m='3326950'>be</span> <span m='3327430'>one third,</span>
  <span m='3327790'>2/3.</span> <span m='3329320'>OK.</span> <span m='3329680'>But</span>
  <span m='3329860'>let's</span> <span m='3330220'>keep</span> <span m='3330490'>it</span>
  <span m='3330610'>convenient.</span> </p><p><span m='3332930'>So</span> <span m='3333400'>I</span>
  <span m='3333490'>want</span> <span m='3333700'>the</span> <span m='3333820'>new</span>
  <span m='3333970'>node</span> <span m='3334210'>to</span> <span m='3334330'>represent</span>
  <span m='3334750'>this</span> <span m='3334930'>subtree</span> <span m='3335620'>and</span>
  <span m='3335800'>this</span> <span m='3335950'>node</span> <span m='3336160'>to</span>
  <span m='3336280'>represent</span> <span m='3336730'>everything</span> <span m='3337120'>else.</span>
  <span m='3337630'>This</span> <span m='3337870'>node</span> <span m='3338140'>is</span>
  <span m='3338290'>as</span> <span m='3338590'>if</span> <span m='3339280'>this</span>
  <span m='3339430'>stuff</span> <span m='3339670'>hasn't</span> <span m='3339910'>happened</span>
  <span m='3340300'>yet.</span> <span m='3341650'>I</span> <span m='3341680'>mean,</span>
  <span m='3341790'>so</span> <span m='3341900'>it</span> <span m='3341960'>represents</span>
  <span m='3342460'>all</span> <span m='3342640'>these</span> <span m='3342820'>old</span>
  <span m='3343000'>versions</span> <span m='3344050'>that</span> <span m='3344170'>do</span>
  <span m='3344290'>not,</span> <span m='3344990'>that are</span> <span m='3345340'>not
  in</span> <span m='3345430'>the</span> <span m='3345490'>subtree.</span> <span m='3345880'>This</span>
  <span m='3346030'>represents</span> <span m='3346450'>all</span> <span m='3346540'>the</span>
  <span m='3346630'>latest</span> <span m='3346900'>stuff.</span> </p><p><span m='3347800'>So</span>
  <span m='3348040'>what</span> <span m='3348190'>I'm</span> <span m='3348250'>going</span>
  <span m='3348370'>to</span> <span m='3348460'>do</span> <span m='3348880'>is</span>
  <span m='3349000'>like</span> <span m='3349270'>before,</span> <span m='3349690'>I</span>
  <span m='3349750'>want</span> <span m='3350110'>to</span> <span m='3350300'>apply</span>
  <span m='3350680'>some</span> <span m='3351340'>mods</span> <span m='3351710'>to</span>
  <span m='3351820'>these</span> <span m='3352120'>fields.</span> <span m='3354090'>And</span>
  <span m='3355170'>whatever</span> <span m='3355640'>minds</span> <span m='3356560'>were</span>
  <span m='3356620'>relevant</span> <span m='3357060'>at</span> <span m='3357180'>this</span>
  <span m='3357360'>point,</span> <span m='3357990'>whatever</span> <span m='3358320'>had</span>
  <span m='3358530'>been</span> <span m='3358650'>applied,</span> <span m='3359730'>I</span>
  <span m='3359850'>apply</span> <span m='3360180'>those</span> <span m='3360990'>to</span>
  <span m='3361110'>the</span> <span m='3361200'>fields</span> <span m='3361560'>here.</span>
  <span m='3362610'>And</span> <span m='3362730'>so</span> <span m='3363210'>that</span>
  <span m='3363420'>means</span> <span m='3363630'>I</span> <span m='3363720'>can</span>
  <span m='3363870'>remove</span> <span m='3364230'>all</span> <span m='3364380'>of</span>
  <span m='3364470'>these</span> <span m='3364680'>mods.</span> <span m='3366900'>I</span>
  <span m='3366990'>only</span> <span m='3367170'>cared</span> <span m='3367370'>about</span>
  <span m='3367560'>these</span> <span m='3367740'>ones.</span> <span m='3369360'>Update</span>
  <span m='3369750'>these</span> <span m='3369930'>fields</span> <span m='3370230'>accordingly.</span>
  <span m='3371220'>I</span> <span m='3371340'>still</span> <span m='3371580'>have</span>
  <span m='3371910'>the</span> <span m='3372090'>other</span> <span m='3372300'>mods</span>
  <span m='3372570'>to</span> <span m='3372660'>represent</span> <span m='3372990'>all</span>
  <span m='3373140'>the</span> <span m='3373290'>other</span> <span m='3373500'>changes</span>
  <span m='3374040'>that</span> <span m='3374190'>could</span> <span m='3374340'>be</span>
  <span m='3374550'>in</span> <span m='3374700'>that</span> <span m='3374850'>subtree.</span>
  <span m='3376170'>OK.</span> </p><p><span m='3376530'>So</span> <span m='3377550'>we</span>
  <span m='3377730'>actually</span> <span m='3378930'>split</span> <span m='3380400'>the</span>
  <span m='3381630'>tree,</span> <span m='3384990'>and</span> <span m='3385650'>we</span>
  <span m='3387390'>apply</span> <span m='3390160'>mods</span> <span m='3392430'>to</span>
  <span m='3392850'>new</span> <span m='3393000'>nodes.</span> <span m='3398680'>Anything</span>
  <span m='3399150'>else</span> <span m='3399270'>I</span> <span m='3399480'>need</span>
  <span m='3399600'>to</span> <span m='3399720'>say?</span> <span m='3402560'>Oh,</span>
  <span m='3402930'>now</span> <span m='3403010'>we</span> <span m='3403070'>need</span>
  <span m='3403200'>to</span> <span m='3403250'>update</span> <span m='3403520'>pointers.</span>
  <span m='3404000'>That's</span> <span m='3404260'>always</span> <span m='3404450'>the</span>
  <span m='3404540'>fun</span> <span m='3404720'>part.</span> <span m='3409550'>Let's</span>
  <span m='3409660'>go</span> <span m='3409900'>over</span> <span m='3410140'>here.</span>
  </p><p><span m='3425300'>So</span> <span m='3425780'>old</span> <span m='3425990'>node</span>
  <span m='3426200'>hasn't</span> <span m='3426470'>moved.</span> <span m='3427490'>But</span>
  <span m='3427700'>this</span> <span m='3427880'>new</span> <span m='3428060'>node</span>
  <span m='3428330'>has</span> <span m='3428600'>moved.</span> <span m='3429150'>So</span>
  <span m='3429260'>for</span> <span m='3430010'>all</span> <span m='3430250'>of</span>
  <span m='3430340'>these</span> <span m='3430580'>versions,</span> <span m='3433520'>I</span>
  <span m='3433640'>want</span> <span m='3433880'>to</span> <span m='3434000'>change</span>
  <span m='3434930'>the</span> <span m='3435050'>pointer</span> <span m='3436550'>that</span>
  <span m='3436670'>used</span> <span m='3436880'>to</span> <span m='3436970'>point</span>
  <span m='3437210'>to</span> <span m='3437300'>old</span> <span m='3437510'>node</span>
  <span m='3438020'>should</span> <span m='3438200'>now</span> <span m='3438410'>point</span>
  <span m='3438650'>to</span> <span m='3438740'>new</span> <span m='3438930'>node.</span>
  <span m='3440810'>In</span> <span m='3440930'>this</span> <span m='3441110'>version,</span>
  <span m='3441440'>it's</span> <span m='3441590'>fine.</span> <span m='3441930'>It</span>
  <span m='3442010'>should</span> <span m='3442160'>still</span> <span m='3442400'>point</span>
  <span m='3442610'>to</span> <span m='3442700'>old</span> <span m='3442910'>node,</span>
  <span m='3443150'>because</span> <span m='3443540'>this</span> <span m='3443780'>represents</span>
  <span m='3444380'>all</span> <span m='3444620'>those</span> <span m='3444770'>old</span>
  <span m='3444920'>versions.</span> <span m='3445280'>But</span> <span m='3445540'>for</span>
  <span m='3445730'>the</span> <span m='3445820'>new</span> <span m='3445940'>version,</span>
  <span m='3446660'>that</span> <span m='3446840'>version</span> <span m='3447170'>in</span>
  <span m='3447350'>the</span> <span m='3447540'>subtree,</span> <span m='3448170'>I've</span>
  <span m='3448310'>got</span> <span m='3448460'>to</span> <span m='3448490'>point</span>
  <span m='3448760'>here</span> <span m='3449000'>instead.</span> </p><p><span m='3450950'>OK.</span>
  <span m='3451280'>So</span> <span m='3454670'>how</span> <span m='3454880'>many</span>
  <span m='3455120'>pointers</span> <span m='3455600'>could</span> <span m='3455810'>there</span>
  <span m='3455960'>be</span> <span m='3456880'>to</span> <span m='3457100'>this node</span>
  <span m='3457330'>that</span> <span m='3457460'>need</span> <span m='3457610'>to</span>
  <span m='3457730'>change.</span> <span m='3458850'>That's</span> <span m='3459380'>a</span>
  <span m='3459440'>tricky</span> <span m='3460100'>part</span> <span m='3460370'>in</span>
  <span m='3460490'>this</span> <span m='3460640'>analysis.</span> <span m='3461630'>Think</span>
  <span m='3461870'>about</span> <span m='3462080'>it</span> <span m='3462140'>for</span>
  <span m='3462290'>a</span> <span m='3462320'>while.</span> <span m='3465200'>I</span>
  <span m='3465260'>mean,</span> <span m='3466130'>in</span> <span m='3466250'>this</span>
  <span m='3466430'>new</span> <span m='3466610'>node,</span> <span m='3466910'>whatever</span>
  <span m='3467200'>is</span> <span m='3467330'>pointed</span> <span m='3467720'>to</span>
  <span m='3467930'>by</span> <span m='3468140'>either</span> <span m='3468380'>here</span>
  <span m='3468650'>or</span> <span m='3468860'>here</span> <span m='3469160'>in</span>
  <span m='3469280'>the</span> <span m='3469370'>new</span> <span m='3469490'>node</span>
  <span m='3469820'>also</span> <span m='3470180'>has</span> <span m='3470330'>a</span>
  <span m='3470390'>return</span> <span m='3470690'>pointer.</span> <span m='3470930'>All</span>
  <span m='3471110'>pointers</span> <span m='3471470'>are</span> <span m='3471570'>bidirectional.</span>
  <span m='3472130'>So</span> <span m='3472280'>we</span> <span m='3472340'>don't</span>
  <span m='3472460'>really</span> <span m='3472640'>care</span> <span m='3472820'>about</span>
  <span m='3473000'>whether</span> <span m='3473130'>they're</span> <span m='3473240'>forward</span>
  <span m='3473540'>or</span> <span m='3473600'>backward.</span> </p><p><span m='3475010'>How</span>
  <span m='3475220'>many</span> <span m='3475430'>pointers</span> <span m='3475790'>are</span>
  <span m='3475880'>there</span> <span m='3475990'>here?</span> <span m='3476300'>Well,</span>
  <span m='3476910'>there's</span> <span m='3477200'>d</span> <span m='3477540'>here</span>
  <span m='3478370'>and</span> <span m='3478490'>there's</span> <span m='3478640'>p</span>
  <span m='3478880'>here.</span> <span m='3479360'>But</span> <span m='3479480'>then</span>
  <span m='3479630'>there's</span> <span m='3479810'>also</span> <span m='3480200'>some</span>
  <span m='3480530'>additional</span> <span m='3480950'>pointers</span> <span m='3481280'>represented</span>
  <span m='3481820'>over</span> <span m='3482030'>here.</span> <span m='3482750'>How</span>
  <span m='3482870'>many?</span> <span m='3484100'>Well,</span> <span m='3484280'>if</span>
  <span m='3484400'>we</span> <span m='3484520'>assume</span> <span m='3484790'>this</span>
  <span m='3484940'>magical</span> <span m='3485360'>50/50</span> <span m='3485890'>split,</span>
  <span m='3486890'>there's</span> <span m='3487400'>right</span> <span m='3487610'>now</span>
  <span m='3487820'>d</span> <span m='3488105'>plus</span> <span m='3488390'>p</span>
  <span m='3488660'>plus</span> <span m='3488990'>1</span> <span m='3489500'>mods</span>
  <span m='3490040'>over</span> <span m='3490270'>here,</span> <span m='3490700'>half</span>
  <span m='3491030'>of</span> <span m='3491150'>them.</span> </p><p><span m='3492920'>Each</span>
  <span m='3493130'>of</span> <span m='3493190'>them</span> <span m='3493340'>might</span>
  <span m='3493670'>be</span> <span m='3493790'>a</span> <span m='3493850'>pointer</span>
  <span m='3494300'>to</span> <span m='3494420'>some</span> <span m='3494750'>other</span>
  <span m='3494960'>place,</span> <span m='3495920'>which</span> <span m='3496100'>has</span>
  <span m='3496310'>a</span> <span m='3496370'>return</span> <span m='3496700'>pointer</span>
  <span m='3497000'>in</span> <span m='3497150'>that</span> <span m='3497330'>version.</span>
  <span m='3498715'>So</span> <span m='3499510'>number</span> <span m='3500000'>of</span>
  <span m='3501530'>back</span> <span m='3502070'>pointers</span> <span m='3502430'>that</span>
  <span m='3502520'>we</span> <span m='3502610'>need</span> <span m='3502730'>to</span>
  <span m='3502850'>update</span> <span m='3503690'>is</span> <span m='3503840'>going</span>
  <span m='3503990'>to</span> <span m='3504080'>be</span> <span m='3504500'>this,</span>
  <span m='3504800'>2</span> <span m='3505220'>times</span> <span m='3505520'>d</span>
  <span m='3505730'>2</span> <span m='3506000'>times</span> <span m='3506310'>p</span>
  <span m='3506590'>plus</span> <span m='3506920'>1.</span> </p><p><span m='3510700'>So</span>
  <span m='3510920'>recursively</span> <span m='3511670'>update</span> <span m='3516479'>at</span>
  <span m='3516950'>most</span> <span m='3519320'>2</span> <span m='3519590'>times</span>
  <span m='3519990'>d</span> <span m='3520325'>plus</span> <span m='3520660'>2</span>
  <span m='3520940'>times</span> <span m='3521400'>p</span> <span m='3521850'>plus</span>
  <span m='3522200'>1</span> <span m='3523790'>pointers</span> <span m='3524300'>to</span>
  <span m='3524420'>the</span> <span m='3524540'>node.</span> <span m='3530270'>The</span>
  <span m='3530390'>good</span> <span m='3530540'>news</span> <span m='3530810'>is</span>
  <span m='3530990'>this</span> <span m='3531170'>is</span> <span m='3531290'>really</span>
  <span m='3531590'>only</span> <span m='3531800'>half</span> <span m='3532130'>of</span>
  <span m='3532280'>them</span> <span m='3532550'>or</span> <span m='3533330'>some</span>
  <span m='3533570'>fraction</span> <span m='3534080'>of</span> <span m='3534220'>them.</span>
  <span m='3534850'>It</span> <span m='3534920'>used</span> <span m='3535190'>to</span>
  <span m='3535280'>be--</span> <span m='3537600'>well,</span> <span m='3537710'>there</span>
  <span m='3538100'>were</span> <span m='3538190'>more</span> <span m='3538370'>pointers</span>
  <span m='3538730'>before.</span> <span m='3539000'>We</span> <span m='3539120'>don't</span>
  <span m='3539330'>have</span> <span m='3539450'>to</span> <span m='3539540'>deal</span>
  <span m='3539690'>with</span> <span m='3539810'>these</span> <span m='3539990'>ones.</span>
  <span m='3540290'>That's</span> <span m='3540500'>where</span> <span m='3540680'>we're</span>
  <span m='3540800'>saving,</span> <span m='3541190'>and</span> <span m='3541280'>that's</span>
  <span m='3541460'>why</span> <span m='3541580'>this</span> <span m='3541730'>amortization</span>
  <span m='3542360'>works.</span> <span m='3543930'>Let</span> <span m='3543980'>me</span>
  <span m='3544100'>give</span> <span m='3544250'>you</span> <span m='3544310'>a</span>
  <span m='3544340'>potential</span> <span m='3544760'>function</span> <span m='3545180'>that</span>
  <span m='3545330'>makes</span> <span m='3545540'>this</span> <span m='3545690'>work--</span>
  <span m='3552950'>is</span> <span m='3556274'>minus</span> <span m='3557190'>c</span>
  <span m='3557610'>times</span> <span m='3558600'>sum</span> <span m='3559680'>of</span>
  <span m='3559830'>the</span> <span m='3559920'>number</span> <span m='3560520'>of</span>
  <span m='3560970'>empty</span> <span m='3561390'>mod</span> <span m='3561740'>slots.</span>
  </p><p><span m='3563760'>It's</span> <span m='3564270'>kind</span> <span m='3564600'>of</span>
  <span m='3564720'>the</span> <span m='3564810'>same</span> <span m='3565050'>potential</span>
  <span m='3565500'>but</span> <span m='3566010'>before</span> <span m='3566370'>we</span>
  <span m='3566490'>had</span> <span m='3566580'>this</span> <span m='3566730'>notion</span>
  <span m='3567000'>of</span> <span m='3567120'>dead</span> <span m='3567390'>and</span>
  <span m='3567510'>alive</span> <span m='3567900'>nodes.</span> <span m='3568530'>Now</span>
  <span m='3569070'>everything's</span> <span m='3569550'>alive</span> <span m='3569940'>because</span>
  <span m='3570090'>everything</span> <span m='3570450'>could</span> <span m='3570570'>change</span>
  <span m='3570900'>at</span> <span m='3570960'>any</span> <span m='3571110'>moment.</span>
  <span m='3571980'>So</span> <span m='3572160'>instead,</span> <span m='3572730'>I'm</span>
  <span m='3572850'>going</span> <span m='3573000'>to</span> <span m='3573060'>measure</span>
  <span m='3575220'>how</span> <span m='3575340'>much</span> <span m='3575550'>room</span>
  <span m='3575760'>I</span> <span m='3575820'>have</span> <span m='3576030'>in</span>
  <span m='3576120'>each</span> <span m='3576300'>node.</span> <span m='3577140'>Before</span>
  <span m='3577470'>I</span> <span m='3577500'>had</span> <span m='3577650'>no</span>
  <span m='3577830'>room</span> <span m='3578010'>in</span> <span m='3578070'>this</span>
  <span m='3578220'>node.</span> <span m='3578550'>Now</span> <span m='3578790'>I</span>
  <span m='3578850'>have</span> <span m='3579090'>half</span> <span m='3579360'>the</span>
  <span m='3579450'>space</span> <span m='3580470'>in</span> <span m='3580620'>both</span>
  <span m='3580860'>nodes.</span> <span m='3581760'>So</span> <span m='3581910'>that's</span>
  <span m='3582120'>good</span> <span m='3582270'>news.</span> </p><p><span m='3584070'>Whenever</span>
  <span m='3585960'>we</span> <span m='3586170'>have</span> <span m='3586470'>this</span>
  <span m='3586650'>recursion,</span> <span m='3588150'>we</span> <span m='3588300'>can</span>
  <span m='3588450'>charge</span> <span m='3588840'>it</span> <span m='3593710'>to</span>
  <span m='3594400'>a</span> <span m='3594500'>potential</span> <span m='3595020'>decrease.</span>
  <span m='3596630'>Fee</span> <span m='3597210'>goes</span> <span m='3597510'>down</span>
  <span m='3598530'>by--</span> <span m='3601160'>because</span> <span m='3601380'>I</span>
  <span m='3601440'>have</span> <span m='3601590'>a</span> <span m='3601650'>negative</span>
  <span m='3602040'>sign</span> <span m='3602370'>here--</span> <span m='3603720'>c</span>
  <span m='3605040'>times,</span> <span m='3606810'>oh man,</span> <span m='3607590'>2</span>
  <span m='3608000'>times</span> <span m='3609350'>d</span> <span m='3609940'>plus</span>
  <span m='3610400'>p</span> <span m='3610690'>plus</span> <span m='3611080'>1,</span>
  <span m='3612660'>I</span> <span m='3612720'>think.</span> <span m='3613740'>Because</span>
  <span m='3613950'>there's</span> <span m='3614100'>d plus p</span> <span m='3614530'>plus</span>
  <span m='3614850'>1</span> <span m='3615120'>space</span> <span m='3615480'>here,</span>
  <span m='3615780'>d plus</span> <span m='3616170'>p plus</span> <span m='3616500'>1</span>
  <span m='3616660'>space</span> <span m='3616980'>here.</span> <span m='3617230'>I
  mean,</span> <span m='3617330'>we</span> <span m='3617520'>added</span> <span m='3617730'>one</span>
  <span m='3617970'>whole</span> <span m='3618150'>new</span> <span m='3618300'>node.</span>
  <span m='3618990'>And</span> <span m='3619290'>total</span> <span m='3619560'>capacity</span>
  <span m='3620070'>of</span> <span m='3620160'>a</span> <span m='3620240'>node in</span>
  <span m='3620470'>mods</span> <span m='3620820'>is</span> <span m='3620970'>2</span>
  <span m='3621150'>times</span> <span m='3622140'>d plus</span> <span m='3622480'>p</span>
  <span m='3622700'>plus</span> <span m='3622950'>1.</span> <span m='3623610'>So</span>
  <span m='3623680'>we</span> <span m='3623740'>get</span> <span m='3623850'>that</span>
  <span m='3624130'>times</span> <span m='3624430'>c.</span> </p><p><span m='3626010'>And</span>
  <span m='3626280'>this</span> <span m='3626430'>is</span> <span m='3626520'>basically</span>
  <span m='3626880'>just</span> <span m='3627210'>enough,</span> <span m='3628530'>because</span>
  <span m='3628860'>this</span> <span m='3629040'>is</span> <span m='3629160'>2</span>
  <span m='3629310'>times</span> <span m='3629580'>d plus</span> <span m='3630030'>2</span>
  <span m='3630210'>times</span> <span m='3630630'>p plus</span> <span m='3631050'>2.</span>
  <span m='3632010'>And</span> <span m='3632280'>here</span> <span m='3632490'>we</span>
  <span m='3632610'>have</span> <span m='3632820'>a</span> <span m='3632880'>plus</span>
  <span m='3633180'>1.</span> <span m='3634140'>And</span> <span m='3634290'>so</span>
  <span m='3635100'>the</span> <span m='3635280'>recursion</span> <span m='3636810'>gets</span>
  <span m='3637050'>annihilated</span> <span m='3638280'>by</span> <span m='3638670'>2</span>
  <span m='3638880'>times</span> <span m='3639240'>d plus</span> <span m='3639690'>2</span>
  <span m='3639840'>times</span> <span m='3640220'>p plus</span> <span m='3640480'>1.</span>
  <span m='3641280'>And</span> <span m='3641370'>then</span> <span m='3641460'>there's</span>
  <span m='3641640'>one</span> <span m='3642030'>c</span> <span m='3642330'>left</span>
  <span m='3642645'>over</span> <span m='3642960'>to</span> <span m='3643080'>absorb</span>
  <span m='3643440'>whatever</span> <span m='3643740'>constant</span> <span m='3644130'>cost</span>
  <span m='3644430'>there</span> <span m='3644550'>was</span> <span m='3644790'>to</span>
  <span m='3644910'>do</span> <span m='3645060'>all</span> <span m='3645180'>this</span>
  <span m='3645330'>other</span> <span m='3645510'>work.</span> </p><p><span m='3647241'>So</span>
  <span m='3647730'>I</span> <span m='3647850'>got</span> <span m='3648030'>the</span>
  <span m='3648120'>constants</span> <span m='3648570'>just</span> <span m='3649470'>to</span>
  <span m='3649620'>work,</span> <span m='3651570'>except</span> <span m='3652080'>that</span>
  <span m='3652230'>I</span> <span m='3652350'>cheated</span> <span m='3652830'>and</span>
  <span m='3652920'>it's</span> <span m='3653040'>really</span> <span m='3653310'>a</span>
  <span m='3653370'>one</span> <span m='3653530'>third,</span> <span m='3653700'>2/3</span>
  <span m='3654160'>split.</span> <span m='3654340'>So</span> <span m='3654540'>probably</span>
  <span m='3654870'>all</span> <span m='3654980'>of</span> <span m='3655020'>these</span>
  <span m='3655140'>constants</span> <span m='3655460'>have</span> <span m='3655560'>to</span>
  <span m='3655650'>change,</span> <span m='3657090'>such</span> <span m='3657330'>is</span>
  <span m='3657420'>life.</span> <span m='3658102'>But</span> <span m='3659340'>I</span>
  <span m='3659370'>think</span> <span m='3659550'>you</span> <span m='3659640'>get</span>
  <span m='3659790'>the</span> <span m='3659880'>idea.</span> <span m='3661490'>Any</span>
  <span m='3661980'>questions</span> <span m='3662640'>about</span> <span m='3662910'>full</span>
  <span m='3663150'>persistence?</span> <span m='3667110'>This is</span> <span m='3667210'>fun</span>
  <span m='3667310'>stuff,</span> <span m='3668360'>time</span> <span m='3668660'>travel.</span>
  <span m='3670200'>Yeah?</span> </p><p><span m='3671426'>AUDIENCE:</span> <span m='3671919'>So</span>
  <span m='3672412'>in the</span> <span m='3672905'>first</span> <span m='3673398'>half
  of</span> <span m='3673891'>the thing</span> <span m='3674384'>where the</span>
  <span m='3674877'>if,</span> <span m='3675370'>there's</span> <span m='3675870'>room
  you can</span> <span m='3676110'>put it in.</span> </p><p><span m='3676583'>ERIK
  DEMAINE:</span> <span m='3676819'>Right.</span> </p><p><span m='3677056'>AUDIENCE:</span>
  <span m='3677292'>I</span> <span m='3677529'>have a question about how we</span>
  <span m='3678002'>represent the</span> <span m='3678475'>version.</span> <span m='3679421'>Because
  before</span> <span m='3679894'>when we</span> <span m='3680370'>said</span> <span
  m='3680810'>restore</span> <span m='3681360'>now</span> <span m='3681750'>[INAUDIBLE].</span>
  <span m='3683016'>It</span> <span m='3683438'>made</span> <span m='3683860'>more</span>
  <span m='3684000'>sense if</span> <span m='3684140'>now was</span> <span m='3684420'>like</span>
  <span m='3684586'>a</span> <span m='3684752'>timestamp</span> <span m='3684920'>or
  something.</span> </p><p><span m='3685920'>ERIK DEMAINE:</span> <span m='3686045'>OK.</span>
  <span m='3686670'>Right,</span> <span m='3686910'>so</span> <span m='3687240'>how</span>
  <span m='3687420'>do</span> <span m='3687510'>we</span> <span m='3687660'>represent</span>
  <span m='3688200'>a</span> <span m='3688320'>version</span> <span m='3689580'>even</span>
  <span m='3689880'>here</span> <span m='3690300'>or</span> <span m='3690390'>anywhere?</span>
  <span m='3691470'>When</span> <span m='3691740'>we</span> <span m='3691830'>do</span>
  <span m='3691980'>a</span> <span m='3692310'>modification,</span> <span m='3692970'>an</span>
  <span m='3693060'>update,</span> <span m='3693660'>in the</span> <span m='3693750'>data</span>
  <span m='3693930'>structure,</span> <span m='3694230'>we</span> <span m='3694290'>want</span>
  <span m='3694410'>to</span> <span m='3694470'>return</span> <span m='3694830'>the</span>
  <span m='3694890'>new</span> <span m='3695010'>version.</span> <span m='3696420'>Basically,</span>
  <span m='3697920'>we're</span> <span m='3698040'>going</span> <span m='3698280'>to</span>
  <span m='3698370'>actually</span> <span m='3698790'>store</span> <span m='3699810'>the</span>
  <span m='3699930'>DAG of</span> <span m='3700410'>versions.</span> <span m='3701220'>And</span>
  <span m='3701460'>a</span> <span m='3701520'>version</span> <span m='3701880'>is</span>
  <span m='3701940'>going</span> <span m='3702090'>to</span> <span m='3702150'>be</span>
  <span m='3702240'>represented</span> <span m='3702630'>by</span> <span m='3702780'>a</span>
  <span m='3702810'>pointer</span> <span m='3703250'>into</span> <span m='3703440'>this</span>
  <span m='3703590'>DAG.</span> <span m='3704400'>One</span> <span m='3704580'>of</span>
  <span m='3704640'>the</span> <span m='3704760'>nodes</span> <span m='3705120'>in</span>
  <span m='3705210'>this</span> <span m='3705360'>DAG</span> <span m='3705720'>becomes</span>
  <span m='3706260'>a</span> <span m='3706320'>version.</span> </p><p><span m='3707340'>Every</span>
  <span m='3708690'>node</span> <span m='3708960'>in</span> <span m='3709050'>this</span>
  <span m='3709190'>DAG</span> <span m='3709500'>is</span> <span m='3709590'>going</span>
  <span m='3709710'>to</span> <span m='3709770'>store</span> <span m='3709950'>a</span>
  <span m='3709980'>pointer</span> <span m='3710400'>to</span> <span m='3710730'>the</span>
  <span m='3710850'>corresponding</span> <span m='3711390'>b</span> <span m='3712080'>character</span>
  <span m='3712470'>and</span> <span m='3712560'>a</span> <span m='3712620'>corresponding</span>
  <span m='3712905'>e</span> <span m='3713190'>character</span> <span m='3713640'>in</span>
  <span m='3713880'>this</span> <span m='3714180'>data</span> <span m='3714390'>structure,</span>
  <span m='3715620'>which</span> <span m='3716120'>then</span> <span m='3716460'>lets</span>
  <span m='3716760'>you</span> <span m='3716940'>do</span> <span m='3717120'>anything</span>
  <span m='3717420'>you</span> <span m='3717510'>want.</span> <span m='3718090'>Then</span>
  <span m='3718170'>you</span> <span m='3718260'>can</span> <span m='3718410'>query</span>
  <span m='3718770'>against</span> <span m='3719040'>that</span> <span m='3719160'>version,</span>
  <span m='3719590'>whether</span> <span m='3719790'>it's</span> <span m='3719880'>an</span>
  <span m='3719970'>ancestor</span> <span m='3720390'>of</span> <span m='3720450'>another</span>
  <span m='3720720'>version.</span> </p><p><span m='3721690'>So</span> <span m='3721900'>yeah,</span>
  <span m='3722010'>I</span> <span m='3722100'>didn't</span> <span m='3722310'>mention</span>
  <span m='3722520'>that.</span> <span m='3722670'>Versions</span> <span m='3723060'>are</span>
  <span m='3723240'>nodes</span> <span m='3723510'>in</span> <span m='3723630'>here.</span>
  <span m='3724230'>Nodes</span> <span m='3724440'>in</span> <span m='3724560'>here</span>
  <span m='3724770'>have</span> <span m='3724950'>pointers</span> <span m='3725490'>to</span>
  <span m='3725640'>the</span> <span m='3725730'>b's</span> <span m='3726060'>and
  e's.</span> <span m='3726750'>And</span> <span m='3726870'>vice</span> <span m='3727140'>versa,</span>
  <span m='3727440'>the</span> <span m='3727560'>b's</span> <span m='3727770'>and
  e's</span> <span m='3728010'>have</span> <span m='3728130'>pointers</span> <span
  m='3728460'>back</span> <span m='3728730'>to</span> <span m='3728880'>the</span>
  <span m='3729090'>corresponding</span> <span m='3729810'>version</span> <span m='3730200'>node.</span>
  <span m='3730920'>And</span> <span m='3731070'>then</span> <span m='3731250'>you</span>
  <span m='3731370'>can</span> <span m='3731490'>keep</span> <span m='3731640'>track</span>
  <span m='3731850'>of</span> <span m='3731940'>everything.</span> <span m='3732480'>Good</span>
  <span m='3732630'>question.</span> <span m='3734790'>Yeah?</span> </p><p><span m='3735390'>AUDIENCE:</span>
  <span m='3735610'>[INAUDIBLE]</span> <span m='3735830'>question.</span> <span m='3736270'>Remind
  me what d is in this.</span> </p><p><span m='3737150'>ERIK DEMAINE:</span> <span
  m='3737350'>Oh,</span> <span m='3737550'>d was</span> <span m='3737850'>the</span>
  <span m='3738000'>maximum</span> <span m='3738480'>out</span> <span m='3738720'>degree.</span>
  <span m='3739100'>It's</span> <span m='3739200'>the</span> <span m='3739260'>number</span>
  <span m='3739530'>of</span> <span m='3739620'>fields</span> <span m='3740070'>in</span>
  <span m='3740170'>a</span> <span m='3740310'>node,</span> <span m='3744350'>as</span>
  <span m='3744620'>defined</span> <span m='3745100'>right</span> <span m='3745440'>here.</span>
  <span m='3746970'>Other</span> <span m='3747780'>questions?</span> <span m='3749750'>Whew.</span>
  <span m='3750200'>OK,</span> <span m='3750370'>a little</span> <span m='3750570'>breather.</span>
  </p><p><span m='3751305'>That</span> <span m='3751560'>was</span> <span m='3751870'>partial</span>
  <span m='3752200'>persistence,</span> <span m='3752680'>full</span> <span m='3752860'>persistence.</span>
  <span m='3753450'>This</span> <span m='3753550'>is,</span> <span m='3753670'>unfortunately,</span>
  <span m='3754240'>the</span> <span m='3754390'>end</span> <span m='3754630'>of</span>
  <span m='3754750'>the</span> <span m='3754870'>really</span> <span m='3755140'>good</span>
  <span m='3755320'>results.</span> <span m='3756730'>As</span> <span m='3756880'>long</span>
  <span m='3757150'>as</span> <span m='3757240'>we</span> <span m='3757300'>have</span>
  <span m='3757390'>constant</span> <span m='3757780'>degree</span> <span m='3758080'>nodes,</span>
  <span m='3758650'>in</span> <span m='3758830'>and</span> <span m='3758950'>out</span>
  <span m='3759100'>degree,</span> <span m='3759820'>we</span> <span m='3759940'>can</span>
  <span m='3760090'>do</span> <span m='3760510'>all.</span> <span m='3761320'>We</span>
  <span m='3761440'>can</span> <span m='3761560'>do</span> <span m='3761710'>for</span>
  <span m='3761890'>persistence</span> <span m='3762760'>for</span> <span m='3763090'>free.</span>
  </p><p><span m='3764950'>Obviously</span> <span m='3765190'>there</span> <span m='3765310'>are</span>
  <span m='3765340'>practical</span> <span m='3766060'>constants</span> <span m='3766540'>involved</span>
  <span m='3766900'>here.</span> <span m='3767080'>But</span> <span m='3767920'>in</span>
  <span m='3767980'>theory,</span> <span m='3768460'>you</span> <span m='3768700'>can</span>
  <span m='3768820'>do</span> <span m='3768910'>this</span> <span m='3769660'>perfectly.</span>
  <span m='3773170'>Before</span> <span m='3773530'>we</span> <span m='3773680'>go</span>
  <span m='3773860'>on to</span> <span m='3774040'>confluence,</span> <span m='3774700'>there</span>
  <span m='3774830'>is</span> <span m='3775000'>one</span> <span m='3775690'>positive</span>
  <span m='3776080'>result,</span> <span m='3776930'>which</span> <span m='3777070'>is</span>
  <span m='3777760'>what</span> <span m='3777970'>if</span> <span m='3778090'>you</span>
  <span m='3778210'>don't</span> <span m='3779050'>like</span> <span m='3779410'>amortize</span>
  <span m='3779910'>bounds.</span> <span m='3781090'>There</span> <span m='3781180'>are</span>
  <span m='3781210'>various</span> <span m='3781480'>reasons</span> <span m='3781780'>amortize</span>
  <span m='3782170'>bounds</span> <span m='3782440'>might</span> <span m='3782590'>not</span>
  <span m='3782740'>be</span> <span m='3782860'>good.</span> <span m='3783070'>Maybe</span>
  <span m='3783310'>you</span> <span m='3783370'>really</span> <span m='3783610'>care</span>
  <span m='3783850'>about</span> <span m='3784000'>every</span> <span m='3784270'>operation</span>
  <span m='3784720'>being</span> <span m='3786060'>no</span> <span m='3786310'>slower</span>
  <span m='3786880'>than</span> <span m='3787000'>it</span> <span m='3787090'>was</span>
  <span m='3787660'>except</span> <span m='3787960'>by a</span> <span m='3788110'>constant</span>
  <span m='3788410'>factor.</span> <span m='3788740'>We're</span> <span m='3788860'>amortizing</span>
  <span m='3789460'>here,</span> <span m='3789610'>so</span> <span m='3789680'>some</span>
  <span m='3789940'>operations</span> <span m='3790420'>get</span> <span m='3790540'>really</span>
  <span m='3790750'>slow.</span> <span m='3791500'>But</span> <span m='3791680'>the</span>
  <span m='3791770'>others</span> <span m='3792010'>are</span> <span m='3792100'>all</span>
  <span m='3792220'>fast</span> <span m='3792550'>to</span> <span m='3792670'>compensate.</span>
  </p><p><span m='3794110'>You</span> <span m='3794290'>can</span> <span m='3795260'>deamortize,</span>
  <span m='3799020'>it's</span> <span m='3799150'>called.</span> <span m='3802600'>You</span>
  <span m='3802750'>can</span> <span m='3802900'>get</span> <span m='3803380'>constant</span>
  <span m='3804550'>worst</span> <span m='3804880'>case</span> <span m='3808810'>slowdown</span>
  <span m='3810280'>for</span> <span m='3810550'>partial</span> <span m='3811030'>persistence.</span>
  <span m='3816770'>This</span> <span m='3816880'>is</span> <span m='3817000'>a</span>
  <span m='3817060'>result</span> <span m='3817780'>of</span> <span m='3818080'>Garret</span>
  <span m='3818410'>Brodle</span> <span m='3819970'>from</span> <span m='3820390'>the</span>
  <span m='3820570'>late</span> <span m='3820810'>'90s,</span> <span m='3822160'>'97.</span>
  <span m='3824260'>For</span> <span m='3824410'>full</span> <span m='3824680'>persistence--</span>
  <span m='3825190'>so</span> <span m='3825340'>it's</span> <span m='3825460'>an</span>
  <span m='3825550'>open</span> <span m='3825790'>problem.</span> <span m='3827520'>I</span>
  <span m='3827610'>don't know</span> <span m='3827820'>if</span> <span m='3828070'>people</span>
  <span m='3828280'>have</span> <span m='3828400'>worked</span> <span m='3828580'>on</span>
  <span m='3828670'>that.</span> <span m='3835970'>All</span> <span m='3836030'>right.</span>
  <span m='3836300'>So</span> <span m='3837020'>some,</span> <span m='3837990'>mostly</span>
  <span m='3838400'>good</span> <span m='3838550'>results.</span> </p><p><span m='3839670'>Let's</span>
  <span m='3839780'>move</span> <span m='3839990'>on</span> <span m='3840170'>to</span>
  <span m='3840320'>confluent</span> <span m='3840680'>persistence</span> <span m='3841220'>where</span>
  <span m='3841340'>things</span> <span m='3841640'>get</span> <span m='3841880'>a</span>
  <span m='3841940'>lot</span> <span m='3842210'>more</span> <span m='3842540'>challenging.</span>
  <span m='3857520'>Lots</span> <span m='3857700'>of</span> <span m='3857760'>things</span>
  <span m='3857970'>go</span> <span m='3858120'>out</span> <span m='3858210'>the</span>
  <span m='3858300'>window</span> <span m='3858540'>with</span> <span m='3859085'>confluent</span>
  <span m='3859420'>persistence.</span> <span m='3860010'>In</span> <span m='3860100'>particular,</span>
  <span m='3860740'>your</span> <span m='3860940'>versions</span> <span m='3861330'>are</span>
  <span m='3861420'>now</span> <span m='3861690'>a</span> <span m='3861750'>DAG.</span>
  <span m='3863520'>It's</span> <span m='3863730'>a</span> <span m='3863790'>lot</span>
  <span m='3864030'>harder</span> <span m='3864300'>to</span> <span m='3864450'>linearize</span>
  <span m='3864960'>a</span> <span m='3865020'>DAG.</span> <span m='3865650'>Trees</span>
  <span m='3865920'>are</span> <span m='3866010'>not</span> <span m='3866310'>that</span>
  <span m='3866520'>far</span> <span m='3866850'>from</span> <span m='3867840'>pads.</span>
  <span m='3868980'>But</span> <span m='3870440'>DAGs</span> <span m='3870840'>are</span>
  <span m='3870930'>quite</span> <span m='3871140'>far</span> <span m='3871350'>from</span>
  <span m='3871500'>pads,</span> <span m='3871980'>unfortunately.</span> <span m='3873770'>But</span>
  <span m='3873870'>that's</span> <span m='3874050'>not</span> <span m='3874230'>all</span>
  <span m='3874440'>that</span> <span m='3874560'>goes</span> <span m='3874770'>wrong.</span>
  </p><p><span m='3884660'>Let</span> <span m='3884840'>me</span> <span m='3884990'>first</span>
  <span m='3885320'>tell</span> <span m='3885560'>you</span> <span m='3887840'>the</span>
  <span m='3887930'>kind</span> <span m='3888110'>of</span> <span m='3888230'>end</span>
  <span m='3888440'>effect</span> <span m='3888800'>as</span> <span m='3888920'>a</span>
  <span m='3888980'>user.</span> <span m='3890060'>Imagine</span> <span m='3890480'>you</span>
  <span m='3890600'>have</span> <span m='3890810'>a</span> <span m='3890990'>data</span>
  <span m='3891260'>structure.</span> <span m='3894830'>Think</span> <span m='3895010'>of</span>
  <span m='3895100'>it</span> <span m='3895190'>as</span> <span m='3896270'>a</span>
  <span m='3896360'>list,</span> <span m='3896750'>I</span> <span m='3896810'>guess,</span>
  <span m='3897140'>which</span> <span m='3897500'>is</span> <span m='3897650'>a</span>
  <span m='3897710'>list</span> <span m='3897950'>of</span> <span m='3898040'>characters</span>
  <span m='3898550'>in</span> <span m='3898670'>your</span> <span m='3898820'>document.</span>
  <span m='3899330'>You're</span> <span m='3900320'>using</span> <span m='3901070'>vi</span>
  <span m='3901550'>or</span> <span m='3901670'>Word,</span> <span m='3902090'>your</span>
  <span m='3902300'>favorite,</span> <span m='3902660'>whatever.</span> <span m='3903410'>It's</span>
  <span m='3903730'>a</span> <span m='3903770'>text</span> <span m='3904070'>editor.</span>
  <span m='3905060'>You've</span> <span m='3905180'>got</span> <span m='3905360'>a</span>
  <span m='3905390'>string</span> <span m='3905750'>of</span> <span m='3905840'>words.</span>
  </p><p><span m='3906680'>And</span> <span m='3906800'>now</span> <span m='3906950'>you</span>
  <span m='3907040'>like</span> <span m='3907220'>to</span> <span m='3907310'>do</span>
  <span m='3907460'>things</span> <span m='3907790'>like</span> <span m='3908270'>copy</span>
  <span m='3908720'>and</span> <span m='3908840'>paste.</span> <span m='3909785'>It's
  a</span> <span m='3910250'>nice</span> <span m='3910430'>operation.</span> <span
  m='3911270'>So</span> <span m='3911420'>you</span> <span m='3911570'>select</span>
  <span m='3912230'>an</span> <span m='3912380'>interval</span> <span m='3913490'>of</span>
  <span m='3913760'>the</span> <span m='3914270'>string</span> <span m='3915200'>and</span>
  <span m='3915440'>you</span> <span m='3915530'>copy</span> <span m='3915890'>it.</span>
  <span m='3916340'>And</span> <span m='3916460'>then</span> <span m='3916610'>you</span>
  <span m='3916730'>paste</span> <span m='3917090'>it</span> <span m='3917180'>somewhere</span>
  <span m='3917480'>else.</span> <span m='3918340'>So</span> <span m='3918440'>now</span>
  <span m='3918540'>you've</span> <span m='3918640'>got</span> <span m='3918740'>two</span>
  <span m='3918800'>copies</span> <span m='3919130'>of</span> <span m='3919220'>that</span>
  <span m='3919370'>string.</span> </p><p><span m='3921950'>This</span> <span m='3922220'>is,</span>
  <span m='3922850'>in</span> <span m='3923030'>some</span> <span m='3923240'>sense,</span>
  <span m='3923480'>what</span> <span m='3923630'>you</span> <span m='3923750'>might</span>
  <span m='3924050'>call</span> <span m='3924470'>a</span> <span m='3924660'>confluent</span>
  <span m='3925040'>operation,</span> <span m='3925610'>because--</span> <span m='3927960'>yeah,</span>
  <span m='3928400'>maybe</span> <span m='3928870'>a</span> <span m='3928940'>cleaner</span>
  <span m='3929240'>way</span> <span m='3929330'>to</span> <span m='3929420'>think</span>
  <span m='3929570'>of</span> <span m='3929630'>it</span> <span m='3929690'>is</span>
  <span m='3929790'>the</span> <span m='3929840'>following.</span> <span m='3930470'>You</span>
  <span m='3930560'>have</span> <span m='3930710'>your</span> <span m='3930800'>string.</span>
  <span m='3931910'>Now</span> <span m='3932060'>I</span> <span m='3932120'>have</span>
  <span m='3932270'>an</span> <span m='3932360'>operation,</span> <span m='3932810'>which</span>
  <span m='3932980'>is</span> <span m='3933080'>split</span> <span m='3933440'>it.</span>
  <span m='3933950'>So</span> <span m='3934100'>now</span> <span m='3934220'>I</span>
  <span m='3934280'>have</span> <span m='3934430'>two</span> <span m='3934580'>strings.</span>
  <span m='3936210'>OK. And</span> <span m='3936470'>now I</span> <span m='3936590'>have</span>
  <span m='3936800'>an</span> <span m='3936890'>operation,</span> <span m='3937310'>which</span>
  <span m='3937460'>is</span> <span m='3937580'>split</span> <span m='3937880'>it.</span>
  <span m='3938030'>Now</span> <span m='3938330'>I</span> <span m='3938420'>have</span>
  <span m='3938660'>three</span> <span m='3938870'>strings.</span> </p><p><span m='3941090'>OK.</span>
  <span m='3941270'>Now</span> <span m='3941480'>I</span> <span m='3941540'>have</span>
  <span m='3941690'>an</span> <span m='3941780'>operation</span> <span m='3942200'>which</span>
  <span m='3942350'>is</span> <span m='3942470'>concatenate.</span> <span m='3944280'>So</span>
  <span m='3945260'>I</span> <span m='3945410'>can,</span> <span m='3946190'>for</span>
  <span m='3946340'>example,</span> <span m='3946700'>reconstruct</span> <span m='3947330'>the</span>
  <span m='3947420'>original</span> <span m='3947810'>string--</span> <span m='3948210'>actually,</span>
  <span m='3948450'>I</span> <span m='3948530'>have</span> <span m='3948740'>the</span>
  <span m='3948830'>original</span> <span m='3949160'>string.</span> <span m='3949850'>No</span>
  <span m='3950180'>biggie.</span> <span m='3951940'>Let's</span> <span m='3952220'>say--</span>
  <span m='3953270'>because</span> <span m='3953480'>I</span> <span m='3953570'>have</span>
  <span m='3953750'>all</span> <span m='3953900'>versions.</span> <span m='3954470'>I</span>
  <span m='3954530'>never</span> <span m='3954770'>lose</span> <span m='3954980'>them.</span>
  <span m='3955520'>So</span> <span m='3955670'>now</span> <span m='3956090'>instead,</span>
  <span m='3956750'>I'm</span> <span m='3956870'>going</span> <span m='3957020'>to</span>
  <span m='3957200'>cut</span> <span m='3957470'>the</span> <span m='3957590'>string</span>
  <span m='3957860'>here,</span> <span m='3958160'>let's</span> <span m='3958310'>say.</span>
  <span m='3959090'>So</span> <span m='3959210'>now</span> <span m='3959420'>I</span>
  <span m='3959510'>have</span> <span m='3959930'>this</span> <span m='3961370'>and</span>
  <span m='3961700'>this.</span> <span m='3963710'>And</span> <span m='3964100'>now</span>
  <span m='3964310'>I</span> <span m='3964400'>can</span> <span m='3964580'>do</span>
  <span m='3964700'>things</span> <span m='3965030'>like</span> <span m='3965840'>concatenate</span>
  <span m='3966620'>from</span> <span m='3966860'>here</span> <span m='3967550'>to</span>
  <span m='3967700'>here</span> <span m='3968720'>to</span> <span m='3969020'>here.</span>
  <span m='3970010'>And</span> <span m='3970130'>I</span> <span m='3970220'>will</span>
  <span m='3970370'>get</span> <span m='3970730'>this</span> <span m='3971870'>plus</span>
  <span m='3972500'>this</span> <span m='3974150'>plus</span> <span m='3975140'>this.</span>
  </p><p><span m='3977130'>OK.</span> <span m='3977300'>This</span> <span m='3977570'>guy</span>
  <span m='3977870'>moved</span> <span m='3978200'>here.</span> <span m='3978710'>So</span>
  <span m='3978830'>that's</span> <span m='3979040'>a</span> <span m='3979100'>copy/paste</span>
  <span m='3979700'>operation</span> <span m='3980120'>with</span> <span m='3980240'>a</span>
  <span m='3980300'>constant</span> <span m='3980660'>number</span> <span m='3980870'>of</span>
  <span m='3980960'>splits</span> <span m='3981300'>and</span> <span m='3981410'>concatenates.</span>
  <span m='3982100'>I</span> <span m='3982190'>could</span> <span m='3982310'>also</span>
  <span m='3982460'>do</span> <span m='3982590'>cut</span> <span m='3982790'>and</span>
  <span m='3982880'>paste.</span> <span m='3983810'>With</span> <span m='3983970'>confluence,</span>
  <span m='3985220'>I</span> <span m='3985310'>can</span> <span m='3985460'>do</span>
  <span m='3985670'>crazy</span> <span m='3986000'>cuts</span> <span m='3986270'>and</span>
  <span m='3986360'>pastes</span> <span m='3986720'>in</span> <span m='3986810'>all</span>
  <span m='3986960'>sorts</span> <span m='3987230'>of</span> <span m='3987290'>ways.</span>
  <span m='3988950'>So</span> <span m='3989060'>what?</span> </p><p><span m='3989910'>Well,</span>
  <span m='3990770'>the so</span> <span m='3990980'>what</span> <span m='3991190'>is</span>
  <span m='3991520'>I</span> <span m='3991670'>can</span> <span m='3991820'>actually</span>
  <span m='3992120'>double</span> <span m='3992630'>the</span> <span m='3992750'>size</span>
  <span m='3993140'>of</span> <span m='3993230'>my</span> <span m='3993380'>data</span>
  <span m='3993530'>structure</span> <span m='3993990'>in</span> <span m='3994160'>a</span>
  <span m='3994220'>constant</span> <span m='3994550'>number</span> <span m='3994730'>of</span>
  <span m='3994820'>operations.</span> <span m='3996050'>I</span> <span m='3996140'>can</span>
  <span m='3996320'>take,</span> <span m='3996660'>for</span> <span m='3996760'>example,</span>
  <span m='3997110'>the</span> <span m='3997210'>entire</span> <span m='3997430'>string</span>
  <span m='3998270'>and</span> <span m='3998540'>concatenate</span> <span m='3999050'>it</span>
  <span m='3999110'>to</span> <span m='3999230'>itself.</span> <span m='4000160'>That</span>
  <span m='4000280'>will</span> <span m='4000400'>double</span> <span m='4000730'>the</span>
  <span m='4000820'>number</span> <span m='4001150'>of</span> <span m='4001240'>characters,</span>
  <span m='4001780'>number</span> <span m='4002020'>of</span> <span m='4002290'>elements</span>
  <span m='4002680'>in</span> <span m='4002830'>there.</span> <span m='4003740'>I</span>
  <span m='4003820'>can</span> <span m='4003940'>do</span> <span m='4004030'>that</span>
  <span m='4004120'>again</span> <span m='4004810'>and</span> <span m='4004900'>again</span>
  <span m='4005350'>and</span> <span m='4005470'>again.</span> </p><p><span m='4005900'>So</span>
  <span m='4006470'>in</span> <span m='4006940'>u</span> <span m='4007360'>updates,</span>
  <span m='4010510'>I</span> <span m='4010630'>can</span> <span m='4010840'>potentially</span>
  <span m='4011380'>get</span> <span m='4011740'>a</span> <span m='4011830'>data</span>
  <span m='4012040'>structure</span> <span m='4012370'>size</span> <span m='4012570'>2</span>
  <span m='4012780'>to the</span> <span m='4012860'>u.</span> <span m='4017770'>Kind
  of</span> <span m='4017830'>nifty.</span> <span m='4018610'>I</span> <span m='4018790'>think</span>
  <span m='4018930'>this</span> <span m='4019060'>is</span> <span m='4019270'>why</span>
  <span m='4019540'>confluence</span> <span m='4019810'>is</span> <span m='4020080'>cool.</span>
  <span m='4020350'>It's</span> <span m='4020470'>also</span> <span m='4020800'>why</span>
  <span m='4020980'>it's</span> <span m='4021100'>hard.</span> <span m='4022700'>So</span>
  <span m='4022880'>not</span> <span m='4023080'>a</span> <span m='4023140'>big</span>
  <span m='4023290'>surprise.</span> <span m='4023900'>But,</span> <span m='4024896'>here</span>
  <span m='4025354'>we go.</span> </p><p><span m='4028130'>In</span> <span m='4028250'>that</span>
  <span m='4028370'>case,</span> <span m='4028610'>the</span> <span m='4028730'>version</span>
  <span m='4029060'>DAG,</span> <span m='4030040'>for</span> <span m='4030170'>reference,</span>
  <span m='4031280'>looks</span> <span m='4032990'>like</span> <span m='4033200'>this.</span>
  <span m='4033490'>You're</span> <span m='4033560'>taking</span> <span m='4033830'>the</span>
  <span m='4033920'>same</span> <span m='4034190'>version,</span> <span m='4035120'>combining</span>
  <span m='4035690'>it.</span> <span m='4036180'>So</span> <span m='4036230'>here</span>
  <span m='4036410'>I'm</span> <span m='4036470'>assuming</span> <span m='4036800'>I</span>
  <span m='4036830'>have</span> <span m='4036980'>a</span> <span m='4037040'>concatenate</span>
  <span m='4037540'>operation.</span> <span m='4040460'>And</span> <span m='4040640'>so</span>
  <span m='4041780'>the</span> <span m='4042260'>effect</span> <span m='4042680'>here,</span>
  <span m='4043460'>every</span> <span m='4043670'>time</span> <span m='4043850'>I</span>
  <span m='4043910'>do</span> <span m='4044030'>this,</span> <span m='4044240'>I</span>
  <span m='4044300'>double</span> <span m='4044570'>the</span> <span m='4044690'>size.</span>
  </p><p><span m='4064210'>All right.</span> <span m='4064880'>What do</span> <span
  m='4065190'>I</span> <span m='4065280'>want</span> <span m='4065400'>to</span> <span
  m='4065460'>say</span> <span m='4065670'>about</span> <span m='4065850'>confluent</span>
  <span m='4066180'>persistence?</span> <span m='4066900'>All</span> <span m='4066960'>right.</span>
  <span m='4067170'>Let</span> <span m='4067290'>me</span> <span m='4067440'>start</span>
  <span m='4067740'>with</span> <span m='4068010'>the</span> <span m='4068160'>most</span>
  <span m='4068400'>general</span> <span m='4068820'>result,</span> <span m='4073060'>which</span>
  <span m='4073200'>is</span> <span m='4073320'>by</span> <span m='4073620'>Fiat</span>
  <span m='4073890'>and</span> <span m='4073980'>Kaplan</span> <span m='4074370'>in</span>
  <span m='4074490'>2003.</span> </p><p><span m='4084340'>They</span> <span m='4084500'>define</span>
  <span m='4085220'>a</span> <span m='4085290'>notion</span> <span m='4085640'>called</span>
  <span m='4085910'>effective</span> <span m='4086510'>depth</span> <span m='4087050'>of</span>
  <span m='4087200'>a version.</span> <span m='4089020'>Let</span> <span m='4089090'>me</span>
  <span m='4089210'>just</span> <span m='4089360'>write</span> <span m='4089540'>it</span>
  <span m='4089600'>down.</span> <span m='4101180'>It's</span> <span m='4101300'>kind</span>
  <span m='4101750'>of</span> <span m='4101810'>like</span> <span m='4102109'>if</span>
  <span m='4102290'>you</span> <span m='4103010'>took</span> <span m='4103970'>this</span>
  <span m='4104149'>DAG</span> <span m='4104870'>and</span> <span m='4104990'>expanded</span>
  <span m='4105620'>it</span> <span m='4105710'>out</span> <span m='4105890'>to</span>
  <span m='4106040'>be</span> <span m='4106160'>a</span> <span m='4106189'>tree</span>
  <span m='4106670'>of</span> <span m='4106910'>all</span> <span m='4107090'>possible</span>
  <span m='4107600'>paths.</span> <span m='4110340'>Instead</span> <span m='4110590'>of</span>
  <span m='4110660'>point</span> <span m='4110899'>to</span> <span m='4110960'>the</span>
  <span m='4111080'>same</span> <span m='4111319'>node,</span> <span m='4111529'>you</span>
  <span m='4111590'>could</span> <span m='4111710'>just</span> <span m='4111830'>duplicate</span>
  <span m='4112340'>that</span> <span m='4112520'>node</span> <span m='4113330'>and</span>
  <span m='4113450'>then</span> <span m='4113569'>have</span> <span m='4113750'>pointers</span>
  <span m='4114200'>left</span> <span m='4114439'>and</span> <span m='4114529'>right.</span>
  </p><p><span m='4115560'>OK.</span> <span m='4115760'>So</span> <span m='4115939'>if</span>
  <span m='4116029'>I</span> <span m='4116090'>did</span> <span m='4116240'>that,</span>
  <span m='4116359'>of</span> <span m='4116450'>course,</span> <span m='4116750'>this</span>
  <span m='4116930'>size</span> <span m='4117260'>grows</span> <span m='4117470'>exponentially.</span>
  <span m='4117979'>It</span> <span m='4118069'>explicitly</span> <span m='4118580'>represents</span>
  <span m='4119090'>the</span> <span m='4119180'>size</span> <span m='4119540'>of</span>
  <span m='4119630'>my</span> <span m='4119750'>data</span> <span m='4119930'>structure.</span>
  <span m='4121310'>At</span> <span m='4121399'>the</span> <span m='4121490'>bottom,</span>
  <span m='4121850'>if</span> <span m='4121970'>I</span> <span m='4122029'>have</span>
  <span m='4122240'>u</span> <span m='4122510'>things,</span> <span m='4122810'>I'm</span>
  <span m='4122840'>going</span> <span m='4122960'>to</span> <span m='4123020'>have</span>
  <span m='4123140'>2</span> <span m='4123310'>to the</span> <span m='4123430'>u</span>
  <span m='4123649'>leaves</span> <span m='4123920'>at</span> <span m='4124010'>the</span>
  <span m='4124100'>bottom.</span> </p><p><span m='4125960'>But</span> <span m='4126170'>then</span>
  <span m='4126350'>I</span> <span m='4126410'>can</span> <span m='4126560'>easily</span>
  <span m='4126890'>measure</span> <span m='4127729'>the</span> <span m='4127910'>number</span>
  <span m='4128420'>of</span> <span m='4128600'>paths</span> <span m='4129080'>from</span>
  <span m='4129260'>the</span> <span m='4129350'>root</span> <span m='4129529'>to</span>
  <span m='4129680'>the</span> <span m='4129800'>same</span> <span m='4130100'>version.</span>
  <span m='4130500'>At</span> <span m='4130600'>the</span> <span m='4130700'>bottom,</span>
  <span m='4130880'>I</span> <span m='4130939'>still</span> <span m='4131120'>label</span>
  <span m='4131479'>it,</span> <span m='4131600'>oh,</span> <span m='4131750'>those</span>
  <span m='4131930'>are</span> <span m='4132020'>all</span> <span m='4132330'>v.</span>
  <span m='4132620'>They're</span> <span m='4132740'>all</span> <span m='4132859'>the</span>
  <span m='4132979'>same</span> <span m='4133220'>version</span> <span m='4133729'>down</span>
  <span m='4133880'>there.</span> <span m='4134630'>So</span> <span m='4134779'>exponential</span>
  <span m='4135290'>number</span> <span m='4135500'>of</span> <span m='4135560'>paths,</span>
  <span m='4135859'>if</span> <span m='4135979'>I</span> <span m='4136040'>take</span>
  <span m='4136250'>log,</span> <span m='4136670'>I</span> <span m='4136760'>get</span>
  <span m='4136970'>what</span> <span m='4137090'>I</span> <span m='4137149'>call</span>
  <span m='4137330'>effective</span> <span m='4137750'>depth.</span> <span m='4138080'>It's</span>
  <span m='4138200'>like</span> <span m='4138380'>if</span> <span m='4138529'>you</span>
  <span m='4138620'>somehow</span> <span m='4139069'>could</span> <span m='4139250'>rebalance</span>
  <span m='4139880'>that</span> <span m='4140090'>tree,</span> <span m='4142250'>this</span>
  <span m='4142520'>is</span> <span m='4142670'>the</span> <span m='4143330'>best</span>
  <span m='4143660'>you</span> <span m='4143720'>could</span> <span m='4143870'>hope</span>
  <span m='4144020'>to</span> <span m='4144109'>do.</span> <span m='4145910'>It's</span>
  <span m='4146029'>not</span> <span m='4146210'>really</span> <span m='4146569'>a</span>
  <span m='4146630'>lower</span> <span m='4146840'>bound.</span> <span m='4147270'>But</span>
  <span m='4147319'>it's</span> <span m='4147470'>a</span> <span m='4147529'>number.</span>
  <span m='4148040'>It's</span> <span m='4148130'>a</span> <span m='4148189'>thing.</span>
  <span m='4149000'>OK.</span> </p><p><span m='4150470'>Then</span> <span m='4150859'>the</span>
  <span m='4150979'>result</span> <span m='4151310'>they</span> <span m='4151430'>achieve</span>
  <span m='4153410'>is</span> <span m='4153560'>that</span> <span m='4153680'>the</span>
  <span m='4153830'>overhead</span> <span m='4156979'>is</span> <span m='4157370'>log</span>
  <span m='4158210'>the</span> <span m='4158279'>number</span> <span m='4158510'>of</span>
  <span m='4158600'>updates</span> <span m='4159770'>plus--</span> <span m='4160130'>this</span>
  <span m='4160260'>is</span> <span m='4160340'>a</span> <span m='4160399'>multiplicative</span>
  <span m='4160970'>overhead,</span> <span m='4161399'>so</span> <span m='4161420'>you</span>
  <span m='4161510'>take</span> <span m='4161720'>your</span> <span m='4161840'>running</span>
  <span m='4162050'>time.</span> <span m='4162290'>You</span> <span m='4162380'>multiply</span>
  <span m='4162830'>it</span> <span m='4163340'>by</span> <span m='4163520'>this.</span>
  <span m='4165979'>And</span> <span m='4166160'>this</span> <span m='4166310'>is</span>
  <span m='4166460'>a</span> <span m='4166580'>time</span> <span m='4167600'>and</span>
  <span m='4167880'>a</span> <span m='4167920'>space</span> <span m='4168290'>overhead.</span>
  </p><p><span m='4171529'>So</span> <span m='4172010'>maximum</span> <span m='4172490'>effective</span>
  <span m='4172880'>depth</span> <span m='4173149'>of</span> <span m='4173270'>all</span>
  <span m='4173390'>versions,</span> <span m='4173750'>maybe</span> <span m='4174020'>even</span>
  <span m='4174260'>sum</span> <span m='4174590'>of</span> <span m='4174740'>effective</span>
  <span m='4175120'>depths,</span> <span m='4175470'>but</span> <span m='4175640'>we'll</span>
  <span m='4175979'>just</span> <span m='4176140'>say</span> <span m='4176510'>max</span>
  <span m='4176899'>to</span> <span m='4177050'>be</span> <span m='4177620'>safe.</span>
  <span m='4179100'>Sorry--</span> <span m='4180700'>sum</span> <span m='4180979'>over</span>
  <span m='4181189'>all</span> <span m='4181340'>the</span> <span m='4181430'>operations.</span>
  <span m='4181800'>This</span> <span m='4181880'>is</span> <span m='4182000'>per</span>
  <span m='4182240'>operation.</span> <span m='4183260'>You</span> <span m='4183350'>pay</span>
  <span m='4183560'>basically</span> <span m='4183890'>the</span> <span m='4184010'>effective</span>
  <span m='4184399'>depth</span> <span m='4184670'>of</span> <span m='4184760'>that</span>
  <span m='4184910'>operation</span> <span m='4187540'>as</span> <span m='4187729'>a</span>
  <span m='4187790'>factor.</span> </p><p><span m='4188779'>Now,</span> <span m='4189050'>the</span>
  <span m='4189170'>annoying</span> <span m='4189439'>thing</span> <span m='4189649'>is</span>
  <span m='4189830'>if</span> <span m='4189979'>you</span> <span m='4190100'>have</span>
  <span m='4190399'>this</span> <span m='4190609'>kind</span> <span m='4190819'>of</span>
  <span m='4190910'>set</span> <span m='4191069'>up</span> <span m='4191330'>where</span>
  <span m='4192380'>the</span> <span m='4192470'>size</span> <span m='4192890'>grew</span>
  <span m='4193250'>exponentially,</span> <span m='4194720'>then</span> <span m='4195160'>number</span>
  <span m='4195410'>of</span> <span m='4195480'>paths</span> <span m='4195700'>is</span>
  <span m='4195920'>exponential.</span> <span m='4196490'>Log</span> <span m='4196800'>of
  the</span> <span m='4196880'>number</span> <span m='4197060'>of</span> <span m='4197120'>paths</span>
  <span m='4197360'>is</span> <span m='4197480'>linear</span> <span m='4198440'>in</span>
  <span m='4198560'>u.</span> <span m='4199220'>And</span> <span m='4199310'>so</span>
  <span m='4199460'>this</span> <span m='4199640'>factor</span> <span m='4200930'>could</span>
  <span m='4201110'>be</span> <span m='4201320'>as</span> <span m='4201440'>much</span>
  <span m='4201800'>as</span> <span m='4203000'>u,</span> <span m='4204290'>linear</span>
  <span m='4204690'>slowdown.</span> </p><p><span m='4206420'>Now,</span> <span m='4206870'>Fiat</span>
  <span m='4207110'>and</span> <span m='4207200'>Kaplan</span> <span m='4207590'>argue</span>
  <span m='4207950'>linear</span> <span m='4208220'>slowdown</span> <span m='4208500'>is</span>
  <span m='4208580'>not</span> <span m='4208820'>that</span> <span m='4209030'>bad,</span>
  <span m='4209930'>because</span> <span m='4210470'>if</span> <span m='4210650'>you</span>
  <span m='4211010'>weren't</span> <span m='4211250'>even</span> <span m='4211550'>persistent,</span>
  <span m='4213110'>if</span> <span m='4213170'>you</span> <span m='4213260'>did</span>
  <span m='4213440'>this</span> <span m='4213620'>in</span> <span m='4213740'>the</span>
  <span m='4213830'>naive</span> <span m='4214250'>way</span> <span m='4215260'>of</span>
  <span m='4215420'>just</span> <span m='4216140'>recopying</span> <span m='4216860'>the</span>
  <span m='4216980'>data,</span> <span m='4218410'>you</span> <span m='4218620'>were</span>
  <span m='4218990'>actually</span> <span m='4219350'>spending</span> <span m='4220760'>exponential</span>
  <span m='4221360'>time</span> <span m='4221600'>to</span> <span m='4221660'>build</span>
  <span m='4221870'>the</span> <span m='4221960'>final</span> <span m='4222200'>data</span>
  <span m='4222340'>structure.</span> <span m='4222620'>It has</span> <span m='4222770'>exponential</span>
  <span m='4223190'>size.</span> <span m='4223550'>Just</span> <span m='4223700'>to</span>
  <span m='4223800'>represent</span> <span m='4224150'>it</span> <span m='4224330'>explicitly</span>
  <span m='4224930'>requires</span> <span m='4225440'>exponential</span> <span m='4225920'>time,</span>
  <span m='4226800'>so</span> <span m='4226880'>losing</span> <span m='4227210'>a</span>
  <span m='4227270'>linear</span> <span m='4227660'>factor</span> <span m='4228740'>to</span>
  <span m='4228860'>do</span> <span m='4229180'>u</span> <span m='4229310'>operations</span>
  <span m='4229820'>and</span> <span m='4229880'>now</span> <span m='4230060'>u</span>
  <span m='4230240'>squared</span> <span m='4230600'>time</span> <span m='4230840'>instead</span>
  <span m='4231080'>of</span> <span m='4231170'>2</span> <span m='4231450'>to the
  u.</span> <span m='4231800'>So</span> <span m='4231980'>it's</span> <span m='4232160'>a</span>
  <span m='4232220'>big</span> <span m='4232460'>improvement</span> <span m='4233450'>to</span>
  <span m='4233570'>do</span> <span m='4233720'>this.</span> </p><p><span m='4235190'>The</span>
  <span m='4235400'>downside</span> <span m='4236210'>of</span> <span m='4236360'>this</span>
  <span m='4236540'>approach</span> <span m='4237050'>is</span> <span m='4237260'>that</span>
  <span m='4237800'>even</span> <span m='4238070'>if</span> <span m='4238700'>you</span>
  <span m='4238850'>have</span> <span m='4239120'>a</span> <span m='4240050'>version</span>
  <span m='4240440'>DAG</span> <span m='4240680'>that</span> <span m='4240800'>looks</span>
  <span m='4241070'>like</span> <span m='4241280'>this,</span> <span m='4242090'>even</span>
  <span m='4242330'>if</span> <span m='4242450'>the</span> <span m='4242570'>size</span>
  <span m='4243080'>of</span> <span m='4243170'>the data</span> <span m='4243410'>structure</span>
  <span m='4243730'>is</span> <span m='4243830'>staying</span> <span m='4244400'>normal,</span>
  <span m='4244910'>staying</span> <span m='4245210'>linear,</span> <span m='4246500'>so</span>
  <span m='4246650'>this</span> <span m='4246860'>potential,</span> <span m='4247400'>you</span>
  <span m='4247520'>could</span> <span m='4247640'>be</span> <span m='4247730'>doubling</span>
  <span m='4248060'>the</span> <span m='4248120'>size.</span> <span m='4248360'>But</span>
  <span m='4248450'>we</span> <span m='4248540'>don't</span> <span m='4248690'>know</span>
  <span m='4248810'>what</span> <span m='4248900'>this</span> <span m='4249050'>merge</span>
  <span m='4249290'>operation</span> <span m='4249740'>is.</span> <span m='4249920'>Maybe</span>
  <span m='4250190'>it</span> <span m='4250280'>just</span> <span m='4250460'>throws</span>
  <span m='4250730'>away</span> <span m='4250970'>one</span> <span m='4251120'>of</span>
  <span m='4251180'>the</span> <span m='4251270'>versions</span> <span m='4251720'>or</span>
  <span m='4251810'>does</span> <span m='4251930'>something--</span> <span m='4253220'>somehow</span>
  <span m='4254060'>takes</span> <span m='4254300'>half</span> <span m='4254600'>the</span>
  <span m='4254720'>nodes</span> <span m='4254930'>from</span> <span m='4255080'>one</span>
  <span m='4255230'>side,</span> <span m='4255380'>half</span> <span m='4255590'>the
  nodes</span> <span m='4255830'>from the</span> <span m='4255920'>other</span> <span
  m='4256070'>side</span> <span m='4256280'>maybe.</span> <span m='4256550'>These</span>
  <span m='4256700'>operations</span> <span m='4257180'>do</span> <span m='4257330'>preserve</span>
  <span m='4257660'>size.</span> </p><p><span m='4258830'>Then</span> <span m='4259010'>there's</span>
  <span m='4259220'>no</span> <span m='4259580'>great</span> <span m='4259940'>reason</span>
  <span m='4260270'>why</span> <span m='4260480'>it</span> <span m='4260570'>should</span>
  <span m='4260750'>be</span> <span m='4261680'>a</span> <span m='4261740'>linear</span>
  <span m='4262070'>slowdown,</span> <span m='4262520'>but</span> <span m='4262790'>it</span>
  <span m='4262910'>is.</span> <span m='4264000'>OK?</span> <span m='4264170'>So</span>
  <span m='4265630'>it's</span> <span m='4266320'>all</span> <span m='4266560'>right</span>
  <span m='4266870'>but</span> <span m='4267050'>not</span> <span m='4267320'>great.</span>
  <span m='4270830'>And</span> <span m='4270950'>it's</span> <span m='4271070'>the</span>
  <span m='4271190'>best</span> <span m='4271400'>general</span> <span m='4271700'>result</span>
  <span m='4272000'>we</span> <span m='4272090'>know.</span> </p><p><span m='4273560'>They</span>
  <span m='4273740'>also</span> <span m='4274400'>prove</span> <span m='4274760'>a</span>
  <span m='4274820'>lower</span> <span m='4275150'>bound.</span> <span m='4281420'>So</span>
  <span m='4281930'>lower</span> <span m='4282230'>bound</span> <span m='4282620'>is</span>
  <span m='4284480'>some</span> <span m='4285690'>effect</span> <span m='4286060'>of</span>
  <span m='4286160'>depth,</span> <span m='4288290'>total</span> <span m='4289430'>bits</span>
  <span m='4289850'>of</span> <span m='4290000'>space.</span> <span m='4297300'>OK.</span>
  <span m='4297730'>What</span> <span m='4297910'>does</span> <span m='4298090'>this</span>
  <span m='4298330'>mean?</span> </p><p><span m='4300020'>So</span> <span m='4300310'>even</span>
  <span m='4300550'>if</span> <span m='4300640'>this</span> <span m='4300820'>is</span>
  <span m='4300940'>not</span> <span m='4301120'>happening,</span> <span m='4302170'>the</span>
  <span m='4302260'>number</span> <span m='4302530'>of</span> <span m='4302590'>bits</span>
  <span m='4302890'>of</span> <span m='4302950'>space</span> <span m='4303310'>you</span>
  <span m='4303430'>need</span> <span m='4304150'>in</span> <span m='4304570'>the</span>
  <span m='4304720'>worst</span> <span m='4305050'>case--</span> <span m='4305320'>this
  does</span> <span m='4305560'>not</span> <span m='4305800'>apply</span> <span m='4306430'>to</span>
  <span m='4306820'>every</span> <span m='4307120'>data</span> <span m='4307330'>structure.</span>
  <span m='4307810'>That's</span> <span m='4308050'>one</span> <span m='4308230'>catch.</span>
  <span m='4309790'>They</span> <span m='4309940'>give</span> <span m='4310120'>a</span>
  <span m='4310240'>specific</span> <span m='4310840'>data</span> <span m='4311080'>structure</span>
  <span m='4312070'>where</span> <span m='4312220'>you</span> <span m='4312340'>need</span>
  <span m='4312490'>this</span> <span m='4312670'>much</span> <span m='4312880'>space.</span>
  <span m='4313630'>So</span> <span m='4313780'>it's</span> <span m='4314200'>similar</span>
  <span m='4314680'>to</span> <span m='4314950'>this</span> <span m='4315100'>kind</span>
  <span m='4315280'>of</span> <span m='4315400'>picture.</span> <span m='4317050'>We'll</span>
  <span m='4317170'>go</span> <span m='4317290'>into</span> <span m='4317470'>the</span>
  <span m='4317530'>details.</span> </p><p><span m='4318940'>And</span> <span m='4319120'>you</span>
  <span m='4319240'>need</span> <span m='4320020'>this</span> <span m='4320230'>much</span>
  <span m='4320470'>space.</span> <span m='4320860'>Now,</span> <span m='4321040'>this</span>
  <span m='4321250'>is</span> <span m='4321460'>kind</span> <span m='4321700'>of</span>
  <span m='4321760'>bad,</span> <span m='4322030'>because</span> <span m='4322450'>if</span>
  <span m='4322570'>there's</span> <span m='4322720'>u</span> <span m='4322900'>operations,</span>
  <span m='4323230'>and</span> <span m='4323560'>each</span> <span m='4323740'>of</span>
  <span m='4323800'>these</span> <span m='4324010'>is</span> <span m='4324130'>u,</span>
  <span m='4325000'>that's</span> <span m='4325510'>u</span> <span m='4325720'>squared</span>
  <span m='4326100'>space.</span> <span m='4326440'>So</span> <span m='4326540'>we</span>
  <span m='4326620'>actually</span> <span m='4326890'>need</span> <span m='4327040'>a</span>
  <span m='4327130'>factor</span> <span m='4327520'>u</span> <span m='4327880'>blow
  up</span> <span m='4328540'>in</span> <span m='4328660'>space.</span> <span m='4329395'>It</span>
  <span m='4329650'>looks</span> <span m='4329830'>like.</span> </p><p><span m='4331290'>But</span>
  <span m='4331570'>to</span> <span m='4331780'>be</span> <span m='4332200'>more</span>
  <span m='4332380'>precise,</span> <span m='4333400'>what</span> <span m='4333520'>this</span>
  <span m='4333670'>means</span> <span m='4333970'>is</span> <span m='4334150'>that</span>
  <span m='4334270'>you</span> <span m='4334420'>need</span> <span m='4334780'>omega</span>
  <span m='4335790'>e</span> <span m='4335940'>of</span> <span m='4336090'>v</span>
  <span m='4336340'>space,</span> <span m='4336850'>and</span> <span m='4336940'>therefore</span>
  <span m='4337270'>time</span> <span m='4339550'>overhead</span> <span m='4341830'>per</span>
  <span m='4342040'>update,</span> <span m='4345700'>if--</span> <span m='4347830'>this</span>
  <span m='4347980'>is</span> <span m='4348100'>not</span> <span m='4348310'>written</span>
  <span m='4348520'>in</span> <span m='4348610'>the</span> <span m='4348730'>paper--</span>
  <span m='4349570'>queries</span> <span m='4350080'>are</span> <span m='4350200'>free.</span>
  <span m='4355300'>Implicit</span> <span m='4355840'>here,</span> <span m='4358480'>they</span>
  <span m='4358630'>just</span> <span m='4358780'>want</span> <span m='4358900'>to</span>
  <span m='4358960'>slow</span> <span m='4359200'>down</span> <span m='4359560'>and</span>
  <span m='4359710'>increase</span> <span m='4360010'>space</span> <span m='4360400'>for</span>
  <span m='4360670'>the</span> <span m='4360820'>updates</span> <span m='4361190'>you</span>
  <span m='4361310'>do,</span> <span m='4361540'>which</span> <span m='4361960'>is</span>
  <span m='4362230'>pretty</span> <span m='4362470'>natural.</span> <span m='4363310'>Normally</span>
  <span m='4363580'>you</span> <span m='4363670'>think</span> <span m='4363850'>of</span>
  <span m='4363940'>queries</span> <span m='4364360'>as</span> <span m='4364450'>not</span>
  <span m='4364660'>increasing</span> <span m='4365170'>space.</span> </p><p><span
  m='4366870'>But</span> <span m='4367080'>in</span> <span m='4367230'>order</span>
  <span m='4367500'>to</span> <span m='4367770'>construct</span> <span m='4368220'>this</span>
  <span m='4368370'>lower</span> <span m='4368640'>bound,</span> <span m='4369600'>they</span>
  <span m='4369780'>actually</span> <span m='4370140'>do</span> <span m='4370410'>this</span>
  <span m='4370740'>many</span> <span m='4371010'>queries.</span> <span m='4372360'>So</span>
  <span m='4372480'>they</span> <span m='4372600'>do</span> <span m='4372720'>e of
  v</span> <span m='4373170'>queries</span> <span m='4374220'>and</span> <span m='4374310'>then</span>
  <span m='4374460'>one</span> <span m='4374670'>update.</span> <span m='4375900'>And</span>
  <span m='4376020'>they</span> <span m='4376140'>say,</span> <span m='4376320'>oh</span>
  <span m='4376470'>well,</span> <span m='4376920'>space</span> <span m='4377250'>had</span>
  <span m='4377370'>to</span> <span m='4377460'>go</span> <span m='4377580'>up</span>
  <span m='4377660'>by</span> <span m='4378360'>an</span> <span m='4378480'>extra</span>
  <span m='4378840'>e of v.</span> <span m='4379410'>So</span> <span m='4380340'>if</span>
  <span m='4380490'>you</span> <span m='4380610'>only</span> <span m='4380880'>charge</span>
  <span m='4381180'>updates</span> <span m='4381540'>for</span> <span m='4381720'>the</span>
  <span m='4381810'>space,</span> <span m='4382470'>then</span> <span m='4382620'>yes,</span>
  <span m='4382950'>you</span> <span m='4383100'>have</span> <span m='4383250'>to</span>
  <span m='4383340'>lose</span> <span m='4383670'>potentially</span> <span m='4384120'>a</span>
  <span m='4384180'>linear</span> <span m='4384480'>factor,</span> <span m='4385210'>this</span>
  <span m='4385710'>effect</span> <span m='4386010'>of</span> <span m='4386110'>death,</span>
  <span m='4386765'>potentially</span> <span m='4386980'>u.</span> </p><p><span m='4387780'>But</span>
  <span m='4388050'>if</span> <span m='4388230'>you</span> <span m='4388380'>also</span>
  <span m='4388680'>charge</span> <span m='4388920'>the</span> <span m='4389010'>queries,</span>
  <span m='4389550'>it's</span> <span m='4389670'>still</span> <span m='4389970'>constant</span>
  <span m='4392070'>in</span> <span m='4392190'>their</span> <span m='4392340'>example.</span>
  <span m='4393270'>So</span> <span m='4393450'>open</span> <span m='4393720'>question,</span>
  <span m='4396390'>for</span> <span m='4396540'>confluent</span> <span m='4396960'>persistence,</span>
  <span m='4398100'>can</span> <span m='4398310'>you</span> <span m='4398460'>achieve</span>
  <span m='4399450'>constant</span> <span m='4399930'>everything?</span> <span m='4401130'>Constant</span>
  <span m='4402210'>time</span> <span m='4403690'>and</span> <span m='4403800'>space</span>
  <span m='4404130'>overheads,</span> <span m='4407160'>multiplicative</span> <span
  m='4407730'>factor</span> <span m='4410250'>per</span> <span m='4410610'>operation,</span>
  <span m='4413610'>both</span> <span m='4413970'>updates</span> <span m='4414360'>and</span>
  <span m='4414570'>queries.</span> <span m='4415630'>So</span> <span m='4415650'>if</span>
  <span m='4415770'>you</span> <span m='4415860'>charge</span> <span m='4416220'>the</span>
  <span m='4416310'>queries,</span> <span m='4416640'>potentially</span> <span m='4417240'>you</span>
  <span m='4417300'>could</span> <span m='4417450'>get</span> <span m='4417570'>constant</span>
  <span m='4417930'>everything.</span> </p><p><span m='4418980'>This</span> <span
  m='4419130'>is</span> <span m='4419190'>a</span> <span m='4419250'>relatively</span>
  <span m='4419910'>new</span> <span m='4420090'>realization.</span> <span m='4423890'>And</span>
  <span m='4424170'>no</span> <span m='4424380'>one</span> <span m='4424500'>knows</span>
  <span m='4424680'>how</span> <span m='4424800'>to</span> <span m='4424890'>do</span>
  <span m='4425010'>this</span> <span m='4425280'>yet.</span> <span m='4427380'>Nice</span>
  <span m='4427590'>challenge.</span> <span m='4427950'>I</span> <span m='4428010'>think</span>
  <span m='4428190'>maybe</span> <span m='4428390'>we'll</span> <span m='4428520'>work</span>
  <span m='4428730'>on</span> <span m='4428850'>that</span> <span m='4429120'>in our</span>
  <span m='4429690'>first</span> <span m='4429930'>problem</span> <span m='4430230'>session.</span>
  <span m='4430530'>I</span> <span m='4430590'>would</span> <span m='4430740'>like</span>
  <span m='4430890'>to.</span> </p><p><span m='4433600'>Questions</span> <span m='4433900'>about</span>
  <span m='4434080'>that</span> <span m='4434230'>result?</span> <span m='4434770'>I'm</span>
  <span m='4434830'>not</span> <span m='4435010'>going</span> <span m='4435160'>to</span>
  <span m='4435250'>prove</span> <span m='4435520'>the</span> <span m='4435610'>result.</span>
  <span m='4436450'>But</span> <span m='4436630'>it</span> <span m='4436720'>is</span>
  <span m='4437750'>a</span> <span m='4437800'>fancy</span> <span m='4438370'>rebalancing</span>
  <span m='4439060'>of</span> <span m='4439150'>those</span> <span m='4439330'>kinds</span>
  <span m='4439540'>of</span> <span m='4439600'>pictures</span> <span m='4441010'>to</span>
  <span m='4441130'>get</span> <span m='4441790'>this</span> <span m='4441940'>log.</span>
  <span m='4450590'>There</span> <span m='4450680'>are</span> <span m='4450740'>other</span>
  <span m='4450890'>results</span> <span m='4451205'>I'd</span> <span m='4451520'>like</span>
  <span m='4451730'>to</span> <span m='4451850'>tell</span> <span m='4452060'>you</span>
  <span m='4452150'>about.</span> </p><p><span m='4472630'>So</span> <span m='4472810'>brand</span>
  <span m='4473050'>new</span> <span m='4473170'>result--</span> <span m='4474710'>that</span>
  <span m='4474920'>was</span> <span m='4475150'>from</span> <span m='4475300'>2003.</span>
  <span m='4475980'>This</span> <span m='4476140'>is</span> <span m='4476260'>from</span>
  <span m='4476410'>2012--</span> <span m='4478300'>no,</span> <span m='4479450'>'11,</span>
  <span m='4480020'>'11,</span> <span m='4480390'>sorry.</span> <span m='4482590'>It's</span>
  <span m='4483010'>SOTO,</span> <span m='4483160'>which is</span> <span m='4483250'>in</span>
  <span m='4483370'>January,</span> <span m='4483630'>so it's</span> <span m='4484030'>a</span>
  <span m='4484330'>little</span> <span m='4484540'>confusing.</span> <span m='4487480'>Is
  it</span> <span m='4487870'>'11?</span> <span m='4489250'>Maybe</span> <span m='4489460'>'12.</span>
  <span m='4490430'>Actually</span> <span m='4491000'>now</span> <span m='4491200'>I'm
  not sure.</span> <span m='4491350'>It's</span> <span m='4491440'>February</span>
  <span m='4491840'>already,</span> <span m='4492110'>right?</span> <span m='4494750'>A</span>
  <span m='4495220'>January,</span> <span m='4495820'>either</span> <span m='4496000'>this</span>
  <span m='4496180'>year</span> <span m='4496360'>or</span> <span m='4496390'>last</span>
  <span m='4496690'>year.</span> </p><p><span m='4500310'>It's</span> <span m='4500440'>not</span>
  <span m='4500680'>as</span> <span m='4500860'>general</span> <span m='4501610'>a</span>
  <span m='4501700'>transformation.</span> <span m='4502840'>It's</span> <span m='4502990'>only</span>
  <span m='4503170'>going</span> <span m='4503290'>to</span> <span m='4503350'>hold</span>
  <span m='4503560'>in</span> <span m='4503680'>what's</span> <span m='4503830'>called</span>
  <span m='4504010'>a</span> <span m='4504070'>disjoint</span> <span m='4504490'>case.</span>
  <span m='4505330'>But</span> <span m='4505740'>it</span> <span m='4505900'>gets</span>
  <span m='4506110'>a</span> <span m='4506170'>very</span> <span m='4506350'>good</span>
  <span m='4506500'>bound--</span> <span m='4507820'>not</span> <span m='4508000'>quite</span>
  <span m='4508240'>constant,</span> <span m='4508690'>but</span> <span m='4508870'>logarithmic.</span>
  <span m='4509850'>OK,</span> <span m='4510120'>logarithmic</span> <span m='4510610'>would</span>
  <span m='4510730'>also</span> <span m='4510940'>be</span> <span m='4511030'>nice.</span>
  <span m='4512420'>Or</span> <span m='4512680'>log,</span> <span m='4514690'>log</span>
  <span m='4514990'>n,</span> <span m='4515770'>whatever</span> <span m='4516070'>n</span>
  <span m='4516400'>is.</span> <span m='4517075'>Pick</span> <span m='4517480'>your</span>
  <span m='4517570'>favorite</span> <span m='4517870'>n,</span> <span m='4519970'>number</span>
  <span m='4520180'>of</span> <span m='4520240'>operations,</span> <span m='4520860'>say.</span>
  </p><p><span m='4522590'>OK.</span> <span m='4525700'>If</span> <span m='4525880'>you</span>
  <span m='4526060'>assume</span> <span m='4527920'>that</span> <span m='4528130'>confluent</span>
  <span m='4528790'>operations</span> <span m='4534430'>are</span> <span m='4534580'>performed</span>
  <span m='4538300'>only</span> <span m='4539830'>on</span> <span m='4540280'>two</span>
  <span m='4540490'>versions</span> <span m='4544660'>with</span> <span m='4544930'>no</span>
  <span m='4545290'>shared</span> <span m='4545770'>nodes--</span> <span m='4550360'>OK,</span>
  <span m='4550510'>this</span> <span m='4550690'>would</span> <span m='4550840'>be</span>
  <span m='4551680'>a</span> <span m='4551860'>way</span> <span m='4552280'>to</span>
  <span m='4552460'>forbid</span> <span m='4553000'>this</span> <span m='4553180'>kind</span>
  <span m='4553330'>of</span> <span m='4553420'>behavior</span> <span m='4553870'>where</span>
  <span m='4553990'>I</span> <span m='4554050'>concatenate</span> <span m='4554710'>the</span>
  <span m='4554800'>data</span> <span m='4554980'>structure</span> <span m='4555340'>with</span>
  <span m='4555550'>itself.</span> <span m='4556660'>All</span> <span m='4556930'>the</span>
  <span m='4557050'>nodes</span> <span m='4557320'>are</span> <span m='4557410'>common.</span>
  </p><p><span m='4558520'>If</span> <span m='4559120'>I</span> <span m='4559270'>guarantee</span>
  <span m='4559840'>that</span> <span m='4559960'>maybe</span> <span m='4560260'>I,</span>
  <span m='4560380'>you</span> <span m='4560530'>know,</span> <span m='4560650'>slice</span>
  <span m='4561190'>this</span> <span m='4561340'>up,</span> <span m='4561550'>slice</span>
  <span m='4561910'>it,</span> <span m='4562100'>dice</span> <span m='4562270'>it,</span>
  <span m='4562390'>wherever,</span> <span m='4562750'>and</span> <span m='4562840'>then</span>
  <span m='4562960'>re-emerge</span> <span m='4563440'>them</span> <span m='4563590'>in</span>
  <span m='4563680'>some</span> <span m='4563890'>other</span> <span m='4564070'>order,</span>
  <span m='4564880'>but</span> <span m='4565030'>I</span> <span m='4565120'>never</span>
  <span m='4565420'>use</span> <span m='4565690'>two</span> <span m='4565870'>copies</span>
  <span m='4566230'>of</span> <span m='4566290'>the</span> <span m='4566380'>same</span>
  <span m='4566710'>piece,</span> <span m='4568180'>that</span> <span m='4568360'>would</span>
  <span m='4568510'>be</span> <span m='4569140'>a</span> <span m='4569230'>valid</span>
  <span m='4569680'>confluent</span> <span m='4570130'>operation</span> <span m='4570640'>over</span>
  <span m='4570820'>here.</span> <span m='4572260'>This is</span> <span m='4572500'>quite</span>
  <span m='4572770'>a</span> <span m='4572830'>strong</span> <span m='4573160'>restriction</span>
  <span m='4573880'>that</span> <span m='4574000'>you're</span> <span m='4574150'>not</span>
  <span m='4574330'>allowed.</span> <span m='4576580'>If</span> <span m='4576760'>you</span>
  <span m='4576850'>try</span> <span m='4577120'>to,</span> <span m='4578110'>who</span>
  <span m='4578260'>knows</span> <span m='4578530'>what</span> <span m='4578620'>happens.</span>
  <span m='4579030'>Behavior's</span> <span m='4579370'>undefined.</span> <span m='4579980'>So</span>
  <span m='4580030'>won't</span> <span m='4580210'>tell</span> <span m='4580450'>you,</span>
  <span m='4580670'>oh,</span> <span m='4581290'>those</span> <span m='4581440'>two</span>
  <span m='4581530'>versions</span> <span m='4581830'>have</span> <span m='4581950'>this</span>
  <span m='4582070'>node</span> <span m='4582220'>in</span> <span m='4582310'>common.</span>
  <span m='4582640'>You've</span> <span m='4582760'>got</span> <span m='4582880'>to</span>
  <span m='4582970'>make</span> <span m='4583150'>a</span> <span m='4583210'>second</span>
  <span m='4583510'>copy</span> <span m='4583840'>of</span> <span m='4583990'>it.</span>
  </p><p><span m='4584600'>So</span> <span m='4584750'>somehow</span> <span m='4585070'>you</span>
  <span m='4585130'>have</span> <span m='4585220'>to</span> <span m='4585340'>guarantee</span>
  <span m='4585910'>that</span> <span m='4586030'>control</span> <span m='4586300'>and</span>
  <span m='4586390'>operations</span> <span m='4586930'>never</span> <span m='4587920'>overlap.</span>
  <span m='4589270'>But</span> <span m='4589420'>they</span> <span m='4589540'>can</span>
  <span m='4589660'>be</span> <span m='4589780'>reordered.</span> <span m='4593740'>Then</span>
  <span m='4595300'>you</span> <span m='4595420'>can</span> <span m='4595600'>get</span>
  <span m='4596050'>order</span> <span m='4596380'>log</span> <span m='4596680'>n</span>
  <span m='4597010'>overhead.</span> <span m='4599500'>n</span> <span m='4599710'>is
  the</span> <span m='4599890'>number</span> <span m='4600100'>of</span> <span m='4600190'>operations.</span>
  </p><p><span m='4605390'>I</span> <span m='4605560'>have</span> <span m='4605830'>a</span>
  <span m='4605890'>sketch</span> <span m='4606250'>of</span> <span m='4606370'>a</span>
  <span m='4606430'>proof</span> <span m='4606660'>of</span> <span m='4606730'>this</span>
  <span m='4606970'>but</span> <span m='4607210'>not</span> <span m='4607540'>very</span>
  <span m='4607690'>much</span> <span m='4607900'>time</span> <span m='4608080'>to</span>
  <span m='4608140'>talk</span> <span m='4608380'>about</span> <span m='4608620'>it.</span>
  <span m='4609160'>All</span> <span m='4609220'>right.</span> <span m='4609370'>Let</span>
  <span m='4609490'>me</span> <span m='4609610'>give</span> <span m='4609820'>you</span>
  <span m='4610000'>a</span> <span m='4610060'>quick</span> <span m='4610300'>picture.</span>
  <span m='4611570'>In</span> <span m='4611710'>general,</span> <span m='4613120'>the</span>
  <span m='4613210'>versions</span> <span m='4613570'>form</span> <span m='4613850'>a</span>
  <span m='4614080'>DAG.</span> <span m='4615790'>But</span> <span m='4616090'>if</span>
  <span m='4616240'>you</span> <span m='4616330'>make</span> <span m='4616540'>this</span>
  <span m='4616750'>assumption,</span> <span m='4617890'>and</span> <span m='4618010'>you</span>
  <span m='4618100'>look</span> <span m='4618280'>at</span> <span m='4618400'>a</span>
  <span m='4618460'>single</span> <span m='4619090'>node,</span> <span m='4620950'>and</span>
  <span m='4621070'>look</span> <span m='4621220'>at</span> <span m='4621280'>all</span>
  <span m='4621490'>the</span> <span m='4621580'>versions</span> <span m='4621940'>where</span>
  <span m='4622060'>that</span> <span m='4622270'>node</span> <span m='4622480'>appears,</span>
  <span m='4623620'>that</span> <span m='4623980'>is</span> <span m='4624160'>a</span>
  <span m='4624220'>tree.</span> <span m='4625210'>Because</span> <span m='4625660'>you're</span>
  <span m='4625810'>not</span> <span m='4625990'>allowed</span> <span m='4626260'>to</span>
  <span m='4626440'>remerge</span> <span m='4626920'>versions</span> <span m='4627370'>that</span>
  <span m='4627460'>have</span> <span m='4627640'>the</span> <span m='4627730'>same</span>
  <span m='4627940'>node.</span> </p><p><span m='4628720'>So</span> <span m='4629320'>while</span>
  <span m='4629500'>the</span> <span m='4629620'>big</span> <span m='4629830'>picture</span>
  <span m='4630160'>is</span> <span m='4630280'>a</span> <span m='4630340'>DAG,</span>
  <span m='4631480'>the</span> <span m='4631630'>small</span> <span m='4631960'>picture</span>
  <span m='4632320'>of</span> <span m='4632410'>a</span> <span m='4632470'>single</span>
  <span m='4632920'>guy</span> <span m='4633820'>is</span> <span m='4634000'>some</span>
  <span m='4634630'>tree.</span> <span m='4637770'>I'm</span> <span m='4638020'>drawing</span>
  <span m='4638290'>all</span> <span m='4638380'>these</span> <span m='4638500'>wiggly</span>
  <span m='4638740'>lines</span> <span m='4638920'>because</span> <span m='4639070'>there
  are</span> <span m='4639170'>all</span> <span m='4639310'>these</span> <span m='4639490'>versions</span>
  <span m='4639850'>where</span> <span m='4640000'>the</span> <span m='4640090'>node</span>
  <span m='4640300'>isn't</span> <span m='4640510'>changing.</span> <span m='4641560'>This</span>
  <span m='4641740'>is</span> <span m='4641830'>the</span> <span m='4641920'>entire</span>
  <span m='4642280'>version</span> <span m='4642610'>DAG.</span> <span m='4643300'>And</span>
  <span m='4643390'>then</span> <span m='4643510'>some</span> <span m='4643900'>of</span>
  <span m='4643990'>these</span> <span m='4644200'>nodes--</span> <span m='4646540'>some</span>
  <span m='4646780'>of</span> <span m='4646870'>these</span> <span m='4647380'>versions,</span>
  <span m='4647980'>I</span> <span m='4648040'>should</span> <span m='4648250'>say--</span>
  <span m='4649000'>that</span> <span m='4649210'>node</span> <span m='4649480'>that</span>
  <span m='4649630'>we're</span> <span m='4649780'>thinking</span> <span m='4650170'>about</span>
  <span m='4650800'>changes.</span> </p><p><span m='4651925'>OK,</span> <span m='4652330'>whenever</span>
  <span m='4652660'>it</span> <span m='4652720'>branches,</span> <span m='4653350'>it's</span>
  <span m='4653410'>probably</span> <span m='4653860'>because</span> <span m='4654370'>the</span>
  <span m='4654640'>actual</span> <span m='4655060'>node</span> <span m='4655350'>changed,</span>
  <span m='4656100'>maybe.</span> <span m='4656410'>I</span> <span m='4656470'>don't</span>
  <span m='4656590'>know.</span> <span m='4657470'>Anyway</span> <span m='4657880'>there</span>
  <span m='4658000'>are</span> <span m='4658040'>some</span> <span m='4658210'>dots</span>
  <span m='4658540'>here</span> <span m='4659320'>where</span> <span m='4659470'>the</span>
  <span m='4659590'>version</span> <span m='4659860'>changed,</span> <span m='4660170'>some</span>
  <span m='4660340'>of</span> <span m='4660430'>the</span> <span m='4660490'>leaves,</span>
  <span m='4660970'>maybe,</span> <span m='4661110'>that</span> <span m='4661420'>changed.</span>
  <span m='4661960'>Maybe</span> <span m='4662200'>some</span> <span m='4662380'>of</span>
  <span m='4662440'>them</span> <span m='4662680'>haven't</span> <span m='4663040'>yet.</span>
  </p><p><span m='4664420'>In</span> <span m='4664540'>fact,</span> <span m='4666830'>let's</span>
  <span m='4666880'>see.</span> <span m='4668350'>Here</span> <span m='4668740'>where</span>
  <span m='4668920'>it's</span> <span m='4669070'>change,</span> <span m='4669620'>it</span>
  <span m='4669720'>could</span> <span m='4669760'>be</span> <span m='4669910'>that</span>
  <span m='4670000'>we</span> <span m='4670300'>destroyed</span> <span m='4670660'>the</span>
  <span m='4670780'>node.</span> <span m='4671170'>Maybe</span> <span m='4671350'>it's</span>
  <span m='4671440'>gone</span> <span m='4671860'>from</span> <span m='4672500'>the</span>
  <span m='4672580'>actual</span> <span m='4672910'>data</span> <span m='4673120'>structure.</span>
  <span m='4674560'>But</span> <span m='4674710'>there</span> <span m='4674810'>still</span>
  <span m='4674980'>may</span> <span m='4675100'>be</span> <span m='4675220'>versions</span>
  <span m='4675580'>down</span> <span m='4675790'>here.</span> <span m='4676870'>It's</span>
  <span m='4676960'>not</span> <span m='4677080'>really</span> <span m='4677230'>a</span>
  <span m='4677260'>tree.</span> <span m='4677500'>It's</span> <span m='4677640'>a</span>
  <span m='4677710'>whole</span> <span m='4677860'>DAG</span> <span m='4678190'>of</span>
  <span m='4678280'>stuff</span> <span m='4679150'>down</span> <span m='4679330'>there.</span>
  <span m='4679480'>So</span> <span m='4679630'>that's</span> <span m='4679810'>kind</span>
  <span m='4679990'>of</span> <span m='4680110'>ugly.</span> </p><p><span m='4681400'>Where</span>
  <span m='4681590'>never</span> <span m='4681900'>the</span> <span m='4681990'>node</span>
  <span m='4682120'>still</span> <span m='4682390'>exists,</span> <span m='4683080'>I</span>
  <span m='4683170'>guess</span> <span m='4683650'>that</span> <span m='4683830'>is</span>
  <span m='4683950'>an</span> <span m='4684070'>actual</span> <span m='4684430'>leaf</span>
  <span m='4684760'>of</span> <span m='4684880'>the</span> <span m='4684970'>DAG.</span>
  <span m='4685300'>So</span> <span m='4685420'>those</span> <span m='4685630'>are</span>
  <span m='4685720'>OK.</span> <span m='4686650'>But</span> <span m='4686830'>as</span>
  <span m='4686890'>soon</span> <span m='4687070'>as</span> <span m='4687220'>I</span>
  <span m='4687700'>maybe</span> <span m='4688030'>delete</span> <span m='4688360'>that</span>
  <span m='4688540'>node,</span> <span m='4688870'>then</span> <span m='4689020'>there</span>
  <span m='4689140'>can</span> <span m='4689260'>be</span> <span m='4689350'>a</span>
  <span m='4689410'>whole</span> <span m='4689560'>subtree</span> <span m='4689990'>down</span>
  <span m='4690160'>there.</span> </p><p><span m='4691870'>OK.</span> <span m='4692110'>So</span>
  <span m='4692230'>now</span> <span m='4692380'>if</span> <span m='4692470'>you</span>
  <span m='4692560'>look</span> <span m='4692710'>at</span> <span m='4692800'>an</span>
  <span m='4692890'>arbitrary</span> <span m='4693400'>version,</span> <span m='4695120'>so</span>
  <span m='4695230'>what</span> <span m='4695320'>we're</span> <span m='4695440'>thinking</span>
  <span m='4695710'>about</span> <span m='4696160'>is</span> <span m='4696340'>how</span>
  <span m='4696490'>to</span> <span m='4696610'>implement</span> <span m='4697270'>reading,</span>
  <span m='4697660'>let's</span> <span m='4697810'>say.</span> <span m='4698080'>Reading</span>
  <span m='4698380'>and</span> <span m='4698470'>writing</span> <span m='4699450'>are</span>
  <span m='4699550'>more</span> <span m='4699700'>or</span> <span m='4699730'>less</span>
  <span m='4699940'>the</span> <span m='4700000'>same.</span> <span m='4701110'>I</span>
  <span m='4701200'>give</span> <span m='4701380'>you</span> <span m='4701500'>a</span>
  <span m='4701530'>version.</span> <span m='4702280'>I</span> <span m='4702370'>give</span>
  <span m='4702550'>you</span> <span m='4702640'>a</span> <span m='4702670'>node,</span>
  <span m='4702940'>and</span> <span m='4703030'>I</span> <span m='4703090'>give</span>
  <span m='4703240'>you</span> <span m='4703330'>a</span> <span m='4703360'>field.</span>
  <span m='4703720'>I</span> <span m='4703810'>want</span> <span m='4703960'>to</span>
  <span m='4704020'>know,</span> <span m='4704140'>what</span> <span m='4704320'>is</span>
  <span m='4704440'>the</span> <span m='4704530'>value</span> <span m='4704920'>of</span>
  <span m='4705010'>that</span> <span m='4705220'>field,</span> <span m='4705670'>that</span>
  <span m='4705850'>node,</span> <span m='4706180'>that</span> <span m='4706360'>version?</span>
  </p><p><span m='4707810'>So</span> <span m='4707830'>now</span> <span m='4708190'>where</span>
  <span m='4708430'>could</span> <span m='4708580'>a</span> <span m='4708640'>version</span>
  <span m='4709090'>fall?</span> <span m='4710140'>Well</span> <span m='4710220'>it</span>
  <span m='4710290'>has</span> <span m='4710530'>to</span> <span m='4710620'>be</span>
  <span m='4710740'>in</span> <span m='4710830'>this</span> <span m='4710930'>subtree.</span>
  <span m='4711430'>Because</span> <span m='4713140'>the</span> <span m='4713230'>node</span>
  <span m='4713410'>has</span> <span m='4713590'>to</span> <span m='4713710'>exist.</span>
  <span m='4716950'>And</span> <span m='4717190'>then</span> <span m='4717370'>it's</span>
  <span m='4717520'>maybe</span> <span m='4717790'>a</span> <span m='4717850'>pointer.</span>
  <span m='4718390'>A</span> <span m='4718810'>pointer</span> <span m='4719170'>could</span>
  <span m='4719380'>be</span> <span m='4721530'>to</span> <span m='4721720'>another</span>
  <span m='4721990'>node,</span> <span m='4722680'>which</span> <span m='4722830'>also</span>
  <span m='4723160'>has</span> <span m='4723550'>this</span> <span m='4723700'>kind</span>
  <span m='4723880'>of</span> <span m='4724210'>picture.</span> <span m='4724540'>They</span>
  <span m='4724630'>could</span> <span m='4724750'>be</span> <span m='4724840'>overlapping</span>
  <span m='4725350'>trees.</span> </p><p><span m='4726460'>In</span> <span m='4726580'>general,</span>
  <span m='4727100'>there</span> <span m='4727210'>are</span> <span m='4727270'>three</span>
  <span m='4727480'>cases.</span> <span m='4728140'>Either</span> <span m='4728440'>you're</span>
  <span m='4728560'>lucky,</span> <span m='4729580'>and</span> <span m='4729880'>the</span>
  <span m='4730000'>version</span> <span m='4730300'>you're</span> <span m='4730390'>talking</span>
  <span m='4730750'>about</span> <span m='4731110'>is</span> <span m='4731350'>a</span>
  <span m='4731440'>version</span> <span m='4731770'>where</span> <span m='4731920'>the</span>
  <span m='4732040'>node</span> <span m='4732250'>was</span> <span m='4732400'>changed.</span>
  <span m='4733960'>In</span> <span m='4734080'>that</span> <span m='4734200'>case,</span>
  <span m='4737020'>the</span> <span m='4737200'>data</span> <span m='4737410'>is
  just</span> <span m='4737710'>stored</span> <span m='4738010'>right</span> <span
  m='4738190'>there.</span> <span m='4738470'>That's</span> <span m='4738550'>easy.</span>
  <span m='4739270'>So</span> <span m='4739380'>you</span> <span m='4739520'>could
  just</span> <span m='4739640'>say,</span> <span m='4739900'>oh,</span> <span m='4740080'>how</span>
  <span m='4740230'>did</span> <span m='4740340'>the</span> <span m='4740470'>node</span>
  <span m='4740620'>change?</span> <span m='4741250'>Oh,</span> <span m='4741520'>that's</span>
  <span m='4741760'>what</span> <span m='4741880'>the</span> <span m='4741970'>field</span>
  <span m='4742240'>is.</span> <span m='4742630'>OK,</span> <span m='4742870'>follow</span>
  <span m='4743080'>the</span> <span m='4743170'>pointer.</span> </p><p><span m='4745190'>A</span>
  <span m='4745270'>slightly</span> <span m='4745660'>harder</span> <span m='4745870'>case</span>
  <span m='4746575'>it's</span> <span m='4747550'>a</span> <span m='4747640'>version</span>
  <span m='4748210'>in</span> <span m='4748510'>between</span> <span m='4748810'>two</span>
  <span m='4748960'>such</span> <span m='4749200'>changes.</span> <span m='4749590'>And</span>
  <span m='4749680'>maybe</span> <span m='4749890'>these</span> <span m='4750070'>are</span>
  <span m='4750160'>not</span> <span m='4751270'>updates.</span> <span m='4751660'>So</span>
  <span m='4754900'>I</span> <span m='4755110'>sort</span> <span m='4755290'>of</span>
  <span m='4755350'>want</span> <span m='4755530'>to</span> <span m='4755590'>know,</span>
  <span m='4755920'>what</span> <span m='4756130'>was</span> <span m='4756340'>the</span>
  <span m='4756460'>previous</span> <span m='4756850'>version</span> <span m='4757180'>where</span>
  <span m='4757330'>this</span> <span m='4757540'>node</span> <span m='4757750'>changed</span>
  <span m='4759520'>in</span> <span m='4759640'>constant</span> <span m='4759970'>time?</span>
  <span m='4761650'>It</span> <span m='4761740'>can</span> <span m='4761890'>be</span>
  <span m='4761980'>done.</span> <span m='4762620'>Not</span> <span m='4762860'>constant</span>
  <span m='4763260'>time,</span> <span m='4763480'>actually,</span> <span m='4763810'>logarithmic</span>
  <span m='4764350'>time,</span> <span m='4765160'>using</span> <span m='4765490'>a</span>
  <span m='4765550'>data</span> <span m='4765730'>structure</span> <span m='4766090'>called</span>
  <span m='4766300'>link-cut</span> <span m='4766680'>trees,</span> <span m='4768120'>another</span>
  <span m='4768710'>fun</span> <span m='4769870'>black</span> <span m='4770155'>box</span>
  <span m='4770440'>for</span> <span m='4770530'>now,</span> <span m='4770800'>which</span>
  <span m='4771010'>we</span> <span m='4771190'>will</span> <span m='4771340'>cover</span>
  <span m='4771760'>in</span> <span m='4772120'>lecture</span> <span m='4773050'>19,</span>
  <span m='4774440'>far</span> <span m='4774670'>in</span> <span m='4774760'>the</span>
  <span m='4774850'>future.</span> <span m='4776220'>OK.</span> </p><p><span m='4779890'>Well,</span>
  <span m='4779980'>that's</span> <span m='4780160'>one</span> <span m='4780580'>case.</span>
  <span m='4780800'>There's</span> <span m='4780940'>also</span> <span m='4781240'>the</span>
  <span m='4781330'>version</span> <span m='4781690'>where</span> <span m='4782590'>maybe</span>
  <span m='4782880'>a</span> <span m='4782920'>version</span> <span m='4783190'>is</span>
  <span m='4783280'>down</span> <span m='4783460'>here</span> <span m='4783580'>in</span>
  <span m='4783670'>a</span> <span m='4783700'>subtree.</span> <span m='4785110'>I</span>
  <span m='4785200'>guess</span> <span m='4785380'>then</span> <span m='4785530'>the</span>
  <span m='4785620'>node</span> <span m='4785800'>didn't</span> <span m='4786040'>exist.</span>
  <span m='4788340'>Well,</span> <span m='4789430'>all</span> <span m='4789610'>these</span>
  <span m='4789730'>things</span> <span m='4789970'>can</span> <span m='4790090'>happen.</span>
  <span m='4790490'>And</span> <span m='4790630'>that's</span> <span m='4790990'>even</span>
  <span m='4791260'>harder.</span> <span m='4791800'>It's</span> <span m='4791920'>messy.</span>
  </p><p><span m='4793360'>They</span> <span m='4793480'>use</span> <span m='4793660'>another</span>
  <span m='4793930'>trick,</span> <span m='4794990'>which</span> <span m='4795130'>is</span>
  <span m='4795220'>called</span> <span m='4795610'>fractional</span> <span m='4797140'>cascading,</span>
  <span m='4799720'>which</span> <span m='4799930'>I'm</span> <span m='4799990'>not</span>
  <span m='4800140'>even</span> <span m='4800290'>going</span> <span m='4800410'>to</span>
  <span m='4800500'>try</span> <span m='4800740'>to</span> <span m='4800830'>describe</span>
  <span m='4801280'>what</span> <span m='4801400'>it</span> <span m='4801490'>means.</span>
  <span m='4802240'>But</span> <span m='4802360'>it's</span> <span m='4802450'>got</span>
  <span m='4802600'>a</span> <span m='4802660'>very</span> <span m='4802870'>cool</span>
  <span m='4803110'>name.</span> <span m='4804190'>Because</span> <span m='4804540'>we'll</span>
  <span m='4804700'>be</span> <span m='4804790'>covering</span> <span m='4805090'>it</span>
  <span m='4805180'>in lecture</span> <span m='4805520'>3.</span> <span m='4806080'>So</span>
  <span m='4806650'>stay</span> <span m='4806860'>tuned</span> <span m='4807040'>for</span>
  <span m='4807160'>that.</span> <span m='4807310'>I'm</span> <span m='4807370'>not</span>
  <span m='4807490'>going</span> <span m='4807610'>to</span> <span m='4807670'>say</span>
  <span m='4807820'>how</span> <span m='4808030'>it</span> <span m='4808090'>applies</span>
  <span m='4808450'>to</span> <span m='4808540'>this</span> <span m='4808900'>setting,</span>
  <span m='4809450'>but</span> <span m='4810930'>it's</span> <span m='4811240'>a</span>
  <span m='4811300'>necessary</span> <span m='4811870'>step</span> <span m='4812140'>in</span>
  <span m='4812260'>here.</span> </p><p><span m='4813330'>In</span> <span m='4813520'>the</span>
  <span m='4813580'>remaining</span> <span m='4814690'>zero</span> <span m='4814960'>minutes,</span>
  <span m='4815350'>let</span> <span m='4815500'>me</span> <span m='4815590'>tell</span>
  <span m='4815800'>you</span> <span m='4815890'>a</span> <span m='4815920'>little</span>
  <span m='4816160'>bit</span> <span m='4816280'>about</span> <span m='4816520'>functional</span>
  <span m='4816940'>data</span> <span m='4817150'>structures.</span> </p><p><span
  m='4817780'>[LAUGHTER]</span> </p><p></p><p><span m='4820900'>Beauty</span> <span
  m='4821170'>of</span> <span m='4821260'>time</span> <span m='4821500'>travel.</span>
  <span m='4824830'>Functional--</span> <span m='4830530'>I</span> <span m='4830620'>just</span>
  <span m='4830740'>want</span> <span m='4830860'>to</span> <span m='4830920'>give</span>
  <span m='4831070'>you</span> <span m='4831130'>some</span> <span m='4831310'>examples</span>
  <span m='4831760'>of</span> <span m='4831850'>things</span> <span m='4832090'>that</span>
  <span m='4832180'>can</span> <span m='4832330'>be</span> <span m='4832420'>done</span>
  <span m='4832630'>functionally.</span> <span m='4833590'>There's</span> <span m='4833740'>a</span>
  <span m='4833800'>whole</span> <span m='4833950'>book</span> <span m='4834190'>about</span>
  <span m='4834430'>functional</span> <span m='4834760'>data</span> <span m='4834940'>structures</span>
  <span m='4835330'>by</span> <span m='4835480'>Okasaki.</span> <span m='4836700'>It's</span>
  <span m='4836830'>pretty</span> <span m='4837040'>cool.</span> </p><p><span m='4838180'>A</span>
  <span m='4838240'>simple</span> <span m='4838570'>example</span> <span m='4839740'>is</span>
  <span m='4840250'>balanced</span> <span m='4840730'>BSTs.</span> <span m='4842320'>So</span>
  <span m='4842440'>if</span> <span m='4842500'>you</span> <span m='4842560'>just</span>
  <span m='4842680'>want</span> <span m='4842800'>to</span> <span m='4842890'>get</span>
  <span m='4843070'>log</span> <span m='4843170'>n</span> <span m='4843470'>time</span>
  <span m='4843760'>for</span> <span m='4843850'>everything,</span> <span m='4844600'>you</span>
  <span m='4844720'>can</span> <span m='4844840'>do</span> <span m='4844960'>that</span>
  <span m='4845140'>functionally.</span> <span m='4845890'>It's</span> <span m='4845980'>actually</span>
  <span m='4846220'>really</span> <span m='4846490'>easy.</span> <span m='4846890'>You</span>
  <span m='4846910'>pick</span> <span m='4847090'>your</span> <span m='4847210'>favorite</span>
  <span m='4847510'>balance</span> <span m='4847780'>BST,</span> <span m='4848200'>like</span>
  <span m='4848380'>red</span> <span m='4848500'>black</span> <span m='4848710'>trees.</span>
  <span m='4848920'>You</span> <span m='4849010'>implement</span> <span m='4849340'>it</span>
  <span m='4849430'>top</span> <span m='4849730'>down</span> <span m='4850030'>so</span>
  <span m='4850120'>you</span> <span m='4850180'>never</span> <span m='4850390'>follow</span>
  <span m='4850640'>parent</span> <span m='4850890'>pointers.</span> <span m='4851260'>So</span>
  <span m='4851360'>you</span> <span m='4851460'>don't</span> <span m='4851500'>need</span>
  <span m='4851590'>parent</span> <span m='4851860'>pointers.</span> </p><p><span
  m='4852710'>So</span> <span m='4852760'>then</span> <span m='4853820'>as</span>
  <span m='4854170'>you</span> <span m='4854350'>make</span> <span m='4854560'>changes</span>
  <span m='4855010'>down</span> <span m='4855520'>the</span> <span m='4855670'>tree,</span>
  <span m='4856390'>you</span> <span m='4856510'>just</span> <span m='4857230'>copy.</span>
  <span m='4857710'>It's</span> <span m='4858010'>called path</span> <span m='4858430'>copying.</span>
  <span m='4859390'>Whenever</span> <span m='4859630'>you're</span> <span m='4859780'>about</span>
  <span m='4860020'>to</span> <span m='4860110'>make</span> <span m='4860230'>a</span>
  <span m='4860290'>change,</span> <span m='4860620'>make</span> <span m='4860800'>a</span>
  <span m='4860860'>copy</span> <span m='4861160'>of</span> <span m='4861220'>that</span>
  <span m='4861370'>node.</span> <span m='4862070'>So</span> <span m='4862170'>you</span>
  <span m='4862270'>end</span> <span m='4862370'>up</span> <span m='4863710'>copying</span>
  <span m='4864130'>all</span> <span m='4864310'>the</span> <span m='4864400'>change</span>
  <span m='4864700'>nodes</span> <span m='4865060'>and</span> <span m='4865240'>all</span>
  <span m='4865450'>their</span> <span m='4865570'>ancestors.</span> <span m='4866200'>There's</span>
  <span m='4866350'>only</span> <span m='4866560'>log</span> <span m='4866800'>n</span>
  <span m='4866860'>of</span> <span m='4866950'>them,</span> <span m='4867130'>so</span>
  <span m='4867210'>it</span> <span m='4867300'>takes</span> <span m='4867490'>log</span>
  <span m='4867520'>n</span> <span m='4867790'>time.</span> <span m='4869650'>Clear?</span>
  <span m='4870500'>Easy.</span> </p><p><span m='4871500'>It's</span> <span m='4871990'>a</span>
  <span m='4872050'>nice</span> <span m='4872230'>technique.</span> <span m='4872620'>Sometimes</span>
  <span m='4873010'>path</span> <span m='4873220'>copying</span> <span m='4874010'>is</span>
  <span m='4874120'>very</span> <span m='4874240'>useful.</span> <span m='4874600'>Like</span>
  <span m='4874960'>link-cut</span> <span m='4875140'>trees,</span> <span m='4875620'>for</span>
  <span m='4875710'>example,</span> <span m='4876170'>can</span> <span m='4876250'>be</span>
  <span m='4876370'>made</span> <span m='4876550'>functional.</span> <span m='4877450'>We</span>
  <span m='4877510'>don't</span> <span m='4877630'>know</span> <span m='4877720'>what</span>
  <span m='4877840'>they</span> <span m='4877960'>are,</span> <span m='4878200'>but</span>
  <span m='4878440'>they're</span> <span m='4878620'>basically</span> <span m='4879130'>a</span>
  <span m='4879400'>BST.</span> <span m='4880270'>And</span> <span m='4880360'>you</span>
  <span m='4880450'>can</span> <span m='4880570'>make</span> <span m='4880720'>them</span>
  <span m='4880840'>functional.</span> <span m='4881280'>We</span> <span m='4881360'>use</span>
  <span m='4881500'>that</span> <span m='4881740'>in</span> <span m='4881860'>a</span>
  <span m='4881920'>paper.</span> </p><p><span m='4883450'>All</span> <span m='4883540'>right.</span>
  <span m='4883790'>Deques.</span> <span m='4885970'>These</span> <span m='4886120'>are</span>
  <span m='4886220'>doubly</span> <span m='4886600'>ended</span> <span m='4886870'>queues.</span>
  <span m='4887800'>So</span> <span m='4888070'>it's</span> <span m='4888220'>like</span>
  <span m='4888460'>a</span> <span m='4888520'>stack</span> <span m='4888880'>and</span>
  <span m='4889020'>a</span> <span m='4889120'>queue</span> <span m='4889540'>and</span>
  <span m='4889660'>everything.</span> <span m='4889990'>You</span> <span m='4890050'>can</span>
  <span m='4890200'>insert</span> <span m='4890530'>and</span> <span m='4890620'>delete</span>
  <span m='4890860'>from</span> <span m='4890980'>the</span> <span m='4891070'>beginning</span>
  <span m='4891400'>and</span> <span m='4891490'>the</span> <span m='4891610'>end.</span>
  <span m='4892900'>People</span> <span m='4893170'>start</span> <span m='4893350'>to</span>
  <span m='4893440'>know</span> <span m='4893560'>what</span> <span m='4893650'>these</span>
  <span m='4893830'>are</span> <span m='4893980'>now,</span> <span m='4894850'>because</span>
  <span m='4895030'>Python</span> <span m='4895390'>calls</span> <span m='4895630'>him</span>
  <span m='4895720'>that.</span> </p><p><span m='4895980'>But</span> <span m='4897520'>you</span>
  <span m='4897700'>can</span> <span m='4898180'>also</span> <span m='4898630'>do</span>
  <span m='4899410'>concatenation</span> <span m='4901090'>with</span> <span m='4901280'>deques</span>
  <span m='4901660'>in</span> <span m='4901840'>constant</span> <span m='4902290'>time
  per</span> <span m='4902770'>operation.</span> <span m='4903310'>This</span> <span
  m='4903490'>is</span> <span m='4903580'>cool.</span> <span m='4904150'>Deques</span>
  <span m='4904420'>are</span> <span m='4904480'>not</span> <span m='4904670'>very</span>
  <span m='4904840'>hard</span> <span m='4905500'>to</span> <span m='4905560'>make</span>
  <span m='4905710'>functional.</span> <span m='4906220'>But</span> <span m='4906340'>you</span>
  <span m='4906460'>can</span> <span m='4906580'>do</span> <span m='4906700'>deques</span>
  <span m='4907360'>and</span> <span m='4907540'>you</span> <span m='4907600'>can</span>
  <span m='4907720'>concatenate</span> <span m='4908350'>them</span> <span m='4908500'>like</span>
  <span m='4908740'>we</span> <span m='4908830'>were</span> <span m='4908950'>doing</span>
  <span m='4909250'>in</span> <span m='4909340'>the</span> <span m='4909640'>figure</span>
  <span m='4910030'>that's</span> <span m='4910210'>right</span> <span m='4910360'>behind</span>
  <span m='4910660'>this</span> <span m='4910780'>board.</span> </p><p><span m='4911980'>Constant</span>
  <span m='4912310'>time</span> <span m='4912640'>split</span> <span m='4913030'>is</span>
  <span m='4913150'>a</span> <span m='4913180'>little</span> <span m='4913330'>harder.</span>
  <span m='4913690'>That's</span> <span m='4913930'>actually</span> <span m='4914890'>one</span>
  <span m='4915010'>of</span> <span m='4915070'>my</span> <span m='4915190'>open</span>
  <span m='4915490'>problems.</span> <span m='4916870'>Can</span> <span m='4917050'>you</span>
  <span m='4917140'>do</span> <span m='4918340'>lists</span> <span m='4919180'>with</span>
  <span m='4919330'>split</span> <span m='4919660'>and</span> <span m='4919810'>concatenate</span>
  <span m='4920320'>in</span> <span m='4920470'>constant</span> <span m='4920790'>time--</span>
  <span m='4921580'>functionally</span> <span m='4922150'>or</span> <span m='4922270'>confluently,</span>
  <span m='4922750'>persistently,</span> <span m='4923470'>or</span> <span m='4923560'>whatever?</span>
  </p><p><span m='4925840'>Another</span> <span m='4926140'>example--</span> <span
  m='4927460'>oh,</span> <span m='4927610'>you</span> <span m='4927730'>can</span>
  <span m='4927850'>do</span> <span m='4927940'>a</span> <span m='4928000'>mix</span>
  <span m='4928240'>of</span> <span m='4928330'>the</span> <span m='4928420'>two.</span>
  <span m='4928580'>You</span> <span m='4928660'>can</span> <span m='4928750'>get</span>
  <span m='4928870'>log</span> <span m='4929110'>n</span> <span m='4929230'>search</span>
  <span m='4929500'>in</span> <span m='4929590'>constant</span> <span m='4929950'>time</span>
  <span m='4930610'>deque</span> <span m='4930940'>operations,</span> <span m='4932390'>is</span>
  <span m='4932620'>you</span> <span m='4932770'>can</span> <span m='4932890'>do</span>
  <span m='4933280'>tries.</span> <span m='4934870'>So</span> <span m='4935080'>a
  try</span> <span m='4935560'>is</span> <span m='4935770'>a</span> <span m='4935890'>tree</span>
  <span m='4936220'>with</span> <span m='4936400'>a</span> <span m='4936490'>fixed</span>
  <span m='4936940'>topology.</span> <span m='4937900'>Think</span> <span m='4938080'>of</span>
  <span m='4938170'>it</span> <span m='4938290'>as</span> <span m='4938410'>a</span>
  <span m='4938470'>directory</span> <span m='4938950'>tree.</span> <span m='4940010'>So</span>
  <span m='4940060'>maybe</span> <span m='4940300'>you're</span> <span m='4940540'>using</span>
  <span m='4940810'>Subversion.</span> <span m='4941530'>Subversion</span> <span m='4941980'>has</span>
  <span m='4942130'>time</span> <span m='4942340'>travel</span> <span m='4942640'>operations.</span>
  <span m='4943120'>You</span> <span m='4943240'>can</span> <span m='4943360'>copy</span>
  <span m='4943810'>an</span> <span m='4943930'>entire</span> <span m='4944440'>subtree</span>
  <span m='4945460'>from</span> <span m='4945670'>one</span> <span m='4945820'>version</span>
  <span m='4946240'>and</span> <span m='4946540'>stick</span> <span m='4946930'>it</span>
  <span m='4947020'>into</span> <span m='4948340'>a</span> <span m='4948400'>new</span>
  <span m='4948550'>version,</span> <span m='4949480'>another</span> <span m='4949780'>version.</span>
  <span m='4950620'>So</span> <span m='4950930'>you</span> <span m='4951070'>get</span>
  <span m='4951220'>a</span> <span m='4951280'>version</span> <span m='4951910'>DAG.</span>
  <span m='4952685'>It's</span> <span m='4952980'>a</span> <span m='4953170'>confluently</span>
  <span m='4953530'>persistent</span> <span m='4953980'>data</span> <span m='4954160'>structure--</span>
  <span m='4954850'>not</span> <span m='4955150'>implemented</span> <span m='4955720'>optimally,</span>
  <span m='4956470'>because</span> <span m='4956680'>we</span> <span m='4956800'>don't</span>
  <span m='4957160'>necessarily</span> <span m='4957610'>know</span> <span m='4957760'>how.</span>
  <span m='4958240'>But</span> <span m='4958600'>there</span> <span m='4958820'>is</span>
  <span m='4958990'>one</span> <span m='4959200'>paper.</span> </p><p><span m='4960200'>This</span>
  <span m='4960340'>actually</span> <span m='4960640'>came</span> <span m='4960970'>from</span>
  <span m='4961830'>the</span> <span m='4961990'>open</span> <span m='4962200'>problem</span>
  <span m='4962470'>section</span> <span m='4962740'>of</span> <span m='4962830'>this</span>
  <span m='4962980'>class</span> <span m='4963910'>four</span> <span m='4964150'>years</span>
  <span m='4964420'>ago,</span> <span m='4964760'>I</span> <span m='4964860'>think.</span>
  <span m='4965590'>It's with</span> <span m='4965770'>Eric</span> <span m='4966040'>Price</span>
  <span m='4967180'>and</span> <span m='4967300'>Stefan</span> <span m='4967660'>Langerman.</span>
  <span m='4969520'>You</span> <span m='4969700'>can</span> <span m='4969880'>get</span>
  <span m='4970180'>very</span> <span m='4970510'>good</span> <span m='4970630'>results.</span>
  <span m='4971050'>I</span> <span m='4971140'>won't</span> <span m='4971350'>write</span>
  <span m='4971530'>them</span> <span m='4971650'>down</span> <span m='4971830'>because</span>
  <span m='4971980'>it</span> <span m='4972070'>takes</span> <span m='4972280'>a</span>
  <span m='4972340'>while.</span> <span m='4972970'>Basically</span> <span m='4973330'>log</span>
  <span m='4974080'>the</span> <span m='4974260'>degree</span> <span m='4974650'>of</span>
  <span m='4974740'>the</span> <span m='4974830'>nodes</span> <span m='4975490'>factor</span>
  <span m='4976450'>and</span> <span m='4976570'>get</span> <span m='4976750'>functional,</span>
  <span m='4977860'>and</span> <span m='4978070'>you</span> <span m='4978250'>can</span>
  <span m='4978400'>be</span> <span m='4978490'>even</span> <span m='4978700'>fancier</span>
  <span m='4979690'>and</span> <span m='4979810'>get</span> <span m='4979930'>slightly</span>
  <span m='4980230'>better</span> <span m='4980470'>bounds</span> <span m='4980740'>like</span>
  <span m='4980860'>log</span> <span m='4981160'>log</span> <span m='4981580'>the</span>
  <span m='4982020'>degree</span> <span m='4982480'>and</span> <span m='4982660'>get</span>
  <span m='4982780'>confluently</span> <span m='4983260'>persistent</span> <span m='4984520'>with</span>
  <span m='4984700'>various</span> <span m='4985000'>tricks,</span> <span m='4985370'>including</span>
  <span m='4985660'>using</span> <span m='4986020'>all</span> <span m='4986200'>of</span>
  <span m='4986290'>these</span> <span m='4986440'>data</span> <span m='4986650'>structures.</span>
  </p><p><span m='4987530'>So</span> <span m='4987630'>if</span> <span m='4987730'>you</span>
  <span m='4987830'>want</span> <span m='4987930'>to</span> <span m='4988030'>implement</span>
  <span m='4988210'>subversion</span> <span m='4988660'>optimally,</span> <span m='4989800'>that</span>
  <span m='4990040'>is</span> <span m='4990160'>known</span> <span m='4990925'>how</span>
  <span m='4991270'>to</span> <span m='4991390'>be</span> <span m='4991510'>done</span>
  <span m='4992080'>but</span> <span m='4992740'>hasn't</span> <span m='4992980'>actually</span>
  <span m='4993430'>been</span> <span m='4993610'>done</span> <span m='4993850'>yet.</span>
  <span m='4994390'>Because</span> <span m='4994630'>there</span> <span m='4994720'>are</span>
  <span m='4994780'>those</span> <span m='4995050'>pesky</span> <span m='4995410'>constant</span>
  <span m='4995770'>factors.</span> <span m='4998110'>I</span> <span m='4998170'>think</span>
  <span m='4998710'>that's</span> <span m='4999040'>all.</span> <span m='4999670'>What</span>
  <span m='4999850'>is</span> <span m='5000000'>known</span> <span m='5000210'>about</span>
  <span m='5000460'>functional</span> <span m='5000750'>is</span> <span m='5001040'>there's</span>
  <span m='5001220'>a</span> <span m='5001290'>log</span> <span m='5001660'>n</span>
  <span m='5001830'>separation.</span> <span m='5003030'>You</span> <span m='5003210'>can</span>
  <span m='5003330'>be</span> <span m='5003450'>log</span> <span m='5003750'>n</span>
  <span m='5003850'>away</span> <span m='5005520'>from</span> <span m='5006270'>the</span>
  <span m='5006390'>best.</span> <span m='5006890'>That's</span> <span m='5008010'>the</span>
  <span m='5008160'>worst</span> <span m='5008520'>separation</span> <span m='5009540'>known,</span>
  <span m='5010230'>between</span> <span m='5010530'>functional</span> <span m='5011040'>and</span>
  <span m='5011130'>just</span> <span m='5011280'>a</span> <span m='5011340'>regular</span>
  <span m='5011700'>old</span> <span m='5011850'>data</span> <span m='5012090'>structure.</span>
  <span m='5013110'>It'd be</span> <span m='5013200'>nice</span> <span m='5013440'>to</span>
  <span m='5013500'>improve</span> <span m='5013830'>that.</span> <span m='5014220'>Lots</span>
  <span m='5014460'>of</span> <span m='5014760'>open problems</span> <span m='5015060'>here.</span>
  <span m='5015210'>Maybe</span> <span m='5015420'>we'll</span> <span m='5015510'>work</span>
  <span m='5015690'>on</span> <span m='5015780'>them</span> <span m='5016410'>next</span>
  <span m='5016590'>time.</span> </p>
type: course
uid: b2dfac404f367dde437aad378ea69bdb

---
None