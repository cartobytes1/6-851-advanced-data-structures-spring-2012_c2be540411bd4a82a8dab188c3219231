---
about_this_resource_text: '<p><strong>Description:</strong> Integer: Sorting in linear
  time for w = O(lg2+&epsilon; n), priority queues.</p> <p><strong>Speaker:</strong>
  Prof. Erik Demaine</p>'
course_id: 6-851-advanced-data-structures-spring-2012
embedded_media:
- id: Video-YouTube-Stream
  media_location: pOKy3RZbSws
  parent_uid: dcf206fd0a4e424a3f0ded0f3a030161
  title: Video-YouTube-Stream
  type: Video
  uid: 071c29d2384f0e583fd68daf4dedffc2
- id: Video-iTunesU-MP4
  media_location: https://itunes.apple.com/us/itunes-u/session-14-sorting-in-linear/id735348884?i=169611712
  parent_uid: dcf206fd0a4e424a3f0ded0f3a030161
  title: Video-iTunes U-MP4
  type: Video
  uid: bcd58909b4a88f37c24adcfc0355fa2a
- id: Video-InternetArchive-MP4
  media_location: http://www.archive.org/download/MIT6.851S12/MIT6_851S12_lec14_300k.mp4
  parent_uid: dcf206fd0a4e424a3f0ded0f3a030161
  title: Video-Internet Archive-MP4
  type: Video
  uid: 134eca52e953dae575908e03ce0f087b
- id: Thumbnail-YouTube-JPG
  media_location: https://img.youtube.com/vi/pOKy3RZbSws/default.jpg
  parent_uid: dcf206fd0a4e424a3f0ded0f3a030161
  title: Thumbnail-YouTube-JPG
  type: Thumbnail
  uid: 879f60bad205f45f66717ef28d7e0fb2
- id: 3Play-3PlayYouTubeid-MP4
  media_location: pOKy3RZbSws
  parent_uid: dcf206fd0a4e424a3f0ded0f3a030161
  title: 3Play-3Play YouTube id
  type: 3Play
  uid: b50d2faa7739ec51fe35b73857e93591
- id: pOKy3RZbSws.srt
  parent_uid: dcf206fd0a4e424a3f0ded0f3a030161
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-851-advanced-data-structures-spring-2012/lecture-videos/session-14-sorting-in-linear-time/pOKy3RZbSws.srt
  title: 3play caption file
  type: null
  uid: b0040f0c578a944d1e9f5100dbc681a6
- id: pOKy3RZbSws.pdf
  parent_uid: dcf206fd0a4e424a3f0ded0f3a030161
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-851-advanced-data-structures-spring-2012/lecture-videos/session-14-sorting-in-linear-time/pOKy3RZbSws.pdf
  title: 3play pdf file
  type: null
  uid: e5ec44f7add0f2040e202fa3102e50b5
- id: Caption-3Play YouTube id-SRT
  parent_uid: dcf206fd0a4e424a3f0ded0f3a030161
  title: Caption-3Play YouTube id-SRT-English - US
  type: Caption
  uid: c76ad8e22c594531f05c176f8b250433
- id: Transcript-3Play YouTube id-PDF
  parent_uid: dcf206fd0a4e424a3f0ded0f3a030161
  title: Transcript-3Play YouTube id-PDF-English - US
  type: Transcript
  uid: ab6c8e2942858133681e2043a829f866
inline_embed_id: 59905627session14:sortinginlineartime76115370
layout: video
order_index: null
parent_uid: b66cbbb7b35e74ff17cdbf44e5fb6b1d
related_resources_text: ''
short_url: session-14-sorting-in-linear-time
technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-851-advanced-data-structures-spring-2012/lecture-videos/session-14-sorting-in-linear-time
template_type: Tabbed
title: 'Session 14: Sorting in Linear Time'
transcript: <p><span m='90'>The</span> <span m='180'>following</span> <span m='630'>content</span>
  <span m='1200'>is</span> <span m='1320'>provided</span> <span m='1770'>under</span>
  <span m='2009'>a</span> <span m='2070'>Creative</span> <span m='2490'>Commons</span>
  <span m='2910'>license.</span> <span m='4030'>Your</span> <span m='4200'>support</span>
  <span m='4710'>will</span> <span m='4860'>help</span> <span m='5100'>MIT</span>
  <span m='5550'>OpenCourseWare</span> <span m='6360'>continue</span> <span m='6870'>to</span>
  <span m='6960'>offer</span> <span m='7380'>high</span> <span m='7620'>quality</span>
  <span m='8100'>educational</span> <span m='8730'>resources</span> <span m='9330'>for</span>
  <span m='9510'>free.</span> <span m='10720'>To</span> <span m='10740'>make</span>
  <span m='10920'>a</span> <span m='10980'>donation</span> <span m='11730'>or</span>
  <span m='11940'>view</span> <span m='12390'>additional</span> <span m='12810'>materials</span>
  <span m='13320'>from</span> <span m='13500'>hundreds</span> <span m='13920'>of</span>
  <span m='14040'>MIT</span> <span m='14460'>courses,</span> <span m='15550'>visit</span>
  <span m='15780'>MIT</span> <span m='16200'>OpenCourseWare</span> <span m='17280'>at</span>
  <span m='17430'>ocw.mit.edu.</span> </p><p><span m='21370'>ERIK DEMAINE:</span>
  <span m='21400'>All</span> <span m='21430'>right,</span> <span m='21580'>today</span>
  <span m='21940'>we</span> <span m='22120'>continue</span> <span m='22780'>our</span>
  <span m='23080'>theme</span> <span m='23530'>of</span> <span m='23950'>integer</span>
  <span m='24370'>data</span> <span m='24610'>structures.</span> <span m='25480'>And</span>
  <span m='25960'>today</span> <span m='26170'>we're</span> <span m='26260'>going</span>
  <span m='26380'>to</span> <span m='26440'>look</span> <span m='26650'>at</span>
  <span m='26800'>priority</span> <span m='27430'>queues</span> <span m='27760'>instead</span>
  <span m='28060'>of</span> <span m='28120'>the</span> <span m='28210'>predecessor</span>
  <span m='28780'>problem,</span> <span m='29035'>so</span> <span m='29290'>something</span>
  <span m='29590'>a</span> <span m='29620'>little</span> <span m='29800'>different.</span>
  <span m='30850'>Insert,</span> <span m='31310'>delete,</span> <span m='31750'>and</span>
  <span m='32409'>find</span> <span m='32740'>min.</span> </p><p><span m='33980'>It</span>
  <span m='34450'>turns</span> <span m='34810'>out</span> <span m='35020'>priority</span>
  <span m='35410'>queues</span> <span m='35860'>are</span> <span m='36160'>equivalent</span>
  <span m='36670'>to</span> <span m='36790'>sorting</span> <span m='38140'>in</span>
  <span m='38320'>the</span> <span m='38410'>sense</span> <span m='38830'>that</span>
  <span m='49330'>if</span> <span m='49450'>you</span> <span m='49570'>have,</span>
  <span m='53130'>normally</span> <span m='53410'>they</span> <span m='53470'>say</span>
  <span m='53650'>f</span> <span m='53800'>of</span> <span m='53920'>n,</span> <span
  m='54160'>but</span> <span m='54310'>here</span> <span m='54490'>we're</span> <span
  m='54580'>going</span> <span m='54700'>to</span> <span m='54760'>depend</span> <span
  m='55150'>on</span> <span m='55240'>both</span> <span m='55470'>n</span> <span m='55640'>and</span>
  <span m='55900'>the</span> <span m='56020'>word</span> <span m='56230'>size,</span>
  <span m='58270'>priority</span> <span m='58780'>queue.</span> <span m='62830'>Well</span>
  <span m='63010'>then,</span> <span m='63190'>of</span> <span m='63310'>course</span>
  <span m='63640'>you</span> <span m='63730'>get</span> <span m='63880'>a</span> <span
  m='63940'>sorting</span> <span m='64300'>algorithm.</span> <span m='65530'>Just</span>
  <span m='65740'>insert</span> <span m='66160'>everything</span> <span m='66610'>into</span>
  <span m='66760'>the</span> <span m='66850'>priority</span> <span m='67240'>queue</span>
  <span m='68420'>and</span> <span m='68470'>then</span> <span m='69320'>find</span>
  <span m='69580'>min</span> <span m='69880'>delete,</span> <span m='70180'>find</span>
  <span m='70520'>min</span> <span m='70785'>delete,</span> <span m='71050'>and</span>
  <span m='71170'>so</span> <span m='71350'>on.</span> <span m='75350'>So</span> <span
  m='75460'>that's</span> <span m='75700'>the</span> <span m='75790'>trivial</span>
  <span m='77290'>direction</span> <span m='77950'>of</span> <span m='78310'>the</span>
  <span m='78400'>equivalence.</span> </p><p><span m='80080'>But</span> <span m='80230'>it</span>
  <span m='80290'>turns</span> <span m='80590'>out,</span> <span m='81800'>both</span>
  <span m='82000'>of</span> <span m='82090'>these</span> <span m='82300'>are</span>
  <span m='82390'>true.</span> <span m='83550'>If</span> <span m='83620'>you</span>
  <span m='83680'>have</span> <span m='83770'>a</span> <span m='83830'>sorting</span>
  <span m='84280'>algorithm</span> <span m='84730'>with</span> <span m='84910'>n</span>
  <span m='85090'>times</span> <span m='85570'>f</span> <span m='87040'>time,</span>
  <span m='88060'>then</span> <span m='88180'>you</span> <span m='88300'>can</span>
  <span m='88420'>convert</span> <span m='88720'>it</span> <span m='88810'>into</span>
  <span m='89020'>a</span> <span m='89080'>priority</span> <span m='89500'>queue</span>
  <span m='90235'>that</span> <span m='90580'>in</span> <span m='90730'>the</span>
  <span m='90850'>worst</span> <span m='91150'>case</span> <span m='91480'>every</span>
  <span m='91810'>operation</span> <span m='92350'>takes</span> <span m='92590'>only</span>
  <span m='92830'>f</span> <span m='93040'>of</span> <span m='93220'>n,</span> <span
  m='94480'>w.</span> <span m='97280'>So</span> <span m='99500'>that's</span> <span
  m='99690'>the</span> <span m='99940'>equivalence</span> <span m='100420'>as</span>
  <span m='100520'>the</span> <span m='100600'>result</span> <span m='100960'>of</span>
  <span m='101080'>Thorpe</span> <span m='101550'>from</span> <span m='102070'>a</span>
  <span m='102130'>few</span> <span m='102370'>years</span> <span m='102610'>ago,</span>
  <span m='103030'>2007.</span> <span m='104890'>Kind</span> <span m='105100'>of</span>
  <span m='105190'>a</span> <span m='105520'>cool</span> <span m='105760'>breakthrough.</span>
  <span m='106180'>There</span> <span m='106300'>were</span> <span m='106390'>earlier</span>
  <span m='106750'>versions</span> <span m='107230'>that</span> <span m='107380'>weren't</span>
  <span m='107560'>quite</span> <span m='107770'>as</span> <span m='107890'>efficient</span>
  <span m='108730'>but</span> <span m='108910'>this</span> <span m='109090'>gives</span>
  <span m='109300'>you</span> <span m='109540'>perfect</span> <span m='109930'>efficiency,</span>
  <span m='110740'>turning</span> <span m='111220'>any</span> <span m='111400'>sorting</span>
  <span m='111700'>algorithm</span> <span m='111840'>into</span> <span m='112060'>priority</span>
  <span m='112490'>queue.</span> </p><p><span m='113050'>Rough</span> <span m='113260'>sketch</span>
  <span m='113620'>of</span> <span m='113710'>the</span> <span m='113830'>data</span>
  <span m='114040'>structure</span> <span m='114610'>is</span> <span m='115290'>you</span>
  <span m='115360'>have</span> <span m='115570'>a</span> <span m='115630'>bunch</span>
  <span m='115870'>of</span> <span m='115930'>sorting</span> <span m='116290'>algorithms</span>
  <span m='116990'>which</span> <span m='117100'>you</span> <span m='117220'>run</span>
  <span m='117550'>now</span> <span m='117790'>and</span> <span m='117910'>then</span>
  <span m='118240'>to</span> <span m='118390'>get</span> <span m='118960'>little</span>
  <span m='119230'>parts</span> <span m='119590'>of</span> <span m='119680'>the</span>
  <span m='119800'>input</span> <span m='120730'>in</span> <span m='120880'>order</span>
  <span m='121060'>to</span> <span m='121240'>build</span> <span m='121540'>an</span>
  <span m='121660'>overall</span> <span m='122080'>priority</span> <span m='122500'>queue.</span>
  <span m='122810'>But</span> <span m='122830'>it's</span> <span m='122980'>very</span>
  <span m='123310'>complicated.</span> <span m='124990'>There</span> <span m='125110'>was</span>
  <span m='125260'>an</span> <span m='125320'>entire</span> <span m='125770'>class</span>
  <span m='126070'>project</span> <span m='126490'>on</span> <span m='127270'>assimilating</span>
  <span m='127840'>it</span> <span m='127930'>and</span> <span m='128020'>understanding</span>
  <span m='128590'>it.</span> <span m='129699'>It's</span> <span m='129910'>a</span>
  <span m='129970'>bit</span> <span m='130150'>beyond</span> <span m='130479'>what</span>
  <span m='130570'>we</span> <span m='130690'>can</span> <span m='130840'>cover</span>
  <span m='131140'>in</span> <span m='131360'>the</span> <span m='131410'>class.</span>
  </p><p><span m='133010'>So</span> <span m='133090'>I'm</span> <span m='133180'>going</span>
  <span m='133300'>to</span> <span m='133360'>take</span> <span m='133600'>this</span>
  <span m='133820'>as</span> <span m='133900'>given</span> <span m='134770'>and</span>
  <span m='134950'>tell</span> <span m='135160'>you</span> <span m='135250'>instead</span>
  <span m='135610'>about</span> <span m='135970'>sorting</span> <span m='136420'>algorithms</span>
  <span m='136930'>because</span> <span m='137110'>there's</span> <span m='137320'>a</span>
  <span m='137380'>major</span> <span m='137710'>open</span> <span m='137980'>problem</span>
  <span m='138310'>here</span> <span m='138520'>which</span> <span m='138730'>is,</span>
  <span m='138880'>can</span> <span m='139150'>you</span> <span m='139270'>sort</span>
  <span m='139660'>n</span> <span m='139870'>integers,</span> <span m='141280'>n</span>
  <span m='141610'>w</span> <span m='141920'>bit</span> <span m='142090'>integers</span>
  <span m='142630'>in</span> <span m='142750'>a</span> <span m='142810'>word</span>
  <span m='143020'>ram's,</span> <span m='143470'>word</span> <span m='143650'>size</span>
  <span m='143890'>w</span> <span m='144760'>in</span> <span m='144940'>linear</span>
  <span m='145270'>time.</span> <span m='145750'>We</span> <span m='145870'>still</span>
  <span m='146080'>don't</span> <span m='146230'>know</span> <span m='148120'>but</span>
  <span m='148390'>we</span> <span m='148570'>have</span> <span m='149020'>a</span>
  <span m='149080'>bunch</span> <span m='149350'>of</span> <span m='149410'>results.</span>
  <span m='149830'>In</span> <span m='149920'>particular,</span> <span m='150500'>we're</span>
  <span m='150600'>going</span> <span m='150700'>to</span> <span m='150800'>talk</span>
  <span m='150940'>about</span> <span m='151120'>a</span> <span m='151180'>couple</span>
  <span m='152440'>interesting</span> <span m='152890'>cases</span> <span m='153310'>where</span>
  <span m='153460'>we</span> <span m='153610'>can</span> <span m='153850'>get</span>
  <span m='154060'>linear</span> <span m='154360'>time</span> <span m='154600'>sorting.</span>
  <span m='156070'>If</span> <span m='156190'>you've</span> <span m='156280'>seen</span>
  <span m='156680'>radix</span> <span m='156790'>sort</span> <span m='157060'>you</span>
  <span m='157180'>know</span> <span m='157690'>another</span> <span m='158050'>interesting</span>
  <span m='158470'>case</span> <span m='158830'>where</span> <span m='159510'>linear</span>
  <span m='159610'>time</span> <span m='159820'>sorting</span> <span m='160120'>is</span>
  <span m='160210'>possible.</span> </p><p><span m='164410'>Interesting</span> <span
  m='164950'>open</span> <span m='165250'>problem</span> <span m='165670'>here.</span>
  <span m='168560'>Can</span> <span m='168700'>you</span> <span m='168850'>get</span>
  <span m='169450'>constant</span> <span m='169900'>time</span> <span m='170350'>decrease</span>
  <span m='170860'>key?</span> <span m='173620'>And</span> <span m='173770'>ideally,</span>
  <span m='174160'>also</span> <span m='174550'>insertion?</span> <span m='176150'>But</span>
  <span m='176320'>decrease</span> <span m='176740'>key</span> <span m='176920'>would</span>
  <span m='177040'>be</span> <span m='177190'>handy</span> <span m='177730'>because</span>
  <span m='178360'>then</span> <span m='178540'>this</span> <span m='178720'>would</span>
  <span m='178810'>be</span> <span m='178900'>useful.</span> </p><p><span m='182530'>In</span>
  <span m='182890'>this</span> <span m='183070'>reduction</span> <span m='183770'>if</span>
  <span m='183870'>you</span> <span m='183970'>have</span> <span m='184070'>a</span>
  <span m='184170'>sorting</span> <span m='184270'>algorithm,</span> <span m='184630'>like</span>
  <span m='184810'>to</span> <span m='184870'>get</span> <span m='184990'>a</span>
  <span m='185050'>priority</span> <span m='185350'>queue</span> <span m='185500'>with</span>
  <span m='185650'>constant</span> <span m='185950'>time</span> <span m='186160'>decrease</span>
  <span m='186550'>key,</span> <span m='186730'>that</span> <span m='186880'>would</span>
  <span m='187000'>have</span> <span m='187120'>applications</span> <span m='187750'>to</span>
  <span m='187900'>Dijkstra's</span> <span m='188350'>algorithm.</span> <span m='188740'>Of</span>
  <span m='188860'>course,</span> <span m='189160'>if</span> <span m='189310'>you</span>
  <span m='189400'>can</span> <span m='189550'>sort</span> <span m='189760'>in</span>
  <span m='189850'>linear</span> <span m='190150'>time</span> <span m='190960'>then</span>
  <span m='191260'>everything</span> <span m='191680'>can</span> <span m='191800'>be</span>
  <span m='191920'>done</span> <span m='192070'>in</span> <span m='192160'>constant</span>
  <span m='192550'>time.</span> <span m='193130'>So</span> <span m='193720'>this</span>
  <span m='193900'>is</span> <span m='193960'>not</span> <span m='194140'>the</span>
  <span m='194260'>most</span> <span m='194500'>interesting</span> <span m='194920'>open</span>
  <span m='195130'>problem</span> <span m='195430'>but</span> <span m='195610'>it</span>
  <span m='195670'>would</span> <span m='195790'>be</span> <span m='195970'>a</span>
  <span m='196030'>step</span> <span m='196360'>in</span> <span m='196450'>that</span>
  <span m='196600'>direction.</span> </p><p><span m='199650'>Cool.</span> <span m='199900'>So</span>
  <span m='200140'>let</span> <span m='200260'>me</span> <span m='200380'>tell</span>
  <span m='200620'>you</span> <span m='203270'>some</span> <span m='204610'>bounds</span>
  <span m='205090'>about</span> <span m='206080'>sorting.</span> <span m='212482'>So</span>
  <span m='212980'>we</span> <span m='213190'>have</span> <span m='214750'>n</span>
  <span m='216060'>w</span> <span m='216460'>bit</span> <span m='218170'>integers.</span>
  <span m='218600'>And</span> <span m='218680'>you</span> <span m='218750'>take</span>
  <span m='219190'>any</span> <span m='219370'>of</span> <span m='219430'>these</span>
  <span m='219610'>bounds</span> <span m='219910'>divide</span> <span m='220180'>by</span>
  <span m='220390'>n</span> <span m='220630'>you</span> <span m='220750'>get</span>
  <span m='221020'>the</span> <span m='221140'>priority</span> <span m='221500'>queue</span>
  <span m='221680'>bound,</span> <span m='222640'>the</span> <span m='222760'>best</span>
  <span m='223620'>that</span> <span m='223840'>we</span> <span m='223960'>know.</span>
  </p><p><span m='226250'>So</span> <span m='226600'>of</span> <span m='226720'>course,</span>
  <span m='228070'>there's</span> <span m='228280'>comparison</span> <span m='228790'>sorting,</span>
  <span m='230520'>which</span> <span m='230680'>takes</span> <span m='231160'>n</span>
  <span m='231350'>log</span> <span m='231750'>n.</span> <span m='232690'>So</span>
  <span m='232870'>that's</span> <span m='233080'>an</span> <span m='233170'>upper</span>
  <span m='233410'>bound.</span> <span m='233950'>Trying</span> <span m='234160'>to</span>
  <span m='234250'>beat</span> <span m='234430'>that.</span> <span m='235070'>Trying</span>
  <span m='235250'>to</span> <span m='235330'>get</span> <span m='235480'>rid</span>
  <span m='235600'>of</span> <span m='235660'>the</span> <span m='235750'>log.</span>
  </p><p><span m='237610'>There's</span> <span m='237840'>a</span> <span m='237940'>counting</span>
  <span m='238420'>sort</span> <span m='238870'>from</span> <span m='239440'>undergraduate</span>
  <span m='239980'>algorithms.</span> <span m='241300'>That</span> <span m='241480'>takes</span>
  <span m='242350'>n</span> <span m='242650'>plus</span> <span m='243100'>u</span>
  <span m='243400'>time</span> <span m='243820'>because</span> <span m='243970'>you</span>
  <span m='244090'>need</span> <span m='244320'>to</span> <span m='244750'>build</span>
  <span m='245020'>a</span> <span m='245080'>table</span> <span m='245380'>of</span>
  <span m='245440'>size</span> <span m='245710'>u.</span> <span m='246040'>You've
  got</span> <span m='246160'>to</span> <span m='246220'>zero</span> <span m='246490'>out</span>
  <span m='246640'>all</span> <span m='246820'>the</span> <span m='246940'>initial</span>
  <span m='247270'>counts</span> <span m='248215'>so</span> <span m='248710'>that</span>
  <span m='248810'>requires</span> <span m='249080'>order</span> <span m='249310'>u</span>
  <span m='249490'>time.</span> <span m='251320'>This</span> <span m='252700'>is</span>
  <span m='252880'>interesting</span> <span m='255460'>when</span> <span m='257320'>the</span>
  <span m='257440'>word</span> <span m='257680'>size</span> <span m='258160'>equals</span>
  <span m='258680'>log</span> <span m='258944'>n.</span> </p><p><span m='260470'>So</span>
  <span m='260649'>that's</span> <span m='260890'>a</span> <span m='260950'>case</span>
  <span m='261279'>of</span> <span m='261370'>potential</span> <span m='261850'>interest,</span>
  <span m='263120'>because</span> <span m='263230'>then</span> <span m='263470'>2</span>
  <span m='263890'>to the</span> <span m='263980'>w</span> <span m='264310'>is just</span>
  <span m='264520'>n.</span> <span m='264740'>So</span> <span m='264900'>this</span>
  <span m='265090'>is</span> <span m='265210'>linear</span> <span m='265510'>time.</span>
  <span m='266760'>But</span> <span m='267130'>even</span> <span m='267400'>if</span>
  <span m='267490'>w</span> <span m='267910'>is</span> <span m='268510'>2</span> <span
  m='268720'>log</span> <span m='268990'>n,</span> <span m='269250'>radix</span> <span
  m='269510'>or</span> <span m='269620'>1.1</span> <span m='270220'>times</span> <span
  m='270470'>log</span> <span m='270730'>n,</span> <span m='270880'>then</span> <span
  m='271090'>this</span> <span m='271300'>is</span> <span m='272230'>bigger</span>
  <span m='272590'>n</span> <span m='272770'>log</span> <span m='272920'>n.</span>
  <span m='273250'>So,</span> <span m='273640'>not</span> <span m='273850'>very</span>
  <span m='274060'>good.</span> </p><p><span m='274820'>But</span> <span m='274930'>we</span>
  <span m='275050'>have</span> <span m='275230'>radix</span> <span m='275990'>sort,</span>
  <span m='278962'>which is</span> <span m='279400'>a</span> <span m='279460'>bit</span>
  <span m='279640'>better.</span> <span m='281110'>And</span> <span m='281260'>this</span>
  <span m='281530'>is</span> <span m='282880'>n</span> <span m='284090'>times</span>
  <span m='284490'>w</span> <span m='285900'>divided</span> <span m='286410'>by</span>
  <span m='286570'>log</span> <span m='286860'>n.</span> <span m='289310'>If</span>
  <span m='289450'>you</span> <span m='289540'>do</span> <span m='289690'>it</span>
  <span m='289780'>right</span> <span m='291480'>you</span> <span m='291550'>have</span>
  <span m='291760'>some</span> <span m='292480'>word</span> <span m='292630'>size</span>
  <span m='292870'>w,</span> <span m='293320'>you're</span> <span m='293500'>using</span>
  <span m='294130'>counting</span> <span m='294460'>sort</span> <span m='294730'>for</span>
  <span m='294880'>each</span> <span m='295180'>digit</span> <span m='295510'>in</span>
  <span m='295630'>the</span> <span m='295750'>radix.</span> <span m='297190'>So</span>
  <span m='297400'>you</span> <span m='297580'>can</span> <span m='297730'>afford</span>
  <span m='298120'>that</span> <span m='299190'>the</span> <span m='299380'>word</span>
  <span m='299590'>size</span> <span m='300760'>of</span> <span m='300910'>doing</span>
  <span m='301240'>counting</span> <span m='301570'>sort</span> <span m='301780'>to</span>
  <span m='301960'>be</span> <span m='302500'>exactly</span> <span m='302920'>log
  n.</span> <span m='303370'>Which</span> <span m='303550'>means</span> <span m='303730'>you</span>
  <span m='303820'>have</span> <span m='304000'>your</span> <span m='304150'>overall</span>
  <span m='304510'>word</span> <span m='304750'>you're</span> <span m='304840'>dividing</span>
  <span m='305260'>into</span> <span m='305500'>chunks</span> <span m='305860'>of</span>
  <span m='305920'>size</span> <span m='306210'>log</span> <span m='306450'>n.</span>
  <span m='307210'>Each</span> <span m='307390'>of</span> <span m='307450'>them</span>
  <span m='307630'>you</span> <span m='307720'>can</span> <span m='307870'>do</span>
  <span m='307960'>in</span> <span m='308020'>linear</span> <span m='308290'>time.</span>
  </p><p><span m='309140'>So</span> <span m='309170'>the</span> <span m='309220'>number</span>
  <span m='309460'>of</span> <span m='309520'>chunks</span> <span m='309820'>you</span>
  <span m='309910'>have</span> <span m='310000'>to</span> <span m='310090'>do</span>
  <span m='310210'>is</span> <span m='310280'>w</span> <span m='310600'>divided</span>
  <span m='310930'>by</span> <span m='311080'>log</span> <span m='311350'>n.</span>
  <span m='312520'>And</span> <span m='312670'>this</span> <span m='312940'>is</span>
  <span m='313990'>linear</span> <span m='315280'>if</span> <span m='316330'>w</span>
  <span m='316720'>equals</span> <span m='317380'>order</span> <span m='317640'>log</span>
  <span m='317850'>n.</span> <span m='322490'>Right,</span> <span m='323090'>but</span>
  <span m='323270'>only</span> <span m='323540'>then.</span> <span m='324010'>So</span>
  <span m='324240'>this</span> <span m='324430'>buys</span> <span m='324680'>you</span>
  <span m='324770'>a</span> <span m='324830'>little</span> <span m='325040'>bit,</span>
  <span m='326840'>but</span> <span m='327080'>still</span> <span m='327380'>not</span>
  <span m='327890'>great.</span> </p><p><span m='329070'>OK,</span> <span m='329300'>there's</span>
  <span m='329480'>some</span> <span m='329660'>other</span> <span m='329840'>sorting</span>
  <span m='330170'>algorithms</span> <span m='330590'>we've</span> <span m='330740'>implicitly</span>
  <span m='331310'>seen</span> <span m='331610'>because</span> <span m='331970'>we've</span>
  <span m='332120'>seen</span> <span m='332780'>Van Emde</span> <span m='332980'>Boas.</span>
  <span m='333860'>I</span> <span m='333920'>mean,</span> <span m='334070'>any</span>
  <span m='334250'>predecessor</span> <span m='334880'>data</span> <span m='335120'>structure</span>
  <span m='336020'>gives</span> <span m='336290'>you</span> <span m='336500'>a</span>
  <span m='336560'>priority</span> <span m='336980'>queue</span> <span m='337160'>data</span>
  <span m='337370'>structure.</span> <span m='337760'>Priority</span> <span m='338120'>queues--</span>
  <span m='339570'>I</span> <span m='340670'>didn't</span> <span m='340880'>write</span>
  <span m='341120'>it,</span> <span m='341360'>but</span> <span m='341540'>I</span>
  <span m='341600'>mentioned--</span> <span m='342530'>insert,</span> <span m='343770'>delete,</span>
  <span m='344180'>find</span> <span m='344480'>min.</span> <span m='345710'>Find</span>
  <span m='345980'>min</span> <span m='346340'>is</span> <span m='346490'>a</span>
  <span m='346580'>weaker</span> <span m='346940'>operation</span> <span m='347480'>than</span>
  <span m='347600'>predecessor</span> <span m='348350'>or</span> <span m='348380'>successor.</span>
  <span m='350600'>So</span> <span m='350840'>we</span> <span m='350960'>can</span>
  <span m='351110'>take</span> <span m='351320'>Van Emde</span> <span m='351570'>Boas's</span>
  <span m='356060'>predecessor</span> <span m='356660'>data</span> <span m='356870'>structure</span>
  <span m='357350'>and</span> <span m='357440'>convert</span> <span m='357800'>it</span>
  <span m='357890'>into</span> <span m='358950'>a</span> <span m='359060'>sorting</span>
  <span m='359450'>algorithm</span> <span m='361040'>and</span> <span m='361190'>we</span>
  <span m='361310'>get</span> <span m='362330'>order</span> <span m='362810'>n</span>
  <span m='363350'>times</span> <span m='363770'>log</span> <span m='364660'>w.</span>
  </p><p><span m='367160'>Now</span> <span m='368030'>this</span> <span m='368240'>is</span>
  <span m='368390'>a</span> <span m='368450'>little</span> <span m='368900'>bit</span>
  <span m='369140'>tricky</span> <span m='369620'>to</span> <span m='369800'>compare.</span>
  <span m='370130'>Of</span> <span m='370220'>course,</span> <span m='370400'>log</span>
  <span m='370640'>w</span> <span m='370940'>sounds</span> <span m='371210'>better</span>
  <span m='371480'>than</span> <span m='371660'>w.</span> <span m='372560'>But</span>
  <span m='372710'>there's</span> <span m='372870'>just</span> <span m='373010'>divided</span>
  <span m='373400'>by</span> <span m='373550'>log</span> <span m='373730'>n,</span>
  <span m='374730'>which</span> <span m='374870'>makes</span> <span m='375110'>it</span>
  <span m='375860'>a</span> <span m='375920'>little</span> <span m='376160'>hard</span>
  <span m='376340'>to</span> <span m='376430'>compare.</span> <span m='378620'>It</span>
  <span m='378740'>turns</span> <span m='379100'>out</span> <span m='381690'>there's</span>
  <span m='382446'>another</span> <span m='383300'>version.</span> <span m='385160'>You</span>
  <span m='385280'>can</span> <span m='385430'>take</span> <span m='385670'>this</span>
  <span m='385840'>sorting</span> <span m='386210'>algorithm</span> <span m='388520'>and</span>
  <span m='388700'>achieve</span> <span m='389150'>a</span> <span m='389200'>bound</span>
  <span m='389610'>of</span> <span m='389810'>m</span> <span m='390740'>log</span>
  <span m='392120'>w</span> <span m='392750'>over</span> <span m='393110'>log</span>
  <span m='393400'>n.</span> </p><p><span m='396680'>OK,</span> <span m='396860'>so</span>
  <span m='397010'>this</span> <span m='397220'>is</span> <span m='397340'>a</span>
  <span m='397430'>slight</span> <span m='397850'>improvement</span> <span m='398660'>in</span>
  <span m='398900'>here.</span> <span m='399500'>It's</span> <span m='399620'>similar</span>
  <span m='400130'>to</span> <span m='400250'>your</span> <span m='400370'>problem</span>
  <span m='400700'>set</span> <span m='401030'>this</span> <span m='401270'>week.</span>
  <span m='402200'>This</span> <span m='402560'>specific</span> <span m='403130'>problem</span>
  <span m='403370'>was</span> <span m='403490'>a</span> <span m='403550'>problem</span>
  <span m='403850'>set</span> <span m='404600'>in</span> <span m='404720'>2005</span>
  <span m='405870'>of</span> <span m='406010'>this</span> <span m='406160'>class.</span>
  <span m='407370'>So</span> <span m='407420'>you</span> <span m='407510'>can</span>
  <span m='408200'>check</span> <span m='408410'>it</span> <span m='408470'>out</span>
  <span m='408620'>if</span> <span m='408710'>you</span> <span m='408800'>want</span>
  <span m='408920'>to</span> <span m='408980'>see</span> <span m='409190'>how</span>
  <span m='409370'>to</span> <span m='409490'>do</span> <span m='409640'>this</span>
  <span m='409790'>slight</span> <span m='410090'>improvement.</span> </p><p><span
  m='410900'>But</span> <span m='411050'>now</span> <span m='411290'>this</span> <span
  m='411470'>is</span> <span m='411560'>clearly</span> <span m='411950'>better</span>
  <span m='412220'>than</span> <span m='412430'>this</span> <span m='412880'>because</span>
  <span m='413060'>here</span> <span m='413180'>we</span> <span m='413270'>have</span>
  <span m='413330'>w</span> <span m='413630'>over</span> <span m='413810'>log</span>
  <span m='414050'>n.</span> <span m='414230'>Here</span> <span m='414380'>I've</span>
  <span m='414440'>got</span> <span m='414590'>a</span> <span m='414620'>log</span>
  <span m='414920'>in</span> <span m='415040'>front.</span> <span m='416070'>So</span>
  <span m='416150'>this</span> <span m='416360'>is</span> <span m='416480'>a</span>
  <span m='416540'>win</span> <span m='416930'>over</span> <span m='417220'>radex</span>
  <span m='417550'>sort.</span> <span m='418540'>So</span> <span m='418820'>Van</span>
  <span m='419040'>Emde</span> <span m='419365'>Boas,</span> <span m='419690'>here's</span>
  <span m='419930'>another</span> <span m='420290'>way</span> <span m='420440'>in</span>
  <span m='420530'>which</span> <span m='420710'>is</span> <span m='420800'>interesting.</span>
  <span m='421820'>It</span> <span m='421880'>gives</span> <span m='422180'>us</span>
  <span m='423230'>a</span> <span m='423500'>strict</span> <span m='423800'>improvement</span>
  <span m='424250'>over</span> <span m='424490'>radex</span> <span m='424760'>sort.</span>
  </p><p><span m='425830'>And</span> <span m='425990'>in</span> <span m='426050'>particular,</span>
  <span m='430700'>actually</span> <span m='431000'>both</span> <span m='431270'>of</span>
  <span m='431360'>these</span> <span m='434020'>are</span> <span m='434150'>order</span>
  <span m='434450'>n</span> <span m='434870'>log</span> <span m='435170'>log</span>
  <span m='435410'>n</span> <span m='436710'>if</span> <span m='436950'>w</span> <span
  m='437290'>is</span> <span m='437420'>not</span> <span m='437600'>too</span> <span
  m='437810'>big,</span> <span m='440360'>poly</span> <span m='441350'>log</span>
  <span m='442090'>n.</span> <span m='446090'>This</span> <span m='446360'>doesn't</span>
  <span m='446870'>actually</span> <span m='447200'>matter</span> <span m='447560'>but</span>
  <span m='447710'>it's</span> <span m='448130'>clearly</span> <span m='448490'>better</span>
  <span m='449780'>than</span> <span m='449900'>this</span> <span m='450110'>one.</span>
  <span m='450710'>Again,</span> <span m='450980'>if</span> <span m='451070'>w</span>
  <span m='451290'>is</span> <span m='451490'>order</span> <span m='451570'>log</span>
  <span m='451840'>n</span> <span m='452480'>you</span> <span m='452600'>get</span>
  <span m='452810'>this</span> <span m='453020'>to</span> <span m='453170'>be</span>
  <span m='453560'>linear.</span> <span m='454490'>But</span> <span m='455180'>in</span>
  <span m='455300'>particular,</span> <span m='455940'>it</span> <span m='456040'>says</span>
  <span m='456230'>overall</span> <span m='456680'>you</span> <span m='456830'>get</span>
  <span m='457040'>n</span> <span m='457210'>log</span> <span m='457420'>log</span>
  <span m='457610'>n</span> <span m='458390'>up</span> <span m='458600'>to</span>
  <span m='459395'>w</span> <span m='459770'>being</span> <span m='459950'>poly</span>
  <span m='460250'>log.</span> </p><p><span m='461300'>OK,</span> <span m='461510'>why</span>
  <span m='461690'>do</span> <span m='461810'>we</span> <span m='461900'>care?</span>
  <span m='464450'>Because</span> <span m='464870'>there's</span> <span m='465060'>this</span>
  <span m='465350'>other</span> <span m='465530'>nice</span> <span m='465800'>algorithm,</span>
  <span m='466670'>signature</span> <span m='467240'>sort,</span> <span m='468230'>which</span>
  <span m='468440'>covers</span> <span m='468920'>all</span> <span m='469250'>large</span>
  <span m='469580'>word</span> <span m='469850'>sizes.</span> <span m='471260'>And</span>
  <span m='471380'>this</span> <span m='471560'>is</span> <span m='471680'>an</span>
  <span m='471770'>algorithm</span> <span m='472460'>we</span> <span m='472640'>will</span>
  <span m='472790'>cover</span> <span m='473150'>today.</span> </p><p><span m='478370'>It</span>
  <span m='478490'>only</span> <span m='478850'>works</span> <span m='479210'>when</span>
  <span m='479360'>w</span> <span m='479710'>is</span> <span m='479840'>large,</span>
  <span m='480680'>and</span> <span m='480830'>large</span> <span m='481160'>means</span>
  <span m='481520'>log</span> <span m='482530'>to</span> <span m='482660'>the</span>
  <span m='482810'>2</span> <span m='483140'>plus</span> <span m='483500'>epsilon.</span>
  <span m='484850'>And</span> <span m='485210'>this</span> <span m='485450'>is</span>
  <span m='485780'>no</span> <span m='485930'>matter</span> <span m='486260'>what</span>
  <span m='486440'>epsilon</span> <span m='486920'>is.</span> <span m='487740'>In</span>
  <span m='488360'>reality,</span> <span m='488840'>it's</span> <span m='488930'>probably</span>
  <span m='489200'>log</span> <span m='489440'>squared</span> <span m='489740'>times</span>
  <span m='490250'>log</span> <span m='490550'>log</span> <span m='490820'>n</span>
  <span m='491030'>squared.</span> <span m='492140'>But</span> <span m='493370'>be</span>
  <span m='493520'>a</span> <span m='493580'>little</span> <span m='493820'>sloppy</span>
  <span m='494180'>and</span> <span m='494270'>just</span> <span m='494390'>say,</span>
  <span m='494750'>a</span> <span m='494780'>little</span> <span m='495110'>bit</span>
  <span m='495230'>bigger</span> <span m='495470'>than</span> <span m='495650'>log</span>
  <span m='495850'>squared.</span> <span m='498410'>And</span> <span m='498560'>then</span>
  <span m='498710'>it</span> <span m='498770'>runs</span> <span m='499010'>in</span>
  <span m='499100'>linear</span> <span m='499460'>time.</span> </p><p><span m='500640'>OK,</span>
  <span m='500840'>so</span> <span m='501030'>if</span> <span m='501325'>you</span>
  <span m='501620'>were</span> <span m='501770'>graphing</span> <span m='502220'>this</span>
  <span m='502400'>in</span> <span m='502490'>your</span> <span m='502610'>mind</span>
  <span m='503030'>you've</span> <span m='503120'>got</span> <span m='504180'>time</span>
  <span m='505640'>and</span> <span m='506030'>there's</span> <span m='506750'>a</span>
  <span m='506870'>nice</span> <span m='507030'>bound</span> <span m='507260'>here</span>
  <span m='507470'>which</span> <span m='507620'>is</span> <span m='507740'>order</span>
  <span m='508080'>n.</span> <span m='508430'>Then</span> <span m='508550'>we</span>
  <span m='508670'>have</span> <span m='509840'>everything's</span> <span m='510350'>above</span>
  <span m='510830'>n</span> <span m='511280'>log</span> <span m='511760'>n.</span>
  <span m='512960'>Maybe</span> <span m='513230'>here</span> <span m='513590'>we</span>
  <span m='513740'>have--</span> <span m='515200'>is</span> <span m='515330'>hard</span>
  <span m='515510'>to</span> <span m='515600'>draw--</span> <span m='516260'>n</span>
  <span m='516470'>log</span> <span m='516730'>log</span> <span m='516919'>n.</span>
  <span m='519590'>This</span> <span m='519770'>is</span> <span m='519919'>asymptotic</span>
  <span m='520580'>space,</span> <span m='521600'>which</span> <span m='521809'>doesn't</span>
  <span m='522020'>really</span> <span m='522169'>exist,</span> <span m='522630'>but</span>
  <span m='522740'>you</span> <span m='522830'>know</span> <span m='522950'>what</span>
  <span m='523039'>I</span> <span m='523100'>mean.</span> <span m='524330'>And</span>
  <span m='524510'>then</span> <span m='524930'>this</span> <span m='525230'>is</span>
  <span m='526030'>the</span> <span m='526130'>word</span> <span m='526430'>size</span>
  <span m='527980'>versus</span> <span m='528560'>log</span> <span m='528800'>n.</span>
  </p><p><span m='529475'>Wow,</span> <span m='529760'>this is</span> <span m='529880'>hard</span>
  <span m='530090'>to--</span> <span m='530420'>this</span> <span m='530680'>is a</span>
  <span m='530760'>really</span> <span m='530850'>weird</span> <span m='531350'>picture.</span>
  <span m='531800'>I've</span> <span m='532260'>never</span> <span m='532460'>drawn</span>
  <span m='532730'>this</span> <span m='532880'>before.</span> <span m='533840'>So</span>
  <span m='534020'>you</span> <span m='534110'>know,</span> <span m='534800'>initially</span>
  <span m='535230'>in a</span> <span m='535660'>radex</span> <span m='535940'>sort,</span>
  <span m='536420'>OK</span> <span m='536720'>log</span> <span m='537020'>n.</span>
  <span m='538080'>We</span> <span m='538130'>could</span> <span m='538250'>get</span>
  <span m='538400'>linear</span> <span m='538700'>time</span> <span m='541370'>or</span>
  <span m='541820'>order</span> <span m='542100'>log</span> <span m='542430'>n,</span>
  <span m='542700'>great.</span> </p><p><span m='544340'>What</span> <span m='544490'>this</span>
  <span m='544670'>is</span> <span m='544730'>saying</span> <span m='545000'>is</span>
  <span m='545120'>once</span> <span m='545330'>you</span> <span m='545420'>get</span>
  <span m='545600'>out</span> <span m='545750'>to</span> <span m='546440'>log</span>
  <span m='546920'>the</span> <span m='547040'>2</span> <span m='547220'>plus</span>
  <span m='547460'>epsilon</span> <span m='547930'>n</span> <span m='549560'>you</span>
  <span m='549680'>can</span> <span m='549830'>also</span> <span m='550100'>do</span>
  <span m='550220'>linear.</span> <span m='550520'>And</span> <span m='550610'>from</span>
  <span m='550820'>here</span> <span m='551120'>over</span> <span m='552110'>we</span>
  <span m='552200'>have</span> <span m='552350'>linear</span> <span m='552650'>time.</span>
  <span m='553180'>And</span> <span m='553340'>here</span> <span m='554200'>over</span>
  <span m='554510'>we</span> <span m='554660'>have</span> <span m='554840'>linear</span>
  <span m='555140'>time.</span> <span m='555840'>So</span> <span m='555890'>the</span>
  <span m='555980'>question</span> <span m='556280'>is</span> <span m='556370'>what</span>
  <span m='556550'>about</span> <span m='556790'>this</span> <span m='556940'>middle</span>
  <span m='557210'>range</span> <span m='557900'>between</span> <span m='558320'>log</span>
  <span m='558635'>n</span> <span m='559250'>and</span> <span m='559400'>log to</span>
  <span m='559670'>the</span> <span m='559760'>2</span> <span m='559940'>plus</span>
  <span m='560150'>epsilon?</span> </p><p><span m='562190'>Well,</span> <span m='563030'>one</span>
  <span m='563210'>thing</span> <span m='563420'>we</span> <span m='563540'>could</span>
  <span m='563660'>do</span> <span m='564470'>is</span> <span m='564680'>use</span>
  <span m='565870'>Van Emde</span> <span m='566170'>Boas</span> <span m='566440'>sort,</span>
  <span m='567530'>get</span> <span m='567710'>an</span> <span m='567800'>n</span>
  <span m='568020'>log</span> <span m='568220'>log</span> <span m='568400'>n</span>
  <span m='568685'>bound.</span> <span m='569980'>And</span> <span m='570170'>so</span>
  <span m='570320'>that's</span> <span m='570500'>one</span> <span m='570710'>way</span>
  <span m='570830'>to</span> <span m='570950'>fill</span> <span m='571220'>in</span>
  <span m='571310'>this</span> <span m='571460'>range</span> <span m='571730'>in</span>
  <span m='571790'>the</span> <span m='571880'>middle.</span> <span m='572180'>And</span>
  <span m='572270'>that</span> <span m='572390'>means</span> <span m='572630'>overall</span>
  <span m='573200'>you</span> <span m='573350'>can</span> <span m='573530'>always</span>
  <span m='573920'>sort</span> <span m='574340'>n</span> <span m='574550'>integers</span>
  <span m='575090'>in</span> <span m='575170'>n</span> <span m='575390'>log</span>
  <span m='575570'>log</span> <span m='575810'>n</span> <span m='575930'>time.</span>
  <span m='576920'>If</span> <span m='577880'>w</span> <span m='578150'>is</span>
  <span m='578240'>big</span> <span m='578630'>you</span> <span m='578780'>use</span>
  <span m='578930'>signature</span> <span m='579320'>sort,</span> <span m='579620'>if</span>
  <span m='579770'>w</span> <span m='580070'>small</span> <span m='580430'>use</span>
  <span m='580640'>Van Emde</span> <span m='581130'>Boas</span> <span m='581460'>sort.</span>
  <span m='582170'>So</span> <span m='582320'>this</span> <span m='582500'>implies</span>
  <span m='584990'>n</span> <span m='585190'>log log</span> <span m='585400'>n</span>
  <span m='587630'>for</span> <span m='587840'>all</span> <span m='588020'>w.</span>
  </p><p><span m='589430'>So</span> <span m='589580'>that's</span> <span m='589730'>something.</span>
  <span m='591080'>It's</span> <span m='591230'>not</span> <span m='591380'>the</span>
  <span m='591470'>best</span> <span m='591740'>known.</span> <span m='593724'>Let's</span>
  <span m='594130'>see,</span> <span m='595460'>first</span> <span m='596390'>result</span>
  <span m='596810'>in</span> <span m='596900'>this</span> <span m='597050'>direction</span>
  <span m='597500'>was</span> <span m='597860'>by</span> <span m='598130'>Han</span>
  <span m='598590'>in</span> <span m='598880'>2001.</span> <span m='600680'>And</span>
  <span m='600950'>it</span> <span m='601070'>achieved</span> <span m='601790'>this</span>
  <span m='602090'>bound,</span> <span m='603920'>deterministic</span> <span m='609080'>and</span>
  <span m='609410'>in</span> <span m='609540'>the</span> <span m='609620'>ac</span>
  <span m='609950'>0</span> <span m='610370'>ram,</span> <span m='611570'>so</span>
  <span m='611780'>without</span> <span m='612020'>using</span> <span m='612290'>multiplication.</span>
  <span m='614390'>Which,</span> <span m='614890'>I guess</span> <span m='615180'>Van</span>
  <span m='615330'>Emde</span> <span m='615630'>Boas</span> <span m='615920'>doesn't</span>
  <span m='616310'>either,</span> <span m='617310'>unless</span> <span m='617810'>I'm</span>
  <span m='617900'>missing</span> <span m='618200'>something.</span> <span m='619760'>But</span>
  <span m='620420'>it</span> <span m='620540'>got</span> <span m='620720'>rid</span>
  <span m='620870'>of</span> <span m='620960'>the</span> <span m='621050'>randomisation</span>
  <span m='621750'>which is</span> <span m='622070'>necessary</span> <span m='622440'>to</span>
  <span m='622530'>get</span> <span m='622650'>linear</span> <span m='622950'>space</span>
  <span m='623400'>in</span> <span m='623650'>Van</span> <span m='623800'>Emde</span>
  <span m='623930'>Boas.</span> </p><p><span m='625800'>The</span> <span m='626490'>current</span>
  <span m='626790'>best</span> <span m='627090'>result</span> <span m='627570'>on</span>
  <span m='627810'>sorting</span> <span m='630258'>is</span> <span m='630720'>by</span>
  <span m='631070'>Han</span> <span m='631310'>and</span> <span m='631530'>Thorpe</span>
  <span m='631890'>in</span> <span m='632010'>2002,</span> <span m='632970'>so</span>
  <span m='633190'>a</span> <span m='633210'>while</span> <span m='633480'>ago.</span>
  <span m='634330'>They</span> <span m='634500'>achieved</span> <span m='635100'>n</span>
  <span m='636420'>square</span> <span m='636900'>root</span> <span m='637620'>log</span>
  <span m='638580'>w</span> <span m='639270'>over</span> <span m='639990'>log</span>
  <span m='640860'>n,</span> <span m='642150'>which</span> <span m='642420'>is</span>
  <span m='642750'>similar</span> <span m='643290'>to</span> <span m='645570'>this</span>
  <span m='645770'>bound,</span> <span m='646390'>just</span> <span m='646560'>has</span>
  <span m='646740'>an</span> <span m='646830'>extra</span> <span m='647160'>square</span>
  <span m='647520'>root</span> <span m='647760'>here.</span> <span m='650200'>So</span>
  <span m='650250'>it's</span> <span m='650340'>a</span> <span m='650400'>little</span>
  <span m='650610'>bit</span> <span m='650790'>better</span> <span m='651180'>than</span>
  <span m='651900'>Van Emde</span> <span m='652160'>Boas</span> <span m='652450'>sort.</span>
  <span m='652680'>It</span> <span m='652780'>uses</span> <span m='653010'>some</span>
  <span m='653190'>clever</span> <span m='653490'>tricks.</span> <span m='653850'>It</span>
  <span m='654000'>is</span> <span m='654150'>randomized.</span> <span m='658780'>So</span>
  <span m='658910'>still</span> <span m='659190'>the</span> <span m='659310'>best</span>
  <span m='659490'>deterministic</span> <span m='660150'>bound</span> <span m='660660'>is</span>
  <span m='661020'>n</span> <span m='661190'>log</span> <span m='661380'>log</span>
  <span m='661560'>n,</span> </p><p><span m='663840'>And</span> <span m='664560'>let's</span>
  <span m='664740'>see,</span> <span m='665880'>we</span> <span m='666000'>can</span>
  <span m='666150'>plug</span> <span m='666420'>that</span> <span m='666660'>in</span>
  <span m='667080'>for</span> <span m='667350'>this</span> <span m='667590'>range</span>
  <span m='668610'>here.</span> <span m='669790'>And</span> <span m='669990'>it</span>
  <span m='670290'>will</span> <span m='670440'>imply</span> <span m='671940'>that</span>
  <span m='672120'>you</span> <span m='672240'>get</span> <span m='672630'>n</span>
  <span m='673080'>square</span> <span m='673530'>root</span> <span m='675630'>log</span>
  <span m='676050'>log</span> <span m='676310'>n</span> <span m='678270'>for</span>
  <span m='678540'>all</span> <span m='678730'>w.</span> <span m='680130'>Because</span>
  <span m='680340'>in</span> <span m='680430'>particular,</span> <span m='684570'>if</span>
  <span m='684810'>w</span> <span m='685080'>is</span> <span m='685170'>poly</span>
  <span m='685440'>log</span> <span m='685710'>n,</span> <span m='686340'>then</span>
  <span m='686460'>this</span> <span m='686610'>is</span> <span m='686700'>just</span>
  <span m='686880'>log</span> <span m='687090'>log</span> <span m='687330'>n.</span>
  <span m='688560'>So</span> <span m='688740'>you</span> <span m='688830'>get</span>
  <span m='688980'>this</span> <span m='689160'>bound.</span> <span m='691780'>Of</span>
  <span m='691920'>course,</span> <span m='692130'>for</span> <span m='692280'>all</span>
  <span m='692370'>w</span> <span m='692670'>because</span> <span m='692970'>large</span>
  <span m='693210'>w</span> <span m='693570'>are already</span> <span m='693930'>covered.</span>
  </p><p><span m='695050'>So</span> <span m='696120'>this</span> <span m='696450'>sorting</span>
  <span m='696910'>algorithm</span> <span m='697230'>is a</span> <span m='697290'>little</span>
  <span m='697500'>bit</span> <span m='698190'>messy,</span> <span m='698730'>and</span>
  <span m='698820'>possibly</span> <span m='699270'>not</span> <span m='699450'>the</span>
  <span m='699540'>right</span> <span m='699690'>answer.</span> <span m='700050'>I</span>
  <span m='700170'>would</span> <span m='700320'>conjecture</span> <span m='701340'>you</span>
  <span m='701460'>can</span> <span m='701570'>sort</span> <span m='701940'>n</span>
  <span m='702090'>integers</span> <span m='702540'>in</span> <span m='702660'>linear</span>
  <span m='702960'>time</span> <span m='703950'>for</span> <span m='704160'>all</span>
  <span m='704400'>w.</span> <span m='705450'>But</span> <span m='705660'>that</span>
  <span m='705870'>is</span> <span m='706080'>a</span> <span m='706110'>big</span>
  <span m='706300'>open</span> <span m='706560'>problem.</span> <span m='712590'>This</span>
  <span m='712770'>is</span> <span m='712860'>the</span> <span m='712980'>current</span>
  <span m='713220'>state</span> <span m='713490'>of</span> <span m='713550'>the</span>
  <span m='713700'>art.</span> <span m='715050'>So</span> <span m='717000'>this</span>
  <span m='717240'>open</span> <span m='717510'>question</span> <span m='717810'>is</span>
  <span m='717900'>really</span> <span m='718140'>about</span> <span m='718380'>for</span>
  <span m='718530'>small</span> <span m='718890'>w</span> <span m='719300'>when</span>
  <span m='719400'>w</span> <span m='719690'>is</span> <span m='719800'>poly</span>
  <span m='720190'>log</span> <span m='720540'>n,</span> <span m='720630'>or actually</span>
  <span m='720870'>when it's</span> <span m='721080'>between</span> <span m='721560'>log</span>
  <span m='721920'>and</span> <span m='722010'>poly</span> <span m='722240'>log.</span>
  </p><p><span m='723540'>So</span> <span m='723960'>to</span> <span m='724140'>give</span>
  <span m='724350'>you</span> <span m='724920'>a</span> <span m='725010'>piece</span>
  <span m='725310'>of</span> <span m='725460'>the</span> <span m='725550'>complete</span>
  <span m='725880'>picture</span> <span m='726330'>I</span> <span m='726450'>want</span>
  <span m='726630'>to</span> <span m='727620'>tell</span> <span m='727830'>you</span>
  <span m='727950'>about</span> <span m='728130'>signature</span> <span m='728610'>sort.</span>
  <span m='729090'>Because</span> <span m='729150'>I</span> <span m='729240'>think</span>
  <span m='729840'>you</span> <span m='729960'>have</span> <span m='730170'>to</span>
  <span m='730230'>use</span> <span m='730380'>different</span> <span m='730680'>techniques</span>
  <span m='731100'>when</span> <span m='731190'>w</span> <span m='731430'>is small</span>
  <span m='731760'>versus</span> <span m='732060'>large.</span> <span m='732390'>We</span>
  <span m='732480'>know</span> <span m='732630'>that</span> <span m='732840'>from</span>
  <span m='733050'>fusion</span> <span m='733350'>trees</span> <span m='733640'>and
  Van</span> <span m='733970'>Emde</span> <span m='734100'>Boas.</span> <span m='735540'>So</span>
  <span m='735690'>I'll</span> <span m='735810'>tell</span> <span m='735960'>you</span>
  <span m='736080'>about</span> <span m='736650'>the</span> <span m='736790'>slightly</span>
  <span m='737310'>large</span> <span m='737670'>case</span> <span m='738330'>when</span>
  <span m='738480'>w</span> <span m='738870'>is</span> <span m='739020'>at</span>
  <span m='739110'>least</span> <span m='739810'>log</span> <span m='740120'>to the</span>
  <span m='740200'>2</span> <span m='740370'>plus</span> <span m='740580'>epsilon,</span>
  <span m='741090'>how</span> <span m='741300'>to</span> <span m='741420'>get</span>
  <span m='741600'>linear</span> <span m='741960'>time.</span> </p><p><span m='742600'>And</span>
  <span m='742670'>this</span> <span m='742860'>is</span> <span m='742950'>fun.</span>
  <span m='743710'>It</span> <span m='743790'>uses bit</span> <span m='744180'>tricks,</span>
  <span m='744510'>it</span> <span m='744600'>uses</span> <span m='744840'>a</span>
  <span m='744900'>lot</span> <span m='745050'>of</span> <span m='745350'>cool</span>
  <span m='745560'>ideas,</span> <span m='745950'>uses</span> <span m='746130'>hashing,</span>
  <span m='747360'>lots</span> <span m='747540'>of</span> <span m='747600'>things.</span>
  </p><p><span m='748470'>It</span> <span m='748590'>also</span> <span m='748860'>uses</span>
  <span m='750360'>another</span> <span m='750660'>sorting</span> <span m='751020'>algorithm</span>
  <span m='751380'>called</span> <span m='751620'>packed</span> <span m='752250'>sort.</span>
  <span m='752820'>This</span> <span m='753730'>doesn't</span> <span m='754080'>fit</span>
  <span m='754290'>in</span> <span m='754380'>the</span> <span m='754470'>regular</span>
  <span m='754860'>table</span> <span m='755310'>because</span> <span m='755730'>it's</span>
  <span m='755910'>for</span> <span m='756090'>a</span> <span m='756120'>situation</span>
  <span m='756840'>when</span> <span m='757020'>more</span> <span m='757380'>than</span>
  <span m='757590'>one</span> <span m='758340'>input</span> <span m='758700'>number</span>
  <span m='759060'>fits</span> <span m='759390'>in</span> <span m='759510'>a</span>
  <span m='759570'>word.</span> <span m='760780'>So</span> <span m='760860'>we're</span>
  <span m='760920'>going</span> <span m='761040'>to</span> <span m='761130'>let</span>
  <span m='761370'>b</span> <span m='762300'>denote</span> <span m='762600'>the</span>
  <span m='762690'>number</span> <span m='762900'>of</span> <span m='762960'>bits</span>
  <span m='763290'>in</span> <span m='763500'>the</span> <span m='763650'>inputs.</span>
  <span m='764340'>So</span> <span m='764720'>we have</span> <span m='764790'>b</span>
  <span m='765030'>bit</span> <span m='765240'>integers.</span> <span m='766560'>Then</span>
  <span m='766800'>when</span> <span m='767190'>w</span> <span m='767730'>is</span>
  <span m='767850'>at</span> <span m='767940'>least</span> <span m='768180'>b</span>
  <span m='768510'>times</span> <span m='769090'>log</span> <span m='769370'>n</span>
  <span m='769530'>log</span> <span m='769770'>log</span> <span m='769980'>n,</span>
  <span m='770460'>so</span> <span m='770610'>you</span> <span m='770730'>can</span>
  <span m='770880'>fit</span> <span m='771120'>log</span> <span m='771420'>n</span>
  <span m='771540'>log</span> <span m='771780'>log</span> <span m='771960'>n</span>
  <span m='772800'>integers</span> <span m='773310'>in</span> <span m='773400'>a</span>
  <span m='773460'>single</span> <span m='773820'>word,</span> <span m='774540'>then</span>
  <span m='774960'>you</span> <span m='775110'>can</span> <span m='775500'>sort</span>
  <span m='775830'>them</span> <span m='776010'>in</span> <span m='776130'>linear</span>
  <span m='776430'>time.</span> </p><p><span m='777250'>So</span> <span m='777300'>it's</span>
  <span m='777390'>like</span> <span m='777570'>your</span> <span m='777810'>machine</span>
  <span m='778170'>is</span> <span m='778350'>just</span> <span m='778560'>a</span>
  <span m='778590'>little</span> <span m='778770'>bit</span> <span m='778890'>bigger</span>
  <span m='779190'>than</span> <span m='779370'>what</span> <span m='779520'>you'd</span>
  <span m='779670'>need</span> <span m='779880'>to</span> <span m='779970'>represent</span>
  <span m='780450'>the</span> <span m='780570'>integers,</span> <span m='781850'>then</span>
  <span m='782640'>all</span> <span m='782910'>sorting</span> <span m='783270'>can</span>
  <span m='783390'>be</span> <span m='783480'>done</span> <span m='783630'>in</span>
  <span m='783690'>a</span> <span m='783730'>linear</span> <span m='783960'>time.</span>
  <span m='784890'>And</span> <span m='785070'>as</span> <span m='785190'>you</span>
  <span m='785280'>might</span> <span m='785460'>imagine,</span> <span m='786580'>this</span>
  <span m='786910'>log</span> <span m='787210'>to the</span> <span m='787380'>2</span>
  <span m='787530'>plus</span> <span m='787740'>epsilon</span> <span m='788580'>buys</span>
  <span m='788940'>you</span> <span m='789450'>a</span> <span m='789480'>little</span>
  <span m='789720'>bit</span> <span m='789810'>of</span> <span m='789870'>room</span>
  <span m='790830'>with</span> <span m='790950'>some</span> <span m='791160'>tricks,</span>
  <span m='792660'>namely</span> <span m='793020'>hashing.</span> </p><p><span m='795350'>Right,</span>
  <span m='795550'>that's</span> <span m='796890'>where</span> <span m='797040'>we're</span>
  <span m='797160'>going.</span> <span m='799140'>And</span> <span m='799350'>we'll</span>
  <span m='799500'>use</span> <span m='800040'>yet</span> <span m='800250'>another</span>
  <span m='800550'>sorting</span> <span m='800940'>algorithm,</span> <span m='801390'>bitonic</span>
  <span m='801710'>sort,</span> <span m='801930'>which</span> <span m='802080'>you</span>
  <span m='802200'>may</span> <span m='802350'>have</span> <span m='802470'>seen.</span>
  <span m='802770'>It's</span> <span m='802950'>a</span> <span m='803190'>sorting</span>
  <span m='803580'>network.</span> </p><p><span m='805840'>It's in</span> <span m='806020'>CLRS</span>
  <span m='806760'>up</span> <span m='806940'>to</span> <span m='807120'>second</span>
  <span m='807450'>edition,</span> <span m='807840'>but</span> <span m='807960'>it</span>
  <span m='808010'>got</span> <span m='808170'>removed</span> <span m='808470'>from</span>
  <span m='808650'>third</span> <span m='808860'>edition.</span> <span m='810170'>I</span>
  <span m='810200'>guess</span> <span m='810360'>they</span> <span m='810480'>thought</span>
  <span m='810660'>people</span> <span m='810930'>didn't</span> <span m='811140'>use</span>
  <span m='811310'>sorting</span> <span m='811710'>networks,</span> <span m='811950'>but</span>
  <span m='812070'>we</span> <span m='812220'>use</span> <span m='812400'>sorting</span>
  <span m='812700'>networks</span> <span m='813090'>here.</span> </p><p><span m='816270'>Because</span>
  <span m='816540'>it</span> <span m='816630'>gives</span> <span m='817290'>us</span>
  <span m='818040'>parallel</span> <span m='818550'>sorting</span> <span m='819000'>and</span>
  <span m='819150'>the</span> <span m='819240'>word</span> <span m='819450'>ram</span>
  <span m='819690'>is</span> <span m='819810'>all</span> <span m='819930'>about</span>
  <span m='820170'>using</span> <span m='820440'>the</span> <span m='820530'>parallelism</span>
  <span m='821130'>in</span> <span m='821250'>your</span> <span m='821370'>word.</span>
  <span m='823290'>So,</span> <span m='826530'>we'll</span> <span m='826680'>get</span>
  <span m='826830'>to</span> <span m='826950'>those.</span> </p><p><span m='828420'>I'm</span>
  <span m='828480'>going</span> <span m='828600'>to</span> <span m='828660'>start</span>
  <span m='829050'>at</span> <span m='829200'>the</span> <span m='829290'>top</span>
  <span m='829590'>level,</span> <span m='831180'>which</span> <span m='831420'>is</span>
  <span m='832050'>signature</span> <span m='832560'>sort.</span> <span m='833590'>And</span>
  <span m='833640'>we're</span> <span m='833730'>going</span> <span m='833850'>to</span>
  <span m='833910'>leave</span> <span m='834210'>things</span> <span m='834510'>to</span>
  <span m='834630'>be</span> <span m='834720'>done</span> <span m='835050'>and</span>
  <span m='835140'>then</span> <span m='835410'>pack</span> <span m='835680'>sorting</span>
  <span m='836040'>will</span> <span m='836160'>be</span> <span m='836310'>one</span>
  <span m='836460'>of</span> <span m='836520'>them.</span> <span m='837420'>And</span>
  <span m='837630'>bitonic</span> <span m='838110'>sorting</span> <span m='838410'>will</span>
  <span m='838500'>be</span> <span m='838620'>used</span> <span m='838890'>in</span>
  <span m='839010'>pack</span> <span m='839310'>sorting.</span> <span m='839670'>So</span>
  <span m='839910'>it's</span> <span m='840300'>a</span> <span m='840360'>chain</span>
  <span m='841320'>like</span> <span m='841530'>this.</span> <span m='843830'>Cool.</span>
  </p><p><span m='845580'>So</span> <span m='846480'>I'm</span> <span m='846660'>going</span>
  <span m='846930'>to</span> <span m='847260'>assume</span> <span m='850170'>my</span>
  <span m='850320'>signature</span> <span m='850770'>sort</span> <span m='851100'>that</span>
  <span m='851280'>w</span> <span m='852150'>is</span> <span m='852300'>at</span>
  <span m='852420'>least</span> <span m='853270'>log</span> <span m='853875'>to</span>
  <span m='854190'>2</span> <span m='854400'>pulse</span> <span m='854670'>epsilon</span>
  <span m='855210'>n</span> <span m='855990'>times</span> <span m='856500'>log</span>
  <span m='856860'>log</span> <span m='857080'>n.</span> <span m='858640'>This</span>
  <span m='858840'>is</span> <span m='858960'>really</span> <span m='859170'>just</span>
  <span m='859380'>a</span> <span m='859440'>change</span> <span m='859890'>in</span>
  <span m='860040'>what</span> <span m='860280'>epsilon</span> <span m='860940'>means.</span>
  <span m='863550'>If</span> <span m='863670'>you're</span> <span m='863760'>given</span>
  <span m='864060'>some</span> <span m='864330'>particular</span> <span m='864780'>epsilon</span>
  <span m='865080'>make</span> <span m='865240'>it a</span> <span m='865300'>little</span>
  <span m='865500'>smaller,</span> <span m='865920'>then</span> <span m='866070'>you</span>
  <span m='866160'>can</span> <span m='866310'>afford</span> <span m='866610'>to</span>
  <span m='866760'>add</span> <span m='866970'>that</span> <span m='867120'>log</span>
  <span m='867350'>log</span> <span m='867720'>factor.</span> <span m='868560'>This</span>
  <span m='868710'>is</span> <span m='868800'>just</span> <span m='868980'>for</span>
  <span m='869130'>convenience.</span> </p><p><span m='872260'>Now</span> <span m='872710'>here's</span>
  <span m='875730'>the</span> <span m='875850'>idea.</span> <span m='878020'>It's</span>
  <span m='878160'>a</span> <span m='878220'>pretty</span> <span m='878460'>cool</span>
  <span m='878700'>idea</span> <span m='878980'>I</span> <span m='879010'>have</span>
  <span m='879150'>to</span> <span m='879210'>say.</span> <span m='879510'>It's</span>
  <span m='879765'>by</span> <span m='880020'>Anderson</span> <span m='880650'>and</span>
  <span m='880770'>others</span> <span m='881160'>in</span> <span m='881340'>1998.</span>
  </p><p><span m='899250'>OK,</span> <span m='899570'>word</span> <span m='899850'>size</span>
  <span m='900110'>is</span> <span m='900250'>big,</span> <span m='900550'>which</span>
  <span m='900910'>is</span> <span m='901090'>both</span> <span m='901330'>good</span>
  <span m='901510'>and</span> <span m='901600'>bad.</span> <span m='901900'>It</span>
  <span m='901990'>means</span> <span m='902260'>the</span> <span m='902350'>numbers</span>
  <span m='902650'>we</span> <span m='902770'>have</span> <span m='902860'>to</span>
  <span m='902950'>sort</span> <span m='903310'>are</span> <span m='903430'>big.</span>
  <span m='903770'>They</span> <span m='903880'>have</span> <span m='903970'>a</span>
  <span m='904030'>lot</span> <span m='904270'>of</span> <span m='904330'>bits</span>
  <span m='904600'>in</span> <span m='904690'>them,</span> <span m='905410'>way</span>
  <span m='905620'>more</span> <span m='905830'>than</span> <span m='905980'>log</span>
  <span m='906180'>n</span> <span m='906340'>bits.</span> <span m='907600'>But</span>
  <span m='907750'>also,</span> <span m='908170'>we</span> <span m='908320'>have</span>
  <span m='908560'>this</span> <span m='909160'>powerful</span> <span m='909580'>machine</span>
  <span m='910090'>that</span> <span m='910210'>can</span> <span m='910390'>handle</span>
  <span m='912100'>words</span> <span m='912610'>of</span> <span m='912970'>very</span>
  <span m='913330'>large</span> <span m='913570'>size</span> <span m='913960'>and</span>
  <span m='914080'>do</span> <span m='914230'>things</span> <span m='914510'>and</span>
  <span m='914590'>constant</span> <span m='914950'>time</span> <span m='915220'>on</span>
  <span m='915370'>them.</span> </p><p><span m='919090'>I'd</span> <span m='919420'>like</span>
  <span m='919570'>to</span> <span m='919690'>make</span> <span m='919900'>some</span>
  <span m='920680'>slop.</span> <span m='921160'>I</span> <span m='921220'>want</span>
  <span m='921430'>my</span> <span m='921550'>words</span> <span m='921820'>to</span>
  <span m='921940'>be</span> <span m='922090'>bigger</span> <span m='922420'>than</span>
  <span m='922570'>my</span> <span m='922720'>items,</span> <span m='923320'>so</span>
  <span m='924010'>first</span> <span m='924250'>few</span> <span m='924400'>steps</span>
  <span m='924700'>are</span> <span m='924790'>about</span> <span m='925000'>doing</span>
  <span m='925300'>that.</span> <span m='926410'>The</span> <span m='926470'>first</span>
  <span m='926770'>idea</span> <span m='927100'>is,</span> <span m='927220'>well,</span>
  <span m='927610'>you've</span> <span m='927760'>got</span> <span m='927970'>this</span>
  <span m='928180'>giant</span> <span m='928630'>word</span> <span m='930340'>log
  to the</span> <span m='930680'>2</span> <span m='930880'>plus</span> <span m='931150'>epsilon.</span>
  <span m='932020'>So</span> <span m='932250'>let's</span> <span m='932410'>split</span>
  <span m='932770'>it</span> <span m='932920'>into</span> <span m='933850'>chunks.</span>
  <span m='934840'>And</span> <span m='934930'>the</span> <span m='935020'>number</span>
  <span m='935470'>of</span> <span m='935590'>chunks</span> <span m='936940'>is</span>
  <span m='937090'>log</span> <span m='937330'>to</span> <span m='937450'>the</span>
  <span m='937570'>epsilon.</span> </p><p><span m='940180'>So</span> <span m='940330'>that</span>
  <span m='940480'>means</span> <span m='940840'>each</span> <span m='941110'>chunk</span>
  <span m='941650'>is--</span> <span m='944200'>well,</span> <span m='944410'>it</span>
  <span m='944560'>could</span> <span m='944710'>be</span> <span m='944920'>even</span>
  <span m='945220'>bigger.</span> <span m='945710'>So</span> <span m='945820'>it's</span>
  <span m='945970'>at</span> <span m='946060'>least</span> <span m='946420'>log</span>
  <span m='946730'>squared</span> <span m='947150'>n.</span> <span m='948020'>But</span>
  <span m='948310'>it</span> <span m='948610'>could</span> <span m='948760'>be</span>
  <span m='948910'>bigger</span> <span m='949210'>than</span> <span m='949360'>that</span>
  <span m='950500'>because</span> <span m='951220'>w</span> <span m='951510'>is</span>
  <span m='951640'>at</span> <span m='951730'>least</span> <span m='952060'>log to
  the</span> <span m='952320'>2</span> <span m='952450'>plus</span> <span m='952750'>epsilon.</span>
  <span m='953720'>So</span> <span m='953800'>we</span> <span m='953860'>don't</span>
  <span m='954010'>know.</span> <span m='954280'>These</span> <span m='954520'>things</span>
  <span m='954760'>are</span> <span m='954850'>of</span> <span m='954940'>size</span>
  <span m='955710'>w</span> <span m='956140'>divided</span> <span m='956590'>by</span>
  <span m='956890'>log to the</span> <span m='957280'>epsilon</span> <span m='957700'>n.</span>
  <span m='957830'>So</span> <span m='958260'>it's</span> <span m='958450'>at</span>
  <span m='958540'>least</span> <span m='958730'>log</span> <span m='958960'>squared.</span>
  </p><p><span m='960470'>OK,</span> <span m='961750'>here's</span> <span m='962020'>the</span>
  <span m='962200'>crazy</span> <span m='962590'>idea.</span> <span m='964970'>We're</span>
  <span m='965230'>thinking</span> <span m='965590'>of</span> <span m='965770'>our</span>
  <span m='966430'>number</span> <span m='966820'>being</span> <span m='967000'>divided</span>
  <span m='967480'>into</span> <span m='968440'>these</span> <span m='968620'>chunks,</span>
  <span m='969030'>you</span> <span m='969070'>know,</span> <span m='969150'>it's</span>
  <span m='969280'>being</span> <span m='969520'>represented</span> <span m='970180'>in</span>
  <span m='970330'>some</span> <span m='970570'>base,</span> <span m='972245'>2</span>
  <span m='972510'>to</span> <span m='972890'>the</span> <span m='973150'>w</span>
  <span m='973480'>divided</span> <span m='973780'>by</span> <span m='973900'>log</span>
  <span m='974180'>to the</span> <span m='974340'>epsilon</span> <span m='974480'>n.</span>
  <span m='975070'>It's</span> <span m='975420'>a</span> <span m='975490'>bit</span>
  <span m='975640'>of</span> <span m='975730'>a</span> <span m='975790'>mouthful.</span>
  </p><p><span m='977510'>But</span> <span m='977770'>think</span> <span m='978010'>about</span>
  <span m='978280'>these</span> <span m='978490'>digits.</span> <span m='980840'>I</span>
  <span m='980990'>claim</span> <span m='981290'>if</span> <span m='981400'>you</span>
  <span m='981490'>look</span> <span m='981700'>at</span> <span m='981790'>a</span>
  <span m='981850'>digit,</span> <span m='982990'>most</span> <span m='983740'>values</span>
  <span m='984850'>don't</span> <span m='985150'>appear.</span> <span m='987040'>Because</span>
  <span m='987310'>how</span> <span m='987520'>many</span> <span m='987970'>values</span>
  <span m='988510'>are</span> <span m='988630'>there</span> <span m='988780'>for</span>
  <span m='989050'>a</span> <span m='989080'>digit?</span> <span m='989920'>Well,</span>
  <span m='990130'>it's</span> <span m='990280'>at</span> <span m='990370'>least</span>
  <span m='990730'>2</span> <span m='990940'>to</span> <span m='991060'>the</span>
  <span m='991180'>log</span> <span m='991480'>squared</span> <span m='991840'>n.</span>
  <span m='993310'>That's</span> <span m='993520'>a</span> <span m='993580'>big</span>
  <span m='993820'>number.</span> <span m='994220'>That's</span> <span m='994330'>way</span>
  <span m='994630'>bigger</span> <span m='994900'>than</span> <span m='995050'>polynomial</span>
  <span m='995385'>and</span> <span m='995720'>n.</span> </p><p><span m='996610'>But</span>
  <span m='996790'>how</span> <span m='997000'>many</span> <span m='997210'>different</span>
  <span m='997540'>digits</span> <span m='997960'>are</span> <span m='998200'>there?</span>
  <span m='999790'>Well,</span> <span m='999940'>there's</span> <span m='1000090'>n</span>
  <span m='1000330'>numbers,</span> <span m='1001410'>each</span> <span m='1001620'>of</span>
  <span m='1001680'>them</span> <span m='1001860'>has</span> <span m='1002130'>log</span>
  <span m='1002460'>to the</span> <span m='1002610'>epsilon</span> <span m='1003090'>n</span>
  <span m='1004740'>digits</span> <span m='1005280'>in</span> <span m='1005460'>it</span>
  <span m='1006060'>appearing.</span> <span m='1007350'>And</span> <span m='1007440'>so</span>
  <span m='1007610'>there's</span> <span m='1007930'>roughly</span> <span m='1008520'>a</span>
  <span m='1008610'>linear</span> <span m='1009000'>number</span> <span m='1009480'>of</span>
  <span m='1010410'>digit</span> <span m='1010710'>values</span> <span m='1011220'>total.</span>
  <span m='1012870'>But</span> <span m='1013080'>the</span> <span m='1013260'>number</span>
  <span m='1013620'>of</span> <span m='1013710'>possible</span> <span m='1014280'>digit</span>
  <span m='1014520'>values</span> <span m='1014850'>is</span> <span m='1014970'>2</span>
  <span m='1015110'>to</span> <span m='1015210'>the</span> <span m='1015270'>log</span>
  <span m='1016020'>log</span> <span m='1016260'>squared</span> <span m='1016620'>n,</span>
  <span m='1016830'>which</span> <span m='1017010'>is</span> <span m='1017130'>huge,</span>
  <span m='1018210'>super</span> <span m='1018510'>polynomial.</span> <span m='1020580'>So</span>
  <span m='1021000'>most</span> <span m='1021600'>digit</span> <span m='1021990'>values</span>
  <span m='1022500'>don't</span> <span m='1022800'>appear</span> <span m='1023220'>in</span>
  <span m='1023370'>our</span> <span m='1023520'>numbers.</span> </p><p><span m='1025030'>So</span>
  <span m='1025130'>what we're</span> <span m='1025380'>going</span> <span m='1025540'>to</span>
  <span m='1025619'>do</span> <span m='1025890'>is</span> <span m='1026069'>hash</span>
  <span m='1026849'>the</span> <span m='1026990'>digit</span> <span m='1027359'>values</span>
  <span m='1028349'>to</span> <span m='1028470'>reduce</span> <span m='1028950'>their</span>
  <span m='1029130'>space.</span> <span m='1029460'>Because</span> <span m='1029609'>they're</span>
  <span m='1029910'>currently</span> <span m='1030329'>living</span> <span m='1030630'>in</span>
  <span m='1030720'>a</span> <span m='1030780'>universe</span> <span m='1031170'>of</span>
  <span m='1031230'>2</span> <span m='1031530'>to the log</span> <span m='1031760'>squared</span>
  <span m='1032109'>n,</span> <span m='1033050'>but</span> <span m='1033180'>there's</span>
  <span m='1033359'>only</span> <span m='1033660'>n</span> <span m='1033985'>times</span>
  <span m='1034310'>log to</span> <span m='1034579'>the</span> <span m='1034680'>epsilon</span>
  <span m='1035099'>n</span> <span m='1035240'>of</span> <span m='1035460'>them.</span>
  <span m='1036089'>So</span> <span m='1036270'>we</span> <span m='1036390'>should</span>
  <span m='1036540'>be</span> <span m='1036630'>able</span> <span m='1036750'>to</span>
  <span m='1036839'>reduce</span> <span m='1037319'>to</span> <span m='1037500'>have</span>
  <span m='1037550'>a</span> <span m='1037619'>much</span> <span m='1037829'>smaller</span>
  <span m='1038160'>universe</span> <span m='1043200'>using</span> <span m='1043530'>hashing.</span>
  <span m='1044970'>Maybe</span> <span m='1048840'>perfect</span> <span m='1049140'>hashing</span>
  <span m='1050220'>even.</span> <span m='1050790'>I</span> <span m='1050850'>mean,</span>
  <span m='1051000'>we</span> <span m='1051090'>don't</span> <span m='1051210'>have</span>
  <span m='1051330'>to</span> <span m='1051420'>be</span> <span m='1051540'>too</span>
  <span m='1051750'>intelligent</span> <span m='1052170'>here.</span> <span m='1052710'>Tell
  you</span> <span m='1052950'>what</span> <span m='1053070'>we</span> <span m='1053190'>get.</span>
  </p><p><span m='1061980'>What</span> <span m='1062130'>I'd</span> <span m='1062220'>like</span>
  <span m='1062460'>is</span> <span m='1062580'>to</span> <span m='1062670'>reduce</span>
  <span m='1062970'>to</span> <span m='1063090'>a</span> <span m='1063120'>polynomial</span>
  <span m='1063780'>universe.</span> <span m='1066120'>And</span> <span m='1066450'>another</span>
  <span m='1066690'>way</span> <span m='1066780'>to</span> <span m='1066870'>say</span>
  <span m='1067080'>that</span> <span m='1071600'>is</span> <span m='1071860'>that</span>
  <span m='1071940'>the</span> <span m='1072030'>hash</span> <span m='1072330'>values</span>
  <span m='1072780'>are</span> <span m='1073050'>order</span> <span m='1073380'>log</span>
  <span m='1073680'>n</span> <span m='1073860'>bits.</span> <span m='1074240'>So</span>
  <span m='1074280'>this</span> <span m='1074460'>lets</span> <span m='1074670'>us</span>
  <span m='1074790'>go</span> <span m='1075030'>to</span> <span m='1075180'>n</span>
  <span m='1075380'>to</span> <span m='1075510'>the</span> <span m='1075630'>10,</span>
  <span m='1076020'>or</span> <span m='1076110'>whatever,</span> <span m='1077140'>which
  is</span> <span m='1077340'>plenty</span> <span m='1077730'>of</span> <span m='1077820'>room.</span>
  <span m='1078360'>We</span> <span m='1078480'>take</span> <span m='1079200'>any</span>
  <span m='1079440'>universal</span> <span m='1079980'>hash</span> <span m='1080250'>function,</span>
  <span m='1083050'>as</span> <span m='1083780'>soon</span> <span m='1083970'>as</span>
  <span m='1084060'>you</span> <span m='1084120'>get</span> <span m='1084270'>to</span>
  <span m='1084750'>roughly</span> <span m='1085110'>n</span> <span m='1085290'>squared</span>
  <span m='1085740'>size,</span> <span m='1086250'>I</span> <span m='1086280'>mean</span>
  <span m='1086400'>the</span> <span m='1086490'>square</span> <span m='1086940'>of</span>
  <span m='1087060'>the</span> <span m='1087120'>number</span> <span m='1087450'>of</span>
  <span m='1087540'>things,</span> <span m='1088380'>by</span> <span m='1088630'>a</span>
  <span m='1088680'>birthday</span> <span m='1088980'>paradox,</span> <span m='1089460'>constant</span>
  <span m='1089790'>probability</span> <span m='1090240'>none</span> <span m='1090480'>of</span>
  <span m='1090570'>them</span> <span m='1090750'>will</span> <span m='1090900'>hit</span>
  <span m='1091050'>each</span> <span m='1091230'>other.</span> </p><p><span m='1092070'>That</span>
  <span m='1092190'>was</span> <span m='1092340'>the</span> <span m='1092460'>second</span>
  <span m='1092790'>level</span> <span m='1093120'>of</span> <span m='1093240'>perfect</span>
  <span m='1093520'>hashing.</span> <span m='1094320'>We</span> <span m='1094440'>don't</span>
  <span m='1094560'>need</span> <span m='1094710'>two</span> <span m='1094890'>levels</span>
  <span m='1095190'>here,</span> <span m='1095370'>just</span> <span m='1095490'>say</span>
  <span m='1095690'>OK,</span> <span m='1096660'>user</span> <span m='1096930'>order</span>
  <span m='1097140'>log</span> <span m='1097380'>n</span> <span m='1097500'>bits.</span>
  <span m='1097760'>You</span> <span m='1097830'>can</span> <span m='1097950'>set</span>
  <span m='1098130'>this</span> <span m='1098310'>to</span> <span m='1098490'>100,</span>
  <span m='1099030'>whatever.</span> <span m='1100320'>Then</span> <span m='1100560'>with</span>
  <span m='1100680'>high</span> <span m='1100830'>probability</span> <span m='1101400'>you</span>
  <span m='1101520'>will</span> <span m='1101640'>not</span> <span m='1101820'>get</span>
  <span m='1101970'>collisions,</span> <span m='1103230'>so</span> <span m='1103350'>none</span>
  <span m='1103530'>of</span> <span m='1103590'>the</span> <span m='1103710'>chunks</span>
  <span m='1103980'>will</span> <span m='1104070'>hit</span> <span m='1104190'>each</span>
  <span m='1104370'>other.</span> </p><p><span m='1105300'>So</span> <span m='1105400'>I'm</span>
  <span m='1105420'>omitting</span> <span m='1105720'>a</span> <span m='1105780'>step</span>
  <span m='1106050'>here</span> <span m='1106200'>which</span> <span m='1106380'>is</span>
  <span m='1106500'>how</span> <span m='1106830'>to--</span> <span m='1107880'>OK,</span>
  <span m='1108120'>I'm</span> <span m='1108240'>omitting</span> <span m='1108480'>a</span>
  <span m='1108540'>couple</span> <span m='1108750'>of</span> <span m='1108810'>things</span>
  <span m='1109650'>here.</span> <span m='1111370'>One</span> <span m='1111480'>of</span>
  <span m='1111570'>them</span> <span m='1113100'>is</span> <span m='1114330'>I</span>
  <span m='1114540'>want</span> <span m='1114720'>to</span> <span m='1114780'>do</span>
  <span m='1114870'>this</span> <span m='1115080'>in</span> <span m='1115200'>linear</span>
  <span m='1115500'>time.</span> <span m='1116130'>Everything</span> <span m='1116520'>has</span>
  <span m='1116640'>to</span> <span m='1116760'>be</span> <span m='1116820'>in</span>
  <span m='1116910'>linear</span> <span m='1117210'>time.</span> <span m='1118060'>So</span>
  <span m='1118140'>one</span> <span m='1118350'>front</span> <span m='1118560'>part</span>
  <span m='1118830'>is</span> <span m='1118980'>I</span> <span m='1119040'>have</span>
  <span m='1119160'>to</span> <span m='1119250'>compute</span> <span m='1119550'>the</span>
  <span m='1119670'>hash</span> <span m='1119940'>value</span> <span m='1120250'>of</span>
  <span m='1120420'>all</span> <span m='1120810'>of</span> <span m='1120960'>these</span>
  <span m='1121710'>digits</span> <span m='1123210'>in</span> <span m='1123360'>a</span>
  <span m='1123420'>single</span> <span m='1123780'>word</span> <span m='1124250'>in</span>
  <span m='1124490'>constant</span> <span m='1124970'>time.</span> </p><p><span m='1127220'>So</span>
  <span m='1127380'>a</span> <span m='1127440'>brief</span> <span m='1127740'>aside,</span>
  <span m='1128520'>how</span> <span m='1128760'>would</span> <span m='1128880'>I</span>
  <span m='1128970'>compute</span> <span m='1130710'>a</span> <span m='1130770'>universal</span>
  <span m='1131310'>hash</span> <span m='1131550'>function</span> <span m='1131920'>of</span>
  <span m='1132300'>these</span> <span m='1132450'>digits</span> <span m='1132810'>individually</span>
  <span m='1133590'>in</span> <span m='1133740'>constant</span> <span m='1134100'>time?</span>
  <span m='1135240'>Well,</span> <span m='1138870'>my</span> <span m='1139170'>personal</span>
  <span m='1139860'>favorite</span> <span m='1141120'>universal</span> <span m='1141630'>hashing</span>
  <span m='1141960'>scheme</span> <span m='1142230'>is</span> <span m='1142350'>the</span>
  <span m='1142410'>multiplication</span> <span m='1143100'>method.</span> <span m='1143940'>You</span>
  <span m='1144000'>just</span> <span m='1144180'>need</span> <span m='1144330'>to</span>
  <span m='1144480'>multiply</span> <span m='1146040'>by</span> <span m='1146400'>a</span>
  <span m='1146460'>single</span> <span m='1146850'>value</span> <span m='1147270'>m</span>
  <span m='1148240'>and</span> <span m='1148340'>then</span> <span m='1148380'>take</span>
  <span m='1148560'>it</span> <span m='1148650'>modular</span> <span m='1149040'>something.</span>
  <span m='1151210'>So</span> <span m='1151710'>if</span> <span m='1151860'>I</span>
  <span m='1151950'>do</span> <span m='1152100'>multiplication,</span> <span m='1160510'>I</span>
  <span m='1160540'>mean</span> <span m='1160690'>if</span> <span m='1160780'>you</span>
  <span m='1160870'>think</span> <span m='1161050'>of</span> <span m='1161140'>there</span>
  <span m='1161260'>being</span> <span m='1161440'>something</span> <span m='1161770'>here,</span>
  <span m='1162490'>something</span> <span m='1162850'>here,</span> <span m='1163090'>something</span>
  <span m='1163480'>here,</span> <span m='1163720'>something</span> <span m='1164110'>here,</span>
  <span m='1164380'>something</span> <span m='1164740'>here,</span> <span m='1165475'>m</span>
  <span m='1165940'>does</span> <span m='1166270'>multiply</span> <span m='1168760'>each</span>
  <span m='1169030'>of</span> <span m='1169120'>these</span> <span m='1169330'>individually.</span>
  <span m='1174170'>Wow,</span> <span m='1174280'>that's</span> <span m='1174460'>a</span>
  <span m='1174520'>rough</span> <span m='1174730'>sketch.</span> </p><p><span m='1176200'>I</span>
  <span m='1176290'>want</span> <span m='1176530'>to</span> <span m='1176710'>hash</span>
  <span m='1177040'>each</span> <span m='1177190'>of</span> <span m='1177250'>these</span>
  <span m='1177430'>guys</span> <span m='1177820'>multiply,</span> <span m='1178240'>them</span>
  <span m='1178360'>by</span> <span m='1178480'>the</span> <span m='1178570'>multiplication</span>
  <span m='1179170'>method.</span> <span m='1180220'>This</span> <span m='1180460'>would</span>
  <span m='1180610'>work</span> <span m='1180880'>fine,</span> <span m='1181240'>except</span>
  <span m='1181600'>you</span> <span m='1181720'>get</span> <span m='1181900'>overflows,</span>
  <span m='1182800'>which</span> <span m='1183160'>is</span> <span m='1183310'>a</span>
  <span m='1183370'>bit</span> <span m='1183520'>messy.</span> <span m='1184340'>So</span>
  <span m='1184480'>in</span> <span m='1184570'>fact,</span> <span m='1184900'>I'm</span>
  <span m='1185020'>going</span> <span m='1185170'>to</span> <span m='1185230'>have</span>
  <span m='1185380'>to</span> <span m='1185470'>do</span> <span m='1185590'>it</span>
  <span m='1185680'>for</span> <span m='1185920'>the</span> <span m='1186700'>odd</span>
  <span m='1186910'>guys</span> <span m='1187210'>first,</span> <span m='1188020'>multiply</span>
  <span m='1188350'>them</span> <span m='1188500'>out,</span> <span m='1188830'>mask</span>
  <span m='1189190'>out</span> <span m='1189310'>the</span> <span m='1189400'>bits</span>
  <span m='1189610'>I</span> <span m='1189670'>care</span> <span m='1189880'>about,</span>
  <span m='1190390'>then</span> <span m='1190570'>do</span> <span m='1190690'>it</span>
  <span m='1190750'>for</span> <span m='1190900'>the</span> <span m='1190990'>even</span>
  <span m='1191290'>guys</span> <span m='1191620'>separately.</span> <span m='1193600'>So</span>
  <span m='1193720'>it's</span> <span m='1193840'>a</span> <span m='1193900'>bit</span>
  <span m='1194050'>messy.</span> <span m='1194470'>But</span> <span m='1194980'>hand-wavy</span>
  <span m='1195640'>proof</span> <span m='1196450'>you</span> <span m='1196600'>can</span>
  <span m='1197080'>compute</span> <span m='1197530'>the</span> <span m='1197650'>hash</span>
  <span m='1197890'>function</span> <span m='1198700'>of</span> <span m='1198850'>each</span>
  <span m='1199000'>of</span> <span m='1199060'>these</span> <span m='1199240'>guys</span>
  <span m='1199450'>individually,</span> <span m='1200230'>but</span> <span m='1200290'>in</span>
  <span m='1200410'>constant</span> <span m='1200780'>time.</span> <span m='1202100'>So</span>
  <span m='1202180'>that</span> <span m='1202360'>lets</span> <span m='1202600'>me</span>
  <span m='1202810'>do</span> <span m='1203020'>this.</span> </p><p><span m='1203260'>You</span>
  <span m='1203350'>have</span> <span m='1203500'>to</span> <span m='1203590'>then</span>
  <span m='1203770'>check</span> <span m='1203980'>for</span> <span m='1204100'>collisions,</span>
  <span m='1204640'>which</span> <span m='1204790'>is</span> <span m='1204880'>kind</span>
  <span m='1205060'>of</span> <span m='1205150'>annoying.</span> <span m='1205510'>Let's</span>
  <span m='1205660'>not</span> <span m='1205810'>worry</span> <span m='1205960'>about</span>
  <span m='1206200'>that.</span> <span m='1206900'>Set</span> <span m='1207130'>this</span>
  <span m='1207280'>really</span> <span m='1207520'>high,</span> <span m='1207790'>very</span>
  <span m='1208030'>high</span> <span m='1208150'>probability,</span> <span m='1208750'>there</span>
  <span m='1208870'>will</span> <span m='1209050'>be</span> <span m='1209170'>no</span>
  <span m='1209350'>collisions.</span> <span m='1211900'>Cool.</span> </p><p><span
  m='1213640'>So</span> <span m='1214060'>at</span> <span m='1214180'>this</span>
  <span m='1214360'>point</span> <span m='1215200'>we</span> <span m='1215350'>have</span>
  <span m='1215650'>mucked</span> <span m='1216100'>up</span> <span m='1216280'>all</span>
  <span m='1216400'>the</span> <span m='1216520'>digits.</span> <span m='1217420'>The</span>
  <span m='1217660'>annoying</span> <span m='1218020'>thing</span> <span m='1218170'>about</span>
  <span m='1218350'>this</span> <span m='1218500'>hashing</span> <span m='1218860'>is</span>
  <span m='1218980'>we</span> <span m='1219100'>do</span> <span m='1219250'>not</span>
  <span m='1219520'>preserve</span> <span m='1220060'>order.</span> <span m='1224860'>It's</span>
  <span m='1225030'>a</span> <span m='1225130'>little</span> <span m='1225400'>weird</span>
  <span m='1225670'>for a</span> <span m='1225820'>sorting</span> <span m='1226180'>algorithm</span>
  <span m='1226660'>not</span> <span m='1226840'>preserve</span> <span m='1227230'>order.</span>
  <span m='1228670'>The</span> <span m='1228760'>whole</span> <span m='1228970'>point</span>
  <span m='1229810'>is</span> <span m='1229990'>to</span> <span m='1230110'>put</span>
  <span m='1230320'>things</span> <span m='1230680'>in</span> <span m='1230860'>order.</span>
  </p><p><span m='1231850'>But</span> <span m='1232510'>it's</span> <span m='1232690'>going</span>
  <span m='1232840'>to</span> <span m='1232900'>be</span> <span m='1233020'>useful</span>
  <span m='1233380'>nonetheless.</span> <span m='1234370'>And</span> <span m='1234500'>so</span>
  <span m='1234700'>each</span> <span m='1234940'>digit</span> <span m='1235660'>has</span>
  <span m='1235840'>been</span> <span m='1236020'>mangled.</span> <span m='1236740'>Each</span>
  <span m='1236980'>digit</span> <span m='1237250'>is</span> <span m='1237370'>out</span>
  <span m='1237520'>of</span> <span m='1237640'>order.</span> <span m='1238570'>But</span>
  <span m='1238720'>of</span> <span m='1238810'>course,</span> <span m='1239590'>the</span>
  <span m='1240160'>sequence</span> <span m='1240490'>of</span> <span m='1240580'>digits</span>
  <span m='1240910'>has</span> <span m='1241060'>been</span> <span m='1241330'>preserved,</span>
  <span m='1242300'>in</span> <span m='1242380'>some</span> <span m='1242560'>sense</span>
  </p><p><span m='1245800'>So,</span> <span m='1246370'>what?</span> <span m='1247730'>Well,</span>
  <span m='1248920'>at</span> <span m='1249070'>this</span> <span m='1249250'>point</span>
  <span m='1249490'>we</span> <span m='1249610'>can</span> <span m='1249730'>use</span>
  <span m='1249910'>packed</span> <span m='1250300'>sorting</span> <span m='1251290'>to</span>
  <span m='1251410'>sort</span> <span m='1252040'>what</span> <span m='1252250'>remains.</span>
  <span m='1265836'>In</span> <span m='1266210'>general</span> <span m='1266570'>packed</span>
  <span m='1266840'>sorting</span> <span m='1267710'>can</span> <span m='1267930'>sort</span>
  <span m='1268280'>n</span> <span m='1268670'>b</span> <span m='1268880'>bit</span>
  <span m='1269180'>integers</span> <span m='1271490'>provided</span> <span m='1272000'>b</span>
  <span m='1272210'>is</span> <span m='1272300'>small,</span> <span m='1273070'>so</span>
  <span m='1273200'>w</span> <span m='1273680'>is</span> <span m='1273920'>at</span>
  <span m='1274010'>least</span> <span m='1275150'>b</span> <span m='1275810'>log</span>
  <span m='1276170'>n</span> <span m='1276990'>log log</span> <span m='1277450'>n.</span>
  <span m='1278500'>That's</span> <span m='1280200'>the</span> <span m='1280360'>theorem</span>
  <span m='1280910'>of</span> <span m='1281210'>packed</span> <span m='1281480'>sorting.</span>
  <span m='1281900'>We're</span> <span m='1281990'>going</span> <span m='1282110'>to</span>
  <span m='1282470'>delay</span> <span m='1283100'>the</span> <span m='1283190'>coverage</span>
  <span m='1283610'>of</span> <span m='1283700'>this</span> <span m='1284720'>result</span>
  <span m='1285080'>until</span> <span m='1285230'>later.</span> </p><p><span m='1286330'>And</span>
  <span m='1286420'>I</span> <span m='1286490'>claim</span> <span m='1286790'>that</span>
  <span m='1286910'>that</span> <span m='1287090'>applies</span> <span m='1287570'>here</span>
  <span m='1288200'>because</span> <span m='1291770'>each</span> <span m='1292040'>chunk</span>
  <span m='1296460'>is</span> <span m='1296590'>now</span> <span m='1296830'>order</span>
  <span m='1297220'>log</span> <span m='1297580'>n</span> <span m='1297820'>bits.</span>
  <span m='1299290'>And</span> <span m='1299590'>there's</span> <span m='1299830'>log</span>
  <span m='1300160'>to</span> <span m='1300340'>the</span> <span m='1300820'>epsilon</span>
  <span m='1302010'>n</span> <span m='1302310'>bits.</span> <span m='1303200'>So</span>
  <span m='1303310'>b</span> <span m='1304330'>is</span> <span m='1305540'>theta</span>
  <span m='1306340'>log</span> <span m='1307330'>to</span> <span m='1307540'>the</span>
  <span m='1307720'>1</span> <span m='1308020'>plus</span> <span m='1308350'>epsilon</span>
  <span m='1309100'>n.</span> <span m='1311320'>And</span> <span m='1311510'>w</span>
  <span m='1313876'>is</span> <span m='1314320'>at</span> <span m='1314410'>least</span>
  <span m='1315840'>log</span> <span m='1316200'>to</span> <span m='1316420'>the 2</span>
  <span m='1316630'>plus</span> <span m='1316870'>epsilon</span> <span m='1319060'>times</span>
  <span m='1319345'>log</span> <span m='1319630'>log</span> <span m='1319990'>n.</span>
  <span m='1321890'>OK,</span> <span m='1322030'>so</span> <span m='1322180'>the</span>
  <span m='1322300'>ratio</span> <span m='1322720'>between</span> <span m='1323050'>these</span>
  <span m='1323470'>is</span> <span m='1323950'>as</span> <span m='1324310'>needed.</span>
  <span m='1324670'>It's</span> <span m='1324820'>at</span> <span m='1324910'>least</span>
  <span m='1325090'>log</span> <span m='1325390'>n</span> <span m='1325600'>times</span>
  <span m='1325900'>log</span> <span m='1326190'>log</span> <span m='1326410'>n.</span>
  </p><p><span m='1329450'>OK,</span> <span m='1329740'>so</span> <span m='1329980'>that's</span>
  <span m='1330190'>why</span> <span m='1330340'>this</span> <span m='1330550'>is</span>
  <span m='1330670'>good.</span> <span m='1331220'>There</span> <span m='1331310'>were</span>
  <span m='1331540'>these</span> <span m='1331810'>things</span> <span m='1332020'>were</span>
  <span m='1332110'>huge</span> <span m='1332470'>before.</span> <span m='1333250'>We've</span>
  <span m='1333370'>compressed</span> <span m='1333790'>them</span> <span m='1333970'>a</span>
  <span m='1334030'>lot.</span> <span m='1335330'>They're</span> <span m='1335390'>at</span>
  <span m='1335450'>least</span> <span m='1335620'>log</span> <span m='1335840'>square,</span>
  <span m='1336160'>now</span> <span m='1336340'>they're</span> <span m='1336490'>only</span>
  <span m='1336700'>log.</span> <span m='1338560'>And</span> <span m='1338770'>so</span>
  <span m='1339490'>now</span> <span m='1340240'>we</span> <span m='1340330'>can</span>
  <span m='1340450'>apply</span> <span m='1340720'>packed</span> <span m='1340960'>sorting.</span>
  </p><p><span m='1344080'>You</span> <span m='1344170'>can</span> <span m='1344290'>fit</span>
  <span m='1345240'>log</span> <span m='1345550'>times</span> <span m='1345790'>log</span>
  <span m='1346030'>log</span> <span m='1346720'>items</span> <span m='1347290'>into</span>
  <span m='1347560'>one</span> <span m='1347770'>word.</span> <span m='1348460'>And</span>
  <span m='1348580'>that's</span> <span m='1348760'>going</span> <span m='1348880'>to</span>
  <span m='1348970'>make</span> <span m='1349120'>sorting</span> <span m='1349480'>easy,</span>
  <span m='1349870'>somehow.</span> <span m='1350680'>That's</span> <span m='1351130'>to</span>
  <span m='1351310'>be</span> <span m='1351430'>done.</span> </p><p><span m='1352660'>But</span>
  <span m='1352810'>now</span> <span m='1352960'>the</span> <span m='1353050'>question</span>
  <span m='1353350'>is,</span> <span m='1354940'>suppose</span> <span m='1355390'>we</span>
  <span m='1355480'>had</span> <span m='1355660'>packed</span> <span m='1355930'>sorting,</span>
  <span m='1356800'>how</span> <span m='1356980'>does</span> <span m='1357160'>this</span>
  <span m='1357310'>help</span> <span m='1357580'>you?</span> <span m='1357760'>Because</span>
  <span m='1357940'>this</span> <span m='1358120'>does</span> <span m='1358300'>not</span>
  <span m='1358630'>sort</span> <span m='1358990'>the</span> <span m='1359080'>original</span>
  <span m='1359530'>integers.</span> <span m='1360460'>It</span> <span m='1360610'>sorts</span>
  <span m='1361000'>these</span> <span m='1361480'>integers</span> <span m='1361960'>that</span>
  <span m='1362050'>have</span> <span m='1362290'>all</span> <span m='1362530'>of</span>
  <span m='1362620'>their</span> <span m='1362740'>digits</span> <span m='1363070'>permuted</span>
  <span m='1363670'>in</span> <span m='1363820'>some</span> <span m='1364390'>random</span>
  <span m='1364870'>way.</span> <span m='1365140'>We</span> <span m='1365230'>have</span>
  <span m='1365350'>no</span> <span m='1365590'>idea</span> <span m='1366550'>how</span>
  <span m='1366940'>the</span> <span m='1367060'>hash</span> <span m='1367330'>function</span>
  <span m='1367640'>re-orders</span> <span m='1368140'>things.</span> <span m='1369070'>So</span>
  <span m='1369160'>we're</span> <span m='1369250'>not</span> <span m='1369490'>done</span>
  <span m='1370180'>with</span> <span m='1370550'>signature</span> <span m='1371020'>sort.</span>
  </p><p><span m='1372160'>It's</span> <span m='1372280'>called</span> <span m='1372490'>signature</span>
  <span m='1372880'>sort,</span> <span m='1373120'>of</span> <span m='1373210'>course,</span>
  <span m='1373450'>because</span> <span m='1373810'>of</span> <span m='1373870'>the</span>
  <span m='1374020'>hashing.</span> <span m='1374560'>You're</span> <span m='1374650'>taking</span>
  <span m='1374950'>signatures</span> <span m='1375550'>of</span> <span m='1375610'>each</span>
  <span m='1375760'>of</span> <span m='1375820'>these</span> <span m='1376000'>digits.</span>
  <span m='1377390'>Another</span> <span m='1377650'>word</span> <span m='1377830'>for</span>
  <span m='1378010'>hashes.</span> </p><p><span m='1379690'>All</span> <span m='1379750'>right,</span>
  <span m='1380230'>next</span> <span m='1380530'>step</span> <span m='1382300'>is</span>
  <span m='1382510'>to</span> <span m='1384040'>build</span> <span m='1384610'>a</span>
  <span m='1384790'>compressed</span> <span m='1385680'>trie.</span> <span m='1389380'>This</span>
  <span m='1389560'>is</span> <span m='1389710'>a</span> <span m='1389800'>term</span>
  <span m='1390040'>we</span> <span m='1390130'>haven't</span> <span m='1390430'>used</span>
  <span m='1390730'>yet.</span> <span m='1397540'>So</span> <span m='1397570'>I'm</span>
  <span m='1397630'>going</span> <span m='1397750'>to</span> <span m='1397810'>call</span>
  <span m='1398020'>these</span> <span m='1398170'>things</span> <span m='1398380'>that</span>
  <span m='1398500'>we</span> <span m='1398650'>sorted</span> <span m='1399130'>signatures.</span>
  </p><p><span m='1401890'>And</span> <span m='1403630'>how</span> <span m='1403750'>many</span>
  <span m='1403900'>people</span> <span m='1404140'>know</span> <span m='1404270'>what</span>
  <span m='1404370'>a</span> <span m='1404440'>compressed</span> <span m='1404800'>trie</span>
  <span m='1405160'>is?</span> <span m='1406960'>OK,</span> <span m='1407470'>no</span>
  <span m='1407620'>one.</span> <span m='1407820'>Wow,</span> <span m='1408220'>just</span>
  <span m='1408400'>a</span> <span m='1408430'>few.</span> <span m='1408985'>So</span>
  <span m='1409300'>you</span> <span m='1409360'>haven't</span> <span m='1409540'>seen</span>
  <span m='1409720'>suffix</span> <span m='1410080'>trees</span> <span m='1410290'>yet.</span>
  <span m='1410410'>We're</span> <span m='1410530'>going</span> <span m='1410650'>to</span>
  <span m='1410710'>cover</span> <span m='1411550'>where</span> <span m='1412060'>compressed</span>
  <span m='1412410'>tries</span> <span m='1412630'>come</span> <span m='1412930'>from</span>
  <span m='1413210'>in</span> <span m='1413320'>a</span> <span m='1413380'>couple</span>
  <span m='1413650'>of</span> <span m='1413750'>lectures</span> <span m='1414350'>but</span>
  <span m='1414370'>we</span> <span m='1414490'>get</span> <span m='1414610'>to</span>
  <span m='1414730'>see</span> <span m='1414880'>them</span> <span m='1415000'>a</span>
  <span m='1415060'>little</span> <span m='1415300'>early</span> <span m='1416250'>because</span>
  <span m='1416440'>they're</span> <span m='1416560'>cool</span> <span m='1417790'>and</span>
  <span m='1418120'>needed</span> <span m='1418480'>in</span> <span m='1418890'>this</span>
  <span m='1420040'>algorithm.</span> </p><p><span m='1421640'>So</span> <span m='1421870'>first</span>
  <span m='1422470'>notion</span> <span m='1422860'>is</span> <span m='1423010'>the</span>
  <span m='1423100'>notion</span> <span m='1423370'>of</span> <span m='1423460'>a</span>
  <span m='1423520'>trie.</span> <span m='1424230'>The</span> <span m='1424330'>word</span>
  <span m='1424450'>trie</span> <span m='1424780'>comes</span> <span m='1425680'>from</span>
  <span m='1426020'>retrieval,</span> <span m='1429340'>from</span> <span m='1429580'>old</span>
  <span m='1429760'>days</span> <span m='1430090'>when</span> <span m='1430270'>information</span>
  <span m='1430690'>retrieval</span> <span m='1431170'>was</span> <span m='1431870'>what's</span>
  <span m='1432220'>now</span> <span m='1432430'>called</span> <span m='1433210'>web</span>
  <span m='1434140'>searching,</span> <span m='1434680'>or</span> <span m='1434740'>whatever.</span>
  <span m='1436640'>So</span> <span m='1436900'>it's</span> <span m='1437580'>now</span>
  <span m='1437860'>pronounced</span> <span m='1438220'>trie.</span> <span m='1440410'>It's</span>
  <span m='1440560'>just</span> <span m='1440830'>another</span> <span m='1441070'>word</span>
  <span m='1441190'>for</span> <span m='1441340'>tree,</span> <span m='1442090'>but</span>
  <span m='1442330'>where</span> <span m='1442630'>the</span> <span m='1443140'>children</span>
  <span m='1443560'>of</span> <span m='1443660'>the</span> <span m='1443710'>tree</span>
  <span m='1444700'>come</span> <span m='1445000'>from</span> <span m='1445390'>a</span>
  <span m='1445510'>fixed</span> <span m='1445840'>universe.</span> </p><p><span m='1450780'>We've</span>
  <span m='1450960'>been</span> <span m='1451110'>working</span> <span m='1451410'>with</span>
  <span m='1452130'>tries</span> <span m='1452550'>all</span> <span m='1452820'>the</span>
  <span m='1452880'>time</span> <span m='1453285'>in</span> <span m='1453690'>pretty</span>
  <span m='1453930'>much</span> <span m='1454110'>every</span> <span m='1454350'>lecture</span>
  <span m='1454680'>for</span> <span m='1454800'>the</span> <span m='1454890'>last</span>
  <span m='1455400'>n</span> <span m='1455640'>lectures,</span> <span m='1456990'>last</span>
  <span m='1457200'>w</span> <span m='1457530'>lectures,</span> <span m='1457980'>I</span>
  <span m='1458070'>don't</span> <span m='1458190'>know,</span> <span m='1458670'>a</span>
  <span m='1458700'>lot</span> <span m='1458910'>of</span> <span m='1459030'>them.</span>
  <span m='1459620'>We</span> <span m='1459720'>said</span> <span m='1459960'>oh,</span>
  <span m='1460290'>OK,</span> <span m='1460710'>well</span> <span m='1460950'>let's</span>
  <span m='1461130'>just</span> <span m='1461280'>consider</span> <span m='1461790'>the</span>
  <span m='1461910'>space</span> <span m='1462300'>of</span> <span m='1462420'>all</span>
  <span m='1462600'>possible</span> <span m='1463140'>keys.</span> <span m='1464400'>You</span>
  <span m='1464490'>know,</span> <span m='1464580'>I've</span> <span m='1464670'>drawn</span>
  <span m='1464880'>this</span> <span m='1465000'>picture</span> <span m='1465480'>zillion</span>
  <span m='1465840'>times.</span> <span m='1466260'>Even</span> <span m='1466530'>when</span>
  <span m='1466710'>we</span> <span m='1466800'>weren't</span> <span m='1466980'>doing</span>
  <span m='1467410'>Van</span> <span m='1467590'>Emde</span> <span m='1467770'>Boas,</span>
  <span m='1468150'>which</span> <span m='1468330'>actually</span> <span m='1468630'>stores</span>
  <span m='1469020'>all</span> <span m='1469190'>of</span> <span m='1469250'>these</span>
  <span m='1469440'>things,</span> <span m='1470590'>we</span> <span m='1470870'>were</span>
  <span m='1470970'>thinking</span> <span m='1471240'>about</span> <span m='1471450'>fusion</span>
  <span m='1471800'>trees</span> <span m='1472030'>like,</span> <span m='1472260'>oh</span>
  <span m='1472440'>yeah,</span> <span m='1472740'>so</span> <span m='1472890'>we're</span>
  <span m='1472980'>storing</span> <span m='1473280'>this</span> <span m='1473490'>value,</span>
  <span m='1474510'>and</span> <span m='1474600'>we're</span> <span m='1474690'>storing</span>
  <span m='1475020'>this</span> <span m='1475260'>value,</span> <span m='1475980'>and</span>
  <span m='1476050'>maybe</span> <span m='1476370'>this</span> <span m='1476640'>value.</span>
  </p><p><span m='1477660'>And</span> <span m='1477840'>we</span> <span m='1477990'>understand</span>
  <span m='1478590'>this</span> <span m='1478980'>corresponds</span> <span m='1479460'>to
  a</span> <span m='1479550'>0-bit.</span> <span m='1480080'>These</span> <span m='1480240'>are</span>
  <span m='1480330'>0</span> <span m='1480540'>and</span> <span m='1480630'>1</span>
  <span m='1480850'>bits.</span> <span m='1481250'>This</span> <span m='1481350'>is
  a</span> <span m='1481470'>1,</span> <span m='1482060'>0,</span> <span m='1482320'>1,</span>
  <span m='1483090'>whatever.</span> <span m='1483560'>So</span> <span m='1484050'>we</span>
  <span m='1484170'>understand</span> <span m='1484620'>how</span> <span m='1484770'>to</span>
  <span m='1484890'>convert</span> <span m='1485580'>a</span> <span m='1485700'>bit</span>
  <span m='1485850'>string</span> <span m='1486210'>into</span> <span m='1486420'>this</span>
  <span m='1486570'>picture.</span> <span m='1487030'>This</span> <span m='1487110'>is</span>
  <span m='1487230'>what</span> <span m='1487380'>we</span> <span m='1487500'>call</span>
  <span m='1487740'>a</span> <span m='1487830'>binary</span> <span m='1488370'>trie.</span>
  </p><p><span m='1489750'>I</span> <span m='1489900'>want</span> <span m='1490080'>to</span>
  <span m='1490140'>do</span> <span m='1490260'>the</span> <span m='1490380'>same</span>
  <span m='1490680'>thing</span> <span m='1490890'>over</span> <span m='1491130'>here,</span>
  <span m='1491560'>except</span> <span m='1491820'>it's</span> <span m='1491910'>not</span>
  <span m='1492120'>a</span> <span m='1492180'>binary</span> <span m='1492630'>trie.</span>
  <span m='1493350'>Now</span> <span m='1493620'>each</span> <span m='1493860'>digit</span>
  <span m='1494670'>is</span> <span m='1494940'>giant</span> <span m='1495670'>so</span>
  <span m='1495920'>we're</span> <span m='1496020'>going</span> <span m='1496140'>to</span>
  <span m='1496200'>have</span> <span m='1496320'>some</span> <span m='1496530'>huge</span>
  <span m='1496860'>branching</span> <span m='1497250'>factor.</span> <span m='1498570'>So</span>
  <span m='1498810'>it's</span> <span m='1498960'>going</span> <span m='1499080'>to</span>
  <span m='1499170'>be</span> <span m='1499290'>more</span> <span m='1499470'>like</span>
  <span m='1499620'>a</span> <span m='1499750'>b-tree.</span> <span m='1500610'>The</span>
  <span m='1500790'>first</span> <span m='1501120'>node</span> <span m='1501360'>has</span>
  <span m='1502320'>a</span> <span m='1502380'>whole</span> <span m='1502590'>bunch</span>
  <span m='1502830'>of</span> <span m='1502890'>children.</span> </p><p><span m='1503280'>I'm</span>
  <span m='1503340'>not</span> <span m='1503490'>going</span> <span m='1503610'>to</span>
  <span m='1503970'>even--</span> <span m='1504540'>I</span> <span m='1504600'>mean,</span>
  <span m='1504810'>it's</span> <span m='1505500'>2</span> <span m='1505770'>to</span>
  <span m='1505930'>the</span> <span m='1506330'>w</span> <span m='1506670'>divided</span>
  <span m='1507030'>by</span> <span m='1508820'>log</span> <span m='1509260'>to</span>
  <span m='1509370'>the</span> <span m='1509460'>epsilon</span> <span m='1509910'>n.</span>
  <span m='1511060'>That's</span> <span m='1511260'>the</span> <span m='1511350'>branching</span>
  <span m='1511710'>factor.</span> <span m='1513440'>OK,</span> <span m='1513760'>it's</span>
  <span m='1513930'>big.</span> <span m='1515430'>That's</span> <span m='1515640'>the</span>
  <span m='1515700'>number</span> <span m='1515940'>of</span> <span m='1516030'>possible</span>
  <span m='1516420'>values</span> <span m='1516840'>in</span> <span m='1516960'>the</span>
  <span m='1517050'>first</span> <span m='1517500'>digit.</span> </p><p><span m='1519570'>OK.</span>
  <span m='1520860'>So</span> <span m='1521400'>then</span> <span m='1522240'>maybe</span>
  <span m='1522570'>this</span> <span m='1522810'>child</span> <span m='1523980'>has</span>
  <span m='1524250'>some</span> <span m='1525190'>node</span> <span m='1526290'>there.</span>
  <span m='1527190'>And</span> <span m='1527550'>maybe</span> <span m='1528750'>this</span>
  <span m='1528960'>one.</span> <span m='1534130'>Actually,</span> <span m='1534520'>sorry,</span>
  <span m='1534910'>I</span> <span m='1535060'>didn't</span> <span m='1535190'>want
  to</span> <span m='1535280'>draw</span> <span m='1535510'>it that</span> <span m='1535710'>way.</span>
  <span m='1537205'>I</span> <span m='1537630'>have a</span> <span m='1537820'>specific</span>
  <span m='1538560'>trie</span> <span m='1538890'>in</span> <span m='1539010'>mind,</span>
  <span m='1539740'>or</span> <span m='1539910'>part</span> <span m='1540180'>of</span>
  <span m='1540270'>it.</span> </p><p><span m='1549200'>OK,</span> <span m='1549570'>I</span>
  <span m='1549630'>mean,</span> <span m='1550130'>trie is</span> <span m='1550510'>going
  to</span> <span m='1550550'>look</span> <span m='1550700'>something</span> <span
  m='1550980'>like</span> <span m='1551160'>this.</span> <span m='1552545'>It's</span>
  <span m='1552990'>harder</span> <span m='1553200'>to</span> <span m='1553320'>draw,</span>
  <span m='1553740'>but</span> <span m='1553920'>it's</span> <span m='1554100'>the</span>
  <span m='1554910'>larger</span> <span m='1555300'>than</span> <span m='1555450'>binary</span>
  <span m='1555780'>equivalent</span> <span m='1556170'>of</span> <span m='1556260'>this</span>
  <span m='1556440'>picture.</span> <span m='1557570'>This</span> <span m='1557790'>would</span>
  <span m='1557910'>be</span> <span m='1558530'>a</span> <span m='1558760'>trie.</span>
  </p><p><span m='1561370'>So</span> <span m='1561390'>let's</span> <span m='1561630'>think</span>
  <span m='1561840'>about</span> <span m='1562440'>a</span> <span m='1562530'>particular</span>
  <span m='1563070'>situation.</span> <span m='1563730'>Which</span> <span m='1563970'>is,</span>
  <span m='1565020'>suppose</span> <span m='1565500'>we</span> <span m='1565590'>just</span>
  <span m='1565770'>have</span> <span m='1565950'>two</span> <span m='1567000'>items</span>
  <span m='1567540'>in</span> <span m='1567720'>this</span> <span m='1567900'>structure.</span>
  <span m='1568780'>Then</span> <span m='1568980'>it's</span> <span m='1569250'>easier</span>
  <span m='1569550'>to</span> <span m='1569640'>draw.</span> <span m='1570310'>So</span>
  <span m='1570330'>let's</span> <span m='1570480'>suppose</span> <span m='1570840'>there's</span>
  <span m='1570960'>some</span> <span m='1571290'>item</span> <span m='1571620'>over</span>
  <span m='1571830'>here,</span> <span m='1572580'>x1.</span> <span m='1574350'>There's</span>
  <span m='1574470'>some</span> <span m='1574680'>item</span> <span m='1575370'>over</span>
  <span m='1575610'>here,</span> <span m='1575820'>x2.</span> </p><p><span m='1576510'>Now,</span>
  <span m='1576810'>generic</span> <span m='1577190'>picture</span> <span m='1577540'>is</span>
  <span m='1577960'>they</span> <span m='1578130'>share</span> <span m='1578400'>some</span>
  <span m='1578640'>common</span> <span m='1578940'>prefix.</span> <span m='1579480'>This</span>
  <span m='1579630'>is</span> <span m='1579780'>the</span> <span m='1579900'>common</span>
  <span m='1580200'>prefix.</span> <span m='1584110'>It's</span> <span m='1584390'>just</span>
  <span m='1584610'>to</span> <span m='1584790'>understand</span> <span m='1585240'>some</span>
  <span m='1585600'>particular</span> <span m='1586080'>picture</span> <span m='1586350'>here.</span>
  <span m='1586920'>Then</span> <span m='1587040'>they</span> <span m='1587160'>diverge,</span>
  <span m='1587700'>and</span> <span m='1587800'>you</span> <span m='1587850'>know,</span>
  <span m='1587940'>then</span> <span m='1588090'>they</span> <span m='1588180'>have</span>
  <span m='1588390'>their</span> <span m='1588570'>own</span> <span m='1588750'>digit</span>
  <span m='1589050'>values.</span> <span m='1590130'>In</span> <span m='1590220'>some</span>
  <span m='1590370'>sense,</span> <span m='1590710'>this</span> <span m='1590790'>is</span>
  <span m='1590910'>the</span> <span m='1591030'>digit</span> <span m='1591300'>value</span>
  <span m='1591660'>we</span> <span m='1591780'>care</span> <span m='1591960'>about</span>
  <span m='1592200'>because</span> <span m='1592380'>it</span> <span m='1592470'>distinguishes</span>
  <span m='1593070'>them.</span> </p><p><span m='1594450'>So</span> <span m='1594750'>there's</span>
  <span m='1594930'>this</span> <span m='1595080'>idea</span> <span m='1595440'>of</span>
  <span m='1595650'>a</span> <span m='1595710'>compressed</span> <span m='1596160'>trie,</span>
  <span m='1599310'>which</span> <span m='1599550'>cleans</span> <span m='1599850'>up</span>
  <span m='1600030'>this</span> <span m='1600210'>picture</span> <span m='1600600'>a</span>
  <span m='1600660'>little</span> <span m='1600900'>bit.</span> <span m='1604990'>The</span>
  <span m='1605080'>idea</span> <span m='1605300'>with</span> <span m='1605380'>the</span>
  <span m='1605470'>compress</span> <span m='1605820'>trie</span> <span m='1606040'>is
  very</span> <span m='1606190'>simple.</span> <span m='1606730'>You</span> <span
  m='1606850'>draw</span> <span m='1607090'>this</span> <span m='1607270'>trie.</span>
  <span m='1608050'>So</span> <span m='1608440'>here,</span> <span m='1609390'>imagine</span>
  <span m='1609940'>I'm</span> <span m='1610210'>erasing</span> <span m='1610960'>all</span>
  <span m='1611140'>the</span> <span m='1611230'>things</span> <span m='1611530'>that</span>
  <span m='1611620'>do</span> <span m='1611770'>not</span> <span m='1611980'>appear.</span>
  <span m='1613350'>Maybe</span> <span m='1613720'>all</span> <span m='1613930'>this</span>
  <span m='1614110'>is</span> <span m='1614230'>gone.</span> <span m='1615220'>So
  I'm</span> <span m='1615370'>just</span> <span m='1615610'>keeping</span> <span
  m='1616600'>this</span> <span m='1616810'>part</span> <span m='1617050'>of</span>
  <span m='1617110'>the</span> <span m='1617170'>structure.</span> </p><p><span m='1617530'>Let's</span>
  <span m='1617610'>do</span> <span m='1617830'>it for</span> <span m='1617980'>the</span>
  <span m='1618070'>binary</span> <span m='1618430'>case</span> <span m='1618700'>first.</span>
  <span m='1620140'>The</span> <span m='1620230'>idea</span> <span m='1620410'>in</span>
  <span m='1620490'>a</span> <span m='1620590'>compress</span> <span m='1620980'>trie</span>
  <span m='1621160'>is</span> <span m='1621280'>very</span> <span m='1621430'>simple.</span>
  <span m='1622790'>I'm</span> <span m='1622900'>going</span> <span m='1623200'>to</span>
  <span m='1623860'>contract</span> <span m='1627280'>every</span> <span m='1627640'>non-branching</span>
  <span m='1628420'>node</span> <span m='1630640'>into</span> <span m='1630910'>its</span>
  <span m='1631030'>parent.</span> </p><p><span m='1641930'>So</span> <span m='1642100'>what</span>
  <span m='1642280'>that</span> <span m='1642460'>means.</span> <span m='1643340'>So</span>
  <span m='1643420'>here</span> <span m='1643750'>I'm</span> <span m='1643960'>storing</span>
  <span m='1644440'>three</span> <span m='1644680'>values:</span> <span m='1645490'>0,</span>
  <span m='1645850'>0,</span> <span m='1646270'>1,</span> <span m='1646630'>1;</span>
  <span m='1648040'>0,</span> <span m='1648540'>1,</span> <span m='1648950'>0,</span>
  <span m='1649394'>0;</span> <span m='1650282'>and</span> <span m='1650726'>0,</span>
  <span m='1651170'>1,</span> <span m='1651480'>1,</span> <span m='1651860'>1.</span>
  <span m='1654370'>So</span> <span m='1654970'>some</span> <span m='1655240'>nodes</span>
  <span m='1655540'>are</span> <span m='1655660'>non-branching,</span> <span m='1656460'>that's</span>
  <span m='1656680'>this</span> <span m='1656980'>node,</span> <span m='1658030'>this</span>
  <span m='1658240'>node,</span> <span m='1659080'>and</span> <span m='1659200'>this</span>
  <span m='1659440'>node.</span> <span m='1659740'>And</span> <span m='1659830'>the</span>
  <span m='1659920'>point</span> <span m='1660100'>is</span> <span m='1660220'>well,</span>
  <span m='1660370'>why</span> <span m='1660610'>store</span> <span m='1660910'>those</span>
  <span m='1661180'>nodes?</span> <span m='1661480'>I</span> <span m='1661540'>mean,</span>
  <span m='1661760'>there</span> <span m='1661860'>was</span> <span m='1661870'>nothing</span>
  <span m='1662350'>being</span> <span m='1662560'>distinguished</span> <span m='1663070'>at</span>
  <span m='1663160'>that</span> <span m='1663340'>node,</span> <span m='1663640'>so</span>
  <span m='1663910'>contract</span> <span m='1664450'>it.</span> </p><p><span m='1665380'>So</span>
  <span m='1665620'>the</span> <span m='1665740'>new</span> <span m='1665890'>picture</span>
  <span m='1666250'>if</span> <span m='1666370'>I</span> <span m='1666460'>redrew</span>
  <span m='1666850'>this</span> <span m='1667090'>would</span> <span m='1667240'>be</span>
  <span m='1668100'>0,</span> <span m='1669600'>0,</span> <span m='1669940'>1--</span>
  <span m='1672510'>sorry,</span> <span m='1672870'>also</span> <span m='1673030'>this</span>
  <span m='1673210'>is</span> <span m='1673300'>non-branching.</span> <span m='1675010'>So</span>
  <span m='1675190'>in</span> <span m='1675280'>fact,</span> <span m='1676030'>I'm</span>
  <span m='1676180'>going</span> <span m='1676420'>to</span> <span m='1676540'>contract</span>
  <span m='1678400'>this</span> <span m='1678640'>into</span> <span m='1678820'>its</span>
  <span m='1678940'>parent,</span> <span m='1679280'>this</span> <span m='1679550'>into</span>
  <span m='1679600'>its</span> <span m='1679720'>parent.</span> <span m='1680120'>So</span>
  <span m='1680170'>this</span> <span m='1680350'>whole</span> <span m='1680500'>path,</span>
  <span m='1680980'>this</span> <span m='1681130'>non-branching</span> <span m='1681610'>path</span>
  <span m='1681950'>will</span> <span m='1682000'>be</span> <span m='1682120'>left</span>
  <span m='1682360'>with</span> <span m='1682960'>a</span> <span m='1683020'>single</span>
  <span m='1683380'>edge</span> <span m='1683650'>which</span> <span m='1683830'>I</span>
  <span m='1683950'>will</span> <span m='1684040'>label</span> <span m='1684430'>0,</span>
  <span m='1684790'>1,</span> <span m='1685000'>1.</span> </p><p><span m='1686140'>But</span>
  <span m='1686290'>it's</span> <span m='1686410'>a</span> <span m='1686470'>single</span>
  <span m='1686830'>edge</span> <span m='1687160'>in</span> <span m='1687260'>this</span>
  <span m='1687360'>structure.</span> <span m='1688570'>Over</span> <span m='1688780'>here</span>
  <span m='1688990'>we</span> <span m='1689110'>have</span> <span m='1689740'>an</span>
  <span m='1689950'>edge</span> <span m='1690180'>1,</span> <span m='1691090'>and</span>
  <span m='1691210'>now</span> <span m='1691420'>we</span> <span m='1691540'>have</span>
  <span m='1691960'>0,</span> <span m='1692275'>0</span> <span m='1692860'>here,</span>
  <span m='1694090'>and</span> <span m='1694420'>1,</span> <span m='1694900'>1</span>
  <span m='1695620'>here.</span> <span m='1696640'>That</span> <span m='1696820'>is</span>
  <span m='1696940'>the</span> <span m='1697060'>compressed</span> <span m='1697600'>trie</span>
  <span m='1697930'>representation</span> <span m='1698650'>of</span> <span m='1698740'>these</span>
  <span m='1698920'>three</span> <span m='1699070'>values.</span> </p><p><span m='1700660'>The</span>
  <span m='1700780'>nice</span> <span m='1701020'>thing</span> <span m='1701200'>about</span>
  <span m='1701470'>this</span> <span m='1701620'>structure</span> <span m='1702610'>is</span>
  <span m='1703540'>every</span> <span m='1703780'>node</span> <span m='1703990'>is</span>
  <span m='1704080'>branching</span> <span m='1704550'>except</span> <span m='1704800'>the</span>
  <span m='1704890'>leaves,</span> <span m='1705400'>which</span> <span m='1705580'>means</span>
  <span m='1705880'>the</span> <span m='1706000'>number</span> <span m='1706270'>of</span>
  <span m='1706360'>nodes</span> <span m='1706660'>here</span> <span m='1706870'>is</span>
  <span m='1707050'>linear</span> <span m='1707410'>in</span> <span m='1707470'>the</span>
  <span m='1707560'>number</span> <span m='1707830'>of</span> <span m='1707920'>leaves.</span>
  <span m='1709230'>That's</span> <span m='1709390'>like</span> <span m='1709540'>twice</span>
  <span m='1709930'>the</span> <span m='1709990'>number</span> <span m='1710170'>of</span>
  <span m='1710260'>leaves</span> <span m='1710500'>minus</span> <span m='1710800'>1,</span>
  <span m='1712040'>roughly.</span> <span m='1712960'>I</span> <span m='1713020'>guess</span>
  <span m='1713260'>the</span> <span m='1713380'>root</span> <span m='1713590'>might</span>
  <span m='1713740'>not</span> <span m='1713920'>be</span> <span m='1714070'>branching.</span>
  <span m='1715930'>It</span> <span m='1716020'>has</span> <span m='1716170'>no</span>
  <span m='1716290'>parent</span> <span m='1716620'>to</span> <span m='1716740'>contract</span>
  <span m='1717130'>into.</span> <span m='1717510'>Whatever.</span> </p><p><span m='1718660'>But</span>
  <span m='1718780'>more</span> <span m='1718930'>and</span> <span m='1719020'>more</span>
  <span m='1719170'>nodes,</span> <span m='1719680'>most</span> <span m='1719980'>2n</span>
  <span m='1720310'>nodes.</span> <span m='1721630'>That's</span> <span m='1721810'>the</span>
  <span m='1721930'>binary</span> <span m='1722290'>case.</span> <span m='1722570'>Now</span>
  <span m='1722740'>over</span> <span m='1722920'>here</span> <span m='1723650'>what</span>
  <span m='1723850'>we</span> <span m='1723970'>do</span> <span m='1724690'>is</span>
  <span m='1725620'>in</span> <span m='1725920'>the</span> <span m='1726010'>corresponding</span>
  <span m='1726520'>contracted</span> <span m='1727010'>try</span> <span m='1727190'>a</span>
  <span m='1727270'>picture</span> <span m='1727570'>of</span> <span m='1727660'>this</span>
  <span m='1727870'>thing.</span> <span m='1729180'>Let's</span> <span m='1729300'>see,</span>
  <span m='1729530'>it's a</span> <span m='1730020'>second</span> <span m='1730285'>edge.</span>
  <span m='1730915'>I'm</span> <span m='1731280'>going</span> <span m='1731600'>to</span>
  <span m='1731680'>put</span> <span m='1731910'>just</span> <span m='1732120'>a</span>
  <span m='1732190'>label</span> <span m='1732490'>of</span> <span m='1732610'>2</span>
  <span m='1732910'>on</span> <span m='1733030'>this</span> <span m='1733240'>edge</span>
  <span m='1733450'>to</span> <span m='1733600'>say,</span> <span m='1733890'>well,</span>
  <span m='1733990'>I'm</span> <span m='1734020'>skipping</span> <span m='1734560'>this</span>
  <span m='1734740'>node.</span> <span m='1734950'>This</span> <span m='1735130'>guy</span>
  <span m='1735370'>is</span> <span m='1735490'>non-branching.</span> </p><p><span
  m='1736210'>So</span> <span m='1736300'>I</span> <span m='1736330'>want</span> <span
  m='1736450'>to</span> <span m='1736540'>get</span> <span m='1736690'>rid</span>
  <span m='1736870'>of</span> <span m='1737020'>it</span> <span m='1737650'>and</span>
  <span m='1737860'>contract</span> <span m='1738290'>it</span> <span m='1738390'>into</span>
  <span m='1738520'>the</span> <span m='1738640'>parent.</span> <span m='1739840'>So</span>
  <span m='1740020'>now</span> <span m='1740260'>this</span> <span m='1740410'>corresponds</span>
  <span m='1740950'>to</span> <span m='1741070'>two</span> <span m='1742000'>edges</span>
  <span m='1742330'>here.</span> <span m='1742510'>There</span> <span m='1742630'>are</span>
  <span m='1742660'>two</span> <span m='1742870'>digits,</span> <span m='1743470'>which</span>
  <span m='1744010'>I</span> <span m='1744100'>could</span> <span m='1744250'>write</span>
  <span m='1744430'>the</span> <span m='1744520'>digits</span> <span m='1744820'>if</span>
  <span m='1744970'>I</span> <span m='1745030'>knew</span> <span m='1745180'>what</span>
  <span m='1745270'>they</span> <span m='1745420'>were.</span> <span m='1745690'>But</span>
  <span m='1746410'>particularly</span> <span m='1746740'>I</span> <span m='1746770'>want</span>
  <span m='1746920'>to</span> <span m='1746980'>keep</span> <span m='1747130'>track</span>
  <span m='1747340'>of</span> <span m='1747400'>the</span> <span m='1747490'>fact</span>
  <span m='1747700'>that</span> <span m='1747790'>there</span> <span m='1747910'>exactly</span>
  <span m='1748330'>two</span> <span m='1748510'>of</span> <span m='1748600'>them.</span>
  </p><p><span m='1751100'>And</span> <span m='1751150'>then</span> <span m='1751980'>there's</span>
  <span m='1752130'>a</span> <span m='1752200'>branching</span> <span m='1752610'>node.</span>
  <span m='1752740'>That</span> <span m='1752920'>one</span> <span m='1753070'>stays.</span>
  <span m='1754450'>But</span> <span m='1754600'>then</span> <span m='1755010'>I</span>
  <span m='1755200'>actually</span> <span m='1755470'>we'll</span> <span m='1755590'>go</span>
  <span m='1755710'>straight</span> <span m='1756040'>to</span> <span m='1756160'>the</span>
  <span m='1756250'>leaves</span> <span m='1756610'>here.</span> <span m='1757040'>This</span>
  <span m='1757250'>will</span> <span m='1757540'>be</span> <span m='1758260'>x1</span>
  <span m='1759700'>and</span> <span m='1759820'>x2.</span> </p><p><span m='1762360'>And</span>
  <span m='1762630'>this</span> <span m='1762810'>will</span> <span m='1762930'>have</span>
  <span m='1763650'>a</span> <span m='1763710'>lot</span> <span m='1763920'>of</span>
  <span m='1764010'>digits.</span> <span m='1766960'>OK,</span> <span m='1767050'>so</span>
  <span m='1767180'>some</span> <span m='1767430'>large</span> <span m='1767760'>number</span>
  <span m='1768510'>written</span> <span m='1768690'>here.</span> <span m='1769000'>So</span>
  <span m='1769080'>that's</span> <span m='1769290'>the</span> <span m='1769380'>idea</span>
  <span m='1769650'>with</span> <span m='1769760'>a</span> <span m='1769830'>compress</span>
  <span m='1770250'>trie.</span> </p><p><span m='1771810'>Now</span> <span m='1771990'>the</span>
  <span m='1772050'>nice</span> <span m='1772260'>thing</span> <span m='1772410'>about</span>
  <span m='1772620'>a</span> <span m='1772650'>compress</span> <span m='1773070'>trie</span>
  <span m='1774030'>is</span> <span m='1774280'>they</span> <span m='1774480'>have</span>
  <span m='1774840'>linear</span> <span m='1775170'>size,</span> <span m='1778830'>number</span>
  <span m='1779040'>of</span> <span m='1779130'>edges</span> <span m='1779400'>and</span>
  <span m='1779520'>vertices</span> <span m='1780000'>is</span> <span m='1780090'>linear</span>
  <span m='1781090'>in</span> <span m='1781320'>the</span> <span m='1781410'>number</span>
  <span m='1781710'>of</span> <span m='1781800'>leaves,</span> <span m='1782220'>which</span>
  <span m='1782430'>is</span> <span m='1782580'>the</span> <span m='1782670'>number</span>
  <span m='1782920'>of</span> <span m='1782970'>values</span> <span m='1783420'>we</span>
  <span m='1783540'>have</span> <span m='1783780'>here.</span> <span m='1785760'>Another</span>
  <span m='1786030'>nice</span> <span m='1786270'>thing</span> <span m='1786450'>about</span>
  <span m='1786750'>compress</span> <span m='1787140'>tries</span> <span m='1787440'>is</span>
  <span m='1787530'>they</span> <span m='1787650'>preserve</span> <span m='1788130'>order.</span>
  <span m='1789060'>So</span> <span m='1789210'>if</span> <span m='1789300'>you</span>
  <span m='1789360'>look</span> <span m='1789570'>at</span> <span m='1789690'>the</span>
  <span m='1789990'>order</span> <span m='1790320'>of</span> <span m='1790440'>the</span>
  <span m='1790530'>leaves</span> <span m='1790830'>down</span> <span m='1791070'>here</span>
  <span m='1792150'>it's</span> <span m='1792300'>the</span> <span m='1792390'>same</span>
  <span m='1792660'>as</span> <span m='1792780'>the</span> <span m='1792870'>order</span>
  <span m='1793110'>of</span> <span m='1793170'>the</span> <span m='1793260'>leaves</span>
  <span m='1793530'>over</span> <span m='1793740'>here.</span> <span m='1794520'>We're</span>
  <span m='1794640'>not</span> <span m='1794820'>really</span> <span m='1795060'>changing</span>
  <span m='1795480'>order,</span> <span m='1795750'>we're</span> <span m='1795870'>just</span>
  <span m='1796590'>making</span> <span m='1796890'>things</span> <span m='1797160'>a</span>
  <span m='1797220'>little</span> <span m='1797400'>shorter</span> <span m='1797790'>to</span>
  <span m='1797940'>write</span> <span m='1798120'>down.</span> </p><p><span m='1799620'>Same</span>
  <span m='1799890'>thing</span> <span m='1800070'>over</span> <span m='1800250'>here.</span>
  <span m='1800820'>I</span> <span m='1800850'>mean,</span> <span m='1801030'>x1</span>
  <span m='1801510'>appears</span> <span m='1801820'>the</span> <span m='1801930'>left</span>
  <span m='1802200'>of</span> <span m='1802320'>x2.</span> <span m='1818130'>Say</span>
  <span m='1818340'>the</span> <span m='1818460'>order</span> <span m='1818670'>of</span>
  <span m='1818730'>the</span> <span m='1818820'>leaves</span> <span m='1819090'>is</span>
  <span m='1819210'>preserved.</span> </p><p><span m='1821190'>The</span> <span m='1821310'>other</span>
  <span m='1821490'>cool</span> <span m='1821700'>thing</span> <span m='1821920'>about</span>
  <span m='1822090'>compress</span> <span m='1822450'>tries</span> <span m='1822700'>is</span>
  <span m='1822810'>you</span> <span m='1822930'>can</span> <span m='1823050'>compute</span>
  <span m='1823410'>them</span> <span m='1823560'>in</span> <span m='1823650'>linear</span>
  <span m='1823950'>time.</span> <span m='1825120'>But</span> <span m='1825630'>let</span>
  <span m='1825810'>me</span> <span m='1825900'>tell</span> <span m='1826050'>you</span>
  <span m='1826170'>why</span> <span m='1826410'>we're</span> <span m='1826530'>drawing</span>
  <span m='1826800'>this</span> <span m='1826950'>picture.</span> <span m='1828360'>We've</span>
  <span m='1828600'>messed</span> <span m='1829080'>up</span> <span m='1829740'>all</span>
  <span m='1829980'>these</span> <span m='1830220'>chunks,</span> <span m='1830550'>all</span>
  <span m='1830740'>these</span> <span m='1830940'>digits.</span> <span m='1832320'>What</span>
  <span m='1832470'>does</span> <span m='1832590'>that</span> <span m='1832740'>correspond</span>
  <span m='1833340'>to</span> <span m='1833490'>in</span> <span m='1833580'>this</span>
  <span m='1833760'>picture?</span> </p><p><span m='1834730'>We've</span> <span m='1835140'>permuted</span>
  <span m='1835830'>all</span> <span m='1836010'>of</span> <span m='1836130'>the</span>
  <span m='1836220'>children</span> <span m='1836940'>in</span> <span m='1837090'>this</span>
  <span m='1837270'>node.</span> <span m='1837690'>We've</span> <span m='1837950'>permuted</span>
  <span m='1838290'>all</span> <span m='1838410'>the</span> <span m='1838500'>children</span>
  <span m='1838830'>in</span> <span m='1838920'>this</span> <span m='1839100'>node,</span>
  <span m='1839560'>permuted</span> <span m='1839910'>all</span> <span m='1840030'>the</span>
  <span m='1840120'>children</span> <span m='1840390'>in</span> <span m='1840450'>this</span>
  <span m='1840630'>node.</span> <span m='1841320'>But</span> <span m='1841560'>otherwise,</span>
  <span m='1842160'>the</span> <span m='1842220'>structure</span> <span m='1842580'>of</span>
  <span m='1842640'>the</span> <span m='1842730'>tree</span> <span m='1842940'>is</span>
  <span m='1843060'>correct.</span> <span m='1844020'>What</span> <span m='1844200'>we</span>
  <span m='1844350'>wanted</span> <span m='1844650'>to</span> <span m='1844800'>do</span>
  <span m='1844950'>was</span> <span m='1845130'>compute--</span> <span m='1846000'>if</span>
  <span m='1846120'>we</span> <span m='1846210'>could</span> <span m='1846330'>compute</span>
  <span m='1846690'>the</span> <span m='1846780'>compress</span> <span m='1847200'>trie</span>
  <span m='1847470'>representation</span> <span m='1848610'>of</span> <span m='1848820'>the</span>
  <span m='1849000'>original</span> <span m='1849600'>values</span> <span m='1851340'>just</span>
  <span m='1851880'>having</span> <span m='1852240'>broken</span> <span m='1852540'>the</span>
  <span m='1852630'>integers</span> <span m='1853020'>into</span> <span m='1853230'>these</span>
  <span m='1853410'>pieces,</span> <span m='1854370'>then</span> <span m='1854730'>if</span>
  <span m='1854880'>we</span> <span m='1854970'>had</span> <span m='1855120'>that</span>
  <span m='1855270'>trie</span> <span m='1855570'>we</span> <span m='1855660'>could</span>
  <span m='1855780'>just</span> <span m='1855930'>do</span> <span m='1856020'>an</span>
  <span m='1856100'>in order</span> <span m='1856410'>traversal,</span> <span m='1856950'>find</span>
  <span m='1857340'>the</span> <span m='1857460'>order</span> <span m='1857730'>of</span>
  <span m='1857820'>the</span> <span m='1857880'>leaves,</span> <span m='1858210'>then</span>
  <span m='1858360'>we'd</span> <span m='1858480'>have</span> <span m='1858630'>the</span>
  <span m='1858740'>sorted</span> <span m='1859080'>order</span> <span m='1859470'>of</span>
  <span m='1859710'>the</span> <span m='1860250'>integers.</span> </p><p><span m='1861720'>Instead</span>
  <span m='1862170'>what</span> <span m='1862320'>we've</span> <span m='1862500'>computed</span>
  <span m='1862950'>is</span> <span m='1864960'>we</span> <span m='1865080'>didn't</span>
  <span m='1865260'>compute</span> <span m='1865590'>the</span> <span m='1865710'>correct</span>
  <span m='1866160'>compress</span> <span m='1866610'>trie.</span> <span m='1866940'>But</span>
  <span m='1867030'>we</span> <span m='1867150'>computed</span> <span m='1867600'>a</span>
  <span m='1867660'>different</span> <span m='1867990'>compress</span> <span m='1868350'>trie</span>
  <span m='1868590'>where</span> <span m='1869100'>every</span> <span m='1869400'>node</span>
  <span m='1869620'>has</span> <span m='1870720'>its</span> <span m='1870900'>children</span>
  <span m='1871330'>permuted.</span> <span m='1872220'>So</span> <span m='1872340'>all</span>
  <span m='1872580'>we</span> <span m='1872700'>need</span> <span m='1872850'>to</span>
  <span m='1872970'>do</span> <span m='1873120'>is</span> <span m='1873210'>put</span>
  <span m='1873390'>the</span> <span m='1873510'>children</span> <span m='1874050'>within</span>
  <span m='1874320'>each</span> <span m='1874530'>node</span> <span m='1875340'>in</span>
  <span m='1875460'>the</span> <span m='1875550'>correct</span> <span m='1875970'>order,</span>
  <span m='1877380'>then</span> <span m='1877660'>we</span> <span m='1877740'>would</span>
  <span m='1877860'>have</span> <span m='1878040'>the</span> <span m='1878130'>correct</span>
  <span m='1878790'>compress</span> <span m='1879200'>trie.</span> <span m='1880220'>OK,</span>
  <span m='1880320'>that's</span> <span m='1880470'>why</span> <span m='1880740'>we're</span>
  <span m='1880860'>doing</span> <span m='1881130'>this.</span> </p><p><span m='1882490'>But</span>
  <span m='1882540'>first,</span> <span m='1882840'>how</span> <span m='1883080'>do</span>
  <span m='1883200'>we</span> <span m='1883380'>compute</span> <span m='1884360'>a</span>
  <span m='1884460'>compress</span> <span m='1884850'>trie</span> <span m='1886140'>in</span>
  <span m='1886510'>linear</span> <span m='1886920'>time?</span> <span m='1892080'>This</span>
  <span m='1892260'>is</span> <span m='1892380'>a</span> <span m='1892440'>simple</span>
  <span m='1892800'>amortization</span> <span m='1893490'>argument.</span> <span m='1909180'>Remember</span>
  <span m='1909430'>what</span> <span m='1909550'>we're</span> <span m='1909670'>given.</span>
  <span m='1913240'>At</span> <span m='1913330'>this</span> <span m='1913510'>point</span>
  <span m='1914320'>we</span> <span m='1914540'>are</span> <span m='1914650'>given</span>
  <span m='1915010'>the</span> <span m='1915100'>leaves</span> <span m='1915820'>in</span>
  <span m='1916000'>sorted</span> <span m='1916390'>order.</span> <span m='1917070'>We've</span>
  <span m='1917230'>just</span> <span m='1917440'>sorted</span> <span m='1917860'>our</span>
  <span m='1918010'>things</span> <span m='1919150'>so</span> <span m='1919290'>all
  I'm</span> <span m='1919480'>trying</span> <span m='1919700'>to</span> <span m='1919780'>do</span>
  <span m='1919870'>is</span> <span m='1919960'>compute</span> <span m='1920320'>the</span>
  <span m='1920440'>trie</span> <span m='1920930'>of</span> <span m='1921130'>the</span>
  <span m='1921250'>stuff</span> <span m='1921580'>above</span> <span m='1922020'>the</span>
  <span m='1922150'>things.</span> </p><p><span m='1922970'>OK,</span> <span m='1923140'>we're</span>
  <span m='1923260'>given</span> <span m='1924100'>the</span> <span m='1924190'>leaves</span>
  <span m='1924430'>of</span> <span m='1924490'>the</span> <span m='1924610'>trie</span>
  <span m='1925600'>in</span> <span m='1926080'>the</span> <span m='1926170'>correct</span>
  <span m='1926470'>order.</span> <span m='1926710'>I</span> <span m='1926740'>just</span>
  <span m='1926890'>need</span> <span m='1927040'>to</span> <span m='1927130'>build</span>
  <span m='1927370'>the</span> <span m='1927490'>compress</span> <span m='1927830'>trie.</span>
  <span m='1928030'>The</span> <span m='1928120'>reason</span> <span m='1928330'>I'm</span>
  <span m='1928390'>building</span> <span m='1928660'>a</span> <span m='1928720'>compress</span>
  <span m='1929050'>trie</span> <span m='1929260'>is so</span> <span m='1929380'>I</span>
  <span m='1929440'>can</span> <span m='1929590'>do</span> <span m='1929680'>it</span>
  <span m='1929730'>in</span> <span m='1929800'>linear</span> <span m='1930070'>time.</span>
  <span m='1930400'>Constructing</span> <span m='1931390'>the</span> <span m='1931930'>uncompressed</span>
  <span m='1932500'>trie</span> <span m='1932770'>would</span> <span m='1932890'>take</span>
  <span m='1933100'>too</span> <span m='1933280'>long.</span> <span m='1935780'>OK,</span>
  <span m='1936520'>so</span> <span m='1936850'>how</span> <span m='1937000'>do</span>
  <span m='1937090'>we</span> <span m='1937210'>do</span> <span m='1937360'>this?</span>
  </p><p><span m='1946150'>We</span> <span m='1946240'>have</span> <span m='1946500'>our</span>
  <span m='1946600'>items</span> <span m='1946990'>xn</span> <span m='1948400'>in</span>
  <span m='1948580'>order.</span> <span m='1954340'>I</span> <span m='1954460'>want</span>
  <span m='1954730'>to</span> <span m='1955030'>just</span> <span m='1955300'>insert</span>
  <span m='1955750'>it</span> <span m='1958690'>into</span> <span m='1959680'>the</span>
  <span m='1959770'>compress</span> <span m='1960160'>trie.</span> <span m='1961570'>So</span>
  <span m='1961840'>I</span> <span m='1961960'>start</span> <span m='1962200'>with</span>
  <span m='1962380'>an</span> <span m='1962470'>empty</span> <span m='1962740'>compress</span>
  <span m='1963100'>trie.</span> <span m='1965080'>First</span> <span m='1965290'>thing</span>
  <span m='1965440'>I</span> <span m='1965530'>do</span> <span m='1965650'>is</span>
  <span m='1965770'>add</span> <span m='1965920'>x1,</span> <span m='1966160'>so</span>
  <span m='1966490'>it's</span> <span m='1966640'>just</span> <span m='1966780'>a</span>
  <span m='1966810'>single</span> <span m='1967150'>leaf.</span> <span m='1967840'>Then</span>
  <span m='1967990'>I</span> <span m='1968080'>add</span> <span m='1968230'>x2</span>
  <span m='1968560'>to</span> <span m='1968650'>the</span> <span m='1968740'>trie,</span>
  <span m='1969280'>x3</span> <span m='1969450'>to the</span> <span m='1969550'>trie.</span>
  </p><p><span m='1970210'>In</span> <span m='1970330'>general,</span> <span m='1971140'>I'll</span>
  <span m='1971280'>have</span> <span m='1971470'>computed--</span> <span m='1973030'>I'm
  going</span> <span m='1973180'>to draw</span> <span m='1973390'>a</span> <span m='1973420'>picture.</span>
  <span m='1974760'>How to</span> <span m='1975080'>draw</span> <span m='1975320'>a</span>
  <span m='1975730'>partial</span> <span m='1976150'>trie,</span> <span m='1976450'>something</span>
  <span m='1976780'>like</span> <span m='1976960'>this.</span> <span m='1978060'>I've</span>
  <span m='1978140'>computed</span> <span m='1978580'>the</span> <span m='1978670'>left</span>
  <span m='1978970'>part</span> <span m='1979240'>of</span> <span m='1979330'>trie</span>
  <span m='1979420'>already.</span> <span m='1980240'>All</span> <span m='1980920'>these</span>
  <span m='1981220'>x1's</span> <span m='1981630'>have</span> <span m='1981790'>been</span>
  <span m='1981940'>done.</span> <span m='1983080'>And</span> <span m='1983200'>now</span>
  <span m='1984310'>I</span> <span m='1984400'>need</span> <span m='1984580'>to</span>
  <span m='1984790'>add</span> <span m='1985060'>on</span> <span m='1985390'>the</span>
  <span m='1985510'>next,</span> <span m='1985780'>say</span> <span m='1986050'>xi</span>
  <span m='1987520'>over</span> <span m='1987670'>here</span> <span m='1988120'>somewhere.</span>
  </p><p><span m='1989930'>So</span> <span m='1989980'>think</span> <span m='1990220'>of</span>
  <span m='1990430'>how</span> <span m='1990700'>that</span> <span m='1990850'>would</span>
  <span m='1991000'>look</span> <span m='1991180'>in</span> <span m='1991270'>the</span>
  <span m='1991360'>trie.</span> <span m='1992860'>It</span> <span m='1993010'>has</span>
  <span m='1993280'>to</span> <span m='1993370'>come</span> <span m='1993700'>off</span>
  <span m='1994000'>of</span> <span m='1994150'>the</span> <span m='1994300'>right</span>
  <span m='1994630'>side,</span> <span m='1996280'>I</span> <span m='1996340'>guess</span>
  <span m='1996600'>what would</span> <span m='1996690'>you</span> <span m='1996790'>call</span>
  <span m='1996940'>this?</span> <span m='1997090'>The</span> <span m='1997210'>right</span>
  <span m='1997480'>spine</span> <span m='1998020'>of</span> <span m='1998140'>the</span>
  <span m='1998260'>tree.</span> <span m='1999550'>Some</span> <span m='2000010'>right</span>
  <span m='2000230'>most</span> <span m='2000580'>node</span> <span m='2001140'>over</span>
  <span m='2001350'>here.</span> <span m='2002310'>We</span> <span m='2002430'>want</span>
  <span m='2002640'>xi</span> <span m='2003000'>to</span> <span m='2003090'>be</span>
  <span m='2003240'>a</span> <span m='2003300'>new</span> <span m='2003930'>to</span>
  <span m='2004080'>the</span> <span m='2004230'>right</span> <span m='2004500'>child.</span>
  </p><p><span m='2007140'>So</span> <span m='2007320'>one</span> <span m='2007500'>possible</span>
  <span m='2007890'>picture</span> <span m='2008280'>is</span> <span m='2010690'>there</span>
  <span m='2010830'>was</span> <span m='2010890'>some</span> <span m='2011100'>node</span>
  <span m='2012390'>which</span> <span m='2012570'>had</span> <span m='2012750'>some</span>
  <span m='2012960'>other</span> <span m='2013200'>children,</span> <span m='2013830'>maybe</span>
  <span m='2014100'>this</span> <span m='2014340'>one</span> <span m='2015030'>had</span>
  <span m='2015310'>xi</span> <span m='2015640'>minus</span> <span m='2015930'>1.</span>
  <span m='2017100'>Maybe</span> <span m='2017400'>xi</span> <span m='2017940'>belongs</span>
  <span m='2018420'>over</span> <span m='2018600'>here.</span> <span m='2019160'>Maybe</span>
  <span m='2019920'>this</span> <span m='2020100'>leads</span> <span m='2020340'>to</span>
  <span m='2020460'>xi</span> <span m='2020990'>in</span> <span m='2021210'>the</span>
  <span m='2021780'>uncompressed</span> <span m='2022960'>trie.</span> <span m='2023700'>This</span>
  <span m='2023850'>could</span> <span m='2024000'>be</span> <span m='2024240'>a</span>
  <span m='2024570'>potential</span> <span m='2024900'>picture.</span> </p><p><span
  m='2026110'>In</span> <span m='2026250'>the</span> <span m='2026340'>compress</span>
  <span m='2026790'>trie</span> <span m='2027480'>this</span> <span m='2027690'>node</span>
  <span m='2028110'>either</span> <span m='2028890'>exists</span> <span m='2029310'>or</span>
  <span m='2029460'>got</span> <span m='2029640'>contracted.</span> <span m='2030960'>If</span>
  <span m='2031110'>it</span> <span m='2031200'>exists</span> <span m='2031680'>maybe</span>
  <span m='2031980'>there</span> <span m='2032140'>was</span> <span m='2032310'>a</span>
  <span m='2032370'>previous</span> <span m='2033450'>xi</span> <span m='2033840'>minus</span>
  <span m='2034860'>2</span> <span m='2035250'>belongs</span> <span m='2035670'>over</span>
  <span m='2035880'>here.</span> <span m='2036640'>So</span> <span m='2036690'>we</span>
  <span m='2036870'>already</span> <span m='2037230'>had</span> <span m='2037470'>this</span>
  <span m='2037620'>node</span> <span m='2037820'>because</span> <span m='2038100'>it</span>
  <span m='2038160'>distinguished</span> <span m='2038670'>these</span> <span m='2038880'>two</span>
  <span m='2039700'>xj's.</span> <span m='2041410'>To</span> <span m='2041580'>add</span>
  <span m='2041820'>the</span> <span m='2041880'>xi</span> <span m='2042135'>is</span>
  <span m='2042390'>really</span> <span m='2042600'>easy.</span> <span m='2043000'>I</span>
  <span m='2043100'>just</span> <span m='2043320'>add</span> <span m='2043530'>a</span>
  <span m='2043590'>node</span> <span m='2043830'>here</span> <span m='2044370'>and</span>
  <span m='2044520'>then</span> <span m='2044820'>which</span> <span m='2044970'>points</span>
  <span m='2045210'>to</span> <span m='2045330'>a</span> <span m='2045360'>leaf</span>
  <span m='2046220'>of</span> <span m='2046430'>xi.</span> <span m='2047820'>So</span>
  <span m='2047940'>that</span> <span m='2048060'>could</span> <span m='2048210'>be</span>
  <span m='2048330'>one</span> <span m='2048510'>situation.</span> </p><p><span m='2050760'>The</span>
  <span m='2050940'>other</span> <span m='2051090'>situation</span> <span m='2051560'>is</span>
  <span m='2051639'>only</span> <span m='2051780'>slightly</span> <span m='2052139'>more</span>
  <span m='2052290'>complicated.</span> <span m='2061980'>So</span> <span m='2063000'>the</span>
  <span m='2063120'>other</span> <span m='2063300'>possibility</span> <span m='2064080'>is</span>
  <span m='2065190'>this</span> <span m='2065340'>node</span> <span m='2065550'>didn't</span>
  <span m='2065909'>exist</span> <span m='2066270'>in</span> <span m='2066360'>the</span>
  <span m='2066449'>compressed</span> <span m='2066840'>trie,</span> <span m='2067130'>which</span>
  <span m='2067320'>means</span> <span m='2068219'>we</span> <span m='2068370'>jumped</span>
  <span m='2068730'>over</span> <span m='2069060'>it</span> <span m='2070199'>in</span>
  <span m='2070320'>the</span> <span m='2070380'>compress</span> <span m='2070800'>trie.</span>
  <span m='2072909'>Some</span> <span m='2073320'>number</span> <span m='2073590'>bigger</span>
  <span m='2073860'>than</span> <span m='2074010'>1</span> <span m='2074250'>here,</span>
  <span m='2074460'>maybe</span> <span m='2075130'>you</span> <span m='2075210'>skipped</span>
  <span m='2075510'>three</span> <span m='2076230'>nodes,</span> <span m='2076560'>who</span>
  <span m='2076650'>knows.</span> </p><p><span m='2079120'>So</span> <span m='2079170'>now</span>
  <span m='2079530'>this</span> <span m='2079739'>node</span> <span m='2080040'>matters.</span>
  <span m='2080520'>It</span> <span m='2080580'>didn't</span> <span m='2080820'>matter</span>
  <span m='2081090'>before.</span> <span m='2081450'>Before</span> <span m='2081810'>it</span>
  <span m='2081870'>was</span> <span m='2082000'>non-branching,</span> <span m='2082560'>but</span>
  <span m='2082679'>now</span> <span m='2082830'>we</span> <span m='2082969'>add</span>
  <span m='2083100'>xi,</span> <span m='2083540'>it's</span> <span m='2083670'>branching.</span>
  <span m='2084570'>All</span> <span m='2084719'>we</span> <span m='2084870'>do</span>
  <span m='2085110'>is</span> <span m='2086219'>update,</span> <span m='2087350'>add</span>
  <span m='2087600'>this</span> <span m='2087810'>new</span> <span m='2087989'>guy,</span>
  <span m='2088909'>add</span> <span m='2089159'>the</span> <span m='2089280'>new</span>
  <span m='2090330'>pointer</span> <span m='2090750'>to</span> <span m='2090880'>xi.</span>
  <span m='2092389'>OK,</span> <span m='2092550'>so</span> <span m='2092730'>constant</span>
  <span m='2093239'>work.</span> </p><p><span m='2094949'>Great,</span> <span m='2095370'>constant</span>
  <span m='2095820'>work</span> <span m='2096060'>per</span> <span m='2096330'>xi</span>
  <span m='2096659'>inserted,</span> <span m='2097710'>linear</span> <span m='2097950'>time</span>
  <span m='2098190'>overall.</span> <span m='2099780'>Not</span> <span m='2099990'>really.</span>
  <span m='2100920'>I've</span> <span m='2101130'>cheated</span> <span m='2101520'>a</span>
  <span m='2101580'>little</span> <span m='2101820'>bit</span> <span m='2102000'>here,</span>
  <span m='2102370'>which</span> <span m='2102510'>is</span> <span m='2103170'>how</span>
  <span m='2103380'>do</span> <span m='2103500'>we</span> <span m='2103680'>know</span>
  <span m='2104130'>what</span> <span m='2104230'>we're</span> <span m='2104330'>going</span>
  <span m='2104460'>to</span> <span m='2104610'>do</span> <span m='2104820'>this</span>
  <span m='2105030'>operation.</span> <span m='2105780'>So</span> <span m='2105960'>the</span>
  <span m='2106080'>changes</span> <span m='2106620'>we</span> <span m='2106740'>make</span>
  <span m='2107040'>is</span> <span m='2107130'>constant,</span> <span m='2108090'>that's</span>
  <span m='2108300'>fine.</span> <span m='2108930'>But</span> <span m='2109110'>how</span>
  <span m='2109260'>did</span> <span m='2109440'>I</span> <span m='2109530'>find</span>
  <span m='2109980'>that</span> <span m='2110160'>this</span> <span m='2110400'>was</span>
  <span m='2110580'>the</span> <span m='2110730'>edge</span> <span m='2111000'>where</span>
  <span m='2111120'>I</span> <span m='2111180'>need</span> <span m='2111360'>to</span>
  <span m='2111450'>put</span> <span m='2111630'>xi</span> <span m='2111780'>in?</span>
  <span m='2113100'>You</span> <span m='2113190'>can't</span> <span m='2113430'>do</span>
  <span m='2113550'>it</span> <span m='2113610'>in</span> <span m='2113730'>constant</span>
  <span m='2114060'>time,</span> <span m='2114990'>but</span> <span m='2115110'>we</span>
  <span m='2115200'>can</span> <span m='2115320'>do</span> <span m='2115410'>it</span>
  <span m='2115470'>in</span> <span m='2115560'>constant</span> <span m='2115890'>amortized</span>
  <span m='2116370'>time.</span> </p><p><span m='2117840'>So</span> <span m='2118110'>what</span>
  <span m='2118230'>we're</span> <span m='2118320'>going</span> <span m='2118440'>to</span>
  <span m='2118530'>do</span> <span m='2119070'>is</span> <span m='2120600'>start</span>
  <span m='2121020'>at</span> <span m='2121230'>the</span> <span m='2121410'>right</span>
  <span m='2121910'>most--</span> <span m='2122700'>that</span> <span m='2122990'>is</span>
  <span m='2123325'>not</span> <span m='2123660'>very</span> <span m='2123870'>red.</span>
  <span m='2126690'>Not</span> <span m='2126870'>a</span> <span m='2126930'>red</span>
  <span m='2127130'>chalk.</span> <span m='2129965'>Red</span> <span m='2130450'>chalk.</span>
  </p><p><span m='2132210'>We</span> <span m='2132390'>start</span> <span m='2132810'>at
  this</span> <span m='2133020'>leaf,</span> <span m='2133770'>the</span> <span m='2133860'>rightmost</span>
  <span m='2134280'>leaf</span> <span m='2134640'>which</span> <span m='2134940'>you</span>
  <span m='2135060'>go</span> <span m='2135630'>going</span> <span m='2135870'>right</span>
  <span m='2136050'>most</span> <span m='2136290'>as</span> <span m='2136380'>possible.</span>
  <span m='2137380'>We're</span> <span m='2137480'>going</span> <span m='2137490'>to</span>
  <span m='2137580'>walk</span> <span m='2138150'>up</span> <span m='2138420'>the</span>
  <span m='2138540'>tree</span> <span m='2140100'>until</span> <span m='2140460'>we</span>
  <span m='2140580'>find</span> <span m='2140880'>the</span> <span m='2141000'>right</span>
  <span m='2141180'>point.</span> <span m='2142090'>We're</span> <span m='2142260'>going
  to</span> <span m='2142370'>spend</span> <span m='2142610'>linear</span> <span m='2142980'>time</span>
  <span m='2143370'>this</span> <span m='2143630'>path</span> <span m='2143990'>walk.</span>
  <span m='2145340'>OK,</span> <span m='2145740'>how</span> <span m='2146100'>could</span>
  <span m='2146280'>this</span> <span m='2146430'>possibly</span> <span m='2146970'>be</span>
  <span m='2147150'>OK?</span> </p><p><span m='2147720'>I</span> <span m='2147750'>think</span>
  <span m='2147930'>you</span> <span m='2148080'>believe</span> <span m='2148440'>that</span>
  <span m='2148530'>I</span> <span m='2148590'>can</span> <span m='2148740'>do</span>
  <span m='2148890'>it</span> <span m='2148950'>in</span> <span m='2149070'>linear</span>
  <span m='2149340'>time,</span> <span m='2149650'>right.</span> <span m='2149990'>Each</span>
  <span m='2150660'>point</span> <span m='2150900'>I</span> <span m='2150960'>see--</span>
  <span m='2151870'>what</span> <span m='2152130'>is</span> <span m='2152220'>my</span>
  <span m='2152400'>common</span> <span m='2152790'>prefix?</span> <span m='2153660'>Actually</span>
  <span m='2153930'>an</span> <span m='2154020'>easy</span> <span m='2154290'>way</span>
  <span m='2154500'>is</span> <span m='2154650'>right</span> <span m='2154830'>up</span>
  <span m='2154920'>front.</span> <span m='2155470'>This</span> <span m='2156120'>thing</span>
  <span m='2156330'>right</span> <span m='2156480'>here</span> <span m='2156690'>is</span>
  <span m='2156930'>xi</span> <span m='2157260'>minus</span> <span m='2157560'>1.</span>
  <span m='2159510'>These</span> <span m='2159690'>are</span> <span m='2159780'>single</span>
  <span m='2160080'>integers.</span> <span m='2160830'>So</span> <span m='2161730'>I</span>
  <span m='2161850'>can</span> <span m='2162000'>just</span> <span m='2162500'>compute</span>
  <span m='2162880'>their</span> <span m='2162960'>x</span> <span m='2163170'>or,</span>
  <span m='2163710'>find</span> <span m='2164070'>the</span> <span m='2164220'>most</span>
  <span m='2164430'>significant</span> <span m='2164910'>one</span> <span m='2165120'>bit,</span>
  <span m='2165460'>which</span> <span m='2165570'>we</span> <span m='2165690'>did</span>
  <span m='2166100'>with the</span> <span m='2166210'>fusion</span> <span m='2166560'>tree</span>
  <span m='2166710'>lecture.</span> </p><p><span m='2168180'>And</span> <span m='2168690'>boom,</span>
  <span m='2169260'>I</span> <span m='2169410'>know</span> <span m='2169830'>where</span>
  <span m='2170040'>they</span> <span m='2170190'>differ</span> <span m='2170790'>in</span>
  <span m='2171090'>bit</span> <span m='2171360'>position.</span> <span m='2172890'>By</span>
  <span m='2173130'>some</span> <span m='2173400'>rounding</span> <span m='2173940'>I</span>
  <span m='2174000'>can</span> <span m='2174180'>figure</span> <span m='2174450'>out</span>
  <span m='2174630'>which</span> <span m='2175050'>chunk</span> <span m='2175710'>they</span>
  <span m='2175920'>differ</span> <span m='2176250'>in,</span> <span m='2177060'>just</span>
  <span m='2177210'>by</span> <span m='2177720'>dividing,</span> <span m='2179070'>taking</span>
  <span m='2179400'>the</span> <span m='2179460'>ceiling.</span> <span m='2182950'>So</span>
  <span m='2183030'>I</span> <span m='2183120'>know</span> <span m='2184110'>the</span>
  <span m='2184350'>correct</span> <span m='2184860'>depth.</span> <span m='2186180'>And</span>
  <span m='2186360'>then</span> <span m='2186540'>these</span> <span m='2186810'>numbers</span>
  <span m='2187380'>tell</span> <span m='2187620'>me</span> <span m='2188940'>how</span>
  <span m='2189090'>much</span> <span m='2189270'>depth</span> <span m='2189600'>I'm</span>
  <span m='2189780'>losing.</span> </p><p><span m='2190170'>As</span> <span m='2190290'>I</span>
  <span m='2190410'>walk</span> <span m='2190740'>up</span> <span m='2191460'>at</span>
  <span m='2191580'>some</span> <span m='2191760'>point</span> <span m='2191940'>I'll</span>
  <span m='2192000'>discover,</span> <span m='2192480'>oops,</span> <span m='2192840'>I</span>
  <span m='2192960'>just</span> <span m='2193170'>jumped</span> <span m='2193560'>over</span>
  <span m='2193770'>the</span> <span m='2193890'>depth</span> <span m='2194160'>I</span>
  <span m='2194250'>care</span> <span m='2194460'>about</span> <span m='2194700'>where</span>
  <span m='2194820'>they</span> <span m='2194970'>differ.</span> <span m='2196120'>And</span>
  <span m='2196220'>so</span> <span m='2196230'>at</span> <span m='2196320'>that</span>
  <span m='2196500'>point</span> <span m='2196840'>I</span> <span m='2196940'>know</span>
  <span m='2196980'>to</span> <span m='2197100'>do</span> <span m='2197250'>that</span>
  <span m='2197370'>operation.</span> <span m='2198480'>So</span> <span m='2198720'>if</span>
  <span m='2199950'>there</span> <span m='2200100'>are</span> <span m='2200160'>k</span>
  <span m='2201210'>edges</span> <span m='2201540'>here</span> <span m='2201780'>on</span>
  <span m='2201870'>the</span> <span m='2201960'>compress</span> <span m='2202410'>trie,</span>
  <span m='2203280'>I</span> <span m='2203370'>can</span> <span m='2203520'>do</span>
  <span m='2203670'>this</span> <span m='2203910'>in</span> <span m='2204060'>order</span>
  <span m='2204330'>k</span> <span m='2204540'>time,</span> <span m='2205480'>k</span>
  <span m='2205880'>plus</span> <span m='2206130'>1,</span> <span m='2206340'>let's</span>
  <span m='2206750'>say.</span> </p><p><span m='2208390'>Why</span> <span m='2208470'>is</span>
  <span m='2208560'>that</span> <span m='2208790'>OK?</span> <span m='2210090'>Because</span>
  <span m='2212280'>my</span> <span m='2212520'>potential</span> <span m='2212940'>function,</span>
  <span m='2214440'>amortization</span> <span m='2215190'>is</span> <span m='2215340'>going</span>
  <span m='2215580'>to</span> <span m='2215730'>be</span> <span m='2216480'>the</span>
  <span m='2216600'>length</span> <span m='2217826'>of</span> <span m='2218662'>the</span>
  <span m='2222150'>rightmost</span> <span m='2222780'>path.</span> <span m='2226030'>OK,</span>
  <span m='2226240'>before</span> <span m='2227170'>my</span> <span m='2227350'>rightmost</span>
  <span m='2227770'>path</span> <span m='2228190'>was</span> <span m='2228670'>this</span>
  <span m='2228880'>thing.</span> </p><p><span m='2230020'>Afterwards,</span> <span
  m='2230650'>my</span> <span m='2230800'>rightmost</span> <span m='2231190'>path</span>
  <span m='2231490'>is</span> <span m='2231610'>going</span> <span m='2231720'>to</span>
  <span m='2231820'>be</span> <span m='2232150'>this</span> <span m='2232420'>thing.</span>
  <span m='2233350'>So</span> <span m='2233500'>it</span> <span m='2233540'>got</span>
  <span m='2234010'>roughly</span> <span m='2234400'>k</span> <span m='2234670'>shorter,</span>
  <span m='2235060'>k</span> <span m='2235300'>minus 1</span> <span m='2235570'>shorter.</span>
  <span m='2237270'>OK,</span> <span m='2237460'>so</span> <span m='2237580'>I</span>
  <span m='2237640'>charged</span> <span m='2238000'>this</span> <span m='2238120'>k</span>
  <span m='2238300'>plus</span> <span m='2238540'>1</span> <span m='2238720'>cost</span>
  <span m='2239710'>to</span> <span m='2239950'>a</span> <span m='2241030'>potential</span>
  <span m='2241480'>decrease</span> <span m='2243020'>of</span> <span m='2243400'>k</span>
  <span m='2243700'>minus</span> <span m='2243880'>1.</span> <span m='2244850'>And</span>
  <span m='2244960'>so</span> <span m='2245140'>the</span> <span m='2245230'>amortize</span>
  <span m='2245650'>cost</span> <span m='2246010'>is</span> <span m='2246100'>only</span>
  <span m='2246370'>constant.</span> <span m='2248250'>Easy</span> <span m='2248530'>amortization.</span>
  </p><p><span m='2249670'>Another</span> <span m='2250000'>way</span> <span m='2250090'>to</span>
  <span m='2250180'>see</span> <span m='2250390'>this</span> <span m='2250570'>is,</span>
  <span m='2251050'>overall</span> <span m='2251620'>we're</span> <span m='2251770'>basically</span>
  <span m='2252190'>doing</span> <span m='2252400'>it</span> <span m='2252460'>in</span>
  <span m='2252610'>order</span> <span m='2252820'>traversal</span> <span m='2253270'>of</span>
  <span m='2253360'>the</span> <span m='2253450'>tree.</span> <span m='2254050'>So</span>
  <span m='2254170'>whenever</span> <span m='2254380'>we</span> <span m='2254500'>walk</span>
  <span m='2254800'>up</span> <span m='2255010'>we'll</span> <span m='2255160'>never</span>
  <span m='2255460'>visit</span> <span m='2255760'>these</span> <span m='2255940'>nodes</span>
  <span m='2256150'>again,</span> <span m='2257080'>because</span> <span m='2257220'>then</span>
  <span m='2257380'>we</span> <span m='2257470'>go</span> <span m='2257620'>down</span>
  <span m='2257875'>at</span> <span m='2258130'>a</span> <span m='2258280'>different</span>
  <span m='2258610'>place.</span> <span m='2259520'>OK,</span> <span m='2259700'>yeah,</span>
  <span m='2259840'>this</span> <span m='2260020'>guy</span> <span m='2260170'>we're</span>
  <span m='2260260'>going</span> <span m='2260370'>to</span> <span m='2260470'>walk</span>
  <span m='2260710'>up</span> <span m='2260860'>again</span> <span m='2261070'>because</span>
  <span m='2261420'>in</span> <span m='2261610'>an</span> <span m='2261880'>in</span>
  <span m='2262030'>order</span> <span m='2262210'>traversal</span> <span m='2262580'>we</span>
  <span m='2262660'>would</span> <span m='2262770'>have</span> <span m='2262870'>gone</span>
  <span m='2263080'>left</span> <span m='2263380'>and</span> <span m='2263470'>then</span>
  <span m='2263560'>come</span> <span m='2263710'>back</span> <span m='2263950'>to</span>
  <span m='2264100'>it</span> <span m='2264160'>and</span> <span m='2264250'>then</span>
  <span m='2264370'>gone</span> <span m='2264550'>down.</span> <span m='2265270'>So</span>
  <span m='2265390'>overall</span> <span m='2265780'>we're</span> <span m='2265900'>doing</span>
  <span m='2266140'>an</span> <span m='2266230'>in</span> <span m='2266410'>order</span>
  <span m='2266590'>traversal</span> <span m='2267130'>of</span> <span m='2267280'>the</span>
  <span m='2267400'>compress</span> <span m='2267790'>trie,</span> <span m='2268780'>so</span>
  <span m='2269970'>it's</span> <span m='2270190'>linear</span> <span m='2270490'>time</span>
  <span m='2270750'>total.</span> <span m='2276320'>OK.</span> </p><p><span m='2280510'>Still</span>
  <span m='2280750'>not</span> <span m='2280960'>done</span> <span m='2281170'>though.</span>
  <span m='2282090'>What</span> <span m='2282230'>we</span> <span m='2282370'>have</span>
  <span m='2282610'>so</span> <span m='2282790'>far--</span> <span m='2283180'>what</span>
  <span m='2283300'>have</span> <span m='2283390'>we</span> <span m='2283480'>done?</span>
  <span m='2283750'>We've</span> <span m='2283870'>taken</span> <span m='2284230'>our</span>
  <span m='2284320'>numbers,</span> <span m='2284740'>we've</span> <span m='2284860'>split</span>
  <span m='2285040'>them</span> <span m='2285160'>into</span> <span m='2285340'>digits.</span>
  <span m='2286450'>We</span> <span m='2287230'>randomly</span> <span m='2287710'>permuted</span>
  <span m='2288100'>the</span> <span m='2288220'>digits</span> <span m='2288550'>via</span>
  <span m='2288760'>hash</span> <span m='2289090'>function.</span> <span m='2289870'>That</span>
  <span m='2290170'>magically</span> <span m='2290680'>let</span> <span m='2290860'>us</span>
  <span m='2290920'>sort</span> <span m='2291220'>them</span> <span m='2291370'>in</span>
  <span m='2291460'>linear</span> <span m='2291760'>time.</span> <span m='2292660'>Now</span>
  <span m='2292840'>we've</span> <span m='2293050'>built</span> <span m='2293710'>a</span>
  <span m='2293830'>compress</span> <span m='2294310'>trie</span> <span m='2294810'>of</span>
  <span m='2294970'>that</span> <span m='2295150'>representation.</span> </p><p><span
  m='2295900'>The</span> <span m='2295990'>last</span> <span m='2296350'>thing</span>
  <span m='2296530'>to</span> <span m='2296650'>do</span> <span m='2297280'>is</span>
  <span m='2297430'>to</span> <span m='2297580'>fix</span> <span m='2298060'>the</span>
  <span m='2298240'>order</span> <span m='2298570'>of</span> <span m='2298690'>the</span>
  <span m='2298780'>children</span> <span m='2299290'>from</span> <span m='2299560'>each</span>
  <span m='2299830'>node.</span> <span m='2300760'>The</span> <span m='2300880'>tree</span>
  <span m='2301180'>is</span> <span m='2301270'>correct</span> <span m='2301840'>except</span>
  <span m='2302320'>for</span> <span m='2302620'>the</span> <span m='2302770'>order</span>
  <span m='2303130'>of</span> <span m='2303220'>the</span> <span m='2303340'>children</span>
  <span m='2303760'>in</span> <span m='2303840'>each</span> <span m='2304090'>node.</span>
  <span m='2305170'>So</span> <span m='2305350'>we've</span> <span m='2305530'>kind</span>
  <span m='2305890'>of</span> <span m='2305980'>sorted</span> <span m='2306420'>a</span>
  <span m='2306490'>little</span> <span m='2306730'>bit,</span> <span m='2307450'>but</span>
  <span m='2307600'>haven't</span> <span m='2307930'>fully</span> <span m='2308200'>sorted.</span>
  <span m='2310060'>So</span> <span m='2312870'>that's</span> <span m='2313170'>the</span>
  <span m='2313260'>last</span> <span m='2313560'>step.</span> </p><p><span m='2314760'>And</span>
  <span m='2316440'>we're</span> <span m='2316560'>going</span> <span m='2316710'>to</span>
  <span m='2316770'>do</span> <span m='2316950'>that</span> <span m='2318450'>with</span>
  <span m='2318630'>recursion.</span> <span m='2323430'>We're</span> <span m='2323580'>only</span>
  <span m='2323790'>going</span> <span m='2323910'>to</span> <span m='2324000'>recurse</span>
  <span m='2324360'>a</span> <span m='2324480'>constant</span> <span m='2325020'>number</span>
  <span m='2325290'>of</span> <span m='2325380'>times.</span> <span m='2328410'>Recursively</span>
  <span m='2329100'>sort.</span> </p><p><span m='2360970'>OK,</span> <span m='2362130'>I'm</span>
  <span m='2362280'>going</span> <span m='2362520'>to</span> <span m='2362940'>walk</span>
  <span m='2363270'>through</span> <span m='2364260'>this</span> <span m='2364410'>compress</span>
  <span m='2364890'>try</span> <span m='2365220'>trie</span> <span m='2365340'>we've</span>
  <span m='2365490'>built.</span> <span m='2367420'>And</span> <span m='2367780'>I</span>
  <span m='2367840'>guess</span> <span m='2368020'>it</span> <span m='2368080'>looks</span>
  <span m='2368350'>more</span> <span m='2368500'>like</span> <span m='2368680'>this.</span>
  <span m='2369450'>And</span> <span m='2369610'>for</span> <span m='2369730'>each</span>
  <span m='2370060'>edge</span> <span m='2371020'>I'm</span> <span m='2371140'>going</span>
  <span m='2371380'>to</span> <span m='2371470'>write</span> <span m='2371680'>down</span>
  <span m='2372430'>this</span> <span m='2372850'>key.</span> </p><p><span m='2374380'>First</span>
  <span m='2374650'>thing</span> <span m='2374830'>you're</span> <span m='2374890'>going</span>
  <span m='2374970'>to</span> <span m='2375040'>write</span> <span m='2375190'>down</span>
  <span m='2375460'>is</span> <span m='2375670'>the</span> <span m='2375850'>ID</span>
  <span m='2376210'>of</span> <span m='2376330'>the</span> <span m='2376420'>node.</span>
  <span m='2376720'>Let's</span> <span m='2376930'>say</span> <span m='2377590'>the</span>
  <span m='2377770'>ID</span> <span m='2378070'>is</span> <span m='2378190'>the</span>
  <span m='2378330'>in</span> <span m='2378490'>order</span> <span m='2378700'>traversal</span>
  <span m='2379420'>index</span> <span m='2379960'>of</span> <span m='2380170'>the</span>
  <span m='2380260'>node.</span> <span m='2382260'>OK,</span> <span m='2382630'>so</span>
  <span m='2383080'>boom.</span> <span m='2383380'>As</span> <span m='2383590'>we</span>
  <span m='2383740'>traverse</span> <span m='2384100'>the</span> <span m='2384190'>tree</span>
  <span m='2384460'>we</span> <span m='2384550'>can</span> <span m='2384700'>just</span>
  <span m='2384850'>increment</span> <span m='2385270'>this</span> <span m='2385420'>counter.</span>
  </p><p><span m='2387910'>Then</span> <span m='2388360'>we</span> <span m='2388690'>also</span>
  <span m='2389080'>want--</span> <span m='2391390'>what</span> <span m='2391570'>I'm</span>
  <span m='2391630'>going</span> <span m='2391750'>to</span> <span m='2391840'>put</span>
  <span m='2392110'>in</span> <span m='2392260'>here</span> <span m='2392560'>is</span>
  <span m='2392770'>the</span> <span m='2393040'>actual</span> <span m='2393700'>chunk</span>
  <span m='2394120'>value</span> <span m='2397960'>that's</span> <span m='2398200'>at</span>
  <span m='2398320'>the</span> <span m='2398410'>top</span> <span m='2398770'>of</span>
  <span m='2398830'>the</span> <span m='2398920'>node.</span> <span m='2399940'>So</span>
  <span m='2400090'>something</span> <span m='2400810'>like</span> <span m='2400990'>this,</span>
  <span m='2401230'>or</span> <span m='2401520'>I</span> <span m='2401660'>guess</span>
  <span m='2401860'>this</span> <span m='2402040'>one.</span> <span m='2402700'>This</span>
  <span m='2402880'>one</span> <span m='2403030'>consists</span> <span m='2403420'>of</span>
  <span m='2403540'>two</span> <span m='2403780'>chunk</span> <span m='2404080'>values.</span>
  <span m='2405400'>So</span> <span m='2405600'>it's</span> <span m='2405840'>called</span>
  <span m='2406150'>c1,</span> <span m='2407350'>for</span> <span m='2407800'>chunk</span>
  <span m='2408250'>values,</span> <span m='2408770'>c1</span> <span m='2409090'>and</span>
  <span m='2409210'>c2.</span> </p><p><span m='2409660'>It's</span> <span m='2409870'>the</span>
  <span m='2409930'>first</span> <span m='2410190'>chunk</span> <span m='2410420'>value</span>
  <span m='2410650'>and</span> <span m='2410770'>the</span> <span m='2410830'>second</span>
  <span m='2411130'>chunk</span> <span m='2411310'>value,</span> <span m='2411580'>first</span>
  <span m='2411820'>digit</span> <span m='2412150'>and</span> <span m='2412240'>the</span>
  <span m='2412330'>second</span> <span m='2412600'>digit.</span> <span m='2413590'>Just</span>
  <span m='2413740'>write</span> <span m='2413920'>down</span> <span m='2414100'>the</span>
  <span m='2414190'>first</span> <span m='2414490'>one.</span> <span m='2418300'>That's</span>
  <span m='2418540'>really</span> <span m='2418750'>the</span> <span m='2418900'>only</span>
  <span m='2419110'>one</span> <span m='2419260'>we</span> <span m='2419350'>care</span>
  <span m='2419560'>about.</span> <span m='2419770'>The</span> <span m='2419860'>second</span>
  <span m='2420100'>one</span> <span m='2420280'>wasn't</span> <span m='2420490'>branching</span>
  <span m='2421030'>so</span> <span m='2421210'>it's</span> <span m='2421300'>no</span>
  <span m='2421450'>big</span> <span m='2421600'>deal.</span> </p><p><span m='2424440'>OK,</span>
  <span m='2424710'>so</span> <span m='2425100'>there's</span> <span m='2425280'>some</span>
  <span m='2425660'>chunk</span> <span m='2425910'>value.</span> <span m='2426240'>Now,</span>
  <span m='2426420'>I</span> <span m='2426510'>don't</span> <span m='2426810'>want</span>
  <span m='2426990'>to</span> <span m='2427080'>write</span> <span m='2427320'>down</span>
  <span m='2428250'>the</span> <span m='2428580'>signature</span> <span m='2429370'>chunk</span>
  <span m='2429690'>value.</span> <span m='2430380'>I</span> <span m='2430470'>don't</span>
  <span m='2430710'>want</span> <span m='2430860'>to</span> <span m='2431190'>write</span>
  <span m='2431370'>down</span> <span m='2431550'>the</span> <span m='2431610'>hash</span>
  <span m='2431880'>value.</span> <span m='2432180'>I</span> <span m='2432270'>want</span>
  <span m='2432450'>the</span> <span m='2432690'>actual</span> <span m='2433290'>chunk,</span>
  <span m='2434850'>original</span> <span m='2435300'>chunk</span> <span m='2435630'>not</span>
  <span m='2435900'>the</span> <span m='2435990'>hash.</span> <span m='2437040'>That's</span>
  <span m='2437190'>why</span> <span m='2437250'>I</span> <span m='2437310'>write</span>
  <span m='2437520'>actual</span> <span m='2438960'>over</span> <span m='2439170'>here</span>
  <span m='2439590'>and</span> <span m='2439680'>then</span> <span m='2439890'>also,</span>
  <span m='2440280'>I'm going</span> <span m='2440400'>to</span> <span m='2440490'>write</span>
  <span m='2440700'>down</span> <span m='2441480'>the</span> <span m='2441630'>index</span>
  <span m='2442110'>of</span> <span m='2442200'>the</span> <span m='2442350'>edge.</span>
  <span m='2442780'>So this</span> <span m='2443010'>is</span> <span m='2443160'>the</span>
  <span m='2443310'>second</span> <span m='2443760'>edge,</span> <span m='2444180'>for</span>
  <span m='2444270'>example.</span> </p><p><span m='2446240'>OK,</span> <span m='2446880'>now</span>
  <span m='2447060'>this</span> <span m='2447270'>is</span> <span m='2447450'>in</span>
  <span m='2447540'>some</span> <span m='2447750'>sense</span> <span m='2448020'>the</span>
  <span m='2448140'>wrong</span> <span m='2448500'>index.</span> <span m='2449560'>And</span>
  <span m='2449580'>what</span> <span m='2449700'>I</span> <span m='2449790'>want</span>
  <span m='2449970'>to</span> <span m='2450030'>compute</span> <span m='2450480'>is</span>
  <span m='2450750'>where</span> <span m='2450930'>it's</span> <span m='2451020'>supposed</span>
  <span m='2451470'>to</span> <span m='2451620'>be.</span> <span m='2452190'>The</span>
  <span m='2452310'>edges</span> <span m='2452610'>have</span> <span m='2452760'>been</span>
  <span m='2452910'>permuted.</span> <span m='2454050'>So</span> <span m='2454200'>if</span>
  <span m='2454320'>I</span> <span m='2454410'>sort</span> <span m='2454770'>this</span>
  <span m='2454980'>thing,</span> <span m='2455430'>I</span> <span m='2455520'>claim</span>
  <span m='2455820'>that</span> <span m='2455970'>I'll</span> <span m='2456090'>find</span>
  <span m='2456480'>that</span> <span m='2456750'>all</span> <span m='2456960'>the</span>
  <span m='2457080'>desired</span> <span m='2457440'>permutations.</span> <span m='2460390'>OK,</span>
  <span m='2461010'>why?</span> </p><p><span m='2462060'>Because</span> <span m='2463410'>if</span>
  <span m='2463560'>I</span> <span m='2463650'>sort</span> <span m='2463920'>by</span>
  <span m='2465860'>this</span> <span m='2466050'>triple,</span> <span m='2466890'>first</span>
  <span m='2467100'>thing</span> <span m='2467280'>I</span> <span m='2467340'>sort</span>
  <span m='2467580'>by</span> <span m='2467750'>is</span> <span m='2467850'>by</span>
  <span m='2468030'>node</span> <span m='2468240'>ID,</span> <span m='2468660'>then</span>
  <span m='2468900'>I'm</span> <span m='2469050'>sorting</span> <span m='2469440'>by</span>
  <span m='2470160'>actual</span> <span m='2470520'>chunk</span> <span m='2470760'>value,</span>
  <span m='2471150'>then</span> <span m='2472030'>edge</span> <span m='2472340'>index.</span>
  <span m='2472560'>I</span> <span m='2472590'>don't</span> <span m='2472710'>care</span>
  <span m='2472890'>that</span> <span m='2473010'>I'm</span> <span m='2473100'>sorting</span>
  <span m='2473430'>by</span> <span m='2473610'>it,</span> <span m='2473700'>that's</span>
  <span m='2473910'>just</span> <span m='2474060'>coming</span> <span m='2474330'>along</span>
  <span m='2474540'>for</span> <span m='2474630'>the</span> <span m='2474720'>ride.</span>
  <span m='2475870'>So</span> <span m='2476010'>what</span> <span m='2476160'>this</span>
  <span m='2476310'>tells</span> <span m='2476580'>me</span> <span m='2476760'>is</span>
  <span m='2476970'>for</span> <span m='2477210'>each</span> <span m='2477450'>node</span>
  <span m='2480270'>it</span> <span m='2480330'>gives</span> <span m='2480570'>me</span>
  <span m='2480690'>the</span> <span m='2480810'>sorted</span> <span m='2481260'>value</span>
  <span m='2481710'>of</span> <span m='2481890'>the</span> <span m='2482100'>actual</span>
  <span m='2482610'>chunks,</span> <span m='2482970'>not</span> <span m='2483150'>the</span>
  <span m='2483270'>hash</span> <span m='2483540'>chunks.</span> <span m='2484560'>And</span>
  <span m='2484680'>then</span> <span m='2484860'>it</span> <span m='2484920'>tells</span>
  <span m='2485220'>me</span> <span m='2485340'>the</span> <span m='2485490'>order</span>
  <span m='2485820'>they</span> <span m='2485970'>used</span> <span m='2486210'>to</span>
  <span m='2486360'>be</span> <span m='2486510'>in.</span> </p><p><span m='2488160'>So</span>
  <span m='2488970'>this</span> <span m='2489240'>is</span> <span m='2489390'>a</span>
  <span m='2489510'>way</span> <span m='2489780'>to</span> <span m='2491640'>figure</span>
  <span m='2491910'>out</span> <span m='2492000'>the</span> <span m='2492120'>sorted</span>
  <span m='2492520'>permutation</span> <span m='2493200'>of</span> <span m='2493260'>these</span>
  <span m='2493440'>things.</span> <span m='2494250'>This</span> <span m='2494430'>gives</span>
  <span m='2494610'>you</span> <span m='2494700'>the</span> <span m='2494850'>old</span>
  <span m='2495060'>index.</span> <span m='2496110'>And</span> <span m='2496260'>so</span>
  <span m='2496440'>once</span> <span m='2496680'>you've</span> <span m='2496770'>sorted</span>
  <span m='2497070'>them</span> <span m='2497250'>you</span> <span m='2497370'>know</span>
  <span m='2497580'>that</span> <span m='2497760'>new</span> <span m='2498090'>correct</span>
  <span m='2498570'>order</span> <span m='2499350'>is</span> <span m='2499800'>in</span>
  <span m='2499980'>order</span> <span m='2500220'>by</span> <span m='2500370'>chunk.</span>
  <span m='2501510'>And</span> <span m='2501630'>so</span> <span m='2501750'>this</span>
  <span m='2501930'>gives</span> <span m='2502140'>you</span> <span m='2502500'>the</span>
  <span m='2502620'>inverse</span> <span m='2503040'>of</span> <span m='2503130'>the</span>
  <span m='2503220'>permutation</span> <span m='2503940'>over</span> <span m='2504150'>here,</span>
  <span m='2504980'>of</span> <span m='2505260'>where</span> <span m='2505620'>each</span>
  <span m='2505920'>edge</span> <span m='2506130'>should</span> <span m='2506400'>be.</span>
  <span m='2507420'>So</span> <span m='2507600'>once</span> <span m='2507840'>I've</span>
  <span m='2507930'>done</span> <span m='2508170'>this</span> <span m='2509130'>the</span>
  <span m='2509220'>last</span> <span m='2509520'>step</span> <span m='2510810'>is</span>
  <span m='2512670'>for</span> <span m='2512850'>each</span> <span m='2513060'>node</span>
  <span m='2517590'>permute</span> <span m='2521070'>the</span> <span m='2521220'>edges</span>
  <span m='2523530'>as</span> <span m='2523860'>given</span> <span m='2524340'>by</span>
  <span m='2524670'>this</span> <span m='2524940'>inverse</span> <span m='2525420'>permutation.</span>
  <span m='2527190'>Questions?</span> </p><p><span m='2528118'>AUDIENCE:</span> <span
  m='2528270'>Can</span> <span m='2528422'>you</span> <span m='2528576'>explain again
  that?</span> <span m='2529034'>You were</span> <span m='2529492'>basically</span>
  <span m='2529950'>sorting</span> <span m='2530408'>three</span> <span m='2530866'>times.</span>
  </p><p><span m='2531330'>ERIK DEMAINE:</span> <span m='2531420'>No,</span> <span
  m='2532530'>I'm</span> <span m='2532860'>sorting</span> <span m='2533280'>these</span>
  <span m='2533550'>single</span> <span m='2534150'>key</span> <span m='2534420'>values.</span>
  <span m='2534840'>The</span> <span m='2534960'>key</span> <span m='2535200'>value,</span>
  <span m='2535620'>the</span> <span m='2535740'>most</span> <span m='2535980'>significant</span>
  <span m='2536400'>part</span> <span m='2536580'>of</span> <span m='2536640'>the</span>
  <span m='2536730'>key</span> <span m='2536880'>is</span> <span m='2537030'>this.</span>
  <span m='2537780'>The</span> <span m='2537870'>next</span> <span m='2538080'>most</span>
  <span m='2538370'>significant</span> <span m='2538620'>part</span> <span m='2538740'>of</span>
  <span m='2538800'>the</span> <span m='2538890'>key</span> <span m='2539070'>is</span>
  <span m='2539160'>this.</span> <span m='2539340'>And</span> <span m='2539400'>the</span>
  <span m='2539460'>least</span> <span m='2539670'>significant</span> <span m='2540060'>part</span>
  <span m='2540210'>of</span> <span m='2540270'>the</span> <span m='2540330'>key</span>
  <span m='2540510'>is</span> <span m='2540630'>this.</span> <span m='2541360'>So</span>
  <span m='2541380'>imagine</span> <span m='2541710'>concatenating</span> <span m='2542400'>these</span>
  <span m='2542580'>things</span> <span m='2542760'>together</span> <span m='2543120'>into</span>
  <span m='2543300'>a</span> <span m='2543360'>single</span> <span m='2543750'>key</span>
  <span m='2543930'>value.</span> <span m='2544400'>Yeah,</span> <span m='2545280'>good</span>
  <span m='2545370'>question.</span> </p><p><span m='2546540'>What</span> <span m='2546710'>I'll</span>
  <span m='2546810'>talk</span> <span m='2547050'>about</span> <span m='2547260'>in</span>
  <span m='2547350'>a</span> <span m='2547380'>moment,</span> <span m='2547740'>how</span>
  <span m='2547920'>big</span> <span m='2548130'>this</span> <span m='2548280'>key</span>
  <span m='2548520'>is.</span> <span m='2549270'>But</span> <span m='2549450'>if</span>
  <span m='2549630'>I</span> <span m='2549720'>sort</span> <span m='2550110'>by</span>
  <span m='2550380'>the</span> <span m='2550500'>concatenation</span> <span m='2551190'>of</span>
  <span m='2551280'>those</span> <span m='2551520'>keys</span> <span m='2552390'>then</span>
  <span m='2552720'>what</span> <span m='2552870'>happens</span> <span m='2553350'>is</span>
  <span m='2553530'>I'm</span> <span m='2553650'>sorting</span> <span m='2554040'>by</span>
  <span m='2554190'>this</span> <span m='2554460'>and</span> <span m='2554610'>then</span>
  <span m='2554820'>sorting</span> <span m='2555150'>by</span> <span m='2555270'>this.</span>
  <span m='2555780'>But</span> <span m='2555960'>really,</span> <span m='2556200'>I'm</span>
  <span m='2556290'>doing</span> <span m='2556500'>one</span> <span m='2556710'>sort</span>
  <span m='2556980'>operation.</span> <span m='2557340'>This</span> <span m='2557700'>is
  one</span> <span m='2558000'>recursion.</span> <span m='2559620'>Other</span> <span
  m='2560220'>questions?</span> <span m='2562530'>OK.</span> </p><p><span m='2564200'>Do</span>
  <span m='2564270'>you</span> <span m='2564360'>see</span> <span m='2564570'>why</span>
  <span m='2565080'>this</span> <span m='2565260'>gives</span> <span m='2565470'>us</span>
  <span m='2565620'>what</span> <span m='2565770'>we</span> <span m='2565890'>need?</span>
  <span m='2566520'>For</span> <span m='2566670'>every</span> <span m='2567030'>node</span>
  <span m='2567840'>we</span> <span m='2567960'>want</span> <span m='2568110'>to</span>
  <span m='2568170'>sort</span> <span m='2568410'>all</span> <span m='2568560'>those</span>
  <span m='2568770'>chunks.</span> <span m='2569500'>And</span> <span m='2569550'>so</span>
  <span m='2570200'>this</span> <span m='2570840'>information</span> <span m='2571380'>is</span>
  <span m='2571470'>just</span> <span m='2571620'>so</span> <span m='2571770'>we</span>
  <span m='2571860'>can</span> <span m='2571980'>keep</span> <span m='2572130'>track</span>
  <span m='2572340'>of</span> <span m='2572400'>the</span> <span m='2572490'>permutation</span>
  <span m='2573180'>when</span> <span m='2573330'>we're</span> <span m='2573420'>just</span>
  <span m='2573600'>sorting</span> <span m='2573900'>by</span> <span m='2574050'>value</span>
  <span m='2574620'>and</span> <span m='2574740'>not</span> <span m='2574920'>keeping</span>
  <span m='2575280'>the</span> <span m='2575370'>permutation.</span> <span m='2576500'>This</span>
  <span m='2577020'>let's</span> <span m='2577280'>us</span> <span m='2577470'>keep</span>
  <span m='2577620'>track</span> <span m='2577890'>of</span> <span m='2577980'>it.</span>
  </p><p><span m='2578650'>But</span> <span m='2579090'>our</span> <span m='2579180'>real</span>
  <span m='2579420'>goal</span> <span m='2579630'>is</span> <span m='2579750'>to</span>
  <span m='2579840'>sort</span> <span m='2580080'>all</span> <span m='2580230'>the</span>
  <span m='2580350'>chunk</span> <span m='2580590'>values.</span> <span m='2581760'>And</span>
  <span m='2581970'>we</span> <span m='2582120'>add</span> <span m='2582300'>in</span>
  <span m='2582390'>the</span> <span m='2582480'>node</span> <span m='2582720'>ID</span>
  <span m='2583000'>so</span> <span m='2583200'>that</span> <span m='2583920'>we</span>
  <span m='2584040'>just</span> <span m='2584430'>learn</span> <span m='2584940'>for</span>
  <span m='2585120'>every</span> <span m='2585360'>node</span> <span m='2585570'>what</span>
  <span m='2585720'>we're</span> <span m='2585840'>supposed</span> <span m='2586110'>to</span>
  <span m='2586260'>do</span> <span m='2586440'>instead</span> <span m='2586740'>of</span>
  <span m='2586860'>globally</span> <span m='2587310'>what</span> <span m='2587460'>we</span>
  <span m='2587520'>need</span> <span m='2587670'>to</span> <span m='2587790'>do.</span>
  <span m='2589060'>Maybe</span> <span m='2589260'>you</span> <span m='2589350'>don't</span>
  <span m='2589530'>have</span> <span m='2589680'>to</span> <span m='2589740'>do</span>
  <span m='2589860'>this</span> <span m='2590070'>but</span> <span m='2590190'>it's</span>
  <span m='2590310'>easier</span> <span m='2590670'>to</span> <span m='2590820'>keep</span>
  <span m='2591030'>the</span> <span m='2591100'>node</span> <span m='2591290'>ID</span>
  <span m='2591510'>in</span> <span m='2591630'>there.</span> </p><p><span m='2593010'>OK,</span>
  <span m='2593550'>how</span> <span m='2593730'>many</span> <span m='2593940'>bits</span>
  <span m='2595350'>are</span> <span m='2595500'>in</span> <span m='2595710'>this</span>
  <span m='2595890'>key?</span> <span m='2597020'>So</span> <span m='2597090'>our</span>
  <span m='2597180'>whole</span> <span m='2597360'>point</span> <span m='2597630'>was</span>
  <span m='2597780'>to</span> <span m='2597870'>make</span> <span m='2598020'>chunks</span>
  <span m='2598290'>small</span> <span m='2598740'>so</span> <span m='2598920'>that</span>
  <span m='2599100'>the</span> <span m='2599190'>keys</span> <span m='2599460'>were</span>
  <span m='2599610'>small.</span> <span m='2600390'>But</span> <span m='2600540'>I</span>
  <span m='2600600'>claim</span> <span m='2600990'>this</span> <span m='2601200'>will</span>
  <span m='2601350'>be</span> <span m='2601470'>a</span> <span m='2601530'>little</span>
  <span m='2601770'>bit</span> <span m='2601890'>smaller</span> <span m='2602220'>than</span>
  <span m='2602340'>what</span> <span m='2602460'>we</span> <span m='2602550'>started</span>
  <span m='2602880'>with.</span> </p><p><span m='2603730'>So</span> <span m='2603840'>the</span>
  <span m='2603960'>node</span> <span m='2604230'>ID,</span> <span m='2605060'>well,</span>
  <span m='2605310'>there's</span> <span m='2605460'>only</span> <span m='2605830'>n</span>
  <span m='2605990'>nodes,</span> <span m='2606300'>so</span> <span m='2606570'>this</span>
  <span m='2606780'>is</span> <span m='2606870'>log</span> <span m='2607190'>n</span>
  <span m='2607450'>bits.</span> <span m='2609510'>Chunk</span> <span m='2609840'>value</span>
  <span m='2611670'>is,</span> <span m='2612240'>I</span> <span m='2612330'>guess,</span>
  <span m='2612630'>w</span> <span m='2613800'>divided</span> <span m='2614280'>by</span>
  <span m='2614640'>log</span> <span m='2615090'>to</span> <span m='2615240'>the</span>
  <span m='2615390'>epsilon</span> <span m='2615940'>n</span> <span m='2617120'>bits.</span>
  <span m='2618630'>Because</span> <span m='2618920'>there</span> <span m='2619070'>are</span>
  <span m='2619110'>a</span> <span m='2619130'>log</span> <span m='2619440'>to</span>
  <span m='2619530'>the</span> <span m='2619650'>epsilon</span> <span m='2620080'>n</span>
  <span m='2620280'>chunks,</span> <span m='2622070'>so it's</span> <span m='2622360'>w</span>
  <span m='2622830'>divided</span> <span m='2623160'>by</span> <span m='2623280'>log
  to</span> <span m='2623730'>the epsilon</span> <span m='2623850'>bits.</span> <span
  m='2624240'>The</span> <span m='2624450'>edge</span> <span m='2624720'>index,</span>
  <span m='2628410'>how</span> <span m='2628680'>many</span> <span m='2629010'>different</span>
  <span m='2629430'>things</span> <span m='2629880'>were</span> <span m='2630090'>there?</span>
  </p><p><span m='2634822'>Is it</span> <span m='2635220'>also</span> <span m='2635610'>w</span>
  <span m='2635880'>divided</span> <span m='2636210'>by</span> <span m='2636390'>log</span>
  <span m='2636630'>to the</span> <span m='2636720'>epsilon?</span> <span m='2637090'>I
  guess</span> <span m='2637508'>so.</span> <span m='2639600'>Depends</span> <span
  m='2639810'>how</span> <span m='2639900'>you</span> <span m='2640020'>count.</span>
  <span m='2644390'>Let me</span> <span m='2644490'>think</span> <span m='2644730'>for</span>
  <span m='2644850'>a</span> <span m='2644880'>second</span> <span m='2645210'>how</span>
  <span m='2645390'>these</span> <span m='2645600'>edge</span> <span m='2645960'>indices</span>
  <span m='2646650'>should</span> <span m='2646860'>be</span> <span m='2647010'>stored.</span>
  <span m='2652140'>I</span> <span m='2652200'>think</span> <span m='2652500'>I'd</span>
  <span m='2652680'>like</span> <span m='2652980'>to</span> <span m='2653130'>store</span>
  <span m='2653460'>the</span> <span m='2653610'>edge</span> <span m='2653880'>indices--</span>
  <span m='2654540'>I</span> <span m='2654630'>don't</span> <span m='2654840'>want</span>
  <span m='2654990'>to</span> <span m='2655050'>store</span> <span m='2655470'>the</span>
  <span m='2656040'>absent</span> <span m='2657360'>down</span> <span m='2657630'>pointers.</span>
  </p><p><span m='2660150'>The</span> <span m='2660330'>way</span> <span m='2660480'>that</span>
  <span m='2660630'>I</span> <span m='2660690'>built</span> <span m='2660960'>this</span>
  <span m='2661140'>tree,</span> <span m='2662280'>this</span> <span m='2662430'>compress</span>
  <span m='2662880'>trie,</span> <span m='2663680'>I was</span> <span m='2663810'>always</span>
  <span m='2664020'>adding</span> <span m='2664380'>things</span> <span m='2664590'>to</span>
  <span m='2664710'>the</span> <span m='2664830'>right.</span> <span m='2665920'>So</span>
  <span m='2666000'>it's</span> <span m='2666090'>like</span> <span m='2666300'>OK,</span>
  <span m='2667870'>I'm</span> <span m='2668070'>storing</span> <span m='2668340'>here.</span>
  <span m='2668700'>Here's</span> <span m='2668970'>the</span> <span m='2669060'>first</span>
  <span m='2669300'>child,</span> <span m='2669690'>here's</span> <span m='2669870'>the</span>
  <span m='2669990'>next</span> <span m='2670170'>child,</span> <span m='2670470'>here's</span>
  <span m='2670650'>the</span> <span m='2670700'>next</span> <span m='2670900'>child,</span>
  <span m='2671140'>here's</span> <span m='2671370'>the next</span> <span m='2671590'>child.</span>
  <span m='2672240'>I</span> <span m='2672300'>just</span> <span m='2672450'>keep</span>
  <span m='2672700'>appending</span> <span m='2673260'>on.</span> <span m='2673450'>It's</span>
  <span m='2673590'>like</span> <span m='2673770'>an</span> <span m='2673890'>array</span>
  <span m='2674190'>that</span> <span m='2674310'>you</span> <span m='2674400'>can</span>
  <span m='2674520'>grow</span> <span m='2674730'>to</span> <span m='2674850'>the</span>
  <span m='2674940'>right,</span> <span m='2675300'>which</span> <span m='2675570'>you</span>
  <span m='2675660'>should</span> <span m='2675810'>know</span> <span m='2675930'>how</span>
  <span m='2676020'>to</span> <span m='2676140'>do</span> <span m='2676260'>in</span>
  <span m='2676350'>constant</span> <span m='2676680'>time,</span> <span m='2677460'>even</span>
  <span m='2677640'>though</span> <span m='2677700'>linked</span> <span m='2677910'>list</span>
  <span m='2678150'>is</span> <span m='2678270'>probably</span> <span m='2678690'>fine.</span>
  </p><p><span m='2681690'>If</span> <span m='2681810'>there</span> <span m='2681900'>are</span>
  <span m='2681960'>a</span> <span m='2681990'>bunch</span> <span m='2682230'>of</span>
  <span m='2682290'>values</span> <span m='2682650'>here</span> <span m='2682800'>that</span>
  <span m='2682920'>are</span> <span m='2683010'>just</span> <span m='2683160'>null</span>
  <span m='2683400'>pointers</span> <span m='2683850'>I</span> <span m='2683910'>don't</span>
  <span m='2684090'>want</span> <span m='2684210'>to</span> <span m='2684300'>store</span>
  <span m='2684540'>those</span> <span m='2684780'>items</span> <span m='2685080'>in</span>
  <span m='2685200'>the</span> <span m='2685290'>array.</span> <span m='2686470'>So</span>
  <span m='2686760'>in</span> <span m='2686850'>fact,</span> <span m='2687250'>the</span>
  <span m='2687300'>maximum</span> <span m='2687870'>number</span> <span m='2688110'>of</span>
  <span m='2688200'>children</span> <span m='2688650'>of</span> <span m='2688770'>a</span>
  <span m='2688800'>node</span> <span m='2689190'>is</span> <span m='2690030'>n.</span>
  <span m='2690360'>I</span> <span m='2690660'>mean,</span> <span m='2690870'>at</span>
  <span m='2690960'>the</span> <span m='2691050'>worst</span> <span m='2691260'>case</span>
  <span m='2691600'>you</span> <span m='2691700'>have</span> <span m='2691920'>branching</span>
  <span m='2692430'>everywhere.</span> <span m='2693190'>So</span> <span m='2693750'>this</span>
  <span m='2693930'>is</span> <span m='2694050'>only</span> <span m='2694320'>log</span>
  <span m='2694620'>n</span> <span m='2694770'>bits</span> <span m='2700600'>to</span>
  <span m='2700760'>store</span> <span m='2701030'>the</span> <span m='2701210'>index</span>
  <span m='2701840'>in</span> <span m='2701990'>that</span> <span m='2702200'>array.</span>
  <span m='2703050'>So</span> <span m='2703190'>it's</span> <span m='2703430'>an</span>
  <span m='2703520'>extra</span> <span m='2703880'>level</span> <span m='2704180'>of</span>
  <span m='2704270'>compression.</span> </p><p><span m='2705240'>I guess</span> <span
  m='2705340'>I</span> <span m='2705440'>didn't</span> <span m='2705560'>mention</span>
  <span m='2709310'>don't</span> <span m='2709580'>store</span> <span m='2712380'>null</span>
  <span m='2712640'>pointers,</span> <span m='2713150'>just</span> <span m='2713330'>skip</span>
  <span m='2713570'>them.</span> <span m='2716040'>And</span> <span m='2716580'>that's</span>
  <span m='2716720'>easy</span> <span m='2716930'>to</span> <span m='2717050'>do</span>
  <span m='2717320'>because</span> <span m='2718480'>you're</span> <span m='2718530'>always</span>
  <span m='2718670'>just</span> <span m='2718850'>appending.</span> <span m='2719510'>And</span>
  <span m='2719660'>in</span> <span m='2719750'>the</span> <span m='2719900'>end</span>
  <span m='2720860'>what</span> <span m='2721010'>do</span> <span m='2721100'>I</span>
  <span m='2721160'>need</span> <span m='2721340'>to</span> <span m='2721460'>do</span>
  <span m='2721640'>here?</span> </p><p><span m='2724300'>Step</span> <span m='2724590'>seven</span>
  <span m='2725450'>is</span> <span m='2725660'>in</span> <span m='2725840'>order</span>
  <span m='2726050'>traversal</span> <span m='2731780'>of</span> <span m='2732050'>the</span>
  <span m='2732170'>compress</span> <span m='2732590'>trie.</span> <span m='2737180'>And</span>
  <span m='2737670'>I</span> <span m='2737770'>output</span> <span m='2738200'>all</span>
  <span m='2738320'>the</span> <span m='2738410'>leaves</span> <span m='2738710'>I</span>
  <span m='2738830'>get</span> <span m='2741350'>in</span> <span m='2741500'>order.</span>
  <span m='2743690'>And</span> <span m='2743770'>the</span> <span m='2743840'>point</span>
  <span m='2744080'>is</span> <span m='2744230'>we</span> <span m='2744380'>computed</span>
  <span m='2744890'>the</span> <span m='2744980'>compress</span> <span m='2745430'>trie</span>
  <span m='2745640'>which</span> <span m='2745820'>has</span> <span m='2746030'>the</span>
  <span m='2746180'>rough</span> <span m='2746810'>correct</span> <span m='2747280'>topological</span>
  <span m='2748040'>structure.</span> <span m='2748910'>Then</span> <span m='2749090'>we</span>
  <span m='2749240'>fix</span> <span m='2749510'>the</span> <span m='2749660'>order</span>
  <span m='2749960'>within</span> <span m='2750230'>each</span> <span m='2750410'>node,</span>
  <span m='2750710'>now</span> <span m='2751040'>we</span> <span m='2751160'>have</span>
  <span m='2751370'>the</span> <span m='2751490'>correctly</span> <span m='2751970'>sorted</span>
  <span m='2752360'>compress</span> <span m='2752750'>trie.</span> <span m='2753320'>And</span>
  <span m='2753550'>so</span> <span m='2753640'>you're</span> <span m='2753730'>just</span>
  <span m='2753860'>doing</span> <span m='2754080'>in</span> <span m='2754180'>order</span>
  <span m='2754380'>traversal,</span> <span m='2755750'>output</span> <span m='2755980'>the</span>
  <span m='2756080'>leave</span> <span m='2756320'>you</span> <span m='2756380'>get</span>
  <span m='2756600'>in</span> <span m='2756740'>order.</span> </p><p><span m='2757610'>Boom,</span>
  <span m='2757910'>we've</span> <span m='2758030'>sorted</span> <span m='2758390'>all</span>
  <span m='2758480'>the</span> <span m='2758630'>items.</span> <span m='2760710'>A</span>
  <span m='2760950'>little</span> <span m='2761060'>crazy.</span> <span m='2764060'>So</span>
  <span m='2764330'>if</span> <span m='2764510'>all</span> <span m='2764630'>we</span>
  <span m='2764720'>need</span> <span m='2764870'>to</span> <span m='2764960'>do</span>
  <span m='2765080'>in</span> <span m='2765170'>the</span> <span m='2765260'>end</span>
  <span m='2765380'>is</span> <span m='2765470'>in</span> <span m='2765590'>order</span>
  <span m='2765740'>traversal</span> <span m='2766220'>then</span> <span m='2766460'>it's</span>
  <span m='2766580'>fine</span> <span m='2766950'>we</span> <span m='2767050'>don't</span>
  <span m='2767060'>need</span> <span m='2767180'>to</span> <span m='2767270'>store</span>
  <span m='2767450'>the</span> <span m='2767570'>null</span> <span m='2767720'>pointers.</span>
  <span m='2768540'>So</span> <span m='2768830'>we</span> <span m='2768950'>don't</span>
  <span m='2769100'>need</span> <span m='2769220'>to</span> <span m='2769310'>be</span>
  <span m='2769370'>able</span> <span m='2769490'>to</span> <span m='2769580'>search</span>
  <span m='2769910'>in</span> <span m='2770020'>this</span> <span m='2770150'>trie,</span>
  <span m='2770920'>so</span> <span m='2771110'>this</span> <span m='2771290'>is</span>
  <span m='2771380'>enough.</span> <span m='2774590'>Clear?</span> </p><p><span m='2776090'>OK,</span>
  <span m='2776330'>the</span> <span m='2776420'>remaining</span> <span m='2776780'>question</span>
  <span m='2777020'>is</span> <span m='2777430'>how</span> <span m='2777950'>expensive</span>
  <span m='2778430'>is</span> <span m='2778580'>this</span> <span m='2778730'>recursion?</span>
  <span m='2779970'>So</span> <span m='2780080'>I</span> <span m='2780170'>computed</span>
  <span m='2781130'>the</span> <span m='2781190'>number</span> <span m='2781430'>of</span>
  <span m='2781490'>bits</span> <span m='2782180'>basically</span> <span m='2782840'>w</span>
  <span m='2783170'>divided</span> <span m='2783530'>by</span> <span m='2783680'>log</span>
  <span m='2783950'>to the</span> <span m='2784070'>epsilon</span> <span m='2784460'>n,</span>
  <span m='2785060'>plus</span> <span m='2785300'>order</span> <span m='2785510'>log</span>
  <span m='2785800'>n.</span> <span m='2787020'>That</span> <span m='2787520'>order</span>
  <span m='2787760'>log</span> <span m='2788000'>n</span> <span m='2788120'>won't</span>
  <span m='2788300'>hurt</span> <span m='2788480'>us.</span> <span m='2789050'>Now,</span>
  <span m='2789200'>we</span> <span m='2789320'>started</span> <span m='2789800'>with</span>
  <span m='2790820'>integers</span> <span m='2791360'>of</span> <span m='2791450'>size</span>
  <span m='2791960'>w,</span> <span m='2792660'>the</span> <span m='2792770'>total</span>
  <span m='2793070'>size</span> <span m='2793400'>here</span> <span m='2794330'>was</span>
  <span m='2794480'>w.</span> <span m='2795740'>Now</span> <span m='2796220'>we</span>
  <span m='2796370'>have</span> <span m='2796640'>integers</span> <span m='2797780'>that</span>
  <span m='2798410'>their</span> <span m='2798620'>size</span> <span m='2799030'>is</span>
  <span m='2799160'>w</span> <span m='2799490'>divided</span> <span m='2799850'>by</span>
  <span m='2800000'>log to the</span> <span m='2800330'>epsilon</span> <span m='2800690'>n.</span>
  <span m='2800910'>So</span> <span m='2801020'>we've</span> <span m='2801170'>made</span>
  <span m='2801350'>progress.</span> <span m='2805010'>Cool.</span> </p><p><span m='2806520'>How</span>
  <span m='2807020'>much</span> <span m='2807290'>progress?</span> <span m='2813380'>Over</span>
  <span m='2813670'>here</span> <span m='2813960'>maybe.</span> <span m='2821710'>After,</span>
  <span m='2822340'>let's</span> <span m='2822490'>say,</span> <span m='2822820'>1</span>
  <span m='2823090'>over</span> <span m='2823300'>epsilon</span> <span m='2823840'>plus</span>
  <span m='2824200'>1</span> <span m='2825280'>recursions</span> <span m='2829540'>we</span>
  <span m='2829780'>will</span> <span m='2829930'>have</span> <span m='2830140'>reached</span>
  <span m='2835850'>b</span> <span m='2837100'>will</span> <span m='2837230'>have</span>
  <span m='2837410'>decreased</span> <span m='2843660'>to</span> <span m='2844800'>order</span>
  <span m='2845130'>log</span> <span m='2845520'>n.</span> <span m='2847110'>I</span>
  <span m='2847170'>guess,</span> <span m='2847620'>like</span> <span m='2848190'>1</span>
  <span m='2848370'>over</span> <span m='2848580'>epsilon</span> <span m='2849320'>log</span>
  <span m='2849670'>n</span> <span m='2851010'>plus</span> <span m='2852990'>w</span>
  <span m='2854340'>over</span> <span m='2854880'>log</span> <span m='2856350'>to</span>
  <span m='2856560'>the</span> <span m='2856800'>1</span> <span m='2857130'>plus</span>
  <span m='2857700'>epsilon</span> <span m='2859440'>n.</span> </p><p><span m='2867480'>OK.</span>
  <span m='2868940'>Right,</span> <span m='2869200'>if</span> <span m='2869470'>we</span>
  <span m='2869590'>take</span> <span m='2869800'>w</span> <span m='2870190'>and</span>
  <span m='2870280'>every</span> <span m='2870550'>time</span> <span m='2870760'>we</span>
  <span m='2870850'>divide</span> <span m='2871180'>by</span> <span m='2871330'>log</span>
  <span m='2871600'>to</span> <span m='2871690'>the</span> <span m='2871780'>epsilon</span>
  <span m='2872230'>n,</span> <span m='2873250'>then</span> <span m='2873370'>after</span>
  <span m='2873640'>1</span> <span m='2873740'>over</span> <span m='2873970'>epsilon</span>
  <span m='2874360'>times</span> <span m='2874630'>we</span> <span m='2874810'>have</span>
  <span m='2874990'>divided</span> <span m='2875410'>by</span> <span m='2875720'>log</span>
  <span m='2876050'>n,</span> <span m='2876610'>get</span> <span m='2876760'>rid</span>
  <span m='2876910'>of</span> <span m='2876970'>epsilon.</span> <span m='2877700'>Do
  it</span> <span m='2877960'>one</span> <span m='2878200'>more</span> <span m='2878350'>time,</span>
  <span m='2878800'>we get</span> <span m='2879260'>w</span> <span m='2879580'>divided</span>
  <span m='2879910'>by</span> <span m='2880540'>log</span> <span m='2880720'>to</span>
  <span m='2880810'>the</span> <span m='2880930'>1</span> <span m='2881170'>plus</span>
  <span m='2881500'>epsilon</span> <span m='2881970'>n.</span> <span m='2883480'>And</span>
  <span m='2883770'>at</span> <span m='2883930'>this</span> <span m='2884140'>point</span>
  <span m='2884950'>we're</span> <span m='2885100'>in</span> <span m='2885190'>good</span>
  <span m='2885400'>shape.</span> </p><p><span m='2889600'>If</span> <span m='2889720'>we</span>
  <span m='2889840'>get</span> <span m='2890080'>the</span> <span m='2890230'>size</span>
  <span m='2890650'>of</span> <span m='2890800'>our</span> <span m='2891010'>integers</span>
  <span m='2891700'>to</span> <span m='2891850'>be</span> <span m='2892180'>only</span>
  <span m='2892540'>w</span> <span m='2892960'>divided</span> <span m='2893290'>by</span>
  <span m='2893440'>log</span> <span m='2893680'>to</span> <span m='2893770'>the</span>
  <span m='2893890'>1</span> <span m='2894040'>plus</span> <span m='2894280'>epsilon</span>
  <span m='2894640'>n,</span> <span m='2895360'>then</span> <span m='2896080'>we</span>
  <span m='2896230'>can</span> <span m='2896350'>use</span> <span m='2896560'>packed</span>
  <span m='2897000'>sorting.</span> <span m='2898450'>Because</span> <span m='2898660'>packed</span>
  <span m='2898990'>sorting,</span> <span m='2899410'>conveniently</span> <span m='2899860'>it's</span>
  <span m='2900310'>the</span> <span m='2900430'>black</span> <span m='2900670'>box</span>
  <span m='2900970'>at</span> <span m='2901030'>the</span> <span m='2901150'>moment,</span>
  <span m='2901900'>says</span> <span m='2902200'>well,</span> <span m='2902410'>as</span>
  <span m='2902530'>long</span> <span m='2902770'>as</span> <span m='2902860'>w</span>
  <span m='2903070'>divided</span> <span m='2903370'>by</span> <span m='2903520'>b</span>
  <span m='2903730'>is</span> <span m='2903850'>a</span> <span m='2903870'>little</span>
  <span m='2904120'>bigger</span> <span m='2904360'>than</span> <span m='2904510'>log</span>
  <span m='2904750'>n.</span> <span m='2905710'>So</span> <span m='2905860'>here</span>
  <span m='2906010'>we've</span> <span m='2906130'>made</span> <span m='2906310'>it</span>
  <span m='2906400'>quite</span> <span m='2906670'>a</span> <span m='2906730'>bit</span>
  <span m='2906850'>bigger</span> <span m='2907120'>than</span> <span m='2907780'>log</span>
  <span m='2907940'>n.</span> <span m='2908260'>I</span> <span m='2908320'>mean,</span>
  <span m='2908560'>log to the</span> <span m='2908930'>1</span> <span m='2909170'>plus</span>
  <span m='2909370'>epsilon</span> <span m='2909830'>n</span> <span m='2910480'>bigger,</span>
  <span m='2911560'>then</span> <span m='2912220'>we</span> <span m='2912310'>can</span>
  <span m='2912430'>use</span> <span m='2912580'>packed</span> <span m='2912880'>sorting.</span>
  <span m='2917680'>Reach</span> <span m='2918190'>base</span> <span m='2918430'>case,</span>
  <span m='2922180'>and</span> <span m='2922330'>then</span> <span m='2923000'>use</span>
  <span m='2923730'>packed</span> <span m='2924130'>sorting.</span> </p><p><span m='2930740'>OK,</span>
  <span m='2931150'>the</span> <span m='2931270'>only</span> <span m='2931600'>thing</span>
  <span m='2931810'>is</span> <span m='2931960'>there's</span> <span m='2932140'>this</span>
  <span m='2932500'>log</span> <span m='2932855'>n.</span> <span m='2933210'>Now,</span>
  <span m='2933430'>epsilon</span> <span m='2933910'>is</span> <span m='2934000'>a</span>
  <span m='2934060'>constant</span> <span m='2934510'>here,</span> <span m='2934930'>so</span>
  <span m='2935170'>1</span> <span m='2935380'>over</span> <span m='2935470'>epsilon</span>
  <span m='2935860'>is</span> <span m='2935980'>constant.</span> <span m='2936890'>So</span>
  <span m='2936940'>this</span> <span m='2937150'>is</span> <span m='2937240'>just</span>
  <span m='2937420'>order</span> <span m='2937690'>log</span> <span m='2937990'>n.</span>
  <span m='2938740'>Order</span> <span m='2939010'>log</span> <span m='2939280'>n</span>
  <span m='2939460'>doesn't</span> <span m='2939730'>hurt</span> <span m='2939880'>you.</span>
  <span m='2940280'>I</span> <span m='2940380'>mean,</span> <span m='2941080'>if</span>
  <span m='2941320'>this</span> <span m='2941530'>happened</span> <span m='2941860'>to</span>
  <span m='2941950'>dominate</span> <span m='2942520'>this</span> <span m='2943030'>then</span>
  <span m='2943240'>you're</span> <span m='2943360'>saying</span> <span m='2943960'>your</span>
  <span m='2944260'>values</span> <span m='2944770'>are</span> <span m='2944920'>order</span>
  <span m='2945280'>log</span> <span m='2945550'>n</span> <span m='2945700'>bits</span>
  <span m='2945910'>long,</span> <span m='2946300'>and</span> <span m='2946390'>so
  you</span> <span m='2946770'>use</span> <span m='2947230'>radex</span> <span m='2947530'>sort.</span>
  <span m='2948740'>So</span> <span m='2948850'>that's</span> <span m='2949300'>not</span>
  <span m='2949450'>going</span> <span m='2949570'>to</span> <span m='2949630'>dominate.</span>
  </p><p><span m='2950710'>In</span> <span m='2950830'>fact,</span> <span m='2951070'>you</span>
  <span m='2951160'>can</span> <span m='2951310'>prove</span> <span m='2951520'>in</span>
  <span m='2951610'>this</span> <span m='2951730'>case</span> <span m='2952070'>it's</span>
  <span m='2952080'>not</span> <span m='2952180'>going</span> <span m='2952300'>to</span>
  <span m='2952360'>dominate.</span> <span m='2952690'>w</span> <span m='2953050'>is</span>
  <span m='2953170'>at</span> <span m='2953260'>least</span> <span m='2953560'>log</span>
  <span m='2953890'>to</span> <span m='2954010'>the</span> <span m='2954130'>2</span>
  <span m='2954280'>plus</span> <span m='2954520'>epsilon.</span> <span m='2955500'>So</span>
  <span m='2955570'>you</span> <span m='2955660'>take</span> <span m='2955870'>w</span>
  <span m='2956200'>divided</span> <span m='2956530'>by</span> <span m='2956650'>log</span>
  <span m='2956890'>to</span> <span m='2957010'>1</span> <span m='2957190'>plus</span>
  <span m='2957640'>epsilon,</span> <span m='2957760'>that's</span> <span m='2957910'>still</span>
  <span m='2958180'>at</span> <span m='2958270'>least</span> <span m='2958630'>log</span>
  <span m='2958900'>n.</span> <span m='2960010'>So</span> <span m='2960160'>this</span>
  <span m='2960340'>will</span> <span m='2960490'>always</span> <span m='2960760'>dominate.</span>
  </p><p><span m='2967360'>OK,</span> <span m='2968380'>so</span> <span m='2969490'>we</span>
  <span m='2969610'>did</span> <span m='2969850'>all</span> <span m='2970180'>this</span>
  <span m='2970420'>work</span> <span m='2971020'>and</span> <span m='2971200'>all</span>
  <span m='2971500'>we</span> <span m='2971650'>did</span> <span m='2972250'>was</span>
  <span m='2972430'>reduce</span> <span m='2972790'>our</span> <span m='2972880'>word</span>
  <span m='2973090'>size</span> <span m='2973420'>by</span> <span m='2973630'>a</span>
  <span m='2973720'>log</span> <span m='2974050'>to</span> <span m='2974140'>the</span>
  <span m='2974230'>epsilon</span> <span m='2974590'>factor.</span> <span m='2975320'>But</span>
  <span m='2975420'>that's</span> <span m='2975520'>enough,</span> <span m='2976030'>because</span>
  <span m='2976300'>after</span> <span m='2976510'>we</span> <span m='2976600'>do</span>
  <span m='2976780'>that</span> <span m='2977430'>1</span> <span m='2977590'>over</span>
  <span m='2977800'>epsilon</span> <span m='2978160'>plus</span> <span m='2978370'>1</span>
  <span m='2978580'>times</span> <span m='2980310'>the</span> <span m='2980470'>words</span>
  <span m='2980770'>are</span> <span m='2980830'>small</span> <span m='2981160'>enough,</span>
  <span m='2981830'>or</span> <span m='2981970'>the</span> <span m='2982180'>items</span>
  <span m='2982540'>we're</span> <span m='2982630'>sorting</span> <span m='2982990'>are</span>
  <span m='2983080'>small</span> <span m='2983350'>enough,</span> <span m='2983950'>that</span>
  <span m='2984040'>we</span> <span m='2984190'>can</span> <span m='2984280'>use</span>
  <span m='2984430'>packed</span> <span m='2984810'>sorting.</span> <span m='2985750'>And</span>
  <span m='2985870'>boom,</span> <span m='2986170'>we're</span> <span m='2986260'>done.</span>
  <span m='2987700'>OK,</span> <span m='2988690'>that</span> <span m='2988990'>is</span>
  <span m='2990220'>the</span> <span m='2990340'>beauty</span> <span m='2991000'>of</span>
  <span m='2991330'>signature</span> <span m='2991900'>sort.</span> </p><p><span m='2992140'>Any</span>
  <span m='2992350'>questions</span> <span m='2992770'>about</span> <span m='2993010'>that?</span>
  <span m='2994780'>Definitely</span> <span m='2995260'>not</span> <span m='2995620'>easy.</span>
  <span m='2999020'>But,</span> <span m='2999585'>it</span> <span m='2999980'>works.</span>
  </p><p><span m='3001640'>The</span> <span m='3001750'>crazy</span> <span m='3002170'>idea</span>
  <span m='3002570'>is,</span> <span m='3003040'>well,</span> <span m='3003250'>decompose</span>
  <span m='3003820'>into</span> <span m='3004030'>these</span> <span m='3004210'>digits.</span>
  <span m='3004660'>And</span> <span m='3004750'>when</span> <span m='3004820'>we</span>
  <span m='3004960'>decompose</span> <span m='3005440'>into</span> <span m='3005650'>log</span>
  <span m='3005830'>to the</span> <span m='3005920'>epsilon</span> <span m='3006370'>digits</span>
  <span m='3006760'>because</span> <span m='3007570'>that</span> <span m='3007780'>would</span>
  <span m='3007900'>be</span> <span m='3008020'>enough.</span> <span m='3008380'>If</span>
  <span m='3008470'>we</span> <span m='3008590'>can</span> <span m='3008680'>get</span>
  <span m='3008860'>things</span> <span m='3009100'>down</span> <span m='3009310'>to</span>
  <span m='3009400'>a</span> <span m='3009430'>single</span> <span m='3009700'>digit</span>
  <span m='3010030'>life</span> <span m='3010270'>would</span> <span m='3010360'>be</span>
  <span m='3010510'>easy.</span> <span m='3012460'>Which</span> <span m='3012670'>I</span>
  <span m='3012730'>guess</span> <span m='3013000'>is</span> <span m='3013120'>kind</span>
  <span m='3013450'>of</span> <span m='3013570'>like</span> <span m='3013840'>Van</span>
  <span m='3014140'>Emde</span> <span m='3014470'>Boas,</span> <span m='3014680'>right.</span>
  </p><p><span m='3016550'>It's</span> <span m='3017110'>like</span> <span m='3017320'>our</span>
  <span m='3017440'>lower</span> <span m='3017710'>bounds</span> <span m='3018010'>from</span>
  <span m='3018160'>last</span> <span m='3018370'>time.</span> <span m='3018790'>I</span>
  <span m='3018820'>don't</span> <span m='3018910'>know.</span> <span m='3019900'>If</span>
  <span m='3020290'>we</span> <span m='3020410'>can</span> <span m='3020550'>make</span>
  <span m='3020740'>it</span> <span m='3020800'>to</span> <span m='3020930'>only</span>
  <span m='3021220'>one</span> <span m='3021400'>digit</span> <span m='3021700'>mattered</span>
  <span m='3022780'>then</span> <span m='3022960'>we</span> <span m='3023080'>could</span>
  <span m='3023200'>afford</span> <span m='3023590'>to</span> <span m='3023680'>do</span>
  <span m='3023890'>it</span> <span m='3024010'>because</span> <span m='3024310'>each</span>
  <span m='3024490'>digit</span> <span m='3024760'>is</span> <span m='3025240'>quite</span>
  <span m='3025540'>a</span> <span m='3025600'>bit</span> <span m='3025750'>smaller.</span>
  <span m='3026290'>It's</span> <span m='3026740'>smaller</span> <span m='3027130'>by</span>
  <span m='3027250'>a</span> <span m='3027280'>factor</span> <span m='3027580'>of</span>
  <span m='3027640'>log</span> <span m='3027910'>to the</span> <span m='3028000'>epsilon</span>
  <span m='3028320'>n.</span> </p><p><span m='3030790'>So</span> <span m='3031030'>we</span>
  <span m='3031150'>did</span> <span m='3031300'>that</span> <span m='3031480'>splitting</span>
  <span m='3032290'>and</span> <span m='3032440'>then</span> <span m='3032590'>there</span>
  <span m='3032700'>was</span> <span m='3032800'>this</span> <span m='3033130'>observation</span>
  <span m='3033760'>that</span> <span m='3034030'>most</span> <span m='3034360'>digit</span>
  <span m='3034660'>values</span> <span m='3035080'>aren't</span> <span m='3035290'>used.</span>
  <span m='3036200'>So</span> <span m='3036390'>if</span> <span m='3036460'>we</span>
  <span m='3036580'>hash</span> <span m='3037660'>then</span> <span m='3037870'>things</span>
  <span m='3038080'>got</span> <span m='3038230'>a</span> <span m='3038290'>lot</span>
  <span m='3038590'>smaller.</span> <span m='3039520'>Then</span> <span m='3039700'>we</span>
  <span m='3039790'>can</span> <span m='3039910'>afford</span> <span m='3040180'>to</span>
  <span m='3040270'>pack</span> <span m='3040570'>sort.</span> <span m='3041260'>Except</span>
  <span m='3041530'>that</span> <span m='3041650'>hash</span> <span m='3041950'>didn't</span>
  <span m='3042160'>preserve</span> <span m='3042520'>the</span> <span m='3042640'>order.</span>
  <span m='3043600'>How</span> <span m='3043810'>didn't</span> <span m='3044020'>it</span>
  <span m='3044110'>preserve</span> <span m='3044470'>the</span> <span m='3044560'>order?</span>
  </p><p><span m='3044830'>Well,</span> <span m='3045010'>when</span> <span m='3045190'>you</span>
  <span m='3045340'>look</span> <span m='3045550'>at</span> <span m='3045670'>the</span>
  <span m='3045940'>compress</span> <span m='3046360'>trie</span> <span m='3046660'>you</span>
  <span m='3046810'>see</span> <span m='3047080'>how</span> <span m='3047290'>it</span>
  <span m='3047410'>got</span> <span m='3047620'>messed</span> <span m='3047920'>up.</span>
  <span m='3048430'>Each</span> <span m='3048640'>node</span> <span m='3048910'>got</span>
  <span m='3049090'>messed</span> <span m='3049360'>up</span> <span m='3049510'>individually,</span>
  <span m='3050210'>but</span> <span m='3050310'>overall</span> <span m='3050620'>the</span>
  <span m='3050710'>structure</span> <span m='3051220'>of</span> <span m='3051310'>the</span>
  <span m='3051400'>trie</span> <span m='3051640'>was</span> <span m='3051820'>correct.</span>
  <span m='3052840'>So</span> <span m='3052930'>we</span> <span m='3053020'>did</span>
  <span m='3053170'>all</span> <span m='3053290'>this</span> <span m='3053440'>work</span>
  <span m='3053650'>to</span> <span m='3053740'>get</span> <span m='3053890'>the</span>
  <span m='3054010'>structure</span> <span m='3054430'>of</span> <span m='3054490'>the</span>
  <span m='3054580'>trie.</span> <span m='3054910'>Then</span> <span m='3055060'>we</span>
  <span m='3055180'>had</span> <span m='3055330'>to</span> <span m='3055420'>fix</span>
  <span m='3055870'>the</span> <span m='3055960'>node</span> <span m='3056240'>order.</span>
  <span m='3056950'>But</span> <span m='3057070'>that's</span> <span m='3057340'>really</span>
  <span m='3057520'>just</span> <span m='3057670'>sorting</span> <span m='3058030'>a</span>
  <span m='3058090'>single</span> <span m='3058390'>digit.</span> </p><p><span m='3059080'>And</span>
  <span m='3059200'>yeah,</span> <span m='3059440'>we</span> <span m='3059560'>have</span>
  <span m='3059650'>to</span> <span m='3059740'>do</span> <span m='3059860'>it</span>
  <span m='3059920'>for</span> <span m='3060100'>all</span> <span m='3060280'>nodes</span>
  <span m='3061150'>but</span> <span m='3061270'>you</span> <span m='3061450'>add</span>
  <span m='3061600'>them</span> <span m='3061750'>up.</span> <span m='3061900'>It's</span>
  <span m='3061990'>still</span> <span m='3062210'>only</span> <span m='3062470'>n</span>
  <span m='3062680'>items</span> <span m='3063640'>that</span> <span m='3063760'>we</span>
  <span m='3063850'>need</span> <span m='3064000'>to</span> <span m='3064120'>sort.</span>
  <span m='3065200'>So</span> <span m='3065330'>I</span> <span m='3065890'>wrote</span>
  <span m='3066100'>that</span> <span m='3066260'>b</span> <span m='3066430'>went</span>
  <span m='3066640'>down.</span> <span m='3068500'>n</span> <span m='3068710'>stays</span>
  <span m='3069050'>the</span> <span m='3069130'>same.</span> <span m='3070760'>The</span>
  <span m='3070860'>number</span> <span m='3071110'>of</span> <span m='3071170'>things</span>
  <span m='3071380'>we</span> <span m='3071500'>have</span> <span m='3071710'>to</span>
  <span m='3071830'>sort</span> <span m='3072100'>of</span> <span m='3072140'>stays</span>
  <span m='3072430'>the</span> <span m='3072490'>same,</span> <span m='3074200'>which</span>
  <span m='3074410'>is</span> <span m='3074530'>fine.</span> <span m='3075375'>We're</span>
  <span m='3075800'>not</span> <span m='3075940'>trying</span> <span m='3076150'>to</span>
  <span m='3076240'>reduce</span> <span m='3076510'>n,</span> <span m='3076840'>we're</span>
  <span m='3077190'>just</span> <span m='3077320'>trying</span> <span m='3077530'>to</span>
  <span m='3077620'>reduce</span> <span m='3077950'>the</span> <span m='3078040'>size</span>
  <span m='3078430'>of</span> <span m='3078520'>our</span> <span m='3078610'>items</span>
  <span m='3079030'>to</span> <span m='3079120'>be</span> <span m='3079270'>a</span>
  <span m='3079300'>little</span> <span m='3079570'>bit</span> <span m='3079690'>smaller</span>
  <span m='3080050'>than</span> <span m='3080240'>w</span> <span m='3080700'>so</span>
  <span m='3081170'>then</span> <span m='3081220'>we</span> <span m='3081310'>can</span>
  <span m='3081400'>use</span> <span m='3081550'>packed</span> <span m='3081810'>sorting.</span>
  </p><p><span m='3082770'>OK,</span> <span m='3083200'>I</span> <span m='3083520'>think</span>
  <span m='3083690'>I've</span> <span m='3083880'>gone</span> <span m='3084340'>over</span>
  <span m='3084490'>this</span> <span m='3084670'>algorithm</span> <span m='3085000'>enough</span>
  <span m='3085210'>times.</span> <span m='3086800'>The</span> <span m='3086890'>next</span>
  <span m='3087100'>step</span> <span m='3087430'>is</span> <span m='3088660'>packed</span>
  <span m='3088900'>sorting.</span> <span m='3092290'>If</span> <span m='3092680'>we</span>
  <span m='3092830'>have</span> <span m='3094600'>integers</span> <span m='3095140'>that</span>
  <span m='3095230'>are</span> <span m='3095320'>much</span> <span m='3095530'>smaller</span>
  <span m='3095920'>than</span> <span m='3096070'>our</span> <span m='3096190'>word,</span>
  <span m='3096940'>how</span> <span m='3097120'>do</span> <span m='3097240'>we</span>
  <span m='3097360'>sort</span> <span m='3097630'>in</span> <span m='3097810'>linear</span>
  <span m='3098140'>time?</span> <span m='3099360'>And</span> <span m='3099450'>this</span>
  <span m='3099640'>is</span> <span m='3099760'>going</span> <span m='3100000'>to</span>
  <span m='3100090'>be</span> <span m='3100210'>essentially</span> <span m='3100780'>a</span>
  <span m='3101590'>fancy</span> <span m='3102520'>merge</span> <span m='3102820'>sort.</span>
  </p><p><span m='3129340'>This</span> <span m='3129605'>is</span> <span m='3129870'>done
  in</span> <span m='3129990'>the</span> <span m='3130080'>same</span> <span m='3130320'>paper.</span>
  <span m='3146560'>Before</span> <span m='3146860'>we</span> <span m='3146950'>said</span>
  <span m='3147190'>omega,</span> <span m='3148930'>I'm</span> <span m='3149080'>going</span>
  <span m='3149320'>to</span> <span m='3149800'>essentially</span> <span m='3150190'>make</span>
  <span m='3150370'>omega</span> <span m='3150910'>a</span> <span m='3150940'>little</span>
  <span m='3151180'>bit</span> <span m='3151300'>bigger</span> <span m='3151540'>than</span>
  <span m='3151750'>2.</span> <span m='3152290'>So</span> <span m='3152410'>I</span>
  <span m='3152440'>want</span> <span m='3152560'>to</span> <span m='3152620'>assume</span>
  <span m='3152860'>that</span> <span m='3152950'>w</span> <span m='3153220'>is</span>
  <span m='3153370'>at</span> <span m='3153430'>least</span> <span m='3153640'>twice</span>
  <span m='3154600'>b</span> <span m='3154800'>plus</span> <span m='3155150'>1</span>
  <span m='3155810'>log</span> <span m='3156130'>n</span> <span m='3156310'>log</span>
  <span m='3156600'>log n.</span> <span m='3156910'>That's</span> <span m='3157120'>just</span>
  <span m='3157330'>to</span> <span m='3157480'>make</span> <span m='3157660'>this</span>
  <span m='3158320'>convenient,</span> <span m='3158860'>but</span> <span m='3158980'>of</span>
  <span m='3159100'>course</span> <span m='3159340'>it</span> <span m='3159400'>doesn't</span>
  <span m='3159610'>really</span> <span m='3159820'>matter</span> <span m='3160710'>what</span>
  <span m='3160810'>the</span> <span m='3160900'>constants</span> <span m='3161320'>are.</span>
  <span m='3162220'>This will</span> <span m='3162400'>make</span> <span m='3162580'>everything</span>
  <span m='3162910'>fit</span> <span m='3163090'>in</span> <span m='3163240'>one</span>
  <span m='3163510'>word</span> <span m='3163750'>though,</span> <span m='3164080'>instead</span>
  <span m='3164350'>of</span> <span m='3164440'>a</span> <span m='3164470'>constant</span>
  <span m='3164800'>number</span> <span m='3165010'>of</span> <span m='3165070'>words.</span>
  </p><p><span m='3166410'>OK,</span> <span m='3166780'>step</span> <span m='3167080'>zero</span>
  <span m='3167620'>of</span> <span m='3167850'>this</span> <span m='3168280'>algorithm</span>
  <span m='3181420'>is</span> <span m='3182050'>the</span> <span m='3182190'>packing</span>
  <span m='3182640'>part.</span> <span m='3187260'>We</span> <span m='3187380'>can</span>
  <span m='3187560'>fit</span> <span m='3187800'>more</span> <span m='3187980'>than</span>
  <span m='3188100'>one</span> <span m='3188250'>element</span> <span m='3188880'>into</span>
  <span m='3189150'>each</span> <span m='3189300'>word.</span> <span m='3189780'>So</span>
  <span m='3190290'>put</span> <span m='3190470'>them</span> <span m='3190650'>in.</span>
  <span m='3192060'>Now,</span> <span m='3192180'>we</span> <span m='3192300'>have</span>
  <span m='3192930'>linear</span> <span m='3193230'>time</span> <span m='3193500'>overall.</span>
  <span m='3193860'>This</span> <span m='3194040'>is</span> <span m='3194160'>easy</span>
  <span m='3194400'>to</span> <span m='3194520'>do.</span> </p><p><span m='3196550'>You</span>
  <span m='3196710'>have</span> <span m='3196860'>some</span> <span m='3197100'>word</span>
  <span m='3197670'>already.</span> <span m='3200580'>Take</span> <span m='3200790'>those</span>
  <span m='3200970'>items,</span> <span m='3201630'>shift</span> <span m='3201930'>them</span>
  <span m='3202080'>left</span> <span m='3202620'>or</span> <span m='3202890'>in</span>
  <span m='3203070'>the</span> <span m='3203160'>next</span> <span m='3203430'>item,</span>
  <span m='3203940'>shift</span> <span m='3204180'>them</span> <span m='3204300'>left</span>
  <span m='3204630'>or</span> <span m='3204870'>in</span> <span m='3204960'>the</span>
  <span m='3205050'>next</span> <span m='3205260'>item,</span> <span m='3205530'>shift</span>
  <span m='3205770'>them</span> <span m='3205890'>left</span> <span m='3206160'>or</span>
  <span m='3206400'>in</span> <span m='3206490'>the</span> <span m='3206580'>next</span>
  <span m='3206800'>item.</span> <span m='3207440'>OK,</span> <span m='3208320'>linear</span>
  <span m='3208590'>time.</span> <span m='3210460'>So</span> <span m='3210540'>in</span>
  <span m='3210600'>the</span> <span m='3210720'>end</span> <span m='3211940'>what</span>
  <span m='3212040'>it's</span> <span m='3212130'>going</span> <span m='3212250'>to</span>
  <span m='3212310'>look</span> <span m='3212490'>like--</span> <span m='3213610'>oh,</span>
  <span m='3213740'>I</span> <span m='3213810'>also</span> <span m='3214050'>want</span>
  <span m='3214170'>to</span> <span m='3214230'>leave</span> <span m='3214500'>a</span>
  <span m='3214560'>0</span> <span m='3215040'>bit in</span> <span m='3215190'>between</span>
  <span m='3215520'>each</span> <span m='3215700'>of</span> <span m='3215760'>them.</span>
  <span m='3216810'>So</span> <span m='3216960'>we're</span> <span m='3217020'>going</span>
  <span m='3217140'>to</span> <span m='3217230'>have</span> <span m='3218580'>b.</span>
  <span m='3219390'>This</span> <span m='3219570'>is</span> <span m='3219660'>going</span>
  <span m='3219780'>to</span> <span m='3219870'>be</span> <span m='3220080'>x1</span>
  <span m='3221230'>here,</span> <span m='3223714'>x2,</span> <span m='3230640'>xn.</span>
  </p><p><span m='3233150'>Each</span> <span m='3233330'>of</span> <span m='3233390'>these</span>
  <span m='3233690'>is</span> <span m='3233840'>b</span> <span m='3234710'>bits</span>
  <span m='3234950'>long.</span> <span m='3235380'>And</span> <span m='3235480'>then</span>
  <span m='3235580'>we</span> <span m='3235680'>have</span> <span m='3235730'>one</span>
  <span m='3235940'>more</span> <span m='3236150'>bit.</span> <span m='3238940'>And</span>
  <span m='3239150'>in</span> <span m='3239270'>fact,</span> <span m='3239700'>the</span>
  <span m='3239800'>way</span> <span m='3239840'>we</span> <span m='3239930'>set</span>
  <span m='3240140'>things</span> <span m='3240380'>up</span> <span m='3240530'>this</span>
  <span m='3240710'>is</span> <span m='3240800'>only</span> <span m='3241010'>half</span>
  <span m='3241280'>the</span> <span m='3241400'>word.</span> <span m='3242130'>So</span>
  <span m='3242330'>there's</span> <span m='3242510'>another</span> <span m='3242870'>half</span>
  <span m='3243170'>over</span> <span m='3243350'>here,</span> <span m='3243690'>which</span>
  <span m='3243740'>is</span> <span m='3243800'>going</span> <span m='3243950'>to</span>
  <span m='3244040'>be</span> <span m='3244160'>all</span> <span m='3244340'>0</span>
  <span m='3244760'>for</span> <span m='3244910'>now.</span> </p><p><span m='3246470'>So</span>
  <span m='3246680'>we</span> <span m='3246800'>have</span> <span m='3247280'>one</span>
  <span m='3247520'>word</span> <span m='3247910'>contains--</span> <span m='3248890'>sorry,</span>
  <span m='3249080'>this</span> <span m='3249230'>is</span> <span m='3249320'>not</span>
  <span m='3249530'>n</span> <span m='3249740'>items.</span> <span m='3250680'>This</span>
  <span m='3250760'>is</span> <span m='3250880'>going</span> <span m='3251030'>to</span>
  <span m='3251120'>be</span> <span m='3252420'>log</span> <span m='3252740'>n</span>
  <span m='3252920'>log</span> <span m='3253130'>log</span> <span m='3253280'>n.</span>
  <span m='3255120'>Can't</span> <span m='3255320'>fit</span> <span m='3255470'>them</span>
  <span m='3255590'>all</span> <span m='3255800'>in</span> <span m='3255890'>one</span>
  <span m='3256040'>word.</span> <span m='3256220'>That</span> <span m='3256370'>would</span>
  <span m='3256570'>make</span> <span m='3256760'>life</span> <span m='3257000'>really</span>
  <span m='3257210'>easy.</span> </p><p><span m='3258220'>You</span> <span m='3258320'>can</span>
  <span m='3258350'>fit</span> <span m='3258530'>log</span> <span m='3258800'>n</span>
  <span m='3258920'>log log</span> <span m='3259340'>n</span> <span m='3259460'>items</span>
  <span m='3259700'>in</span> <span m='3259790'>the</span> <span m='3259880'>first</span>
  <span m='3260120'>word.</span> <span m='3260360'>Then</span> <span m='3260630'>the</span>
  <span m='3260720'>next</span> <span m='3260960'>word</span> <span m='3261680'>is</span>
  <span m='3261980'>the</span> <span m='3262070'>next</span> <span m='3262580'>log</span>
  <span m='3262820'>n</span> <span m='3262940'>log log</span> <span m='3263210'>n</span>
  <span m='3263390'>items</span> <span m='3263720'>and</span> <span m='3263810'>so</span>
  <span m='3263900'>on.</span> <span m='3265260'>Linear</span> <span m='3265670'>time</span>
  <span m='3265940'>to</span> <span m='3266060'>do</span> <span m='3266180'>that.</span>
  </p><p><span m='3270170'>Next</span> <span m='3270350'>step,</span> <span m='3272180'>this</span>
  <span m='3272330'>is</span> <span m='3272480'>an</span> <span m='3272600'>algorithm.</span>
  <span m='3273680'>It's</span> <span m='3273710'>not</span> <span m='3273860'>really</span>
  <span m='3274040'>a</span> <span m='3274100'>step.</span> <span m='3274430'>I</span>
  <span m='3274520'>should</span> <span m='3274670'>say</span> <span m='3274820'>these</span>
  <span m='3275030'>are</span> <span m='3275750'>things</span> <span m='3276050'>that</span>
  <span m='3276140'>we're</span> <span m='3277700'>able</span> <span m='3277940'>to</span>
  <span m='3278090'>do,</span> <span m='3278320'>and</span> <span m='3278390'>we're</span>
  <span m='3278480'>going</span> <span m='3278600'>to</span> <span m='3278660'>combine</span>
  <span m='3279050'>them</span> <span m='3279170'>in</span> <span m='3279230'>different</span>
  <span m='3279470'>ways.</span> <span m='3281380'>So</span> <span m='3281480'>the</span>
  <span m='3281580'>next</span> <span m='3281690'>thing</span> <span m='3281840'>to</span>
  <span m='3281960'>observe,</span> <span m='3282380'>this</span> <span m='3282560'>is</span>
  <span m='3282800'>sort</span> <span m='3283010'>of</span> <span m='3283070'>a</span>
  <span m='3283090'>bottom</span> <span m='3283460'>up</span> <span m='3284510'>perspective.</span>
  </p><p><span m='3286070'>So</span> <span m='3286160'>first</span> <span m='3286370'>thing</span>
  <span m='3286520'>we</span> <span m='3286580'>can</span> <span m='3286700'>do</span>
  <span m='3286790'>is</span> <span m='3286850'>pack</span> <span m='3287120'>things</span>
  <span m='3287330'>into</span> <span m='3287550'>word.</span> <span m='3288320'>Next</span>
  <span m='3288500'>thing</span> <span m='3288680'>we</span> <span m='3288800'>can</span>
  <span m='3288920'>do</span> <span m='3289370'>is</span> <span m='3289610'>merge</span>
  <span m='3290030'>two</span> <span m='3290210'>sorted</span> <span m='3290570'>words.</span>
  <span m='3292000'>Let's</span> <span m='3292130'>say</span> <span m='3292700'>they</span>
  <span m='3292850'>each</span> <span m='3293090'>have</span> <span m='3293300'>k</span>
  <span m='3293630'>items</span> <span m='3294170'>and</span> <span m='3294320'>k</span>
  <span m='3294670'>is at</span> <span m='3294740'>most</span> <span m='3294980'>log</span>
  <span m='3295310'>n</span> <span m='3295430'>log</span> <span m='3295640'>log</span>
  <span m='3295950'>n.</span> <span m='3304480'>And</span> <span m='3304690'>I</span>
  <span m='3304750'>want</span> <span m='3304870'>to</span> <span m='3304960'>merge</span>
  <span m='3305260'>them</span> <span m='3305560'>into</span> <span m='3306250'>one</span>
  <span m='3306640'>sorted</span> <span m='3307030'>word</span> <span m='3314020'>with</span>
  <span m='3314290'>two</span> <span m='3314520'>k</span> <span m='3315790'>elements.</span>
  <span m='3318970'>So</span> <span m='3319120'>I</span> <span m='3319180'>have</span>
  <span m='3319330'>two</span> <span m='3319570'>of</span> <span m='3319660'>these</span>
  <span m='3319840'>things</span> <span m='3320750'>and I'll</span> <span m='3321100'>merge</span>
  <span m='3321460'>them</span> <span m='3322060'>in</span> <span m='3322240'>sorted</span>
  <span m='3322570'>order.</span> </p><p><span m='3325330'>And</span> <span m='3325420'>when</span>
  <span m='3325570'>I</span> <span m='3325630'>did</span> <span m='3325780'>this</span>
  <span m='3325900'>packing,</span> <span m='3326320'>nothing's</span> <span m='3326600'>sorted.</span>
  <span m='3327160'>But</span> <span m='3327490'>don't</span> <span m='3327670'>worry</span>
  <span m='3327790'>about</span> <span m='3328000'>that</span> <span m='3328180'>at</span>
  <span m='3328270'>the</span> <span m='3328360'>moment.</span> <span m='3329170'>Just</span>
  <span m='3329320'>if</span> <span m='3329500'>I</span> <span m='3329560'>had</span>
  <span m='3329860'>two</span> <span m='3330190'>these</span> <span m='3330400'>words</span>
  <span m='3330670'>and</span> <span m='3330760'>suppose</span> <span m='3331690'>they</span>
  <span m='3331900'>were</span> <span m='3332050'>already</span> <span m='3332500'>sorted,</span>
  <span m='3334600'>then</span> <span m='3334780'>I</span> <span m='3334840'>want</span>
  <span m='3334990'>to</span> <span m='3335050'>merge</span> <span m='3335410'>them</span>
  <span m='3335650'>and</span> <span m='3336850'>make</span> <span m='3337120'>them</span>
  <span m='3337270'>still</span> <span m='3337550'>sorted.</span> <span m='3339610'>OK,</span>
  <span m='3340120'>I</span> <span m='3340240'>want</span> <span m='3340420'>x1</span>
  <span m='3340750'>to</span> <span m='3340840'>be</span> <span m='3340900'>less</span>
  <span m='3341080'>than</span> <span m='3341170'>x2</span> <span m='3341500'>and</span>
  <span m='3341620'>so</span> <span m='3341710'>on.</span> </p><p><span m='3344470'>How</span>
  <span m='3344650'>much</span> <span m='3344890'>time?</span> <span m='3345895'>It'd</span>
  <span m='3346330'>be</span> <span m='3346420'>cool</span> <span m='3346990'>if</span>
  <span m='3347080'>you</span> <span m='3347170'>could</span> <span m='3347290'>do</span>
  <span m='3347380'>this</span> <span m='3347530'>in</span> <span m='3347620'>constant</span>
  <span m='3348040'>time</span> <span m='3348340'>on</span> <span m='3348520'>a</span>
  <span m='3349030'>transdichotomous</span> <span m='3349780'>rem.</span> <span m='3349990'>You</span>
  <span m='3350050'>could</span> <span m='3350170'>do</span> <span m='3350290'>anything</span>
  <span m='3350710'>on</span> <span m='3350800'>a</span> <span m='3350840'>constant</span>
  <span m='3351080'>number</span> <span m='3351340'>of</span> <span m='3351400'>words</span>
  <span m='3351670'>in</span> <span m='3351760'>constant</span> <span m='3352090'>time.</span>
  <span m='3352990'>We're</span> <span m='3353140'>not</span> <span m='3353290'>going</span>
  <span m='3353410'>to</span> <span m='3353580'>achieve</span> <span m='3353710'>constant</span>
  <span m='3354040'>time,</span> <span m='3354240'>but</span> <span m='3354320'>we</span>
  <span m='3354400'>don't</span> <span m='3354550'>need</span> <span m='3354700'>to.</span>
  <span m='3355880'>We're</span> <span m='3355980'>going</span> <span m='3356000'>to</span>
  <span m='3356080'>do</span> <span m='3356260'>order</span> <span m='3356860'>log</span>
  <span m='3357420'>k</span> <span m='3357670'>time.</span> </p><p><span m='3361690'>ERIK
  DEMAINE:</span> <span m='3361780'>This</span> <span m='3361870'>is</span> <span
  m='3361960'>the</span> <span m='3362110'>hardest</span> <span m='3362410'>step</span>
  <span m='3362680'>of</span> <span m='3362770'>packed</span> <span m='3363020'>sorting,</span>
  <span m='3363610'>and</span> <span m='3363880'>I'm</span> <span m='3363940'>not</span>
  <span m='3364090'>going</span> <span m='3364240'>to</span> <span m='3364300'>tell</span>
  <span m='3364420'>you</span> <span m='3364510'>how</span> <span m='3364630'>to</span>
  <span m='3364750'>do</span> <span m='3364930'>it</span> <span m='3365230'>until</span>
  <span m='3365500'>later.</span> <span m='3366790'>I</span> <span m='3366850'>will</span>
  <span m='3367000'>tell</span> <span m='3367210'>you,</span> <span m='3367420'>don't</span>
  <span m='3367600'>worry.</span> <span m='3368890'>But</span> <span m='3369040'>this</span>
  <span m='3369250'>is</span> <span m='3369370'>going</span> <span m='3369640'>to</span>
  <span m='3369760'>require</span> <span m='3370790'>bitonic</span> <span m='3371350'>sorting.</span>
  <span m='3373210'>So</span> <span m='3373690'>I</span> <span m='3373720'>have</span>
  <span m='3373810'>to</span> <span m='3373900'>delay</span> <span m='3374200'>it</span>
  <span m='3374320'>a</span> <span m='3374380'>little</span> <span m='3374590'>bit.</span>
  </p><p><span m='3375650'>Suppose</span> <span m='3375970'>you</span> <span m='3376090'>had</span>
  <span m='3376300'>that</span> <span m='3376480'>for</span> <span m='3376630'>now.</span>
  <span m='3377320'>Let</span> <span m='3377470'>me</span> <span m='3377590'>tell</span>
  <span m='3377860'>you</span> <span m='3378040'>how</span> <span m='3378190'>the</span>
  <span m='3378310'>rest</span> <span m='3378610'>is</span> <span m='3378730'>easy.</span>
  <span m='3385900'>So</span> <span m='3386100'>many</span> <span m='3386310'>black</span>
  <span m='3386580'>boxes,</span> <span m='3387120'>but</span> <span m='3387480'>they're</span>
  <span m='3387630'>all</span> <span m='3387750'>filled</span> <span m='3388050'>in</span>
  <span m='3388290'>in this</span> <span m='3388440'>lecture.</span> </p><p><span
  m='3391660'>OK,</span> <span m='3395620'>next</span> <span m='3395830'>thing</span>
  <span m='3395950'>you</span> <span m='3396040'>might</span> <span m='3396220'>ask</span>
  <span m='3396550'>is,</span> <span m='3396770'>well,</span> <span m='3397060'>how</span>
  <span m='3397300'>do</span> <span m='3397510'>I</span> <span m='3397600'>get</span>
  <span m='3397810'>a</span> <span m='3397930'>sorted</span> <span m='3398380'>word?</span>
  <span m='3398860'>I</span> <span m='3398980'>see</span> <span m='3399190'>how</span>
  <span m='3399340'>to</span> <span m='3399430'>get</span> <span m='3399940'>a</span>
  <span m='3400030'>single</span> <span m='3400390'>word</span> <span m='3400660'>that</span>
  <span m='3400750'>has</span> <span m='3401340'>log</span> <span m='3401560'>n</span>
  <span m='3401680'>log log</span> <span m='3402000'>n</span> <span m='3402120'>items.</span>
  <span m='3402190'>But</span> <span m='3402490'>how</span> <span m='3402670'>would</span>
  <span m='3402790'>I</span> <span m='3402880'>sort</span> <span m='3403210'>those</span>
  <span m='3403420'>items?</span> <span m='3404640'>Use</span> <span m='3404860'>merge</span>
  <span m='3405130'>sort.</span> <span m='3406360'>Here's</span> <span m='3406660'>a</span>
  <span m='3406720'>merger.</span> <span m='3407410'>You</span> <span m='3407530'>have</span>
  <span m='3407800'>a</span> <span m='3407860'>way</span> <span m='3408070'>to</span>
  <span m='3408220'>merge</span> <span m='3408610'>two</span> <span m='3408790'>sorted</span>
  <span m='3409120'>lists,</span> <span m='3409810'>so</span> <span m='3409930'>use</span>
  <span m='3410110'>merge</span> <span m='3410350'>sort,</span> <span m='3410590'>that</span>
  <span m='3410740'>will</span> <span m='3410860'>give</span> <span m='3411040'>you</span>
  <span m='3411140'>a</span> <span m='3411160'>way</span> <span m='3411310'>to</span>
  <span m='3411520'>sort</span> <span m='3411760'>the</span> <span m='3411850'>whole</span>
  <span m='3412000'>thing.</span> </p><p><span m='3413270'>So</span> <span m='3413530'>I'm</span>
  <span m='3413650'>going</span> <span m='3413770'>to</span> <span m='3413860'>merge</span>
  <span m='3414130'>sort</span> <span m='3414860'>k</span> <span m='3415450'>equals</span>
  <span m='3415930'>log</span> <span m='3416350'>n</span> <span m='3417070'>log</span>
  <span m='3417490'>log</span> <span m='3417910'>n</span> <span m='3418060'>items</span>
  <span m='3423840'>into</span> <span m='3425280'>one</span> <span m='3425550'>sorted</span>
  <span m='3425940'>word.</span> <span m='3433050'>So</span> <span m='3433410'>I</span>
  <span m='3433530'>start</span> <span m='3433860'>out</span> <span m='3434010'>with</span>
  <span m='3434190'>a</span> <span m='3434250'>word</span> <span m='3434460'>that's</span>
  <span m='3434670'>unsorted.</span> <span m='3435690'>I</span> <span m='3435780'>do</span>
  <span m='3435960'>merge</span> <span m='3436230'>sort.</span> <span m='3437490'>And</span>
  <span m='3437800'>I</span> <span m='3438080'>sort</span> <span m='3438350'>them.</span>
  <span m='3440030'>So</span> <span m='3440220'>this</span> <span m='3440410'>is</span>
  <span m='3440520'>not</span> <span m='3440700'>the</span> <span m='3440790'>whole</span>
  <span m='3440910'>sorting</span> <span m='3441240'>problem</span> <span m='3441550'>but</span>
  <span m='3442370'>it's</span> <span m='3442620'>the</span> <span m='3442800'>one</span>
  <span m='3443220'>word</span> <span m='3443520'>sorting</span> <span m='3443850'>problem.</span>
  </p><p><span m='3445300'>So</span> <span m='3445440'>how</span> <span m='3445620'>long</span>
  <span m='3445790'>does</span> <span m='3445890'>this</span> <span m='3446040'>take?</span>
  <span m='3447060'>Well,</span> <span m='3447390'>it's</span> <span m='3447450'>usual</span>
  <span m='3447720'>merge</span> <span m='3447990'>sort</span> <span m='3448200'>recurrence,</span>
  <span m='3450020'>but</span> <span m='3450120'>then</span> <span m='3450270'>it's</span>
  <span m='3450390'>plus</span> <span m='3451380'>how</span> <span m='3451500'>long</span>
  <span m='3451710'>it</span> <span m='3451770'>takes</span> <span m='3452040'>me</span>
  <span m='3452160'>to</span> <span m='3452250'>split</span> <span m='3453630'>the</span>
  <span m='3453750'>word.</span> <span m='3454250'>Well,</span> <span m='3454350'>splitting</span>
  <span m='3454770'>the</span> <span m='3454800'>word</span> <span m='3455040'>is</span>
  <span m='3455160'>easy,</span> <span m='3455470'>you</span> <span m='3455550'>just</span>
  <span m='3455790'>mask</span> <span m='3456180'>out</span> <span m='3456540'>the</span>
  <span m='3456630'>low</span> <span m='3456900'>end</span> <span m='3457110'>or</span>
  <span m='3457230'>the</span> <span m='3457320'>high</span> <span m='3457560'>end</span>
  <span m='3458310'>and</span> <span m='3458460'>then</span> <span m='3458670'>maybe</span>
  <span m='3458850'>shift</span> <span m='3459120'>over.</span> <span m='3460140'>So</span>
  <span m='3460260'>in</span> <span m='3460320'>constant</span> <span m='3460680'>time</span>
  <span m='3461010'>I</span> <span m='3461100'>can</span> <span m='3461340'>get</span>
  <span m='3461610'>the</span> <span m='3462450'>left</span> <span m='3462690'>half</span>
  <span m='3462900'>and</span> <span m='3462990'>the</span> <span m='3463050'>right</span>
  <span m='3463200'>half</span> <span m='3463500'>of</span> <span m='3463620'>the</span>
  <span m='3464040'>array,</span> <span m='3464680'>which</span> <span m='3464760'>is</span>
  <span m='3464880'>the</span> <span m='3465030'>word.</span> </p><p><span m='3466230'>Then</span>
  <span m='3466380'>the</span> <span m='3466470'>hard</span> <span m='3466650'>part</span>
  <span m='3466890'>is</span> <span m='3467040'>merging</span> <span m='3467400'>them.</span>
  <span m='3467850'>And</span> <span m='3468000'>merging</span> <span m='3468330'>them</span>
  <span m='3468660'>is</span> <span m='3469020'>1,</span> <span m='3471380'>and</span>
  <span m='3471570'>that</span> <span m='3471720'>takes</span> <span m='3471980'>log</span>
  <span m='3472210'>k.</span> <span m='3474468'>So</span> <span m='3474960'>this</span>
  <span m='3475200'>is</span> <span m='3475820'>step</span> <span m='3476030'>one.</span>
  <span m='3477710'>That's</span> <span m='3477930'>our</span> <span m='3478020'>merger.</span>
  </p><p><span m='3479010'>And</span> <span m='3479160'>so</span> <span m='3479310'>what</span>
  <span m='3479430'>does</span> <span m='3479550'>this</span> <span m='3479670'>solve</span>
  <span m='3480000'>to?</span> <span m='3480560'>Well,</span> <span m='3481550'>probably</span>
  <span m='3481800'>easiest</span> <span m='3482130'>to</span> <span m='3482250'>draw</span>
  <span m='3482460'>the</span> <span m='3482580'>recursion</span> <span m='3483030'>tree.</span>
  <span m='3483600'>So</span> <span m='3483770'>at the</span> <span m='3483850'>root</span>
  <span m='3484060'>we</span> <span m='3484170'>pay</span> <span m='3484350'>log</span>
  <span m='3484620'>k.</span> <span m='3485550'>Then</span> <span m='3485670'>we</span>
  <span m='3485820'>have</span> <span m='3486240'>2</span> <span m='3486600'>times</span>
  <span m='3488040'>log</span> <span m='3490350'>k</span> <span m='3490620'>over</span>
  <span m='3490770'>2,</span> <span m='3492940'>log</span> <span m='3493110'>k</span>
  <span m='3493350'>over</span> <span m='3493470'>2.</span> <span m='3496770'>So</span>
  <span m='3497010'>at</span> <span m='3497100'>this</span> <span m='3497280'>level</span>
  <span m='3497550'>we're</span> <span m='3497700'>paying</span> <span m='3497940'>log</span>
  <span m='3498150'>k.</span> <span m='3500160'>At</span> <span m='3500280'>this</span>
  <span m='3500430'>level</span> <span m='3500670'>we're</span> <span m='3500790'>paying</span>
  <span m='3502290'>2</span> <span m='3503750'>log</span> <span m='3504090'>k</span>
  <span m='3505090'>minus</span> <span m='3505500'>1,</span> <span m='3505710'>I</span>
  <span m='3505800'>guess.</span> </p><p><span m='3508880'>I'm</span> <span m='3509190'>just</span>
  <span m='3509340'>going</span> <span m='3509490'>to</span> <span m='3509550'>call</span>
  <span m='3509700'>this</span> <span m='3509910'>maybe--</span> <span m='3510720'>yeah,</span>
  <span m='3510990'>I</span> <span m='3511110'>do</span> <span m='3511260'>need</span>
  <span m='3511410'>to</span> <span m='3511500'>do</span> <span m='3511620'>that.</span>
  <span m='3513480'>I</span> <span m='3513540'>mean</span> <span m='3513660'>everything</span>
  <span m='3513940'>is</span> <span m='3513990'>constant</span> <span m='3514350'>size</span>
  <span m='3514800'>so you</span> <span m='3514920'>pay a</span> <span m='3515190'>constant.</span>
  <span m='3516030'>How</span> <span m='3516180'>many</span> <span m='3516390'>leaves</span>
  <span m='3516690'>are</span> <span m='3516810'>there</span> <span m='3516960'>at</span>
  <span m='3517050'>the</span> <span m='3517140'>bottom</span> <span m='3517440'>level?</span>
  <span m='3519200'>k</span> <span m='3519940'>of</span> <span m='3520120'>them.</span>
  </p><p><span m='3522260'>OK,</span> <span m='3522690'>so</span> <span m='3522870'>at</span>
  <span m='3522930'>the</span> <span m='3523050'>root</span> <span m='3523260'>we're</span>
  <span m='3523350'>paying</span> <span m='3523600'>log</span> <span m='3523750'>k,</span>
  <span m='3524090'>at</span> <span m='3524250'>the</span> <span m='3524340'>leaves</span>
  <span m='3524610'>we're</span> <span m='3524670'>paying</span> <span m='3524950'>k.</span>
  <span m='3525750'>This</span> <span m='3525930'>is</span> <span m='3526080'>roughly</span>
  <span m='3526620'>geometric.</span> <span m='3527310'>There's</span> <span m='3527490'>this</span>
  <span m='3527610'>minus</span> <span m='3527940'>1,</span> <span m='3528300'>but</span>
  <span m='3528660'>it's</span> <span m='3528870'>geometric</span> <span m='3529380'>enough</span>
  <span m='3530540'>and</span> <span m='3530690'>when</span> <span m='3530820'>you</span>
  <span m='3530940'>add</span> <span m='3531180'>up</span> <span m='3531330'>all</span>
  <span m='3531480'>these</span> <span m='3531630'>levels</span> <span m='3532410'>it's</span>
  <span m='3532530'>dominated</span> <span m='3533040'>by</span> <span m='3533220'>k.</span>
  <span m='3534210'>So</span> <span m='3534360'>this</span> <span m='3534570'>ends</span>
  <span m='3534780'>up</span> <span m='3534900'>being</span> <span m='3535860'>order</span>
  <span m='3536150'>k</span> <span m='3536400'>time.</span> <span m='3539450'>The</span>
  <span m='3539700'>minus</span> <span m='3540090'>1 here</span> <span m='3540480'>turns</span>
  <span m='3540750'>out</span> <span m='3540840'>not</span> <span m='3541020'>to</span>
  <span m='3541140'>matter</span> <span m='3541380'>much.</span> <span m='3543860'>Cool.</span>
  </p><p><span m='3544710'>So</span> <span m='3544890'>this</span> <span m='3545070'>linear</span>
  <span m='3545460'>time</span> <span m='3545700'>sorting</span> <span m='3546230'>on</span>
  <span m='3546480'>log</span> <span m='3546800'>n</span> <span m='3546930'>log</span>
  <span m='3547210'>log</span> <span m='3547390'>n</span> <span m='3547500'>items.</span>
  <span m='3548110'>Everything</span> <span m='3548640'>it</span> <span m='3548690'>fits</span>
  <span m='3548890'>in</span> <span m='3548970'>a</span> <span m='3549030'>word.</span>
  <span m='3550050'>Cool,</span> <span m='3551240'>but</span> <span m='3551680'>we're</span>
  <span m='3551730'>not</span> <span m='3551880'>done</span> <span m='3552090'>yet.</span>
  <span m='3553060'>We</span> <span m='3553080'>need</span> <span m='3553410'>another</span>
  <span m='3553800'>level.</span> <span m='3556320'>The</span> <span m='3556410'>rest</span>
  <span m='3556620'>is</span> <span m='3556710'>pretty</span> <span m='3556950'>easy.</span>
  <span m='3559455'>It's</span> <span m='3559880'>just</span> <span m='3560310'>scaling</span>
  <span m='3560790'>up.</span> </p><p><span m='3594660'>OK,</span> <span m='3595790'>let's</span>
  <span m='3595940'>see.</span> <span m='3596540'>At</span> <span m='3596690'>this</span>
  <span m='3596900'>point</span> <span m='3598220'>we're</span> <span m='3598370'>going</span>
  <span m='3598480'>to</span> <span m='3598610'>assume</span> <span m='3599180'>that</span>
  <span m='3599750'>all</span> <span m='3600020'>of</span> <span m='3600140'>our</span>
  <span m='3600260'>words</span> <span m='3600530'>are</span> <span m='3600620'>completely</span>
  <span m='3601190'>full.</span> <span m='3602150'>So</span> <span m='3602300'>this</span>
  <span m='3602480'>merging</span> <span m='3602930'>and</span> <span m='3603050'>stuff</span>
  <span m='3603380'>was</span> <span m='3603530'>in</span> <span m='3603620'>order</span>
  <span m='3603830'>to</span> <span m='3603980'>fill</span> <span m='3604310'>up</span>
  <span m='3604880'>words</span> <span m='3605270'>and</span> <span m='3605390'>to</span>
  <span m='3605510'>make</span> <span m='3605690'>those</span> <span m='3605870'>words</span>
  <span m='3606160'>sorted.</span> <span m='3607310'>But</span> <span m='3607490'>once</span>
  <span m='3607730'>we've</span> <span m='3607880'>done</span> <span m='3608120'>that</span>
  <span m='3608300'>for</span> <span m='3608480'>each</span> <span m='3609320'>cluster</span>
  <span m='3609920'>of</span> <span m='3610190'>log</span> <span m='3610490'>n</span>
  <span m='3610640'>log</span> <span m='3610850'>log</span> <span m='3611060'>n</span>
  <span m='3611180'>items,</span> <span m='3612110'>now</span> <span m='3612260'>we</span>
  <span m='3612320'>can</span> <span m='3612450'>assume</span> <span m='3612680'>each</span>
  <span m='3612920'>word</span> <span m='3613130'>is</span> <span m='3613220'>sorted</span>
  <span m='3613910'>and</span> <span m='3614060'>completely</span> <span m='3614450'>full.</span>
  <span m='3614650'>It has</span> <span m='3614870'>exactly</span> <span m='3615350'>k</span>
  <span m='3616250'>elements</span> <span m='3616610'>in</span> <span m='3616760'>it.</span>
  <span m='3618150'>So</span> <span m='3618230'>each</span> <span m='3618440'>of</span>
  <span m='3618530'>these</span> <span m='3618710'>r</span> <span m='3618860'>sorted</span>
  <span m='3619160'>words</span> <span m='3620480'>has</span> <span m='3622090'>k</span>
  <span m='3623490'>elements.</span> </p><p><span m='3625540'>OK,</span> <span m='3625730'>so</span>
  <span m='3625880'>now</span> <span m='3626120'>the</span> <span m='3626240'>issue</span>
  <span m='3626510'>is</span> <span m='3626690'>things</span> <span m='3626900'>don't</span>
  <span m='3627080'>fit</span> <span m='3627290'>in</span> <span m='3627380'>a</span>
  <span m='3627440'>word.</span> <span m='3628100'>And</span> <span m='3628220'>so</span>
  <span m='3628340'>now</span> <span m='3628520'>suppose</span> <span m='3628880'>they</span>
  <span m='3628970'>fit</span> <span m='3629180'>in</span> <span m='3629390'>r</span>
  <span m='3629630'>sorted</span> <span m='3629990'>words.</span> <span m='3630410'>So
  supposed</span> <span m='3630740'>we've</span> <span m='3630890'>already</span>
  <span m='3631160'>made</span> <span m='3631370'>a</span> <span m='3631460'>sorted</span>
  <span m='3631850'>list</span> <span m='3632060'>of</span> <span m='3633620'>r</span>
  <span m='3633800'>times</span> <span m='3634100'>k</span> <span m='3634370'>items</span>
  <span m='3635120'>which</span> <span m='3635270'>fit</span> <span m='3635450'>in</span>
  <span m='3635570'>r</span> <span m='3635780'>words,</span> <span m='3636200'>each</span>
  <span m='3636440'>with</span> <span m='3636590'>k</span> <span m='3637100'>items</span>
  <span m='3637430'>in</span> <span m='3637550'>it.</span> <span m='3638720'>Then</span>
  <span m='3638960'>I</span> <span m='3639050'>want</span> <span m='3639230'>to</span>
  <span m='3639320'>take</span> <span m='3639620'>two</span> <span m='3639860'>of</span>
  <span m='3639920'>these</span> <span m='3640100'>lists</span> <span m='3640760'>and</span>
  <span m='3640880'>merge</span> <span m='3641150'>them</span> <span m='3641300'>together</span>
  <span m='3641720'>and</span> <span m='3641840'>get</span> <span m='3642050'>one</span>
  <span m='3642590'>sorted</span> <span m='3643070'>list</span> <span m='3643370'>of</span>
  <span m='3643460'>sorted</span> <span m='3643850'>words.</span> <span m='3644620'>So</span>
  <span m='3644930'>it's</span> <span m='3645980'>2</span> <span m='3646370'>rk</span>
  <span m='3646970'>items</span> <span m='3647540'>that</span> <span m='3647720'>are</span>
  <span m='3648110'>distributed</span> <span m='3648800'>into</span> <span m='3649520'>2r</span>
  <span m='3650060'>words,</span> <span m='3650570'>each</span> <span m='3650840'>of</span>
  <span m='3650900'>size</span> <span m='3651400'>k.</span> </p><p><span m='3653960'>How</span>
  <span m='3654050'>do</span> <span m='3654140'>I</span> <span m='3654200'>do</span>
  <span m='3654320'>that</span> <span m='3654470'>merge</span> <span m='3655700'>in</span>
  <span m='3656000'>linear</span> <span m='3656420'>time?</span> <span m='3657750'>And</span>
  <span m='3657860'>I</span> <span m='3657920'>only</span> <span m='3658160'>need</span>
  <span m='3658310'>to</span> <span m='3658400'>do</span> <span m='3658640'>it</span>
  <span m='3658790'>in</span> <span m='3659150'>r</span> <span m='3659510'>log</span>
  <span m='3660170'>k</span> <span m='3660270'>time,</span> <span m='3662060'>only.</span>
  <span m='3663700'>Yeah,</span> <span m='3664120'>question?</span> </p><p><span m='3664550'>AUDIENCE:</span>
  <span m='3664787'>I'm</span> <span m='3665025'>assuming</span> <span m='3665500'>k
  is the</span> <span m='3665975'>number</span> <span m='3666450'>of items</span>
  <span m='3666925'>per word?</span> </p><p><span m='3668860'>ERIK DEMAINE:</span>
  <span m='3668985'>Yeah,</span> <span m='3669110'>k</span> <span m='3669370'>is</span>
  <span m='3669620'>this</span> <span m='3670720'>from</span> <span m='3671060'>now</span>
  <span m='3671360'>on.</span> <span m='3672230'>And</span> <span m='3672380'>there
  are</span> <span m='3672470'>exactly</span> <span m='3673010'>k</span> <span m='3673490'>elements</span>
  <span m='3673880'>per</span> <span m='3674090'>word.</span> <span m='3676220'>We've</span>
  <span m='3676670'>already</span> <span m='3676910'>filled</span> <span m='3677180'>up</span>
  <span m='3677270'>the</span> <span m='3677420'>word</span> <span m='3677730'>so
  at</span> <span m='3677840'>this</span> <span m='3677960'>point</span> <span m='3678170'>we</span>
  <span m='3678260'>can</span> <span m='3678380'>assume</span> <span m='3678650'>that.</span>
  </p><p><span m='3679320'>AUDIENCE:</span> <span m='3679570'>But</span> <span m='3679820'>it's</span>
  <span m='3680320'>exactly equal,</span> <span m='3680820'>not less</span> <span
  m='3681320'>than.</span> </p><p><span m='3681820'>ERIK DEMAINE:</span> <span m='3682040'>Right.</span>
  </p><p><span m='3682260'>AUDIENCE:</span> <span m='3682478'>Because</span> <span
  m='3682696'>in one--</span> </p><p><span m='3683132'>ERIK DEMAINE:</span> <span
  m='3683351'>Yeah,</span> <span m='3683570'>over</span> <span m='3683840'>here</span>
  <span m='3683990'>it's</span> <span m='3684110'>less</span> <span m='3684320'>than</span>
  <span m='3684410'>or</span> <span m='3684480'>equal</span> <span m='3684680'>to.</span>
  <span m='3684830'>I</span> <span m='3684880'>know</span> <span m='3684990'>it's</span>
  <span m='3685130'>a</span> <span m='3685370'>little</span> <span m='3685550'>confusing.</span>
  <span m='3686090'>I</span> <span m='3686150'>use</span> <span m='3686330'>k</span>
  <span m='3686600'>for</span> <span m='3686770'>different--</span> <span m='3687290'>call</span>
  <span m='3687410'>this</span> <span m='3687530'>k</span> <span m='3687780'>prime.</span>
  <span m='3689280'>OK,</span> <span m='3690020'>and</span> <span m='3690170'>at</span>
  <span m='3690320'>this</span> <span m='3690530'>point</span> <span m='3690770'>we've</span>
  <span m='3690890'>filled</span> <span m='3691190'>up</span> <span m='3691340'>to</span>
  <span m='3691700'>this</span> <span m='3691940'>value</span> <span m='3692190'>of</span>
  <span m='3692270'>k.</span> <span m='3693080'>Now</span> <span m='3693290'>everything</span>
  <span m='3693590'>has</span> <span m='3693740'>exactly</span> <span m='3694220'>log</span>
  <span m='3694460'>n</span> <span m='3694580'>log</span> <span m='3694790'>log</span>
  <span m='3694970'>n</span> <span m='3695090'>items.</span> <span m='3695570'>Thanks.</span>
  <span m='3698120'>OK,</span> <span m='3699620'>let's</span> <span m='3699800'>see.</span>
  </p><p><span m='3702650'>A</span> <span m='3703160'>regular</span> <span m='3703520'>merging</span>
  <span m='3703910'>algorithm</span> <span m='3704240'>would</span> <span m='3704330'>take</span>
  <span m='3704570'>r</span> <span m='3704780'>times</span> <span m='3705080'>k</span>
  <span m='3705350'>time</span> <span m='3705590'>because</span> <span m='3705770'>they're</span>
  <span m='3705890'>r</span> <span m='3706070'>times</span> <span m='3706310'>k</span>
  <span m='3706550'>items.</span> <span m='3707970'>But</span> <span m='3708230'>we</span>
  <span m='3708530'>have</span> <span m='3709580'>this</span> <span m='3709790'>merger</span>
  <span m='3711350'>over</span> <span m='3711530'>here,</span> <span m='3711780'>which</span>
  <span m='3711860'>will</span> <span m='3711980'>merge</span> <span m='3712250'>two</span>
  <span m='3712460'>words</span> <span m='3712880'>in</span> <span m='3713090'>log</span>
  <span m='3713320'>k</span> <span m='3713570'>time.</span> <span m='3715040'>So</span>
  <span m='3715220'>that's</span> <span m='3715430'>why</span> <span m='3715610'>it's</span>
  <span m='3715730'>going</span> <span m='3715850'>to</span> <span m='3715940'>be</span>
  <span m='3716090'>r</span> <span m='3716290'>log</span> <span m='3716890'>k.</span>
  <span m='3718250'>What's</span> <span m='3718430'>the</span> <span m='3718520'>picture?</span>
  <span m='3719300'>Well,</span> <span m='3719910'>let me</span> <span m='3720030'>draw</span>
  <span m='3720300'>it.</span> </p><p><span m='3736900'>We</span> <span m='3737050'>have</span>
  <span m='3737530'>a</span> <span m='3737590'>list</span> <span m='3738520'>of</span>
  <span m='3738700'>words.</span> <span m='3741080'>A</span> <span m='3741130'>list</span>
  <span m='3741490'>of</span> <span m='3741580'>words.</span> <span m='3744040'>How</span>
  <span m='3744160'>do</span> <span m='3744280'>we</span> <span m='3744430'>merge?</span>
  <span m='3744880'>Well,</span> <span m='3745180'>we</span> <span m='3745300'>take</span>
  <span m='3745510'>the</span> <span m='3745630'>first</span> <span m='3745900'>two</span>
  <span m='3746080'>words,</span> <span m='3746920'>merge</span> <span m='3747250'>them.</span>
  <span m='3747880'>When</span> <span m='3748060'>we</span> <span m='3748210'>merge</span>
  <span m='3748540'>them</span> <span m='3748840'>and</span> <span m='3748930'>we</span>
  <span m='3749080'>know</span> <span m='3749230'>how</span> <span m='3749350'>to</span>
  <span m='3749470'>do</span> <span m='3749590'>this</span> <span m='3749800'>n</span>
  <span m='3749960'>log</span> <span m='3750330'>k</span> <span m='3750430'>time,</span>
  <span m='3750620'>that's</span> <span m='3751330'>step</span> <span m='3751570'>1.</span>
  <span m='3753220'>When</span> <span m='3753340'>we</span> <span m='3753460'>merge</span>
  <span m='3753730'>them</span> <span m='3753910'>we</span> <span m='3754060'>get</span>
  <span m='3754510'>two</span> <span m='3754750'>words,</span> <span m='3755080'>they</span>
  <span m='3755200'>just</span> <span m='3755440'>are</span> <span m='3755560'>now</span>
  <span m='3755740'>sorted.</span> </p><p><span m='3759100'>So</span> <span m='3759280'>we've</span>
  <span m='3759400'>got</span> <span m='3759580'>these</span> <span m='3759790'>two</span>
  <span m='3759940'>guys</span> <span m='3760180'>sorted</span> <span m='3761470'>and</span>
  <span m='3761620'>then</span> <span m='3761770'>there's</span> <span m='3761920'>the</span>
  <span m='3762040'>rest.</span> <span m='3763510'>I'd</span> <span m='3763810'>like</span>
  <span m='3763960'>to</span> <span m='3764050'>say</span> <span m='3764260'>output</span>
  <span m='3764620'>these</span> <span m='3764860'>and</span> <span m='3765160'>repeat,</span>
  <span m='3765610'>but</span> <span m='3765790'>that</span> <span m='3765970'>wouldn't</span>
  <span m='3766180'>be</span> <span m='3766300'>quite</span> <span m='3766510'>correct.</span>
  <span m='3768640'>Well,</span> <span m='3768970'>these</span> <span m='3769300'>guys</span>
  <span m='3769555'>I</span> <span m='3769810'>can</span> <span m='3769960'>output</span>
  <span m='3772810'>because</span> <span m='3772990'>I've</span> <span m='3773110'>got</span>
  <span m='3773880'>k</span> <span m='3774190'>items</span> <span m='3774490'>here,</span>
  <span m='3774980'>k items</span> <span m='3775270'>here.</span> <span m='3775520'>These</span>
  <span m='3775600'>are</span> <span m='3775690'>the</span> <span m='3775780'>k</span>
  <span m='3775990'>smallest</span> <span m='3776470'>among</span> <span m='3776740'>all</span>
  <span m='3776890'>of</span> <span m='3776950'>them.</span> <span m='3777590'>Those</span>
  <span m='3777820'>must</span> <span m='3778030'>be</span> <span m='3778180'>the</span>
  <span m='3778300'>overall</span> <span m='3778630'>smallest</span> <span m='3779050'>k</span>
  <span m='3779250'>items.</span> <span m='3780340'>Because</span> <span m='3780520'>I</span>
  <span m='3780620'>compared</span> <span m='3781000'>k</span> <span m='3781240'>with</span>
  <span m='3781390'>k.</span> </p><p><span m='3782050'>These</span> <span m='3782290'>higher</span>
  <span m='3782620'>k</span> <span m='3782830'>items,</span> <span m='3783250'>I</span>
  <span m='3783370'>don't</span> <span m='3783490'>know.</span> <span m='3784930'>They</span>
  <span m='3785260'>might</span> <span m='3785440'>be</span> <span m='3785590'>good</span>
  <span m='3785770'>or</span> <span m='3785830'>bad.</span> <span m='3786560'>So</span>
  <span m='3786580'>I</span> <span m='3786640'>have</span> <span m='3786820'>to</span>
  <span m='3786910'>put</span> <span m='3787120'>this</span> <span m='3788030'>high</span>
  <span m='3788480'>part</span> <span m='3789310'>back</span> <span m='3789760'>into</span>
  <span m='3790780'>one</span> <span m='3790960'>of</span> <span m='3791050'>these</span>
  <span m='3791260'>lists.</span> <span m='3792140'>You</span> <span m='3792540'>have</span>
  <span m='3792660'>to</span> <span m='3792730'>think</span> <span m='3792940'>a</span>
  <span m='3792970'>little</span> <span m='3793210'>bit</span> <span m='3793330'>about</span>
  <span m='3793540'>which</span> <span m='3793720'>list</span> <span m='3793900'>to</span>
  <span m='3793990'>put</span> <span m='3794170'>it</span> <span m='3794230'>into.</span>
  </p><p><span m='3794590'>Turns</span> <span m='3794860'>out</span> <span m='3795010'>if</span>
  <span m='3795100'>you</span> <span m='3795190'>look</span> <span m='3795370'>at</span>
  <span m='3795430'>the</span> <span m='3795520'>max</span> <span m='3795950'>item,</span>
  <span m='3796690'>say</span> <span m='3796870'>where</span> <span m='3797110'>did</span>
  <span m='3797230'>this</span> <span m='3797410'>come</span> <span m='3797620'>from,</span>
  <span m='3797830'>list</span> <span m='3798070'>one</span> <span m='3798280'>or
  list</span> <span m='3798540'>two?</span> <span m='3799450'>You</span> <span m='3799540'>put</span>
  <span m='3799750'>it</span> <span m='3799810'>into</span> <span m='3800020'>that</span>
  <span m='3800200'>list.</span> <span m='3800440'>Let's</span> <span m='3800590'>say</span>
  <span m='3800860'>this</span> <span m='3801040'>came</span> <span m='3801250'>from</span>
  <span m='3801480'>list</span> <span m='3802030'>two.</span> <span m='3802815'>And
  you</span> <span m='3803230'>put</span> <span m='3803380'>it</span> <span m='3803470'>back</span>
  <span m='3803680'>into</span> <span m='3803860'>list</span> <span m='3804070'>two</span>
  <span m='3804400'>and</span> <span m='3804520'>then</span> <span m='3804640'>repeat.</span>
  </p><p><span m='3805970'>OK,</span> <span m='3806230'>so</span> <span m='3806590'>in</span>
  <span m='3807460'>log</span> <span m='3807940'>k</span> <span m='3808040'>time</span>
  <span m='3808360'>here</span> <span m='3810160'>we</span> <span m='3810370'>have</span>
  <span m='3810760'>output</span> <span m='3811150'>k</span> <span m='3811420'>items.</span>
  <span m='3812710'>And</span> <span m='3812830'>so</span> <span m='3813010'>we</span>
  <span m='3813160'>end</span> <span m='3813340'>up</span> <span m='3814120'>with</span>
  <span m='3814270'>an</span> <span m='3814390'>r</span> <span m='3814600'>log</span>
  <span m='3814870'>k</span> <span m='3815110'>running</span> <span m='3815380'>time</span>
  <span m='3815590'>overall.</span> <span m='3816790'>OK, so</span> <span m='3817250'>it's</span>
  <span m='3817390'>like</span> <span m='3818590'>regular</span> <span m='3818920'>merge</span>
  <span m='3819160'>algorithm,</span> <span m='3819490'>except</span> <span m='3819790'>we</span>
  <span m='3819880'>use</span> <span m='3820750'>step</span> <span m='3821020'>one</span>
  <span m='3821620'>to</span> <span m='3821770'>merge</span> <span m='3822160'>words,</span>
  <span m='3823420'>and</span> <span m='3823570'>then</span> <span m='3823720'>there's</span>
  <span m='3823830'>a</span> <span m='3823870'>little</span> <span m='3824080'>bit</span>
  <span m='3824200'>of</span> <span m='3824350'>work.</span> </p><p><span m='3825690'>This</span>
  <span m='3825880'>is</span> <span m='3826000'>like</span> <span m='3826450'>old</span>
  <span m='3826660'>merging</span> <span m='3826990'>algorithm,</span> <span m='3827320'>right?</span>
  <span m='3827470'>You</span> <span m='3827530'>take</span> <span m='3827740'>the</span>
  <span m='3827910'>min</span> <span m='3828430'>and</span> <span m='3828520'>you</span>
  <span m='3828640'>put</span> <span m='3828820'>the</span> <span m='3828910'>max</span>
  <span m='3829210'>back</span> <span m='3829480'>in.</span> <span m='3830770'>Except</span>
  <span m='3831010'>now</span> <span m='3831250'>the</span> <span m='3831370'>max</span>
  <span m='3831700'>is</span> <span m='3831820'>a</span> <span m='3831910'>whole</span>
  <span m='3832480'>word.</span> <span m='3835040'>OK</span> <span m='3836410'>that's</span>
  <span m='3836620'>how</span> <span m='3836740'>we</span> <span m='3836890'>merge.</span>
  </p><p><span m='3838030'>Now,</span> <span m='3838150'>why</span> <span m='3838360'>did</span>
  <span m='3838450'>we</span> <span m='3838600'>do</span> <span m='3838750'>a</span>
  <span m='3838810'>merger?</span> <span m='3839260'>Because</span> <span m='3839920'>next</span>
  <span m='3840160'>thing</span> <span m='3840310'>we</span> <span m='3840400'>do</span>
  <span m='3840640'>is</span> <span m='3840810'>merge</span> <span m='3841340'>sort.</span>
  <span m='3860250'>And</span> <span m='3860460'>this</span> <span m='3860670'>is</span>
  <span m='3860820'>the</span> <span m='3861000'>overall</span> <span m='3861390'>algorithm.</span>
  <span m='3862160'>It's</span> <span m='3862350'>one</span> <span m='3862560'>merge</span>
  <span m='3862800'>sort.</span> <span m='3863070'>We're</span> <span m='3863130'>going</span>
  <span m='3863250'>to</span> <span m='3863310'>use</span> <span m='3863460'>this</span>
  <span m='3863700'>is</span> <span m='3863820'>the</span> <span m='3863910'>merger</span>
  <span m='3864750'>and</span> <span m='3864870'>we're</span> <span m='3864930'>going</span>
  <span m='3865040'>to</span> <span m='3865110'>use</span> <span m='3865320'>this</span>
  <span m='3865590'>as</span> <span m='3865710'>the</span> <span m='3865830'>base</span>
  <span m='3866100'>case.</span> </p><p><span m='3866650'>So</span> <span m='3866700'>it's</span>
  <span m='3866820'>actually</span> <span m='3867150'>two</span> <span m='3868470'>recursive</span>
  <span m='3869010'>levels</span> <span m='3869400'>of</span> <span m='3869520'>merge</span>
  <span m='3869890'>sort.</span> <span m='3870110'>Merge</span> <span m='3870380'>sort
  is</span> <span m='3870600'>recursive</span> <span m='3871710'>within</span> <span
  m='3872010'>step</span> <span m='3872280'>four</span> <span m='3872580'>for</span>
  <span m='3872730'>a</span> <span m='3872760'>while,</span> <span m='3873390'>until</span>
  <span m='3873750'>we</span> <span m='3873840'>get</span> <span m='3873990'>down</span>
  <span m='3874200'>to</span> <span m='3874290'>the</span> <span m='3874350'>level</span>
  <span m='3874680'>of</span> <span m='3874770'>a</span> <span m='3874800'>single</span>
  <span m='3875190'>word.</span> <span m='3875940'>Then</span> <span m='3876120'>we</span>
  <span m='3876240'>use</span> <span m='3876420'>this</span> <span m='3876660'>thing</span>
  <span m='3876840'>to</span> <span m='3876930'>deal</span> <span m='3877140'>with</span>
  <span m='3877260'>things</span> <span m='3877500'>in</span> <span m='3877590'>a</span>
  <span m='3877650'>single</span> <span m='3877980'>word.</span> <span m='3882580'>So</span>
  <span m='3883320'>we</span> <span m='3883530'>end</span> <span m='3883740'>up</span>
  <span m='3883980'>with</span> <span m='3884290'>t of</span> <span m='3884585'>n</span>
  <span m='3885960'>is</span> <span m='3886140'>2</span> <span m='3886500'>times</span>
  <span m='3886860'>t</span> <span m='3886990'>of</span> <span m='3887060'>n</span>
  <span m='3887240'>over</span> <span m='3887430'>2</span> <span m='3889230'>plus</span>
  <span m='3891500'>n</span> <span m='3891900'>over</span> <span m='3892220'>k</span>
  <span m='3892950'>log</span> <span m='3893610'>k.</span> <span m='3895890'>And</span>
  <span m='3896100'>base</span> <span m='3896430'>case</span> <span m='3896970'>of</span>
  <span m='3897380'>t</span> <span m='3897650'>of</span> <span m='3897750'>k</span>
  <span m='3898980'>is</span> <span m='3899190'>order</span> <span m='3899600'>k.</span>
  </p><p><span m='3907350'>Why</span> <span m='3907800'>is</span> <span m='3907920'>it</span>
  <span m='3908040'>all</span> <span m='3908190'>this?</span> <span m='3908670'>This</span>
  <span m='3909150'>thing</span> <span m='3911100'>is</span> <span m='3911480'>r.</span>
  <span m='3915450'>So</span> <span m='3915630'>we</span> <span m='3915690'>have</span>
  <span m='3915900'>r log</span> <span m='3916320'>k</span> <span m='3916800'>to</span>
  <span m='3916980'>do</span> <span m='3917370'>a</span> <span m='3917775'>merge.</span>
  <span m='3918180'>r</span> <span m='3918420'>here</span> <span m='3918690'>is</span>
  <span m='3918810'>n over</span> <span m='3919140'>k.</span> </p><p><span m='3920430'>Why</span>
  <span m='3920730'>is it</span> <span m='3920850'>n</span> <span m='3921030'>over</span>
  <span m='3921190'>k?</span> <span m='3924250'>Because</span> <span m='3924870'>n</span>
  <span m='3925140'>is</span> <span m='3925260'>the</span> <span m='3925350'>total</span>
  <span m='3925620'>number</span> <span m='3925830'>of</span> <span m='3925920'>items.</span>
  <span m='3926190'>We</span> <span m='3926250'>had</span> <span m='3926370'>r</span>
  <span m='3926550'>times</span> <span m='3926820'>k</span> <span m='3927060'>items,</span>
  <span m='3927340'>so</span> <span m='3927620'>n</span> <span m='3927870'>equals</span>
  <span m='3928140'>rk.</span> <span m='3929190'>So</span> <span m='3929400'>r</span>
  <span m='3929640'>equals</span> <span m='3929910'>n over</span> <span m='3930180'>k.</span>
  <span m='3931040'>That's</span> <span m='3931320'>that.</span> </p><p><span m='3932220'>So</span>
  <span m='3932340'>this</span> <span m='3932550'>is</span> <span m='3932640'>our</span>
  <span m='3932730'>merge</span> <span m='3933000'>cost.</span> <span m='3933260'>This</span>
  <span m='3933450'>is</span> <span m='3933570'>the</span> <span m='3933660'>cost</span>
  <span m='3933990'>of</span> <span m='3934110'>3,</span> <span m='3935490'>this</span>
  <span m='3935700'>is</span> <span m='3935910'>the</span> <span m='3936060'>cost</span>
  <span m='3936450'>of</span> <span m='3936670'>2.</span> <span m='3938160'>If</span>
  <span m='3939150'>we</span> <span m='3939300'>have</span> <span m='3939720'>only</span>
  <span m='3940080'>log</span> <span m='3940350'>n</span> <span m='3940440'>log log</span>
  <span m='3940780'>n</span> <span m='3940920'>items,</span> <span m='3941920'>so</span>
  <span m='3942010'>k</span> <span m='3942270'>items,</span> <span m='3943320'>then</span>
  <span m='3943800'>we</span> <span m='3944010'>can</span> <span m='3946260'>sort</span>
  <span m='3946590'>in</span> <span m='3946740'>linear</span> <span m='3946980'>time.</span>
  <span m='3948150'>So</span> <span m='3948360'>we</span> <span m='3948450'>just</span>
  <span m='3948600'>need</span> <span m='3948750'>to</span> <span m='3948810'>solve</span>
  <span m='3949080'>this</span> <span m='3949260'>recurrence.</span> <span m='3952990'>Well,</span>
  <span m='3954745'>how's</span> <span m='3955200'>it</span> <span m='3955290'>going</span>
  <span m='3955410'>to</span> <span m='3955470'>work?</span> <span m='3956820'>It's</span>
  <span m='3956910'>going</span> <span m='3957090'>to</span> <span m='3957150'>be</span>
  <span m='3957210'>kind</span> <span m='3957690'>of</span> <span m='3957750'>like</span>
  <span m='3958020'>merge</span> <span m='3958260'>sort,</span> <span m='3958780'>but</span>
  <span m='3958920'>not</span> <span m='3959100'>quite.</span> <span m='3961050'>Question?</span>
  </p><p><span m='3964700'>AUDIENCE:</span> <span m='3964822'>When</span> <span m='3964944'>you</span>
  <span m='3965066'>say--</span> <span m='3965190'>so you have--</span> <span m='3965680'>it's
  definitely</span> <span m='3966170'>merging</span> <span m='3967150'>two</span>
  <span m='3967640'>lists of</span> <span m='3968130'>sorted words</span> <span m='3968620'>into</span>
  <span m='3969110'>one sorted list</span> <span m='3969600'>of two</span> <span m='3970090'>words.</span>
  <span m='3971070'>[INAUDIBLE]?</span> <span m='3976950'>You</span> <span m='3977440'>may
  have to</span> <span m='3977930'>do that,</span> <span m='3978420'>right?</span>
  </p><p><span m='3981870'>ERIK DEMAINE:</span> <span m='3981980'>Say</span> <span
  m='3982090'>that</span> <span m='3982200'>again.</span> </p><p><span m='3982440'>AUDIENCE:</span>
  <span m='3982557'>So</span> <span m='3982674'>you</span> <span m='3982791'>have</span>
  <span m='3982909'>two</span> <span m='3983378'>sorted--</span> <span m='3984316'>two</span>
  <span m='3984785'>sorted</span> <span m='3985254'>lists of</span> <span m='3985723'>R
  sorted</span> <span m='3986192'>words.</span> </p><p><span m='3987600'>ERIK DEMAINE:</span>
  <span m='3987690'>The</span> <span m='3987780'>words</span> <span m='3988120'>are</span>
  <span m='3988650'>going</span> <span m='3988800'>to</span> <span m='3988890'>change,</span>
  <span m='3989460'>which</span> <span m='3989700'>elements</span> <span m='3990060'>are</span>
  <span m='3990120'>in</span> <span m='3990210'>which</span> <span m='3990390'>words</span>
  <span m='3990600'>are</span> <span m='3990690'>changing.</span> <span m='3991530'>But</span>
  <span m='3991710'>that's</span> <span m='3992040'>thanks</span> <span m='3992550'>to</span>
  <span m='3993090'>step</span> <span m='3993450'>one,</span> <span m='3995760'>for</span>
  <span m='3995910'>example.</span> <span m='3996300'>I</span> <span m='3996390'>mean,</span>
  <span m='3996600'>step</span> <span m='3996870'>one</span> <span m='3997160'>can</span>
  <span m='3997290'>merge</span> <span m='3997650'>any</span> <span m='3997890'>two</span>
  <span m='3998070'>sorted</span> <span m='3998370'>words</span> <span m='3998640'>and</span>
  <span m='3998730'>make</span> <span m='3998910'>one</span> <span m='3999360'>sorted</span>
  <span m='3999810'>word.</span> <span m='4001070'>Or</span> <span m='4001220'>actually,</span>
  <span m='4004080'>one</span> <span m='4004400'>sorted</span> <span m='4004700'>word.</span>
  <span m='4005180'>In</span> <span m='4005300'>our</span> <span m='4005420'>case,</span>
  <span m='4006790'>we're</span> <span m='4006940'>going</span> <span m='4007090'>to</span>
  <span m='4007160'>get</span> <span m='4007310'>two</span> <span m='4007530'>sorted</span>
  <span m='4007880'>words.</span> <span m='4008360'>That</span> <span m='4008480'>was</span>
  <span m='4008660'>the</span> <span m='4008750'>picture</span> <span m='4009050'>over</span>
  <span m='4009230'>here.</span> </p><p><span m='4009840'>I</span> <span m='4010000'>merge</span>
  <span m='4010290'>the</span> <span m='4010370'>two</span> <span m='4010550'>guys.</span>
  <span m='4011510'>I</span> <span m='4011600'>could</span> <span m='4011840'>represent</span>
  <span m='4012290'>it as</span> <span m='4012500'>one</span> <span m='4012950'>word</span>
  <span m='4013160'>that's</span> <span m='4013430'>kind</span> <span m='4013610'>of</span>
  <span m='4013700'>double</span> <span m='4014030'>full,</span> <span m='4014720'>and</span>
  <span m='4014840'>then</span> <span m='4014930'>I</span> <span m='4014990'>can</span>
  <span m='4015110'>split</span> <span m='4015410'>that</span> <span m='4015590'>into</span>
  <span m='4015830'>two</span> <span m='4016040'>words.</span> <span m='4017420'>So</span>
  <span m='4017660'>we</span> <span m='4017870'>again</span> <span m='4018080'>need</span>
  <span m='4018260'>the</span> <span m='4018350'>split</span> <span m='4018650'>operation,</span>
  <span m='4019190'>but</span> <span m='4019310'>split</span> <span m='4019700'>is</span>
  <span m='4019880'>just</span> <span m='4022100'>a</span> <span m='4022130'>mask</span>
  <span m='4022940'>these</span> <span m='4023120'>guys</span> <span m='4023390'>out</span>
  <span m='4024380'>and</span> <span m='4024530'>you</span> <span m='4024620'>get</span>
  <span m='4024830'>the</span> <span m='4024950'>high</span> <span m='4025160'>part.</span>
  <span m='4025760'>This</span> <span m='4026000'>is</span> <span m='4026120'>all</span>
  <span m='4026270'>0.</span> <span m='4027090'>Then</span> <span m='4027230'>you</span>
  <span m='4027320'>shift</span> <span m='4027550'>it</span> <span m='4027650'>over</span>
  <span m='4027830'>to</span> <span m='4027890'>the</span> <span m='4027980'>left,</span>
  <span m='4029480'>now</span> <span m='4029740'>you've</span> <span m='4029910'>got</span>
  <span m='4030020'>the</span> <span m='4030320'>high</span> <span m='4030620'>word</span>
  <span m='4031430'>over</span> <span m='4031730'>the</span> <span m='4031790'>single</span>
  <span m='4032090'>word.</span> </p><p><span m='4034130'>So</span> <span m='4034340'>they're</span>
  <span m='4034640'>shuffling</span> <span m='4035240'>within</span> <span m='4035540'>those</span>
  <span m='4035720'>two</span> <span m='4035930'>words,</span> <span m='4037230'>or</span>
  <span m='4037490'>within</span> <span m='4037790'>one</span> <span m='4038000'>word,</span>
  <span m='4038330'>essentially,</span> <span m='4039620'>via</span> <span m='4039920'>this</span>
  <span m='4040100'>procedure,</span> <span m='4040980'>which</span> <span m='4041060'>we</span>
  <span m='4041180'>haven't</span> <span m='4041390'>covered.</span> <span m='4042940'>So</span>
  <span m='4043120'>everything</span> <span m='4043290'>is</span> <span m='4043480'>going</span>
  <span m='4043610'>to</span> <span m='4043700'>mix</span> <span m='4043940'>around.</span>
  <span m='4044400'>But</span> <span m='4044420'>then</span> <span m='4044600'>there's</span>
  <span m='4044750'>the</span> <span m='4044870'>low</span> <span m='4045170'>items</span>
  <span m='4045560'>and</span> <span m='4045650'>the</span> <span m='4045710'>high</span>
  <span m='4045980'>items.</span> <span m='4047150'>And</span> <span m='4047270'>so</span>
  <span m='4047450'>all</span> <span m='4047660'>the</span> <span m='4047780'>items</span>
  <span m='4048050'>in</span> <span m='4048140'>here</span> <span m='4048440'>are</span>
  <span m='4048500'>less</span> <span m='4048780'>than</span> <span m='4048890'>all</span>
  <span m='4048980'>of</span> <span m='4049040'>the</span> <span m='4049130'>items</span>
  <span m='4049430'>in</span> <span m='4049520'>here.</span> <span m='4052080'>Other</span>
  <span m='4052220'>questions?</span> <span m='4053630'>Cool.</span> </p><p><span
  m='4054980'>So</span> <span m='4055160'>I</span> <span m='4055220'>need</span> <span
  m='4055340'>to</span> <span m='4055430'>solve</span> <span m='4055700'>this</span>
  <span m='4055850'>recurrence.</span> <span m='4057150'>So</span> <span m='4057560'>let's</span>
  <span m='4058050'>draw</span> <span m='4058150'>another</span> <span m='4058250'>recursion</span>
  <span m='4058670'>tree.</span> <span m='4060040'>That's</span> <span m='4060220'>the
  east</span> <span m='4060350'>way</span> <span m='4060770'>to</span> <span m='4060830'>solve</span>
  <span m='4061160'>recurrences.</span> <span m='4062250'>Root</span> <span m='4062480'>is</span>
  <span m='4062690'>n</span> <span m='4062850'>over</span> <span m='4063020'>k</span>
  <span m='4063250'>log</span> <span m='4063460'>k.</span> </p><p><span m='4064970'>Next</span>
  <span m='4065360'>level</span> <span m='4065750'>down,</span> <span m='4067030'>see</span>
  <span m='4067240'>n</span> <span m='4067490'>got</span> <span m='4067670'>divided</span>
  <span m='4068030'>by</span> <span m='4068210'>2.</span> <span m='4068750'>So</span>
  <span m='4068870'>it's</span> <span m='4068960'>going</span> <span m='4069110'>to</span>
  <span m='4069170'>be</span> <span m='4069320'>1/2</span> <span m='4070610'>n</span>
  <span m='4070760'>over</span> <span m='4070930'>k</span> <span m='4071368'>log k,</span>
  <span m='4073560'>1/2</span> <span m='4074780'>n</span> <span m='4074900'>over</span>
  <span m='4075060'>k</span> <span m='4075320'>log</span> <span m='4075560'>k,</span>
  <span m='4077690'>because</span> <span m='4077945'>the n</span> <span m='4078200'>gets</span>
  <span m='4078350'>divided</span> <span m='4078650'>by</span> <span m='4078770'>2.</span>
  <span m='4079460'>So</span> <span m='4079580'>if</span> <span m='4079670'>I</span>
  <span m='4079730'>add</span> <span m='4080000'>up</span> <span m='4080270'>everything</span>
  <span m='4080630'>on</span> <span m='4080750'>this</span> <span m='4080900'>level,</span>
  <span m='4081410'>I</span> <span m='4081500'>get</span> <span m='4081790'>n</span>
  <span m='4081980'>over</span> <span m='4082190'>k</span> <span m='4082932'>log</span>
  <span m='4083314'>k.</span> <span m='4084080'>And</span> <span m='4084230'>in</span>
  <span m='4084320'>general</span> <span m='4084710'>as</span> <span m='4084890'>I</span>
  <span m='4084980'>go</span> <span m='4085100'>down,</span> <span m='4086270'>all</span>
  <span m='4086480'>levels</span> <span m='4086870'>are</span> <span m='4086930'>going</span>
  <span m='4087140'>to</span> <span m='4087560'>sum</span> <span m='4087830'>to</span>
  <span m='4087950'>this</span> <span m='4088070'>same</span> <span m='4088370'>value,</span>
  <span m='4088700'>n</span> <span m='4088880'>over</span> <span m='4089050'>k</span>
  <span m='4089240'>log</span> <span m='4089440'>k.</span> <span m='4090080'>So</span>
  <span m='4090230'>up</span> <span m='4090410'>here</span> <span m='4090960'>we</span>
  <span m='4091150'>are</span> <span m='4091250'>going</span> <span m='4091490'>to</span>
  <span m='4091580'>have</span> <span m='4091760'>a</span> <span m='4091820'>cost</span>
  <span m='4092790'>of</span> <span m='4093230'>n over</span> <span m='4093440'>k</span>
  <span m='4094172'>log</span> <span m='4094664'>k</span> <span m='4096140'>times</span>
  <span m='4097010'>the</span> <span m='4097160'>number</span> <span m='4097580'>of</span>
  <span m='4097700'>levels.</span> </p><p><span m='4098120'>Now,</span> <span m='4098330'>this</span>
  <span m='4098510'>is</span> <span m='4098630'>where</span> <span m='4098779'>it's</span>
  <span m='4098899'>a</span> <span m='4098930'>little</span> <span m='4099170'>tricky.</span>
  <span m='4100069'>It's</span> <span m='4100130'>not</span> <span m='4100370'>log</span>
  <span m='4100680'>n</span> <span m='4100790'>levels</span> <span m='4101180'>like</span>
  <span m='4101330'>regular</span> <span m='4101660'>merge</span> <span m='4101899'>sort.</span>
  <span m='4102080'>We</span> <span m='4102229'>stop</span> <span m='4102770'>at</span>
  <span m='4102890'>level</span> <span m='4103189'>k.</span> <span m='4105010'>So</span>
  <span m='4105080'>it's</span> <span m='4105170'>going</span> <span m='4105319'>to</span>
  <span m='4105410'>be</span> <span m='4105529'>log</span> <span m='4107140'>of</span>
  <span m='4107390'>n</span> <span m='4107540'>over</span> <span m='4107760'>k.</span>
  <span m='4113050'>That's</span> <span m='4113330'>the</span> <span m='4113450'>number</span>
  <span m='4113750'>of</span> <span m='4114529'>levels</span> <span m='4114920'>we</span>
  <span m='4115010'>get</span> <span m='4115160'>to.</span> </p><p><span m='4115370'>Now</span>
  <span m='4115580'>at</span> <span m='4115729'>the</span> <span m='4115819'>leaf</span>
  <span m='4116120'>level</span> <span m='4117600'>finally</span> <span m='4117890'>we</span>
  <span m='4118040'>have</span> <span m='4118460'>things</span> <span m='4118850'>of</span>
  <span m='4119870'>size</span> <span m='4120170'>order</span> <span m='4120380'>k,</span>
  <span m='4120939'>and</span> <span m='4121620'>we</span> <span m='4121729'>only</span>
  <span m='4121910'>pay</span> <span m='4122180'>order</span> <span m='4122450'>k.</span>
  <span m='4124020'>Great.</span> <span m='4126470'>And</span> <span m='4126740'>then</span>
  <span m='4126920'>how</span> <span m='4127069'>many</span> <span m='4127279'>leaves</span>
  <span m='4127580'>are</span> <span m='4127750'>there?</span> <span m='4128915'>There's</span>
  <span m='4129340'>n</span> <span m='4129520'>over</span> <span m='4129729'>k</span>
  <span m='4129979'>leaves.</span> <span m='4136460'>OK.</span> <span m='4136729'>So,</span>
  <span m='4136910'>that's</span> <span m='4137270'>an</span> <span m='4137390'>order</span>
  <span m='4137600'>n</span> <span m='4137810'>cost.</span> <span m='4140050'>This</span>
  <span m='4140460'>is</span> <span m='4140715'>order</span> <span m='4140970'>k,</span>
  <span m='4141744'>that's</span> <span m='4142029'>n</span> <span m='4142279'>over</span>
  <span m='4142500'>k,</span> <span m='4143470'>order</span> <span m='4143950'>n.</span>
  </p><p><span m='4145640'>What's</span> <span m='4146000'>this</span> <span m='4146300'>thing?</span>
  <span m='4148715'>Well,</span> <span m='4149010'>what's</span> <span m='4149240'>k?</span>
  <span m='4149779'>k</span> <span m='4150200'>was</span> <span m='4150410'>log</span>
  <span m='4150859'>n</span> <span m='4151550'>log</span> <span m='4151880'>log</span>
  <span m='4152120'>n.</span> <span m='4152840'>So</span> <span m='4152960'>this</span>
  <span m='4153200'>is</span> <span m='4153350'>n</span> <span m='4154130'>divided</span>
  <span m='4154460'>by</span> <span m='4154640'>log</span> <span m='4154970'>n</span>
  <span m='4155090'>log</span> <span m='4155330'>log</span> <span m='4155540'>n.</span>
  <span m='4156680'>This,</span> <span m='4157069'>therefore,</span> <span m='4157729'>is</span>
  <span m='4157970'>approximately</span> <span m='4158630'>log</span> <span m='4158930'>log</span>
  <span m='4159140'>n.</span> </p><p><span m='4160130'>So</span> <span m='4160310'>that</span>
  <span m='4160490'>log</span> <span m='4160729'>log</span> <span m='4160910'>n</span>
  <span m='4161250'>cancels</span> <span m='4161510'>this</span> <span m='4161720'>one.</span>
  <span m='4162330'>This</span> <span m='4162500'>is</span> <span m='4162620'>approximately</span>
  <span m='4163279'>log</span> <span m='4163609'>n,</span> <span m='4164630'>so</span>
  <span m='4164750'>that</span> <span m='4164870'>cancels</span> <span m='4165260'>with</span>
  <span m='4165380'>this</span> <span m='4165560'>one.</span> <span m='4166065'>So</span>
  <span m='4166330'>this</span> <span m='4166479'>is</span> <span m='4166950'>order</span>
  <span m='4167220'>n.</span> <span m='4169340'>That's</span> <span m='4169550'>why</span>
  <span m='4169760'>we</span> <span m='4170540'>chose</span> <span m='4170810'>these</span>
  <span m='4170960'>values.</span> </p><p><span m='4172279'>So</span> <span m='4172430'>this</span>
  <span m='4172609'>n over</span> <span m='4172920'>k</span> <span m='4173090'>was</span>
  <span m='4173240'>not</span> <span m='4173390'>actually</span> <span m='4173630'>that</span>
  <span m='4173750'>significant.</span> <span m='4174229'>We</span> <span m='4174319'>could</span>
  <span m='4174470'>have</span> <span m='4174560'>called</span> <span m='4174770'>that</span>
  <span m='4174950'>n.</span> <span m='4175700'>What</span> <span m='4176359'>is</span>
  <span m='4176630'>important</span> <span m='4177229'>is</span> <span m='4177410'>that</span>
  <span m='4177649'>this</span> <span m='4177950'>recursion</span> <span m='4179240'>doesn't</span>
  <span m='4179540'>work</span> <span m='4179990'>when</span> <span m='4180140'>you</span>
  <span m='4180229'>get</span> <span m='4180380'>down</span> <span m='4180590'>to</span>
  <span m='4180680'>a</span> <span m='4180740'>single</span> <span m='4181069'>word.</span>
  <span m='4182240'>Can't</span> <span m='4182450'>do</span> <span m='4182660'>the</span>
  <span m='4182779'>same</span> <span m='4183020'>strategy.</span> <span m='4183800'>You</span>
  <span m='4183920'>need</span> <span m='4184069'>to</span> <span m='4184160'>use</span>
  <span m='4184370'>a</span> <span m='4184430'>different</span> <span m='4184790'>merger</span>
  <span m='4186380'>for</span> <span m='4186590'>single</span> <span m='4186920'>words</span>
  <span m='4187700'>because</span> <span m='4187880'>here</span> <span m='4188090'>we</span>
  <span m='4188210'>have</span> <span m='4188300'>to</span> <span m='4188390'>do</span>
  <span m='4188540'>bit</span> <span m='4188720'>tricks.</span> </p><p><span m='4189800'>For</span>
  <span m='4189920'>this</span> <span m='4190160'>merge</span> <span m='4190399'>strategy</span>
  <span m='4190830'>we</span> <span m='4190939'>didn't</span> <span m='4191180'>have</span>
  <span m='4191390'>to</span> <span m='4191479'>do</span> <span m='4191600'>big</span>
  <span m='4191750'>tricks</span> <span m='4192020'>because</span> <span m='4192200'>everything</span>
  <span m='4192590'>was</span> <span m='4192710'>bigger</span> <span m='4192979'>than</span>
  <span m='4193100'>a</span> <span m='4193160'>word.</span> <span m='4195920'>The</span>
  <span m='4196010'>reason</span> <span m='4196460'>why</span> <span m='4196610'>we</span>
  <span m='4196730'>have</span> <span m='4196850'>these</span> <span m='4197000'>two</span>
  <span m='4197120'>levels</span> <span m='4197480'>is</span> <span m='4197570'>not</span>
  <span m='4197750'>to</span> <span m='4197870'>make</span> <span m='4198020'>the</span>
  <span m='4198110'>time</span> <span m='4198410'>fast,</span> <span m='4199570'>it's</span>
  <span m='4199730'>just</span> <span m='4201050'>to</span> <span m='4201170'>make</span>
  <span m='4201320'>the</span> <span m='4201410'>algorithm</span> <span m='4202040'>work.</span>
  <span m='4202640'>I</span> <span m='4202730'>mean,</span> <span m='4202880'>to</span>
  <span m='4203030'>define</span> <span m='4203330'>the</span> <span m='4203450'>algorithm</span>
  <span m='4204020'>there's</span> <span m='4204320'>within</span> <span m='4204620'>a</span>
  <span m='4204680'>word</span> <span m='4204890'>merging</span> <span m='4205880'>and</span>
  <span m='4207230'>over</span> <span m='4207470'>many</span> <span m='4207740'>words</span>
  <span m='4208010'>merging.</span> <span m='4208880'>The</span> <span m='4209000'>hard</span>
  <span m='4209210'>part</span> <span m='4210050'>is</span> <span m='4210200'>this</span>
  <span m='4210380'>one,</span> <span m='4210650'>within</span> <span m='4210950'>a</span>
  <span m='4211010'>word</span> <span m='4211250'>merging.</span> </p><p><span m='4211910'>So</span>
  <span m='4212030'>that's</span> <span m='4212240'>our</span> <span m='4212360'>next</span>
  <span m='4213830'>goal.</span> <span m='4214650'>But</span> <span m='4214910'>if</span>
  <span m='4215090'>we</span> <span m='4215180'>could</span> <span m='4215300'>do</span>
  <span m='4215480'>that</span> <span m='4217280'>we</span> <span m='4217370'>get</span>
  <span m='4217580'>linear</span> <span m='4217940'>time</span> <span m='4218420'>sorting</span>
  <span m='4219110'>for</span> <span m='4219560'>packed</span> <span m='4219860'>sorting</span>
  <span m='4220190'>when</span> <span m='4220280'>you</span> <span m='4220370'>can</span>
  <span m='4220490'>fit</span> <span m='4220670'>log</span> <span m='4220910'>log</span>
  <span m='4221040'>log</span> <span m='4221420'>n</span> <span m='4221600'>things</span>
  <span m='4221900'>in</span> <span m='4221990'>a</span> <span m='4222050'>word.</span>
  <span m='4222530'>Any</span> <span m='4222800'>questions</span> <span m='4223190'>about</span>
  <span m='4223520'>packed</span> <span m='4223820'>sorting?</span> <span m='4227180'>Good.</span>
  </p><p><span m='4228160'>So,</span> <span m='4229390'>last</span> <span m='4229690'>thing</span>
  <span m='4230080'>is</span> <span m='4230260'>how</span> <span m='4230440'>do</span>
  <span m='4230560'>we</span> <span m='4230680'>merge</span> <span m='4233080'>two</span>
  <span m='4233230'>sorted</span> <span m='4233530'>words</span> <span m='4233800'>into</span>
  <span m='4234010'>one</span> <span m='4234280'>sorted</span> <span m='4234610'>word.</span>
  <span m='4237580'>And</span> <span m='4237700'>this</span> <span m='4237880'>is</span>
  <span m='4238000'>where</span> <span m='4238150'>we're</span> <span m='4238240'>going</span>
  <span m='4238390'>to</span> <span m='4238480'>use</span> <span m='4238840'>bitonic</span>
  <span m='4239410'>sorting.</span> <span m='4239770'>See,</span> <span m='4239890'>it</span>
  <span m='4239980'>says</span> <span m='4240190'>right</span> <span m='4240310'>here,</span>
  <span m='4240460'>bitonic</span> <span m='4240880'>sort</span> <span m='4241120'>for</span>
  <span m='4241270'>merging</span> <span m='4241630'>sorted</span> <span m='4241930'>words.</span>
  <span m='4242200'>Here</span> <span m='4242440'>we</span> <span m='4242530'>know</span>
  <span m='4242650'>what</span> <span m='4242800'>to</span> <span m='4242890'>do.</span>
  <span m='4245500'>Much</span> <span m='4245650'>easier</span> <span m='4246010'>in</span>
  <span m='4246100'>hindsight.</span> </p><p><span m='4252200'>So</span> <span m='4252250'>I'm</span>
  <span m='4252310'>going</span> <span m='4252430'>to</span> <span m='4252490'>take</span>
  <span m='4252640'>a</span> <span m='4252700'>little</span> <span m='4252880'>diversion</span>
  <span m='4253430'>tell</span> <span m='4253570'>you</span> <span m='4253660'>about</span>
  <span m='4253880'>bitonic</span> <span m='4254350'>sorting,</span> <span m='4256090'>briefly.</span>
  <span m='4261240'>Because</span> <span m='4261520'>it's</span> <span m='4261680'>NCLRS</span>
  <span m='4262390'>I</span> <span m='4262450'>don't</span> <span m='4262570'>want</span>
  <span m='4262690'>to</span> <span m='4262750'>spend</span> <span m='4262930'>too</span>
  <span m='4263050'>much</span> <span m='4263230'>time</span> <span m='4263500'>on</span>
  <span m='4263620'>it,</span> <span m='4264820'>but</span> <span m='4265960'>it</span>
  <span m='4266080'>is</span> <span m='4266860'>something</span> <span m='4267220'>we</span>
  <span m='4267310'>need.</span> <span m='4267740'>So</span> <span m='4268150'>you</span>
  <span m='4268180'>need</span> <span m='4268360'>to</span> <span m='4268480'>know</span>
  <span m='4268750'>how</span> <span m='4268960'>it</span> <span m='4269020'>works.</span>
  </p><p><span m='4274310'>So</span> <span m='4274480'>first</span> <span m='4274720'>thing</span>
  <span m='4275310'>is</span> <span m='4275590'>the</span> <span m='4275680'>idea</span>
  <span m='4276040'>of</span> <span m='4276250'>a</span> <span m='4276310'>bitonic</span>
  <span m='4276940'>sequence.</span> <span m='4277810'>This</span> <span m='4278020'>is</span>
  <span m='4278140'>going</span> <span m='4278380'>to</span> <span m='4278500'>be</span>
  <span m='4280130'>a</span> <span m='4280240'>cyclic</span> <span m='4280690'>shift</span>
  <span m='4284360'>of</span> <span m='4284720'>a</span> <span m='4284890'>uni-modal</span>
  <span m='4285520'>sequence.</span> <span m='4286150'>So</span> <span m='4286360'>a</span>
  <span m='4286450'>non-decreasing</span> <span m='4289000'>plus</span> <span m='4289370'>a</span>
  <span m='4289560'>non-increasing</span> <span m='4292570'>sequence.</span> <span
  m='4296110'>So</span> <span m='4297190'>I</span> <span m='4297250'>want</span> <span
  m='4297370'>non-decreasing</span> <span m='4298570'>and</span> <span m='4298740'>then</span>
  <span m='4298840'>non-increasing.</span> <span m='4299650'>So</span> <span m='4299680'>this</span>
  <span m='4299860'>is</span> <span m='4299950'>a</span> <span m='4300070'>bitonic</span>
  <span m='4300550'>sequence.</span> <span m='4301530'>I think</span> <span m='4301660'>you</span>
  <span m='4301720'>know</span> <span m='4301810'>what</span> <span m='4301900'>this</span>
  <span m='4302050'>means.</span> </p><p><span m='4304210'>Or</span> <span m='4304430'>it</span>
  <span m='4304480'>could</span> <span m='4304630'>be</span> <span m='4304720'>a</span>
  <span m='4304750'>cyclic</span> <span m='4305170'>shift</span> <span m='4305440'>thereof.</span>
  <span m='4306920'>So</span> <span m='4307030'>I</span> <span m='4307090'>could,</span>
  <span m='4307340'>for</span> <span m='4307360'>example,</span> <span m='4307760'>take</span>
  <span m='4307870'>this</span> <span m='4308590'>part</span> <span m='4308860'>here</span>
  <span m='4309280'>and</span> <span m='4309430'>shift</span> <span m='4309700'>it</span>
  <span m='4309790'>over</span> <span m='4310000'>to</span> <span m='4310060'>this</span>
  <span m='4310240'>side.</span> <span m='4311270'>So</span> <span m='4311320'>then</span>
  <span m='4311470'>I'd</span> <span m='4311560'>end</span> <span m='4311770'>up</span>
  <span m='4311890'>with</span> <span m='4312130'>this,</span> <span m='4313456'>this,</span>
  <span m='4314550'>and</span> <span m='4314710'>this.</span> <span m='4315220'>This
  is</span> <span m='4315310'>also</span> <span m='4315600'>bitonic.</span> <span
  m='4316900'>or</span> <span m='4317050'>I</span> <span m='4317080'>could</span>
  <span m='4317230'>shift</span> <span m='4317410'>this</span> <span m='4317560'>whole</span>
  <span m='4317740'>thing</span> <span m='4317980'>and</span> <span m='4318070'>put</span>
  <span m='4318220'>it</span> <span m='4318310'>over</span> <span m='4318490'>there</span>
  <span m='4319550'>so</span> <span m='4319600'>I</span> <span m='4319630'>end</span>
  <span m='4319750'>up</span> <span m='4319900'>with</span> <span m='4321160'>that.</span>
  <span m='4321710'>That's</span> <span m='4321760'>also</span> <span m='4322130'>bitonic.</span>
  </p><p><span m='4323470'>So it</span> <span m='4323590'>basically</span> <span m='4323980'>has</span>
  <span m='4325000'>one</span> <span m='4325210'>max,</span> <span m='4325600'>one</span>
  <span m='4325810'>min</span> <span m='4326440'>if</span> <span m='4326590'>you're</span>
  <span m='4326890'>reading</span> <span m='4327160'>it</span> <span m='4327280'>cyclically.</span>
  <span m='4328630'>One</span> <span m='4328810'>local</span> <span m='4329050'>max,</span>
  <span m='4329320'>one</span> <span m='4329470'>local</span> <span m='4329750'>min.</span>
  <span m='4331000'>Except, it's</span> <span m='4331300'>non-decreasing</span> <span
  m='4331705'>so</span> <span m='4332110'>it's a</span> <span m='4332380'>little</span>
  <span m='4332610'>messier,</span> <span m='4333090'>but</span> <span m='4334360'>same</span>
  <span m='4334570'>thing.</span> <span m='4336230'>OK,</span> <span m='4337450'>let's</span>
  <span m='4337720'>go</span> <span m='4340074'>over</span> <span m='4340520'>here.</span>
  </p><p><span m='4357900'>So</span> <span m='4358160'>if</span> <span m='4358340'>you</span>
  <span m='4358430'>have</span> <span m='4358580'>a</span> <span m='4358700'>bitonic</span>
  <span m='4359150'>sequence</span> <span m='4359870'>there's</span> <span m='4360170'>something</span>
  <span m='4360500'>called</span> <span m='4360650'>a</span> <span m='4360710'>bitonic</span>
  <span m='4361310'>sorting</span> <span m='4361670'>network,</span> <span m='4363356'>which</span>
  <span m='4363780'>you</span> <span m='4363830'>can</span> <span m='4363950'>think</span>
  <span m='4364100'>of</span> <span m='4364220'>as</span> <span m='4364370'>a</span>
  <span m='4364460'>parallel</span> <span m='4364910'>sorting</span> <span m='4365270'>algorithm,</span>
  <span m='4366410'>to</span> <span m='4366560'>sort</span> <span m='4366830'>such</span>
  <span m='4367070'>a</span> <span m='4367130'>thing.</span> <span m='4367560'>So</span>
  <span m='4367610'>it's</span> <span m='4367820'>almost</span> <span m='4368270'>sorted,</span>
  <span m='4369590'>but</span> <span m='4369740'>not</span> <span m='4369890'>quite.</span>
  <span m='4370700'>And</span> <span m='4371030'>there's</span> <span m='4371210'>this</span>
  <span m='4371360'>way</span> <span m='4371570'>of</span> <span m='4371630'>sorting</span>
  <span m='4371960'>them.</span> <span m='4372620'>So</span> <span m='4373610'>I'm</span>
  <span m='4373670'>going</span> <span m='4373790'>to</span> <span m='4374180'>draw</span>
  <span m='4374390'>a</span> <span m='4374420'>picture</span> <span m='4375440'>to</span>
  <span m='4375560'>make</span> <span m='4375800'>it</span> <span m='4377150'>easier</span>
  <span m='4377510'>for</span> <span m='4377660'>me.</span> <span m='4381160'>It's</span>
  <span m='4381290'>a</span> <span m='4381320'>little</span> <span m='4381530'>more</span>
  <span m='4381650'>annoying</span> <span m='4381920'>to</span> <span m='4382040'>write</span>
  <span m='4382220'>down</span> <span m='4382400'>the</span> <span m='4382490'>general</span>
  <span m='4382790'>algorithm.</span> </p><p><span m='4383450'>But</span> <span m='4384140'>so</span>
  <span m='4384290'>what</span> <span m='4384410'>I</span> <span m='4384470'>want</span>
  <span m='4384590'>to</span> <span m='4384680'>do,</span> <span m='4385230'>suppose</span>
  <span m='4385520'>the</span> <span m='4385610'>number</span> <span m='4385820'>of</span>
  <span m='4385910'>elements</span> <span m='4386260'>is</span> <span m='4386360'>a</span>
  <span m='4386420'>power</span> <span m='4386770'>of 2.</span> <span m='4387560'>Here's</span>
  <span m='4387710'>what</span> <span m='4387830'>I'm</span> <span m='4387890'>going</span>
  <span m='4388010'>to</span> <span m='4388070'>do.</span> <span m='4388180'>First</span>
  <span m='4388430'>I</span> <span m='4388520'>compare</span> <span m='4389600'>the</span>
  <span m='4390050'>first</span> <span m='4390530'>and</span> <span m='4390785'>the</span>
  <span m='4391040'>midway</span> <span m='4391460'>element.</span> <span m='4392070'>And</span>
  <span m='4392090'>then</span> <span m='4392240'>the</span> <span m='4392330'>next</span>
  <span m='4392570'>one</span> <span m='4393310'>with</span> <span m='4393410'>the</span>
  <span m='4393500'>next</span> <span m='4393710'>one,</span> <span m='4393890'>and</span>
  <span m='4393980'>then</span> <span m='4394100'>the</span> <span m='4394160'>next</span>
  <span m='4394400'>one</span> <span m='4394670'>with</span> <span m='4394790'>the</span>
  <span m='4394880'>next</span> <span m='4395120'>one,</span> <span m='4395680'>the</span>
  <span m='4395780'>next</span> <span m='4396020'>one</span> <span m='4396200'>with</span>
  <span m='4396320'>the</span> <span m='4396410'>next</span> <span m='4396650'>one.</span>
  <span m='4396800'>For</span> <span m='4396920'>each</span> <span m='4397040'>of</span>
  <span m='4397100'>these</span> <span m='4397250'>comparisons</span> <span m='4397790'>I</span>
  <span m='4397880'>put</span> <span m='4398060'>those</span> <span m='4398270'>items</span>
  <span m='4398570'>in</span> <span m='4398660'>the</span> <span m='4398750'>correct</span>
  <span m='4399110'>order.</span> </p><p><span m='4400080'>So</span> <span m='4400180'>if</span>
  <span m='4400280'>I</span> <span m='4400380'>do</span> <span m='4400480'>that</span>
  <span m='4400520'>3</span> <span m='4400760'>versus</span> <span m='4401060'>6,</span>
  <span m='4401390'>3</span> <span m='4401600'>is</span> <span m='4401660'>less</span>
  <span m='4401840'>than</span> <span m='4401960'>6,</span> <span m='4402250'>so</span>
  <span m='4402320'>3</span> <span m='4402560'>stays</span> <span m='4402890'>here,</span>
  <span m='4403480'>6</span> <span m='4403780'>stays</span> <span m='4404060'>there.</span>
  <span m='4404800'>5</span> <span m='4405320'>is</span> <span m='4405410'>bigger</span>
  <span m='4405650'>than</span> <span m='4405800'>4</span> <span m='4406070'>though,</span>
  <span m='4406340'>so</span> <span m='4406430'>4</span> <span m='4406685'>comes</span>
  <span m='4406940'>over</span> <span m='4407150'>here,</span> <span m='4407840'>5</span>
  <span m='4408200'>goes</span> <span m='4408440'>over</span> <span m='4408620'>here.</span>
  <span m='4409370'>Next</span> <span m='4409650'>is</span> <span m='4409780'>7</span>
  <span m='4410660'>versus</span> <span m='4411380'>2,</span> <span m='4412190'>so</span>
  <span m='4412340'>2</span> <span m='4412700'>comes</span> <span m='4413000'>over</span>
  <span m='4413180'>here,</span> <span m='4413570'>7</span> <span m='4414020'>comes</span>
  <span m='4414290'>over</span> <span m='4414470'>here.</span> <span m='4415430'>Nine</span>
  <span m='4415790'>versus</span> <span m='4416060'>0,</span> <span m='4416335'>so</span>
  <span m='4416610'>0</span> <span m='4416900'>is</span> <span m='4417020'>over</span>
  <span m='4417200'>here,</span> <span m='4418050'>9 is</span> <span m='4418430'>over</span>
  <span m='4418610'>there.</span> <span m='4419700'>OK,</span> <span m='4419930'>that's</span>
  <span m='4420200'>an</span> <span m='4420290'>easy</span> <span m='4420830'>set</span>
  <span m='4421790'>comparisons</span> <span m='4422210'>to</span> <span m='4422300'>do.</span>
  <span m='4422480'>The nice</span> <span m='4422690'>thing</span> <span m='4422930'>is
  you</span> <span m='4422990'>can</span> <span m='4423110'>do</span> <span m='4423200'>all</span>
  <span m='4423380'>those</span> <span m='4423590'>in</span> <span m='4423680'>parallel.</span>
  </p><p><span m='4425710'>OK,</span> <span m='4426540'>just</span> <span m='4426680'>to</span>
  <span m='4426830'>check</span> <span m='4427220'>here.</span> <span m='4427400'>This</span>
  <span m='4427610'>was</span> <span m='4427760'>a</span> <span m='4427850'>monotone</span>
  <span m='4428420'>increasing</span> <span m='4429110'>sub-sequence</span> <span
  m='4430460'>and</span> <span m='4430580'>then</span> <span m='4430730'>a</span>
  <span m='4430790'>monotone</span> <span m='4431240'>decreasing.</span> <span m='4433590'>Now,</span>
  <span m='4434000'>we</span> <span m='4434180'>have</span> <span m='4434810'>increasing</span>
  <span m='4435680'>then</span> <span m='4436100'>decreasing.</span> <span m='4437270'>And</span>
  <span m='4437390'>then</span> <span m='4437510'>we</span> <span m='4437630'>have</span>
  <span m='4438920'>decreasing</span> <span m='4439790'>then</span> <span m='4440150'>increasing.</span>
  </p><p><span m='4442250'>But</span> <span m='4442580'>if</span> <span m='4442760'>you</span>
  <span m='4442850'>look</span> <span m='4443060'>at</span> <span m='4443180'>the</span>
  <span m='4443270'>left</span> <span m='4443630'>half</span> <span m='4444560'>or</span>
  <span m='4444710'>the</span> <span m='4444830'>right</span> <span m='4445040'>half,</span>
  <span m='4445310'>they</span> <span m='4445430'>are</span> <span m='4445550'>still</span>
  <span m='4445850'>bitonic.</span> <span m='4446860'>And</span> <span m='4446960'>that's</span>
  <span m='4447110'>an</span> <span m='4447200'>invariant.</span> <span m='4448610'>Bitonic</span>
  <span m='4449120'>will</span> <span m='4449210'>be</span> <span m='4449330'>preserved</span>
  <span m='4449810'>here.</span> <span m='4450560'>Also</span> <span m='4450920'>notice,</span>
  <span m='4451340'>all</span> <span m='4451550'>the</span> <span m='4451670'>elements</span>
  <span m='4451970'>in</span> <span m='4452060'>the</span> <span m='4452150'>left</span>
  <span m='4452870'>are</span> <span m='4452960'>smaller</span> <span m='4453440'>than</span>
  <span m='4453590'>all</span> <span m='4453740'>the</span> <span m='4453860'>elements</span>
  <span m='4454190'>in</span> <span m='4454250'>the</span> <span m='4454340'>right.</span>
  <span m='4455150'>That's</span> <span m='4455270'>not</span> <span m='4455420'>true</span>
  <span m='4455570'>for</span> <span m='4455690'>an</span> <span m='4455780'>arbitrary</span>
  <span m='4456230'>sequence,</span> <span m='4456620'>but</span> <span m='4456710'>it</span>
  <span m='4456770'>will</span> <span m='4456980'>be</span> <span m='4457070'>true</span>
  <span m='4457280'>for</span> <span m='4457430'>bitonic</span> <span m='4457940'>sequence.</span>
  </p><p><span m='4458300'>Essentially</span> <span m='4459470'>the</span> <span m='4460100'>max</span>
  <span m='4460670'>is</span> <span m='4460760'>somewhere</span> <span m='4461210'>here</span>
  <span m='4462260'>and</span> <span m='4462350'>so</span> <span m='4462440'>it's</span>
  <span m='4462530'>going</span> <span m='4462680'>to</span> <span m='4462740'>be</span>
  <span m='4462860'>spanned</span> <span m='4463580'>by</span> <span m='4464570'>some</span>
  <span m='4465050'>of</span> <span m='4465200'>these</span> <span m='4465410'>intervals,</span>
  <span m='4466430'>that</span> <span m='4466610'>max.</span> <span m='4467510'>And</span>
  <span m='4467630'>by</span> <span m='4467780'>spanning</span> <span m='4468200'>those</span>
  <span m='4468410'>intervals,</span> <span m='4468830'>and</span> <span m='4468920'>in</span>
  <span m='4468980'>particular</span> <span m='4469340'>comparing</span> <span m='4469760'>that</span>
  <span m='4469920'>guy</span> <span m='4470090'>with</span> <span m='4470180'>somebody</span>
  <span m='4470510'>on</span> <span m='4470600'>the</span> <span m='4470690'>right,</span>
  <span m='4471530'>the</span> <span m='4471620'>max</span> <span m='4472010'>will</span>
  <span m='4472100'>get</span> <span m='4472220'>over</span> <span m='4472400'>to</span>
  <span m='4472490'>the</span> <span m='4472610'>right</span> <span m='4472920'>and</span>
  <span m='4473810'>then</span> <span m='4474170'>the</span> <span m='4474530'>rest</span>
  <span m='4474920'>of</span> <span m='4475070'>the</span> <span m='4475520'>increasing</span>
  <span m='4475940'>and</span> <span m='4476360'>decreasing</span> <span m='4476870'>sub-sequences</span>
  <span m='4477470'>will</span> <span m='4477620'>follow.</span> <span m='4478530'>That's</span>
  <span m='4478670'>a</span> <span m='4478820'>very</span> <span m='4479120'>hand-wavy</span>
  <span m='4480050'>argument.</span> <span m='4480440'>You</span> <span m='4480530'>can</span>
  <span m='4480680'>see</span> <span m='4480830'>CLRS</span> <span m='4482060'>for</span>
  <span m='4482480'>a</span> <span m='4482630'>way</span> <span m='4482810'>to</span>
  <span m='4482930'>prove</span> <span m='4483140'>that</span> <span m='4484210'>OK,</span>
  <span m='4484820'>just</span> <span m='4485000'>take</span> <span m='4485210'>it</span>
  <span m='4485330'>for</span> <span m='4485480'>granted</span> <span m='4485870'>now.</span>
  </p><p><span m='4486740'>Now,</span> <span m='4486890'>we</span> <span m='4487010'>recurse</span>
  <span m='4487400'>on</span> <span m='4487490'>the</span> <span m='4487580'>two</span>
  <span m='4487730'>sides.</span> <span m='4488420'>So</span> <span m='4488600'>I</span>
  <span m='4488660'>compare</span> <span m='4488990'>3</span> <span m='4489200'>with</span>
  <span m='4489320'>2,</span> <span m='4489980'>4</span> <span m='4490240'>with</span>
  <span m='4490500'>0,</span> <span m='4490760'>I</span> <span m='4490850'>compare</span>
  <span m='4491210'>6 with</span> <span m='4491490'>7,</span> <span m='4492320'>and</span>
  <span m='4492410'>6</span> <span m='4492680'>with</span> <span m='4492800'>9.</span>
  <span m='4493510'>So</span> <span m='4493730'>what</span> <span m='4493850'>do</span>
  <span m='4493940'>I</span> <span m='4494000'>get?</span> <span m='4494990'>2</span>
  <span m='4495380'>is</span> <span m='4495500'>less</span> <span m='4495770'>than</span>
  <span m='4495920'>3.</span> <span m='4496760'>0 is</span> <span m='4497180'>less</span>
  <span m='4497390'>than</span> <span m='4497550'>4.</span> <span m='4498570'>Then
  I</span> <span m='4498980'>compare</span> <span m='4499610'>6 with</span> <span
  m='4500018'>7,</span> <span m='4500426'>so</span> <span m='4500834'>6</span> <span
  m='4501242'>less than</span> <span m='4501650'>7.</span> <span m='4502450'>5 is</span>
  <span m='4502850'>less</span> <span m='4503090'>than</span> <span m='4503180'>9.</span>
  </p><p><span m='4505910'>So</span> <span m='4506060'>now</span> <span m='4506150'>I've</span>
  <span m='4506330'>got</span> <span m='4506540'>four</span> <span m='4506810'>chunks,</span>
  <span m='4508190'>this</span> <span m='4508400'>one,</span> <span m='4509330'>this</span>
  <span m='4509540'>one,</span> <span m='4510530'>this</span> <span m='4510710'>one,</span>
  <span m='4511010'>and</span> <span m='4511250'>this</span> <span m='4511490'>one.</span>
  <span m='4511670'>I</span> <span m='4511780'>recurse</span> <span m='4512120'>on</span>
  <span m='4512240'>each</span> <span m='4512420'>of</span> <span m='4512480'>them.</span>
  <span m='4513320'>So</span> <span m='4513380'>0</span> <span m='4513640'>is</span>
  <span m='4513740'>less</span> <span m='4513920'>than</span> <span m='4514040'>2,</span>
  <span m='4514850'>3</span> <span m='4515030'>is less than</span> <span m='4515480'>4,</span>
  <span m='4516480'>5</span> <span m='4516770'>is</span> <span m='4516840'>less</span>
  <span m='4517020'>than</span> <span m='4517150'>6,</span> <span m='4518110'>7</span>
  <span m='4518450'>is</span> <span m='4518540'>less</span> <span m='4518720'>than</span>
  <span m='4518810'>9.</span> <span m='4519660'>Now</span> <span m='4519950'>I</span>
  <span m='4520040'>have</span> <span m='4520430'>all</span> <span m='4520580'>my</span>
  <span m='4520760'>items</span> <span m='4521120'>in</span> <span m='4521180'>sorted</span>
  <span m='4521510'>order,</span> <span m='4522910'>magically.</span> </p><p><span
  m='4524020'>OK,</span> <span m='4524180'>but</span> <span m='4524300'>if</span>
  <span m='4524420'>you</span> <span m='4524510'>believe</span> <span m='4524810'>that</span>
  <span m='4524970'>invariant</span> <span m='4525470'>that</span> <span m='4526280'>the</span>
  <span m='4527300'>smallest</span> <span m='4527930'>n over</span> <span m='4528090'>two</span>
  <span m='4528320'>items</span> <span m='4528680'>get</span> <span m='4529130'>to</span>
  <span m='4529250'>the</span> <span m='4529340'>left</span> <span m='4529640'>and</span>
  <span m='4529730'>the</span> <span m='4529820'>larger</span> <span m='4530210'>n</span>
  <span m='4530360'>over</span> <span m='4530510'>two</span> <span m='4530630'>items</span>
  <span m='4530900'>get</span> <span m='4531020'>to</span> <span m='4531110'>the</span>
  <span m='4531200'>right,</span> <span m='4532340'>then</span> <span m='4532610'>by</span>
  <span m='4532940'>induction</span> <span m='4533510'>this</span> <span m='4533660'>will</span>
  <span m='4533780'>sort</span> <span m='4534020'>them.</span> <span m='4534740'>Kind</span>
  <span m='4534920'>of</span> <span m='4535010'>like</span> <span m='4535190'>quick
  sort</span> <span m='4535610'>in</span> <span m='4535730'>that</span> <span m='4535880'>sense.</span>
  <span m='4537590'>OK.</span> <span m='4537930'>The</span> <span m='4538030'>cool</span>
  <span m='4538100'>thing</span> <span m='4538280'>is</span> <span m='4538400'>I</span>
  <span m='4538490'>can</span> <span m='4538580'>do</span> <span m='4538700'>all</span>
  <span m='4538920'>these</span> <span m='4539090'>in</span> <span m='4539180'>parallel,</span>
  <span m='4539600'>all</span> <span m='4539810'>these</span> <span m='4539990'>in</span>
  <span m='4540080'>parallel,</span> <span m='4540470'>all</span> <span m='4540680'>these</span>
  <span m='4540800'>in</span> <span m='4540890'>parallel.</span> </p><p><span m='4541360'>So</span>
  <span m='4541430'>the</span> <span m='4541520'>total</span> <span m='4541850'>time</span>
  <span m='4542620'>is</span> <span m='4542810'>log</span> <span m='4543320'>k,</span>
  <span m='4544925'>if</span> <span m='4545210'>I'm</span> <span m='4545390'>a</span>
  <span m='4545450'>parallel</span> <span m='4545810'>sorting</span> <span m='4546140'>algorithm</span>
  <span m='4546560'>or a</span> <span m='4546680'>sorting</span> <span m='4546980'>network.</span>
  <span m='4548030'>And</span> <span m='4548420'>log</span> <span m='4548720'>k is</span>
  <span m='4549200'>exactly</span> <span m='4549710'>what</span> <span m='4549860'>I</span>
  <span m='4549950'>can</span> <span m='4550070'>afford.</span> <span m='4551270'>So</span>
  <span m='4551480'>the</span> <span m='4551600'>last</span> <span m='4551870'>thing</span>
  <span m='4552020'>to</span> <span m='4552140'>do</span> <span m='4552380'>is</span>
  <span m='4552530'>to</span> <span m='4552650'>implement</span> <span m='4553610'>an</span>
  <span m='4553730'>operation</span> <span m='4554300'>like</span> <span m='4554480'>this,</span>
  <span m='4554810'>or</span> <span m='4554930'>like</span> <span m='4555170'>this--</span>
  <span m='4555455'>this</span> <span m='4555740'>is</span> <span m='4555830'>kind</span>
  <span m='4556010'>of</span> <span m='4556100'>the</span> <span m='4556190'>generic</span>
  <span m='4557240'>picture</span> <span m='4557600'>here--</span> <span m='4560030'>in</span>
  <span m='4560180'>constant</span> <span m='4560600'>time</span> <span m='4560900'>on</span>
  <span m='4561000'>a</span> <span m='4561050'>word</span> <span m='4561260'>ram.</span>
  </p><p><span m='4573380'>One</span> <span m='4573620'>other</span> <span m='4573830'>thing,</span>
  <span m='4575010'>because</span> <span m='4575180'>I</span> <span m='4575240'>don't</span>
  <span m='4575360'>want</span> <span m='4575540'>to</span> <span m='4575630'>sort</span>
  <span m='4575900'>a</span> <span m='4575990'>bitonic</span> <span m='4576540'>sequence.</span>
  <span m='4577010'>That</span> <span m='4577160'>wasn't</span> <span m='4577400'>my</span>
  <span m='4577520'>goal.</span> <span m='4577890'>My</span> <span m='4577940'>goal</span>
  <span m='4578090'>was</span> <span m='4578240'>to</span> <span m='4578360'>merge</span>
  <span m='4578780'>two</span> <span m='4579020'>sorted</span> <span m='4579410'>sequences.</span>
  <span m='4580910'>I</span> <span m='4581300'>have</span> <span m='4581450'>two</span>
  <span m='4581660'>sorted</span> <span m='4582050'>sequences,</span> <span m='4582590'>I</span>
  <span m='4582680'>want</span> <span m='4582830'>to</span> <span m='4582920'>merge</span>
  <span m='4583220'>them.</span> <span m='4584730'>How</span> <span m='4584750'>do</span>
  <span m='4584900'>I</span> <span m='4585020'>make</span> <span m='4585290'>that</span>
  <span m='4585590'>bitonic?</span> </p><p><span m='4588460'>I</span> <span m='4588560'>just</span>
  <span m='4588740'>flip,</span> <span m='4590720'>like</span> <span m='4590870'>that.</span>
  <span m='4592130'>I</span> <span m='4592220'>take</span> <span m='4592460'>this</span>
  <span m='4592580'>sequence</span> <span m='4593000'>and</span> <span m='4593090'>I</span>
  <span m='4593180'>reverse</span> <span m='4593690'>it.</span> <span m='4594860'>If
  I</span> <span m='4594920'>take</span> <span m='4595220'>a</span> <span m='4595250'>sorted</span>
  <span m='4595550'>sequence</span> <span m='4595910'>and</span> <span m='4595970'>reverse</span>
  <span m='4596360'>it</span> <span m='4596450'>then</span> <span m='4596600'>it</span>
  <span m='4596660'>looks</span> <span m='4596840'>like</span> <span m='4597020'>this.</span>
  <span m='4597390'>And</span> <span m='4597410'>so</span> <span m='4597620'>then</span>
  <span m='4597800'>the</span> <span m='4597890'>result</span> <span m='4598310'>is</span>
  <span m='4598890'>bitonic.</span> <span m='4599600'>Then</span> <span m='4599870'>I</span>
  <span m='4600010'>can</span> <span m='4600200'>use</span> <span m='4600350'>bitonic</span>
  <span m='4600620'>sorting</span> <span m='4600920'>to</span> <span m='4601010'>sort</span>
  <span m='4601280'>it.</span> <span m='4601850'>So</span> <span m='4602000'>this</span>
  <span m='4602210'>is</span> <span m='4602300'>the</span> <span m='4602390'>merge</span>
  <span m='4602690'>problem</span> <span m='4603530'>and</span> <span m='4603680'>I've</span>
  <span m='4603800'>just</span> <span m='4603950'>reduced</span> <span m='4604430'>it</span>
  <span m='4604580'>to</span> <span m='4604940'>bitonic</span> <span m='4605460'>sorting.</span>
  <span m='4607220'>Cool.</span> </p><p><span m='4608060'>Except,</span> <span m='4609500'>how</span>
  <span m='4609710'>do</span> <span m='4609890'>I</span> <span m='4610190'>reverse</span>
  <span m='4610850'>a</span> <span m='4610970'>sequence</span> <span m='4612610'>in</span>
  <span m='4613000'>log</span> <span m='4613240'>k</span> <span m='4613580'>time</span>
  <span m='4614000'>on</span> <span m='4614090'>a</span> <span m='4614150'>word</span>
  <span m='4614360'>ram?</span> <span m='4616770'>Cute</span> <span m='4617000'>trick.</span>
  <span m='4620735'>If</span> <span m='4621200'>I</span> <span m='4621260'>have</span>
  <span m='4621500'>a</span> <span m='4621560'>word</span> <span m='4622220'>and</span>
  <span m='4622430'>it</span> <span m='4622700'>has</span> <span m='4622880'>many</span>
  <span m='4623120'>items</span> <span m='4623450'>in</span> <span m='4623570'>it--</span>
  <span m='4624950'>that's</span> <span m='4625100'>our</span> <span m='4625220'>picture,</span>
  <span m='4625680'>that's</span> <span m='4625820'>our</span> <span m='4625910'>set</span>
  <span m='4626120'>up</span> <span m='4626270'>here--</span> <span m='4627110'>and</span>
  <span m='4627260'>I</span> <span m='4627350'>want</span> <span m='4627470'>to</span>
  <span m='4627560'>reverse</span> <span m='4627890'>it</span> <span m='4627950'>over</span>
  <span m='4628190'>all,</span> <span m='4628370'>what</span> <span m='4628520'>I'll</span>
  <span m='4628640'>do</span> <span m='4629000'>is</span> <span m='4629240'>cut</span>
  <span m='4629480'>it</span> <span m='4629570'>in</span> <span m='4629660'>half,</span>
  <span m='4631070'>take</span> <span m='4631310'>all</span> <span m='4631580'>these</span>
  <span m='4631790'>guys</span> <span m='4632150'>put</span> <span m='4632330'>them</span>
  <span m='4632480'>over</span> <span m='4632690'>here,</span> <span m='4632990'>take</span>
  <span m='4633230'>all</span> <span m='4633410'>these</span> <span m='4633620'>guys</span>
  <span m='4633950'>put</span> <span m='4634130'>them</span> <span m='4634280'>over</span>
  <span m='4634490'>here.</span> <span m='4635870'>So</span> <span m='4636080'>I've</span>
  <span m='4636360'>got</span> <span m='4637160'>the</span> <span m='4637280'>right</span>
  <span m='4637520'>side--</span> <span m='4638315'>sorry,</span> <span m='4638570'>it's</span>
  <span m='4638690'>only</span> <span m='4638930'>four--</span> <span m='4641060'>cells</span>
  <span m='4641420'>over</span> <span m='4641600'>here.</span> <span m='4642480'>I've</span>
  <span m='4642530'>got</span> <span m='4642710'>the</span> <span m='4642800'>left</span>
  <span m='4643010'>side</span> <span m='4643310'>over</span> <span m='4643490'>here.</span>
  </p><p><span m='4644930'>Then</span> <span m='4645080'>I</span> <span m='4647090'>recursively</span>
  <span m='4648290'>reverse</span> <span m='4649840'>the</span> <span m='4649950'>sequence</span>
  <span m='4650420'>and</span> <span m='4650570'>recursively</span> <span m='4651740'>reverse</span>
  <span m='4652220'>this</span> <span m='4652370'>sequence.</span> <span m='4654300'>And</span>
  <span m='4654320'>then</span> <span m='4654530'>I</span> <span m='4654590'>have</span>
  <span m='4654890'>the</span> <span m='4654980'>reverse</span> <span m='4655340'>sequence.</span>
  <span m='4657220'>Right,</span> <span m='4657420'>this</span> <span m='4657600'>is</span>
  <span m='4657750'>a</span> <span m='4657840'>standard.</span> <span m='4659040'>One</span>
  <span m='4659220'>way</span> <span m='4659340'>to</span> <span m='4659460'>reverse</span>
  <span m='4659850'>items</span> <span m='4660300'>is</span> <span m='4660480'>to</span>
  <span m='4661020'>do</span> <span m='4661140'>the</span> <span m='4661260'>big</span>
  <span m='4661710'>part</span> <span m='4662220'>and</span> <span m='4662370'>then</span>
  <span m='4662490'>recursively</span> <span m='4662970'>reverse.</span> <span m='4663830'>Then</span>
  <span m='4664050'>I will</span> <span m='4664260'>get,</span> <span m='4664680'>I</span>
  <span m='4664740'>mean</span> <span m='4664860'>this</span> <span m='4664980'>is</span>
  <span m='4665100'>like</span> <span m='4666340'>ab</span> <span m='4667170'>reverse</span>
  <span m='4668280'>is</span> <span m='4668430'>equal</span> <span m='4668670'>to</span>
  <span m='4668880'>b</span> <span m='4669060'>reverse</span> <span m='4669510'>a</span>
  <span m='4669630'>reverse.</span> </p><p><span m='4671180'>Just</span> <span m='4671670'>a</span>
  <span m='4671790'>fun</span> <span m='4672060'>fact.</span> <span m='4672570'>So</span>
  <span m='4672750'>we're</span> <span m='4672930'>implementing</span> <span m='4673440'>that.</span>
  </p><p><span m='4675180'>Now</span> <span m='4675300'>how</span> <span m='4675480'>do</span>
  <span m='4675600'>I</span> <span m='4675690'>do</span> <span m='4675840'>this?</span>
  <span m='4676810'>Well,</span> <span m='4676910'>this</span> <span m='4676940'>is</span>
  <span m='4677010'>the</span> <span m='4677130'>thing</span> <span m='4677340'>I've</span>
  <span m='4677490'>been</span> <span m='4677640'>talking</span> <span m='4677970'>about</span>
  <span m='4678750'>over</span> <span m='4679050'>here.</span> <span m='4679860'>You</span>
  <span m='4679920'>want</span> <span m='4680070'>to</span> <span m='4680130'>take</span>
  <span m='4680310'>the</span> <span m='4680400'>high</span> <span m='4680610'>part</span>
  <span m='4680970'>you</span> <span m='4681060'>just</span> <span m='4681240'>mask</span>
  <span m='4681540'>that</span> <span m='4681750'>part</span> <span m='4682170'>out,</span>
  <span m='4682820'>shift it</span> <span m='4683190'>to</span> <span m='4683310'>the</span>
  <span m='4683400'>right.</span> <span m='4683680'>You</span> <span m='4683800'>want</span>
  <span m='4683900'>to</span> <span m='4683970'>take</span> <span m='4684100'>the</span>
  <span m='4684150'>low</span> <span m='4684420'>part,</span> <span m='4684690'>just
  mask</span> <span m='4684960'>that</span> <span m='4685140'>part</span> <span m='4685410'>out.</span>
  <span m='4686600'>And</span> <span m='4686640'>so</span> <span m='4687090'>I</span>
  <span m='4687210'>can</span> <span m='4687420'>take</span> <span m='4687750'>each</span>
  <span m='4687960'>of</span> <span m='4688020'>these</span> <span m='4688200'>parts</span>
  <span m='4688440'>individually,</span> <span m='4689370'>shift</span> <span m='4689580'>this</span>
  <span m='4689760'>one</span> <span m='4689910'>to</span> <span m='4690000'>the</span>
  <span m='4690060'>left,</span> <span m='4690330'>shift</span> <span m='4690600'>this</span>
  <span m='4690750'>one</span> <span m='4690900'>to</span> <span m='4690990'>the</span>
  <span m='4691110'>right,</span> <span m='4691620'>order</span> <span m='4691860'>them</span>
  <span m='4692010'>together,</span> <span m='4692610'>and</span> <span m='4692700'>I've</span>
  <span m='4692820'>reversed.</span> </p><p><span m='4693690'>So</span> <span m='4693840'>this</span>
  <span m='4694020'>takes</span> <span m='4694260'>constant</span> <span m='4694650'>time.</span>
  <span m='4696000'>This</span> <span m='4696270'>is</span> <span m='4696430'>recursion</span>
  <span m='4697270'>but</span> <span m='4697350'>the</span> <span m='4697440'>total</span>
  <span m='4697710'>number</span> <span m='4697950'>of</span> <span m='4698010'>steps</span>
  <span m='4698340'>will</span> <span m='4698430'>be</span> <span m='4699070'>order</span>
  <span m='4699450'>log</span> <span m='4699770'>k,</span> <span m='4700860'>which</span>
  <span m='4700980'>is</span> <span m='4701100'>exactly</span> <span m='4701580'>what</span>
  <span m='4701730'>I</span> <span m='4701790'>can</span> <span m='4701940'>afford.</span>
  <span m='4703770'>So</span> <span m='4703980'>that's</span> <span m='4704160'>how</span>
  <span m='4704280'>I</span> <span m='4704340'>do</span> <span m='4704460'>the</span>
  <span m='4705210'>reverse</span> <span m='4705660'>part.</span> <span m='4706260'>So</span>
  <span m='4706350'>if</span> <span m='4706460'>I</span> <span m='4706500'>want</span>
  <span m='4706680'>to</span> <span m='4706740'>merge,</span> <span m='4707280'>now</span>
  <span m='4707520'>I</span> <span m='4707610'>have</span> <span m='4707760'>a</span>
  <span m='4707790'>bitonic</span> <span m='4708270'>sequence.</span> </p><p><span
  m='4709620'>Last</span> <span m='4709950'>thing</span> <span m='4710130'>to</span>
  <span m='4710220'>do</span> <span m='4710430'>is,</span> <span m='4710550'>how</span>
  <span m='4710730'>do</span> <span m='4710850'>I</span> <span m='4710910'>do</span>
  <span m='4711030'>this</span> <span m='4711180'>bitonic</span> <span m='4711690'>comparison</span>
  <span m='4715080'>in</span> <span m='4715310'>constant</span> <span m='4715803'>time.</span>
  <span m='4725970'>So,</span> <span m='4726800'>that's</span> <span m='4727050'>next</span>
  <span m='4727410'>page.</span> <span m='4732770'>Here's</span> <span m='4732900'>a</span>
  <span m='4732990'>quick</span> <span m='4733170'>sketch.</span> <span m='4741740'>I'm</span>
  <span m='4742240'>going</span> <span m='4742360'>to</span> <span m='4742420'>try</span>
  <span m='4742570'>to</span> <span m='4742660'>draw</span> <span m='4742870'>the</span>
  <span m='4742960'>generic</span> <span m='4743350'>picture.</span> <span m='4743690'>So</span>
  <span m='4743890'>the</span> <span m='4743980'>generic</span> <span m='4744340'>picture</span>
  <span m='4744540'>is</span> <span m='4744760'>I</span> <span m='4744850'>have</span>
  <span m='4745050'>this</span> <span m='4745540'>thing</span> <span m='4745720'>which</span>
  <span m='4745900'>I</span> <span m='4745960'>call</span> <span m='4746320'>a,</span>
  <span m='4747460'>this</span> <span m='4747640'>thing</span> <span m='4747820'>which</span>
  <span m='4747970'>I</span> <span m='4748030'>call</span> <span m='4748300'>b,</span>
  <span m='4748660'>and</span> <span m='4748750'>we</span> <span m='4748840'>basically</span>
  <span m='4749170'>want</span> <span m='4749320'>to</span> <span m='4749410'>compare</span>
  <span m='4749890'>corresponding</span> <span m='4750490'>items</span> <span m='4750760'>in
  a</span> <span m='4750850'>and</span> <span m='4751090'>b.</span> </p><p><span m='4751960'>Though</span>
  <span m='4752050'>in</span> <span m='4752140'>fact,</span> <span m='4752540'>there's</span>
  <span m='4752650'>another</span> <span m='4752910'>a</span> <span m='4753170'>over</span>
  <span m='4753370'>here</span> <span m='4753850'>and</span> <span m='4754000'>another</span>
  <span m='4754330'>b</span> <span m='4754540'>over</span> <span m='4754750'>here.</span>
  <span m='4755320'>In</span> <span m='4755410'>general,</span> <span m='4755810'>there</span>
  <span m='4755830'>are</span> <span m='4755890'>many</span> <span m='4756175'>a's,</span>
  <span m='4756460'>many</span> <span m='4756700'>b's,</span> <span m='4757540'>but</span>
  <span m='4757630'>they</span> <span m='4757810'>appear</span> <span m='4758110'>in</span>
  <span m='4758170'>this</span> <span m='4758320'>nice</span> <span m='4758560'>periodic</span>
  <span m='4759010'>pattern.</span> <span m='4759580'>And</span> <span m='4759670'>so</span>
  <span m='4759880'>I'm</span> <span m='4760090'>just</span> <span m='4760300'>going</span>
  <span m='4760420'>to</span> <span m='4760480'>look</span> <span m='4760690'>at</span>
  <span m='4760780'>one</span> <span m='4761080'>ab</span> <span m='4761380'>pair,</span>
  <span m='4761650'>but</span> <span m='4761770'>it's</span> <span m='4761890'>going</span>
  <span m='4762010'>to</span> <span m='4762070'>simultaneously</span> <span m='4762760'>work</span>
  <span m='4762910'>for</span> <span m='4763060'>all</span> <span m='4763270'>of</span>
  <span m='4763390'>them</span> <span m='4764500'>with</span> <span m='4764650'>the</span>
  <span m='4764740'>same</span> <span m='4765070'>operations.</span> <span m='4766240'>So</span>
  <span m='4766510'>that's the</span> <span m='4766630'>dot,</span> <span m='4766900'>dot,</span>
  <span m='4767140'>dot</span> <span m='4767410'>here.</span> <span m='4767560'>There's</span>
  <span m='4767710'>another</span> <span m='4768010'>a and</span> <span m='4768310'>then
  another</span> <span m='4768670'>b,</span> <span m='4768880'>and</span> <span m='4768970'>another
  a</span> <span m='4769360'>and</span> <span m='4769450'>another</span> <span m='4769750'>b.</span>
  </p><p><span m='4770860'>So</span> <span m='4771310'>what</span> <span m='4771490'>do</span>
  <span m='4771580'>I</span> <span m='4771670'>do?</span> <span m='4772810'>First</span>
  <span m='4773050'>thing</span> <span m='4773230'>I</span> <span m='4773320'>do</span>
  <span m='4773650'>is</span> <span m='4773980'>make</span> <span m='4775060'>1aa,</span>
  <span m='4776410'>1aa,</span> <span m='4778230'>1aa.</span> <span m='4780760'>In</span>
  <span m='4780820'>other</span> <span m='4780940'>words,</span> <span m='4781120'>I</span>
  <span m='4781240'>add</span> <span m='4781540'>in</span> <span m='4781690'>these</span>
  <span m='4781870'>1</span> <span m='4782110'>bits.</span> <span m='4782510'>Remember,</span>
  <span m='4782830'>we</span> <span m='4782980'>had</span> <span m='4783280'>zeros</span>
  <span m='4783820'>there</span> <span m='4785590'>hanging</span> <span m='4785920'>out.</span>
  <span m='4786555'>That was</span> <span m='4786890'>when</span> <span m='4787030'>we
  were</span> <span m='4787300'>going to</span> <span m='4787400'>use them.</span>
  </p><p><span m='4788230'>So</span> <span m='4788380'>I</span> <span m='4788440'>set</span>
  <span m='4788680'>them</span> <span m='4788830'>all</span> <span m='4788950'>to</span>
  <span m='4789040'>ones</span> <span m='4789310'>in</span> <span m='4789580'>the</span>
  <span m='4789830'>a</span> <span m='4790120'>list.</span> <span m='4791030'>I</span>
  <span m='4791140'>take</span> <span m='4791380'>the</span> <span m='4791470'>b</span>
  <span m='4791670'>list,</span> <span m='4792370'>I</span> <span m='4792460'>just</span>
  <span m='4792610'>shift</span> <span m='4792880'>it</span> <span m='4792970'>over</span>
  <span m='4793720'>and</span> <span m='4793810'>leave</span> <span m='4794020'>them</span>
  <span m='4794170'>as</span> <span m='4794260'>zeros.</span> <span m='4800300'>Time</span>
  <span m='4800540'>for</span> <span m='4800690'>bit</span> <span m='4801180'>tricks.</span>
  </p><p><span m='4801870'>Then</span> <span m='4801980'>I</span> <span m='4802040'>take</span>
  <span m='4802220'>this</span> <span m='4802430'>number,</span> <span m='4802850'>I</span>
  <span m='4803150'>subtract</span> <span m='4803690'>it</span> <span m='4803780'>from</span>
  <span m='4803990'>this</span> <span m='4804140'>number.</span> <span m='4805160'>What</span>
  <span m='4805310'>do</span> <span m='4805400'>I</span> <span m='4805490'>get?</span>
  <span m='4806610'>I</span> <span m='4806630'>get</span> <span m='4806990'>zeros</span>
  <span m='4807470'>or</span> <span m='4807560'>ones</span> <span m='4808640'>for</span>
  <span m='4809240'>whether</span> <span m='4809540'>this</span> <span m='4809720'>bit</span>
  <span m='4809930'>got</span> <span m='4810140'>borrowed,</span> <span m='4810650'>which</span>
  <span m='4810860'>tells</span> <span m='4811070'>me</span> <span m='4811160'>whether</span>
  <span m='4811460'>little</span> <span m='4811730'>a</span> <span m='4811910'>is</span>
  <span m='4812030'>bigger</span> <span m='4812240'>than</span> <span m='4812390'>little</span>
  <span m='4812600'>b.</span> </p><p><span m='4813350'>Then</span> <span m='4813500'>I</span>
  <span m='4813560'>get</span> <span m='4813680'>some</span> <span m='4813860'>junk.</span>
  <span m='4814440'>And</span> <span m='4814540'>then</span> <span m='4814640'>I</span>
  <span m='4814740'>get</span> <span m='4814840'>0,</span> <span m='4814970'>1.</span>
  <span m='4815300'>Junk.</span> <span m='4816320'>So</span> <span m='4816560'>on.</span>
  <span m='4817310'>0,</span> <span m='4817640'>1,</span> <span m='4818440'>junk.</span>
  <span m='4820730'>So</span> <span m='4820910'>0</span> <span m='4821270'>corresponds</span>
  <span m='4821810'>to</span> <span m='4822740'>a</span> <span m='4823100'>being</span>
  <span m='4823460'>smaller</span> <span m='4823880'>than</span> <span m='4824030'>b,</span>
  <span m='4824470'>and</span> <span m='4824570'>1</span> <span m='4824810'>corresponds</span>
  <span m='4825230'>to</span> <span m='4825300'>the</span> <span m='4825380'>reverse.</span>
  <span m='4826720'>OK,</span> <span m='4826820'>whatever.</span> </p><p><span m='4827800'>Then</span>
  <span m='4828020'>I</span> <span m='4828110'>do</span> <span m='4828350'>my</span>
  <span m='4828530'>usual</span> <span m='4828860'>masking,</span> <span m='4830450'>just</span>
  <span m='4830930'>the</span> <span m='4831110'>0,</span> <span m='4831380'>1</span>
  <span m='4831620'>bits,</span> <span m='4831950'>then</span> <span m='4832130'>there's</span>
  <span m='4832200'>some</span> <span m='4832370'>zeros.</span> <span m='4836640'>OK,</span>
  <span m='4836870'>here's</span> <span m='4837080'>a</span> <span m='4837140'>new
  trick</span> <span m='4837560'>which</span> <span m='4837710'>we</span> <span m='4837800'>haven't</span>
  <span m='4838010'>seen</span> <span m='4838250'>yet.</span> <span m='4838760'>I'm</span>
  <span m='4838820'>going</span> <span m='4838970'>to</span> <span m='4839030'>shift</span>
  <span m='4839360'>this</span> <span m='4839570'>to</span> <span m='4839690'>the</span>
  <span m='4839810'>right</span> <span m='4840110'>by</span> <span m='4840400'>two,</span>
  <span m='4841970'>or</span> <span m='4842060'>in</span> <span m='4842150'>general</span>
  <span m='4842450'>by</span> <span m='4842630'>the</span> <span m='4842720'>size</span>
  <span m='4843110'>of</span> <span m='4843200'>those</span> <span m='4843440'>items.</span>
  <span m='4844470'>So</span> <span m='4844570'>now</span> <span m='4844580'>I</span>
  <span m='4844670'>have</span> <span m='4844880'>0,</span> <span m='4845370'>1</span>
  <span m='4845660'>here,</span> <span m='4846620'>0,</span> <span m='4847010'>1</span>
  <span m='4847400'>here,</span> <span m='4848150'>0,</span> <span m='4848420'>1</span>
  <span m='4848630'>here.</span> <span m='4848810'>Each</span> <span m='4848990'>of</span>
  <span m='4849050'>these</span> <span m='4849230'>bits</span> <span m='4849530'>might</span>
  <span m='4849740'>be</span> <span m='4849860'>different.</span> </p><p><span m='4850880'>So</span>
  <span m='4850970'>I</span> <span m='4851030'>take</span> <span m='4851300'>this,</span>
  <span m='4851570'>shift</span> <span m='4851930'>to</span> <span m='4852080'>the</span>
  <span m='4852200'>right.</span> <span m='4853140'>Now</span> <span m='4853490'>I</span>
  <span m='4853610'>subtract.</span> <span m='4855560'>What</span> <span m='4855770'>this</span>
  <span m='4855920'>gives</span> <span m='4856220'>me--</span> <span m='4857400'>so</span>
  <span m='4858010'>I'm</span> <span m='4858110'>taking</span> <span m='4858420'>1,
  0,</span> <span m='4858755'>0,</span> <span m='4859090'>0,</span> <span m='4859800'>minus</span>
  <span m='4860210'>1.</span> <span m='4860690'>What</span> <span m='4861170'>I</span>
  <span m='4861230'>get</span> <span m='4861440'>is</span> <span m='4861620'>0,</span>
  <span m='4862520'>1,</span> <span m='4862850'>1,</span> <span m='4863090'>1.</span>
  </p><p><span m='4863750'>OK,</span> <span m='4863990'>in</span> <span m='4864080'>this</span>
  <span m='4864200'>case,</span> <span m='4864480'>there's</span> <span m='4864530'>just</span>
  <span m='4864680'>two</span> <span m='4864860'>bits.</span> <span m='4866160'>Except</span>
  <span m='4866300'>it's</span> <span m='4866420'>not</span> <span m='4866630'>1,</span>
  <span m='4866930'>1.</span> <span m='4867230'>It's</span> <span m='4867890'>either</span>
  <span m='4872046'>0,</span> <span m='4872500'>0</span> <span m='4872954'>or</span>
  <span m='4873410'>1,</span> <span m='4873710'>1.</span> <span m='4874760'>And</span>
  <span m='4874880'>then</span> <span m='4875060'>we</span> <span m='4875210'>have</span>
  <span m='4875540'>here</span> <span m='4876350'>0,</span> <span m='4876758'>and
  then</span> <span m='4877166'>0,</span> <span m='4877574'>0</span> <span m='4877982'>or</span>
  <span m='4878390'>1,</span> <span m='4878660'>1,</span> <span m='4880980'>and</span>
  <span m='4881080'>so</span> <span m='4881090'>on.</span> </p><p><span m='4882120'>So</span>
  <span m='4882170'>now</span> <span m='4882500'>these</span> <span m='4882770'>are</span>
  <span m='4882890'>masks.</span> <span m='4884630'>The</span> <span m='4884720'>zeros</span>
  <span m='4885140'>correspond</span> <span m='4885800'>to</span> <span m='4886100'>when</span>
  <span m='4886310'>the</span> <span m='4886430'>a's</span> <span m='4886790'>were</span>
  <span m='4887630'>smaller,</span> <span m='4888410'>the</span> <span m='4888500'>ones</span>
  <span m='4888740'>correspond</span> <span m='4889160'>to</span> <span m='4889250'>when</span>
  <span m='4889370'>the</span> <span m='4889460'>b's</span> <span m='4889760'>are</span>
  <span m='4889850'>smaller.</span> <span m='4891020'>So</span> <span m='4891680'>if</span>
  <span m='4891830'>I</span> <span m='4891890'>take</span> <span m='4892190'>this</span>
  <span m='4893060'>[? added ?]</span> <span m='4893540'>with</span> <span m='4894830'>this,</span>
  <span m='4895490'>I</span> <span m='4895610'>get</span> <span m='4895880'>the</span>
  <span m='4896900'>large</span> <span m='4897320'>b's.</span> <span m='4898430'>If</span>
  <span m='4898550'>I</span> <span m='4898610'>take</span> <span m='4898790'>this</span>
  <span m='4899000'>[? added ?]</span> <span m='4899210'>with</span> <span m='4899390'>this,</span>
  <span m='4899870'>I</span> <span m='4899990'>get</span> <span m='4900260'>the</span>
  <span m='4900650'>small</span> <span m='4901430'>a's.</span> <span m='4902480'>Or</span>
  <span m='4902690'>one</span> <span m='4902860'>of</span> <span m='4902960'>some</span>
  <span m='4903240'>of</span> <span m='4903400'>those</span> <span m='4903560'>combinations.</span>
  </p><p><span m='4905630'>The</span> <span m='4905780'>point</span> <span m='4906020'>is</span>
  <span m='4906350'>I</span> <span m='4906500'>take--</span> <span m='4908240'>I</span>
  <span m='4908270'>think</span> <span m='4908480'>here</span> <span m='4908840'>I</span>
  <span m='4908960'>get</span> <span m='4909260'>the</span> <span m='4910760'>small</span>
  <span m='4911490'>a's.</span> <span m='4915080'>And</span> <span m='4915320'>then</span>
  <span m='4915830'>if</span> <span m='4916100'>I</span> <span m='4917150'>take</span>
  <span m='4917420'>this</span> <span m='4917660'>thing</span> <span m='4918800'>and</span>
  <span m='4919040'>negate</span> <span m='4919490'>it</span> <span m='4921920'>and</span>
  <span m='4922040'>then</span> <span m='4922280'>mask</span> <span m='4925190'>it
  with</span> <span m='4925340'>this</span> <span m='4926450'>I</span> <span m='4926540'>get</span>
  <span m='4926840'>the</span> <span m='4927080'>small</span> <span m='4927470'>b's.</span>
  <span m='4931750'>And</span> <span m='4932110'>then</span> <span m='4932220'>I</span>
  <span m='4932280'>take</span> <span m='4932520'>this</span> <span m='4932760'>thing--</span>
  <span m='4933120'>I</span> <span m='4933410'>ran</span> <span m='4933680'>out</span>
  <span m='4933840'>of</span> <span m='4933930'>room.</span> <span m='4934950'>So</span>
  <span m='4935060'>I've</span> <span m='4935130'>got</span> <span m='4935280'>small</span>
  <span m='4935640'>a's,</span> <span m='4938550'>small</span> <span m='4938940'>b's.</span>
  <span m='4942240'>I</span> <span m='4942330'>take</span> <span m='4942510'>this</span>
  <span m='4942720'>thing</span> <span m='4943080'>I</span> <span m='4943200'>shift
  it</span> <span m='4943650'>over</span> <span m='4944100'>so</span> <span m='4944250'>I</span>
  <span m='4944310'>have</span> <span m='4944490'>small</span> <span m='4944760'>b's</span>
  <span m='4945105'>here.</span> <span m='4949020'>And</span> <span m='4949110'>then</span>
  <span m='4949270'>I</span> <span m='4949620'>OR</span> <span m='4949860'>these</span>
  <span m='4950100'>together,</span> <span m='4951310'>I</span> <span m='4951410'>get</span>
  <span m='4951480'>all</span> <span m='4951600'>the</span> <span m='4951660'>smalls.</span>
  </p><p><span m='4953620'>OK,</span> <span m='4953970'>these</span> <span m='4954210'>are</span>
  <span m='4954300'>designed</span> <span m='4954750'>to</span> <span m='4954840'>never</span>
  <span m='4955140'>conflict</span> <span m='4956460'>because</span> <span m='4956820'>I</span>
  <span m='4956940'>took</span> <span m='4957300'>the</span> <span m='4957450'>inversion</span>
  <span m='4957930'>here.</span> <span m='4958740'>So</span> <span m='4958860'>I</span>
  <span m='4958950'>get</span> <span m='4959100'>the</span> <span m='4959190'>smaller</span>
  <span m='4959580'>of the a's,</span> <span m='4959790'>smaller</span> <span m='4960190'>of</span>
  <span m='4960270'>the</span> <span m='4960390'>b's.</span> <span m='4960770'>So</span>
  <span m='4961110'>now</span> <span m='4961440'>I</span> <span m='4961530'>put</span>
  <span m='4962580'>the</span> <span m='4962700'>smaller</span> <span m='4963060'>things</span>
  <span m='4963330'>in</span> <span m='4963480'>the</span> <span m='4963600'>right</span>
  <span m='4963840'>order.</span> <span m='4964590'>I</span> <span m='4964710'>do</span>
  <span m='4964860'>exactly</span> <span m='4965640'>the</span> <span m='4965700'>same</span>
  <span m='4965880'>procedure</span> <span m='4966330'>negated,</span> <span m='4967220'>and</span>
  <span m='4967500'>get</span> <span m='4967650'>the</span> <span m='4967790'>larges.</span>
  <span m='4971210'>And</span> <span m='4971310'>then</span> <span m='4971430'>I</span>
  <span m='4971520'>OR</span> <span m='4971730'>these</span> <span m='4971970'>together</span>
  <span m='4973080'>and</span> <span m='4973230'>I</span> <span m='4973290'>get</span>
  <span m='4974140'>sorted.</span> </p><p><span m='4977430'>Well,</span> <span m='4977640'>not</span>
  <span m='4977820'>sorted.</span> <span m='4978330'>I</span> <span m='4978420'>get</span>
  <span m='4978630'>whatever</span> <span m='4979670'>bitonic</span> <span m='4980170'>sort</span>
  <span m='4980400'>would</span> <span m='4980550'>have</span> <span m='4980640'>done.</span>
  <span m='4981600'>It's</span> <span m='4981930'>doing</span> <span m='4982200'>these</span>
  <span m='4982350'>pairwise</span> <span m='4982770'>comparisons</span> <span m='4983460'>by</span>
  <span m='4983580'>doing</span> <span m='4983820'>this</span> <span m='4983940'>shift</span>
  <span m='4985140'>and</span> <span m='4985400'>it's</span> <span m='4985500'>putting</span>
  <span m='4985800'>things</span> <span m='4986010'>in</span> <span m='4986070'>the</span>
  <span m='4986160'>right</span> <span m='4986370'>order.</span> <span m='4986970'>The</span>
  <span m='4987090'>small</span> <span m='4987330'>ones</span> <span m='4987570'>always</span>
  <span m='4987780'>end</span> <span m='4987900'>up</span> <span m='4988020'>on</span>
  <span m='4988080'>the</span> <span m='4988170'>left,</span> <span m='4988890'>the</span>
  <span m='4988980'>large</span> <span m='4989220'>ones</span> <span m='4989400'>always</span>
  <span m='4989610'>end</span> <span m='4989760'>up</span> <span m='4989880'>on</span>
  <span m='4989970'>the</span> <span m='4990060'>right.</span> <span m='4990270'>That's</span>
  <span m='4990540'>the</span> <span m='4990660'>definition</span> <span m='4991170'>of</span>
  <span m='4991260'>the</span> <span m='4991380'>operation</span> <span m='4991800'>we</span>
  <span m='4991860'>want</span> <span m='4992040'>to</span> <span m='4992100'>do.</span>
  <span m='4993790'>Bitonic</span> <span m='4995530'>operated.</span> </p><p><span
  m='4996810'>And</span> <span m='4997170'>because</span> <span m='4997440'>we</span>
  <span m='4997500'>are</span> <span m='4997590'>just</span> <span m='4997740'>doing</span>
  <span m='4997950'>shifts,</span> <span m='4998340'>and</span> <span m='4998430'>subtractions,</span>
  <span m='4999060'>and</span> <span m='4999150'>all</span> <span m='4999270'>these</span>
  <span m='4999420'>things,</span> <span m='5000260'>it</span> <span m='5000440'>works</span>
  <span m='5000800'>even</span> <span m='5001070'>though</span> <span m='5001160'>there's</span>
  <span m='5001310'>not</span> <span m='5001460'>just</span> <span m='5001610'>one</span>
  <span m='5001820'>ab</span> <span m='5002120'>pair,</span> <span m='5002420'>but</span>
  <span m='5002510'>there's</span> <span m='5002660'>a</span> <span m='5002750'>whole</span>
  <span m='5002990'>bunch</span> <span m='5003230'>of</span> <span m='5003320'>ab</span>
  <span m='5003560'>pairs.</span> <span m='5003830'>They</span> <span m='5003950'>will</span>
  <span m='5004070'>all</span> <span m='5004310'>be</span> <span m='5004460'>shifted,</span>
  <span m='5004910'>and</span> <span m='5005450'>computed,</span> <span m='5006050'>and</span>
  <span m='5006410'>sorted</span> <span m='5006980'>together.</span> <span m='5008460'>It's</span>
  <span m='5009500'>a</span> <span m='5009930'>little</span> <span m='5010130'>hard</span>
  <span m='5010280'>to</span> <span m='5010370'>visualize</span> <span m='5010880'>but</span>
  <span m='5011030'>this</span> <span m='5011210'>will</span> <span m='5011330'>do</span>
  <span m='5011660'>one</span> <span m='5011870'>bitonic</span> <span m='5012350'>operation</span>
  <span m='5013180'>and</span> <span m='5013280'>a</span> <span m='5013340'>constant</span>
  <span m='5013760'>number</span> <span m='5014090'>of</span> <span m='5014270'>word</span>
  <span m='5014480'>ram</span> <span m='5014720'>operations.</span> <span m='5015890'>And</span>
  <span m='5015980'>so</span> <span m='5016180'>you</span> <span m='5016310'>pop</span>
  <span m='5016610'>out</span> <span m='5016970'>all</span> <span m='5017210'>these</span>
  <span m='5017360'>stacks</span> <span m='5018350'>this</span> <span m='5018500'>gives</span>
  <span m='5018740'>us</span> <span m='5018860'>a</span> <span m='5018950'>merger,</span>
  <span m='5019850'>that</span> <span m='5020000'>gives</span> <span m='5020200'>us</span>
  <span m='5020330'>packed</span> <span m='5020630'>sorting,</span> <span m='5021110'>and</span>
  <span m='5021440'>with</span> <span m='5021680'>packed</span> <span m='5021970'>sorting</span>
  <span m='5022700'>we</span> <span m='5022850'>get</span> <span m='5023900'>signature</span>
  <span m='5024350'>sorting.</span> <span m='5025130'>Easy,</span> <span m='5025460'>right?</span>
  </p><p><span m='5028010'>All</span> <span m='5028070'>right,</span> <span m='5028200'>that's</span>
  <span m='5028310'>probably</span> <span m='5028580'>one</span> <span m='5028730'>of</span>
  <span m='5028790'>the</span> <span m='5028880'>most</span> <span m='5029090'>complicated</span>
  <span m='5029600'>algorithms</span> <span m='5030050'>we'll</span> <span m='5030170'>see</span>
  <span m='5030350'>in</span> <span m='5030440'>this</span> <span m='5030590'>class.</span>
  <span m='5030950'>But</span> <span m='5031490'>from</span> <span m='5031640'>that</span>
  <span m='5031880'>you</span> <span m='5032000'>get</span> <span m='5032150'>a</span>
  <span m='5032210'>priority</span> <span m='5032750'>queue</span> <span m='5033110'>that</span>
  <span m='5033230'>runs</span> <span m='5033440'>in</span> <span m='5033530'>constant</span>
  <span m='5033920'>time</span> <span m='5034190'>provided</span> <span m='5034580'>w</span>
  <span m='5034910'>is</span> <span m='5035040'>a</span> <span m='5035060'>little</span>
  <span m='5035300'>bigger</span> <span m='5035570'>than</span> <span m='5035810'>log</span>
  <span m='5036110'>squared</span> <span m='5036410'>n.</span> <span m='5037010'>Boom.</span>
  </p>
type: course
uid: dcf206fd0a4e424a3f0ded0f3a030161

---
None