---
about_this_resource_text: <p><strong>Description:</strong> Partial and full retroactivity
  let us alter and manipulate the order of operations, and investigate the results.  A
  third type, &quot;non-oblivious&quot;, puts queries on the timeline as well, and
  reports the first query whose answer changed.</p> <p><strong>Speaker:</strong> Prof.
  Erik Demaine</p>
course_id: 6-851-advanced-data-structures-spring-2012
embedded_media:
- id: Video-YouTube-Stream
  media_location: WqCWghETNDc
  parent_uid: 7a6f6d94d65b1f04b0f7e26b47f4a490
  title: Video-YouTube-Stream
  type: Video
  uid: ed21bff913779b145b93b3559117ba49
- id: Video-iTunesU-MP4
  media_location: https://itunes.apple.com/us/itunes-u/session-2-retroactive-data/id735348884?i=169609893
  parent_uid: 7a6f6d94d65b1f04b0f7e26b47f4a490
  title: Video-iTunes U-MP4
  type: Video
  uid: f9fb4d0d5f7f662e554b6d7735ef194b
- id: Video-InternetArchive-MP4
  media_location: http://www.archive.org/download/MIT6.851S12/MIT6_851S12_lec02_300k.mp4
  parent_uid: 7a6f6d94d65b1f04b0f7e26b47f4a490
  title: Video-Internet Archive-MP4
  type: Video
  uid: baf84830c97cd31e328038396315c56c
- id: Thumbnail-YouTube-JPG
  media_location: https://img.youtube.com/vi/WqCWghETNDc/default.jpg
  parent_uid: 7a6f6d94d65b1f04b0f7e26b47f4a490
  title: Thumbnail-YouTube-JPG
  type: Thumbnail
  uid: 2af5a7152867fe8989e13b8cc797b2d3
- id: 3Play-3PlayYouTubeid-MP4
  media_location: WqCWghETNDc
  parent_uid: 7a6f6d94d65b1f04b0f7e26b47f4a490
  title: 3Play-3Play YouTube id
  type: 3Play
  uid: ca0b2a0ff652378f878244aa1976af72
- id: WqCWghETNDc.srt
  parent_uid: 7a6f6d94d65b1f04b0f7e26b47f4a490
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-851-advanced-data-structures-spring-2012/lecture-videos/session-2-retroactive-data-structures/WqCWghETNDc.srt
  title: 3play caption file
  type: null
  uid: 26fca207413b95859039b76237b69de5
- id: WqCWghETNDc.pdf
  parent_uid: 7a6f6d94d65b1f04b0f7e26b47f4a490
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-851-advanced-data-structures-spring-2012/lecture-videos/session-2-retroactive-data-structures/WqCWghETNDc.pdf
  title: 3play pdf file
  type: null
  uid: ca7b65edbee1b231cfdc3f9261548f73
- id: Caption-3Play YouTube id-SRT
  parent_uid: 7a6f6d94d65b1f04b0f7e26b47f4a490
  title: Caption-3Play YouTube id-SRT-English - US
  type: Caption
  uid: a3ef0a4b15f04712e4cebc20791ef7c1
- id: Transcript-3Play YouTube id-PDF
  parent_uid: 7a6f6d94d65b1f04b0f7e26b47f4a490
  title: Transcript-3Play YouTube id-PDF-English - US
  type: Transcript
  uid: 4583d43ada20776a02a6f8a4096dc5a9
inline_embed_id: 58396692session2:retroactivedatastructures70181234
layout: video
order_index: null
parent_uid: b66cbbb7b35e74ff17cdbf44e5fb6b1d
related_resources_text: ''
short_url: session-2-retroactive-data-structures
technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-851-advanced-data-structures-spring-2012/lecture-videos/session-2-retroactive-data-structures
template_type: Tabbed
title: 'Session 2: Retroactive Data Structures'
transcript: <p><span m='90'>The</span> <span m='180'>following</span> <span m='630'>content</span>
  <span m='1200'>is</span> <span m='1320'>provided</span> <span m='1770'>under</span>
  <span m='2009'>a</span> <span m='2070'>Creative</span> <span m='2490'>Commons</span>
  <span m='2910'>license.</span> <span m='4030'>Your</span> <span m='4200'>support</span>
  <span m='4710'>will</span> <span m='4860'>help</span> <span m='5100'>MIT</span>
  <span m='5550'>OpenCourseWare</span> <span m='6360'>continue</span> <span m='6870'>to</span>
  <span m='6960'>offer</span> <span m='7380'>high</span> <span m='7620'>quality</span>
  <span m='8100'>educational</span> <span m='8730'>resources</span> <span m='9330'>for</span>
  <span m='9510'>free.</span> <span m='10720'>To</span> <span m='10740'>make</span>
  <span m='10920'>a</span> <span m='10980'>donation</span> <span m='11730'>or</span>
  <span m='11940'>view</span> <span m='12390'>additional</span> <span m='12810'>materials</span>
  <span m='13320'>from</span> <span m='13500'>hundreds</span> <span m='13920'>of</span>
  <span m='14040'>MIT</span> <span m='14460'>courses,</span> <span m='15550'>visit</span>
  <span m='15780'>MIT</span> <span m='16200'>OpenCourseWare</span> <span m='17280'>at</span>
  <span m='17430'>ocw.mit.edu.</span> </p><p><span m='22110'>ERIK DEMAINE:</span>
  <span m='22135'>All</span> <span m='22160'>right,</span> <span m='22430'>welcome</span>
  <span m='22730'>back</span> <span m='22910'>to</span> <span m='23000'>6.851.</span>
  <span m='25092'>We</span> <span m='25550'>continue</span> <span m='26120'>our</span>
  <span m='26360'>theme</span> <span m='26870'>of</span> <span m='27080'>time</span>
  <span m='27380'>travel</span> <span m='27680'>today.</span> <span m='28530'>Before</span>
  <span m='28850'>I</span> <span m='28940'>get</span> <span m='29090'>started,</span>
  <span m='29780'>I</span> <span m='29900'>wanted</span> <span m='30140'>to</span>
  <span m='30230'>briefly</span> <span m='30590'>talk</span> <span m='30800'>about</span>
  <span m='31010'>the</span> <span m='31130'>project,</span> <span m='31640'>which</span>
  <span m='31800'>I</span> <span m='31880'>forgot</span> <span m='32150'>to</span>
  <span m='32210'>talk</span> <span m='32390'>about</span> <span m='32570'>in</span>
  <span m='32670'>lecture</span> <span m='32960'>one.</span> <span m='33650'>Project</span>
  <span m='34070'>is</span> <span m='34190'>sort</span> <span m='34400'>of</span>
  <span m='34460'>the</span> <span m='34550'>focus</span> <span m='35030'>of</span>
  <span m='35330'>your</span> <span m='35540'>evaluation</span> <span m='36210'>in</span>
  <span m='36320'>the</span> <span m='36380'>class,</span> <span m='36710'>other</span>
  <span m='36920'>than</span> <span m='37220'>problems</span> <span m='37570'>sets</span>
  <span m='37760'>inscribing,</span> <span m='38380'>it's</span> <span m='39350'>supposed</span>
  <span m='39620'>to</span> <span m='39710'>be</span> <span m='39800'>the</span> <span
  m='39890'>bulk</span> <span m='40130'>of</span> <span m='40190'>the</span> <span
  m='40310'>work.</span> <span m='40590'>Project</span> <span m='40940'>can</span>
  <span m='41120'>be</span> <span m='41270'>theoretical,</span> <span m='41870'>trying</span>
  <span m='42110'>to</span> <span m='42200'>solve</span> <span m='42440'>an</span>
  <span m='42480'>open</span> <span m='42710'>problem.</span> <span m='43010'>You</span>
  <span m='43100'>don't</span> <span m='43250'>have</span> <span m='43400'>to</span>
  <span m='43520'>succeed.</span> <span m='44510'>If</span> <span m='44600'>you</span>
  <span m='44690'>want</span> <span m='44840'>to</span> <span m='44900'>do</span>
  <span m='44990'>that,</span> <span m='45140'>you</span> <span m='45200'>should</span>
  <span m='45380'>come</span> <span m='45560'>to</span> <span m='45660'>the</span>
  <span m='45780'>open</span> <span m='46070'>problem</span> <span m='46340'>sessions.</span>
  </p><p><span m='47480'>Could</span> <span m='47750'>be</span> <span m='48590'>a</span>
  <span m='48770'>survey</span> <span m='49520'>of</span> <span m='49940'>things,</span>
  <span m='50370'>especially</span> <span m='50720'>not</span> <span m='51590'>covered
  in</span> <span m='52040'>class,</span> <span m='52520'>or</span> <span m='52670'>not</span>
  <span m='52850'>covered</span> <span m='53060'>in</span> <span m='53150'>class</span>
  <span m='53420'>in</span> <span m='53480'>much</span> <span m='53690'>detail.</span>
  <span m='54500'>Look</span> <span m='54650'>at</span> <span m='54710'>a</span> <span
  m='54740'>few</span> <span m='54920'>papers.</span> <span m='55790'>Could</span>
  <span m='55970'>be</span> <span m='56150'>an</span> <span m='56240'>implementation</span>
  <span m='56960'>of</span> <span m='57080'>one</span> <span m='57230'>of</span> <span
  m='57320'>these</span> <span m='57890'>data</span> <span m='58070'>structures.</span>
  <span m='58490'>A</span> <span m='58550'>lot</span> <span m='58760'>of</span> <span
  m='58850'>the</span> <span m='58970'>data</span> <span m='59180'>structures</span>
  <span m='60260'>we're</span> <span m='60320'>talking</span> <span m='60590'>about</span>
  <span m='60740'>here</span> <span m='60890'>have</span> <span m='60980'>never</span>
  <span m='61250'>been</span> <span m='61370'>implemented.</span> <span m='61850'>We</span>
  <span m='61970'>don't</span> <span m='62120'>know</span> <span m='62330'>how</span>
  <span m='62540'>well</span> <span m='62780'>they</span> <span m='62900'>perform</span>
  <span m='63290'>in</span> <span m='63380'>practice,</span> <span m='64069'>and</span>
  <span m='64190'>it'd</span> <span m='64310'>cool</span> <span m='64510'>to</span>
  <span m='64580'>find</span> <span m='64849'>out.</span> <span m='65300'>Many</span>
  <span m='65510'>of</span> <span m='65570'>them</span> <span m='65690'>have though,</span>
  <span m='66160'>so</span> <span m='66290'>you</span> <span m='66380'>should</span>
  <span m='66530'>do</span> <span m='66680'>one</span> <span m='66830'>that</span>
  <span m='66950'>hasn't</span> <span m='67280'>been</span> <span m='67460'>done</span>
  <span m='67640'>already.</span> <span m='69980'>Those</span> <span m='70160'>are</span>
  <span m='70220'>the</span> <span m='70310'>main</span> <span m='71120'>project</span>
  <span m='71480'>types.</span> </p><p><span m='71840'>There</span> <span m='71960'>will</span>
  <span m='72920'>in</span> <span m='73070'>a</span> <span m='73160'>month</span>
  <span m='73580'>or</span> <span m='73730'>so,</span> <span m='74150'>there</span>
  <span m='74300'>will</span> <span m='74420'>be</span> <span m='74630'>a</span> <span
  m='74870'>project</span> <span m='75260'>proposal</span> <span m='75710'>deadline</span>
  <span m='76130'>where</span> <span m='76220'>you</span> <span m='76280'>have</span>
  <span m='76370'>to</span> <span m='76490'>pick</span> <span m='76700'>what</span>
  <span m='76820'>you're</span> <span m='76940'>doing.</span> <span m='77750'>And</span>
  <span m='77870'>then</span> <span m='78740'>the</span> <span m='79040'>project</span>
  <span m='79430'>itself</span> <span m='79700'>is</span> <span m='79800'>due</span>
  <span m='79950'>last</span> <span m='80210'>day</span> <span m='80330'>of</span>
  <span m='80390'>classes.</span> <span m='81500'>And</span> <span m='81920'>in</span>
  <span m='82340'>the</span> <span m='82430'>last</span> <span m='82850'>few</span>
  <span m='83480'>lectures,</span> <span m='84080'>there</span> <span m='84200'>will</span>
  <span m='84320'>be</span> <span m='84620'>project</span> <span m='85010'>presentations.</span>
  <span m='85700'>So you'll</span> <span m='85760'>also</span> <span m='85970'>have</span>
  <span m='86060'>to</span> <span m='86180'>give</span> <span m='86330'>a</span> <span
  m='86390'>talk</span> <span m='86660'>about</span> <span m='86900'>it.</span> </p><p><span
  m='87290'>You</span> <span m='87410'>can</span> <span m='87530'>do</span> <span
  m='87620'>group</span> <span m='87800'>projects.</span> <span m='88550'>And</span>
  <span m='89330'>for</span> <span m='89510'>more</span> <span m='89720'>people</span>
  <span m='90050'>we</span> <span m='90140'>expect</span> <span m='90710'>more</span>
  <span m='91040'>stuff</span> <span m='91400'>to</span> <span m='91490'>be</span>
  <span m='91580'>done,</span> <span m='91850'>that's</span> <span m='92030'>all.</span>
  <span m='93210'>Otherwise</span> <span m='93590'>unconstrained.</span> </p><p><span
  m='94880'>So</span> <span m='96350'>in</span> <span m='97010'>time</span> <span
  m='97400'>travel</span> <span m='98210'>land,</span> <span m='99520'>I</span> <span
  m='99650'>guess</span> <span m='99830'>the</span> <span m='99950'>most</span> <span
  m='100190'>sort</span> <span m='100340'>of</span> <span m='100400'>physically</span>
  <span m='101000'>realistic</span> <span m='101660'>physics</span> <span m='102090'>land,</span>
  <span m='103450'>if</span> <span m='103790'>time</span> <span m='104090'>travel</span>
  <span m='104420'>is</span> <span m='104630'>branching</span> <span m='105050'>universes</span>
  <span m='105670'>where</span> <span m='105890'>if</span> <span m='106070'>you</span>
  <span m='106160'>make</span> <span m='106370'>a</span> <span m='106400'>change</span>
  <span m='106670'>in</span> <span m='106730'>the</span> <span m='106820'>past</span>
  <span m='107150'>you</span> <span m='107240'>get</span> <span m='107360'>a</span>
  <span m='107420'>totally</span> <span m='107780'>new</span> <span m='107900'>universe.</span>
  <span m='108410'>That's</span> <span m='109220'>full</span> <span m='109460'>persistence.</span>
  <span m='110370'>That's</span> <span m='110660'>last</span> <span m='110900'>class.</span>
  </p><p><span m='111920'>Today</span> <span m='112250'>we're</span> <span m='112370'>going</span>
  <span m='112450'>to</span> <span m='112550'>do</span> <span m='112700'>the</span>
  <span m='112790'>more</span> <span m='112970'>science</span> <span m='113270'>fiction-y</span>
  <span m='113750'>approach</span> <span m='114230'>to</span> <span m='114470'>time</span>
  <span m='114770'>travel,</span> <span m='115580'>which</span> <span m='115820'>is</span>
  <span m='116570'>you</span> <span m='116810'>can--</span> <span m='117290'>like
  in</span> <span m='117770'><i>Back</i></span> <span m='117950'><i>to</i></span>
  <span m='118070'><i>the</i></span> <span m='118130'><i>Future.</i></span> <span
  m='118560'>You</span> <span m='118580'>can</span> <span m='118700'>go</span> <span
  m='118850'>back</span> <span m='119120'>in</span> <span m='119210'>time,</span>
  <span m='119870'>make</span> <span m='120080'>a</span> <span m='120140'>change,</span>
  <span m='120560'>and</span> <span m='120680'>then</span> <span m='120800'>return</span>
  <span m='121190'>to</span> <span m='121280'>the</span> <span m='121370'>present</span>
  <span m='121820'>and</span> <span m='121970'>see</span> <span m='122180'>all</span>
  <span m='122510'>the</span> <span m='122690'>intervening--</span> <span m='123800'>the</span>
  <span m='123890'>result</span> <span m='124220'>of</span> <span m='124310'>all</span>
  <span m='124430'>the</span> <span m='124550'>intervening</span> <span m='125240'>things</span>
  <span m='125660'>that</span> <span m='125750'>happen</span> <span m='126150'>meanwhile.</span>
  <span m='128120'>A</span> <span m='128240'>fun</span> <span m='128509'>example</span>
  <span m='128900'>of</span> <span m='128990'>this,</span> <span m='129320'>if</span>
  <span m='129530'>you</span> <span m='129680'>haven't</span> <span m='129919'>seen</span>
  <span m='130160'>it,</span> <span m='130250'>is</span> <span m='130490'>the</span>
  <span m='130580'>movie</span> <span m='130820'><i>Time</i></span> <span m='131180'><i>Cop,</i></span>
  <span m='132110'>where</span> <span m='132630'>there's</span> <span m='132830'>this</span>
  <span m='133040'>guy</span> <span m='133580'>going</span> <span m='133880'>back</span>
  <span m='134090'>in</span> <span m='134180'>time,</span> <span m='134570'>trying</span>
  <span m='134810'>to</span> <span m='135530'>fight</span> <span m='136040'>evil</span>
  <span m='136400'>time</span> <span m='136690'>travelers.</span> <span m='137810'>And</span>
  <span m='138440'>when</span> <span m='138560'>he</span> <span m='138650'>returns</span>
  <span m='139570'>to</span> <span m='139700'>the</span> <span m='139970'>present,</span>
  <span m='140420'>sometimes,</span> <span m='141550'>like</span> <span m='141950'>the</span>
  <span m='142130'>whole</span> <span m='142310'>time</span> <span m='142550'>travel</span>
  <span m='142820'>service</span> <span m='143230'>is</span> <span m='143300'>starting</span>
  <span m='143630'>to</span> <span m='143750'>fail.</span> <span m='144140'>And</span>
  <span m='144260'>there's</span> <span m='144410'>this</span> <span m='144560'>worry</span>
  <span m='144800'>that</span> <span m='144890'>he'll</span> <span m='145010'>never</span>
  <span m='145280'>be</span> <span m='145370'>able</span> <span m='145490'>to</span>
  <span m='145580'>return</span> <span m='145850'>to</span> <span m='145940'>the</span>
  <span m='146030'>present.</span> </p><p><span m='146900'>So</span> <span m='146990'>anyway,</span>
  <span m='147350'>we</span> <span m='147500'>want</span> <span m='147690'>to</span>
  <span m='147780'>do</span> <span m='147980'>that</span> <span m='148940'>with</span>
  <span m='149120'>the</span> <span m='149210'>data</span> <span m='149450'>structure.</span>
  <span m='150240'>So</span> <span m='150890'>this</span> <span m='151070'>is</span>
  <span m='151130'>the</span> <span m='151250'>idea</span> <span m='151460'>of</span>
  <span m='151550'>retroactivity.</span> <span m='153440'>In</span> <span m='153560'>general,</span>
  <span m='154020'>we</span> <span m='154070'>think</span> <span m='154970'>of</span>
  <span m='155180'>a</span> <span m='155240'>data</span> <span m='155510'>structure</span>
  <span m='155990'>as</span> <span m='156140'>having</span> <span m='156470'>a</span>
  <span m='156530'>timeline.</span> </p><p><span m='166460'>We're</span> <span m='166580'>going</span>
  <span m='166670'>to</span> <span m='166790'>maintain</span> <span m='167240'>one</span>
  <span m='167690'>linear</span> <span m='168020'>timeline</span> <span m='169850'>of</span>
  <span m='170210'>updates.</span> <span m='172520'>So</span> <span m='172790'>here's</span>
  <span m='174200'>time.</span> <span m='177990'>And</span> <span m='178100'>the</span>
  <span m='178190'>idea</span> <span m='178460'>is,</span> <span m='178770'>well,</span>
  <span m='178950'>maybe</span> <span m='179270'>at</span> <span m='179630'>time</span>
  <span m='179960'>0</span> <span m='180920'>you</span> <span m='181070'>do</span>
  <span m='182090'>an</span> <span m='182180'>insert</span> <span m='183980'>of</span>
  <span m='184300'>7.</span> <span m='185810'>And</span> <span m='185960'>then</span>
  <span m='186320'>at</span> <span m='186470'>time</span> <span m='186830'>1,</span>
  <span m='187790'>you</span> <span m='187940'>maybe</span> <span m='188180'>did</span>
  <span m='188360'>an</span> <span m='188480'>insert</span> <span m='189990'>of</span>
  <span m='190640'>3.</span> <span m='191600'>And</span> <span m='191750'>then</span>
  <span m='192080'>at</span> <span m='192230'>time</span> <span m='192620'>2,</span>
  <span m='193420'>you</span> <span m='193550'>did</span> <span m='193820'>a</span>
  <span m='193950'>delete-min.</span> </p><p><span m='198860'>OK,</span> <span m='199100'>what's</span>
  <span m='199280'>that</span> <span m='199460'>spell?</span> <span m='199960'>Or,</span>
  <span m='200030'>at the</span> <span m='200430'>end</span> <span m='200570'>you</span>
  <span m='200680'>have--</span> <span m='201200'>right</span> <span m='201320'>now,</span>
  <span m='201570'>you'd</span> <span m='201590'>have</span> <span m='201740'>just</span>
  <span m='202040'>the</span> <span m='202190'>element</span> <span m='202550'>7.</span>
  <span m='203810'>In</span> <span m='203960'>general,</span> <span m='204860'>every</span>
  <span m='205460'>data</span> <span m='205700'>structure</span> <span m='206030'>you</span>
  <span m='206150'>can</span> <span m='206270'>think</span> <span m='206480'>of</span>
  <span m='206600'>is</span> <span m='206720'>this.</span> <span m='206900'>Now</span>
  <span m='207050'>normally,</span> <span m='208010'>we're</span> <span m='208220'>always</span>
  <span m='208520'>appending</span> <span m='209420'>to</span> <span m='209540'>the</span>
  <span m='209660'>timeline</span> <span m='210590'>that's</span> <span m='210830'>working</span>
  <span m='211130'>in</span> <span m='211220'>the</span> <span m='211310'>present.</span>
  <span m='213200'>You're</span> <span m='213410'>doing</span> <span m='213740'>operations</span>
  <span m='214910'>on</span> <span m='215030'>the</span> <span m='215120'>present.</span>
  <span m='215900'>But</span> <span m='216050'>we'd</span> <span m='216230'>like</span>
  <span m='216380'>to</span> <span m='216890'>allow--</span> <span m='217310'>with</span>
  <span m='217520'>retroactive</span> <span m='218090'>data</span> <span m='218300'>structures</span>
  <span m='218750'>you</span> <span m='218840'>can</span> <span m='218960'>go</span>
  <span m='219110'>back</span> <span m='219410'>in</span> <span m='219500'>time,</span>
  <span m='219860'>say</span> <span m='220760'>right</span> <span m='221120'>at</span>
  <span m='221210'>the</span> <span m='221300'>beginning</span> <span m='221660'>of</span>
  <span m='221750'>time,</span> <span m='221990'>and</span> <span m='222080'>say</span>
  <span m='222320'>actually</span> <span m='223430'>I</span> <span m='223550'>meant</span>
  <span m='223820'>to</span> <span m='223970'>put,</span> <span m='224270'>at</span>
  <span m='224420'>time</span> <span m='224660'>minus</span> <span m='224990'>1,</span>
  <span m='225290'>I</span> <span m='225350'>meant</span> <span m='225560'>to</span>
  <span m='225680'>do</span> <span m='225930'>something</span> <span m='226230'>insert</span>
  <span m='227380'>4.</span> <span m='228660'>Or</span> <span m='228770'>actually,</span>
  <span m='229070'>insert</span> <span m='229380'>2</span> <span m='229700'>would
  be</span> <span m='229790'>a</span> <span m='229820'>little</span> <span m='230030'>more</span>
  <span m='230180'>interesting.</span> </p><p><span m='232050'>Insert</span> <span
  m='232640'>2 is</span> <span m='232940'>interesting,</span> <span m='233490'>because</span>
  <span m='233690'>that</span> <span m='233840'>actually</span> <span m='234140'>changes</span>
  <span m='234650'>what</span> <span m='234770'>the</span> <span m='234890'>delete-min</span>
  <span m='235370'>operation</span> <span m='235910'>would</span> <span m='236060'>have</span>
  <span m='236240'>done.</span> <span m='236990'>And</span> <span m='237080'>so</span>
  <span m='237290'>I</span> <span m='237540'>want</span> <span m='237710'>to</span>
  <span m='237770'>go</span> <span m='237920'>back</span> <span m='238130'>in</span>
  <span m='238220'>time,</span> <span m='238460'>do</span> <span m='238610'>this,</span>
  <span m='238850'>and</span> <span m='238970'>then</span> <span m='239120'>return</span>
  <span m='239450'>to</span> <span m='239540'>the</span> <span m='239630'>present,</span>
  <span m='240320'>say</span> <span m='240500'>what's</span> <span m='240710'>my</span>
  <span m='240830'>data</span> <span m='241040'>structure</span> <span m='241400'>look</span>
  <span m='241580'>like</span> <span m='241790'>now.</span> <span m='242510'>I</span>
  <span m='242570'>want</span> <span m='242780'>to</span> <span m='242840'>be</span>
  <span m='242900'>able</span> <span m='243050'>to</span> <span m='243140'>do</span>
  <span m='243350'>the</span> <span m='243440'>regular</span> <span m='243830'>queries</span>
  <span m='244280'>I</span> <span m='244370'>can.</span> </p><p><span m='245990'>So</span>
  <span m='246110'>let's</span> <span m='246230'>say</span> <span m='246530'>you</span>
  <span m='246680'>can</span> <span m='246950'>do</span> <span m='247160'>queries</span>
  <span m='247700'>at</span> <span m='247790'>the</span> <span m='247910'>present.</span>
  <span m='249530'>This</span> <span m='249800'>is</span> <span m='250040'>now.</span>
  <span m='251420'>And</span> <span m='251690'>you</span> <span m='251810'>can</span>
  <span m='251930'>do</span> <span m='252230'>queries</span> <span m='252740'>here.</span>
  <span m='255050'>And</span> <span m='255620'>I</span> <span m='255740'>want</span>
  <span m='255950'>to</span> <span m='256010'>be</span> <span m='256160'>able</span>
  <span m='256339'>to</span> <span m='258410'>add</span> <span m='259790'>and</span>
  <span m='259970'>remove</span> <span m='260930'>operations.</span> <span m='267170'>Update</span>
  <span m='267560'>operations</span> <span m='269870'>at</span> <span m='270050'>any</span>
  <span m='270320'>time.</span> </p><p><span m='275430'>So</span> <span m='276620'>that's</span>
  <span m='276800'>what's</span> <span m='276950'>called</span> <span m='277160'>a</span>
  <span m='277270'>partially</span> <span m='277910'>retroactive</span> <span m='278570'>data</span>
  <span m='278780'>structure.</span> <span m='281920'>So</span> <span m='282110'>like</span>
  <span m='282350'>persistence,</span> <span m='282830'>we</span> <span m='282900'>have</span>
  <span m='282980'>partial</span> <span m='283460'>and</span> <span m='283550'>full.</span>
  <span m='285620'>So</span> <span m='288740'>in</span> <span m='288860'>general,</span>
  <span m='289440'>we're</span> <span m='289540'>going</span> <span m='289640'>to</span>
  <span m='289740'>have</span> <span m='289910'>insert</span> <span m='290930'>at</span>
  <span m='291050'>a</span> <span m='291110'>given</span> <span m='291410'>time,</span>
  <span m='292570'>a</span> <span m='292640'>given</span> <span m='293240'>update.</span>
  <span m='296810'>Delete</span> <span m='299324'>the</span> <span m='299810'>operation</span>
  <span m='300410'>at</span> <span m='300500'>a</span> <span m='300560'>given</span>
  <span m='300830'>time.</span> <span m='301970'>And</span> <span m='302300'>query.</span>
  </p><p><span m='310610'>And</span> <span m='311120'>I'm</span> <span m='311270'>going</span>
  <span m='311480'>to</span> <span m='311600'>use</span> <span m='313610'>capital</span>
  <span m='314480'>letters</span> <span m='315290'>to</span> <span m='315560'>denote</span>
  <span m='315950'>retroactive</span> <span m='316580'>operations</span> <span m='317120'>and</span>
  <span m='317210'>lower</span> <span m='317450'>case</span> <span m='317750'>letters</span>
  <span m='318110'>to</span> <span m='318260'>denote</span> <span m='318560'>regular</span>
  <span m='318890'>operations.</span> <span m='319470'>So</span> <span m='319490'>it's</span>
  <span m='319700'>intentional.</span> <span m='320820'>This</span> <span m='320870'>is</span>
  <span m='320930'>an</span> <span m='321060'>uppercase</span> <span m='321620'>insert.</span>
  <span m='322550'>This</span> <span m='322680'>is</span> <span m='322740'>a</span>
  <span m='322820'>lowercase</span> <span m='323420'>insert.</span> <span m='323850'>So</span>
  <span m='324050'>we're</span> <span m='324260'>inserting</span> <span m='324800'>an</span>
  <span m='324890'>insert</span> <span m='325640'>at</span> <span m='325770'>time,</span>
  <span m='326780'>the</span> <span m='326870'>time</span> <span m='327110'>before</span>
  <span m='327470'>0.</span> </p><p><span m='329960'>What</span> <span m='330200'>exactly</span>
  <span m='330740'>does</span> <span m='330950'>time</span> <span m='331430'>mean</span>
  <span m='331760'>here?</span> <span m='333380'>We're</span> <span m='333560'>not</span>
  <span m='333680'>going</span> <span m='333800'>to</span> <span m='333890'>work</span>
  <span m='334100'>with</span> <span m='334190'>that</span> <span m='334340'>too</span>
  <span m='334580'>much</span> <span m='335090'>directly</span> <span m='335510'>today.</span>
  <span m='336530'>You</span> <span m='336680'>can</span> <span m='336800'>think</span>
  <span m='336980'>of</span> <span m='337070'>them</span> <span m='337220'>as</span>
  <span m='337310'>just</span> <span m='337490'>being</span> <span m='337700'>integers.</span>
  <span m='338270'>But</span> <span m='338420'>it</span> <span m='338480'>gets</span>
  <span m='338690'>awkward</span> <span m='339050'>if</span> <span m='339140'>you</span>
  <span m='339230'>just</span> <span m='339380'>keep</span> <span m='340100'>inserting</span>
  <span m='340550'>new</span> <span m='340700'>operations</span> <span m='341360'>to</span>
  <span m='341690'>do</span> <span m='342020'>in</span> <span m='342140'>between</span>
  <span m='342470'>1</span> <span m='342650'>and</span> <span m='342740'>2.</span>
  <span m='342920'>There</span> <span m='343020'>aren't</span> <span m='343130'>very</span>
  <span m='343310'>many</span> <span m='343520'>integers</span> <span m='343940'>between</span>
  <span m='344240'>1</span> <span m='344390'>and</span> <span m='344510'>2.</span>
  </p><p><span m='345900'>One</span> <span m='346430'>easy</span> <span m='346700'>solution</span>
  <span m='347090'>to</span> <span m='347180'>this</span> <span m='347390'>is</span>
  <span m='347510'>use</span> <span m='347810'>the</span> <span m='348080'>order</span>
  <span m='348350'>maintenance</span> <span m='348710'>data</span> <span m='348920'>structure</span>
  <span m='349340'>that we</span> <span m='349490'>mentioned</span> <span m='349850'>in
  the</span> <span m='349910'>last</span> <span m='350150'>class,</span> <span m='351050'>where</span>
  <span m='351170'>you</span> <span m='351290'>basically</span> <span m='351620'>are</span>
  <span m='351710'>maintaining</span> <span m='352190'>a</span> <span m='352250'>linked</span>
  <span m='352460'>list</span> <span m='352880'>and</span> <span m='353000'>you're</span>
  <span m='353150'>able</span> <span m='353390'>to</span> <span m='353540'>insert</span>
  <span m='354980'>new</span> <span m='355280'>times</span> <span m='355730'>in</span>
  <span m='355820'>between</span> <span m='356180'>any</span> <span m='356390'>two</span>
  <span m='356600'>given</span> <span m='356840'>times.</span> <span m='357200'>And</span>
  <span m='357290'>you</span> <span m='357380'>can</span> <span m='357500'>still</span>
  <span m='357710'>do</span> <span m='357890'>order</span> <span m='358100'>queries</span>
  <span m='358760'>in</span> <span m='358880'>constant</span> <span m='359330'>time.</span>
  <span m='360240'>But</span> <span m='360740'>I</span> <span m='360800'>mean,</span>
  <span m='361330'>if</span> <span m='361550'>you</span> <span m='361640'>don't</span>
  <span m='361790'>mind</span> <span m='361970'>logs</span> <span m='362300'>you</span>
  <span m='362360'>could</span> <span m='362480'>just</span> <span m='362610'>store</span>
  <span m='362960'>the</span> <span m='363080'>times</span> <span m='363410'>in</span>
  <span m='363500'>a</span> <span m='363560'>binary</span> <span m='363860'>search</span>
  <span m='364100'>tree.</span> <span m='364520'>That's</span> <span m='364700'>an</span>
  <span m='364790'>easy</span> <span m='365030'>way</span> <span m='366050'>to</span>
  <span m='366140'>do</span> <span m='366320'>it.</span> <span m='368280'>We're</span>
  <span m='368330'>not</span> <span m='368450'>really</span> <span m='368600'>going</span>
  <span m='368720'>to</span> <span m='368840'>worry</span> <span m='369080'>about</span>
  <span m='369290'>that</span> <span m='370160'>too</span> <span m='370280'>much</span>
  <span m='370520'>here.</span> </p><p><span m='372410'>What</span> <span m='372560'>we're</span>
  <span m='372650'>interested</span> <span m='373070'>here</span> <span m='373430'>is</span>
  <span m='373670'>how</span> <span m='373850'>do</span> <span m='373970'>we</span>
  <span m='374120'>maintain</span> <span m='376250'>the</span> <span m='376430'>sort</span>
  <span m='376610'>of</span> <span m='376730'>side</span> <span m='377060'>effects</span>
  <span m='377600'>of</span> <span m='377750'>doing</span> <span m='378020'>this</span>
  <span m='378170'>operation</span> <span m='379100'>earlier</span> <span m='379490'>in</span>
  <span m='379610'>time,</span> <span m='380210'>computing</span> <span m='380750'>all</span>
  <span m='380990'>of</span> <span m='381140'>this,</span> <span m='381380'>or</span>
  <span m='381470'>chain</span> <span m='381770'>reactions</span> <span m='383330'>that</span>
  <span m='383540'>would</span> <span m='383660'>have</span> <span m='383780'>happened</span>
  <span m='384260'>meanwhile,</span> <span m='384650'>sort</span> <span m='384860'>of</span>
  <span m='384920'>butterfly</span> <span m='385400'>effect.</span> </p><p><span m='386900'>All</span>
  <span m='386990'>right,</span> <span m='387440'>I</span> <span m='387590'>want</span>
  <span m='387770'>to</span> <span m='387860'>define</span> <span m='390100'>partial</span>
  <span m='392480'>retroactivity</span> <span m='393980'>means</span> <span m='395930'>queries</span>
  <span m='398300'>are</span> <span m='398420'>always</span> <span m='398870'>done</span>
  <span m='400910'>at</span> <span m='401060'>the</span> <span m='401180'>present.</span>
  <span m='403200'>Let's</span> <span m='403430'>say</span> <span m='403640'>t</span>
  <span m='403940'>equals</span> <span m='404300'>infinity</span> <span m='405260'>or</span>
  <span m='405510'>now.</span> <span m='406670'>This</span> <span m='406850'>is</span>
  <span m='406970'>what</span> <span m='407120'>you</span> <span m='407210'>might</span>
  <span m='407420'>call</span> <span m='407720'>the</span> <span m='407870'>Q</span>
  <span m='408530'>model,</span> <span m='408790'>if</span> <span m='409050'>you're</span>
  <span m='409250'>a</span> <span m='409290'>Star</span> <span m='409520'>Trek</span>
  <span m='409760'>fan.</span> <span m='410300'>You</span> <span m='410420'>can</span>
  <span m='410540'>exist</span> <span m='410840'>in</span> <span m='410930'>all</span>
  <span m='411170'>time</span> <span m='411440'>simultaneously,</span> <span m='412160'>do</span>
  <span m='412310'>updates</span> <span m='412700'>whenever</span> <span m='412970'>you</span>
  <span m='413030'>feel</span> <span m='413240'>like</span> <span m='413450'>it,</span>
  <span m='413540'>do</span> <span m='413690'>queries</span> <span m='414020'>whenever</span>
  <span m='414290'>you</span> <span m='414410'>feel</span> <span m='414560'>like</span>
  <span m='414800'>it.</span> <span m='417140'>All</span> <span m='417230'>right</span>
  <span m='417880'>model</span> <span m='418220'>clear.</span> </p><p><span m='419780'>Now</span>
  <span m='419930'>as</span> <span m='420080'>you</span> <span m='420170'>might</span>
  <span m='420350'>expect,</span> <span m='420860'>this</span> <span m='421070'>is</span>
  <span m='421160'>hard.</span> <span m='422040'>You</span> <span m='422140'>can't</span>
  <span m='422330'>always</span> <span m='422600'>do</span> <span m='422750'>retroactivity</span>
  <span m='424100'>super</span> <span m='424460'>well.</span> <span m='425580'>But</span>
  <span m='426030'>we'll</span> <span m='426320'>talk</span> <span m='426530'>about</span>
  <span m='426710'>our</span> <span m='427070'>situations</span> <span m='427640'>you</span>
  <span m='427760'>can</span> <span m='427910'>do</span> <span m='428030'>well</span>
  <span m='428900'>and</span> <span m='429800'>what</span> <span m='429980'>you</span>
  <span m='430130'>can</span> <span m='430280'>do</span> <span m='430400'>in</span>
  <span m='430520'>general.</span> </p><p><span m='435315'>Go</span> <span m='435720'>to</span>
  <span m='435860'>an</span> <span m='435980'>easy</span> <span m='436280'>case,</span>
  <span m='438230'>which</span> <span m='438380'>is</span> <span m='438470'>still</span>
  <span m='439490'>fairly</span> <span m='439850'>interesting.</span> <span m='444620'>Suppose</span>
  <span m='445190'>you</span> <span m='445310'>have</span> <span m='445700'>commutative</span>
  <span m='446570'>updates,</span> <span m='449720'>meaning</span> <span m='451160'>x</span>
  <span m='451550'>followed</span> <span m='451970'>by</span> <span m='452170'>y</span>
  <span m='452750'>is</span> <span m='452900'>the</span> <span m='452960'>same</span>
  <span m='453290'>thing</span> <span m='453620'>as</span> <span m='453800'>y</span>
  <span m='454250'>followed</span> <span m='454640'>by</span> <span m='454850'>x.</span>
  <span m='456800'>This</span> <span m='456980'>would</span> <span m='457070'>be</span>
  <span m='457160'>great</span> <span m='457460'>if</span> <span m='457610'>I</span>
  <span m='457700'>could</span> <span m='457820'>reorder</span> <span m='458210'>updates,</span>
  <span m='458630'>because</span> <span m='458900'>then</span> <span m='459050'>I</span>
  <span m='459110'>don't</span> <span m='459320'>really</span> <span m='459620'>care</span>
  <span m='459830'>about</span> <span m='460040'>the</span> <span m='460130'>sequence</span>
  <span m='460520'>of</span> <span m='460640'>updates,</span> <span m='461600'>as</span>
  <span m='461750'>long</span> <span m='461960'>as</span> <span m='462080'>I'm</span>
  <span m='462200'>only</span> <span m='462470'>querying</span> <span m='463340'>the</span>
  <span m='463670'>final</span> <span m='464060'>results.</span> </p><p><span m='465470'>If</span>
  <span m='465620'>I</span> <span m='465680'>want</span> <span m='465860'>to</span>
  <span m='465920'>do</span> <span m='466040'>an</span> <span m='466130'>update</span>
  <span m='466490'>in</span> <span m='466610'>the</span> <span m='466700'>past--</span>
  <span m='467390'>this</span> <span m='467750'>would</span> <span m='467840'>not</span>
  <span m='468050'>be</span> <span m='468140'>an</span> <span m='468200'>example</span>
  <span m='468530'>of</span> <span m='468620'>commutative--</span> <span m='469100'>delete-min</span>
  <span m='469670'>and</span> <span m='469760'>insert</span> <span m='470150'>are</span>
  <span m='470240'>not</span> <span m='470450'>commutative.</span> <span m='471255'>But</span>
  <span m='471510'>if</span> <span m='471620'>I</span> <span m='471650'>was</span>
  <span m='471740'>just</span> <span m='471890'>doing</span> <span m='472070'>insert</span>
  <span m='472370'>and</span> <span m='472460'>delete</span> <span m='473060'>for</span>
  <span m='473150'>example,</span> <span m='474770'>delete</span> <span m='475690'>7,</span>
  <span m='476270'>whatever,</span> <span m='477290'>then</span> <span m='478130'>inserting</span>
  <span m='478490'>2</span> <span m='478700'>here</span> <span m='479030'>is</span>
  <span m='479150'>the</span> <span m='479210'>same</span> <span m='479450'>thing</span>
  <span m='479630'>as</span> <span m='479750'>inserting</span> <span m='480110'>2</span>
  <span m='480260'>at</span> <span m='480320'>the</span> <span m='480470'>end,</span>
  <span m='480620'>as</span> <span m='480740'>long</span> <span m='480950'>as</span>
  <span m='481070'>I'm</span> <span m='481190'>only</span> <span m='481460'>querying</span>
  <span m='482000'>the</span> <span m='482150'>end.</span> <span m='483230'>So</span>
  <span m='483380'>this</span> <span m='483590'>would</span> <span m='483680'>be</span>
  <span m='483770'>an</span> <span m='483860'>easy</span> <span m='484130'>case</span>
  <span m='485000'>for</span> <span m='485270'>partial</span> <span m='485780'>retroactivity.</span>
  </p><p><span m='491660'>If</span> <span m='491900'>my</span> <span m='492050'>updates</span>
  <span m='492350'>are</span> <span m='492440'>commutative,</span> <span m='493550'>then</span>
  <span m='494000'>inserting</span> <span m='496520'>an</span> <span m='496670'>operation</span>
  <span m='497450'>at</span> <span m='497630'>time</span> <span m='497960'>t</span>
  <span m='498860'>is</span> <span m='499070'>the</span> <span m='499160'>same</span>
  <span m='499430'>thing</span> <span m='499910'>as</span> <span m='500210'>inserting</span>
  <span m='501350'>that</span> <span m='501530'>operation</span> <span m='502700'>now,</span>
  <span m='505670'>at</span> <span m='505790'>the</span> <span m='505910'>end</span>
  <span m='506090'>of</span> <span m='506180'>time.</span> <span m='509590'>That's</span>
  <span m='509870'>for</span> <span m='510050'>inserts.</span> <span m='510830'>But</span>
  <span m='511040'>if</span> <span m='511160'>I</span> <span m='511250'>want</span>
  <span m='511430'>to</span> <span m='511490'>also</span> <span m='511880'>be</span>
  <span m='512000'>able</span> <span m='512210'>to--</span> <span m='513260'>for</span>
  <span m='513470'>retroactive</span> <span m='514159'>inserts,</span> <span m='514549'>I</span>
  <span m='514610'>should</span> <span m='514820'>say,</span> <span m='514970'>capital</span>
  <span m='515440'>I.</span> </p><p><span m='516110'>If</span> <span m='516200'>I</span>
  <span m='516260'>want</span> <span m='516470'>to</span> <span m='516530'>be</span>
  <span m='516620'>able</span> <span m='516740'>to</span> <span m='516830'>do</span>
  <span m='516919'>retroactive</span> <span m='517490'>deletes,</span> <span m='519230'>I</span>
  <span m='519350'>need</span> <span m='520220'>something</span> <span m='520610'>else.</span>
  <span m='520909'>I</span> <span m='520970'>need</span> <span m='521179'>some</span>
  <span m='521450'>way--</span> <span m='521900'>I</span> <span m='521990'>still</span>
  <span m='522200'>want</span> <span m='522350'>to</span> <span m='522409'>only</span>
  <span m='522710'>work</span> <span m='522919'>in</span> <span m='523010'>the</span>
  <span m='523100'>present,</span> <span m='523549'>if</span> <span m='523669'>I</span>
  <span m='523760'>can.</span> <span m='525950'>And</span> <span m='526070'>for</span>
  <span m='526220'>that</span> <span m='526430'>I</span> <span m='526490'>need</span>
  <span m='527120'>inversion.</span> <span m='528680'>I</span> <span m='528740'>have</span>
  <span m='528980'>invertible</span> <span m='529490'>updates.</span> </p><p><span
  m='535480'>If</span> <span m='535640'>there</span> <span m='535690'>is</span> <span
  m='535790'>some</span> <span m='536060'>way</span> <span m='536300'>to,</span> <span
  m='537420'>given</span> <span m='537680'>an</span> <span m='537770'>operation</span>
  <span m='538280'>x,</span> <span m='538760'>compute</span> <span m='539180'>a</span>
  <span m='539240'>new</span> <span m='539390'>operation</span> <span m='539960'>x</span>
  <span m='540200'>inverse,</span> <span m='541290'>that</span> <span m='541420'>does</span>
  <span m='541640'>the</span> <span m='541700'>reverse,</span> <span m='542190'>and</span>
  <span m='542300'>that's</span> <span m='542510'>equivalent</span> <span m='542960'>to</span>
  <span m='543110'>nothing,</span> <span m='544610'>then</span> <span m='546530'>deleting</span>
  <span m='547010'>an</span> <span m='547100'>operation</span> <span m='547580'>is</span>
  <span m='547640'>the</span> <span m='547730'>same</span> <span m='547970'>thing</span>
  <span m='548120'>as</span> <span m='548240'>doing</span> <span m='548450'>the</span>
  <span m='548570'>inverse.</span> <span m='549560'>And</span> <span m='550180'>if</span>
  <span m='550370'>you</span> <span m='550460'>have</span> <span m='550760'>also</span>
  <span m='551090'>commutativity--</span> <span m='551840'>so</span> <span m='552020'>I'm</span>
  <span m='552290'>adding</span> <span m='552650'>these</span> <span m='552890'>two</span>
  <span m='554030'>constraints--</span> <span m='554810'>then</span> <span m='556400'>delete</span>
  <span m='557320'>t</span> <span m='557840'>some</span> <span m='558170'>operation</span>
  <span m='559380'>is</span> <span m='559550'>the</span> <span m='559610'>same</span>
  <span m='559880'>thing</span> <span m='560240'>as</span> <span m='560600'>inserting</span>
  <span m='564020'>now</span> <span m='565520'>that</span> <span m='565850'>operation</span>
  <span m='567260'>inverse.</span> </p><p><span m='571150'>So</span> <span m='571260'>that's--</span>
  <span m='573150'>if</span> <span m='573330'>I</span> <span m='573420'>have</span>
  <span m='573690'>both</span> <span m='573960'>of</span> <span m='574020'>these</span>
  <span m='574380'>properties,</span> <span m='574920'>then</span> <span m='575070'>partial</span>
  <span m='575400'>retroactivity</span> <span m='576360'>is</span> <span m='576750'>trivial.</span>
  <span m='577320'>I</span> <span m='577380'>just</span> <span m='577530'>do</span>
  <span m='577650'>everything</span> <span m='578880'>in</span> <span m='579030'>the</span>
  <span m='579120'>present.</span> <span m='580810'>May</span> <span m='580900'>not</span>
  <span m='581080'>seem</span> <span m='581210'>very</span> <span m='581380'>exciting,</span>
  <span m='581800'>but</span> <span m='582670'>it</span> <span m='583030'>solves</span>
  <span m='583390'>a</span> <span m='583450'>bunch</span> <span m='583660'>of</span>
  <span m='583720'>problems</span> <span m='584080'>already</span> <span m='584560'>for</span>
  <span m='584740'>free.</span> <span m='585370'>So</span> <span m='585550'>for</span>
  <span m='585700'>example,</span> <span m='586720'>hashing.</span> <span m='588220'>If</span>
  <span m='588520'>you</span> <span m='588640'>want</span> <span m='588850'>a</span>
  <span m='589150'>dynamic</span> <span m='589750'>hash</span> <span m='590050'>table</span>
  <span m='590360'>or</span> <span m='590400'>dictionary,</span> <span m='592140'>and</span>
  <span m='592300'>you</span> <span m='592390'>want</span> <span m='592540'>to</span>
  <span m='592600'>be</span> <span m='592660'>able</span> <span m='592780'>to</span>
  <span m='592900'>make</span> <span m='593050'>retroactive</span> <span m='593500'>changes,</span>
  <span m='593820'>it</span> <span m='593890'>really</span> <span m='594070'>doesn't</span>
  <span m='594280'>matter</span> <span m='594550'>whether</span> <span m='594730'>you</span>
  <span m='594820'>make</span> <span m='595000'>them</span> <span m='595150'>in</span>
  <span m='595210'>the</span> <span m='595300'>past</span> <span m='596130'>or</span>
  <span m='596200'>in</span> <span m='596260'>the</span> <span m='596350'>present.</span>
  </p><p><span m='597070'>I'm</span> <span m='597190'>assuming</span> <span m='597610'>a</span>
  <span m='597670'>little</span> <span m='597970'>bit</span> <span m='598120'>here</span>
  <span m='599080'>that</span> <span m='599200'>you</span> <span m='599320'>don't,</span>
  <span m='599590'>for</span> <span m='599710'>example,</span> <span m='600130'>clobber</span>
  <span m='600610'>a</span> <span m='600670'>key</span> <span m='600970'>and</span>
  <span m='601060'>write</span> <span m='601270'>to</span> <span m='601390'>the</span>
  <span m='601510'>same</span> <span m='601750'>key</span> <span m='601900'>twice.</span>
  <span m='603070'>Then</span> <span m='603250'>the</span> <span m='603370'>order</span>
  <span m='603610'>would</span> <span m='603790'>matter.</span> <span m='605490'>But</span>
  <span m='605530'>if</span> <span m='605620'>you</span> <span m='605710'>store</span>
  <span m='605950'>all</span> <span m='606100'>copies</span> <span m='606460'>of</span>
  <span m='606550'>all</span> <span m='606670'>keys,</span> <span m='607660'>then</span>
  <span m='607840'>this</span> <span m='607990'>is</span> <span m='608110'>true.</span>
  </p><p><span m='610940'>Slightly</span> <span m='611350'>more</span> <span m='611530'>interesting,</span>
  <span m='612070'>if</span> <span m='612220'>you</span> <span m='612310'>have</span>
  <span m='612460'>an</span> <span m='612550'>array</span> <span m='614800'>with</span>
  <span m='617020'>the</span> <span m='617170'>operation</span> <span m='618470'>add</span>
  <span m='619660'>delta</span> <span m='621250'>to</span> <span m='621400'>a</span>
  <span m='621460'>given</span> <span m='621730'>array</span> <span m='621970'>element.</span>
  <span m='622640'>So</span> <span m='622720'>if</span> <span m='622840'>I</span>
  <span m='622900'>had</span> <span m='623050'>an</span> <span m='623140'>assignment</span>
  <span m='623680'>here,</span> <span m='623890'>then</span> <span m='624070'>the</span>
  <span m='624160'>order</span> <span m='624400'>would</span> <span m='624550'>matter.</span>
  <span m='624980'>But</span> <span m='625030'>if</span> <span m='625180'>I</span>
  <span m='625240'>have</span> <span m='625840'>only</span> <span m='626110'>addition</span>
  <span m='626620'>or</span> <span m='626710'>subtraction,</span> <span m='629000'>that's</span>
  <span m='629140'>fine,</span> <span m='629620'>because</span> <span m='630250'>addition
  and</span> <span m='630580'>subtraction</span> <span m='631180'>are</span> <span
  m='631400'>commutative.</span> <span m='632620'>So</span> <span m='632980'>I</span>
  <span m='633220'>can</span> <span m='633460'>do</span> <span m='633550'>that.</span>
  <span m='634690'>Not</span> <span m='634870'>terribly</span> <span m='635170'>exciting,</span>
  <span m='636640'>as</span> <span m='636790'>you</span> <span m='636880'>might</span>
  <span m='637030'>imagine.</span> <span m='638360'>We're</span> <span m='638460'>going</span>
  <span m='638470'>to</span> <span m='638530'>get</span> <span m='638650'>to</span>
  <span m='638770'>much</span> <span m='638950'>more</span> <span m='639040'>interesting</span>
  <span m='639400'>examples.</span> </p><p><span m='640000'>But</span> <span m='641550'>a</span>
  <span m='641620'>natural</span> <span m='642100'>question</span> <span m='642610'>here</span>
  <span m='642910'>is</span> <span m='643150'>what</span> <span m='643360'>about</span>
  <span m='643600'>full</span> <span m='643990'>retroactivity?</span> <span m='644950'>So</span>
  <span m='645130'>partial's</span> <span m='645640'>nice.</span> <span m='646780'>But</span>
  <span m='647200'>if</span> <span m='647380'>I</span> <span m='647500'>have</span>
  <span m='647740'>such</span> <span m='647980'>an</span> <span m='648070'>easy</span>
  <span m='648370'>setup,</span> <span m='649120'>can</span> <span m='649360'>I</span>
  <span m='649480'>achieve</span> <span m='649780'>full</span> <span m='649990'>retroactivity?</span>
  <span m='650365'>It's</span> <span m='650740'>not</span> <span m='650950'>so</span>
  <span m='651130'>obvious</span> <span m='651520'>because</span> <span m='651700'>now</span>
  <span m='651940'>working</span> <span m='652240'>in</span> <span m='652330'>the</span>
  <span m='652420'>present,</span> <span m='653530'>it's</span> <span m='653980'>not</span>
  <span m='654130'>correctly</span> <span m='654550'>reflecting</span> <span m='655120'>the</span>
  <span m='655210'>past.</span> <span m='657130'>To</span> <span m='657310'>do</span>
  <span m='657490'>that,</span> <span m='658480'>we</span> <span m='658600'>need--</span>
  <span m='659170'>we</span> <span m='659320'>cannot</span> <span m='659590'>do</span>
  <span m='659710'>it</span> <span m='659770'>in</span> <span m='659890'>general,</span>
  <span m='660160'>we</span> <span m='660250'>don't</span> <span m='660370'>know</span>
  <span m='660520'>how.</span> </p><p><span m='661210'>But</span> <span m='661450'>there</span>
  <span m='661540'>is</span> <span m='661690'>a</span> <span m='661780'>situation</span>
  <span m='662980'>where</span> <span m='663130'>we</span> <span m='663250'>do</span>
  <span m='663370'>know</span> <span m='663580'>how.</span> <span m='665230'>First</span>
  <span m='665610'>I'll</span> <span m='665710'>define</span> <span m='666280'>a</span>
  <span m='666520'>search</span> <span m='667000'>problem.</span> <span m='671680'>The
  search</span> <span m='672010'>problem</span> <span m='672610'>is--</span> <span
  m='674080'>you've</span> <span m='674230'>seen</span> <span m='674410'>many</span>
  <span m='674680'>examples</span> <span m='675130'>of</span> <span m='675250'>this</span>
  <span m='676880'>in</span> <span m='677020'>your</span> <span m='677140'>algorithmic</span>
  <span m='677680'>lifetime--</span> <span m='679460'>I</span> <span m='679690'>maintain</span>
  <span m='680800'>a</span> <span m='680860'>set S</span> <span m='681550'>of</span>
  <span m='681910'>objects--</span> <span m='682960'>we</span> <span m='683050'>don't</span>
  <span m='683200'>know</span> <span m='683380'>what</span> <span m='683500'>they</span>
  <span m='683680'>are--</span> <span m='684820'>subject</span> <span m='685300'>to</span>
  <span m='686650'>insert,</span> <span m='687920'>delete,</span> <span m='688720'>and</span>
  <span m='688870'>some</span> <span m='689140'>kind</span> <span m='689350'>of</span>
  <span m='689440'>search</span> <span m='689710'>query.</span> <span m='699280'>And</span>
  <span m='699640'>I</span> <span m='699880'>want</span> <span m='700030'>to</span>
  <span m='700090'>focus</span> <span m='700450'>in</span> <span m='700600'>on</span>
  <span m='700720'>the</span> <span m='700810'>types</span> <span m='701110'>of</span>
  <span m='701200'>queries</span> <span m='701560'>we</span> <span m='701680'>allow.</span>
  </p><p><span m='702250'>So</span> <span m='702420'>this</span> <span m='702820'>in
  particular,</span> <span m='704500'>insert</span> <span m='704860'>and</span> <span
  m='704950'>delete</span> <span m='705940'>are</span> <span m='706450'>commutative</span>
  <span m='706920'>and</span> <span m='706980'>invertible.</span> <span m='707770'>They</span>
  <span m='707890'>are</span> <span m='708250'>each</span> <span m='708430'>other's</span>
  <span m='708640'>inverses.</span> <span m='709220'>So</span> <span m='710650'>n</span>
  <span m='711180'>queries</span> <span m='711520'>are</span> <span m='711610'>queries.</span>
  <span m='712220'>This</span> <span m='712300'>is</span> <span m='712420'>really</span>
  <span m='712630'>just</span> <span m='712810'>a</span> <span m='712870'>constraint</span>
  <span m='713230'>on</span> <span m='713350'>updates.</span> <span m='714190'>So</span>
  <span m='714340'>search</span> <span m='714610'>problems</span> <span m='715090'>fall</span>
  <span m='715360'>into</span> <span m='715570'>this</span> <span m='715750'>easy</span>
  <span m='716020'>class.</span> <span m='717230'>So in</span> <span m='717400'>particular,</span>
  <span m='717790'>it covers</span> <span m='718090'>hashing.</span> </p><p><span
  m='721420'>Fine,</span> <span m='722650'>that's</span> <span m='722890'>a</span>
  <span m='722950'>general</span> <span m='723280'>class</span> <span m='723520'>of</span>
  <span m='723580'>problems.</span> <span m='724570'>Here's</span> <span m='724840'>a</span>
  <span m='725260'>slightly</span> <span m='725680'>less</span> <span m='725920'>general</span>
  <span m='726220'>class</span> <span m='726460'>of</span> <span m='726520'>problems,</span>
  <span m='727990'>which</span> <span m='728650'>are</span> <span m='728800'>sort</span>
  <span m='728980'>of</span> <span m='729040'>well-studied.</span> <span m='731180'>The</span>
  <span m='731410'>old</span> <span m='731800'>geometric</span> <span m='732340'>data</span>
  <span m='732520'>structures</span> <span m='732940'>literature.</span> <span m='733870'>Decomposable</span>
  <span m='734620'>search</span> <span m='734890'>problems.</span> <span m='737810'>This</span>
  <span m='737830'>is</span> <span m='737920'>a</span> <span m='737980'>concept</span>
  <span m='738370'>from</span> <span m='738610'>1980</span> <span m='740840'>revitalized.</span>
  </p><p><span m='742060'>I</span> <span m='742120'>should</span> <span m='742240'>mention</span>
  <span m='742540'>this</span> <span m='742690'>retroactive</span> <span m='743410'>paper</span>
  <span m='743920'>is</span> <span m='744370'>pretty</span> <span m='744610'>recent.</span>
  <span m='744880'>I</span> <span m='744940'>think</span> <span m='745150'>the</span>
  <span m='745240'>journal</span> <span m='745510'>version</span> <span m='745780'>appeared</span>
  <span m='746020'>in</span> <span m='746110'>2007.</span> <span m='749412'>I</span>
  <span m='749840'>have</span> <span m='749980'>2003</span> <span m='751360'>and</span>
  <span m='751450'>2007</span> <span m='752200'>here.</span> <span m='752510'>So</span>
  <span m='752590'>those</span> <span m='752800'>are</span> <span m='752860'>the</span>
  <span m='752980'>two</span> <span m='753130'>versions</span> <span m='753520'>of</span>
  <span m='753580'>the</span> <span m='753670'>paper.</span> </p><p><span m='757000'>So</span>
  <span m='757480'>what's</span> <span m='757600'>a</span> <span m='757660'>decomposable</span>
  <span m='758320'>search</span> <span m='758560'>problem?</span> <span m='760640'>Same</span>
  <span m='760840'>thing,</span> <span m='761380'>but</span> <span m='761560'>the</span>
  <span m='761680'>query</span> <span m='762090'>is of</span> <span m='762240'>a</span>
  <span m='762310'>particular</span> <span m='762860'>flavor,</span> <span m='764020'>has</span>
  <span m='764170'>a</span> <span m='764200'>particular</span> <span m='764710'>structure.</span>
  <span m='767170'>If</span> <span m='767350'>I</span> <span m='767440'>want</span>
  <span m='767650'>to</span> <span m='767710'>do</span> <span m='767860'>a</span>
  <span m='767890'>query</span> <span m='768850'>on</span> <span m='769000'>the</span>
  <span m='769090'>union</span> <span m='769480'>of</span> <span m='769600'>two</span>
  <span m='769780'>sets,</span> <span m='770380'>a</span> <span m='770730'>and</span>
  <span m='771010'>b,</span> <span m='772560'>it's</span> <span m='772780'>the</span>
  <span m='772870'>same</span> <span m='773290'>thing</span> <span m='773770'>as</span>
  <span m='774010'>doing</span> <span m='774190'>the</span> <span m='774280'>query</span>
  <span m='774730'>on</span> <span m='774910'>the</span> <span m='775000'>two</span>
  <span m='775180'>sets</span> <span m='775480'>individually</span> <span m='776440'>and</span>
  <span m='776560'>then</span> <span m='776680'>combining</span> <span m='777160'>them</span>
  <span m='777280'>with</span> <span m='777400'>some</span> <span m='777610'>function.</span>
  </p><p><span m='786820'>This</span> <span m='787030'>is</span> <span m='787150'>a</span>
  <span m='787240'>constraint</span> <span m='787930'>on</span> <span m='788320'>what</span>
  <span m='788590'>the</span> <span m='788860'>query</span> <span m='790270'>is.</span>
  <span m='790750'>The</span> <span m='790840'>problem</span> <span m='791200'>is</span>
  <span m='791290'>still</span> <span m='791500'>this.</span> <span m='791800'>I</span>
  <span m='791860'>still</span> <span m='792070'>want</span> <span m='792220'>to</span>
  <span m='792280'>do</span> <span m='792400'>a</span> <span m='792460'>query</span>
  <span m='792820'>on</span> <span m='792910'>the</span> <span m='793000'>entire</span>
  <span m='793480'>set.</span> <span m='794290'>But</span> <span m='794470'>I</span>
  <span m='794560'>just</span> <span m='794770'>know</span> <span m='796180'>this</span>
  <span m='796360'>fact,</span> <span m='796870'>that</span> <span m='797020'>if</span>
  <span m='797170'>I</span> <span m='797290'>could</span> <span m='797770'>somehow</span>
  <span m='798220'>solve</span> <span m='798490'>the</span> <span m='798580'>query</span>
  <span m='798910'>on</span> <span m='799030'>smaller</span> <span m='799420'>sets,</span>
  <span m='799810'>I</span> <span m='799930'>could</span> <span m='800110'>combine</span>
  <span m='800710'>them</span> <span m='800950'>into</span> <span m='801160'>the</span>
  <span m='801280'>union</span> <span m='802030'>using</span> <span m='802270'>this</span>
  <span m='802580'>f function.</span> <span m='803080'>For</span> <span m='803230'>some,</span>
  <span m='803620'>let's</span> <span m='803770'>say</span> <span m='803950'>this</span>
  <span m='804070'>can</span> <span m='804250'>be</span> <span m='804340'>computed</span>
  <span m='804790'>in</span> <span m='804910'>constant</span> <span m='805270'>time.</span>
  </p><p><span m='810520'>That's</span> <span m='810730'>a</span> <span m='810790'>decomposable</span>
  <span m='811390'>search</span> <span m='811600'>problem.</span> <span m='811870'>For</span>
  <span m='812080'>example,</span> <span m='813190'>suppose</span> <span m='813520'>I</span>
  <span m='813580'>have</span> <span m='813850'>a</span> <span m='813910'>set</span>
  <span m='814150'>of</span> <span m='814390'>points</span> <span m='814900'>in</span>
  <span m='815050'>the</span> <span m='815170'>plane.</span> <span m='815780'>And</span>
  <span m='815880'>I</span> <span m='815980'>want</span> <span m='816040'>to</span>
  <span m='816130'>know,</span> <span m='816520'>given</span> <span m='816700'>a</span>
  <span m='816760'>query</span> <span m='817030'>point,</span> <span m='817250'>what's</span>
  <span m='817450'>the</span> <span m='817570'>nearest</span> <span m='817900'>point</span>
  <span m='818170'>in</span> <span m='818320'>my</span> <span m='818470'>set?</span>
  <span m='819160'>So it</span> <span m='819300'>would</span> <span m='819530'>be</span>
  <span m='819710'>dynamic</span> <span m='820270'>nearest</span> <span m='820570'>neighbor.</span>
  </p><p><span m='823210'>If</span> <span m='823360'>I</span> <span m='823450'>could</span>
  <span m='823570'>compute</span> <span m='823900'>the</span> <span m='823990'>nearest</span>
  <span m='824230'>neighbor</span> <span m='824530'>among</span> <span m='825190'>one</span>
  <span m='825700'>subset</span> <span m='826090'>of</span> <span m='826150'>the</span>
  <span m='826210'>points,</span> <span m='826520'>and</span> <span m='826600'>the</span>
  <span m='826690'>nearest</span> <span m='826900'>neighbor</span> <span m='827140'>among</span>
  <span m='827350'>a</span> <span m='827410'>different</span> <span m='827680'>subset,</span>
  <span m='828510'>I</span> <span m='828630'>can</span> <span m='828820'>compute</span>
  <span m='829010'>the</span> <span m='829120'>nearest</span> <span m='829390'>neighbor</span>
  <span m='829660'>among</span> <span m='829870'>the</span> <span m='829960'>union</span>
  <span m='830290'>just</span> <span m='830440'>by</span> <span m='830560'>taking</span>
  <span m='830920'>the</span> <span m='831040'>min</span> <span m='831220'>of</span>
  <span m='831340'>the</span> <span m='831460'>two.</span> <span m='832240'>Doesn't</span>
  <span m='832510'>matter</span> <span m='832810'>whether</span> <span m='833050'>a
  and</span> <span m='833290'>b</span> <span m='833440'>overlap.</span> <span m='834490'>That</span>
  <span m='834610'>will</span> <span m='834700'>still</span> <span m='834880'>give</span>
  <span m='835060'>the</span> <span m='835150'>right</span> <span m='835300'>answer.</span>
  <span m='836650'>Sort</span> <span m='836860'>of</span> <span m='836980'>a</span>
  <span m='837050'>min</span> <span m='837550'>over</span> <span m='837850'>all</span>
  <span m='838060'>things.</span> <span m='838720'>I</span> <span m='838870'>have</span>
  <span m='839050'>some</span> <span m='839260'>other</span> <span m='839440'>examples.</span>
  </p><p><span m='842140'>Successor</span> <span m='843000'>on</span> <span m='843940'>a</span>
  <span m='844010'>line.</span> <span m='844550'>If I'm</span> <span m='844990'>given</span>
  <span m='845350'>a</span> <span m='845410'>query</span> <span m='845740'>point,</span>
  <span m='845980'>I</span> <span m='846040'>want</span> <span m='846220'>to</span>
  <span m='846280'>know</span> <span m='846400'>what</span> <span m='846550'>the</span>
  <span m='846670'>next,</span> <span m='847540'>the</span> <span m='847630'>nearest</span>
  <span m='847960'>item</span> <span m='848260'>after</span> <span m='848620'>it</span>
  <span m='848740'>is.</span> <span m='849190'>That's sort</span> <span m='849550'>of</span>
  <span m='849640'>like</span> <span m='849850'>one-sided</span> <span m='850300'>nearest</span>
  <span m='850560'>neighbor.</span> <span m='852850'>Yeah,</span> <span m='853330'>point</span>
  <span m='853600'>location,</span> <span m='854380'>we'll</span> <span m='854530'>get</span>
  <span m='854650'>to</span> <span m='854770'>that</span> <span m='855520'>in</span>
  <span m='855610'>the</span> <span m='855700'>future.</span> <span m='856840'>Don't</span>
  <span m='856960'>want</span> <span m='857080'>to</span> <span m='857140'>time</span>
  <span m='857350'>travel</span> <span m='857590'>too</span> <span m='857740'>much.</span>
  </p><p><span m='858590'>OK,</span> <span m='858820'>so</span> <span m='859420'>some</span>
  <span m='860470'>property--</span> <span m='861070'>some</span> <span m='861610'>queries</span>
  <span m='862090'>have</span> <span m='862270'>this</span> <span m='862420'>property.</span>
  <span m='862840'>Some</span> <span m='863050'>don't.</span> <span m='863260'>If</span>
  <span m='863440'>they</span> <span m='863590'>do--</span> <span m='864670'>and</span>
  <span m='865000'>we</span> <span m='865090'>have</span> <span m='865270'>commutative</span>
  <span m='865810'>and</span> <span m='865930'>invertability--</span> <span m='867160'>I</span>
  <span m='867250'>claim</span> <span m='867520'>full</span> <span m='867820'>retroactivity</span>
  <span m='868630'>becomes</span> <span m='869080'>easy.</span> <span m='870010'>Relatively</span>
  <span m='870550'>easy.</span> <span m='871030'>Log</span> <span m='871300'>factor</span>
  <span m='871780'>overhead.</span> <span m='873140'>So</span> <span m='873190'>that's</span>
  <span m='873400'>what</span> <span m='873550'>I</span> <span m='873610'>wanted</span>
  <span m='873850'>to</span> <span m='874900'>show</span> <span m='875200'>you.</span>
  </p><p><span m='878170'>Full</span> <span m='878560'>retro</span> <span m='881440'>for</span>
  <span m='881920'>decomposable</span> <span m='882640'>search</span> <span m='882910'>problems.</span>
  <span m='888430'>Decomposable</span> <span m='889000'>search</span> <span m='889240'>problems</span>
  <span m='889540'>are</span> <span m='889690'>automatically</span> <span m='890470'>computed</span>
  <span m='890920'>of</span> <span m='891040'>an</span> <span m='891130'>invertible,</span>
  <span m='891700'>so</span> <span m='891880'>I</span> <span m='891940'>don't</span>
  <span m='892090'>need</span> <span m='892240'>to</span> <span m='892360'>write</span>
  <span m='892570'>that</span> <span m='892720'>constraint.</span> <span m='894410'>In</span>
  <span m='895870'>log--</span> <span m='897835'>I</span> <span m='898290'>have</span>
  <span m='898510'>n</span> <span m='898740'>here,</span> <span m='899010'>but I</span>
  <span m='899100'>think</span> <span m='899310'>I</span> <span m='899370'>mean</span>
  <span m='899600'>m--</span> <span m='901240'>overhead.</span> <span m='904370'>It's</span>
  <span m='904940'>a</span> <span m='905010'>multiplicative</span> <span m='905670'>factor.</span>
  <span m='906790'>m</span> <span m='906880'>here</span> <span m='907050'>is</span>
  <span m='907170'>the</span> <span m='907290'>number</span> <span m='907590'>of</span>
  <span m='907830'>retroactive</span> <span m='908430'>operations</span> <span m='909120'>you're</span>
  <span m='909270'>doing.</span> <span m='909630'>So</span> <span m='909750'>it's</span>
  <span m='909930'>the</span> <span m='910050'>size</span> <span m='910410'>of</span>
  <span m='910470'>the</span> <span m='910630'>timeline.</span> </p><p><span m='915080'>OK,</span>
  <span m='916730'>we're</span> <span m='916930'>going</span> <span m='917040'>to</span>
  <span m='917140'>do</span> <span m='917320'>that</span> <span m='920750'>via</span>
  <span m='920980'>something</span> <span m='921310'>called</span> <span m='921580'>a</span>
  <span m='921670'>segment</span> <span m='922150'>tree,</span> <span m='926566'>which</span>
  <span m='926920'>was</span> <span m='927070'>introduced</span> <span m='927550'>in</span>
  <span m='927700'>the</span> <span m='927790'>same</span> <span m='928060'>paper</span>
  <span m='928960'>that</span> <span m='929050'>dealt</span> <span m='929230'>with</span>
  <span m='929350'>decomposable</span> <span m='929950'>search</span> <span m='930190'>problems</span>
  <span m='930970'>by</span> <span m='931120'>Bentley</span> <span m='931390'>and
  Saxe</span> <span m='931470'>in 1980.</span> <span m='934450'>They</span> <span
  m='934600'>weren't</span> <span m='934840'>thinking</span> <span m='935140'>about</span>
  <span m='935350'>time</span> <span m='935560'>travel.</span> <span m='936850'>Retroactively</span>
  <span m='937780'>their</span> <span m='937930'>result</span> <span m='938350'>is</span>
  <span m='938500'>useful.</span> </p><p><span m='940450'>So</span> <span m='940690'>what's</span>
  <span m='940870'>a</span> <span m='940930'>segment</span> <span m='941320'>tree?</span>
  <span m='944080'>It's</span> <span m='944290'>a</span> <span m='944350'>tree.</span>
  <span m='945260'>Let me</span> <span m='945520'>draw</span> <span m='946450'>my</span>
  <span m='946570'>favorite</span> <span m='946900'>picture.</span> <span m='948490'>Draw</span>
  <span m='948730'>this</span> <span m='949300'>many</span> <span m='949600'>times</span>
  <span m='950020'>in</span> <span m='950110'>this</span> <span m='950230'>class,</span>
  <span m='950610'>I'm</span> <span m='950710'>sure.</span> </p><p><span m='955330'>I</span>
  <span m='955420'>would</span> <span m='955570'>like</span> <span m='955720'>to</span>
  <span m='955840'>build</span> <span m='956350'>a</span> <span m='957280'>balanced</span>
  <span m='957700'>binary</span> <span m='958000'>search</span> <span m='958270'>tree</span>
  <span m='958570'>on</span> <span m='958810'>time.</span> <span m='959440'>Leaves</span>
  <span m='959860'>will</span> <span m='960010'>be</span> <span m='960190'>time.</span>
  <span m='963490'>Here's</span> <span m='963730'>time.</span> </p><p><span m='968900'>And</span>
  <span m='968920'>the</span> <span m='969010'>idea</span> <span m='969340'>is,</span>
  <span m='969710'>well,</span> <span m='970790'>if</span> <span m='970870'>I</span>
  <span m='970960'>have</span> <span m='971500'>my</span> <span m='971710'>operations,</span>
  <span m='972280'>my</span> <span m='972430'>updates--</span> <span m='973120'>which</span>
  <span m='973330'>are</span> <span m='973420'>what</span> <span m='973720'>the</span>
  <span m='973810'>things</span> <span m='974050'>that</span> <span m='974170'>live</span>
  <span m='974350'>on</span> <span m='974470'>time</span> <span m='974760'>are--</span>
  <span m='975010'>are</span> <span m='975370'>inserts</span> <span m='975850'>and</span>
  <span m='975940'>deletes.</span> <span m='977090'>And</span> <span m='977230'>so</span>
  <span m='977380'>if</span> <span m='977470'>I</span> <span m='977560'>look</span>
  <span m='977740'>at</span> <span m='977830'>an</span> <span m='977920'>element,</span>
  <span m='979240'>at</span> <span m='979330'>some</span> <span m='979510'>point</span>
  <span m='979780'>it</span> <span m='979870'>might</span> <span m='980020'>be</span>
  <span m='980140'>inserted.</span> <span m='980890'>At</span> <span m='980980'>some</span>
  <span m='981160'>point</span> <span m='981310'>later</span> <span m='981520'>it</span>
  <span m='981580'>might</span> <span m='981730'>be</span> <span m='981850'>deleted.</span>
  <span m='982300'>I'm</span> <span m='982390'>going</span> <span m='982510'>to</span>
  <span m='982570'>assume</span> <span m='983470'>every</span> <span m='983740'>element</span>
  <span m='984070'>is</span> <span m='984460'>inserted</span> <span m='984760'>and</span>
  <span m='984850'>deleted</span> <span m='985240'>only</span> <span m='985570'>once.</span>
  <span m='987820'>Otherwise,</span> <span m='988400'>if</span> <span m='988740'>it</span>
  <span m='988810'>happens</span> <span m='989110'>multiple</span> <span m='989410'>times,</span>
  <span m='989660'>think</span> <span m='989830'>of</span> <span m='989890'>them</span>
  <span m='990040'>as</span> <span m='990130'>different</span> <span m='990400'>elements.</span>
  </p><p><span m='991910'>Then</span> <span m='991990'>every</span> <span m='992230'>element</span>
  <span m='992770'>exists</span> <span m='993430'>for</span> <span m='993610'>an</span>
  <span m='993700'>interval</span> <span m='994210'>of</span> <span m='994300'>time.</span>
  <span m='996460'>So</span> <span m='996610'>for</span> <span m='996730'>example,</span>
  <span m='997370'>maybe</span> <span m='997630'>I</span> <span m='997750'>have</span>
  <span m='999280'>an</span> <span m='999460'>element</span> <span m='999940'>that</span>
  <span m='1000060'>exists</span> <span m='1000450'>for</span> <span m='1001410'>this</span>
  <span m='1001770'>interval</span> <span m='1002250'>of</span> <span m='1002340'>time.</span>
  <span m='1002880'>Maybe</span> <span m='1003090'>it</span> <span m='1003150'>gets</span>
  <span m='1003330'>inserted</span> <span m='1003840'>here</span> <span m='1004680'>and</span>
  <span m='1004800'>then</span> <span m='1004950'>gets</span> <span m='1005160'>deleted</span>
  <span m='1005550'>here.</span> <span m='1006960'>How</span> <span m='1007140'>should</span>
  <span m='1007260'>I</span> <span m='1007350'>represent</span> <span m='1007860'>that</span>
  <span m='1008070'>interval</span> <span m='1008650'>in</span> <span m='1008730'>my</span>
  <span m='1008880'>tree?</span> <span m='1010380'>Let's</span> <span m='1010770'>call</span>
  <span m='1010980'>this</span> <span m='1011160'>element</span> <span m='1011580'>a.</span>
  </p><p><span m='1013650'>Well,</span> <span m='1015160'>if</span> <span m='1015640'>I</span>
  <span m='1015720'>draw</span> <span m='1016050'>a</span> <span m='1016080'>complete</span>
  <span m='1016410'>binary</span> <span m='1016710'>tree,</span> <span m='1016920'>there</span>
  <span m='1016980'>there's</span> <span m='1017130'>an</span> <span m='1017220'>obvious</span>
  <span m='1017520'>way</span> <span m='1017640'>to</span> <span m='1017730'>represent</span>
  <span m='1018150'>that</span> <span m='1018300'>interval,</span> <span m='1019180'>which</span>
  <span m='1019320'>is</span> <span m='1019990'>as</span> <span m='1020220'>the</span>
  <span m='1020280'>union</span> <span m='1021510'>of</span> <span m='1022680'>these</span>
  <span m='1024240'>four</span> <span m='1024630'>intervals.</span> <span m='1025150'>If</span>
  <span m='1025230'>you</span> <span m='1025290'>think</span> <span m='1025500'>of</span>
  <span m='1025589'>this</span> <span m='1025770'>node</span> <span m='1026010'>as</span>
  <span m='1026130'>representing</span> <span m='1026579'>the</span> <span m='1026670'>interval</span>
  <span m='1027030'>of</span> <span m='1027150'>all</span> <span m='1027390'>of</span>
  <span m='1027510'>its</span> <span m='1028230'>leaves,</span> <span m='1028750'>descendant</span>
  <span m='1029160'>leaves,</span> <span m='1029940'>then</span> <span m='1030119'>I</span>
  <span m='1030180'>could</span> <span m='1030300'>put</span> <span m='1030510'>a</span>
  <span m='1030720'>here.</span> <span m='1031140'>And</span> <span m='1031589'>I</span>
  <span m='1031680'>could</span> <span m='1031829'>put</span> <span m='1032010'>a</span>
  <span m='1032220'>here,</span> <span m='1033480'>and</span> <span m='1033690'>here,</span>
  <span m='1034829'>and</span> <span m='1034950'>here.</span> <span m='1036660'>I</span>
  <span m='1036780'>do</span> <span m='1036930'>that</span> <span m='1037079'>for</span>
  <span m='1038280'>all</span> <span m='1038460'>my</span> <span m='1038640'>elements.</span>
  </p><p><span m='1039270'>This picture's</span> <span m='1039579'>going</span> <span
  m='1039740'>to</span> <span m='1039859'>get</span> <span m='1040050'>messy</span>
  <span m='1040349'>quickly.</span> <span m='1041640'>Let</span> <span m='1041819'>me</span>
  <span m='1041940'>just</span> <span m='1042210'>do</span> <span m='1042690'>one</span>
  <span m='1042930'>more</span> <span m='1043079'>example.</span> <span m='1044599'>So</span>
  <span m='1044970'>maybe</span> <span m='1045240'>I</span> <span m='1045300'>have</span>
  <span m='1045599'>an</span> <span m='1045900'>element</span> <span m='1046349'>from</span>
  <span m='1046710'>here</span> <span m='1047940'>to</span> <span m='1050030'>here.</span>
  <span m='1051880'>Then</span> <span m='1051960'>I'm</span> <span m='1052050'>going</span>
  <span m='1052170'>to</span> <span m='1052440'>call</span> <span m='1052660'>that</span>
  <span m='1052770'>element</span> <span m='1053160'>b.</span> <span m='1053850'>Then</span>
  <span m='1053970'>I'll</span> <span m='1054030'>put</span> <span m='1054270'>b</span>
  <span m='1054510'>here.</span> <span m='1056010'>And</span> <span m='1056250'>I'll</span>
  <span m='1056370'>put</span> <span m='1056760'>b</span> <span m='1057690'>here.</span>
  <span m='1058950'>So</span> <span m='1059190'>always</span> <span m='1059370'>putting</span>
  <span m='1059670'>it</span> <span m='1059790'>is</span> <span m='1060660'>as</span>
  <span m='1060810'>high</span> <span m='1060960'>as</span> <span m='1061080'>I</span>
  <span m='1061170'>can.</span> </p><p><span m='1061650'>I</span> <span m='1061740'>don't</span>
  <span m='1061920'>want</span> <span m='1062040'>to</span> <span m='1062100'>put</span>
  <span m='1062280'>b</span> <span m='1063150'>or</span> <span m='1063360'>a</span>
  <span m='1063570'>in</span> <span m='1063750'>all</span> <span m='1064020'>the</span>
  <span m='1064110'>leaves</span> <span m='1064350'>it</span> <span m='1064440'>appears
  in,</span> <span m='1064890'>because</span> <span m='1065070'>that</span> <span
  m='1065190'>would</span> <span m='1065280'>be</span> <span m='1065370'>a</span>
  <span m='1065430'>linear</span> <span m='1065730'>number</span> <span m='1065970'>of</span>
  <span m='1066030'>leaves.</span> <span m='1066330'>If</span> <span m='1066450'>I</span>
  <span m='1066510'>do</span> <span m='1066660'>it</span> <span m='1066720'>like</span>
  <span m='1066930'>this,</span> <span m='1067690'>there's</span> <span m='1067740'>only</span>
  <span m='1067950'>log</span> <span m='1068270'>n</span> <span m='1068400'>subtrees</span>
  <span m='1068910'>I</span> <span m='1069030'>care</span> <span m='1069210'>about,</span>
  <span m='1070050'>representing</span> <span m='1070560'>the</span> <span m='1070680'>interval</span>
  <span m='1071670'>as</span> <span m='1072000'>a</span> <span m='1072060'>union</span>
  <span m='1072390'>of</span> <span m='1072480'>log</span> <span m='1072760'>n</span>
  <span m='1073530'>subtree</span> <span m='1074040'>aligned</span> <span m='1074460'>intervals.</span>
  </p><p><span m='1077000'>OK,</span> <span m='1078160'>now</span> <span m='1078860'>the</span>
  <span m='1078960'>real</span> <span m='1079140'>picture</span> <span m='1079560'>is</span>
  <span m='1079710'>slightly</span> <span m='1080190'>messier</span> <span m='1080520'>than</span>
  <span m='1080670'>this.</span> <span m='1081090'>I</span> <span m='1081180'>drew</span>
  <span m='1081360'>a</span> <span m='1081420'>nice,</span> <span m='1081660'>complete,</span>
  <span m='1082350'>perfect</span> <span m='1082650'>tree.</span> <span m='1083670'>In</span>
  <span m='1083790'>reality,</span> <span m='1084660'>you're</span> <span m='1084810'>inserting</span>
  <span m='1085350'>new</span> <span m='1085470'>operations</span> <span m='1086100'>in</span>
  <span m='1086220'>here.</span> <span m='1087030'>And</span> <span m='1087150'>so</span>
  <span m='1087300'>you've</span> <span m='1087420'>actually</span> <span m='1087690'>got</span>
  <span m='1087810'>to</span> <span m='1087870'>maintain</span> <span m='1088260'>this</span>
  <span m='1088440'>as</span> <span m='1088530'>a</span> <span m='1088590'>balanced</span>
  <span m='1088920'>binary</span> <span m='1089220'>search</span> <span m='1089460'>tree.</span>
  <span m='1089750'>So</span> <span m='1089820'>use</span> <span m='1090060'>a</span>
  <span m='1090360'>red-black</span> <span m='1090780'>tree,</span> <span m='1091410'>AVL</span>
  <span m='1091770'>tree,</span> <span m='1092110'>or</span> <span m='1092340'>pick</span>
  <span m='1092520'>your</span> <span m='1092640'>favorite.</span> <span m='1093560'>As</span>
  <span m='1093660'>long</span> <span m='1093780'>as</span> <span m='1093870'>it</span>
  <span m='1093960'>stays</span> <span m='1094230'>balanced,</span> <span m='1095190'>you</span>
  <span m='1095310'>can</span> <span m='1095460'>still</span> <span m='1095670'>do</span>
  <span m='1095820'>this.</span> <span m='1097420'>It'll</span> <span m='1097920'>be</span>
  <span m='1098130'>a</span> <span m='1098160'>little</span> <span m='1098370'>less</span>
  <span m='1098580'>obvious</span> <span m='1098880'>how</span> <span m='1098970'>to</span>
  <span m='1099060'>do</span> <span m='1099210'>rotations,</span> <span m='1099870'>but</span>
  <span m='1099990'>let's</span> <span m='1100170'>not</span> <span m='1100320'>worry</span>
  <span m='1100470'>about</span> <span m='1100650'>rotations</span> <span m='1101130'>right</span>
  <span m='1101280'>now.</span> </p><p><span m='1102660'>Now</span> <span m='1102870'>I</span>
  <span m='1102960'>want</span> <span m='1103140'>to</span> <span m='1103200'>do</span>
  <span m='1103320'>a</span> <span m='1103350'>query.</span> <span m='1105150'>What's</span>
  <span m='1105350'>a</span> <span m='1105410'>query</span> <span m='1105750'>look</span>
  <span m='1105960'>like?</span> <span m='1106200'>Well,</span> <span m='1106340'>I</span>
  <span m='1106440'>care</span> <span m='1106740'>about</span> <span m='1107100'>all</span>
  <span m='1107340'>the</span> <span m='1107460'>things</span> <span m='1107760'>done</span>
  <span m='1108090'>up</span> <span m='1108300'>to</span> <span m='1108420'>a</span>
  <span m='1108450'>certain</span> <span m='1108750'>time.</span> <span m='1109170'>Or</span>
  <span m='1109230'>really</span> <span m='1109500'>I</span> <span m='1109590'>care</span>
  <span m='1109770'>about</span> <span m='1111360'>who</span> <span m='1111540'>exists.</span>
  <span m='1111990'>Let's</span> <span m='1112140'>say</span> <span m='1112320'>I</span>
  <span m='1112380'>want</span> <span m='1112530'>to</span> <span m='1112590'>do</span>
  <span m='1112740'>a</span> <span m='1112800'>query</span> <span m='1114700'>on</span>
  <span m='1114870'>an</span> <span m='1114990'>array</span> <span m='1115260'>here.</span>
  <span m='1116876'>That's</span> <span m='1117260'>maybe</span> <span m='1117480'>not</span>
  <span m='1117630'>so</span> <span m='1117840'>exciting.</span> <span m='1119250'>Let's</span>
  <span m='1119400'>do</span> <span m='1119710'>a</span> <span m='1119920'>query</span>
  <span m='1122650'>here.</span> </p><p><span m='1126090'>I</span> <span m='1126240'>want</span>
  <span m='1126420'>to</span> <span m='1126480'>know</span> <span m='1126660'>at</span>
  <span m='1126900'>this</span> <span m='1127080'>time</span> <span m='1127650'>who</span>
  <span m='1127860'>exists,</span> <span m='1129510'>and</span> <span m='1130350'>perform</span>
  <span m='1130740'>the</span> <span m='1130830'>query</span> <span m='1131130'>on</span>
  <span m='1131580'>that</span> <span m='1131700'>time.</span> <span m='1131970'>So</span>
  <span m='1132090'>really,</span> <span m='1132570'>I'm</span> <span m='1132750'>asking</span>
  <span m='1133140'>about</span> <span m='1133830'>everything</span> <span m='1134340'>done</span>
  <span m='1135510'>in</span> <span m='1135900'>this</span> <span m='1136320'>interval,</span>
  <span m='1137550'>from</span> <span m='1137730'>the</span> <span m='1137790'>beginning</span>
  <span m='1138180'>of</span> <span m='1138270'>time</span> <span m='1138930'>to</span>
  <span m='1139260'>my</span> <span m='1139410'>query</span> <span m='1139770'>time</span>
  <span m='1140100'>t.</span> <span m='1141430'>So</span> <span m='1141870'>here's</span>
  <span m='1142080'>query</span> <span m='1144540'>of</span> <span m='1145260'>t.</span>
  </p><p><span m='1146550'>Now</span> <span m='1146670'>we</span> <span m='1146760'>don't</span>
  <span m='1146940'>know</span> <span m='1147090'>what</span> <span m='1147240'>the</span>
  <span m='1147330'>query</span> <span m='1147630'>is.</span> <span m='1148500'>We</span>
  <span m='1148590'>just</span> <span m='1148800'>know</span> <span m='1149040'>it's</span>
  <span m='1149280'>on</span> <span m='1149520'>the</span> <span m='1149610'>set.</span>
  <span m='1150380'>And</span> <span m='1150510'>we</span> <span m='1150600'>know</span>
  <span m='1150760'>that</span> <span m='1150850'>is</span> <span m='1150960'>decomposable</span>
  <span m='1151710'>in</span> <span m='1151800'>this</span> <span m='1151980'>way</span>
  <span m='1152590'>by</span> <span m='1152750'>a</span> <span m='1152810'>set</span>
  <span m='1153060'>union.</span> <span m='1154720'>So</span> <span m='1154890'>the</span>
  <span m='1155010'>idea</span> <span m='1155280'>is,</span> <span m='1155620'>well</span>
  <span m='1155790'>I'll</span> <span m='1155940'>do</span> <span m='1156120'>the</span>
  <span m='1156240'>query</span> <span m='1156930'>on</span> <span m='1157140'>this</span>
  <span m='1157350'>data</span> <span m='1157560'>structure,</span> <span m='1158070'>because</span>
  <span m='1158250'>that</span> <span m='1158400'>represents</span> <span m='1159390'>whatever</span>
  <span m='1159720'>existed</span> <span m='1160140'>at</span> <span m='1160260'>that</span>
  <span m='1160440'>time.</span> <span m='1161070'>And</span> <span m='1161160'>then</span>
  <span m='1161280'>I'll</span> <span m='1161340'>do</span> <span m='1161500'>the</span>
  <span m='1161580'>query</span> <span m='1161940'>on</span> <span m='1162150'>this</span>
  <span m='1162360'>data</span> <span m='1162570'>structure,</span> <span m='1162930'>because</span>
  <span m='1163110'>that</span> <span m='1163260'>represents</span> <span m='1163890'>the</span>
  <span m='1164010'>things</span> <span m='1164280'>that</span> <span m='1164400'>existed</span>
  <span m='1165330'>before</span> <span m='1165690'>that.</span> <span m='1169500'>That
  doesn't</span> <span m='1169720'>look</span> <span m='1169940'>so</span> <span m='1170550'>great.</span>
  </p><p><span m='1172240'>OK,</span> <span m='1172830'>so</span> <span m='1173760'>I</span>
  <span m='1173880'>need</span> <span m='1174090'>to</span> <span m='1174180'>put</span>
  <span m='1174780'>each</span> <span m='1175230'>element</span> <span m='1175740'>in</span>
  <span m='1175980'>log</span> <span m='1176400'>n</span> <span m='1176550'>different</span>
  <span m='1176820'>nodes</span> <span m='1177090'>in</span> <span m='1177210'>here,</span>
  <span m='1178440'>such</span> <span m='1178830'>that</span> <span m='1179220'>I</span>
  <span m='1179310'>can</span> <span m='1179460'>answer</span> <span m='1179670'>a</span>
  <span m='1179730'>query</span> <span m='1180120'>by</span> <span m='1180300'>looking</span>
  <span m='1180660'>at</span> <span m='1180780'>log</span> <span m='1181020'>n</span>
  <span m='1181110'>different</span> <span m='1181380'>nodes.</span> <span m='1182280'>And</span>
  <span m='1182400'>a</span> <span m='1182460'>query</span> <span m='1182850'>is</span>
  <span m='1183000'>asking</span> <span m='1183390'>about</span> <span m='1184710'>what</span>
  <span m='1184920'>are</span> <span m='1185010'>all</span> <span m='1185190'>the</span>
  <span m='1185310'>things</span> <span m='1185550'>that</span> <span m='1185670'>exist</span>
  <span m='1186030'>at</span> <span m='1186210'>this</span> <span m='1186390'>time.</span>
  <span m='1188480'>So</span> <span m='1188840'>here</span> <span m='1189080'>it</span>
  <span m='1189170'>would</span> <span m='1189320'>be</span> <span m='1189510'>ab.</span>
  <span m='1190310'>Over</span> <span m='1190520'>here</span> <span m='1190650'>it
  would</span> <span m='1190730'>be</span> <span m='1190820'>nothing.</span> <span
  m='1191810'>Over</span> <span m='1192020'>here</span> <span m='1192200'>it would</span>
  <span m='1192290'>be</span> <span m='1192380'>nothing.</span> <span m='1194884'>Yeah?</span>
  </p><p><span m='1196357'>AUDIENCE:</span> <span m='1196602'>If</span> <span m='1196848'>you're</span>
  <span m='1197339'>querying,</span> <span m='1197830'>the</span> <span m='1198321'>time</span>
  <span m='1198812'>correspond</span> <span m='1199303'>to</span> <span m='1199794'>particular</span>
  <span m='1200285'>[INAUDIBLE].</span> <span m='1200776'>Then you</span> <span m='1201267'>can
  query</span> <span m='1201758'>all the</span> <span m='1202249'>data structures--</span>
  </p><p><span m='1203250'>ERIK DEMAINE:</span> <span m='1203450'>OK,</span> <span
  m='1203860'>maybe</span> <span m='1204160'>I</span> <span m='1204190'>was</span>
  <span m='1204280'>just</span> <span m='1204430'>doing</span> <span m='1204670'>the</span>
  <span m='1204760'>queries</span> <span m='1205150'>wrong.</span> <span m='1205900'>Good,</span>
  <span m='1206860'>I</span> <span m='1206950'>think</span> <span m='1207160'>that's</span>
  <span m='1207370'>a</span> <span m='1207430'>good</span> <span m='1207580'>idea.</span>
  <span m='1208630'>I</span> <span m='1208720'>guess</span> <span m='1208870'>I'm</span>
  <span m='1208990'>asking</span> <span m='1209350'>about</span> <span m='1209560'>querying</span>
  <span m='1210010'>this</span> <span m='1210220'>time.</span> <span m='1212080'>So</span>
  <span m='1212200'>which node</span> <span m='1212450'>should I</span> <span m='1212820'>do?</span>
  <span m='1213850'>All</span> <span m='1214150'>the</span> <span m='1214390'>ancestors.</span>
  <span m='1219630'>I</span> <span m='1219730'>see.</span> <span m='1221920'>Claim</span>
  <span m='1222160'>that</span> <span m='1222340'>does</span> <span m='1222540'>it.</span>
  <span m='1224880'>Gotta think</span> <span m='1225100'>about</span> <span m='1225370'>it.</span>
  </p><p><span m='1225962'>AUDIENCE:</span> <span m='1226198'>And</span> <span m='1226434'>then
  you</span> <span m='1226906'>carry</span> <span m='1227378'>[INAUDIBLE]</span> </p><p><span
  m='1229740'>ERIK DEMAINE:</span> <span m='1229815'>That</span> <span m='1229890'>definitely</span>
  <span m='1230190'>gets</span> <span m='1230370'>a and</span> <span m='1230610'>b.</span>
  <span m='1231400'>That looks good.</span> <span m='1232260'>All</span> <span m='1232320'>right,</span>
  <span m='1232470'>exercise</span> <span m='1232790'>to</span> <span m='1233110'>prove</span>
  <span m='1233410'>that this</span> <span m='1233700'>works.</span> <span m='1238110'>I</span>
  <span m='1238200'>think</span> <span m='1238470'>that</span> <span m='1238650'>is</span>
  <span m='1238830'>right.</span> <span m='1240150'>So</span> <span m='1240330'>it's</span>
  <span m='1240450'>an</span> <span m='1240540'>asymmetry</span> <span m='1241140'>between</span>
  <span m='1241470'>queries</span> <span m='1241800'>and</span> <span m='1241890'>updates.</span>
  <span m='1242640'>For</span> <span m='1242880'>updates,</span> <span m='1246090'>you</span>
  <span m='1246210'>basically</span> <span m='1247500'>partition</span> <span m='1248070'>the</span>
  <span m='1248220'>interval.</span> </p><p><span m='1251340'>AUDIENCE:</span> <span
  m='1251586'>What</span> <span m='1251832'>happens</span> <span m='1252324'>to</span>
  <span m='1252816'>a very</span> <span m='1253308'>short-lived</span> <span m='1254292'>element</span>
  <span m='1254784'>at</span> <span m='1255276'>the</span> <span m='1255768'>very
  end</span> <span m='1256260'>of the</span> <span m='1256752'>time</span> <span m='1257244'>travel?</span>
  <span m='1257736'>[INAUDIBLE]</span> </p><p><span m='1273030'>ERIK DEMAINE:</span>
  <span m='1273135'>So</span> <span m='1273240'>maybe</span> <span m='1273480'>this</span>
  <span m='1273660'>works.</span> <span m='1274530'>I'll think</span> <span m='1274860'>about</span>
  <span m='1275100'>it</span> <span m='1275220'>offline</span> <span m='1276300'>and</span>
  <span m='1276550'>I'll</span> <span m='1276630'>send</span> <span m='1276900'>email</span>
  <span m='1277710'>if</span> <span m='1277860'>it</span> <span m='1277980'>doesn't</span>
  <span m='1278250'>work.</span> <span m='1278580'>But</span> <span m='1279490'>I</span>
  <span m='1279690'>think</span> <span m='1279870'>this</span> <span m='1280050'>is</span>
  <span m='1280200'>right.</span> </p><p><span m='1281670'>So</span> <span m='1282020'>for
  query,</span> <span m='1282290'>you</span> <span m='1282540'>walk</span> <span m='1282810'>up</span>
  <span m='1282930'>time.</span> <span m='1283320'>And</span> <span m='1283470'>I'm</span>
  <span m='1283560'>going</span> <span m='1283680'>to</span> <span m='1283740'>query</span>
  <span m='1284070'>each</span> <span m='1284250'>of</span> <span m='1284310'>these</span>
  <span m='1284490'>data</span> <span m='1284700'>structures.</span> <span m='1285990'>Now</span>
  <span m='1286110'>this</span> <span m='1286320'>is</span> <span m='1286470'>a</span>
  <span m='1286710'>logarithmic</span> <span m='1287280'>factor</span> <span m='1287830'>overhead,</span>
  <span m='1288270'>both</span> <span m='1288570'>in</span> <span m='1288720'>time</span>
  <span m='1289080'>and</span> <span m='1289290'>space,</span> <span m='1290400'>because</span>
  <span m='1291030'>each</span> <span m='1291300'>element</span> <span m='1291660'>might</span>
  <span m='1291900'>be</span> <span m='1292020'>stored</span> <span m='1292350'>in</span>
  <span m='1292440'>log</span> <span m='1292680'>n</span> <span m='1292770'>different</span>
  <span m='1293010'>structures.</span> </p><p><span m='1293480'>Or</span> <span m='1293570'>what</span>
  <span m='1293790'>are</span> <span m='1293880'>in</span> <span m='1294000'>these</span>
  <span m='1294180'>nodes,</span> <span m='1294450'>by</span> <span m='1294630'>the</span>
  <span m='1294720'>way?</span> <span m='1295510'>That</span> <span m='1295620'>is</span>
  <span m='1295890'>your</span> <span m='1296100'>data</span> <span m='1296370'>structure,</span>
  <span m='1297030'>the</span> <span m='1297120'>non-retroactive</span> <span m='1297930'>version.</span>
  <span m='1298700'>So we're</span> <span m='1298910'>storing</span> <span m='1299370'>the</span>
  <span m='1299460'>non-radioactive</span> <span m='1300150'>data</span> <span m='1300300'>structure</span>
  <span m='1300660'>on</span> <span m='1300840'>these</span> <span m='1301050'>guys</span>
  <span m='1302430'>in</span> <span m='1302640'>order</span> <span m='1302910'>to--</span>
  <span m='1303935'>when I</span> <span m='1304210'>add--</span> <span m='1305140'>if</span>
  <span m='1305250'>I</span> <span m='1305340'>modify</span> <span m='1305880'>a's</span>
  <span m='1306120'>interval,</span> <span m='1307010'>I</span> <span m='1307110'>delete</span>
  <span m='1307500'>it</span> <span m='1307590'>from</span> <span m='1307800'>all</span>
  <span m='1307920'>the</span> <span m='1308040'>places</span> <span m='1308400'>that</span>
  <span m='1308490'>used</span> <span m='1308670'>to</span> <span m='1308790'>be</span>
  <span m='1308970'>in</span> <span m='1309230'>and</span> <span m='1309360'>then</span>
  <span m='1309540'>reinsert</span> <span m='1309870'>it</span> <span m='1310200'>into</span>
  <span m='1310410'>all</span> <span m='1310530'>the</span> <span m='1310650'>places</span>
  <span m='1311340'>it's</span> <span m='1311490'>now</span> <span m='1311760'>in.</span>
  <span m='1311940'>So</span> <span m='1312120'>I'm</span> <span m='1312210'>doing</span>
  <span m='1312390'>inserts</span> <span m='1312750'>and</span> <span m='1312840'>deletes</span>
  <span m='1313680'>on</span> <span m='1314010'>log</span> <span m='1314265'>n</span>
  <span m='1314520'>of</span> <span m='1314640'>those</span> <span m='1315980'>non-retroactive</span>
  <span m='1316650'>data</span> <span m='1316830'>structures.</span> </p><p><span
  m='1318330'>OK,</span> <span m='1318810'>and</span> <span m='1318930'>then</span>
  <span m='1319080'>I</span> <span m='1319140'>combine</span> <span m='1319530'>with</span>
  <span m='1319650'>f</span> <span m='1319890'>which</span> <span m='1320070'>is</span>
  <span m='1320160'>constant</span> <span m='1320490'>time.</span> <span m='1321490'>So</span>
  <span m='1321730'>only</span> <span m='1321870'>log</span> <span m='1322230'>factor</span>
  <span m='1322680'>overhead</span> <span m='1323010'>on</span> <span m='1323130'>the</span>
  <span m='1323300'>queries.</span> <span m='1325211'>OK,</span> <span m='1325710'>a</span>
  <span m='1325740'>little</span> <span m='1326580'>harder</span> <span m='1326850'>than</span>
  <span m='1327000'>I</span> <span m='1327120'>thought.</span> </p><p><span m='1330420'>So</span>
  <span m='1330630'>full</span> <span m='1330900'>retro,</span> <span m='1332010'>full</span>
  <span m='1332390'>retroactivity,</span> <span m='1333300'>but</span> <span m='1333480'>in</span>
  <span m='1333600'>this</span> <span m='1333750'>relatively</span> <span m='1334320'>simple</span>
  <span m='1335340'>special</span> <span m='1335730'>case.</span> <span m='1336420'>Let's</span>
  <span m='1336600'>talk</span> <span m='1336780'>about</span> <span m='1336960'>the</span>
  <span m='1337050'>general</span> <span m='1337350'>case.</span> </p><p><span m='1357630'>There's</span>
  <span m='1357840'>an</span> <span m='1357960'>obvious</span> <span m='1358320'>way</span>
  <span m='1358500'>to</span> <span m='1358620'>do</span> <span m='1358980'>full</span>
  <span m='1359600'>retroactivity,</span> <span m='1361140'>which</span> <span m='1361380'>is--</span>
  <span m='1362830'>let's</span> <span m='1362910'>say</span> <span m='1363210'>partial</span>
  <span m='1363600'>retroactivity.</span> <span m='1364200'>I</span> <span m='1364260'>want</span>
  <span m='1364440'>to</span> <span m='1364500'>know</span> <span m='1364620'>what</span>
  <span m='1364770'>happened</span> <span m='1365130'>in</span> <span m='1365250'>the</span>
  <span m='1365340'>present.</span> <span m='1366780'>The</span> <span m='1366870'>obvious</span>
  <span m='1367140'>thing</span> <span m='1367320'>to</span> <span m='1367440'>do</span>
  <span m='1367950'>is</span> <span m='1369000'>write</span> <span m='1369270'>down</span>
  <span m='1369480'>all</span> <span m='1369630'>the</span> <span m='1369720'>changes</span>
  <span m='1370080'>you</span> <span m='1370200'>made.</span> <span m='1371280'>And</span>
  <span m='1371430'>then</span> <span m='1372270'>if</span> <span m='1372450'>you</span>
  <span m='1372540'>want</span> <span m='1372660'>to</span> <span m='1372720'>make</span>
  <span m='1372900'>a</span> <span m='1372930'>retroactive</span> <span m='1373380'>change,</span>
  <span m='1373800'>you</span> <span m='1373980'>roll</span> <span m='1374400'>back,</span>
  <span m='1375600'>do</span> <span m='1375750'>your</span> <span m='1375900'>change,</span>
  <span m='1376440'>and</span> <span m='1376560'>then</span> <span m='1376680'>replay</span>
  <span m='1377190'>everything</span> <span m='1377580'>that</span> <span m='1377670'>happened</span>
  <span m='1377970'>meanwhile.</span> <span m='1379200'>So</span> <span m='1379380'>this</span>
  <span m='1379620'>is</span> <span m='1380520'>the</span> <span m='1380640'>rollback</span>
  <span m='1381180'>method.</span> </p><p><span m='1405470'>So</span> <span m='1405600'>if</span>
  <span m='1405720'>I</span> <span m='1405840'>need</span> <span m='1406080'>to</span>
  <span m='1406200'>go</span> <span m='1406380'>back</span> <span m='1406710'>in</span>
  <span m='1406830'>time</span> <span m='1407310'>by</span> <span m='1407490'>a</span>
  <span m='1407520'>factor</span> <span m='1407850'>of</span> <span m='1407940'>r,</span>
  <span m='1410430'>by</span> <span m='1411060'>r</span> <span m='1411210'>time</span>
  <span m='1411450'>units,</span> <span m='1411690'>I</span> <span m='1411780'>pay</span>
  <span m='1411940'>a</span> <span m='1411960'>factor</span> <span m='1412320'>of</span>
  <span m='1412410'>r</span> <span m='1413100'>overhead</span> <span m='1413550'>in</span>
  <span m='1413880'>time.</span> <span m='1414930'>And</span> <span m='1415020'>space</span>
  <span m='1415440'>is</span> <span m='1415590'>reasonable.</span> <span m='1416010'>You</span>
  <span m='1416070'>just</span> <span m='1416220'>have</span> <span m='1416340'>to</span>
  <span m='1416430'>remember</span> <span m='1416850'>everything</span> <span m='1417240'>that</span>
  <span m='1417360'>happened.</span> <span m='1419670'>This</span> <span m='1419850'>is</span>
  <span m='1419940'>pretty</span> <span m='1420180'>obvious.</span> <span m='1421340'>Also</span>
  <span m='1421680'>old.</span> <span m='1422880'>Unfortunately,</span> <span m='1423450'>it's</span>
  <span m='1423660'>about</span> <span m='1423900'>the</span> <span m='1423960'>best</span>
  <span m='1424200'>we</span> <span m='1424320'>can</span> <span m='1424470'>do</span>
  <span m='1424650'>in</span> <span m='1424770'>general,</span> <span m='1426150'>depending</span>
  <span m='1426750'>on</span> <span m='1426870'>your</span> <span m='1426990'>exact</span>
  <span m='1427380'>model.</span> </p><p><span m='1434492'>So</span> <span m='1434970'>we
  add the</span> <span m='1435060'>lower</span> <span m='1435350'>bound.</span> </p><p><span
  m='1454210'>This</span> <span m='1454390'>is</span> <span m='1454930'>kind</span>
  <span m='1455170'>of</span> <span m='1455290'>a</span> <span m='1455350'>fun</span>
  <span m='1455590'>result</span> <span m='1456040'>from</span> <span m='1456340'>a</span>
  <span m='1456550'>philosophy</span> <span m='1457240'>standpoint,</span> <span m='1457900'>philosophy</span>
  <span m='1458350'>of</span> <span m='1458440'>time</span> <span m='1458680'>travel.</span>
  <span m='1460270'>It's</span> <span m='1460450'>essentially</span> <span m='1460960'>saying</span>
  <span m='1461320'>that</span> <span m='1461440'><i>Back</i></span> <span m='1461650'><i>to</i></span>
  <span m='1461740'><i>the</i></span> <span m='1461800'><i>Future</i></span> <span
  m='1462100'>is</span> <span m='1462190'>impossible.</span> <span m='1463360'>I</span>
  <span m='1463450'>know,</span> <span m='1463600'>it's</span> <span m='1463690'>sad</span>
  <span m='1464545'>but</span> <span m='1464990'>true.</span> <span m='1465610'>And</span>
  <span m='1465730'>there's</span> <span m='1465910'>a</span> <span m='1465970'>good</span>
  <span m='1466330'>movie</span> <span m='1466960'>about</span> <span m='1467440'>this</span>
  <span m='1467680'>called</span> <span m='1468100'><i>Retroactive.</i></span> <span
  m='1468850'>This</span> <span m='1469000'>is</span> <span m='1469090'>a</span> <span
  m='1469120'>very</span> <span m='1469370'>unknown</span> <span m='1470170'>movie,</span>
  <span m='1470950'>from</span> <span m='1471130'>'97,</span> <span m='1471760'>or</span>
  <span m='1471820'>so,</span> <span m='1473050'>where</span> <span m='1474850'>they</span>
  <span m='1475330'>play</span> <span m='1475540'>through</span> <span m='1475690'>this</span>
  <span m='1476440'>sequence</span> <span m='1476980'>of</span> <span m='1477070'>events.</span>
  <span m='1477940'>And</span> <span m='1478060'>then</span> <span m='1478210'>there's</span>
  <span m='1478390'>a</span> <span m='1478450'>time</span> <span m='1478660'>machine</span>
  <span m='1478900'>which</span> <span m='1479080'>brings</span> <span m='1479350'>them,</span>
  <span m='1479750'>I</span> <span m='1480040'>forget,</span> <span m='1480580'>an</span>
  <span m='1480700'>hour</span> <span m='1481060'>into</span> <span m='1481300'>the</span>
  <span m='1481390'>past.</span> <span m='1482740'>And</span> <span m='1482860'>then</span>
  <span m='1483010'>they</span> <span m='1483130'>have</span> <span m='1483250'>to</span>
  <span m='1483400'>relive</span> <span m='1483970'>those</span> <span m='1484180'>events.</span>
  <span m='1484510'>And</span> <span m='1484660'>they</span> <span m='1484840'>can</span>
  <span m='1484960'>make</span> <span m='1485110'>changes.</span> </p><p><span m='1486070'>But</span>
  <span m='1486250'>they</span> <span m='1486370'>have</span> <span m='1486580'>to</span>
  <span m='1486700'>spend</span> <span m='1487030'>all</span> <span m='1487150'>that</span>
  <span m='1487300'>time</span> <span m='1487570'>until</span> <span m='1487780'>they</span>
  <span m='1487840'>get</span> <span m='1487960'>to</span> <span m='1488050'>the</span>
  <span m='1488140'>time</span> <span m='1488370'>machine</span> <span m='1488460'>again.</span>
  <span m='1488830'>They</span> <span m='1488950'>still</span> <span m='1489310'>didn't</span>
  <span m='1489520'>get</span> <span m='1489670'>it</span> <span m='1489760'>right,</span>
  <span m='1490000'>so</span> <span m='1490120'>they</span> <span m='1490240'>go</span>
  <span m='1490390'>back</span> <span m='1490600'>in</span> <span m='1490690'>time.</span>
  <span m='1491290'>And</span> <span m='1491410'>the</span> <span m='1491500'>movie</span>
  <span m='1491740'>repeats</span> <span m='1492220'>like</span> <span m='1492850'>six</span>
  <span m='1493210'>times</span> <span m='1493600'>or</span> <span m='1493660'>so,</span>
  <span m='1494140'>until</span> <span m='1494320'>they</span> <span m='1494410'>finally</span>
  <span m='1494770'>get</span> <span m='1494920'>it</span> <span m='1494980'>right.</span>
  <span m='1495660'>Or</span> <span m='1495710'>I</span> <span m='1495950'>shouldn't,</span>
  <span m='1496310'>whatever,</span> <span m='1496720'>forget</span> <span m='1497050'>the</span>
  <span m='1497170'>ending</span> <span m='1497470'>actually.</span> </p><p><span
  m='1499030'>So</span> <span m='1499780'>that's</span> <span m='1500320'>realistic</span>
  <span m='1501570'>in</span> <span m='1501730'>that</span> <span m='1501910'>we</span>
  <span m='1502090'>know</span> <span m='1502360'>from</span> <span m='1502540'>persistence,</span>
  <span m='1503020'>we</span> <span m='1503140'>can</span> <span m='1503290'>remember</span>
  <span m='1503830'>the</span> <span m='1503950'>past.</span> <span m='1505150'>And</span>
  <span m='1505330'>we</span> <span m='1505420'>can</span> <span m='1505550'>jump</span>
  <span m='1505780'>back</span> <span m='1505990'>into</span> <span m='1506140'>the</span>
  <span m='1506200'>past</span> <span m='1506470'>and</span> <span m='1506560'>then</span>
  <span m='1506680'>just</span> <span m='1506830'>relive</span> <span m='1507250'>it.</span>
  <span m='1508360'>And</span> <span m='1508600'>maybe</span> <span m='1508900'>make</span>
  <span m='1509080'>changes</span> <span m='1509500'>along</span> <span m='1509770'>the</span>
  <span m='1509860'>way.</span> <span m='1510610'>But</span> <span m='1511390'>the</span>
  <span m='1511480'>claim</span> <span m='1511690'>is</span> <span m='1511780'>you</span>
  <span m='1511870'>can't</span> <span m='1512080'>do</span> <span m='1512200'>that</span>
  <span m='1512350'>any</span> <span m='1512530'>more</span> <span m='1512710'>efficiently</span>
  <span m='1513520'>than</span> <span m='1513730'>replaying</span> <span m='1514510'>all</span>
  <span m='1514610'>of</span> <span m='1514650'>those</span> <span m='1514810'>events,</span>
  <span m='1515200'>in</span> <span m='1515350'>the</span> <span m='1515440'>worst</span>
  <span m='1515620'>case,</span> <span m='1516670'>and</span> <span m='1516910'>I</span>
  <span m='1516970'>think</span> <span m='1517240'>even</span> <span m='1517510'>in</span>
  <span m='1517810'>real</span> <span m='1518020'>life.</span> <span m='1519760'>Should</span>
  <span m='1520000'>include</span> <span m='1520270'>the</span> <span m='1520360'>worst</span>
  <span m='1520570'>case.</span> <span m='1521300'>So</span> <span m='1521350'>let</span>
  <span m='1521470'>me</span> <span m='1521560'>tell</span> <span m='1521740'>you</span>
  <span m='1521860'>why.</span> <span m='1522460'>All</span> <span m='1522700'>we</span>
  <span m='1522820'>need</span> <span m='1523780'>to</span> <span m='1523900'>live</span>
  <span m='1524140'>in</span> <span m='1524230'>our</span> <span m='1524320'>universe</span>
  <span m='1524920'>for</span> <span m='1525100'>this</span> <span m='1525580'>lower</span>
  <span m='1525850'>bound</span> <span m='1526060'>to</span> <span m='1526180'>hold</span>
  <span m='1526930'>is</span> <span m='1527290'>a</span> <span m='1527350'>very</span>
  <span m='1527650'>simple</span> <span m='1527980'>computer.</span> </p><p><span
  m='1541440'>It's</span> <span m='1541620'>a</span> <span m='1541690'>computer</span>
  <span m='1542110'>with</span> <span m='1542290'>two</span> <span m='1542470'>registers,</span>
  <span m='1543220'>x</span> <span m='1543520'>and</span> <span m='1543640'>y.</span>
  <span m='1544360'>They</span> <span m='1544480'>start</span> <span m='1544750'>at</span>
  <span m='1545110'>zero.</span> </p><p><span m='1545530'>AUDIENCE:</span> <span m='1546025'>Question.</span>
  </p><p><span m='1546520'>ERIK DEMAINE:</span> <span m='1546670'>Yeah?</span> </p><p><span
  m='1546745'>AUDIENCE:</span> <span m='1546820'>When you say</span> <span m='1547120'>that
  the overhead</span> <span m='1547608'>can be</span> <span m='1548096'>necessary,</span>
  <span m='1548584'>does that mean that</span> <span m='1549560'>it's</span> <span
  m='1550048'>sometimes</span> <span m='1550536'>not--</span> </p><p><span m='1551520'>ERIK
  DEMAINE:</span> <span m='1551685'>The</span> <span m='1551850'>can</span> <span
  m='1552250'>be</span> <span m='1552460'>is</span> <span m='1552580'>relative</span>
  <span m='1553060'>to</span> <span m='1553210'>the</span> <span m='1553360'>data</span>
  <span m='1553630'>structure.</span> <span m='1554320'>So</span> <span m='1554440'>there</span>
  <span m='1554620'>is</span> <span m='1554770'>a</span> <span m='1554830'>data</span>
  <span m='1555040'>structure</span> <span m='1555460'>where</span> <span m='1555610'>you're</span>
  <span m='1555760'>guaranteed</span> <span m='1556360'>to</span> <span m='1556510'>need</span>
  <span m='1557560'>order</span> <span m='1558070'>r</span> <span m='1558760'>in</span>
  <span m='1558910'>the</span> <span m='1559000'>worst</span> <span m='1559210'>case.</span>
  <span m='1561430'>And</span> <span m='1561580'>probably</span> <span m='1561940'>the</span>
  <span m='1562120'>average</span> <span m='1562510'>case</span> <span m='1562870'>in</span>
  <span m='1562990'>all</span> <span m='1563080'>sorts</span> <span m='1563320'>of</span>
  <span m='1563840'>bad</span> <span m='1564210'>things.</span> <span m='1565010'>Yeah,</span>
  <span m='1565240'>so</span> <span m='1565390'>there</span> <span m='1565540'>are</span>
  <span m='1565570'>some</span> <span m='1565780'>data</span> <span m='1565960'>structures,</span>
  <span m='1566470'>like</span> <span m='1567430'>these</span> <span m='1567670'>ones,</span>
  <span m='1567940'>where</span> <span m='1568090'>you</span> <span m='1568210'>can</span>
  <span m='1568360'>do</span> <span m='1568540'>better.</span> <span m='1569780'>And</span>
  <span m='1569800'>this</span> <span m='1569980'>is</span> <span m='1570100'>for</span>
  <span m='1570250'>partial</span> <span m='1570630'>retroactivity.</span> <span m='1573790'>But</span>
  <span m='1573970'>then</span> <span m='1574380'>there</span> <span m='1574490'>are</span>
  <span m='1574540'>some</span> <span m='1574750'>data</span> <span m='1574880'>structures,</span>
  <span m='1575230'>like</span> <span m='1575380'>the</span> <span m='1575440'>one</span>
  <span m='1575590'>I'm</span> <span m='1575680'>going</span> <span m='1575890'>to</span>
  <span m='1575980'>describe</span> <span m='1576340'>to</span> <span m='1576430'>you,</span>
  <span m='1576670'>that</span> <span m='1576970'>you</span> <span m='1577120'>cannot</span>
  <span m='1577420'>do</span> <span m='1577540'>better.</span> </p><p><span m='1581720'>So</span>
  <span m='1581860'>here</span> <span m='1582030'>are</span> <span m='1582070'>my</span>
  <span m='1582190'>operations.</span> <span m='1582790'>I</span> <span m='1582880'>can</span>
  <span m='1583030'>set</span> <span m='1583330'>x</span> <span m='1583630'>to</span>
  <span m='1583780'>a</span> <span m='1583850'>value.</span> <span m='1585230'>I</span>
  <span m='1585250'>can</span> <span m='1586120'>add</span> <span m='1586790'>a</span>
  <span m='1586870'>value</span> <span m='1587290'>to</span> <span m='1587470'>y.</span>
  <span m='1589600'>I</span> <span m='1589750'>can</span> <span m='1590320'>compute</span>
  <span m='1590800'>the</span> <span m='1590890'>product</span> <span m='1591460'>of</span>
  <span m='1591580'>x</span> <span m='1591790'>and</span> <span m='1591880'>y</span>
  <span m='1592120'>and</span> <span m='1592210'>put</span> <span m='1592390'>it</span>
  <span m='1592480'>into</span> <span m='1592780'>y.</span> <span m='1595240'>And</span>
  <span m='1595420'>then</span> <span m='1595870'>I</span> <span m='1595960'>have</span>
  <span m='1596110'>a</span> <span m='1596170'>query,</span> <span m='1597820'>which</span>
  <span m='1598090'>is</span> <span m='1599080'>what</span> <span m='1599290'>is</span>
  <span m='1599440'>y.</span> <span m='1601350'>So</span> <span m='1601660'>this</span>
  <span m='1601990'>is</span> <span m='1602140'>one</span> <span m='1602290'>of</span>
  <span m='1602350'>the</span> <span m='1602440'>simplest</span> <span m='1602830'>computers</span>
  <span m='1603280'>ever</span> <span m='1603700'>designed.</span> <span m='1605160'>A</span>
  <span m='1605440'>very</span> <span m='1605920'>basic</span> <span m='1606190'>calculator.</span>
  <span m='1607210'>But</span> <span m='1607900'>it</span> <span m='1608050'>lets</span>
  <span m='1608380'>us</span> <span m='1608620'>do--</span> </p><p><span m='1611230'>Here's</span>
  <span m='1611650'>what</span> <span m='1611980'>the</span> <span m='1612160'>operations</span>
  <span m='1612700'>I'm</span> <span m='1612790'>going</span> <span m='1612970'>to</span>
  <span m='1613090'>do.</span> <span m='1613390'>First</span> <span m='1613750'>operation--</span>
  <span m='1615400'>this</span> <span m='1615640'>is</span> <span m='1615790'>in</span>
  <span m='1616180'>order</span> <span m='1616480'>of</span> <span m='1616600'>time.</span>
  <span m='1617890'>First</span> <span m='1618280'>I</span> <span m='1618430'>will</span>
  <span m='1618790'>add</span> <span m='1619270'>a</span> <span m='1619720'>into</span>
  <span m='1619870'>y.</span> <span m='1621220'>Then</span> <span m='1621400'>I</span>
  <span m='1621460'>will</span> <span m='1621610'>compute</span> <span m='1622480'>the</span>
  <span m='1622600'>product.</span> <span m='1624420'>Then</span> <span m='1624660'>I</span>
  <span m='1624790'>will</span> <span m='1625230'>compute--</span> <span m='1626220'>then</span>
  <span m='1626380'>I</span> <span m='1626470'>will</span> <span m='1626620'>add</span>
  <span m='1627070'>a and</span> <span m='1627370'>minus</span> <span m='1627610'>1</span>
  <span m='1627820'>to</span> <span m='1627940'>y.</span> <span m='1628675'>Then</span>
  <span m='1629080'>I</span> <span m='1629170'>will</span> <span m='1629290'>compute</span>
  <span m='1629620'>the</span> <span m='1629710'>product.</span> <span m='1631900'>And</span>
  <span m='1632080'>then</span> <span m='1632650'>at</span> <span m='1632800'>the</span>
  <span m='1632980'>end,</span> <span m='1633340'>I</span> <span m='1633460'>will</span>
  <span m='1633640'>add</span> <span m='1634840'>a</span> <span m='1635080'>zero</span>
  <span m='1635500'>to</span> <span m='1635650'>y.</span> <span m='1636760'>What</span>
  <span m='1636910'>does</span> <span m='1637060'>that</span> <span m='1637240'>do?</span>
  <span m='1641090'>Mathematicians.</span> </p><p><span m='1642724'>AUDIENCE:</span>
  <span m='1642940'>[INAUDIBLE]</span> </p><p><span m='1644890'>ERIK DEMAINE:</span>
  <span m='1645070'>Polynomial</span> <span m='1645610'>evaluation.</span> <span m='1647470'>This</span>
  <span m='1648460'>is</span> <span m='1648580'>equivalent</span> <span m='1649150'>to</span>
  <span m='1649510'>computing</span> <span m='1651880'>a n,</span> <span m='1652360'>x</span>
  <span m='1652630'>to</span> <span m='1652780'>the</span> <span m='1652960'>n--</span>
  <span m='1654650'>well,</span> <span m='1655060'>I</span> <span m='1655150'>guess</span>
  <span m='1655430'>capital</span> <span m='1655900'>X</span> <span m='1656080'>to</span>
  <span m='1656200'>the</span> <span m='1656350'>n,</span> <span m='1657370'>a n</span>
  <span m='1657700'>minus</span> <span m='1658060'>1,</span> <span m='1658780'>x</span>
  <span m='1659080'>to</span> <span m='1659200'>the</span> <span m='1659530'>n minus</span>
  <span m='1659890'>1,</span> <span m='1661400'>a0.</span> <span m='1664210'>OK,</span>
  <span m='1664360'>I didn't</span> <span m='1664540'>set</span> <span m='1664930'>X</span>
  <span m='1665500'>at</span> <span m='1665620'>the</span> <span m='1665710'>beginning.</span>
  <span m='1666040'>But</span> <span m='1666160'>whatever</span> <span m='1666520'>X</span>
  <span m='1666790'>was,</span> <span m='1667560'>this</span> <span m='1668390'>sequence</span>
  <span m='1668740'>of</span> <span m='1668860'>operations</span> <span m='1669400'>will</span>
  <span m='1669580'>evaluate</span> <span m='1670150'>this</span> <span m='1670300'>polynomial.</span>
  <span m='1670820'>This is</span> <span m='1670960'>called</span> <span m='1671190'>Cramer's</span>
  <span m='1671650'>rule</span> <span m='1672280'>for</span> <span m='1672490'>evaluating</span>
  <span m='1673030'>that</span> <span m='1673180'>polynomial.</span> <span m='1673870'>Just</span>
  <span m='1674020'>keep</span> <span m='1674230'>multiplying</span> <span m='1674680'>by</span>
  <span m='1674830'>X</span> <span m='1675270'>in</span> <span m='1675370'>each</span>
  <span m='1675520'>round,</span> <span m='1676660'>adding</span> <span m='1676990'>on</span>
  <span m='1677270'>the</span> <span m='1677800'>next</span> <span m='1678010'>coefficient.</span>
  </p><p><span m='1680130'>OK,</span> <span m='1680800'>so</span> <span m='1681070'>the</span>
  <span m='1681160'>result--</span> <span m='1681760'>this</span> <span m='1682010'>I'm</span>
  <span m='1682120'>just</span> <span m='1682270'>going</span> <span m='1682420'>to</span>
  <span m='1682510'>do</span> <span m='1682810'>at</span> <span m='1682900'>the</span>
  <span m='1682990'>beginning.</span> <span m='1683950'>It's</span> <span m='1684130'>like</span>
  <span m='1684340'>regular</span> <span m='1684790'>operations.</span> <span m='1686020'>And</span>
  <span m='1686140'>now</span> <span m='1686590'>I'm</span> <span m='1686710'>going</span>
  <span m='1686890'>to</span> <span m='1686950'>do</span> <span m='1687460'>things</span>
  <span m='1687850'>like</span> <span m='1689740'>insert</span> <span m='1691240'>at</span>
  <span m='1691480'>time</span> <span m='1691820'>0</span> <span m='1693250'>that</span>
  <span m='1694060'>X</span> <span m='1694480'>equals</span> <span m='1694870'>some</span>
  <span m='1695080'>value.</span> <span m='1697490'>I'm</span> <span m='1697510'>just</span>
  <span m='1697660'>going</span> <span m='1697780'>to</span> <span m='1697840'>keep--</span>
  <span m='1698560'>first</span> <span m='1698860'>I'll</span> <span m='1698920'>put</span>
  <span m='1699070'>it</span> <span m='1699130'>here,</span> <span m='1699520'>then</span>
  <span m='1699760'>right</span> <span m='1699940'>after,</span> <span m='1700300'>then</span>
  <span m='1700480'>right</span> <span m='1700630'>after--</span> <span m='1701310'>keep</span>
  <span m='1701500'>doing</span> <span m='1701740'>those</span> <span m='1701920'>insertions.</span>
  <span m='1702580'>I</span> <span m='1702670'>completely</span> <span m='1703120'>change</span>
  <span m='1703450'>what</span> <span m='1703570'>X</span> <span m='1703920'>is.</span>
  <span m='1704740'>And</span> <span m='1704830'>so</span> <span m='1704950'>I</span>
  <span m='1705210'>change</span> <span m='1705670'>where</span> <span m='1705930'>I'm</span>
  <span m='1706060'>evaluating</span> <span m='1706630'>this</span> <span m='1706780'>polynomial.</span>
  </p><p><span m='1708310'>And</span> <span m='1709210'>claim</span> <span m='1709540'>is</span>
  <span m='1709720'>you</span> <span m='1710080'>really</span> <span m='1710380'>can't</span>
  <span m='1710650'>do</span> <span m='1710770'>that</span> <span m='1710950'>any</span>
  <span m='1711100'>faster</span> <span m='1711430'>than</span> <span m='1711580'>reevaluating</span>
  <span m='1712240'>the</span> <span m='1712330'>polynomial.</span> <span m='1713740'>In</span>
  <span m='1716530'>a</span> <span m='1716780'>history</span> <span m='1717460'>independent</span>
  <span m='1722920'>algebraic</span> <span m='1723460'>decision</span> <span m='1723850'>tree</span>
  <span m='1724030'>model--</span> <span m='1725630'>which</span> <span m='1726040'>I</span>
  <span m='1726130'>don't</span> <span m='1726370'>want</span> <span m='1726550'>to</span>
  <span m='1726640'>define</span> <span m='1727120'>precisely,</span> <span m='1729090'>but</span>
  <span m='1731590'>maybe</span> <span m='1731830'>computation</span> <span m='1732510'>tree</span>
  <span m='1732730'>would</span> <span m='1732880'>be</span> <span m='1733030'>better.</span>
  </p><p><span m='1733720'>Anyway,</span> <span m='1734620'>this</span> <span m='1734890'>is</span>
  <span m='1735040'>just</span> <span m='1735940'>you</span> <span m='1736150'>draw</span>
  <span m='1736480'>a</span> <span m='1736510'>tree</span> <span m='1736780'>of</span>
  <span m='1736900'>all</span> <span m='1737050'>the</span> <span m='1737170'>possible</span>
  <span m='1737530'>things</span> <span m='1737740'>you</span> <span m='1737860'>could</span>
  <span m='1737980'>do.</span> <span m='1739400'>And</span> <span m='1739510'>the</span>
  <span m='1739600'>things</span> <span m='1739840'>you</span> <span m='1739930'>can</span>
  <span m='1740080'>do</span> <span m='1740500'>are</span> <span m='1741370'>additions,</span>
  <span m='1742000'>multiplications,</span> <span m='1742750'>subtractions,</span>
  <span m='1743530'>divisions,</span> <span m='1744520'>all</span> <span m='1744700'>field</span>
  <span m='1745030'>operations.</span> <span m='1747690'>So</span> <span m='1747850'>for</span>
  <span m='1748210'>any</span> <span m='1748540'>field,</span> <span m='1750580'>this</span>
  <span m='1750880'>would</span> <span m='1751030'>work</span> <span m='1751210'>with</span>
  <span m='1751360'>reals,</span> <span m='1752570'>would</span> <span m='1752710'>also,</span>
  <span m='1753550'>should</span> <span m='1753790'>work</span> <span m='1754000'>for</span>
  <span m='1754780'>integers</span> <span m='1755230'>module</span> <span m='1755680'>LP.</span>
  <span m='1757990'>Any</span> <span m='1758260'>fields.</span> <span m='1760690'>And</span>
  <span m='1760840'>the</span> <span m='1760960'>interesting</span> <span m='1761350'>part</span>
  <span m='1761710'>is</span> <span m='1761980'>independent</span> <span m='1763780'>of</span>
  <span m='1765100'>preprocessing</span> <span m='1765910'>of</span> <span m='1766000'>the</span>
  <span m='1766120'>coefficients,</span> <span m='1767350'>you</span> <span m='1767440'>can</span>
  <span m='1767590'>stare</span> <span m='1767830'>at</span> <span m='1767920'>those</span>
  <span m='1768490'>coefficients</span> <span m='1769090'>however</span> <span m='1769510'>long</span>
  <span m='1769780'>you</span> <span m='1769900'>like.</span> <span m='1771040'>In</span>
  <span m='1771190'>the</span> <span m='1771310'>worst</span> <span m='1771550'>case,</span>
  <span m='1772700'>you</span> <span m='1772750'>need</span> <span m='1776002'>mega</span>
  <span m='1776460'>n</span> <span m='1778720'>field</span> <span m='1779110'>operations,</span>
  <span m='1780190'>where</span> <span m='1780570'>n</span> <span m='1780780'>is</span>
  <span m='1780940'>the</span> <span m='1781060'>degree</span> <span m='1781330'>of</span>
  <span m='1781390'>the</span> <span m='1781450'>polynomial.</span> </p><p><span m='1783380'>So</span>
  <span m='1783460'>this</span> <span m='1783640'>is</span> <span m='1783760'>a</span>
  <span m='1783850'>known</span> <span m='1784090'>result</span> <span m='1784570'>from</span>
  <span m='1784750'>2001.</span> <span m='1786220'>And</span> <span m='1786370'>so</span>
  <span m='1786490'>it</span> <span m='1786550'>tells</span> <span m='1786880'>you</span>
  <span m='1787030'>that</span> <span m='1787900'>each</span> <span m='1788080'>of</span>
  <span m='1788140'>these</span> <span m='1788290'>retroactive</span> <span m='1788830'>operations,</span>
  <span m='1789780'>it's</span> <span m='1790020'>n</span> <span m='1790200'>time</span>
  <span m='1790460'>units</span> <span m='1790690'>in</span> <span m='1790780'>the</span>
  <span m='1790840'>past.</span> <span m='1791380'>And</span> <span m='1791530'>you</span>
  <span m='1791620'>need</span> <span m='1791860'>order</span> <span m='1792130'>n</span>
  <span m='1792310'>time</span> <span m='1793060'>to</span> <span m='1793150'>complete</span>
  <span m='1793510'>it.</span> <span m='1793600'>Even</span> <span m='1793900'>though</span>
  <span m='1794440'>these</span> <span m='1794590'>operations</span> <span m='1795280'>can</span>
  <span m='1795430'>be</span> <span m='1795550'>solved</span> <span m='1795880'>in</span>
  <span m='1795970'>constant</span> <span m='1796390'>time</span> <span m='1796660'>each.</span>
  <span m='1798130'>So</span> <span m='1798370'>it's</span> <span m='1798540'>a</span>
  <span m='1799050'>factor</span> <span m='1799500'>n</span> <span m='1800100'>loss.</span>
  </p><p><span m='1801360'>Now</span> <span m='1801480'>this</span> <span m='1801690'>is</span>
  <span m='1801780'>a</span> <span m='1801870'>particular</span> <span m='1802500'>model</span>
  <span m='1802800'>of</span> <span m='1802890'>computation.</span> <span m='1804300'>It</span>
  <span m='1804420'>implies</span> <span m='1805020'>something</span> <span m='1805380'>like</span>
  <span m='1805650'>an</span> <span m='1805770'>integer</span> <span m='1806240'>or</span>
  <span m='1806260'>a</span> <span m='1806310'>random</span> <span m='1806610'>access</span>
  <span m='1806970'>machine,</span> <span m='1807390'>where</span> <span m='1807510'>you</span>
  <span m='1808370'>can</span> <span m='1808500'>have</span> <span m='1808650'>arrays,</span>
  <span m='1809280'>I</span> <span m='1809340'>don't</span> <span m='1809460'>really</span>
  <span m='1809700'>care.</span> <span m='1810120'>But</span> <span m='1810450'>as</span>
  <span m='1810570'>long</span> <span m='1810780'>as</span> <span m='1811050'>the</span>
  <span m='1811440'>way</span> <span m='1811680'>that</span> <span m='1811830'>you're</span>
  <span m='1811920'>manipulating</span> <span m='1812490'>these</span> <span m='1812790'>objects</span>
  <span m='1813360'>are</span> <span m='1813540'>with</span> <span m='1813660'>field</span>
  <span m='1813930'>operations,</span> <span m='1814950'>you're</span> <span m='1815100'>in</span>
  <span m='1815220'>trouble.</span> </p><p><span m='1817470'>OK,</span> <span m='1817680'>but</span>
  <span m='1817890'>there</span> <span m='1818070'>are</span> <span m='1818370'>conceivably</span>
  <span m='1819120'>other</span> <span m='1819300'>things</span> <span m='1819510'>you</span>
  <span m='1819630'>could</span> <span m='1819720'>do.</span> <span m='1823170'>If</span>
  <span m='1823260'>these</span> <span m='1823470'>numbers</span> <span m='1823920'>are</span>
  <span m='1824040'>integers</span> <span m='1824670'>maybe</span> <span m='1824880'>I</span>
  <span m='1824940'>could</span> <span m='1825060'>split</span> <span m='1825420'>their</span>
  <span m='1825570'>bits</span> <span m='1825930'>into</span> <span m='1826170'>parts</span>
  <span m='1826800'>and</span> <span m='1827370'>do</span> <span m='1827520'>crazy</span>
  <span m='1827880'>things</span> <span m='1828120'>with</span> <span m='1828240'>them.</span>
  <span m='1828480'>That's</span> <span m='1828660'>something</span> <span m='1828960'>we'll</span>
  <span m='1829080'>get</span> <span m='1829230'>to</span> <span m='1829470'>later</span>
  <span m='1829740'>on</span> <span m='1829870'>in</span> <span m='1829920'>the</span>
  <span m='1830010'>class.</span> <span m='1833970'>Even</span> <span m='1834330'>then,</span>
  <span m='1834820'>you</span> <span m='1835110'>can't</span> <span m='1835350'>do</span>
  <span m='1835470'>so</span> <span m='1835680'>well.</span> <span m='1837654'>I</span>
  <span m='1838080'>guess</span> <span m='1838350'>I'll briefly</span> <span m='1840720'>tell</span>
  <span m='1840930'>you</span> <span m='1841050'>this</span> <span m='1841290'>because</span>
  <span m='1842190'>there's</span> <span m='1842310'>an</span> <span m='1842370'>interesting</span>
  <span m='1842730'>lower</span> <span m='1843000'>balance.</span> <span m='1843330'>Oh</span>
  <span m='1843660'>sorry,</span> <span m='1843900'>interesting</span> <span m='1844290'>open</span>
  <span m='1844530'>problem.</span> </p><p><span m='1855140'>Cell-probe</span> <span
  m='1856040'>model,</span> <span m='1856890'>something</span> <span m='1857280'>we'll</span>
  <span m='1857400'>get</span> <span m='1857640'>into</span> <span m='1858060'>in</span>
  <span m='1858150'>a</span> <span m='1858210'>deeper</span> <span m='1858510'>way</span>
  <span m='1858720'>later</span> <span m='1858990'>on</span> <span m='1859140'>in</span>
  <span m='1859200'>this</span> <span m='1859350'>class.</span> <span m='1859900'>But</span>
  <span m='1860820'>it</span> <span m='1860970'>just</span> <span m='1861180'>says</span>
  <span m='1861960'>how</span> <span m='1862200'>many</span> <span m='1863850'>objects,</span>
  <span m='1864550'>how</span> <span m='1864570'>many</span> <span m='1864780'>words</span>
  <span m='1865050'>of</span> <span m='1865170'>memory</span> <span m='1865500'>do</span>
  <span m='1865590'>you</span> <span m='1865710'>need</span> <span m='1865890'>to</span>
  <span m='1866040'>read</span> <span m='1866400'>in</span> <span m='1866520'>order</span>
  <span m='1866670'>to</span> <span m='1866820'>solve</span> <span m='1867120'>your</span>
  <span m='1867240'>problem?</span> <span m='1868660'>So</span> <span m='1868980'>that's</span>
  <span m='1869160'>a</span> <span m='1869220'>lower</span> <span m='1869520'>bound</span>
  <span m='1869730'>on</span> <span m='1869850'>time.</span> <span m='1870930'>No</span>
  <span m='1871080'>matter</span> <span m='1871380'>how</span> <span m='1871740'>you're</span>
  <span m='1871890'>computing</span> <span m='1872310'>with</span> <span m='1872460'>those</span>
  <span m='1872640'>numbers,</span> <span m='1873420'>how</span> <span m='1873600'>many</span>
  <span m='1873840'>of</span> <span m='1873960'>the</span> <span m='1874470'>objects,</span>
  <span m='1874950'>how</span> <span m='1875040'>many</span> <span m='1875260'>of</span>
  <span m='1875300'>the</span> <span m='1875370'>integers</span> <span m='1875790'>do</span>
  <span m='1875850'>you</span> <span m='1875940'>need</span> <span m='1876120'>to</span>
  <span m='1876270'>read?</span> </p><p><span m='1877830'>Not</span> <span m='1878010'>necessarily</span>
  <span m='1878460'>just</span> <span m='1878610'>the</span> <span m='1878890'>ai's</span>
  <span m='1879180'>You</span> <span m='1879270'>could</span> <span m='1879420'>split</span>
  <span m='1879660'>them</span> <span m='1879810'>into</span> <span m='1879990'>parts,</span>
  <span m='1880350'>do</span> <span m='1880500'>all</span> <span m='1880620'>kinds</span>
  <span m='1880860'>of</span> <span m='1880980'>preprocessing,</span> <span m='1882420'>make</span>
  <span m='1882630'>a</span> <span m='1882690'>hash</span> <span m='1882960'>table,</span>
  <span m='1883800'>build</span> <span m='1883980'>whatever</span> <span m='1884310'>data</span>
  <span m='1884490'>structure</span> <span m='1884820'>you</span> <span m='1884880'>want.</span>
  <span m='1885120'>How</span> <span m='1885450'>many</span> <span m='1885720'>words</span>
  <span m='1886110'>of</span> <span m='1886200'>that</span> <span m='1886710'>data</span>
  <span m='1886920'>structure</span> <span m='1887280'>do</span> <span m='1887370'>you</span>
  <span m='1887490'>need</span> <span m='1887640'>to</span> <span m='1887790'>read?</span>
  <span m='1889050'>And</span> <span m='1889380'>the</span> <span m='1889470'>claim</span>
  <span m='1889800'>is</span> <span m='1891210'>at</span> <span m='1891330'>least</span>
  <span m='1892320'>square</span> <span m='1892770'>root</span> <span m='1892950'>of</span>
  <span m='1893070'>r</span> <span m='1893340'>divided</span> <span m='1893670'>by</span>
  <span m='1893850'>log r.</span> <span m='1895990'>So</span> <span m='1896790'>roughly</span>
  <span m='1897120'>square root</span> <span m='1897360'>of</span> <span m='1897510'>r,</span>
  <span m='1898170'>open</span> <span m='1898440'>problem,</span> <span m='1899490'>is</span>
  <span m='1899770'>can</span> <span m='1900000'>you</span> <span m='1900120'>get</span>
  <span m='1900840'>something</span> <span m='1901230'>like</span> <span m='1901470'>r
  again</span> <span m='1902580'>in</span> <span m='1902700'>this</span> <span m='1903600'>model?</span>
  </p><p><span m='1904030'>So</span> <span m='1904050'>this</span> <span m='1904200'>is</span>
  <span m='1904260'>a</span> <span m='1904320'>very</span> <span m='1904590'>powerful</span>
  <span m='1904980'>model,</span> <span m='1906060'>not</span> <span m='1906300'>at</span>
  <span m='1906360'>all</span> <span m='1906480'>realistic.</span> <span m='1907500'>But</span>
  <span m='1907710'>if</span> <span m='1907800'>you</span> <span m='1907860'>can</span>
  <span m='1907980'>prove</span> <span m='1908160'>a</span> <span m='1908190'>lower</span>
  <span m='1908430'>bound</span> <span m='1908640'>in</span> <span m='1908730'>this</span>
  <span m='1908880'>model,</span> <span m='1909210'>then</span> <span m='1909360'>it</span>
  <span m='1909540'>holds</span> <span m='1909840'>basically</span> <span m='1910200'>all</span>
  <span m='1910380'>models</span> <span m='1911295'>you</span> <span m='1911730'>could</span>
  <span m='1911940'>ever</span> <span m='1912120'>think</span> <span m='1912360'>of.</span>
  </p><p><span m='1913530'>So</span> <span m='1913680'>here's</span> <span m='1913920'>a</span>
  <span m='1914310'>data</span> <span m='1914610'>structure--</span> <span m='1915090'>or</span>
  <span m='1915300'>here's</span> <span m='1915570'>the</span> <span m='1916560'>proof</span>
  <span m='1916890'>of</span> <span m='1917010'>this</span> <span m='1917190'>lower</span>
  <span m='1917430'>bound.</span> <span m='1921420'>Data</span> <span m='1921660'>structure</span>
  <span m='1922020'>maintains</span> <span m='1922560'>n</span> <span m='1923460'>words.</span>
  <span m='1926460'>I</span> <span m='1926610'>should</span> <span m='1926760'>say</span>
  <span m='1926940'>typically</span> <span m='1927390'>in</span> <span m='1927480'>this</span>
  <span m='1927600'>class,</span> <span m='1927900'>a</span> <span m='1927960'>word</span>
  <span m='1928800'>is</span> <span m='1928920'>an</span> <span m='1929040'>integer</span>
  <span m='1930580'>of</span> <span m='1931020'>let's</span> <span m='1931200'>say</span>
  <span m='1932310'>log</span> <span m='1933000'>n--</span> <span m='1934460'>I'll</span>
  <span m='1934950'>be</span> <span m='1935100'>more</span> <span m='1935280'>precise.</span>
  <span m='1935790'>w</span> <span m='1936240'>bits.</span> <span m='1937650'>w</span>
  <span m='1938010'>is</span> <span m='1938130'>at</span> <span m='1938220'>least</span>
  <span m='1938400'>log</span> <span m='1938700'>n.</span> <span m='1941580'>We'll</span>
  <span m='1941730'>talk</span> <span m='1941910'>about</span> <span m='1942120'>this</span>
  <span m='1942390'>a</span> <span m='1942450'>lot</span> <span m='1942600'>more</span>
  <span m='1942810'>later</span> <span m='1943170'>in</span> <span m='1943290'>the</span>
  <span m='1943380'>class</span> <span m='1943640'>when</span> <span m='1943730'>we</span>
  <span m='1943800'>get</span> <span m='1943920'>to</span> <span m='1944100'>integer</span>
  <span m='1944370'>data</span> <span m='1944580'>structures.</span> <span m='1946390'>But</span>
  <span m='1946440'>if</span> <span m='1946530'>you</span> <span m='1946710'>were</span>
  <span m='1946830'>wondering</span> <span m='1947130'>what</span> <span m='1947250'>a</span>
  <span m='1947280'>word</span> <span m='1947520'>means,</span> <span m='1949300'>there</span>
  <span m='1949600'>it is.</span> </p><p><span m='1950850'>And</span> <span m='1951120'>the</span>
  <span m='1951240'>operations,</span> <span m='1952970'>the</span> <span m='1953100'>updates</span>
  <span m='1953420'>you</span> <span m='1953500'>are</span> <span m='1953520'>allowed</span>
  <span m='1953760'>to</span> <span m='1953850'>do</span> <span m='1954240'>are</span>
  <span m='1954420'>arithmetic</span> <span m='1954990'>operations.</span> <span m='1957520'>So</span>
  <span m='1958680'>it's</span> <span m='1958920'>generalization</span> <span m='1959760'>of</span>
  <span m='1959880'>this</span> <span m='1960030'>problem.</span> <span m='1960450'>You</span>
  <span m='1960570'>can</span> <span m='1960690'>do</span> <span m='1960900'>addition,</span>
  <span m='1961260'>multiplication,</span> <span m='1962010'>division,</span> <span
  m='1963540'>just</span> <span m='1963720'>basic</span> <span m='1964080'>stuff.</span>
  <span m='1966720'>So</span> <span m='1966900'>that's</span> <span m='1967140'>the</span>
  <span m='1967200'>data</span> <span m='1967410'>structure</span> <span m='1967740'>we're</span>
  <span m='1967860'>trying</span> <span m='1968100'>to</span> <span m='1968190'>do.</span>
  <span m='1968340'>And</span> <span m='1968430'>at</span> <span m='1968520'>the</span>
  <span m='1968640'>end</span> <span m='1968790'>you</span> <span m='1968880'>can</span>
  <span m='1969000'>query</span> <span m='1969330'>what</span> <span m='1969510'>is</span>
  <span m='1969660'>the</span> <span m='1969750'>value</span> <span m='1970020'>of</span>
  <span m='1970110'>this</span> <span m='1970260'>word.</span> </p><p><span m='1972420'>And</span>
  <span m='1973920'>now</span> <span m='1974160'>what</span> <span m='1974310'>are</span>
  <span m='1974370'>we</span> <span m='1974490'>going</span> <span m='1974700'>to</span>
  <span m='1974790'>do?</span> <span m='1974910'>Before</span> <span m='1975210'>we</span>
  <span m='1975300'>did</span> <span m='1975450'>polynomial</span> <span m='1976050'>evaluation</span>
  <span m='1976860'>in</span> <span m='1977040'>that</span> <span m='1977190'>model.</span>
  <span m='1977850'>Now</span> <span m='1978510'>what</span> <span m='1978690'>I'm</span>
  <span m='1978750'>going</span> <span m='1978930'>to</span> <span m='1979020'>do</span>
  <span m='1979170'>is</span> <span m='1979320'>compute</span> <span m='1979850'>FFT,</span>
  <span m='1981420'>fast</span> <span m='1981660'>Fourier</span> <span m='1981930'>transform.</span>
  <span m='1983710'>If</span> <span m='1984020'>you</span> <span m='1984090'>know</span>
  <span m='1984210'>how</span> <span m='1984270'>to</span> <span m='1984390'>do</span>
  <span m='1984510'>that</span> <span m='1984660'>great.</span> <span m='1985180'>If</span>
  <span m='1985280'>not,</span> <span m='1985900'>it's</span> <span m='1986160'>an</span>
  <span m='1986280'>n log</span> <span m='1986740'>n algorithm.</span> <span m='1987510'>So</span>
  <span m='1987630'>it's</span> <span m='1987720'>an</span> <span m='1987780'>n log</span>
  <span m='1988170'>in</span> <span m='1988330'>operations</span> <span m='1988950'>you</span>
  <span m='1989040'>do.</span> <span m='1989280'>I'm</span> <span m='1989340'>just</span>
  <span m='1989490'>going</span> <span m='1989610'>to</span> <span m='1989700'>write</span>
  <span m='1989940'>them</span> <span m='1990090'>down</span> <span m='1990450'>as</span>
  <span m='1990600'>my</span> <span m='1990720'>sequence</span> <span m='1991080'>of</span>
  <span m='1991170'>updates.</span> <span m='1992200'>At</span> <span m='1992300'>the</span>
  <span m='1992420'>end</span> <span m='1992640'>I</span> <span m='1992700'>have</span>
  <span m='1992850'>the</span> <span m='1992940'>fast</span> <span m='1993180'>Fourier</span>
  <span m='1993470'>transform.</span> </p><p><span m='1995340'>And</span> <span m='1996870'>the</span>
  <span m='1996960'>retroactive</span> <span m='1997560'>thing</span> <span m='1997740'>I'm</span>
  <span m='1997830'>going</span> <span m='1998010'>to</span> <span m='1998130'>do</span>
  <span m='1998280'>is</span> <span m='1998460'>set</span> <span m='1998880'>all</span>
  <span m='1999120'>of</span> <span m='1999210'>these</span> <span m='1999390'>words,</span>
  <span m='1999900'>all</span> <span m='2000080'>the</span> <span m='2000200'>xi's,</span>
  <span m='2001220'>and</span> <span m='2001550'>name</span> <span m='2001820'>them.</span>
  <span m='2003230'>Which</span> <span m='2003500'>changes</span> <span m='2004010'>the</span>
  <span m='2004130'>input</span> <span m='2004460'>to</span> <span m='2004550'>the</span>
  <span m='2004640'>fast</span> <span m='2004880'>Fourier</span> <span m='2005150'>transform.</span>
  <span m='2005780'>And</span> <span m='2005900'>it</span> <span m='2005990'>turns</span>
  <span m='2006260'>out</span> <span m='2006890'>that</span> <span m='2007070'>dynamic</span>
  <span m='2008640'>fast</span> <span m='2008780'>Fourier</span> <span m='2009080'>transform,</span>
  <span m='2012200'>where</span> <span m='2013460'>changing</span> <span m='2016790'>one</span>
  <span m='2017090'>of</span> <span m='2017210'>the</span> <span m='2017330'>words,</span>
  <span m='2018390'>xi,</span> <span m='2019900'>you</span> <span m='2020330'>can</span>
  <span m='2020540'>show,</span> <span m='2021440'>or</span> <span m='2021740'>it</span>
  <span m='2021800'>has</span> <span m='2022070'>been</span> <span m='2022220'>shown--</span>
  <span m='2023360'>we're</span> <span m='2023600'>not</span> <span m='2023720'>going</span>
  <span m='2023840'>to</span> <span m='2023900'>prove</span> <span m='2024110'>this</span>
  <span m='2024320'>here--</span> <span m='2025190'>requires</span> <span m='2026330'>at</span>
  <span m='2026450'>least</span> <span m='2026600'>square root</span> <span m='2027070'>of</span>
  <span m='2027200'>n</span> <span m='2028610'>cell-probes.</span> </p><p><span m='2032540'>So</span>
  <span m='2032720'>this</span> <span m='2032930'>is</span> <span m='2033080'>about--</span>
  <span m='2033680'>if</span> <span m='2034070'>you</span> <span m='2034160'>change</span>
  <span m='2034490'>one</span> <span m='2034760'>thing</span> <span m='2034940'>in</span>
  <span m='2035000'>a</span> <span m='2035060'>fast</span> <span m='2035240'>Fourier</span>
  <span m='2035450'>transform,</span> <span m='2035840'>it</span> <span m='2035900'>doesn't</span>
  <span m='2036110'>change</span> <span m='2036500'>everything,</span> <span m='2037340'>necessarily.</span>
  <span m='2038630'>But</span> <span m='2039330'>the</span> <span m='2039710'>claim</span>
  <span m='2039950'>is</span> <span m='2040100'>that</span> <span m='2040550'>you</span>
  <span m='2040730'>need</span> <span m='2040940'>to</span> <span m='2041090'>look</span>
  <span m='2041330'>at</span> <span m='2041480'>least</span> <span m='2041690'>root
  n</span> <span m='2042020'>of</span> <span m='2042110'>the</span> <span m='2042200'>things</span>
  <span m='2042470'>again,</span> <span m='2043220'>in</span> <span m='2043340'>order</span>
  <span m='2043490'>to</span> <span m='2043670'>figure</span> <span m='2043940'>out</span>
  <span m='2044060'>what</span> <span m='2044210'>happened,</span> <span m='2044810'>how</span>
  <span m='2044990'>the</span> <span m='2045140'>FFT</span> <span m='2045470'>changed.</span>
  <span m='2046820'>So</span> <span m='2046970'>I</span> <span m='2047030'>mention</span>
  <span m='2047360'>this</span> <span m='2047750'>mostly</span> <span m='2048290'>as</span>
  <span m='2048560'>an</span> <span m='2048679'>interesting</span> <span m='2049250'>question</span>
  <span m='2049610'>of</span> <span m='2049690'>whether</span> <span m='2049850'>you</span>
  <span m='2049969'>can</span> <span m='2050090'>come</span> <span m='2050300'>up</span>
  <span m='2050480'>with</span> <span m='2050659'>a</span> <span m='2051320'>better</span>
  <span m='2051679'>lower</span> <span m='2051949'>bound</span> <span m='2052310'>in</span>
  <span m='2052520'>this</span> <span m='2053130'>data</span> <span m='2053389'>structure.</span>
  <span m='2053750'>Ideally</span> <span m='2054080'>taking</span> <span m='2054469'>some</span>
  <span m='2054679'>existing</span> <span m='2055100'>lower</span> <span m='2055310'>bound,</span>
  <span m='2056030'>plugging</span> <span m='2056480'>it</span> <span m='2056570'>in</span>
  <span m='2057850'>to</span> <span m='2058040'>this</span> <span m='2058280'>kind</span>
  <span m='2058489'>of</span> <span m='2058550'>retroactive</span> <span m='2059090'>framework,</span>
  <span m='2060469'>and</span> <span m='2064219'>getting</span> <span m='2064460'>what</span>
  <span m='2064550'>you</span> <span m='2064639'>want.</span> </p><p><span m='2065739'>Enough</span>
  <span m='2066290'>about</span> <span m='2066530'>the</span> <span m='2066620'>bad</span>
  <span m='2066830'>news.</span> <span m='2067310'>I</span> <span m='2067400'>want</span>
  <span m='2067550'>to</span> <span m='2067639'>go</span> <span m='2067909'>to</span>
  <span m='2068449'>positive</span> <span m='2068900'>results</span> <span m='2069650'>again.</span>
  <span m='2071040'>So</span> <span m='2071090'>we</span> <span m='2071179'>had</span>
  <span m='2071300'>a</span> <span m='2071360'>very</span> <span m='2071630'>simple</span>
  <span m='2071960'>thing</span> <span m='2072620'>here.</span> <span m='2073590'>Let's</span>
  <span m='2073790'>try</span> <span m='2074120'>something</span> <span m='2074540'>that's</span>
  <span m='2074690'>somewhere</span> <span m='2075020'>in</span> <span m='2075080'>between,</span>
  <span m='2076040'>where</span> <span m='2076460'>there</span> <span m='2076670'>are</span>
  <span m='2076730'>chain</span> <span m='2077030'>reactions,</span> <span m='2078980'>but</span>
  <span m='2079219'>it's</span> <span m='2079370'>not</span> <span m='2079550'>impossible.</span>
  <span m='2080880'>So</span> <span m='2080929'>in</span> <span m='2081020'>general,</span>
  <span m='2081480'>if</span> <span m='2081530'>you're</span> <span m='2081650'>building--</span>
  <span m='2082070'>if you</span> <span m='2082489'>have a</span> <span m='2082550'>data
  structure</span> <span m='2082880'>that represents</span> <span m='2083389'>an</span>
  <span m='2083449'>arbitrary</span> <span m='2083840'>computer,</span> <span m='2084739'>you're</span>
  <span m='2084860'>basically</span> <span m='2085370'>hosed.</span> <span m='2086600'>If</span>
  <span m='2086780'>you</span> <span m='2086929'>have</span> <span m='2087139'>a</span>
  <span m='2087199'>data</span> <span m='2087409'>structure</span> <span m='2087770'>where</span>
  <span m='2088010'>the</span> <span m='2088310'>operations</span> <span m='2088820'>can</span>
  <span m='2088969'>be</span> <span m='2089150'>arbitrarily</span> <span m='2089630'>reordered,</span>
  <span m='2090679'>pretty</span> <span m='2090949'>easy.</span> <span m='2091699'>So</span>
  <span m='2092210'>our</span> <span m='2092480'>intermediate</span> <span m='2093469'>setting</span>
  <span m='2093949'>will</span> <span m='2094100'>be</span> <span m='2097610'>priority</span>
  <span m='2098180'>queues,</span> <span m='2099440'>the</span> <span m='2099510'>example</span>
  <span m='2099920'>I</span> <span m='2100040'>showed</span> <span m='2100250'>at</span>
  <span m='2100340'>the</span> <span m='2100430'>very</span> <span m='2100640'>beginning.</span>
  </p><p><span m='2110250'>So on</span> <span m='2110480'>a</span> <span m='2110540'>priority</span>
  <span m='2110940'>queue,</span> <span m='2111470'>I'm</span> <span m='2111620'>going</span>
  <span m='2111920'>to</span> <span m='2112220'>think</span> <span m='2112430'>about</span>
  <span m='2112700'>two</span> <span m='2112940'>operations,</span> <span m='2113660'>insert</span>
  <span m='2114680'>and</span> <span m='2114830'>delete-min.</span> <span m='2119240'>This</span>
  <span m='2119450'>is</span> <span m='2119540'>interesting</span> <span m='2120140'>because</span>
  <span m='2121270'>delete-min</span> <span m='2121940'>depends</span> <span m='2122480'>on</span>
  <span m='2122780'>what</span> <span m='2123200'>the</span> <span m='2123320'>current</span>
  <span m='2123560'>state</span> <span m='2123850'>is.</span> <span m='2125750'>So</span>
  <span m='2126170'>if</span> <span m='2126410'>I</span> <span m='2126650'>insert</span>
  <span m='2126940'>something</span> <span m='2127310'>early</span> <span m='2127580'>on,</span>
  <span m='2127760'>it</span> <span m='2127810'>can</span> <span m='2127970'>change</span>
  <span m='2128450'>every</span> <span m='2128720'>delete-min</span> <span m='2129200'>that</span>
  <span m='2129320'>happens</span> <span m='2129800'>thereafter,</span> <span m='2130730'>and</span>
  <span m='2130850'>completely</span> <span m='2131510'>change</span> <span m='2132380'>what</span>
  <span m='2132560'>happens</span> <span m='2132890'>at</span> <span m='2132980'>the</span>
  <span m='2133130'>end</span> <span m='2133760'>of</span> <span m='2133880'>the</span>
  <span m='2133940'>data</span> <span m='2134120'>structure.</span> </p><p><span m='2136820'>So</span>
  <span m='2137030'>the</span> <span m='2137090'>claim</span> <span m='2137360'>is</span>
  <span m='2137510'>we</span> <span m='2137630'>can</span> <span m='2137750'>solve</span>
  <span m='2138020'>this</span> <span m='2138350'>with</span> <span m='2139890'>log</span>
  <span m='2140320'>n</span> <span m='2140690'>time</span> <span m='2140990'>per</span>
  <span m='2142250'>operation,</span> <span m='2143510'>per</span> <span m='2145340'>partially</span>
  <span m='2146030'>retroactive</span> <span m='2146720'>operation.</span> <span m='2151710'>It's</span>
  <span m='2152010'>pretty</span> <span m='2152220'>good</span> <span m='2152460'>because</span>
  <span m='2153470'>in</span> <span m='2153660'>this</span> <span m='2153840'>model,</span>
  <span m='2155370'>which--</span> <span m='2157125'>what</span> <span m='2157470'>model</span>
  <span m='2157800'>are</span> <span m='2157860'>we</span> <span m='2158040'>in</span>
  <span m='2158250'>here?</span> <span m='2158910'>I</span> <span m='2159000'>guess</span>
  <span m='2159210'>pointer</span> <span m='2159510'>machine</span> <span m='2160455'>would
  be a</span> <span m='2160950'>reasonable</span> <span m='2161370'>model?</span>
  <span m='2162430'>Log</span> <span m='2162710'>n</span> <span m='2162990'>is</span>
  <span m='2163230'>the</span> <span m='2163530'>best</span> <span m='2163830'>you</span>
  <span m='2163920'>can</span> <span m='2164040'>hope</span> <span m='2164160'>for</span>
  <span m='2164520'>a</span> <span m='2164580'>priority</span> <span m='2164990'>queue.</span>
  <span m='2165540'>I</span> <span m='2165630'>guess</span> <span m='2165780'>comparison</span>
  <span m='2166260'>model</span> <span m='2167040'>is</span> <span m='2167580'>more</span>
  <span m='2167730'>relevant</span> <span m='2168090'>then.</span> </p><p><span m='2168560'>So</span>
  <span m='2168730'>you</span> <span m='2168870'>can</span> <span m='2168960'>use</span>
  <span m='2169080'>priority</span> <span m='2169440'>queues</span> <span m='2169650'>to</span>
  <span m='2169770'>sort.</span> <span m='2170290'>So</span> <span m='2170460'>log</span>
  <span m='2170730'>n</span> <span m='2170800'>is</span> <span m='2170910'>the</span>
  <span m='2170980'>best</span> <span m='2171180'>you</span> <span m='2171240'>can</span>
  <span m='2171360'>do</span> <span m='2171450'>for</span> <span m='2171600'>regular</span>
  <span m='2171990'>priority</span> <span m='2172380'>queues.</span> <span m='2173340'>And</span>
  <span m='2173460'>so</span> <span m='2174680'>to</span> <span m='2174840'>do</span>
  <span m='2174960'>it</span> <span m='2175020'>also</span> <span m='2175440'>partially</span>
  <span m='2175830'>retroactive</span> <span m='2176460'>is</span> <span m='2176580'>pretty</span>
  <span m='2176790'>interesting.</span> </p><p><span m='2179460'>How</span> <span
  m='2179610'>do</span> <span m='2179730'>we</span> <span m='2179850'>do</span> <span
  m='2179970'>this?</span> <span m='2182260'>Well,</span> <span m='2182940'>I</span>
  <span m='2183080'>don't</span> <span m='2183150'>want</span> <span m='2183300'>to</span>
  <span m='2183360'>draw</span> <span m='2183600'>a</span> <span m='2183630'>picture</span>
  <span m='2184560'>of</span> <span m='2184950'>what</span> <span m='2185190'>these</span>
  <span m='2185490'>data</span> <span m='2185730'>structures</span> <span m='2186120'>look</span>
  <span m='2186300'>like.</span> <span m='2193230'>My</span> <span m='2193380'>picture</span>
  <span m='2193770'>is</span> <span m='2195240'>keyspace</span> <span m='2195960'>is</span>
  <span m='2196050'>going</span> <span m='2196200'>to</span> <span m='2196290'>be</span>
  <span m='2196470'>the</span> <span m='2196620'>y-axis,</span> <span m='2198630'>and</span>
  <span m='2198780'>time</span> <span m='2200070'>is</span> <span m='2200340'>the</span>
  <span m='2200490'>x-axis.</span> <span m='2203410'>So</span> <span m='2203510'>if</span>
  <span m='2203610'>someone</span> <span m='2203790'>comes</span> <span m='2204030'>along</span>
  <span m='2204330'>and</span> <span m='2204420'>does</span> <span m='2204570'>an</span>
  <span m='2204690'>insertion,</span> <span m='2205620'>they</span> <span m='2206070'>do</span>
  <span m='2206310'>the</span> <span m='2206430'>insertion</span> <span m='2206880'>at</span>
  <span m='2207090'>some</span> <span m='2207360'>time</span> <span m='2208230'>with</span>
  <span m='2208380'>some</span> <span m='2208680'>key</span> <span m='2208920'>value.</span>
  <span m='2210210'>And</span> <span m='2210360'>so</span> <span m='2210510'>I'm</span>
  <span m='2210570'>going</span> <span m='2210690'>to</span> <span m='2210750'>think</span>
  <span m='2210960'>of</span> <span m='2211050'>that</span> <span m='2211290'>as</span>
  <span m='2211500'>a</span> <span m='2211590'>rightward</span> <span m='2212010'>pointing</span>
  <span m='2212340'>ray,</span> <span m='2212490'>because</span> <span m='2212760'>at</span>
  <span m='2212850'>that</span> <span m='2213030'>point</span> <span m='2213300'>that</span>
  <span m='2213480'>element</span> <span m='2213900'>exists.</span> <span m='2215940'>And</span>
  <span m='2216090'>if</span> <span m='2216180'>nothing</span> <span m='2216450'>happens,</span>
  <span m='2216810'>it</span> <span m='2216900'>will</span> <span m='2217080'>exist</span>
  <span m='2217440'>for</span> <span m='2217620'>the</span> <span m='2217770'>end</span>
  <span m='2217920'>of</span> <span m='2218040'>time.</span> </p><p><span m='2219690'>The</span>
  <span m='2219900'>problem</span> <span m='2220350'>would</span> <span m='2220500'>be</span>
  <span m='2220740'>if</span> <span m='2220830'>someone</span> <span m='2221160'>comes</span>
  <span m='2221400'>along</span> <span m='2221730'>and</span> <span m='2221820'>does</span>
  <span m='2222030'>a</span> <span m='2222090'>delete-min.</span> <span m='2222790'>A</span>
  <span m='2223010'>delete-min</span> <span m='2224010'>is</span> <span m='2224160'>going</span>
  <span m='2224330'>to</span> <span m='2224400'>be</span> <span m='2225130'>a</span>
  <span m='2225440'>ray</span> <span m='2226740'>shooting</span> <span m='2227280'>up</span>
  <span m='2227490'>from</span> <span m='2227790'>infinity,</span> <span m='2228540'>because</span>
  <span m='2228720'>you</span> <span m='2228780'>always</span> <span m='2228960'>want</span>
  <span m='2229080'>to</span> <span m='2229140'>delete</span> <span m='2229410'>the</span>
  <span m='2229500'>smallest</span> <span m='2229920'>possible</span> <span m='2230310'>thing.</span>
  <span m='2230880'>So</span> <span m='2231030'>whatever</span> <span m='2231300'>this</span>
  <span m='2231480'>ray</span> <span m='2231690'>hits</span> <span m='2231900'>first,</span>
  <span m='2232590'>that</span> <span m='2232920'>is</span> <span m='2233100'>the</span>
  <span m='2233220'>thing</span> <span m='2233400'>that</span> <span m='2233490'>gets</span>
  <span m='2233700'>deleted.</span> </p><p><span m='2235440'>So</span> <span m='2235650'>I</span>
  <span m='2235710'>want</span> <span m='2235860'>to</span> <span m='2235920'>keep--</span>
  <span m='2236250'>I</span> <span m='2236370'>want</span> <span m='2236520'>to</span>
  <span m='2236580'>draw</span> <span m='2236820'>all</span> <span m='2237360'>those</span>
  <span m='2237630'>rays</span> <span m='2238080'>for</span> <span m='2238230'>the</span>
  <span m='2238320'>delete-mins.</span> <span m='2239530'>So</span> <span m='2239670'>this</span>
  <span m='2239880'>is</span> <span m='2240060'>a</span> <span m='2240390'>delete-min.</span>
  <span m='2244460'>And</span> <span m='2244590'>this</span> <span m='2244770'>is</span>
  <span m='2244890'>an</span> <span m='2245040'>insert.</span> <span m='2247410'>So</span>
  <span m='2247620'>I</span> <span m='2247680'>have</span> <span m='2247980'>rightward</span>
  <span m='2248430'>rays</span> <span m='2249000'>for</span> <span m='2249780'>insertions.</span>
  <span m='2250410'>They</span> <span m='2250530'>start</span> <span m='2250800'>at</span>
  <span m='2250860'>some</span> <span m='2251070'>point.</span> <span m='2251400'>And</span>
  <span m='2251520'>I</span> <span m='2251580'>have</span> <span m='2251820'>upward</span>
  <span m='2252660'>rays</span> <span m='2252940'>from</span> <span m='2253110'>infinity.</span>
  <span m='2254460'>In</span> <span m='2254640'>general,</span> <span m='2255190'>I'm</span>
  <span m='2255210'>going</span> <span m='2255360'>to</span> <span m='2255450'>get</span>
  <span m='2256320'>a</span> <span m='2256380'>bunch</span> <span m='2256680'>of</span>
  <span m='2256890'>L</span> <span m='2257130'>shapes.</span> <span m='2272010'>And</span>
  <span m='2272310'>the</span> <span m='2272460'>L's</span> <span m='2272730'>will</span>
  <span m='2272880'>be</span> <span m='2273120'>non</span> <span m='2273390'>crossing</span>
  <span m='2273990'>in</span> <span m='2274110'>a</span> <span m='2274170'>legitimate</span>
  <span m='2274740'>picture</span> <span m='2275400'>of</span> <span m='2275760'>an</span>
  <span m='2275880'>execution</span> <span m='2276450'>of</span> <span m='2276540'>the</span>
  <span m='2276690'>algorithm.</span> </p><p><span m='2278532'>AUDIENCE:</span> <span
  m='2278690'>The</span> <span m='2278848'>vertical</span> <span m='2279006'>stuff</span>
  <span m='2279480'>is when</span> <span m='2279954'>you're taking</span> <span m='2280428'>the
  min</span> <span m='2280902'>out?</span> </p><p><span m='2281380'>ERIK DEMAINE:</span>
  <span m='2281415'>Yeah</span> <span m='2281880'>the</span> <span m='2282000'>vertical</span>
  <span m='2282420'>lines</span> <span m='2282840'>are</span> <span m='2283140'>delete-mins.</span>
  <span m='2283830'>They're</span> <span m='2283980'>coming</span> <span m='2284310'>from</span>
  <span m='2284490'>below.</span> <span m='2285570'>They're</span> <span m='2285720'>taking</span>
  <span m='2286170'>whatever</span> <span m='2286530'>the</span> <span m='2286650'>smallest</span>
  <span m='2287100'>thing</span> <span m='2287310'>is</span> <span m='2287490'>that</span>
  <span m='2287640'>exists.</span> <span m='2287910'>So</span> <span m='2288180'>think</span>
  <span m='2288390'>about</span> <span m='2288690'>like</span> <span m='2288870'>this</span>
  <span m='2289080'>time</span> <span m='2289410'>right</span> <span m='2289590'>here.</span>
  <span m='2290760'>Right</span> <span m='2290940'>now</span> <span m='2291270'>these</span>
  <span m='2292320'>four</span> <span m='2292710'>elements</span> <span m='2293130'>are</span>
  <span m='2293220'>in</span> <span m='2293310'>the</span> <span m='2293400'>data</span>
  <span m='2293580'>structure.</span> <span m='2293980'>You</span> <span m='2294100'>do</span>
  <span m='2294250'>a</span> <span m='2294270'>delete-min,</span> <span m='2295320'>you</span>
  <span m='2295470'>delete</span> <span m='2295710'>the</span> <span m='2295770'>smallest</span>
  <span m='2296190'>one.</span> <span m='2296400'>So</span> <span m='2296550'>this</span>
  <span m='2296730'>guy</span> <span m='2296880'>dies.</span> <span m='2298150'>But</span>
  <span m='2298230'>the</span> <span m='2298320'>three</span> <span m='2298560'>others</span>
  <span m='2298830'>continue.</span> </p><p><span m='2299760'>Maybe</span> <span m='2299970'>there'll</span>
  <span m='2300120'>be</span> <span m='2300210'>some</span> <span m='2300480'>elements</span>
  <span m='2300870'>that</span> <span m='2301050'>just</span> <span m='2301320'>exist.</span>
  <span m='2302800'>They</span> <span m='2302820'>don't</span> <span m='2303030'>get</span>
  <span m='2303180'>deleted.</span> <span m='2304110'>So</span> <span m='2304430'>it's</span>
  <span m='2304560'>not</span> <span m='2304710'>entirely</span> <span m='2305220'>L's.</span>
  <span m='2305490'>That's</span> <span m='2305640'>sort</span> <span m='2305820'>of</span>
  <span m='2306010'>a</span> <span m='2306270'>half</span> <span m='2306570'>of</span>
  <span m='2306660'>an</span> <span m='2306750'>L.</span> <span m='2308250'>So you</span>
  <span m='2308370'>might</span> <span m='2308520'>have</span> <span m='2308670'>some</span>
  <span m='2308880'>L's</span> <span m='2309270'>like</span> <span m='2309480'>that</span>
  <span m='2309710'>that</span> <span m='2309840'>just</span> <span m='2309990'>go</span>
  <span m='2310100'>off</span> <span m='2310260'>to</span> <span m='2310350'>infinity.</span>
  <span m='2313770'>But</span> <span m='2313950'>everyone</span> <span m='2314280'>that's</span>
  <span m='2314700'>in</span> <span m='2314940'>an L,</span> <span m='2315480'>this</span>
  <span m='2315910'>is</span> <span m='2316020'>the</span> <span m='2316110'>insertion</span>
  <span m='2316560'>that</span> <span m='2316650'>made</span> <span m='2316890'>it.</span>
  <span m='2317100'>These</span> <span m='2317310'>are</span> <span m='2317400'>the</span>
  <span m='2317520'>delete-mins</span> <span m='2318050'>that</span> <span m='2318180'>deleted</span>
  <span m='2318540'>it.</span> <span m='2319650'>We're</span> <span m='2319740'>not</span>
  <span m='2319860'>going</span> <span m='2319980'>to</span> <span m='2320070'>do</span>
  <span m='2320190'>arbitrary</span> <span m='2320550'>deletes,</span> <span m='2320850'>just</span>
  <span m='2321120'>delete-mins.</span> <span m='2321430'>It's</span> <span m='2321800'>hard</span>
  <span m='2322170'>enough.</span> <span m='2324110'>OK,</span> <span m='2324480'>problem</span>
  <span m='2324750'>clear?</span> </p><p><span m='2326380'>So</span> <span m='2326820'>I</span>
  <span m='2326910'>want</span> <span m='2327060'>to</span> <span m='2327150'>maintain</span>
  <span m='2327630'>this.</span> <span m='2328800'>Let</span> <span m='2328890'>me</span>
  <span m='2329010'>show</span> <span m='2329250'>you</span> <span m='2329940'>what</span>
  <span m='2330150'>goes</span> <span m='2330450'>wrong,</span> <span m='2331600'>the</span>
  <span m='2331980'>hard</span> <span m='2332340'>part</span> <span m='2332760'>about</span>
  <span m='2333090'>this</span> <span m='2335490'>data</span> <span m='2335850'>structure.</span>
  <span m='2337680'>Let's</span> <span m='2337950'>say</span> <span m='2338490'>I</span>
  <span m='2338640'>do</span> <span m='2338910'>an</span> <span m='2339030'>insert</span>
  <span m='2340110'>here.</span> <span m='2342660'>New</span> <span m='2342810'>insertion.</span>
  <span m='2344100'>Well,</span> <span m='2344250'>that</span> <span m='2344430'>means</span>
  <span m='2344970'>that</span> <span m='2345300'>this</span> <span m='2345510'>delete-min</span>
  <span m='2346020'>would</span> <span m='2346140'>have</span> <span m='2346230'>returned</span>
  <span m='2346650'>this</span> <span m='2346830'>guy</span> <span m='2347100'>instead</span>
  <span m='2347430'>of</span> <span m='2347520'>this</span> <span m='2347700'>one.</span>
  <span m='2348420'>So</span> <span m='2348540'>this</span> <span m='2348720'>one</span>
  <span m='2348900'>would</span> <span m='2349020'>actually</span> <span m='2349350'>continue</span>
  <span m='2349740'>to</span> <span m='2349860'>exist.</span> </p><p><span m='2351340'>So</span>
  <span m='2351420'>then</span> <span m='2351630'>this</span> <span m='2351870'>delete-min</span>
  <span m='2352320'>would</span> <span m='2352410'>have</span> <span m='2352500'>deleted</span>
  <span m='2352890'>this</span> <span m='2353100'>guy</span> <span m='2353520'>instead</span>
  <span m='2353970'>of</span> <span m='2354210'>that</span> <span m='2354450'>one.</span>
  <span m='2355110'>So</span> <span m='2355230'>this</span> <span m='2355410'>guy</span>
  <span m='2355590'>continues</span> <span m='2355980'>to</span> <span m='2356070'>exist.</span>
  <span m='2357070'>So</span> <span m='2357360'>this</span> <span m='2358380'>continues</span>
  <span m='2360060'>to</span> <span m='2360250'>the</span> <span m='2360370'>right.</span>
  <span m='2360710'>This</span> <span m='2360730'>starts</span> <span m='2361140'>exist</span>
  <span m='2361530'>until</span> <span m='2361800'>this</span> <span m='2362060'>delete-min,</span>
  <span m='2362920'>and</span> <span m='2363060'>now</span> <span m='2363180'>this</span>
  <span m='2363360'>one</span> <span m='2363510'>exists.</span> <span m='2364870'>OK,</span>
  <span m='2365220'>and</span> <span m='2365400'>then</span> <span m='2365760'>this</span>
  <span m='2365910'>one</span> <span m='2366060'>exists</span> <span m='2366780'>for</span>
  <span m='2366870'>the</span> <span m='2366990'>rest</span> <span m='2367230'>of</span>
  <span m='2367320'>time.</span> <span m='2368370'>In</span> <span m='2368490'>general,</span>
  <span m='2368970'>you</span> <span m='2369090'>do</span> <span m='2369210'>a</span>
  <span m='2369270'>single</span> <span m='2370050'>retroactive</span> <span m='2370620'>insert,</span>
  <span m='2371640'>everything</span> <span m='2372060'>could</span> <span m='2372180'>change.</span>
  <span m='2373280'>Or</span> <span m='2373470'>a</span> <span m='2373500'>linear</span>
  <span m='2373800'>number</span> <span m='2374040'>of</span> <span m='2374100'>guys</span>
  <span m='2374970'>could</span> <span m='2375060'>change.</span> </p><p><span m='2379370'>So</span>
  <span m='2379450'>if</span> <span m='2379540'>you</span> <span m='2379630'>want</span>
  <span m='2379780'>to</span> <span m='2379840'>maintain</span> <span m='2380170'>this</span>
  <span m='2380290'>picture,</span> <span m='2381130'>you're</span> <span m='2381220'>in</span>
  <span m='2381310'>trouble.</span> <span m='2381760'>You</span> <span m='2381910'>get</span>
  <span m='2382640'>an</span> <span m='2382740'>omega</span> <span m='2383050'>r</span>
  <span m='2383300'>lower</span> <span m='2383490'>bound.</span> <span m='2384310'>So</span>
  <span m='2384400'>we're</span> <span m='2384520'>not</span> <span m='2384640'>going</span>
  <span m='2384790'>to</span> <span m='2384850'>maintain</span> <span m='2385150'>this</span>
  <span m='2385270'>picture.</span> <span m='2386020'>But</span> <span m='2386170'>we're</span>
  <span m='2386230'>going</span> <span m='2386350'>to</span> <span m='2386410'>keep</span>
  <span m='2386650'>it</span> <span m='2386800'>in</span> <span m='2386950'>our</span>
  <span m='2387040'>minds,</span> <span m='2387490'>vaguely,</span> <span m='2388270'>that</span>
  <span m='2388390'>we</span> <span m='2388570'>wanted</span> <span m='2388960'>to
  know</span> <span m='2389170'>something</span> <span m='2389560'>like</span> <span
  m='2389770'>this</span> <span m='2389920'>picture.</span> </p><p><span m='2391030'>What</span>
  <span m='2391270'>we</span> <span m='2391480'>really</span> <span m='2391810'>need</span>
  <span m='2391960'>to</span> <span m='2392110'>know</span> <span m='2392440'>is</span>
  <span m='2392590'>that</span> <span m='2392890'>this</span> <span m='2393220'>element</span>
  <span m='2393670'>now</span> <span m='2393940'>exists</span> <span m='2394270'>in</span>
  <span m='2394360'>the</span> <span m='2394450'>data</span> <span m='2394690'>structure.</span>
  <span m='2395980'>If</span> <span m='2396100'>I'm</span> <span m='2396220'>just</span>
  <span m='2396370'>doing</span> <span m='2396580'>partial</span> <span m='2396880'>retroactivity,</span>
  <span m='2397570'>what</span> <span m='2397720'>I</span> <span m='2397780'>care</span>
  <span m='2398050'>about</span> <span m='2398320'>is</span> <span m='2398590'>who</span>
  <span m='2398800'>exists</span> <span m='2399190'>at</span> <span m='2399310'>the</span>
  <span m='2399460'>end</span> <span m='2399610'>of</span> <span m='2399730'>time.</span>
  <span m='2401120'>So</span> <span m='2401200'>I'm</span> <span m='2401380'>doing</span>
  <span m='2401650'>an</span> <span m='2401740'>insert</span> <span m='2402340'>at</span>
  <span m='2402490'>a</span> <span m='2402550'>given</span> <span m='2402820'>time</span>
  <span m='2403160'>t,</span> <span m='2404500'>with</span> <span m='2404740'>a</span>
  <span m='2404800'>given</span> <span m='2405640'>key</span> <span m='2405970'>x.</span>
  <span m='2408290'>And</span> <span m='2409360'>if</span> <span m='2409720'>life</span>
  <span m='2410020'>was</span> <span m='2410200'>good,</span> <span m='2410790'>you</span>
  <span m='2410910'>know,</span> <span m='2410980'>if</span> <span m='2411100'>I</span>
  <span m='2411220'>was</span> <span m='2411460'>commutative,</span> <span m='2412330'>then</span>
  <span m='2412440'>that</span> <span m='2412570'>would</span> <span m='2412660'>be</span>
  <span m='2412750'>equivalent</span> <span m='2413140'>to</span> <span m='2413200'>inserting</span>
  <span m='2413590'>that</span> <span m='2413800'>key</span> <span m='2413980'>x</span>
  <span m='2414280'>at</span> <span m='2414400'>the</span> <span m='2414520'>end</span>
  <span m='2414670'>of</span> <span m='2414760'>time.</span> <span m='2415130'>But</span>
  <span m='2415210'>it's</span> <span m='2415300'>not.</span> </p><p><span m='2416080'>Instead</span>
  <span m='2416530'>I</span> <span m='2416620'>have</span> <span m='2416770'>to</span>
  <span m='2416860'>figure</span> <span m='2417130'>out</span> <span m='2417220'>what</span>
  <span m='2417550'>key</span> <span m='2417970'>gets</span> <span m='2418210'>inserted</span>
  <span m='2418630'>at</span> <span m='2418720'>the</span> <span m='2418870'>end</span>
  <span m='2419590'>when</span> <span m='2419740'>I</span> <span m='2419860'>insert</span>
  <span m='2420160'>this</span> <span m='2420310'>key</span> <span m='2420460'>at</span>
  <span m='2420580'>this</span> <span m='2420730'>time.</span> <span m='2421450'>And</span>
  <span m='2421600'>similarly</span> <span m='2422080'>for</span> <span m='2422260'>adding</span>
  <span m='2422500'>a</span> <span m='2422590'>delete-min.</span> <span m='2424200'>I</span>
  <span m='2424300'>won't</span> <span m='2424450'>try</span> <span m='2424630'>to</span>
  <span m='2424720'>draw</span> <span m='2424900'>that,</span> <span m='2425140'>but</span>
  <span m='2425680'>exactly</span> <span m='2426070'>the</span> <span m='2426160'>same</span>
  <span m='2426400'>kind</span> <span m='2426520'>of</span> <span m='2426610'>chain</span>
  <span m='2426820'>reactions</span> <span m='2427240'>can</span> <span m='2427390'>happen.</span>
  <span m='2429680'>OK,</span> <span m='2431090'>so</span> <span m='2431330'>we're</span>
  <span m='2431420'>going</span> <span m='2431540'>to</span> <span m='2431600'>do</span>
  <span m='2431690'>this</span> <span m='2431900'>in</span> <span m='2431990'>log</span>
  <span m='2432220'>n</span> <span m='2432350'>time.</span> </p><p><span m='2453850'>How</span>
  <span m='2454210'>do</span> <span m='2454330'>we</span> <span m='2454480'>do</span>
  <span m='2454690'>it?</span> <span m='2461130'>So</span> <span m='2461310'>I'm</span>
  <span m='2461400'>going</span> <span m='2461520'>to</span> <span m='2461580'>focus</span>
  <span m='2461970'>on</span> <span m='2462120'>the</span> <span m='2462270'>insertion</span>
  <span m='2462780'>case,</span> <span m='2463980'>inserting--</span> <span m='2464910'>the</span>
  <span m='2465000'>double</span> <span m='2465300'>insertion</span> <span m='2465750'>case--</span>
  <span m='2466440'>inserting</span> <span m='2466920'>an</span> <span m='2467010'>insert</span>
  <span m='2467670'>operation.</span> <span m='2469230'>I</span> <span m='2469380'>guess
  I'm going to</span> <span m='2469810'>switch</span> <span m='2470010'>notation</span>
  <span m='2470550'>and</span> <span m='2470670'>call</span> <span m='2470880'>the</span>
  <span m='2470970'>keys</span> <span m='2471240'>k,</span> <span m='2471540'>instead</span>
  <span m='2471840'>of</span> <span m='2471930'>x.</span> <span m='2472600'>It</span>
  <span m='2472820'>doesn't</span> <span m='2473010'>matter.</span> </p><p><span m='2482440'>OK,</span>
  <span m='2483000'>what</span> <span m='2483150'>I'd</span> <span m='2483270'>like</span>
  <span m='2483450'>to</span> <span m='2483570'>know</span> <span m='2483810'>is that</span>
  <span m='2484020'>when</span> <span m='2484200'>I</span> <span m='2484290'>do</span>
  <span m='2484470'>this</span> <span m='2484680'>insertion,</span> <span m='2486090'>what</span>
  <span m='2486390'>gets</span> <span m='2486600'>inserted</span> <span m='2487080'>into</span>
  <span m='2487590'>the</span> <span m='2487830'>final</span> <span m='2488220'>Q?</span>
  <span m='2488760'>I'm</span> <span m='2488850'>going</span> <span m='2488970'>to</span>
  <span m='2489030'>call</span> <span m='2489180'>that</span> <span m='2489330'>Q</span>
  <span m='2489570'>now,</span> <span m='2489900'>being</span> <span m='2490170'>the</span>
  <span m='2490710'>the</span> <span m='2490800'>present,</span> <span m='2492280'>the</span>
  <span m='2492380'>future,</span> <span m='2492880'>whatever</span> <span m='2493050'>you</span>
  <span m='2493170'>want</span> <span m='2493290'>to</span> <span m='2493440'>call
  it.</span> </p><p><span m='2496620'>I</span> <span m='2496740'>claim</span> <span
  m='2505300'>this</span> <span m='2505480'>is</span> <span m='2505630'>what</span>
  <span m='2505780'>gets</span> <span m='2505990'>inserted.</span> </p><p><span m='2513530'>If</span>
  <span m='2513630'>you</span> <span m='2513730'>look</span> <span m='2513760'>at</span>
  <span m='2513820'>all</span> <span m='2514000'>the</span> <span m='2514090'>keys</span>
  <span m='2514410'>that</span> <span m='2514480'>get</span> <span m='2514660'>deleted</span>
  <span m='2515110'>from</span> <span m='2515320'>now</span> <span m='2515620'>on,</span>
  <span m='2516130'>and</span> <span m='2516280'>you</span> <span m='2516370'>look</span>
  <span m='2516520'>at</span> <span m='2516610'>the</span> <span m='2516700'>key</span>
  <span m='2516890'>you're</span> <span m='2517000'>inserting,</span> <span m='2517600'>you</span>
  <span m='2517720'>take</span> <span m='2517900'>the</span> <span m='2518020'>max</span>
  <span m='2518380'>of</span> <span m='2518500'>all</span> <span m='2518650'>those,</span>
  <span m='2518920'>that</span> <span m='2519100'>will</span> <span m='2519190'>be</span>
  <span m='2519310'>the</span> <span m='2519430'>one</span> <span m='2519580'>that</span>
  <span m='2519700'>survives.</span> <span m='2520960'>That's</span> <span m='2521110'>pretty</span>
  <span m='2521350'>obvious.</span> <span m='2522640'>The</span> <span m='2522760'>annoying</span>
  <span m='2523030'>thing</span> <span m='2523240'>is</span> <span m='2523420'>this</span>
  <span m='2523720'>is</span> <span m='2523810'>really</span> <span m='2524080'>hard</span>
  <span m='2524290'>to</span> <span m='2524710'>think</span> <span m='2525010'>about.</span>
  <span m='2526150'>Because</span> <span m='2526420'>who</span> <span m='2526690'>gets</span>
  <span m='2526960'>deleted</span> <span m='2527590'>is</span> <span m='2528160'>something</span>
  <span m='2528550'>that</span> <span m='2528730'>is</span> <span m='2528880'>a</span>
  <span m='2528940'>chain</span> <span m='2529240'>reaction</span> <span m='2530230'>effect.</span>
  <span m='2530560'>What</span> <span m='2530680'>we'd</span> <span m='2530830'>really</span>
  <span m='2531070'>like</span> <span m='2531280'>to</span> <span m='2531400'>have</span>
  <span m='2531670'>is</span> <span m='2531760'>the</span> <span m='2531880'>word</span>
  <span m='2532030'>inserted</span> <span m='2532540'>there,</span> <span m='2533190'>because</span>
  <span m='2533350'>we</span> <span m='2533470'>know</span> <span m='2533650'>what</span>
  <span m='2533830'>things</span> <span m='2534070'>get</span> <span m='2534250'>inserted</span>
  <span m='2534640'>when.</span> <span m='2535050'>Those</span> <span m='2535150'>are</span>
  <span m='2535360'>the</span> <span m='2535480'>operations.</span> <span m='2536090'>We</span>
  <span m='2536200'>just</span> <span m='2536380'>maintain</span> <span m='2536800'>the</span>
  <span m='2536890'>list</span> <span m='2537100'>of</span> <span m='2537190'>operations,</span>
  <span m='2537700'>we'd</span> <span m='2537820'>know</span> <span m='2537970'>that.</span>
  </p><p><span m='2538700'>Deleted</span> <span m='2539170'>is</span> <span m='2539320'>a</span>
  <span m='2539350'>lot</span> <span m='2539560'>harder</span> <span m='2539830'>to</span>
  <span m='2539950'>think</span> <span m='2540160'>about.</span> <span m='2541510'>So</span>
  <span m='2543220'>we</span> <span m='2543310'>need</span> <span m='2543460'>a</span>
  <span m='2543520'>Lemma</span> <span m='2544120'>that</span> <span m='2544240'>tells</span>
  <span m='2544630'>us--</span> <span m='2545290'>there's</span> <span m='2545620'>a</span>
  <span m='2545680'>nice</span> <span m='2545950'>equation</span> <span m='2546430'>that</span>
  <span m='2546580'>simplifies</span> <span m='2547150'>this</span> <span m='2547300'>formula</span>
  <span m='2547660'>for</span> <span m='2547900'>us,</span> <span m='2549160'>or</span>
  <span m='2549310'>this</span> <span m='2549460'>computation.</span> <span m='2551030'>For</span>
  <span m='2551200'>that</span> <span m='2551380'>we</span> <span m='2551500'>need</span>
  <span m='2551650'>the</span> <span m='2551740'>notion</span> <span m='2552040'>of</span>
  <span m='2552160'>a</span> <span m='2552220'>bridge.</span> <span m='2554270'>A</span>
  <span m='2556390'>very</span> <span m='2556540'>simple</span> <span m='2556870'>idea.</span>
  <span m='2557770'>A</span> <span m='2558220'>bridge</span> <span m='2558520'>at</span>
  <span m='2558580'>time</span> <span m='2558880'>t</span> <span m='2560680'>is</span>
  <span m='2561160'>a</span> <span m='2561220'>time</span> <span m='2561850'>when</span>
  <span m='2565150'>everything</span> <span m='2565510'>that's</span> <span m='2565660'>currently</span>
  <span m='2566140'>in</span> <span m='2566230'>the</span> <span m='2566320'>queue</span>
  <span m='2567160'>will</span> <span m='2567340'>finally</span> <span m='2567760'>be</span>
  <span m='2567940'>in</span> <span m='2568030'>the</span> <span m='2568120'>queue.</span>
  </p><p><span m='2571880'>So</span> <span m='2574960'>this</span> <span m='2575230'>is</span>
  <span m='2575350'>a</span> <span m='2575410'>bridge.</span> <span m='2576040'>This</span>
  <span m='2576280'>is</span> <span m='2576400'>a</span> <span m='2576460'>bridge.</span>
  <span m='2577630'>Because</span> <span m='2577930'>these</span> <span m='2578230'>elements</span>
  <span m='2578740'>exist</span> <span m='2579070'>for</span> <span m='2579160'>the</span>
  <span m='2579250'>rest</span> <span m='2579520'>of</span> <span m='2579580'>time.</span>
  <span m='2581050'>This</span> <span m='2581230'>is</span> <span m='2581350'>a</span>
  <span m='2581410'>bridge.</span> <span m='2583610'>OK,</span> <span m='2584110'>these</span>
  <span m='2584290'>are</span> <span m='2584350'>basically--</span> <span m='2585370'>interesting</span>
  <span m='2585850'>stuff</span> <span m='2586090'>happens</span> <span m='2586420'>between</span>
  <span m='2586810'>bridges.</span> <span m='2587230'>Bridges</span> <span m='2587620'>are</span>
  <span m='2587720'>the</span> <span m='2587830'>points</span> <span m='2588160'>of</span>
  <span m='2588340'>rest</span> <span m='2589030'>when</span> <span m='2589320'>things</span>
  <span m='2589570'>are</span> <span m='2589660'>kind</span> <span m='2589840'>of</span>
  <span m='2589900'>boring.</span> <span m='2591430'>We'll</span> <span m='2591550'>need</span>
  <span m='2591760'>this</span> <span m='2593170'>for</span> <span m='2593350'>the</span>
  <span m='2593470'>next</span> <span m='2594730'>statement.</span> </p><p><span m='2599070'>And</span>
  <span m='2599200'>the</span> <span m='2599350'>other</span> <span m='2599530'>claim</span>
  <span m='2599770'>is</span> <span m='2599890'>it's</span> <span m='2600010'>easy</span>
  <span m='2600220'>to</span> <span m='2600310'>maintain</span> <span m='2600700'>where</span>
  <span m='2600820'>the</span> <span m='2600910'>bridges</span> <span m='2601240'>are.</span>
  <span m='2601510'>That's</span> <span m='2602320'>not</span> <span m='2602530'>a</span>
  <span m='2602590'>big</span> <span m='2602740'>surprise.</span> <span m='2603715'>Because</span>
  <span m='2604150'>there's</span> <span m='2604300'>no</span> <span m='2604420'>chain</span>
  <span m='2604660'>reactions</span> <span m='2605080'>at</span> <span m='2605200'>the</span>
  <span m='2605290'>bridges.</span> </p><p><span m='2620330'>So</span> <span m='2620570'>if</span>
  <span m='2620720'>I</span> <span m='2620810'>have</span> <span m='2620950'>a</span>
  <span m='2621060'>time</span> <span m='2621350'>t</span> <span m='2621590'>that</span>
  <span m='2621740'>I</span> <span m='2621830'>care</span> <span m='2622130'>about--</span>
  <span m='2622400'>I</span> <span m='2622490'>want</span> <span m='2622700'>to</span>
  <span m='2622760'>compute</span> <span m='2623210'>this</span> <span m='2623450'>formula</span>
  <span m='2624020'>for</span> <span m='2624200'>time</span> <span m='2624480'>t--</span>
  <span m='2625370'>what</span> <span m='2625520'>I</span> <span m='2625580'>do</span>
  <span m='2625730'>is</span> <span m='2625850'>find</span> <span m='2626120'>the</span>
  <span m='2626270'>preceding</span> <span m='2627020'>bridge.</span> <span m='2627770'>Call</span>
  <span m='2628010'>it</span> <span m='2628100'>t</span> <span m='2628310'>prime.</span>
  </p><p><span m='2629610'>This</span> <span m='2629690'>is</span> <span m='2629780'>like--</span>
  <span m='2631280'>an</span> <span m='2631460'>arbitrary</span> <span m='2631880'>time</span>
  <span m='2632180'>t</span> <span m='2632450'>like</span> <span m='2632690'>here,</span>
  <span m='2633310'>we're</span> <span m='2633440'>in</span> <span m='2633500'>the</span>
  <span m='2633590'>middle</span> <span m='2633830'>of</span> <span m='2633890'>some</span>
  <span m='2634070'>action.</span> <span m='2634460'>I</span> <span m='2634550'>want</span>
  <span m='2634700'>to</span> <span m='2634760'>know</span> <span m='2634910'>what</span>
  <span m='2635060'>that</span> <span m='2635210'>action</span> <span m='2635480'>is.</span>
  <span m='2635660'>So I</span> <span m='2635780'>want</span> <span m='2635900'>to</span>
  <span m='2635990'>go</span> <span m='2636110'>to</span> <span m='2636170'>the</span>
  <span m='2636290'>preceding</span> <span m='2636830'>blue</span> <span m='2637040'>line.</span>
  <span m='2638850'>So</span> <span m='2638990'>that's</span> <span m='2639320'>t</span>
  <span m='2639440'>prime.</span> <span m='2640680'>If</span> <span m='2640880'>my</span>
  <span m='2641060'>query</span> <span m='2641480'>is</span> <span m='2641630'>here,</span>
  <span m='2642430'>t</span> <span m='2643580'>prime</span> <span m='2644000'>will</span>
  <span m='2644150'>be</span> <span m='2644510'>there.</span> </p><p><span m='2647550'>Then,</span>
  <span m='2650780'>what</span> <span m='2651020'>I</span> <span m='2651110'>want</span>
  <span m='2651320'>to</span> <span m='2651410'>know</span> <span m='2651860'>is</span>
  <span m='2652070'>this</span> <span m='2652250'>max</span> <span m='2652850'>of</span>
  <span m='2653060'>k</span> <span m='2653300'>prime</span> <span m='2654350'>where</span>
  <span m='2654530'>k</span> <span m='2654800'>prime</span> <span m='2655400'>is</span>
  <span m='2655700'>deleted</span> <span m='2658700'>after</span> <span m='2662210'>time</span>
  <span m='2662660'>t.</span> <span m='2667450'>I</span> <span m='2667760'>should</span>
  <span m='2667970'>say</span> <span m='2668330'>greater</span> <span m='2668840'>equal</span>
  <span m='2668880'>to</span> <span m='2668970'>t,</span> <span m='2669920'>instead</span>
  <span m='2670160'>of</span> <span m='2670280'>after,</span> <span m='2670970'>a
  little</span> <span m='2671030'>more</span> <span m='2671180'>precise.</span> <span
  m='2675230'>Claim</span> <span m='2675590'>this</span> <span m='2675830'>equals</span>
  <span m='2676910'>the</span> <span m='2677030'>max</span> <span m='2680325'>over</span>
  <span m='2680740'>all</span> <span m='2681830'>k</span> <span m='2682070'>prime</span>
  <span m='2682660'>not</span> <span m='2683060'>in</span> <span m='2683240'>the</span>
  <span m='2683330'>final</span> <span m='2683720'>queue,</span> <span m='2684660'>because</span>
  <span m='2685130'>those guys</span> <span m='2685430'>obviously</span> <span m='2685760'>still</span>
  <span m='2685970'>exist.</span> <span m='2690050'>Where</span> <span m='2690260'>k</span>
  <span m='2690500'>prime</span> <span m='2690920'>is</span> <span m='2691160'>inserted</span>
  <span m='2697900'>at</span> <span m='2698100'>time</span> <span m='2699600'>greater</span>
  <span m='2699840'>than</span> <span m='2699930'>or</span> <span m='2700050'>equal</span>
  <span m='2700350'>to</span> <span m='2700500'>t</span> <span m='2700800'>prime.</span>
  </p><p><span m='2702940'>So</span> <span m='2702990'>basically</span> <span m='2703320'>I</span>
  <span m='2703350'>can</span> <span m='2703530'>turn</span> <span m='2703740'>the</span>
  <span m='2703830'>word</span> <span m='2703950'>deleted</span> <span m='2704400'>into</span>
  <span m='2704610'>the</span> <span m='2704730'>word</span> <span m='2704850'>inserted,</span>
  <span m='2705930'>if</span> <span m='2706050'>I</span> <span m='2706140'>change</span>
  <span m='2706440'>t to t</span> <span m='2706890'>prime.</span> <span m='2707930'>And</span>
  <span m='2708060'>I</span> <span m='2708150'>also</span> <span m='2708420'>have</span>
  <span m='2708570'>to</span> <span m='2708660'>exclude</span> <span m='2709740'>the</span>
  <span m='2709830'>guys</span> <span m='2710070'>at</span> <span m='2710190'>the</span>
  <span m='2710280'>top.</span> <span m='2710770'>So</span> <span m='2711510'>we're</span>
  <span m='2711690'>looking</span> <span m='2712050'>at</span> <span m='2712170'>a</span>
  <span m='2712260'>particular</span> <span m='2712680'>time</span> <span m='2712890'>like</span>
  <span m='2713130'>here.</span> <span m='2714540'>I</span> <span m='2714690'>want</span>
  <span m='2714840'>to</span> <span m='2714900'>know</span> <span m='2715080'>who</span>
  <span m='2715230'>are</span> <span m='2715290'>the</span> <span m='2715410'>things</span>
  <span m='2715710'>that</span> <span m='2715830'>are</span> <span m='2715890'>deleted</span>
  <span m='2716310'>after</span> <span m='2716610'>that.</span> <span m='2716880'>Well,</span>
  <span m='2717090'>this</span> <span m='2717300'>is</span> <span m='2717390'>deleted.</span>
  <span m='2717880'>This</span> <span m='2717960'>is</span> <span m='2718020'>deleted.</span>
  <span m='2718510'>All</span> <span m='2718540'>these</span> <span m='2718710'>guys</span>
  <span m='2718920'>are</span> <span m='2718980'>deleted</span> <span m='2719340'>after.</span>
  </p><p><span m='2721170'>I'm</span> <span m='2721260'>going</span> <span m='2721410'>to</span>
  <span m='2721470'>rewind</span> <span m='2722130'>to</span> <span m='2722280'>t</span>
  <span m='2722460'>prime</span> <span m='2722820'>and</span> <span m='2722910'>say,</span>
  <span m='2723220'>well,</span> <span m='2723960'>you</span> <span m='2724020'>know</span>
  <span m='2724110'>there</span> <span m='2724230'>are</span> <span m='2724260'>these</span>
  <span m='2724470'>guys</span> <span m='2724800'>that</span> <span m='2724910'>they</span>
  <span m='2725100'>survive.</span> <span m='2725640'>They</span> <span m='2725820'>obviously</span>
  <span m='2726120'>don't</span> <span m='2726270'>get</span> <span m='2726390'>deleted.</span>
  <span m='2726780'>But</span> <span m='2726980'>if</span> <span m='2727140'>you</span>
  <span m='2727200'>ignore</span> <span m='2727500'>the</span> <span m='2727620'>guys</span>
  <span m='2727920'>that</span> <span m='2728100'>end</span> <span m='2728280'>up</span>
  <span m='2728430'>in</span> <span m='2728520'>the</span> <span m='2728610'>final</span>
  <span m='2728910'>queue,</span> <span m='2731100'>the</span> <span m='2731220'>guys</span>
  <span m='2731460'>that</span> <span m='2731550'>get</span> <span m='2732750'>deleted</span>
  <span m='2733230'>after</span> <span m='2733500'>time</span> <span m='2733740'>t</span>
  <span m='2733920'>are</span> <span m='2734010'>the</span> <span m='2734100'>same</span>
  <span m='2734400'>as</span> <span m='2734490'>the</span> <span m='2734580'>ones</span>
  <span m='2734760'>that</span> <span m='2734850'>get</span> <span m='2734940'>inserted</span>
  <span m='2735390'>after</span> <span m='2735710'>t</span> <span m='2735840'>prime.</span>
  <span m='2738900'>That's</span> <span m='2739140'>the</span> <span m='2739290'>claim.</span>
  </p><p><span m='2739500'>Or</span> <span m='2739860'>actually,</span> <span m='2740800'>that</span>
  <span m='2741150'>set</span> <span m='2741330'>of</span> <span m='2741420'>elements</span>
  <span m='2741690'>is</span> <span m='2741780'>not</span> <span m='2741930'>the</span>
  <span m='2742020'>same,</span> <span m='2742230'>but</span> <span m='2742350'>the</span>
  <span m='2742470'>max</span> <span m='2742830'>will</span> <span m='2742950'>be</span>
  <span m='2743070'>the</span> <span m='2743190'>same.</span> <span m='2743910'>That's</span>
  <span m='2744090'>all</span> <span m='2744210'>I</span> <span m='2744300'>care</span>
  <span m='2744480'>about.</span> <span m='2745500'>I</span> <span m='2745560'>only</span>
  <span m='2745800'>want</span> <span m='2745980'>to</span> <span m='2746040'>know</span>
  <span m='2746190'>the</span> <span m='2746280'>max.</span> <span m='2746550'>The</span>
  <span m='2746820'>max</span> <span m='2747180'>among</span> <span m='2747450'>all</span>
  <span m='2747570'>the</span> <span m='2747630'>ones</span> <span m='2747810'>deleted</span>
  <span m='2748110'>here</span> <span m='2748320'>is</span> <span m='2748440'>this</span>
  <span m='2748600'>upper</span> <span m='2748810'>uppermost</span> <span m='2749940'>segment.</span>
  <span m='2751580'>And</span> <span m='2751680'>that's</span> <span m='2751860'>the</span>
  <span m='2751980'>same</span> <span m='2752340'>as</span> <span m='2752490'>the</span>
  <span m='2752580'>max</span> <span m='2752910'>among</span> <span m='2753150'>all</span>
  <span m='2753270'>the</span> <span m='2753360'>guys</span> <span m='2753570'>that</span>
  <span m='2753690'>are</span> <span m='2753750'>inserted</span> <span m='2754200'>after</span>
  <span m='2754560'>here.</span> <span m='2754960'>So it's</span> <span m='2755130'>really</span>
  <span m='2755340'>just</span> <span m='2755500'>a</span> <span m='2755580'>claim</span>
  <span m='2755820'>about</span> <span m='2756090'>this</span> <span m='2756300'>one</span>
  <span m='2757230'>being</span> <span m='2757560'>inserted</span> <span m='2758730'>after</span>
  <span m='2759210'>this</span> <span m='2760830'>bridge.</span> </p><p><span m='2761700'>I</span>
  <span m='2761820'>won't</span> <span m='2761970'>prove</span> <span m='2762180'>this</span>
  <span m='2762360'>Lemma.</span> <span m='2762690'>It's</span> <span m='2763020'>just,</span>
  <span m='2763890'>you</span> <span m='2764010'>think</span> <span m='2764220'>about</span>
  <span m='2764460'>it</span> <span m='2764550'>for</span> <span m='2764670'>long</span>
  <span m='2764880'>enough,</span> <span m='2765220'>it</span> <span m='2765320'>becomes</span>
  <span m='2765540'>obvious.</span> <span m='2766770'>Leave it</span> <span m='2767010'>at</span>
  <span m='2767100'>that.</span> <span m='2768900'>Now</span> <span m='2769140'>we</span>
  <span m='2769260'>can</span> <span m='2769410'>do</span> <span m='2769530'>some</span>
  <span m='2769650'>data</span> <span m='2769860'>structures,</span> <span m='2770250'>because</span>
  <span m='2770640'>now</span> <span m='2770820'>we</span> <span m='2770910'>have</span>
  <span m='2771060'>something</span> <span m='2771420'>that</span> <span m='2771540'>we</span>
  <span m='2771660'>can</span> <span m='2771870'>reasonably</span> <span m='2772440'>hope</span>
  <span m='2772650'>to</span> <span m='2772770'>maintain.</span> </p><p><span m='2781220'>So</span>
  <span m='2781520'>maintaining</span> <span m='2781940'>bridges,</span> <span m='2782840'>one</span>
  <span m='2783050'>thing--</span> <span m='2787170'>Yeah,</span> <span m='2787920'>actually</span>
  <span m='2788410'>kind</span> <span m='2788620'>of</span> <span m='2789280'>an</span>
  <span m='2789380'>important</span> <span m='2789640'>thing.</span> <span m='2792800'>So</span>
  <span m='2792880'>here's</span> <span m='2793090'>where</span> <span m='2793210'>we're</span>
  <span m='2793270'>going</span> <span m='2793390'>to</span> <span m='2793480'>store.</span>
  <span m='2794010'>We're</span> <span m='2794170'>going</span> <span m='2794270'>to</span>
  <span m='2794380'>store</span> <span m='2794680'>the</span> <span m='2794800'>current</span>
  <span m='2795070'>Q</span> <span m='2796660'>as</span> <span m='2796990'>a</span>
  <span m='2797080'>balanced</span> <span m='2797470'>binary</span> <span m='2797770'>search</span>
  <span m='2798040'>tree.</span> <span m='2799620'>OK,</span> <span m='2799990'>that's</span>
  <span m='2800980'>not</span> <span m='2801610'>very</span> <span m='2801820'>exciting.</span>
  <span m='2803056'>Though</span> <span m='2803450'>the</span> <span m='2803620'>hard</span>
  <span m='2803860'>part</span> <span m='2804130'>is</span> <span m='2804250'>to</span>
  <span m='2804340'>figure</span> <span m='2804640'>out</span> <span m='2805180'>how</span>
  <span m='2805450'>Q</span> <span m='2805690'>now</span> <span m='2806020'>is</span>
  <span m='2806140'>changing</span> <span m='2806620'>at</span> <span m='2806710'>each</span>
  <span m='2806890'>step.</span> <span m='2807630'>But</span> <span m='2807790'>this</span>
  <span m='2807940'>will</span> <span m='2808060'>allow</span> <span m='2808330'>us</span>
  <span m='2808420'>to</span> <span m='2808540'>do</span> <span m='2808930'>arbitrary</span>
  <span m='2809410'>queries</span> <span m='2809890'>on</span> <span m='2810010'>the</span>
  <span m='2810100'>final</span> <span m='2810400'>result</span> </p><p><span m='2813280'>We</span>
  <span m='2813520'>want</span> <span m='2813730'>to</span> <span m='2813820'>store</span>
  <span m='2815500'>a</span> <span m='2815560'>balanced</span> <span m='2816070'>binary</span>
  <span m='2816490'>search</span> <span m='2816850'>tree</span> <span m='2819790'>whose</span>
  <span m='2820150'>leaves</span> <span m='2822760'>represent</span> <span m='2823390'>insertions.</span>
  <span m='2828400'>So</span> <span m='2829390'>lowercase</span> <span m='2829990'>insertions.</span>
  <span m='2830455'>So</span> <span m='2830920'>that's</span> <span m='2831190'>all</span>
  <span m='2831400'>of</span> <span m='2831550'>the</span> <span m='2832390'>rightward</span>
  <span m='2832790'>arrows.</span> <span m='2835960'>And</span> <span m='2836230'>they're</span>
  <span m='2836450'>are</span> <span m='2836500'>going</span> <span m='2836710'>to</span>
  <span m='2836830'>be</span> <span m='2836980'>sorted</span> <span m='2837460'>by</span>
  <span m='2838240'>time.</span> <span m='2843270'>Not</span> <span m='2843490'>by</span>
  <span m='2843700'>a</span> <span m='2843740'>key</span> <span m='2843940'>value.</span>
  </p><p><span m='2846540'>OK,</span> <span m='2846910'>and</span> <span m='2847060'>I'm</span>
  <span m='2847180'>going</span> <span m='2847360'>to</span> <span m='2847510'>augment</span>
  <span m='2848050'>that</span> <span m='2848290'>balanced</span> <span m='2848620'>binary</span>
  <span m='2848890'>search</span> <span m='2849160'>tree</span> <span m='2854710'>with</span>
  <span m='2855490'>a</span> <span m='2855670'>fun</span> <span m='2858250'>value</span>
  <span m='2858820'>for</span> <span m='2859000'>every</span> <span m='2859270'>node</span>
  <span m='2859540'>in</span> <span m='2859660'>the</span> <span m='2859720'>balanced</span>
  <span m='2860020'>binary</span> <span m='2860290'>search</span> <span m='2860590'>tree.</span>
  <span m='2861190'>I</span> <span m='2861310'>want</span> <span m='2861490'>to know</span>
  <span m='2861750'>max</span> <span m='2863010'>of</span> <span m='2863770'>all</span>
  <span m='2863980'>the</span> <span m='2864100'>keys</span> <span m='2864820'>not</span>
  <span m='2865210'>currently</span> <span m='2865630'>in</span> <span m='2865720'>the</span>
  <span m='2865840'>queue,</span> <span m='2867620'>or</span> <span m='2867820'>not</span>
  <span m='2868090'>presently</span> <span m='2868540'>in</span> <span m='2868630'>the</span>
  <span m='2868720'>queue</span> <span m='2868960'>at</span> <span m='2869050'>the</span>
  <span m='2869170'>end</span> <span m='2869320'>of</span> <span m='2869440'>time.</span>
  <span m='2870582'>That</span> <span m='2870990'>changes</span> <span m='2871330'>is</span>
  <span m='2871420'>very</span> <span m='2871630'>slowly,</span> <span m='2872230'>so</span>
  <span m='2872260'>this</span> <span m='2872470'>is</span> <span m='2872620'>easy</span>
  <span m='2872920'>to</span> <span m='2873100'>maintain.</span> <span m='2877510'>Among</span>
  <span m='2877870'>all</span> <span m='2878080'>the</span> <span m='2878200'>keys</span>
  <span m='2878530'>that</span> <span m='2878650'>are</span> <span m='2878740'>inserted</span>
  <span m='2879340'>in</span> <span m='2880420'>the</span> <span m='2880540'>subtree</span>
  <span m='2881080'>rooted</span> <span m='2881410'>at</span> <span m='2881500'>x.</span>
  </p><p><span m='2884210'>OK,</span> <span m='2884410'>that's</span> <span m='2884590'>basically</span>
  <span m='2886060'>this</span> <span m='2886240'>value,</span> <span m='2886790'>which</span>
  <span m='2886870'>I</span> <span m='2886960'>want</span> <span m='2887170'>to</span>
  <span m='2887260'>maintain,</span> <span m='2888220'>but</span> <span m='2888400'>split</span>
  <span m='2888700'>up</span> <span m='2888850'>over</span> <span m='2889060'>a</span>
  <span m='2889090'>subtree.</span> <span m='2890350'>And</span> <span m='2890440'>so</span>
  <span m='2890590'>that</span> <span m='2890710'>lets</span> <span m='2890950'>me</span>
  <span m='2891100'>easily</span> <span m='2891430'>compute</span> <span m='2891760'>this</span>
  <span m='2891910'>value</span> <span m='2892240'>by</span> <span m='2892660'>taking</span>
  <span m='2892990'>the</span> <span m='2893080'>max</span> <span m='2893440'>of</span>
  <span m='2893680'>log</span> <span m='2893980'>n</span> <span m='2894160'>of</span>
  <span m='2894250'>these</span> <span m='2894430'>values</span> <span m='2896140'>at</span>
  <span m='2896290'>any</span> <span m='2896500'>time.</span> </p><p><span m='2898470'>OK,</span>
  <span m='2899320'>then</span> <span m='2899560'>we</span> <span m='2899680'>store</span>
  <span m='2899950'>another</span> <span m='2900310'>balanced</span> <span m='2900640'>binary</span>
  <span m='2900880'>search</span> <span m='2901150'>tree</span> <span m='2903310'>where</span>
  <span m='2903820'>the</span> <span m='2903970'>leaves</span> <span m='2904510'>are</span>
  <span m='2904720'>all</span> <span m='2904930'>the</span> <span m='2905080'>updates.</span>
  <span m='2911610'>Again</span> <span m='2911900'>they</span> <span m='2912020'>will</span>
  <span m='2912190'>be</span> <span m='2912370'>ordered</span> <span m='2912610'>by</span>
  <span m='2912760'>time.</span> <span m='2921040'>And</span> <span m='2921430'>they</span>
  <span m='2921530'>will</span> <span m='2921600'>be</span> <span m='2921760'>augmented.</span>
  <span m='2930360'>In</span> <span m='2930520'>each</span> <span m='2930730'>node,</span>
  <span m='2931250'>I'm</span> <span m='2931350'>going</span> <span m='2931360'>to</span>
  <span m='2931450'>store</span> <span m='2932320'>a</span> <span m='2932350'>number</span>
  <span m='2933070'>which</span> <span m='2933250'>is</span> <span m='2933340'>0</span>
  <span m='2933760'>plus</span> <span m='2934030'>1</span> <span m='2934210'>or</span>
  <span m='2934270'>minus</span> <span m='2934600'>1.</span> <span m='2935440'>It's</span>
  <span m='2935620'>going</span> <span m='2935770'>to</span> <span m='2935860'>be</span>
  <span m='2936110'>0</span> <span m='2937900'>for</span> <span m='2938520'>an</span>
  <span m='2938650'>insert.</span> <span m='2941610'>This</span> <span m='2941790'>is</span>
  <span m='2941910'>at</span> <span m='2942100'>the</span> <span m='2942250'>leaf</span>
  <span m='2942550'>level</span> <span m='2942820'>because</span> <span m='2943020'>the</span>
  <span m='2943090'>leaves</span> <span m='2943420'>correspond</span> <span m='2943870'>to</span>
  <span m='2943960'>updates.</span> </p><p><span m='2946480'>If</span> <span m='2946810'>that</span>
  <span m='2948220'>key</span> <span m='2949660'>ends</span> <span m='2949930'>up</span>
  <span m='2950320'>in</span> <span m='2950500'>the</span> <span m='2950590'>final</span>
  <span m='2950920'>queue.</span> <span m='2951940'>So</span> <span m='2952060'>those</span>
  <span m='2952300'>we</span> <span m='2952420'>just</span> <span m='2952600'>ignore.</span>
  <span m='2954020'>It's</span> <span m='2954100'>going</span> <span m='2954280'>to</span>
  <span m='2954370'>be</span> <span m='2954640'>plus</span> <span m='2955120'>1</span>
  <span m='2957250'>for</span> <span m='2957550'>any</span> <span m='2957760'>other</span>
  <span m='2957940'>kind</span> <span m='2958120'>of</span> <span m='2958240'>insert.</span>
  <span m='2961300'>Inserting</span> <span m='2961750'>a</span> <span m='2961810'>key</span>
  <span m='2962260'>where</span> <span m='2963120'>k</span> <span m='2963310'>is</span>
  <span m='2963460'>not</span> <span m='2963880'>in</span> <span m='2965020'>Q</span>
  <span m='2965260'>now.</span> <span m='2967430'>And</span> <span m='2967780'>it's</span>
  <span m='2967870'>going</span> <span m='2968020'>to</span> <span m='2968080'>be</span>
  <span m='2968170'>minus 1</span> <span m='2968980'>for</span> <span m='2969460'>a</span>
  <span m='2969700'>delete-min.</span> </p><p><span m='2975810'>I'm</span> <span m='2975900'>going</span>
  <span m='2976160'>to</span> <span m='2976240'>store</span> <span m='2976450'>this.</span>
  <span m='2977470'>And</span> <span m='2979000'>we're</span> <span m='2979090'>going</span>
  <span m='2979210'>to</span> <span m='2979330'>have</span> <span m='2980560'>subtree</span>
  <span m='2981160'>sums.</span> <span m='2985330'>So</span> <span m='2985600'>this</span>
  <span m='2985840'>is</span> <span m='2987100'>fun</span> <span m='2987430'>with</span>
  <span m='2987610'>augmentation.</span> </p><p><span m='2989200'>Why</span> <span
  m='2989530'>do</span> <span m='2989680'>I</span> <span m='2989800'>do</span> <span
  m='2990010'>all</span> <span m='2990190'>that?</span> <span m='2991680'>Because</span>
  <span m='2995480'>if</span> <span m='2995630'>I</span> <span m='2995750'>store</span>
  <span m='2996080'>all</span> <span m='2996230'>these</span> <span m='2996440'>numbers,</span>
  <span m='2997920'>it</span> <span m='2997940'>becomes</span> <span m='2998330'>really</span>
  <span m='2998570'>easy</span> <span m='2998870'>to</span> <span m='2999050'>detect</span>
  <span m='3000350'>bridges.</span> <span m='3004442'>I</span> <span m='3004938'>claim.</span>
  </p><p><span m='3014858'>AUDIENCE:</span> <span m='3015109'>Professor?</span> </p><p><span
  m='3015360'>ERIK DEMAINE:</span> <span m='3015490'>Yeah?</span> </p><p><span m='3016117'>AUDIENCE:</span>
  <span m='3016365'>So,</span> <span m='3016614'>what</span> <span m='3017111'>we're</span>
  <span m='3017608'>looking</span> <span m='3018105'>for</span> <span m='3018602'>is
  basically</span> <span m='3019099'>we</span> <span m='3019596'>know</span> <span
  m='3020093'>how</span> <span m='3020590'>the</span> <span m='3021087'>cascade</span>
  <span m='3021584'>went</span> <span m='3022081'>in</span> <span m='3022578'>any</span>
  <span m='3023075'>given--</span> </p><p><span m='3024070'>ERIK DEMAINE:</span> <span
  m='3024145'>We</span> <span m='3024220'>want</span> <span m='3024370'>to</span>
  <span m='3024460'>compute</span> <span m='3025060'>how</span> <span m='3025360'>one</span>
  <span m='3025480'>of</span> <span m='3025540'>these</span> <span m='3025720'>cascades</span>
  <span m='3026290'>will</span> <span m='3026440'>end.</span> </p><p><span m='3026670'>AUDIENCE:</span>
  <span m='3026886'>And</span> <span m='3027102'>so we</span> <span m='3027534'>just</span>
  <span m='3027966'>always</span> <span m='3028398'>maintain</span> <span m='3028830'>that</span>
  <span m='3029262'>information?</span> </p><p><span m='3029700'>ERIK DEMAINE:</span>
  <span m='3029740'>We're</span> <span m='3029780'>always</span> <span m='3029950'>going</span>
  <span m='3030100'>to</span> <span m='3030190'>maintain</span> <span m='3030580'>what's</span>
  <span m='3030790'>here.</span> <span m='3031700'>We</span> <span m='3032110'>can't</span>
  <span m='3032410'>afford</span> <span m='3032680'>to</span> <span m='3032770'>maintain</span>
  <span m='3033100'>this</span> <span m='3033250'>whole</span> <span m='3033400'>picture</span>
  <span m='3033820'>because</span> <span m='3034120'>it</span> <span m='3034180'>changes</span>
  <span m='3034570'>too</span> <span m='3034720'>much.</span> <span m='3035800'>But</span>
  <span m='3036040'>we</span> <span m='3036250'>want</span> <span m='3036490'>to--</span>
  <span m='3036960'>we're</span> <span m='3037090'>given</span> <span m='3037420'>this.</span>
  <span m='3037720'>We</span> <span m='3037870'>want</span> <span m='3038050'>to</span>
  <span m='3038110'>know</span> <span m='3038290'>the</span> <span m='3038380'>result</span>
  <span m='3038770'>of</span> <span m='3038860'>the</span> <span m='3038950'>cascade,</span>
  <span m='3039520'>without</span> <span m='3039970'>having</span> <span m='3040270'>to</span>
  <span m='3040780'>do</span> <span m='3040960'>all</span> <span m='3041080'>that</span>
  <span m='3041260'>stuff</span> <span m='3041500'>in</span> <span m='3041590'>the</span>
  <span m='3041650'>middle.</span> <span m='3042000'>Yeah,</span> <span m='3042190'>that's</span>
  <span m='3042400'>our</span> <span m='3042490'>goal.</span> <span m='3043530'>And</span>
  <span m='3043660'>I</span> <span m='3043720'>claim--</span> <span m='3044710'>this</span>
  <span m='3044950'>is</span> <span m='3045100'>a</span> <span m='3045190'>lot</span>
  <span m='3045400'>of</span> <span m='3045520'>text.</span> <span m='3046040'>But</span>
  <span m='3046510'>I</span> <span m='3046600'>claim</span> <span m='3046840'>that</span>
  <span m='3046990'>this</span> <span m='3047260'>information</span> <span m='3047800'>is</span>
  <span m='3047920'>enough</span> <span m='3048190'>to</span> <span m='3048310'>do</span>
  <span m='3048430'>that</span> <span m='3048690'>in</span> <span m='3048770'>log</span>
  <span m='3049030'>n</span> <span m='3049180'>time.</span> <span m='3050200'>So</span>
  <span m='3050350'>let</span> <span m='3050530'>me</span> <span m='3051400'>try</span>
  <span m='3051580'>to</span> <span m='3051670'>convince</span> <span m='3051970'>you.</span>
  </p><p><span m='3052620'>AUDIENCE:</span> <span m='3052870'>So</span> <span m='3053120'>are
  you storing</span> <span m='3053620'>several</span> <span m='3054120'>binary</span>
  <span m='3054620'>searches?</span> </p><p><span m='3055470'>ERIK DEMAINE:</span>
  <span m='3055565'>I'm</span> <span m='3055660'>storing</span> <span m='3056260'>three.</span>
  <span m='3057960'>I'm</span> <span m='3058090'>storing</span> <span m='3058450'>one</span>
  <span m='3058660'>that</span> <span m='3058750'>represents</span> <span m='3059170'>the</span>
  <span m='3059290'>final</span> <span m='3059590'>result.</span> <span m='3060370'>I'm</span>
  <span m='3060490'>storing</span> <span m='3060780'>one</span> <span m='3061210'>that's</span>
  <span m='3061540'>just</span> <span m='3061900'>looking</span> <span m='3062200'>at</span>
  <span m='3062320'>the</span> <span m='3062380'>insertions.</span> <span m='3062920'>I'm</span>
  <span m='3063090'>storing</span> <span m='3063370'>one</span> <span m='3063580'>that</span>
  <span m='3063670'>looks</span> <span m='3063910'>at</span> <span m='3064000'>all</span>
  <span m='3064150'>the</span> <span m='3064270'>updates.</span> <span m='3065360'>I</span>
  <span m='3065420'>maintain</span> <span m='3065830'>all</span> <span m='3065980'>three,</span>
  <span m='3066250'>and</span> <span m='3066340'>you</span> <span m='3066430'>can</span>
  <span m='3066550'>cross-link</span> <span m='3067090'>them</span> <span m='3067780'>all</span>
  <span m='3067960'>you</span> <span m='3068080'>want.</span> </p><p><span m='3070700'>OK,</span>
  <span m='3071920'>I</span> <span m='3072100'>claim</span> <span m='3073210'>a</span>
  <span m='3073420'>bridge</span> <span m='3076270'>is</span> <span m='3076540'>now</span>
  <span m='3077560'>a</span> <span m='3077680'>prefix</span> <span m='3078910'>of</span>
  <span m='3079480'>updates</span> <span m='3082820'>summing</span> <span m='3083410'>to</span>
  <span m='3083560'>zero,</span> <span m='3087280'>according</span> <span m='3087670'>to</span>
  <span m='3087910'>this</span> <span m='3088150'>measure.</span> <span m='3090250'>Because</span>
  <span m='3090880'>inserts</span> <span m='3091390'>and</span> <span m='3091510'>deletes,</span>
  <span m='3092620'>when</span> <span m='3092770'>they</span> <span m='3092890'>all</span>
  <span m='3093040'>cancel</span> <span m='3093490'>out--</span> <span m='3093730'>and</span>
  <span m='3093940'>if</span> <span m='3094090'>we</span> <span m='3094180'>ignore</span>
  <span m='3094450'>the</span> <span m='3094570'>things</span> <span m='3094840'>that</span>
  <span m='3094960'>finally</span> <span m='3095380'>end</span> <span m='3095560'>up</span>
  <span m='3095710'>there,</span> <span m='3097990'>the</span> <span m='3098140'>periods</span>
  <span m='3098560'>of</span> <span m='3098710'>rest,</span> <span m='3100060'>when</span>
  <span m='3100210'>no</span> <span m='3100420'>one</span> <span m='3100570'>is</span>
  <span m='3100720'>active</span> <span m='3101200'>that</span> <span m='3101320'>will</span>
  <span m='3101500'>eventually</span> <span m='3101890'>get</span> <span m='3102040'>deleted,</span>
  <span m='3102820'>that's</span> <span m='3103030'>exactly</span> <span m='3103450'>when</span>
  <span m='3104170'>everyone</span> <span m='3104590'>to</span> <span m='3104680'>the</span>
  <span m='3104800'>left</span> <span m='3105250'>has</span> <span m='3105520'>been</span>
  <span m='3105970'>deleted</span> <span m='3106420'>or</span> <span m='3106600'>will</span>
  <span m='3106750'>survive</span> <span m='3107140'>to</span> <span m='3107260'>the</span>
  <span m='3107380'>end.</span> <span m='3108080'>So</span> <span m='3108100'>these</span>
  <span m='3108280'>guys</span> <span m='3108490'>counts as</span> <span m='3108880'>zeros,</span>
  <span m='3110220'>so</span> <span m='3110380'>we</span> <span m='3110590'>ignore</span>
  <span m='3110950'>those.</span> <span m='3112570'>Each</span> <span m='3112780'>of</span>
  <span m='3112840'>these</span> <span m='3113050'>corresponds</span> <span m='3113470'>to</span>
  <span m='3113590'>plus</span> <span m='3113890'>1.</span> <span m='3114040'>Each</span>
  <span m='3114160'>of</span> <span m='3114220'>these</span> <span m='3114370'>corresponds</span>
  <span m='3114820'>to</span> <span m='3114910'>a</span> <span m='3114970'>minus 1.</span>
  <span m='3115980'>So</span> <span m='3116320'>these</span> <span m='3116620'>have</span>
  <span m='3116740'>all</span> <span m='3116920'>canceled</span> <span m='3117340'>out</span>
  <span m='3117610'>by</span> <span m='3117730'>now.</span> <span m='3118460'>And</span>
  <span m='3118540'>when</span> <span m='3118750'>this</span> <span m='3119260'>prefix</span>
  <span m='3119515'>sum,</span> <span m='3120080'>which</span> <span m='3120160'>is</span>
  <span m='3120250'>everything</span> <span m='3120670'>up</span> <span m='3120790'>to</span>
  <span m='3120970'>a</span> <span m='3121030'>given</span> <span m='3121300'>point,</span>
  <span m='3121960'>is</span> <span m='3122050'>zero,</span> <span m='3123010'>then</span>
  <span m='3123760'>that</span> <span m='3123970'>is</span> <span m='3124060'>a</span>
  <span m='3124120'>bridge.</span> </p><p><span m='3125170'>What</span> <span m='3125350'>this</span>
  <span m='3125500'>lets</span> <span m='3125710'>you</span> <span m='3125800'>do</span>
  <span m='3126520'>is</span> <span m='3126640'>if</span> <span m='3126760'>you</span>
  <span m='3126880'>have</span> <span m='3127150'>some--</span> <span m='3129700'>you</span>
  <span m='3129790'>have</span> <span m='3130000'>this</span> <span m='3130750'>binary</span>
  <span m='3131050'>search</span> <span m='3131350'>tree.</span> <span m='3132070'>You</span>
  <span m='3132160'>have</span> <span m='3132340'>some</span> <span m='3132530'>query</span>
  <span m='3132820'>time</span> <span m='3133150'>t,</span> <span m='3133550'>which</span>
  <span m='3133630'>corresponds</span> <span m='3134110'>to</span> <span m='3134230'>a</span>
  <span m='3134290'>leaf.</span> <span m='3135160'>And</span> <span m='3135310'>now
  I</span> <span m='3135460'>want</span> <span m='3135640'>to</span> <span m='3135700'>know</span>
  <span m='3136330'>what</span> <span m='3136660'>is</span> <span m='3136960'>the</span>
  <span m='3137110'>preceding</span> <span m='3137920'>bridge?</span> <span m='3138490'>I</span>
  <span m='3138580'>want</span> <span m='3138760'>to</span> <span m='3138820'>know</span>
  <span m='3138970'>t</span> <span m='3139180'>prime,</span> <span m='3139930'>the</span>
  <span m='3140020'>bridge</span> <span m='3140260'>proceeding</span> <span m='3140710'>time</span>
  <span m='3140980'>t.</span> <span m='3142150'>Then</span> <span m='3142420'>basically</span>
  <span m='3142750'>I</span> <span m='3142840'>walk</span> <span m='3143230'>up</span>
  <span m='3143350'>this</span> <span m='3143560'>tree</span> <span m='3144820'>and</span>
  <span m='3144970'>find</span> <span m='3145300'>the</span> <span m='3145420'>preceding</span>
  <span m='3146020'>moments--</span> <span m='3146700'>I</span> <span m='3146740'>actually</span>
  <span m='3147100'>have</span> <span m='3147220'>to</span> <span m='3147340'>first</span>
  <span m='3147580'>walk</span> <span m='3147820'>down</span> <span m='3148090'>to</span>
  <span m='3148180'>compute</span> <span m='3148900'>all</span> <span m='3149080'>the</span>
  <span m='3149170'>sums.</span> </p><p><span m='3150520'>So</span> <span m='3150700'>hanging</span>
  <span m='3151090'>off</span> <span m='3151480'>on</span> <span m='3151600'>the</span>
  <span m='3151690'>left</span> <span m='3152020'>of</span> <span m='3152110'>this</span>
  <span m='3152260'>path</span> <span m='3153520'>are</span> <span m='3153880'>all</span>
  <span m='3154060'>these</span> <span m='3154870'>times</span> <span m='3155770'>in</span>
  <span m='3155860'>the</span> <span m='3155950'>past.</span> <span m='3156895'>And</span>
  <span m='3157180'>I</span> <span m='3157300'>say</span> <span m='3157570'>well,</span>
  <span m='3157960'>if</span> <span m='3158170'>the</span> <span m='3158300'>sum</span>
  <span m='3158650'>of</span> <span m='3158770'>all</span> <span m='3159010'>of</span>
  <span m='3159130'>those</span> <span m='3160770'>subtree</span> <span m='3161180'>sums,</span>
  <span m='3162130'>sum</span> <span m='3162400'>of</span> <span m='3162520'>all</span>
  <span m='3162670'>the</span> <span m='3162730'>values</span> <span m='3163060'>in</span>
  <span m='3163150'>those</span> <span m='3163300'>leaves,</span> <span m='3163480'>if</span>
  <span m='3163600'>that's</span> <span m='3163770'>0</span> <span m='3164140'>then</span>
  <span m='3164290'>we're</span> <span m='3164440'>already</span> <span m='3164890'>at</span>
  <span m='3165610'>a</span> <span m='3166390'>bridge.</span> <span m='3166990'>If</span>
  <span m='3167170'>not,</span> <span m='3167890'>I</span> <span m='3168010'>basically</span>
  <span m='3168340'>compute</span> <span m='3168700'>the</span> <span m='3168820'>preceding</span>
  <span m='3169450'>point</span> <span m='3169810'>where</span> <span m='3169990'>this</span>
  <span m='3170410'>sum</span> <span m='3170800'>up</span> <span m='3170950'>to</span>
  <span m='3171040'>that</span> <span m='3171190'>point</span> <span m='3171430'>is</span>
  <span m='3171550'>0.</span> <span m='3172820'>And</span> <span m='3173170'>that</span>
  <span m='3173350'>should</span> <span m='3173530'>be</span> <span m='3173680'>relatively</span>
  <span m='3174220'>obvious</span> <span m='3174520'>how</span> <span m='3174610'>to</span>
  <span m='3174700'>do.</span> <span m='3174940'>It's</span> <span m='3175120'>a</span>
  <span m='3175330'>regular</span> <span m='3175780'>kind</span> <span m='3175990'>of</span>
  <span m='3176470'>walking</span> <span m='3176860'>up</span> <span m='3176980'>the</span>
  <span m='3177100'>tree.</span> </p><p><span m='3178300'>So</span> <span m='3178500'>log</span>
  <span m='3178810'>n</span> <span m='3178960'>time</span> <span m='3181210'>I</span>
  <span m='3181300'>can</span> <span m='3181450'>find</span> <span m='3181690'>the</span>
  <span m='3181780'>preceding</span> <span m='3182210'>bridge.</span> <span m='3187450'>Because</span>
  <span m='3187810'>I</span> <span m='3187870'>have</span> <span m='3188080'>all</span>
  <span m='3188230'>these</span> <span m='3188370'>subtrees</span> <span m='3188770'>sums</span>
  <span m='3189790'>I</span> <span m='3189910'>can</span> <span m='3191410'>do</span>
  <span m='3191560'>that</span> <span m='3196380'>by</span> <span m='3196540'>a</span>
  <span m='3196600'>tree</span> <span m='3196810'>walk.</span> </p><p><span m='3199300'>OK,</span>
  <span m='3202540'>then</span> <span m='3202960'>it</span> <span m='3203080'>just</span>
  <span m='3203230'>says</span> <span m='3203440'>here,</span> <span m='3203920'>"And</span>
  <span m='3204070'>then</span> <span m='3204250'>you</span> <span m='3204370'>can</span>
  <span m='3204490'>compute</span> <span m='3204850'>the</span> <span m='3204970'>change</span>
  <span m='3205300'>to</span> <span m='3205390'>Qnow."</span> <span m='3206440'>How</span>
  <span m='3206560'>do</span> <span m='3206680'>we</span> <span m='3206830'>compute</span>
  <span m='3207310'>the</span> <span m='3207400'>change</span> <span m='3207730'>to</span>
  <span m='3207820'>Qnow?</span> <span m='3209410'>We</span> <span m='3209560'>have</span>
  <span m='3209710'>to</span> <span m='3209800'>compute</span> <span m='3210100'>this</span>
  <span m='3210280'>max</span> <span m='3212020'>of</span> <span m='3212170'>all</span>
  <span m='3212410'>the</span> <span m='3212530'>keys</span> <span m='3212950'>that</span>
  <span m='3213040'>are</span> <span m='3213100'>inserted</span> <span m='3213550'>after</span>
  <span m='3214030'>time</span> <span m='3214420'>t</span> <span m='3214630'>prime.</span>
  </p><p><span m='3216230'>So</span> <span m='3216430'>this</span> <span m='3216670'>was</span>
  <span m='3216940'>the</span> <span m='3217120'>tree</span> <span m='3217540'>of</span>
  <span m='3217870'>all</span> <span m='3218200'>updates.</span> <span m='3221290'>And</span>
  <span m='3221560'>we</span> <span m='3221650'>have</span> <span m='3221800'>another</span>
  <span m='3222100'>tree,</span> <span m='3222610'>which</span> <span m='3222820'>is</span>
  <span m='3222940'>just</span> <span m='3223210'>the</span> <span m='3223330'>tree</span>
  <span m='3223600'>of</span> <span m='3223690'>insertions.</span> <span m='3226780'>And</span>
  <span m='3226960'>so</span> <span m='3227290'>if</span> <span m='3227760'>we</span>
  <span m='3227890'>cross-link</span> <span m='3228430'>time--</span> <span m='3228730'>so</span>
  <span m='3228880'>we</span> <span m='3229000'>find</span> <span m='3229960'>t</span>
  <span m='3230140'>prime,</span> <span m='3230650'>where</span> <span m='3230920'>the</span>
  <span m='3231130'>prefix</span> <span m='3231520'>sum</span> <span m='3232150'>is</span>
  <span m='3232270'>zero.</span> <span m='3233200'>We</span> <span m='3233500'>map</span>
  <span m='3233890'>over</span> <span m='3234160'>to</span> <span m='3234310'>t</span>
  <span m='3234490'>prime</span> <span m='3234850'>here.</span> <span m='3236260'>And</span>
  <span m='3236410'>again</span> <span m='3236650'>we</span> <span m='3236770'>get</span>
  <span m='3236950'>a</span> <span m='3237070'>root</span> <span m='3237170'>to</span>
  <span m='3237340'>leaf</span> <span m='3237520'>path.</span> <span m='3238210'>And</span>
  <span m='3238330'>now</span> <span m='3238600'>we</span> <span m='3238690'>look</span>
  <span m='3238930'>at</span> <span m='3239080'>all</span> <span m='3239320'>of</span>
  <span m='3239440'>the</span> <span m='3239560'>elements</span> <span m='3240040'>hanging</span>
  <span m='3240370'>off</span> <span m='3240490'>the</span> <span m='3240580'>right</span>
  <span m='3240760'>side.</span> <span m='3243370'>Those</span> <span m='3243640'>are</span>
  <span m='3243760'>all</span> <span m='3243940'>the</span> <span m='3244060'>elements</span>
  <span m='3244360'>that</span> <span m='3244480'>are</span> <span m='3244540'>inserted</span>
  <span m='3244930'>after</span> <span m='3245290'>time</span> <span m='3245530'>t</span>
  <span m='3245680'>prime.</span> <span m='3246430'>And</span> <span m='3246780'>I
  just</span> <span m='3246910'>take</span> <span m='3247060'>the</span> <span m='3247160'>max</span>
  <span m='3247420'>of</span> <span m='3247510'>those.</span> </p><p><span m='3247870'>So</span>
  <span m='3248020'>I</span> <span m='3248080'>guess</span> <span m='3248410'>I</span>
  <span m='3248500'>didn't</span> <span m='3248680'>write</span> <span m='3248890'>it,</span>
  <span m='3248990'>but</span> <span m='3249130'>I</span> <span m='3249190'>need</span>
  <span m='3249370'>to</span> <span m='3249490'>store our</span> <span m='3249820'>subtree--</span>
  <span m='3250760'>oh no,</span> <span m='3250950'>I</span> <span m='3251290'>store</span>
  <span m='3251530'>this.</span> <span m='3252190'>Right,</span> <span m='3252400'>this</span>
  <span m='3252580'>is</span> <span m='3252670'>what</span> <span m='3252790'>I</span>
  <span m='3252880'>want.</span> <span m='3253780'>For</span> <span m='3254020'>every</span>
  <span m='3254260'>subtree,</span> <span m='3254650'>I</span> <span m='3254710'>want</span>
  <span m='3254870'>to</span> <span m='3254910'>know</span> <span m='3254990'>the</span>
  <span m='3255130'>max</span> <span m='3255490'>of</span> <span m='3255580'>the</span>
  <span m='3255670'>things</span> <span m='3255950'>in that</span> <span m='3256060'>subtree,</span>
  <span m='3256450'>but</span> <span m='3256570'>ignoring</span> <span m='3257050'>the</span>
  <span m='3257140'>guys</span> <span m='3257470'>that</span> <span m='3257590'>are</span>
  <span m='3257680'>in</span> <span m='3257870'>Qnow.</span> </p><p><span m='3260680'>I</span>
  <span m='3261010'>take</span> <span m='3261220'>all</span> <span m='3261310'>those</span>
  <span m='3261490'>maxes</span> <span m='3262970'>on</span> <span m='3263190'>all</span>
  <span m='3263290'>those</span> <span m='3263410'>subtrees.</span> <span m='3265550'>And</span>
  <span m='3265840'>I</span> <span m='3265930'>can</span> <span m='3266110'>find</span>
  <span m='3268210'>what</span> <span m='3268870'>element</span> <span m='3269290'>gets</span>
  <span m='3270190'>inserted</span> <span m='3272620'>into</span> <span m='3272980'>Qnow</span>
  <span m='3275620'>in</span> <span m='3275800'>log</span> <span m='3276090'>n</span>
  <span m='3276190'>time.</span> <span m='3277360'>Then,</span> <span m='3277510'>of</span>
  <span m='3277630'>course,</span> <span m='3277840'>I</span> <span m='3277900'>have</span>
  <span m='3278020'>to</span> <span m='3278110'>update</span> <span m='3278440'>all</span>
  <span m='3278560'>this</span> <span m='3278710'>information.</span> <span m='3279450'>And
  I</span> <span m='3279550'>don't</span> <span m='3279700'>want</span> <span m='3279860'>to</span>
  <span m='3280480'>spend</span> <span m='3280780'>any</span> <span m='3280960'>more</span>
  <span m='3281140'>time</span> <span m='3281830'>on</span> <span m='3281980'>this,</span>
  <span m='3282190'>no</span> <span m='3282340'>pun</span> <span m='3282550'>intended.</span>
  <span m='3284170'>You</span> <span m='3284320'>have</span> <span m='3284530'>to--</span>
  <span m='3285010'>then</span> <span m='3285280'>Qnow</span> <span m='3285670'>changes.</span>
  <span m='3286750'>And</span> <span m='3286840'>so</span> <span m='3286930'>you've</span>
  <span m='3287050'>got</span> <span m='3287170'>to</span> <span m='3287890'>update</span>
  <span m='3288190'>all</span> <span m='3288340'>these</span> <span m='3288550'>values</span>
  <span m='3289150'>and</span> <span m='3289240'>these</span> <span m='3289450'>values.</span>
  <span m='3290560'>But</span> <span m='3290710'>the</span> <span m='3290800'>claim</span>
  <span m='3291040'>is</span> <span m='3291400'>that</span> <span m='3291700'>you</span>
  <span m='3291910'>can</span> <span m='3292000'>do</span> <span m='3292150'>all</span>
  <span m='3292240'>that</span> <span m='3292420'>in</span> <span m='3292520'>log</span>
  <span m='3292620'>n</span> <span m='3292810'>time.</span> <span m='3293830'>It's</span>
  <span m='3293950'>not</span> <span m='3294130'>hard.</span> </p><p><span m='3296730'>OK,</span>
  <span m='3297000'>that's</span> <span m='3297240'>priority</span> <span m='3297660'>queues.</span>
  <span m='3298380'>So</span> <span m='3298530'>I</span> <span m='3298650'>know</span>
  <span m='3298770'>that was</span> <span m='3298980'>a</span> <span m='3299010'>little</span>
  <span m='3299220'>bit</span> <span m='3299340'>tedious.</span> <span m='3300450'>But</span>
  <span m='3300690'>this</span> <span m='3300930'>is</span> <span m='3300990'>sort</span>
  <span m='3301200'>of--</span> <span m='3302910'>it's not</span> <span m='3303090'>quite</span>
  <span m='3303330'>the</span> <span m='3303570'>coolest</span> <span m='3303960'>thing</span>
  <span m='3304140'>we</span> <span m='3304230'>know</span> <span m='3304350'>how</span>
  <span m='3304470'>to</span> <span m='3304560'>do,</span> <span m='3304750'>but</span>
  <span m='3304870'>it</span> <span m='3305480'>was</span> <span m='3305640'>the</span>
  <span m='3305730'>first</span> <span m='3306030'>cool</span> <span m='3306270'>thing</span>
  <span m='3306470'>we</span> <span m='3306570'>knew</span> <span m='3306700'>how</span>
  <span m='3306800'>to</span> <span m='3306870'>do</span> <span m='3307140'>in</span>
  <span m='3307290'>the</span> <span m='3307380'>retroactive</span> <span m='3307950'>world.</span>
  <span m='3308190'>It's</span> <span m='3308370'>this</span> <span m='3308580'>nice</span>
  <span m='3309450'>borderline</span> <span m='3310170'>where</span> <span m='3310700'>it</span>
  <span m='3310800'>looks</span> <span m='3310950'>scary.</span> <span m='3311400'>There</span>
  <span m='3311560'>are</span> <span m='3311670'>linear-sized</span> <span m='3312480'>chain</span>
  <span m='3312690'>reactions.</span> <span m='3313680'>Yet</span> <span m='3313980'>we</span>
  <span m='3314160'>can</span> <span m='3315240'>still</span> <span m='3315630'>deal</span>
  <span m='3315840'>with</span> <span m='3316020'>them</span> <span m='3316230'>in</span>
  <span m='3316330'>log</span> <span m='3316550'>n</span> <span m='3316680'>time.</span>
  <span m='3318840'>So</span> <span m='3319020'>not</span> <span m='3319140'>quite</span>
  <span m='3319350'>the</span> <span m='3319440'>worst</span> <span m='3319620'>case,</span>
  <span m='3319950'>but</span> <span m='3321270'>also</span> <span m='3321570'>not</span>
  <span m='3321810'>easy.</span> </p><p><span m='3324000'>So</span> <span m='3324120'>in</span>
  <span m='3324210'>general,</span> <span m='3324540'>if</span> <span m='3324660'>you</span>
  <span m='3324810'>want</span> <span m='3325290'>a</span> <span m='3325380'>retroactive</span>
  <span m='3325890'>data</span> <span m='3326100'>structure</span> <span m='3326490'>for</span>
  <span m='3326640'>your</span> <span m='3326850'>favorite</span> <span m='3328500'>data</span>
  <span m='3328710'>structure,</span> <span m='3329880'>you're</span> <span m='3330030'>going</span>
  <span m='3330090'>to</span> <span m='3330180'>have</span> <span m='3330270'>to</span>
  <span m='3330330'>think</span> <span m='3330570'>along</span> <span m='3330870'>these</span>
  <span m='3331050'>lines,</span> <span m='3332130'>see</span> <span m='3332340'>whether</span>
  <span m='3332610'>you</span> <span m='3332760'>can</span> <span m='3332910'>maintain</span>
  <span m='3334800'>something</span> <span m='3335160'>reasonable.</span> <span m='3336600'>Let</span>
  <span m='3336720'>me</span> <span m='3336810'>tell</span> <span m='3336960'>you</span>
  <span m='3337050'>briefly</span> <span m='3337470'>about</span> <span m='3337770'>other</span>
  <span m='3338850'>problems,</span> <span m='3341640'>other</span> <span m='3341850'>data</span>
  <span m='3342030'>structures</span> <span m='3342450'>that</span> <span m='3342690'>we've</span>
  <span m='3342990'>looked</span> <span m='3343290'>at,</span> <span m='3343780'>and</span>
  <span m='3343890'>other</span> <span m='3344100'>people</span> <span m='3344340'>have</span>
  <span m='3344430'>looked</span> <span m='3344640'>at.</span> </p><p><span m='3350140'>So</span>
  <span m='3350200'>a</span> <span m='3350250'>simple</span> <span m='3350550'>one</span>
  <span m='3350730'>is</span> <span m='3350850'>a</span> <span m='3350970'>queue,</span>
  <span m='3353700'>first</span> <span m='3354030'>in,</span> <span m='3354220'>first</span>
  <span m='3354390'>out</span> <span m='3355430'>first</span> <span m='3355680'>in,</span>
  <span m='3355830'>last</span> <span m='3356160'>out.</span> <span m='3356690'>One</span>
  <span m='3356900'>of those.</span> <span m='3358020'>I've</span> <span m='3358140'>got</span>
  <span m='3358320'>stacks</span> <span m='3358710'>too,</span> <span m='3358950'>probably.</span>
  <span m='3360390'>You</span> <span m='3360600'>can</span> <span m='3360750'>do</span>
  <span m='3360870'>constant time</span> <span m='3361500'>partial</span> <span m='3361860'>retroactivity.</span>
  <span m='3363780'>Log</span> <span m='3365160'>n</span> <span m='3365260'>time</span>
  <span m='3365700'>full</span> <span m='3366000'>retroactivity</span> <span m='3368280'>for</span>
  <span m='3368760'>a</span> <span m='3369660'>deque.</span> <span m='3370140'>I</span>
  <span m='3370170'>mentioned</span> <span m='3370470'>this</span> <span m='3370590'>last</span>
  <span m='3370830'>time</span> <span m='3371070'>where</span> <span m='3371160'>you</span>
  <span m='3371250'>can</span> <span m='3371370'>insert</span> <span m='3371670'>and</span>
  <span m='3371760'>delete</span> <span m='3372000'>from</span> <span m='3372210'>either</span>
  <span m='3372510'>end.</span> <span m='3373680'>We</span> <span m='3373890'>can</span>
  <span m='3374040'>do</span> <span m='3374830'>log</span> <span m='3375450'>n</span>
  <span m='3375900'>full</span> <span m='3376290'>retroactivity</span> <span m='3378600'>for</span>
  <span m='3380510'>union-find.</span> </p><p><span m='3384360'>You</span> <span m='3384480'>have</span>
  <span m='3384660'>a</span> <span m='3384720'>bunch</span> <span m='3384990'>of</span>
  <span m='3385050'>sets.</span> <span m='3385440'>You</span> <span m='3385500'>want</span>
  <span m='3385680'>to</span> <span m='3385740'>be</span> <span m='3385800'>able</span>
  <span m='3385950'>to</span> <span m='3386010'>take</span> <span m='3386220'>their</span>
  <span m='3386340'>union.</span> <span m='3386790'>And</span> <span m='3386910'>given</span>
  <span m='3387150'>an</span> <span m='3387270'>element</span> <span m='3387570'>you</span>
  <span m='3387630'>want</span> <span m='3387780'>to</span> <span m='3387870'>know</span>
  <span m='3388110'>which</span> <span m='3388680'>set</span> <span m='3388950'>it's</span>
  <span m='3389100'>in.</span> <span m='3389380'>It's</span> <span m='3389730'>sometimes</span>
  <span m='3390110'>taught</span> <span m='3390490'>in</span> <span m='3390650'>6046.</span>
  </p><p><span m='3392980'>The</span> <span m='3393060'>best</span> <span m='3393270'>thing</span>
  <span m='3393450'>we</span> <span m='3393540'>know</span> <span m='3393810'>is</span>
  <span m='3395250'>log</span> <span m='3395680'>m</span> <span m='3396750'>fully</span>
  <span m='3397230'>retroactive.</span> <span m='3401970'>Priority</span> <span m='3402500'>queue</span>
  <span m='3402690'>we</span> <span m='3402810'>already</span> <span m='3402990'>talked</span>
  <span m='3403290'>about.</span> <span m='3404180'>But--</span> </p><p><span m='3404350'>AUDIENCE:</span>
  <span m='3404575'>[INAUDIBLE]</span> </p><p><span m='3406150'>ERIK DEMAINE:</span>
  <span m='3406200'>Is</span> <span m='3406250'>there</span> <span m='3406680'>a</span>
  <span m='3406740'>question?</span> <span m='3409565'>Priority</span> <span m='3409830'>queue,</span>
  <span m='3410070'>we</span> <span m='3410220'>already</span> <span m='3410400'>did</span>
  <span m='3410760'>partial</span> <span m='3411240'>retroactivity.</span> <span m='3411900'>But</span>
  <span m='3412020'>what</span> <span m='3412200'>if</span> <span m='3412290'>you</span>
  <span m='3412380'>want</span> <span m='3412560'>full</span> <span m='3412800'>retroactivity?</span>
  <span m='3413520'>This</span> <span m='3413730'>is</span> <span m='3413850'>pretty</span>
  <span m='3414090'>much</span> <span m='3414300'>an</span> <span m='3414390'>open</span>
  <span m='3414660'>problem.</span> <span m='3415550'>Best</span> <span m='3415800'>thing</span>
  <span m='3415980'>we</span> <span m='3416070'>know</span> <span m='3416820'>is</span>
  <span m='3417000'>square</span> <span m='3417360'>root</span> <span m='3417510'>of</span>
  <span m='3417610'>m</span> <span m='3418470'>to m's</span> <span m='3418750'>log
  n.</span> <span m='3419700'>This</span> <span m='3419910'>is</span> <span m='3420060'>via--</span>
  <span m='3420840'>we</span> <span m='3420960'>have</span> <span m='3421110'>a</span>
  <span m='3421200'>general</span> <span m='3421530'>result</span> <span m='3421860'>that</span>
  <span m='3421980'>says</span> <span m='3422250'>if</span> <span m='3422310'>you</span>
  <span m='3422370'>have</span> <span m='3422490'>anything</span> <span m='3422850'>that's</span>
  <span m='3423000'>partially</span> <span m='3423360'>retroactive,</span> <span m='3423930'>you</span>
  <span m='3424020'>can</span> <span m='3424140'>make</span> <span m='3424350'>it</span>
  <span m='3424440'>fully</span> <span m='3424710'>retroactive</span> <span m='3425580'>at</span>
  <span m='3425730'>a</span> <span m='3425790'>huge</span> <span m='3426180'>cost</span>
  <span m='3426750'>of</span> <span m='3426990'>square root</span> <span m='3427380'>of</span>
  <span m='3427470'>m</span> <span m='3428130'>factor.</span> <span m='3429180'>So</span>
  <span m='3429300'>you</span> <span m='3429360'>could</span> <span m='3429480'>take</span>
  <span m='3429750'>what</span> <span m='3429870'>we</span> <span m='3429960'>have,</span>
  <span m='3430800'>make</span> <span m='3430980'>it</span> <span m='3431040'>fully</span>
  <span m='3431250'>retroactive.</span> <span m='3432560'>Full.</span> </p><p><span
  m='3433780'>AUDIENCE:</span> <span m='3433936'>Is</span> <span m='3434092'>there</span>
  <span m='3434250'>any</span> <span m='3435190'>difference</span> <span m='3435660'>when</span>
  <span m='3436130'>you're talking</span> <span m='3436600'>about n</span> <span m='3437070'>[INAUDIBLE]</span>
  </p><p><span m='3439890'>ERIK DEMAINE:</span> <span m='3440040'>n,</span> <span
  m='3440190'>I</span> <span m='3440310'>think</span> <span m='3440490'>it's</span>
  <span m='3440610'>supposed</span> <span m='3440970'>to</span> <span m='3441060'>be</span>
  <span m='3441330'>the</span> <span m='3443190'>current</span> <span m='3443610'>size</span>
  <span m='3443880'>of</span> <span m='3443940'>the</span> <span m='3444030'>data</span>
  <span m='3444270'>structure.</span> <span m='3445490'>I'm not</span> <span m='3445860'>actually</span>
  <span m='3446220'>sure</span> <span m='3446370'>what</span> <span m='3446490'>that</span>
  <span m='3446640'>means</span> <span m='3446880'>with</span> <span m='3447020'>a</span>
  <span m='3447090'>retroactive</span> <span m='3447630'>operation.</span> <span m='3448110'>I'll</span>
  <span m='3448170'>just</span> <span m='3448320'>make</span> <span m='3448470'>them</span>
  <span m='3448590'>all</span> <span m='3448800'>m's.</span> <span m='3450510'>I</span>
  <span m='3450750'>think</span> <span m='3450930'>that's</span> <span m='3451110'>safer.</span>
  <span m='3453250'>Other</span> <span m='3453390'>question</span> <span m='3453720'>or</span>
  <span m='3453840'>same</span> <span m='3454050'>one?</span> <span m='3454730'>OK</span>
  <span m='3454890'>good,</span> <span m='3455970'>thank</span> <span m='3456180'>you.</span>
  </p><p><span m='3458780'>OK,</span> <span m='3459120'>let</span> <span m='3459300'>me</span>
  <span m='3459420'>tell</span> <span m='3459660'>you</span> <span m='3460020'>about</span>
  <span m='3460350'>the</span> <span m='3460440'>most</span> <span m='3460680'>important</span>
  <span m='3461040'>problem</span> <span m='3461340'>in</span> <span m='3461460'>this</span>
  <span m='3461560'>field.</span> <span m='3464730'>This</span> <span m='3464940'>is</span>
  <span m='3465030'>actually</span> <span m='3465390'>what</span> <span m='3465540'>motivated</span>
  <span m='3466200'>us</span> <span m='3466440'>to</span> <span m='3466740'>define</span>
  <span m='3467850'>retroactivity,</span> <span m='3469380'>which</span> <span m='3469590'>is</span>
  <span m='3469680'>a</span> <span m='3469740'>particular</span> <span m='3470090'>problem,</span>
  <span m='3470310'>retroactive</span> <span m='3470940'>successor.</span> <span m='3471750'>So</span>
  <span m='3471900'>successor</span> <span m='3472410'>problem</span> <span m='3472830'>is</span>
  <span m='3474030'>I</span> <span m='3474210'>want</span> <span m='3474360'>to</span>
  <span m='3474450'>be</span> <span m='3474510'>able</span> <span m='3474630'>to</span>
  <span m='3474690'>insert</span> <span m='3474970'>and</span> <span m='3475070'>delete</span>
  <span m='3476040'>keys</span> <span m='3477330'>in</span> <span m='3477570'>one</span>
  <span m='3477750'>dimension.</span> <span m='3478500'>And</span> <span m='3478770'>given</span>
  <span m='3479100'>a</span> <span m='3479250'>query</span> <span m='3479730'>key,</span>
  <span m='3480180'>I</span> <span m='3480300'>want</span> <span m='3480480'>to</span>
  <span m='3480540'>know</span> <span m='3480690'>what</span> <span m='3480900'>is</span>
  <span m='3481050'>the</span> <span m='3481170'>next</span> <span m='3481470'>key</span>
  <span m='3481680'>greater</span> <span m='3481950'>or</span> <span m='3482020'>equal</span>
  <span m='3482190'>to</span> <span m='3482340'>it.</span> <span m='3482640'>This</span>
  <span m='3482790'>is</span> <span m='3482880'>something</span> <span m='3483180'>you</span>
  <span m='3483240'>can</span> <span m='3483360'>do</span> <span m='3483570'>in</span>
  <span m='3483660'>log</span> <span m='3483900'>n</span> <span m='3484020'>time</span>
  <span m='3484860'>with</span> <span m='3485010'>a</span> <span m='3485040'>balanced</span>
  <span m='3485340'>binary</span> <span m='3485580'>search</span> <span m='3485850'>tree.</span>
  <span m='3486930'>There's</span> <span m='3487110'>lots</span> <span m='3487290'>of</span>
  <span m='3487380'>other</span> <span m='3487500'>ways</span> <span m='3487680'>to</span>
  <span m='3487770'>do</span> <span m='3487920'>it,</span> <span m='3488080'>which</span>
  <span m='3488160'>we</span> <span m='3488210'>will</span> <span m='3488340'>get</span>
  <span m='3488490'>to</span> <span m='3488670'>later</span> <span m='3488910'>in</span>
  <span m='3488970'>this</span> <span m='3489120'>class.</span> </p><p><span m='3490050'>But</span>
  <span m='3490170'>what</span> <span m='3490300'>if</span> <span m='3490470'>I</span>
  <span m='3490500'>want</span> <span m='3490650'>to</span> <span m='3490710'>do</span>
  <span m='3490860'>it</span> <span m='3490950'>fully</span> <span m='3491280'>retroactive?</span>
  <span m='3493170'>Partially</span> <span m='3493620'>retroactive</span> <span m='3494160'>is</span>
  <span m='3494280'>really</span> <span m='3494640'>easy,</span> <span m='3495420'>because</span>
  <span m='3496590'>this</span> <span m='3496920'>is</span> <span m='3497220'>a</span>
  <span m='3497700'>search</span> <span m='3498000'>problem.</span> <span m='3500100'>So</span>
  <span m='3500220'>I can</span> <span m='3500400'>definitely</span> <span m='3500700'>do</span>
  <span m='3502650'>log</span> <span m='3503070'>m</span> <span m='3504240'>partial</span>
  <span m='3504690'>retroactivity.</span> <span m='3508540'>In</span> <span m='3508560'>fact,</span>
  <span m='3509080'>it</span> <span m='3509100'>is</span> <span m='3509370'>a--</span>
  <span m='3510235'>I</span> <span m='3510690'>just</span> <span m='3510870'>use</span>
  <span m='3511050'>a</span> <span m='3511110'>regular</span> <span m='3511710'>binary</span>
  <span m='3512040'>search</span> <span m='3512310'>tree,</span> <span m='3512460'>or</span>
  <span m='3512520'>whatever.</span> <span m='3513900'>In</span> <span m='3514050'>fact,</span>
  <span m='3514380'>it</span> <span m='3514500'>is</span> <span m='3514740'>a</span>
  <span m='3515850'>decomposable</span> <span m='3516540'>search</span> <span m='3516750'>problem.</span>
  <span m='3517350'>So</span> <span m='3517440'>I get</span> <span m='3517740'>full</span>
  <span m='3517970'>retroactivity,</span> <span m='3518940'>no</span> <span m='3519120'>problem.</span>
  <span m='3519920'>But</span> <span m='3519960'>I</span> <span m='3520050'>pay</span>
  <span m='3520320'>a</span> <span m='3520380'>log</span> <span m='3520650'>factor,</span>
  <span m='3521100'>so</span> <span m='3521280'>I</span> <span m='3521340'>get</span>
  <span m='3521490'>log</span> <span m='3521760'>squared</span> <span m='3522150'>m,</span>
  <span m='3523830'>full</span> <span m='3524140'>retroactivity.</span> </p><p><span
  m='3525870'>And</span> <span m='3525990'>so</span> <span m='3526110'>that's</span>
  <span m='3526320'>where</span> <span m='3526500'>we</span> <span m='3526620'>left</span>
  <span m='3526920'>it,</span> <span m='3529020'>back</span> <span m='3529200'>in</span>
  <span m='3529290'>2003.</span> <span m='3530640'>But</span> <span m='3530820'>there's</span>
  <span m='3531000'>a</span> <span m='3531030'>new</span> <span m='3531180'>result,</span>
  <span m='3532090'>which</span> <span m='3532170'>is</span> <span m='3532290'>that</span>
  <span m='3532410'>you</span> <span m='3532560'>can</span> <span m='3532740'>actually</span>
  <span m='3533040'>get</span> <span m='3533190'>log</span> <span m='3533730'>m</span>
  <span m='3534510'>without</span> <span m='3534810'>the</span> <span m='3534930'>square</span>
  <span m='3535920'>full</span> <span m='3536170'>retroactivity.</span> <span m='3538680'>This</span>
  <span m='3538890'>is</span> <span m='3539040'>a</span> <span m='3539100'>complicated</span>
  <span m='3539640'>result.</span> <span m='3540590'>It's by</span> <span m='3540810'>Goran
  and</span> <span m='3541290'>Kaplan,</span> <span m='3542000'>2009.</span> <span
  m='3543370'>It</span> <span m='3543510'>uses</span> <span m='3544020'>fun</span>
  <span m='3544260'>techniques</span> <span m='3544680'>like</span> <span m='3544980'>fractional</span>
  <span m='3545370'>cascading,</span> <span m='3545880'>which</span> <span m='3546060'>is</span>
  <span m='3546150'>next</span> <span m='3546360'>lecture,</span> <span m='3547260'>and</span>
  <span m='3547650'>van</span> <span m='3547950'>Emde Boas,</span> <span m='3548320'>which</span>
  <span m='3548675'>is</span> <span m='3549030'>lecture</span> <span m='3549450'>11,</span>
  <span m='3551400'>and</span> <span m='3552150'>various</span> <span m='3552480'>other</span>
  <span m='3552660'>tools.</span> </p><p><span m='3554560'>So</span> <span m='3554820'>it's</span>
  <span m='3555090'>a</span> <span m='3555150'>little</span> <span m='3555420'>too</span>
  <span m='3555660'>advanced</span> <span m='3555990'>to</span> <span m='3556110'>cover</span>
  <span m='3556410'>now.</span> <span m='3557790'>But</span> <span m='3558450'>it's</span>
  <span m='3558630'>cool.</span> <span m='3559500'>And</span> <span m='3559650'>it</span>
  <span m='3559700'>has</span> <span m='3559860'>lots</span> <span m='3560040'>of</span>
  <span m='3560130'>applications</span> <span m='3560670'>in</span> <span m='3560770'>geometry,</span>
  <span m='3561450'>which</span> <span m='3561660'>we</span> <span m='3561810'>will</span>
  <span m='3561960'>be</span> <span m='3562080'>talking</span> <span m='3562350'>about</span>
  <span m='3562800'>next</span> <span m='3563010'>class.</span> <span m='3563580'>So</span>
  <span m='3564990'>hold</span> <span m='3565440'>your</span> <span m='3565560'>breath</span>
  <span m='3565860'>for</span> <span m='3565980'>that,</span> <span m='3566280'>I</span>
  <span m='3566370'>guess.</span> <span m='3567790'>Yeah.</span> <span m='3568980'>I</span>
  <span m='3569070'>want</span> <span m='3569220'>to</span> <span m='3569280'>go</span>
  <span m='3569460'>to</span> <span m='3569730'>one</span> <span m='3570030'>last</span>
  <span m='3570330'>topic,</span> <span m='3572470'>which</span> <span m='3572640'>is</span>
  <span m='3572850'>a</span> <span m='3572940'>different</span> <span m='3573360'>kind</span>
  <span m='3573690'>of</span> <span m='3573780'>retro</span> <span m='3574010'>activity</span>
  </p><p><span m='3628330'>Nonoblivious</span> <span m='3629000'>retroactivity</span>
  <span m='3629620'>is</span> <span m='3629720'>introduced</span> <span m='3630910'>by</span>
  <span m='3631160'>Acar,</span> <span m='3631700'>Blelloch,</span> <span m='3632300'>Tangwongsan</span>
  <span m='3633260'>in</span> <span m='3633500'>2007.</span> <span m='3636320'>And</span>
  <span m='3636710'>it's</span> <span m='3636830'>basically</span> <span m='3637430'>answering</span>
  <span m='3637850'>the</span> <span m='3637940'>question</span> <span m='3638900'>"What</span>
  <span m='3639050'>about</span> <span m='3639260'>my</span> <span m='3639410'>queries?"</span>
  <span m='3640610'>So</span> <span m='3641390'>we</span> <span m='3641570'>have</span>
  <span m='3641750'>this</span> <span m='3641960'>timeline</span> <span m='3642680'>of</span>
  <span m='3642860'>updates.</span> <span m='3644720'>And</span> <span m='3646160'>we've</span>
  <span m='3646370'>done</span> <span m='3646820'>various</span> <span m='3647240'>operations</span>
  <span m='3647810'>on</span> <span m='3647960'>our</span> <span m='3648020'>data</span>
  <span m='3648230'>structure,</span> <span m='3650300'>which</span> <span m='3650450'>are</span>
  <span m='3650540'>the</span> <span m='3650660'>updates.</span> <span m='3652010'>And</span>
  <span m='3652280'>we've</span> <span m='3652400'>considered</span> <span m='3652760'>how</span>
  <span m='3652970'>those</span> <span m='3653180'>can</span> <span m='3653300'>be</span>
  <span m='3653420'>changed.</span> <span m='3653840'>And</span> <span m='3653930'>then</span>
  <span m='3654560'>with</span> <span m='3654710'>queries,</span> <span m='3655130'>either</span>
  <span m='3655340'>we're querying</span> <span m='3655730'>at</span> <span m='3655820'>the</span>
  <span m='3655940'>end</span> <span m='3656150'>or</span> <span m='3656210'>querying</span>
  <span m='3656510'>in</span> <span m='3656600'>the</span> <span m='3656660'>middle.</span>
  <span m='3657450'>But</span> <span m='3657470'>we're</span> <span m='3657590'>always</span>
  <span m='3657800'>getting</span> <span m='3658010'>sort of instantaneous,</span>
  <span m='3659240'>as</span> <span m='3659480'>the</span> <span m='3659600'>timeline</span>
  <span m='3660110'>exists</span> <span m='3660470'>right</span> <span m='3660740'>now,</span>
  <span m='3662030'>here's</span> <span m='3663020'>what</span> <span m='3663200'>the</span>
  <span m='3663260'>result</span> <span m='3663560'>of</span> <span m='3663650'>your</span>
  <span m='3663770'>query</span> <span m='3664140'>is.</span> </p><p><span m='3665120'>But</span>
  <span m='3665270'>what</span> <span m='3665420'>if</span> <span m='3665570'>I</span>
  <span m='3665660'>want</span> <span m='3665810'>to</span> <span m='3665990'>do--</span>
  <span m='3667190'>I</span> <span m='3667250'>mean,</span> <span m='3667430'>if</span>
  <span m='3667580'>I</span> <span m='3667670'>really--</span> <span m='3668150'>normally</span>
  <span m='3668540'>when I</span> <span m='3668750'>use</span> <span m='3668960'>a</span>
  <span m='3668990'>data</span> <span m='3669200'>structure,</span> <span m='3670370'>I</span>
  <span m='3670490'>do</span> <span m='3670700'>some</span> <span m='3670940'>updates.</span>
  <span m='3671630'>I</span> <span m='3671720'>do</span> <span m='3671930'>some</span>
  <span m='3672320'>queries.</span> <span m='3673550'>I</span> <span m='3673670'>do</span>
  <span m='3674960'>a</span> <span m='3674990'>combination</span> <span m='3675560'>of</span>
  <span m='3675650'>these</span> <span m='3675830'>things.</span> </p><p><span m='3677030'>And</span>
  <span m='3677480'>to</span> <span m='3677660'>make</span> <span m='3678020'>life</span>
  <span m='3678410'>worse,</span> <span m='3679970'>when</span> <span m='3680150'>I</span>
  <span m='3680210'>do</span> <span m='3680330'>a</span> <span m='3680390'>query,</span>
  <span m='3681320'>the</span> <span m='3681410'>result</span> <span m='3681770'>of</span>
  <span m='3681860'>that</span> <span m='3682010'>query</span> <span m='3682370'>probably</span>
  <span m='3683090'>influences</span> <span m='3683660'>what</span> <span m='3683810'>updates</span>
  <span m='3684170'>I</span> <span m='3684230'>do</span> <span m='3684350'>in</span>
  <span m='3684440'>the</span> <span m='3684530'>future.</span> <span m='3685530'>So</span>
  <span m='3685700'>real</span> <span m='3686180'>use,</span> <span m='3686420'>I'll
  just</span> <span m='3686750'>call</span> <span m='3686930'>that</span> <span m='3687140'>the</span>
  <span m='3687500'>algorithmic</span> <span m='3688060'>use</span> <span m='3688250'>of</span>
  <span m='3688340'>a</span> <span m='3688400'>data</span> <span m='3688610'>structure.</span>
  <span m='3696800'>Results</span> <span m='3697220'>of</span> <span m='3697340'>queries</span>
  <span m='3697790'>influence</span> <span m='3698180'>updates,</span> <span m='3701660'>what</span>
  <span m='3701870'>updates</span> <span m='3702230'>are</span> <span m='3702290'>going</span>
  <span m='3702500'>to</span> <span m='3702620'>do.</span> </p><p><span m='3707370'>OK,</span>
  <span m='3707900'>and</span> <span m='3708010'>now</span> <span m='3708410'>this</span>
  <span m='3709280'>gets</span> <span m='3709520'>a</span> <span m='3709580'>little</span>
  <span m='3709820'>dicey,</span> <span m='3710300'>because</span> <span m='3712010'>what</span>
  <span m='3712580'>does</span> <span m='3712700'>influence</span> <span m='3713180'>mean?</span>
  <span m='3713390'>We</span> <span m='3713720'>don't</span> <span m='3713870'>know,</span>
  <span m='3714230'>because</span> <span m='3714590'>that's</span> <span m='3714890'>the</span>
  <span m='3715040'>user</span> <span m='3715460'>somehow</span> <span m='3716360'>depends</span>
  <span m='3716840'>on</span> <span m='3716990'>these</span> <span m='3717140'>results.</span>
  <span m='3719310'>So</span> <span m='3719590'>nonoblivious</span> <span m='3720230'>retroactivity</span>
  <span m='3720830'>is</span> <span m='3721160'>trying</span> <span m='3721370'>to</span>
  <span m='3721460'>deal</span> <span m='3721760'>with</span> <span m='3721910'>this</span>
  <span m='3722390'>issue.</span> <span m='3722780'>Can</span> <span m='3723080'>we</span>
  <span m='3723200'>get</span> <span m='3723440'>something</span> <span m='3724340'>reasonable?</span>
  </p><p><span m='3725190'>So</span> <span m='3725240'>what</span> <span m='3725330'>we'd</span>
  <span m='3725450'>like</span> <span m='3725630'>to</span> <span m='3725750'>do</span>
  <span m='3725960'>is</span> <span m='3726020'>say,</span> <span m='3726390'>oh</span>
  <span m='3726740'>I</span> <span m='3727070'>now</span> <span m='3727370'>add</span>
  <span m='3727640'>an</span> <span m='3727760'>update</span> <span m='3728120'>over</span>
  <span m='3728330'>here,</span> <span m='3729590'>retroactively.</span> <span m='3730220'>So</span>
  <span m='3730370'>their</span> <span m='3730940'>updates</span> <span m='3731330'>are</span>
  <span m='3731390'>the</span> <span m='3731510'>same,</span> <span m='3732500'>in</span>
  <span m='3732650'>some</span> <span m='3732890'>sense.</span> <span m='3733300'>You</span>
  <span m='3733400'>can</span> <span m='3733460'>retroactively</span> <span m='3734060'>insert</span>
  <span m='3734360'>and</span> <span m='3734450'>delete</span> <span m='3735560'>updates</span>
  <span m='3735980'>and</span> <span m='3736220'>queries</span> <span m='3736800'>now.</span>
  <span m='3738260'>I'd</span> <span m='3738410'>like</span> <span m='3738560'>to</span>
  <span m='3738680'>know</span> <span m='3738890'>well,</span> <span m='3739340'>did</span>
  <span m='3739520'>the</span> <span m='3739610'>result</span> <span m='3739970'>of</span>
  <span m='3740060'>this</span> <span m='3740210'>query</span> <span m='3740540'>change?</span>
  <span m='3741980'>Maybe</span> <span m='3742280'>you</span> <span m='3742400'>can</span>
  <span m='3742580'>show--</span> <span m='3743150'>at</span> <span m='3743270'>the</span>
  <span m='3743390'>data structure</span> <span m='3743840'>level</span> <span m='3744050'>we</span>
  <span m='3744140'>can</span> <span m='3744260'>tell</span> <span m='3744920'>did</span>
  <span m='3745040'>that</span> <span m='3745220'>query</span> <span m='3745490'>result</span>
  <span m='3745790'>change.</span> <span m='3747260'>Maybe</span> <span m='3748220'>this</span>
  <span m='3748430'>one</span> <span m='3748630'>changed,</span> <span m='3749120'>but</span>
  <span m='3749300'>this</span> <span m='3749480'>one</span> <span m='3749630'>did</span>
  <span m='3749750'>not.</span> </p><p><span m='3750980'>What</span> <span m='3751220'>we'd</span>
  <span m='3751340'>like</span> <span m='3751460'>to</span> <span m='3751580'>report</span>
  <span m='3751940'>to</span> <span m='3752090'>the</span> <span m='3752180'>user</span>
  <span m='3752510'>is</span> <span m='3752810'>what</span> <span m='3753020'>is</span>
  <span m='3753140'>the</span> <span m='3753260'>first</span> <span m='3754220'>query</span>
  <span m='3754580'>that</span> <span m='3754730'>changed,</span> <span m='3756080'>because</span>
  <span m='3756260'>that's</span> <span m='3756440'>like</span> <span m='3756590'>the</span>
  <span m='3756680'>first</span> <span m='3757040'>mistake</span> <span m='3757520'>that</span>
  <span m='3757700'>you</span> <span m='3757910'>made.</span> <span m='3758790'>Like</span>
  <span m='3758990'>oh</span> <span m='3759500'>you</span> <span m='3759590'>know,</span>
  <span m='3759680'>retroactively</span> <span m='3760370'>oops</span> <span m='3760640'>I</span>
  <span m='3760790'>should</span> <span m='3761030'>have</span> <span m='3761690'>deposited</span>
  <span m='3762170'>$100</span> <span m='3762770'>back</span> <span m='3763040'>here.</span>
  <span m='3763610'>And</span> <span m='3763820'>then</span> <span m='3764540'>these</span>
  <span m='3764960'>queries</span> <span m='3765380'>which</span> <span m='3765540'>we're</span>
  <span m='3765620'>checking</span> <span m='3766010'>whether</span> <span m='3766250'>the</span>
  <span m='3766340'>balance</span> <span m='3766670'>was</span> <span m='3766790'>positive</span>
  <span m='3767180'>or</span> <span m='3767240'>negative,</span> <span m='3768200'>some</span>
  <span m='3768470'>of</span> <span m='3768530'>their</span> <span m='3768650'>results</span>
  <span m='3768980'>might</span> <span m='3769160'>change,</span> <span m='3769490'>some</span>
  <span m='3769670'>of</span> <span m='3769760'>them</span> <span m='3769880'>might</span>
  <span m='3770060'>not.</span> </p><p><span m='3772130'>If</span> <span m='3772340'>they</span>
  <span m='3772460'>change,</span> <span m='3772850'>then</span> <span m='3773230'>the</span>
  <span m='3773450'>algorithm</span> <span m='3773870'>has</span> <span m='3774080'>to--</span>
  <span m='3774500'>I</span> <span m='3774530'>mean,</span> <span m='3775040'>it</span>
  <span m='3775100'>doesn't</span> <span m='3775310'>have</span> <span m='3775430'>to</span>
  <span m='3775520'>rerun</span> <span m='3775880'>these</span> <span m='3776030'>operations,</span>
  <span m='3776600'>because</span> <span m='3776810'>that's</span> <span m='3777080'>what</span>
  <span m='3777260'>retroactivity</span> <span m='3777960'>buys</span> <span m='3778250'>for</span>
  <span m='3778460'>you.</span> <span m='3779000'>But</span> <span m='3779120'>it</span>
  <span m='3779180'>has</span> <span m='3779390'>to</span> <span m='3779480'>say,</span>
  <span m='3779720'>oh</span> <span m='3779930'>well,</span> <span m='3780260'>now</span>
  <span m='3780440'>this</span> <span m='3780620'>query</span> <span m='3780920'>has</span>
  <span m='3781070'>changed.</span> <span m='3782120'>And</span> <span m='3782570'>then</span>
  <span m='3782810'>you</span> <span m='3782900'>have</span> <span m='3783020'>to</span>
  <span m='3783140'>rerun</span> <span m='3783470'>the</span> <span m='3783590'>algorithm</span>
  <span m='3783980'>from</span> <span m='3784220'>that</span> <span m='3784400'>point.</span>
  </p><p><span m='3785580'>But</span> <span m='3785750'>not</span> <span m='3785960'>necessarily</span>
  <span m='3786620'>entirely.</span> <span m='3787940'>I</span> <span m='3787970'>mean,</span>
  <span m='3788710'>you</span> <span m='3789170'>look</span> <span m='3789410'>at</span>
  <span m='3789470'>that</span> <span m='3789740'>and</span> <span m='3789830'>say,</span>
  <span m='3790010'>oh,</span> <span m='3790850'>did</span> <span m='3791150'>that</span>
  <span m='3791330'>query</span> <span m='3791570'>actually</span> <span m='3791810'>change</span>
  <span m='3792090'>anything?</span> <span m='3792380'>This</span> <span m='3792530'>is</span>
  <span m='3792590'>now</span> <span m='3792740'>the</span> <span m='3792860'>algorithm.</span>
  <span m='3794120'>Oh</span> <span m='3794300'>yeah,</span> <span m='3794540'>instead</span>
  <span m='3794930'>of</span> <span m='3795140'>this</span> <span m='3795380'>update</span>
  <span m='3796070'>here,</span> <span m='3796750'>I</span> <span m='3796930'>would</span>
  <span m='3797090'>have</span> <span m='3797540'>made</span> <span m='3797840'>a</span>
  <span m='3797900'>different</span> <span m='3798170'>update</span> <span m='3798470'>u</span>
  <span m='3798620'>prime.</span> <span m='3800570'>Well,</span> <span m='3800670'>that's</span>
  <span m='3800780'>good,</span> <span m='3800960'>we</span> <span m='3801110'>know</span>
  <span m='3801230'>how</span> <span m='3801320'>to</span> <span m='3801440'>do</span>
  <span m='3801560'>that.</span> <span m='3801810'>That's</span> <span m='3801920'>a</span>
  <span m='3801980'>retroactive</span> <span m='3802550'>update.</span> <span m='3803610'>So</span>
  <span m='3803630'>I</span> <span m='3803690'>can</span> <span m='3803870'>delete</span>
  <span m='3804410'>this</span> <span m='3804860'>operation</span> <span m='3805370'>retroactively</span>
  <span m='3805970'>and</span> <span m='3806060'>insert</span> <span m='3806360'>this</span>
  <span m='3806570'>one.</span> </p><p><span m='3807810'>So</span> <span m='3807860'>in</span>
  <span m='3807950'>general,</span> <span m='3808250'>what</span> <span m='3808370'>we</span>
  <span m='3808490'>assume</span> <span m='3808790'>the</span> <span m='3808910'>algorithm</span>
  <span m='3809300'>does</span> <span m='3809750'>is</span> <span m='3809900'>it</span>
  <span m='3811430'>looks</span> <span m='3811700'>at</span> <span m='3811760'>the</span>
  <span m='3811880'>first</span> <span m='3812150'>error,</span> <span m='3812540'>which</span>
  <span m='3812720'>is</span> <span m='3812810'>reported</span> <span m='3813200'>by</span>
  <span m='3813320'>our</span> <span m='3813410'>data</span> <span m='3813650'>structure.</span>
  <span m='3815130'>And</span> <span m='3815180'>then</span> <span m='3815420'>it</span>
  <span m='3816500'>then</span> <span m='3816830'>may</span> <span m='3817220'>make</span>
  <span m='3817580'>various</span> <span m='3818120'>changes</span> <span m='3818690'>from</span>
  <span m='3819020'>that</span> <span m='3819230'>point</span> <span m='3819500'>onward,</span>
  <span m='3819930'>but</span> <span m='3820130'>always</span> <span m='3820460'>monotonically</span>
  <span m='3821270'>left</span> <span m='3821490'>to</span> <span m='3821570'>right,</span>
  <span m='3821840'>as</span> <span m='3821990'>if</span> <span m='3822140'>it</span>
  <span m='3822230'>was</span> <span m='3822380'>rerun</span> <span m='3822640'>in</span>
  <span m='3822920'>the</span> <span m='3823050'>algorithm,</span> <span m='3823940'>but</span>
  <span m='3824120'>just</span> <span m='3824450'>changing</span> <span m='3825020'>what</span>
  <span m='3825200'>needed</span> <span m='3825470'>to</span> <span m='3825590'>change,</span>
  <span m='3827670'>until</span> <span m='3828300'>all</span> <span m='3828480'>the</span>
  <span m='3828630'>errors</span> <span m='3828930'>are</span> <span m='3829020'>resolved.</span>
  <span m='3829860'>All</span> <span m='3830010'>the</span> <span m='3830100'>queries</span>
  <span m='3830490'>have</span> <span m='3830670'>been</span> <span m='3831000'>corrected</span>
  <span m='3831480'>to</span> <span m='3831600'>the</span> <span m='3831720'>right</span>
  <span m='3831900'>answers.</span> <span m='3832920'>Then</span> <span m='3833130'>it</span>
  <span m='3833610'>can</span> <span m='3833760'>do</span> <span m='3833880'>whatever</span>
  <span m='3834120'>it</span> <span m='3834180'>wants.</span> <span m='3834450'>Then</span>
  <span m='3834540'>it</span> <span m='3834600'>can</span> <span m='3834690'>do</span>
  <span m='3834810'>retroactive</span> <span m='3835440'>operation</span> <span m='3835890'>anytime</span>
  <span m='3836310'>in</span> <span m='3836370'>the</span> <span m='3836460'>past.</span>
  </p><p><span m='3837860'>OK,</span> <span m='3838080'>so</span> <span m='3838320'>this</span>
  <span m='3838530'>is</span> <span m='3838620'>an</span> <span m='3838710'>assumption.</span>
  <span m='3841050'>Assume</span> <span m='3844500'>once</span> <span m='3844860'>there's</span>
  <span m='3845220'>an</span> <span m='3845340'>error,</span> <span m='3851080'>that</span>
  <span m='3851340'>the</span> <span m='3851550'>algorithm</span> <span m='3854730'>makes</span>
  <span m='3855150'>changes,</span> <span m='3857940'>retroactive</span> <span m='3860340'>updates,</span>
  <span m='3865320'>from</span> <span m='3865620'>left</span> <span m='3865800'>to</span>
  <span m='3865920'>right.</span> <span m='3871260'>And</span> <span m='3871740'>also</span>
  <span m='3872040'>going</span> <span m='3872310'>to</span> <span m='3872460'>assume</span>
  <span m='3874890'>that</span> <span m='3875070'>it</span> <span m='3875130'>does</span>
  <span m='3875370'>it</span> <span m='3875490'>at</span> <span m='3875670'>times</span>
  <span m='3880890'>less</span> <span m='3881340'>than</span> <span m='3881460'>or</span>
  <span m='3881550'>equal</span> <span m='3881850'>to</span> <span m='3882090'>all</span>
  <span m='3882300'>errors.</span> </p><p><span m='3886980'>So</span> <span m='3887310'>in</span>
  <span m='3887490'>general,</span> <span m='3889000'>you</span> <span m='3889100'>have</span>
  <span m='3889110'>a</span> <span m='3889150'>timeline.</span> <span m='3890920'>And
  then</span> <span m='3891120'>there</span> <span m='3891220'>are</span> <span m='3891270'>some</span>
  <span m='3892020'>errors</span> <span m='3892470'>where</span> <span m='3892620'>bad</span>
  <span m='3893010'>queries</span> <span m='3893460'>were</span> <span m='3893580'>done.</span>
  <span m='3896280'>Naturally,</span> <span m='3896850'>you</span> <span m='3897000'>would</span>
  <span m='3897150'>go</span> <span m='3897480'>right</span> <span m='3897660'>here</span>
  <span m='3897940'>and</span> <span m='3898040'>fix</span> <span m='3898200'>the</span>
  <span m='3898320'>first</span> <span m='3898590'>error,</span> <span m='3899160'>because</span>
  <span m='3899340'>that</span> <span m='3899460'>may</span> <span m='3899610'>influence</span>
  <span m='3899940'>other</span> <span m='3900340'>errors.</span> <span m='3901540'>And</span>
  <span m='3901660'>maybe</span> <span m='3902130'>you</span> <span m='3902310'>have--</span>
  <span m='3903260'>so</span> <span m='3903390'>then</span> <span m='3903510'>you</span>
  <span m='3903600'>make</span> <span m='3903780'>that</span> <span m='3903930'>change.</span>
  <span m='3904770'>Maybe</span> <span m='3905010'>then</span> <span m='3905250'>that</span>
  <span m='3905430'>causes</span> <span m='3905790'>some</span> <span m='3906000'>other</span>
  <span m='3906210'>changes</span> <span m='3906600'>right</span> <span m='3906780'>after</span>
  <span m='3907260'>or</span> <span m='3907320'>somewhere</span> <span m='3907620'>in</span>
  <span m='3907730'>between.</span> <span m='3909370'>But</span> <span m='3909480'>then</span>
  <span m='3911190'>I don't</span> <span m='3911450'>want</span> <span m='3911570'>to</span>
  <span m='3911630'>make</span> <span m='3911760'>a</span> <span m='3911820'>change</span>
  <span m='3912090'>here,</span> <span m='3912270'>because</span> <span m='3912540'>that</span>
  <span m='3912720'>would</span> <span m='3912960'>be</span> <span m='3913140'>depending</span>
  <span m='3913710'>on</span> <span m='3913860'>this</span> <span m='3914040'>result,</span>
  <span m='3914400'>which</span> <span m='3914610'>was</span> <span m='3914850'>incorrect.</span>
  <span m='3915290'>So</span> <span m='3915420'>first</span> <span m='3915690'>you</span>
  <span m='3915750'>have</span> <span m='3915870'>to</span> <span m='3915960'>fix</span>
  <span m='3916200'>this.</span> <span m='3917280'>So</span> <span m='3917370'>you</span>
  <span m='3917460'>keep</span> <span m='3917700'>going</span> <span m='3917910'>to</span>
  <span m='3918000'>the</span> <span m='3918090'>right</span> <span m='3918390'>and</span>
  <span m='3918480'>you</span> <span m='3918540'>visit</span> <span m='3918840'>all</span>
  <span m='3918970'>the</span> <span m='3919050'>stars.</span> <span m='3920550'>That's</span>
  <span m='3922920'>this</span> <span m='3923070'>assumption.</span> </p><p><span
  m='3926800'>This</span> <span m='3927180'>is</span> <span m='3927270'>a</span> <span
  m='3927330'>very</span> <span m='3927510'>different</span> <span m='3927780'>kind</span>
  <span m='3927930'>of</span> <span m='3928020'>retroactivity.</span> <span m='3928920'>I</span>
  <span m='3929040'>would</span> <span m='3929220'>say</span> <span m='3930990'>it's</span>
  <span m='3931140'>more</span> <span m='3931500'>about</span> <span m='3931830'>maintaining</span>
  <span m='3932550'>this</span> <span m='3932760'>exact</span> <span m='3933180'>picture</span>
  <span m='3934140'>of</span> <span m='3934260'>what's</span> <span m='3934440'>happening,</span>
  <span m='3936600'>but</span> <span m='3936810'>being</span> <span m='3937080'>able</span>
  <span m='3937290'>to</span> <span m='3937410'>teleport</span> <span m='3937920'>over</span>
  <span m='3938160'>the</span> <span m='3938320'>uninteresting</span> <span m='3938880'>stuff.</span>
  <span m='3940320'>So</span> <span m='3940470'>in</span> <span m='3940530'>this</span>
  <span m='3940680'>picture,</span> <span m='3942150'>if</span> <span m='3942870'>we're</span>
  <span m='3943020'>doing</span> <span m='3943290'>priority</span> <span m='3943680'>queues</span>
  <span m='3943950'>like</span> <span m='3944100'>this,</span> <span m='3945120'>when</span>
  <span m='3945300'>I</span> <span m='3945360'>make</span> <span m='3945540'>this</span>
  <span m='3945690'>change,</span> <span m='3945990'>well,</span> <span m='3946110'>that</span>
  <span m='3946290'>query</span> <span m='3946680'>changes.</span> <span m='3947130'>That
  query</span> <span m='3947520'>changes.</span> </p><p><span m='3948310'>The</span>
  <span m='3948650'>delete-mins,</span> <span m='3950040'>the</span> <span m='3950160'>mins</span>
  <span m='3950520'>that</span> <span m='3950640'>they're</span> <span m='3950760'>deleting</span>
  <span m='3951440'>change.</span> <span m='3952740'>So</span> <span m='3952890'>here</span>
  <span m='3953070'>they</span> <span m='3953190'>were</span> <span m='3953460'>just</span>
  <span m='3953670'>updates.</span> <span m='3954150'>But</span> <span m='3954280'>if</span>
  <span m='3954660'>there's</span> <span m='3954810'>also</span> <span m='3955050'>a</span>
  <span m='3955110'>query</span> <span m='3955410'>here,</span> <span m='3955660'>which</span>
  <span m='3955740'>is</span> <span m='3955860'>what</span> <span m='3956070'>is</span>
  <span m='3956220'>the</span> <span m='3956310'>min,</span> <span m='3957060'>then</span>
  <span m='3957270'>all</span> <span m='3957480'>of</span> <span m='3957540'>these</span>
  <span m='3957750'>query</span> <span m='3957990'>values</span> <span m='3958350'>would</span>
  <span m='3958470'>change.</span> <span m='3962420'>So</span> <span m='3963280'>you're</span>
  <span m='3963430'>forced</span> <span m='3963760'>now</span> <span m='3963970'>to</span>
  <span m='3964060'>pay</span> <span m='3964300'>for</span> <span m='3964450'>that.</span>
  <span m='3965390'>So</span> <span m='3965440'>in</span> <span m='3965500'>some</span>
  <span m='3965680'>sense,</span> <span m='3966230'>it</span> <span m='3966250'>gets</span>
  <span m='3966460'>easier.</span> <span m='3967520'>Let's</span> <span m='3967810'>say.</span>
  </p><p><span m='3968290'>For</span> <span m='3968670'>a</span> <span m='3968700'>lot</span>
  <span m='3968830'>of</span> <span m='3968890'>problems</span> <span m='3969310'>this</span>
  <span m='3969460'>kind</span> <span m='3969610'>of</span> <span m='3969900'>retroactivity</span>
  <span m='3970210'>is</span> <span m='3970300'>easier.</span> <span m='3971210'>But</span>
  <span m='3971320'>for</span> <span m='3971530'>many</span> <span m='3971740'>problems,</span>
  <span m='3972070'>it's</span> <span m='3972190'>also</span> <span m='3972460'>more</span>
  <span m='3972640'>useful.</span> <span m='3973220'>So</span> <span m='3973330'>their</span>
  <span m='3973510'>example</span> <span m='3973960'>is</span> <span m='3974170'>what</span>
  <span m='3974350'>if</span> <span m='3974440'>you</span> <span m='3974560'>want</span>
  <span m='3974740'>to</span> <span m='3974800'>do a</span> <span m='3975040'>dynamic</span>
  <span m='3975780'>Dijkstra?</span> <span m='3976640'>So</span> <span m='3976790'>you</span>
  <span m='3977150'>have</span> <span m='3977320'>Dijkstra's</span> <span m='3977710'>algorithm,</span>
  <span m='3978130'>and</span> <span m='3978220'>then</span> <span m='3978340'>you</span>
  <span m='3978430'>say,</span> <span m='3978770'>oh,</span> <span m='3978910'>actually</span>
  <span m='3979360'>this</span> <span m='3979550'>edge weight</span> <span m='3979870'>was</span>
  <span m='3980020'>wrong.</span> <span m='3981120'>So</span> <span m='3981220'>you</span>
  <span m='3981280'>run</span> <span m='3981490'>Dijkstra's</span> <span m='3981850'>algorithm</span>
  <span m='3982210'>once.</span> <span m='3983080'>You've</span> <span m='3983170'>got</span>
  <span m='3983290'>a</span> <span m='3983350'>priority</span> <span m='3983740'>queue</span>
  <span m='3983920'>in</span> <span m='3984010'>there</span> <span m='3984460'>telling</span>
  <span m='3984760'>you</span> <span m='3984940'>which</span> <span m='3985850'>vertex</span>
  <span m='3986330'>is</span> <span m='3986470'>next.</span> <span m='3989255'>And</span>
  <span m='3989550'>now</span> <span m='3989800'>you</span> <span m='3989920'>say,</span>
  <span m='3990070'>OK,</span> <span m='3990370'>I changed</span> <span m='3990670'>this</span>
  <span m='3990820'>weight</span> <span m='3991000'>at</span> <span m='3991090'>the</span>
  <span m='3991180'>beginning</span> <span m='3991600'>of</span> <span m='3991690'>time.</span>
  <span m='3992680'>I</span> <span m='3992800'>don't</span> <span m='3992950'>want</span>
  <span m='3993070'>to</span> <span m='3993130'>have</span> <span m='3993250'>to</span>
  <span m='3993340'>rerun</span> <span m='3993670'>Dijkstra</span> <span m='3994030'>entirely</span>
  <span m='3994690'>if</span> <span m='3995020'>nothing</span> <span m='3995320'>changes.</span>
  <span m='3996040'>Maybe</span> <span m='3996280'>that</span> <span m='3996400'>weight</span>
  <span m='3996610'>was</span> <span m='3996730'>completely</span> <span m='3997090'>irrelevant.</span>
  </p><p><span m='3998240'>If</span> <span m='3998380'>you</span> <span m='3998440'>just</span>
  <span m='3998620'>do</span> <span m='3998830'>a</span> <span m='3998860'>retroactive</span>
  <span m='3999460'>update</span> <span m='4000180'>and</span> <span m='4000300'>see</span>
  <span m='4000480'>did</span> <span m='4000690'>any</span> <span m='4000900'>of</span>
  <span m='4000960'>the</span> <span m='4001080'>query</span> <span m='4001320'>results</span>
  <span m='4001680'>change,</span> <span m='4002100'>if</span> <span m='4002190'>they</span>
  <span m='4002310'>didn't</span> <span m='4002520'>change,</span> <span m='4002880'>then</span>
  <span m='4003090'>great</span> <span m='4003360'>you</span> <span m='4003450'>have</span>
  <span m='4003600'>the</span> <span m='4003660'>right</span> <span m='4003810'>answer.</span>
  <span m='4004380'>If</span> <span m='4004470'>they</span> <span m='4004560'>did</span>
  <span m='4004710'>change,</span> <span m='4005190'>the</span> <span m='4005310'>results</span>
  <span m='4005640'>change.</span> <span m='4006090'>And</span> <span m='4006210'>so</span>
  <span m='4006510'>you</span> <span m='4006690'>have</span> <span m='4006960'>to</span>
  <span m='4007080'>know</span> <span m='4007860'>for</span> <span m='4008040'>every</span>
  <span m='4008370'>wrong</span> <span m='4008640'>query</span> <span m='4008970'>that</span>
  <span m='4009180'>oh,</span> <span m='4009390'>I</span> <span m='4009480'>really</span>
  <span m='4009750'>had</span> <span m='4009900'>to</span> <span m='4009960'>change</span>
  <span m='4010350'>the</span> <span m='4010440'>shortest</span> <span m='4010710'>pathway.</span>
  <span m='4011520'>It's</span> <span m='4011610'>not</span> <span m='4011820'>this,</span>
  <span m='4012060'>it's</span> <span m='4012210'>now</span> <span m='4012390'>this.</span>
  <span m='4013440'>But</span> <span m='4013620'>hopefully,</span> <span m='4014580'>you</span>
  <span m='4014700'>will</span> <span m='4014790'>only</span> <span m='4015060'>have</span>
  <span m='4015210'>to</span> <span m='4015300'>change</span> <span m='4015570'>a</span>
  <span m='4015600'>very</span> <span m='4015780'>small</span> <span m='4016110'>amount</span>
  <span m='4016410'>if</span> <span m='4016530'>your</span> <span m='4016620'>graph</span>
  <span m='4016890'>didn't</span> <span m='4017100'>change</span> <span m='4017910'>in</span>
  <span m='4018030'>a</span> <span m='4018090'>big</span> <span m='4018270'>way.</span>
  </p><p><span m='4018900'>So</span> <span m='4019080'>it's</span> <span m='4019170'>hard</span>
  <span m='4019350'>to</span> <span m='4019440'>proof</span> <span m='4019770'>results</span>
  <span m='4020130'>about</span> <span m='4020430'>that,</span> <span m='4021090'>but</span>
  <span m='4021270'>at</span> <span m='4021330'>least</span> <span m='4022680'>this</span>
  <span m='4022920'>would</span> <span m='4023070'>let</span> <span m='4023250'>you</span>
  <span m='4023430'>dynamize</span> <span m='4024060'>almost</span> <span m='4024390'>any</span>
  <span m='4024600'>algorithm that's</span> <span m='4025050'>using</span> <span m='4025300'>the</span>
  <span m='4025350'>data</span> <span m='4025560'>structure.</span> <span m='4026220'>So</span>
  <span m='4026310'>it's</span> <span m='4026400'>easier,</span> <span m='4026790'>but</span>
  <span m='4027000'>useful</span> <span m='4027360'>for</span> <span m='4027480'>that</span>
  <span m='4027690'>kind</span> <span m='4027870'>of</span> <span m='4027960'>transformation.</span>
  </p><p><span m='4030960'>OK,</span> <span m='4032700'>let</span> <span m='4032880'>me</span>
  <span m='4033090'>give</span> <span m='4033300'>you</span> <span m='4033390'>an</span>
  <span m='4033480'>example,</span> <span m='4035070'>which</span> <span m='4035310'>is</span>
  <span m='4035610'>priority</span> <span m='4035885'>queues.</span> <span m='4036420'>There's</span>
  <span m='4036630'>a</span> <span m='4036690'>bunch</span> <span m='4036990'>of</span>
  <span m='4037260'>results</span> <span m='4037650'>in</span> <span m='4037770'>their</span>
  <span m='4037890'>paper,</span> <span m='4039010'>but</span> <span m='4039090'>for</span>
  <span m='4039420'>symmetry.</span> <span m='4040980'>Tell</span> <span m='4041160'>you</span>
  <span m='4041220'>about</span> <span m='4041460'>priority</span> <span m='4041715'>queues.</span>
  <span m='4041970'>This</span> <span m='4042120'>will</span> <span m='4042240'>look</span>
  <span m='4042480'>completely</span> <span m='4042960'>different,</span> <span m='4043490'>so</span>
  <span m='4043650'>don't</span> <span m='4044040'>worry.</span> </p><p><span m='4047150'>Operations--</span>
  <span m='4047560'>well,</span> <span m='4048430'>the</span> <span m='4049200'>visual</span>
  <span m='4049590'>picture</span> <span m='4049900'>is</span> <span m='4049980'>the</span>
  <span m='4050070'>same,</span> <span m='4050470'>but</span> <span m='4050550'>the</span>
  <span m='4050640'>data</span> <span m='4050880'>structuring</span> <span m='4051300'>is</span>
  <span m='4051420'>all</span> <span m='4051540'>completely</span> <span m='4051930'>different.</span>
  <span m='4053950'>They</span> <span m='4053970'>can</span> <span m='4054090'>do</span>
  <span m='4054210'>all</span> <span m='4054420'>these</span> <span m='4054600'>things</span>
  <span m='4055110'>in</span> <span m='4055470'>log</span> <span m='4055920'>m</span>
  <span m='4056990'>per</span> <span m='4057390'>retroactive</span> <span m='4058020'>operation.</span>
  <span m='4061050'>Now</span> <span m='4061320'>there's</span> <span m='4061500'>no</span>
  <span m='4061620'>notion</span> <span m='4061920'>of</span> <span m='4062010'>full</span>
  <span m='4063180'>and</span> <span m='4063330'>partial.</span> <span m='4063780'>It's</span>
  <span m='4063870'>just</span> <span m='4064050'>nonoblivious</span> <span m='4064690'>retroactivity.</span>
  <span m='4066420'>I</span> <span m='4066510'>didn't</span> <span m='4066720'>write</span>
  <span m='4066960'>it</span> <span m='4067050'>here,</span> <span m='4067260'>but</span>
  <span m='4067860'>the</span> <span m='4067950'>data</span> <span m='4068130'>structure</span>
  <span m='4068520'>always</span> <span m='4068820'>maintains</span> <span m='4069270'>what</span>
  <span m='4069510'>is</span> <span m='4069690'>the</span> <span m='4069870'>earliest</span>
  <span m='4070380'>error</span> <span m='4071370'>currently.</span> </p><p><span
  m='4075510'>Maintain</span> <span m='4078410'>the</span> <span m='4078800'>earliest</span>
  <span m='4079310'>in</span> <span m='4079400'>time</span> <span m='4082160'>error.</span>
  <span m='4082570'>That</span> <span m='4082760'>error</span> <span m='4083180'>is</span>
  <span m='4083300'>a</span> <span m='4083360'>query</span> <span m='4083750'>that</span>
  <span m='4083960'>used</span> <span m='4084200'>to</span> <span m='4084620'>return</span>
  <span m='4084920'>one</span> <span m='4085100'>result,</span> <span m='4085410'>now</span>
  <span m='4085550'>returns</span> <span m='4085910'>a</span> <span m='4085970'>new</span>
  <span m='4086120'>result.</span> </p><p><span m='4089180'>OK</span> <span m='4091510'>we</span>
  <span m='4091630'>have</span> <span m='4094150'>a</span> <span m='4094210'>similar</span>
  <span m='4094720'>picture.</span> <span m='4096910'>So</span> <span m='4097240'>I</span>
  <span m='4097649'>cheated--</span> <span m='4097929'>I've</span> <span m='4098210'>changed</span>
  <span m='4098590'>things</span> <span m='4098800'>a</span> <span m='4098859'>little</span>
  <span m='4099010'>bit.</span> <span m='4099189'>I</span> <span m='4099250'>didn't</span>
  <span m='4099399'>cheat.</span> <span m='4099810'>It's</span> <span m='4099939'>just</span>
  <span m='4101020'>a</span> <span m='4101050'>slight</span> <span m='4101410'>discrepancy.</span>
  <span m='4102670'>For</span> <span m='4103870'>retroactive,</span> <span m='4104529'>regular</span>
  <span m='4104830'>retroactive,</span> <span m='4105430'>insert</span> <span m='4105760'>and</span>
  <span m='4105850'>delete-min</span> <span m='4106300'>were</span> <span m='4106390'>more</span>
  <span m='4106569'>interesting,</span> <span m='4107050'>because</span> <span m='4107319'>then</span>
  <span m='4107470'>they</span> <span m='4107580'>were</span> <span m='4107649'>chain</span>
  <span m='4107920'>reactions.</span> <span m='4108399'>In</span> <span m='4108520'>this</span>
  <span m='4108700'>world</span> <span m='4109450'>you</span> <span m='4109540'>don't</span>
  <span m='4109720'>have</span> <span m='4110020'>to</span> <span m='4110200'>combine</span>
  <span m='4110710'>delete</span> <span m='4110950'>and</span> <span m='4111060'>min.</span>
  <span m='4111279'>You</span> <span m='4111399'>could</span> <span m='4111760'>consider</span>
  <span m='4112210'>delete</span> <span m='4112510'>separate</span> <span m='4112870'>from</span>
  <span m='4113080'>min.</span> </p><p><span m='4113890'>Because</span> <span m='4114100'>now,</span>
  <span m='4115149'>updates</span> <span m='4115540'>are</span> <span m='4115600'>allowed</span>
  <span m='4115840'>to</span> <span m='4115930'>depend</span> <span m='4116260'>on</span>
  <span m='4116380'>queries.</span> <span m='4116880'>So</span> <span m='4116979'>maybe</span>
  <span m='4117170'>you</span> <span m='4117279'>compute</span> <span m='4117609'>a</span>
  <span m='4117670'>min</span> <span m='4117880'>and</span> <span m='4117970'>then</span>
  <span m='4118090'>you</span> <span m='4118180'>decide</span> <span m='4118510'>to</span>
  <span m='4118600'>delete</span> <span m='4118899'>that</span> <span m='4119140'>thing.</span>
  <span m='4120010'>If</span> <span m='4120270'>the min</span> <span m='4120540'>changes,</span>
  <span m='4121060'>well</span> <span m='4121180'>then,</span> <span m='4121359'>the</span>
  <span m='4121450'>thing</span> <span m='4121720'>that</span> <span m='4121870'>got</span>
  <span m='4122080'>deleted</span> <span m='4122439'>might</span> <span m='4122620'>also</span>
  <span m='4122890'>change.</span> <span m='4123229'>That's</span> <span m='4123430'>the</span>
  <span m='4123569'>algorithm's</span> <span m='4124240'>choice.</span> <span m='4125560'>What</span>
  <span m='4125710'>to</span> <span m='4125830'>do.</span> </p><p><span m='4127580'>So</span>
  <span m='4127720'>in</span> <span m='4127779'>this</span> <span m='4128020'>new</span>
  <span m='4128229'>world</span> <span m='4128529'>of</span> <span m='4128649'>insert,</span>
  <span m='4129109'>delete,</span> <span m='4129420'>and min,</span> <span m='4130029'>slightly</span>
  <span m='4130510'>more</span> <span m='4130689'>general,</span> <span m='4132640'>if</span>
  <span m='4132850'>you</span> <span m='4132939'>look</span> <span m='4133180'>at</span>
  <span m='4133990'>an</span> <span m='4134109'>item,</span> <span m='4134830'>it</span>
  <span m='4134920'>gets</span> <span m='4135220'>inserted</span> <span m='4135720'>at
  some time.</span> <span m='4136050'>It</span> <span m='4136120'>might</span> <span
  m='4136270'>get</span> <span m='4136420'>deleted</span> <span m='4136750'>at</span>
  <span m='4136840'>some</span> <span m='4137020'>time.</span> <span m='4137649'>Sometimes</span>
  <span m='4138220'>it</span> <span m='4138279'>might</span> <span m='4138430'>go</span>
  <span m='4138520'>off</span> <span m='4138700'>to</span> <span m='4138760'>infinity,</span>
  <span m='4139075'>if</span> <span m='4139390'>it</span> <span m='4139450'>never</span>
  <span m='4139660'>gets</span> <span m='4139870'>deleted.</span> <span m='4141729'>OK,</span>
  <span m='4141970'>this</span> <span m='4142180'>is</span> <span m='4142270'>our</span>
  <span m='4142390'>new</span> <span m='4142600'>picture</span> <span m='4143920'>of</span>
  <span m='4145180'>the</span> <span m='4145240'>priority</span> <span m='4145630'>queue</span>
  <span m='4145870'>over</span> <span m='4146140'>time.</span> <span m='4147290'>So</span>
  <span m='4147490'>again,</span> <span m='4147859'>this</span> <span m='4147910'>is</span>
  <span m='4148029'>the</span> <span m='4148149'>time</span> <span m='4148470'>axis.</span>
  <span m='4150100'>And</span> <span m='4150279'>this</span> <span m='4150460'>is</span>
  <span m='4150580'>the</span> <span m='4150670'>key</span> <span m='4150880'>value.</span>
  <span m='4152760'>So</span> <span m='4152899'>have</span> <span m='4152979'>some</span>
  <span m='4153310'>inserts,</span> <span m='4153700'>deletes.</span> <span m='4154310'>They're
  all</span> <span m='4154630'>corresponding</span> <span m='4155109'>points</span>
  <span m='4155529'>in</span> <span m='4155830'>here.</span> </p><p><span m='4156460'>And</span>
  <span m='4156580'>then</span> <span m='4156700'>you</span> <span m='4156790'>have</span>
  <span m='4156939'>min</span> <span m='4157180'>queries,</span> <span m='4157720'>which</span>
  <span m='4157990'>maybe</span> <span m='4158290'>I</span> <span m='4158410'>will</span>
  <span m='4158529'>draw</span> <span m='4158890'>in</span> <span m='4159310'>red.</span>
  <span m='4162649'>So</span> <span m='4162810'>min</span> <span m='4163040'>query</span>
  <span m='4163490'>would</span> <span m='4163580'>be</span> <span m='4163939'>something</span>
  <span m='4164450'>like</span> <span m='4164660'>this.</span> <span m='4166550'>Give</span>
  <span m='4166850'>me</span> <span m='4167120'>what</span> <span m='4167300'>is</span>
  <span m='4167390'>the</span> <span m='4167479'>lowest</span> <span m='4167779'>segment</span>
  <span m='4168170'>at</span> <span m='4168380'>this</span> <span m='4168590'>time.</span>
  </p><p><span m='4174100'>So</span> <span m='4174170'>that's</span> <span m='4174510'>my</span>
  <span m='4174649'>sequence</span> <span m='4175010'>of</span> <span m='4175130'>operations</span>
  <span m='4175580'>is</span> <span m='4175670'>the</span> <span m='4175760'>projection</span>
  <span m='4176359'>onto</span> <span m='4176600'>time,</span> <span m='4176960'>so</span>
  <span m='4177080'>there's</span> <span m='4177229'>this</span> <span m='4177439'>thing.</span>
  <span m='4178000'>Then</span> <span m='4178130'>there's</span> <span m='4178270'>this</span>
  <span m='4178370'>query.</span> <span m='4178700'>Then</span> <span m='4178790'>there's</span>
  <span m='4178939'>this</span> <span m='4179090'>insertion.</span> <span m='4180140'>Then</span>
  <span m='4180319'>there's</span> <span m='4180500'>this</span> <span m='4180649'>deletion.</span>
  <span m='4181090'>Then</span> <span m='4181189'>there's</span> <span m='4181340'>this</span>
  <span m='4181490'>deletion.</span> <span m='4181960'>Then</span> <span m='4182060'>there's</span>
  <span m='4182240'>this</span> <span m='4182390'>query.</span> <span m='4183380'>Min</span>
  <span m='4183500'>query,</span> <span m='4183830'>then</span> <span m='4183979'>there's</span>
  <span m='4184160'>this</span> <span m='4184279'>insertion.</span> <span m='4184819'>Then</span>
  <span m='4184939'>there's</span> <span m='4185120'>this</span> <span m='4185420'>query.</span>
  <span m='4185910'>Then</span> <span m='4186010'>there's</span> <span m='4186080'>this</span>
  <span m='4186200'>deletion.</span> <span m='4186950'>You</span> <span m='4187040'>get</span>
  <span m='4187160'>the</span> <span m='4187279'>idea.</span> <span m='4189479'>But</span>
  <span m='4189500'>this</span> <span m='4189710'>is</span> <span m='4189830'>a</span>
  <span m='4189920'>way</span> <span m='4190100'>to</span> <span m='4190310'>two-dimensionalize</span>
  <span m='4191240'>that</span> <span m='4192050'>picture.</span> </p><p><span m='4193730'>AUDIENCE:</span>
  <span m='4193950'>Can you delete</span> <span m='4194170'>without</span> <span m='4194610'>the
  query?</span> </p><p><span m='4195050'>ERIK DEMAINE:</span> <span m='4195205'>Sorry?</span>
  </p><p><span m='4196158'>AUDIENCE:</span> <span m='4196320'>Can</span> <span m='4196482'>you</span>
  <span m='4196646'>delete without</span> <span m='4197134'>the query?</span> </p><p><span
  m='4198600'>ERIK DEMAINE:</span> <span m='4198720'>You</span> <span m='4198840'>can</span>
  <span m='4198990'>delete</span> <span m='4199260'>without</span> <span m='4199500'>a</span>
  <span m='4199560'>query</span> <span m='4199890'>in</span> <span m='4199960'>this</span>
  <span m='4200130'>model.</span> <span m='4202830'>Make</span> <span m='4203070'>our
  life</span> <span m='4203250'>a</span> <span m='4203280'>little</span> <span m='4203460'>bit</span>
  <span m='4203580'>harder.</span> </p><p><span m='4203900'>Now</span> <span m='4204570'>what</span>
  <span m='4204780'>we</span> <span m='4204900'>need</span> <span m='4205050'>to</span>
  <span m='4205170'>support</span> <span m='4205620'>are</span> <span m='4206370'>capital</span>
  <span m='4206820'>insert,</span> <span m='4207180'>and</span> <span m='4207270'>capital</span>
  <span m='4207690'>delete,</span> <span m='4208110'>retroactive</span> <span m='4208620'>insert</span>
  <span m='4208870'>and</span> <span m='4208950'>delete,</span> <span m='4209500'>of</span>
  <span m='4210030'>all</span> <span m='4210300'>three</span> <span m='4210780'>of</span>
  <span m='4210900'>these</span> <span m='4211080'>operations.</span> <span m='4211680'>Before</span>
  <span m='4212040'>it</span> <span m='4212100'>was</span> <span m='4212220'>just</span>
  <span m='4212430'>updates.</span> <span m='4212770'>Now</span> <span m='4213030'>we</span>
  <span m='4213150'>can</span> <span m='4213270'>insert</span> <span m='4213540'>and</span>
  <span m='4213690'>delete</span> <span m='4213840'>queries.</span> <span m='4215660'>A</span>
  <span m='4215700'>little</span> <span m='4215910'>harder</span> <span m='4216120'>to</span>
  <span m='4216210'>think</span> <span m='4216390'>about.</span> <span m='4217180'>But</span>
  <span m='4218850'>it</span> <span m='4218940'>can</span> <span m='4219060'>be</span>
  <span m='4219150'>done.</span> </p><p><span m='4220270'>So</span> <span m='4220440'>for</span>
  <span m='4220620'>example,</span> <span m='4221550'>let's</span> <span m='4221700'>just--</span>
  <span m='4222340'>I'm</span> <span m='4222480'>not</span> <span m='4222600'>going</span>
  <span m='4222720'>to</span> <span m='4222810'>do</span> <span m='4222960'>all</span>
  <span m='4223140'>the</span> <span m='4223260'>cases,</span> <span m='4223680'>because</span>
  <span m='4223860'>there's</span> <span m='4223980'>a</span> <span m='4224040'>lot</span>
  <span m='4224220'>of</span> <span m='4224280'>them.</span> <span m='4225670'>Let's</span>
  <span m='4225810'>say</span> <span m='4226950'>I</span> <span m='4227640'>delete</span>
  <span m='4228270'>this</span> <span m='4228510'>deletion.</span> <span m='4230580'>OK,</span>
  <span m='4230880'>that</span> <span m='4231060'>means</span> <span m='4231330'>that</span>
  <span m='4231450'>this</span> <span m='4232230'>will</span> <span m='4232380'>just</span>
  <span m='4232530'>go</span> <span m='4232770'>to</span> <span m='4232890'>the</span>
  <span m='4233010'>right.</span> <span m='4237550'>OK,</span> <span m='4238050'>that's</span>
  <span m='4238500'>bad,</span> <span m='4239010'>because</span> <span m='4239400'>it</span>
  <span m='4239460'>changes</span> <span m='4240810'>all</span> <span m='4241050'>of</span>
  <span m='4241140'>these</span> <span m='4241320'>queries.</span> <span m='4241620'>All
  of</span> <span m='4241800'>these</span> <span m='4241950'>queries</span> <span
  m='4242220'>are</span> <span m='4242340'>now</span> <span m='4242640'>incorrect.</span>
  <span m='4243750'>We're</span> <span m='4243870'>just</span> <span m='4244020'>going</span>
  <span m='4244140'>to</span> <span m='4244230'>keep</span> <span m='4244530'>the</span>
  <span m='4244620'>picture</span> <span m='4244950'>like</span> <span m='4245130'>this</span>
  <span m='4246090'>and</span> <span m='4246210'>remember</span> <span m='4246630'>that</span>
  <span m='4246810'>there</span> <span m='4246960'>are</span> <span m='4247170'>errors.</span>
  <span m='4247960'>And</span> <span m='4248060'>we'll</span> <span m='4248070'>be</span>
  <span m='4248190'>able</span> <span m='4248400'>to</span> <span m='4248640'>maintain</span>
  <span m='4249090'>at</span> <span m='4249180'>every</span> <span m='4249420'>moment</span>
  <span m='4249720'>what</span> <span m='4249870'>is</span> <span m='4250020'>the</span>
  <span m='4250140'>next</span> <span m='4250410'>error.</span> </p><p><span m='4251760'>The</span>
  <span m='4251910'>errors</span> <span m='4252660'>are</span> <span m='4252900'>these</span>
  <span m='4253110'>crossings.</span> <span m='4255000'>Crossings</span> <span m='4255390'>are</span>
  <span m='4255480'>bad.</span> <span m='4255750'>That</span> <span m='4255900'>means</span>
  <span m='4256650'>you</span> <span m='4256770'>have</span> <span m='4256890'>the</span>
  <span m='4257010'>wrong</span> <span m='4257220'>picture.</span> <span m='4258270'>But</span>
  <span m='4258720'>we'll</span> <span m='4258930'>wait</span> <span m='4259110'>for</span>
  <span m='4259230'>the</span> <span m='4259380'>algorithm--</span> <span m='4259820'>we'll</span>
  <span m='4259950'>tell</span> <span m='4260130'>the</span> <span m='4260250'>algorithm</span>
  <span m='4260580'>this</span> <span m='4260790'>is</span> <span m='4260910'>the</span>
  <span m='4261030'>next</span> <span m='4261240'>crossing.</span> <span m='4261690'>And</span>
  <span m='4261790'>it's</span> <span m='4262010'>going</span> <span m='4262140'>to</span>
  <span m='4262200'>have</span> <span m='4262290'>to</span> <span m='4262380'>fix</span>
  <span m='4262650'>it</span> <span m='4262770'>by</span> <span m='4262920'>say</span>
  <span m='4263130'>deleting</span> <span m='4263520'>that</span> <span m='4263670'>query</span>
  <span m='4263920'>and</span> <span m='4264000'>then</span> <span m='4264120'>reinserting</span>
  <span m='4264750'>it.</span> <span m='4265230'>Then</span> <span m='4265350'>it</span>
  <span m='4265410'>will</span> <span m='4265500'>get</span> <span m='4265650'>the</span>
  <span m='4265740'>correct</span> <span m='4266010'>result.</span> <span m='4266760'>But</span>
  <span m='4266910'>it</span> <span m='4266970'>might</span> <span m='4267150'>do</span>
  <span m='4267300'>other</span> <span m='4267510'>updates</span> <span m='4267870'>meanwhile.</span>
  <span m='4268620'>So</span> <span m='4268740'>let's</span> <span m='4268920'>not</span>
  <span m='4269040'>try</span> <span m='4269160'>to</span> <span m='4269280'>fix</span>
  <span m='4269460'>them</span> <span m='4269610'>all</span> <span m='4269700'>now</span>
  <span m='4269970'>because</span> <span m='4271290'>they</span> <span m='4271530'>may</span>
  <span m='4271680'>change.</span> <span m='4272100'>Maybe</span> <span m='4272490'>they'll</span>
  <span m='4272700'>decide</span> <span m='4273000'>to</span> <span m='4273120'>re-insert</span>
  <span m='4273405'>a</span> <span m='4273690'>deletion</span> <span m='4274140'>here</span>
  <span m='4274950'>to</span> <span m='4275070'>do</span> <span m='4275190'>that,</span>
  <span m='4275590'>and</span> <span m='4275610'>then</span> <span m='4275760'>erase</span>
  <span m='4276300'>all</span> <span m='4276490'>of</span> <span m='4276570'>those</span>
  <span m='4276720'>crossings,</span> <span m='4277565'>if</span> <span m='4277840'>we're</span>
  <span m='4278010'>lucky.</span> </p><p><span m='4280210'>You</span> <span m='4280230'>might</span>
  <span m='4280410'>also</span> <span m='4280830'>insert</span> <span m='4281310'>an</span>
  <span m='4281430'>insertion.</span> <span m='4282270'>That's</span> <span m='4282480'>basically</span>
  <span m='4282840'>the</span> <span m='4282960'>same</span> <span m='4283200'>as</span>
  <span m='4283290'>deleting</span> <span m='4283620'>a</span> <span m='4283680'>deletion.</span>
  <span m='4284640'>You</span> <span m='4284790'>get</span> <span m='4285000'>a</span>
  <span m='4285060'>whole</span> <span m='4285210'>bunch</span> <span m='4285480'>of</span>
  <span m='4285540'>crossings.</span> <span m='4290050'>Inserting</span> <span m='4290480'>an
  insertion</span> <span m='4290970'>and</span> <span m='4291150'>deleting</span>
  <span m='4291390'>a</span> <span m='4292290'>deletion</span> <span m='4292680'>are</span>
  <span m='4292770'>about</span> <span m='4292980'>the</span> <span m='4293100'>same.</span>
  <span m='4294330'>So</span> <span m='4294840'>the</span> <span m='4294960'>other</span>
  <span m='4295200'>case</span> <span m='4295740'>is</span> <span m='4295980'>inserting</span>
  <span m='4296430'>a</span> <span m='4296460'>deletion</span> <span m='4296880'>or</span>
  <span m='4296940'>deleting</span> <span m='4297360'>an</span> <span m='4297450'>insertion.</span>
  </p><p><span m='4300670'>So</span> <span m='4301410'>inserting</span> <span m='4302220'>a</span>
  <span m='4302610'>deletion.</span> <span m='4304200'>Let's</span> <span m='4304380'>say</span>
  <span m='4304620'>that</span> <span m='4304770'>I</span> <span m='4304890'>insert</span>
  <span m='4305370'>a</span> <span m='4305550'>deletion</span> <span m='4306660'>here.</span>
  <span m='4308170'>So</span> <span m='4308220'>now</span> <span m='4308430'>suddenly</span>
  <span m='4308820'>this</span> <span m='4309060'>thing</span> <span m='4309690'>ceases</span>
  <span m='4310140'>to</span> <span m='4310290'>exist.</span> <span m='4311220'>All</span>
  <span m='4311430'>of</span> <span m='4311490'>this</span> <span m='4311670'>is</span>
  <span m='4311790'>gone.</span> <span m='4312540'>We</span> <span m='4312630'>get</span>
  <span m='4312860'>not</span> <span m='4313110'>a</span> <span m='4313170'>crossing</span>
  <span m='4313770'>error,</span> <span m='4314010'>but</span> <span m='4314160'>we</span>
  <span m='4314280'>get</span> <span m='4314550'>what</span> <span m='4314730'>I'll</span>
  <span m='4314850'>call</span> <span m='4315090'>a</span> <span m='4315180'>floating</span>
  <span m='4315720'>air,</span> <span m='4316500'>which</span> <span m='4316620'>is</span>
  <span m='4316740'>that</span> <span m='4316860'>these</span> <span m='4317040'>guys</span>
  <span m='4317280'>are</span> <span m='4317370'>currently</span> <span m='4317730'>returning</span>
  <span m='4318180'>something</span> <span m='4318660'>that</span> <span m='4318960'>there's</span>
  <span m='4319170'>no</span> <span m='4319320'>segment</span> <span m='4319760'>there.</span>
  <span m='4322290'>OK,</span> <span m='4322560'>so</span> <span m='4322800'>we</span>
  <span m='4322920'>can</span> <span m='4323100'>get</span> <span m='4323340'>crossing</span>
  <span m='4323820'>errors</span> <span m='4325080'>and</span> <span m='4325320'>floating</span>
  <span m='4325710'>errors.</span> </p><p><span m='4335190'>I</span> <span m='4335250'>want</span>
  <span m='4335370'>to</span> <span m='4335430'>give</span> <span m='4335580'>you</span>
  <span m='4335640'>enough</span> <span m='4335910'>of</span> <span m='4335970'>this</span>
  <span m='4336120'>data</span> <span m='4336330'>structure</span> <span m='4336660'>to</span>
  <span m='4336780'>show</span> <span m='4336990'>that</span> <span m='4337110'>actually</span>
  <span m='4337560'>you</span> <span m='4337740'>use</span> <span m='4338670'>these</span>
  <span m='4338940'>data</span> <span m='4339180'>structures</span> <span m='4339630'>to</span>
  <span m='4339750'>solve</span> <span m='4340050'>it.</span> <span m='4342400'>So</span>
  <span m='4342420'>in</span> <span m='4342510'>that</span> <span m='4342630'>sense,</span>
  <span m='4342910'>it's</span> <span m='4343010'>actually</span> <span m='4343170'>not</span>
  <span m='4343350'>that</span> <span m='4343470'>much</span> <span m='4343770'>easier.</span>
  <span m='4344455'>I said</span> <span m='4344720'>it</span> <span m='4344800'>was</span>
  <span m='4344940'>easier,</span> <span m='4345300'>but</span> <span m='4345780'>we're</span>
  <span m='4345840'>going</span> <span m='4345990'>to</span> <span m='4346080'>need</span>
  <span m='4346670'>a</span> <span m='4346710'>retroactive</span> <span m='4347430'>successor</span>
  <span m='4348690'>in</span> <span m='4348810'>order</span> <span m='4348960'>to</span>
  <span m='4349110'>solve</span> <span m='4349380'>this</span> <span m='4349530'>problem.</span>
  </p><p><span m='4351840'>OK,</span> <span m='4353000'>some</span> <span m='4353990'>variants.</span>
  </p><p><span m='4366860'>Man,</span> <span m='4367100'>who</span> <span m='4367190'>used</span>
  <span m='4367470'>this</span> <span m='4367610'>colored</span> <span m='4367910'>chalk?</span>
  <span m='4368210'>It's</span> <span m='4368390'>so</span> <span m='4368450'>hard
  to</span> <span m='4368780'>erase.</span> </p><p><span m='4383740'>Let's</span>
  <span m='4383950'>say</span> <span m='4388300'>I</span> <span m='4388420'>want</span>
  <span m='4388600'>to</span> <span m='4388690'>maintain</span> <span m='4389560'>the</span>
  <span m='4390070'>lowest</span> <span m='4392308'>leftmost</span> <span m='4393300'>crossing.</span>
  </p><p><span m='4400740'>So</span> <span m='4400790'>in</span> <span m='4400880'>this</span>
  <span m='4401000'>picture,</span> <span m='4401400'>where</span> <span m='4401410'>I</span>
  <span m='4401480'>have</span> <span m='4401660'>a</span> <span m='4401720'>bunch</span>
  <span m='4401990'>of</span> <span m='4402050'>crossings,</span> <span m='4402590'>this</span>
  <span m='4402890'>is</span> <span m='4403010'>the</span> <span m='4403100'>one</span>
  <span m='4403250'>I</span> <span m='4403340'>want</span> <span m='4403520'>to</span>
  <span m='4403610'>maintain,</span> <span m='4404330'>the</span> <span m='4404450'>bottom</span>
  <span m='4404780'>left</span> <span m='4405060'>one.</span> <span m='4405690'>Now</span>
  <span m='4406110'>there's</span> <span m='4406350'>a</span> <span m='4406550'>bit</span>
  <span m='4406700'>of</span> <span m='4406790'>a</span> <span m='4406850'>subtlety</span>
  <span m='4407270'>here,</span> <span m='4407450'>which</span> <span m='4407630'>is</span>
  <span m='4407780'>do</span> <span m='4407870'>you</span> <span m='4408570'>do</span>
  <span m='4408700'>you</span> <span m='4408890'>minimize</span> <span m='4409400'>y-coordinate</span>
  <span m='4410000'>and</span> <span m='4410120'>then</span> <span m='4410240'>x-coordinate?</span>
  <span m='4410900'>Or</span> <span m='4411050'>vice</span> <span m='4411380'>versa?</span>
  <span m='4411680'>It</span> <span m='4411740'>turns</span> <span m='4412040'>out</span>
  <span m='4412130'>these</span> <span m='4412310'>are</span> <span m='4412370'>the</span>
  <span m='4412490'>same</span> <span m='4412760'>thing.</span> </p><p><span m='4416760'>I</span>
  <span m='4416900'>don't</span> <span m='4417020'>want</span> <span m='4417140'>to</span>
  <span m='4417200'>prove</span> <span m='4417500'>that</span> <span m='4417680'>here,</span>
  <span m='4418100'>but</span> <span m='4419030'>because</span> <span m='4419720'>of</span>
  <span m='4419840'>this</span> <span m='4420050'>assumption</span> <span m='4420590'>that</span>
  <span m='4420710'>we're</span> <span m='4420830'>always</span> <span m='4421130'>proceeding</span>
  <span m='4421550'>monotonically</span> <span m='4422210'>left</span> <span m='4422430'>to</span>
  <span m='4422540'>right,</span> <span m='4424110'>we</span> <span m='4424190'>have</span>
  <span m='4424340'>a</span> <span m='4424370'>nice</span> <span m='4424610'>invariant</span>
  <span m='4425060'>that</span> <span m='4425300'>if</span> <span m='4425450'>you</span>
  <span m='4425540'>look</span> <span m='4425720'>at</span> <span m='4425810'>all</span>
  <span m='4425960'>the</span> <span m='4426110'>crossings,</span> <span m='4427520'>they</span>
  <span m='4427760'>involve</span> <span m='4429470'>segments</span> <span m='4429920'>that</span>
  <span m='4430040'>start</span> <span m='4430340'>to</span> <span m='4430490'>the</span>
  <span m='4430610'>left</span> <span m='4430940'>of</span> <span m='4431030'>all</span>
  <span m='4431180'>errors.</span> <span m='4431480'>Because</span> <span m='4431630'>all</span>
  <span m='4431750'>the</span> <span m='4431870'>changes</span> <span m='4432230'>we've</span>
  <span m='4432380'>made</span> <span m='4432560'>are</span> <span m='4432650'>to</span>
  <span m='4432770'>the</span> <span m='4432860'>left</span> <span m='4433130'>of</span>
  <span m='4433220'>all</span> <span m='4433370'>errors</span> <span m='4433760'>by</span>
  <span m='4434030'>this</span> <span m='4434720'>property.</span> <span m='4436010'>And</span>
  <span m='4436130'>so</span> <span m='4436370'>it's</span> <span m='4436820'>really</span>
  <span m='4437000'>just</span> <span m='4437180'>a</span> <span m='4437240'>whole</span>
  <span m='4437390'>bunch</span> <span m='4437660'>of</span> <span m='4438260'>rays</span>
  <span m='4438680'>coming</span> <span m='4438950'>in</span> <span m='4439070'>from</span>
  <span m='4439250'>negative</span> <span m='4439580'>infinity</span> <span m='4440030'>on</span>
  <span m='4440120'>the</span> <span m='4440180'>left,</span> <span m='4440840'>and</span>
  <span m='4441020'>a whole</span> <span m='4441170'>bunch</span> <span m='4441410'>of</span>
  <span m='4441500'>rays</span> <span m='4441770'>coming</span> <span m='4442100'>from</span>
  <span m='4442610'>minus</span> <span m='4442970'>infinity</span> <span m='4443630'>on</span>
  <span m='4443870'>the</span> <span m='4443960'>bottom.</span> <span m='4445010'>Sometimes</span>
  <span m='4445550'>the</span> <span m='4445670'>rays</span> <span m='4445850'>stop.</span>
  <span m='4447200'>But</span> <span m='4447650'>if</span> <span m='4447800'>you</span>
  <span m='4447890'>look</span> <span m='4448040'>at</span> <span m='4448100'>where</span>
  <span m='4448220'>they</span> <span m='4448340'>cross,</span> <span m='4448860'>there's</span>
  <span m='4448940'>a</span> <span m='4449030'>uniquely</span> <span m='4449600'>defined</span>
  <span m='4450050'>bottom</span> <span m='4450350'>left</span> <span m='4450500'>corner.</span>
  </p><p><span m='4451730'>OK,</span> <span m='4452300'>so</span> <span m='4452540'>that's</span>
  <span m='4455180'>this</span> <span m='4455390'>picture.</span> <span m='4456482'>Those</span>
  <span m='4456820'>rays</span> <span m='4457120'>might</span> <span m='4457320'>go</span>
  <span m='4457520'>different</span> <span m='4457900'>amounts</span> <span m='4459020'>from</span>
  <span m='4459170'>either</span> <span m='4459380'>side,</span> <span m='4461090'>but</span>
  <span m='4461520'>there</span> <span m='4461690'>is</span> <span m='4461840'>a</span>
  <span m='4461900'>single</span> <span m='4463010'>lower</span> <span m='4463250'>left</span>
  <span m='4463460'>corner.</span> <span m='4464910'>So</span> <span m='4464930'>we're</span>
  <span m='4464990'>going</span> <span m='4465110'>to</span> <span m='4465170'>maintain</span>
  <span m='4465530'>that.</span> </p><p><span m='4466890'>And</span> <span m='4466940'>we're</span>
  <span m='4467090'>also</span> <span m='4467300'>going</span> <span m='4467540'>to</span>
  <span m='4467660'>maintain</span> <span m='4469550'>the</span> <span m='4470900'>leftmost</span>
  <span m='4471950'>floating</span> <span m='4472520'>point,</span> <span m='4478220'>floating</span>
  <span m='4478670'>error,</span> <span m='4480680'>on</span> <span m='4481190'>each</span>
  <span m='4481520'>row</span> <span m='4481910'>separately.</span> <span m='4484330'>So</span>
  <span m='4484400'>in</span> <span m='4484550'>each</span> <span m='4484730'>horizontal</span>
  <span m='4485210'>line,</span> <span m='4486640'>like</span> <span m='4486830'>here,</span>
  <span m='4487070'>we'll</span> <span m='4487190'>maintain</span> <span m='4487640'>that</span>
  <span m='4487790'>there's</span> <span m='4488000'>a</span> <span m='4488060'>floating</span>
  <span m='4488390'>error</span> <span m='4488570'>here</span> <span m='4488990'>for</span>
  <span m='4489170'>this</span> <span m='4489350'>row.</span> <span m='4489980'>But</span>
  <span m='4490380'>we</span> <span m='4490530'>won't</span> <span m='4490910'>figure</span>
  <span m='4491390'>out</span> <span m='4491480'>that</span> <span m='4491690'>one</span>
  <span m='4491960'>till</span> <span m='4492110'>later.</span> <span m='4493200'>That</span>
  <span m='4493310'>just</span> <span m='4493490'>saves</span> <span m='4493850'>the</span>
  <span m='4493970'>work</span> <span m='4494150'>we</span> <span m='4494270'>have</span>
  <span m='4494450'>to</span> <span m='4494540'>do.</span> </p><p><span m='4495880'>OK,</span>
  <span m='4496160'>now</span> <span m='4496490'>let</span> <span m='4496670'>me</span>
  <span m='4498170'>show</span> <span m='4498560'>you</span> <span m='4500180'>an</span>
  <span m='4500270'>operation</span> <span m='4502080'>let's</span> <span m='4502370'>do</span>
  <span m='4502660'>insert</span> <span m='4504350'>min.</span> <span m='4506360'>So</span>
  <span m='4506600'>I</span> <span m='4506690'>want</span> <span m='4506940'>to--</span>
  <span m='4507260'>I'm</span> <span m='4507380'>going to use</span> <span m='4507680'>x</span>
  <span m='4507980'>for</span> <span m='4508110'>time</span> <span m='4508430'>here,</span>
  <span m='4508610'>because</span> <span m='4508820'>it's</span> <span m='4509120'>a</span>
  <span m='4509150'>little</span> <span m='4509300'>bit</span> <span m='4509450'>more</span>
  <span m='4509570'>intuitive.</span> <span m='4510680'>X-coordinate</span> <span
  m='4511245'>is</span> <span m='4511580'>time.</span> </p><p><span m='4512660'>Suppose</span>
  <span m='4512930'>I</span> <span m='4513020'>want</span> <span m='4513140'>to</span>
  <span m='4513230'>insert</span> <span m='4513650'>a</span> <span m='4513770'>query.</span>
  <span m='4514430'>This</span> <span m='4514610'>is</span> <span m='4514760'>actually</span>
  <span m='4515030'>an</span> <span m='4515090'>easy</span> <span m='4515390'>case</span>
  <span m='4515750'>because</span> <span m='4517400'>there's</span> <span m='4517580'>no</span>
  <span m='4517700'>chain</span> <span m='4517910'>reactions</span> <span m='4518420'>here.</span>
  <span m='4519140'>It's</span> <span m='4519260'>going</span> <span m='4519410'>to</span>
  <span m='4519470'>be</span> <span m='4519590'>correct</span> <span m='4519950'>because</span>
  <span m='4520130'>I'm doing</span> <span m='4520340'>the</span> <span m='4520480'>query</span>
  <span m='4520730'>right</span> <span m='4520940'>now.</span> <span m='4521680'>This</span>
  <span m='4521870'>is</span> <span m='4522140'>basically</span> <span m='4522470'>a
  fully</span> <span m='4522770'>retroactive</span> <span m='4523400'>query.</span>
  <span m='4524300'>I'm</span> <span m='4524450'>adding</span> <span m='4524840'>a</span>
  <span m='4524900'>new</span> <span m='4525260'>time,</span> <span m='4525830'>a</span>
  <span m='4525920'>new</span> <span m='4526100'>query,</span> <span m='4526950'>and</span>
  <span m='4527080'>I</span> <span m='4527150'>want</span> <span m='4527360'>to</span>
  <span m='4527420'>know</span> <span m='4527600'>what</span> <span m='4527840'>is</span>
  <span m='4527960'>the</span> <span m='4528080'>first</span> <span m='4528410'>ray</span>
  <span m='4528740'>that</span> <span m='4528890'>I</span> <span m='4529010'>hit.</span>
  <span m='4532830'>How do</span> <span m='4533080'>I</span> <span m='4533180'>solve</span>
  <span m='4533460'>that?</span> </p><p><span m='4537800'>So</span> <span m='4538430'>what's</span>
  <span m='4538910'>going</span> <span m='4539450'>on</span> <span m='4539810'>here</span>
  <span m='4542040'>is</span> <span m='4542160'>I'm</span> <span m='4542270'>basically</span>
  <span m='4542630'>manipulating</span> <span m='4543380'>these</span> <span m='4543560'>line</span>
  <span m='4543860'>segments.</span> <span m='4546020'>I</span> <span m='4546260'>mean,</span>
  <span m='4546680'>the</span> <span m='4547520'>red</span> <span m='4547720'>lines</span>
  <span m='4548060'>don't</span> <span m='4548210'>really</span> <span m='4548600'>affect</span>
  <span m='4548930'>this</span> <span m='4549110'>query.</span> <span m='4550070'>They</span>
  <span m='4550190'>just</span> <span m='4550370'>might</span> <span m='4550580'>be</span>
  <span m='4550700'>incorrect.</span> <span m='4551360'>But</span> <span m='4551690'>I</span>
  <span m='4551720'>don't</span> <span m='4551870'>care</span> <span m='4552020'>if</span>
  <span m='4552110'>they're</span> <span m='4552200'>incorrect.</span> <span m='4552920'>I</span>
  <span m='4553010'>just</span> <span m='4553130'>want</span> <span m='4553280'>to</span>
  <span m='4553340'>know</span> <span m='4553470'>for</span> <span m='4553610'>this</span>
  <span m='4553790'>query,</span> <span m='4554090'>what</span> <span m='4554270'>is</span>
  <span m='4554390'>the</span> <span m='4554480'>lowest</span> <span m='4554660'>segment?</span>
  </p><p><span m='4555110'>So</span> <span m='4555160'>really,</span> <span m='4555530'>I
  have</span> <span m='4556010'>segments.</span> <span m='4556560'>They're</span>
  <span m='4556700'>changing.</span> <span m='4557510'>Inserting</span> <span m='4557930'>and</span>
  <span m='4558020'>deleting</span> <span m='4558350'>endpoints</span> <span m='4558700'>of</span>
  <span m='4558800'>the</span> <span m='4558890'>segments.</span> <span m='4560280'>And</span>
  <span m='4560300'>I</span> <span m='4560390'>want</span> <span m='4560540'>to</span>
  <span m='4560630'>know</span> <span m='4561380'>from</span> <span m='4561680'>below,</span>
  <span m='4563000'>what</span> <span m='4563180'>is</span> <span m='4563330'>the</span>
  <span m='4563420'>first</span> <span m='4563780'>segment</span> <span m='4564410'>that</span>
  <span m='4564500'>I</span> <span m='4564560'>hit?</span> <span m='4565190'>This</span>
  <span m='4565370'>is</span> <span m='4565460'>called</span> <span m='4566330'>upward</span>
  <span m='4566690'>ray-shooting.</span> <span m='4568810'>Or</span> <span m='4569400'>vertical</span>
  <span m='4569910'>ray-shooting,</span> <span m='4570350'>I</span> <span m='4570440'>guess,</span>
  <span m='4570620'>would</span> <span m='4570710'>be</span> <span m='4570800'>the</span>
  <span m='4570890'>normal</span> <span m='4572120'>phrasing,</span> <span m='4572610'>but</span>
  <span m='4572750'>I</span> <span m='4572810'>want</span> <span m='4572960'>to</span>
  <span m='4573020'>be</span> <span m='4573230'>a</span> <span m='4573260'>little</span>
  <span m='4573440'>more</span> <span m='4573620'>specific.</span> <span m='4574390'>Not</span>
  <span m='4574580'>downward</span> <span m='4575060'>upward.</span> <span m='4577610'>Among</span>
  <span m='4578110'>dynamic</span> <span m='4578630'>segments.</span> </p><p><span
  m='4582730'>This</span> <span m='4582770'>is</span> <span m='4582890'>a</span> <span
  m='4583000'>well-studied</span> <span m='4583460'>problem.</span> <span m='4587960'>And</span>
  <span m='4588080'>conveniently,</span> <span m='4588740'>it</span> <span m='4588860'>can</span>
  <span m='4588980'>be</span> <span m='4589070'>solved</span> <span m='4589430'>in</span>
  <span m='4589550'>log</span> <span m='4589760'>n</span> <span m='4589880'>time</span>
  <span m='4590110'>preparation.</span> <span m='4590750'>So</span> <span m='4590930'>you</span>
  <span m='4591080'>can</span> <span m='4591770'>modify</span> <span m='4592130'>segments</span>
  <span m='4593180'>and</span> <span m='4594230'>do</span> <span m='4594540'>upward</span>
  <span m='4594910'>ray-shooting</span> <span m='4595250'>queries</span> <span m='4595850'>in</span>
  <span m='4595970'>log</span> <span m='4596180'>n</span> <span m='4596300'>type</span>
  <span m='4596480'>preparation.</span> <span m='4597620'>But</span> <span m='4598250'>you</span>
  <span m='4598550'>already</span> <span m='4599030'>knew</span> <span m='4599330'>that.</span>
  <span m='4600590'>Good,</span> <span m='4601540'>you're</span> <span m='4601560'>nodding</span>
  <span m='4601880'>your</span> <span m='4601970'>head.</span> <span m='4602630'>Because</span>
  <span m='4602930'>that</span> <span m='4603200'>is</span> <span m='4603410'>retroactive</span>
  <span m='4603980'>successor,</span> <span m='4605030'>if</span> <span m='4605120'>you</span>
  <span m='4605180'>think</span> <span m='4605390'>about</span> <span m='4605630'>it.</span>
  <span m='4606520'>A</span> <span m='4606820'>retroactive</span> <span m='4607610'>insertion</span>
  <span m='4608210'>operation</span> <span m='4608720'>in</span> <span m='4608810'>the</span>
  <span m='4608930'>past</span> <span m='4609950'>is</span> <span m='4610190'>like</span>
  <span m='4610670'>its</span> <span m='4610850'>fully</span> <span m='4611330'>retroactive</span>
  <span m='4611990'>successor.</span> <span m='4612620'>That's</span> <span m='4613310'>this</span>
  <span m='4613460'>result.</span> </p><p><span m='4615260'>Inserting</span> <span
  m='4616130'>an</span> <span m='4616280'>insertion,</span> <span m='4616970'>that's</span>
  <span m='4617180'>like</span> <span m='4617330'>creating</span> <span m='4617720'>a</span>
  <span m='4617780'>new</span> <span m='4617960'>left</span> <span m='4618290'>endpoint</span>
  <span m='4618540'>point</span> <span m='4618680'>of</span> <span m='4618770'>a</span>
  <span m='4618830'>segment.</span> <span m='4619670'>Inserting</span> <span m='4620030'>a</span>
  <span m='4620090'>deletion</span> <span m='4620510'>is</span> <span m='4620630'>like</span>
  <span m='4621050'>creating</span> <span m='4621410'>a</span> <span m='4621470'>new</span>
  <span m='4621590'>right</span> <span m='4621800'>endpoint.</span> <span m='4622230'>Deleting</span>
  <span m='4622700'>a</span> <span m='4622730'>deletion</span> <span m='4623080'>or</span>
  <span m='4623170'>deleting</span> <span m='4623870'>an</span> <span m='4624040'>insertion,</span>
  <span m='4625400'>you</span> <span m='4625700'>could</span> <span m='4625850'>use</span>
  <span m='4626030'>that</span> <span m='4626210'>to</span> <span m='4626330'>move</span>
  <span m='4626690'>the</span> <span m='4626840'>endpoint.</span> <span m='4627870'>So</span>
  <span m='4627920'>that's</span> <span m='4628130'>exactly</span> <span m='4628580'>dynamic</span>
  <span m='4629720'>segments,</span> <span m='4630710'>horizontal</span> <span m='4631280'>segments.</span>
  </p><p><span m='4632600'>And</span> <span m='4632720'>then</span> <span m='4632840'>shooting</span>
  <span m='4633230'>a ray</span> <span m='4634370'>is--</span> <span m='4635660'>in</span>
  <span m='4635780'>general--</span> <span m='4636860'>a</span> <span m='4637070'>general</span>
  <span m='4637460'>ray-shooting</span> <span m='4637880'>query is</span> <span m='4638150'>like</span>
  <span m='4638300'>this.</span> <span m='4638780'>I</span> <span m='4639110'>can</span>
  <span m='4639260'>be</span> <span m='4639530'>not</span> <span m='4639800'>from</span>
  <span m='4639950'>minus</span> <span m='4640220'>infinity,</span> <span m='4640670'>be
  at</span> <span m='4640850'>an</span> <span m='4640940'>arbitrary</span> <span m='4641390'>point,</span>
  <span m='4642440'>and</span> <span m='4642560'>ask,</span> <span m='4642930'>what</span>
  <span m='4643010'>do</span> <span m='4643130'>I</span> <span m='4643190'>hit</span>
  <span m='4643790'>upward</span> <span m='4644280'>next?</span> <span m='4644840'>That</span>
  <span m='4645020'>is</span> <span m='4645140'>like</span> <span m='4645440'>at</span>
  <span m='4645710'>this</span> <span m='4645920'>time</span> <span m='4646880'>doing</span>
  <span m='4647150'>a</span> <span m='4647210'>successor</span> <span m='4647690'>query.</span>
  </p><p><span m='4649290'>OK,</span> <span m='4649440'>now</span> <span m='4649580'>this</span>
  <span m='4649760'>is</span> <span m='4649910'>a</span> <span m='4649970'>special</span>
  <span m='4650360'>kind</span> <span m='4650540'>of</span> <span m='4650630'>successor</span>
  <span m='4651050'>query,</span> <span m='4651260'>because</span> <span m='4651410'>it's</span>
  <span m='4651500'>always</span> <span m='4651740'>from</span> <span m='4651860'>minus</span>
  <span m='4652160'>infinity.</span> <span m='4653390'>So</span> <span m='4653570'>you</span>
  <span m='4653690'>might</span> <span m='4653840'>be</span> <span m='4653930'>able</span>
  <span m='4654050'>to</span> <span m='4654140'>solve</span> <span m='4654370'>it</span>
  <span m='4654440'>easier.</span> <span m='4654890'>But</span> <span m='4655040'>in</span>
  <span m='4655160'>particular,</span> <span m='4655740'>you</span> <span m='4655790'>can</span>
  <span m='4655940'>solve</span> <span m='4656240'>it</span> <span m='4656750'>using</span>
  <span m='4657440'>this</span> <span m='4657710'>result.</span> <span m='4659610'>So</span>
  <span m='4660350'>regular</span> <span m='4660740'>retroactivity</span> <span m='4662270'>helps</span>
  <span m='4662630'>you</span> <span m='4662750'>do</span> <span m='4663140'>nonoblivious</span>
  <span m='4663710'>retroactivity.</span> <span m='4665846'>Cool.</span> </p><p><span
  m='4673090'>We're out</span> <span m='4673330'>of</span> <span m='4673390'>time.</span>
  <span m='4674860'>So</span> <span m='4675280'>I</span> <span m='4675430'>will</span>
  <span m='4675610'>just</span> <span m='4675820'>say,</span> <span m='4677920'>the</span>
  <span m='4678070'>other</span> <span m='4678250'>cases</span> <span m='4678580'>are</span>
  <span m='4678670'>similar.</span> <span m='4680800'>There's</span> <span m='4681070'>one</span>
  <span m='4681280'>other</span> <span m='4681460'>thing</span> <span m='4681640'>you</span>
  <span m='4681730'>need</span> <span m='4681880'>to</span> <span m='4682000'>do,</span>
  <span m='4682310'>which</span> <span m='4682390'>is</span> <span m='4682510'>in</span>
  <span m='4682630'>addition</span> <span m='4682960'>to</span> <span m='4683140'>upward</span>
  <span m='4683415'>ray-shooting,</span> <span m='4684490'>you</span> <span m='4684550'>have</span>
  <span m='4684670'>to</span> <span m='4684760'>do</span> <span m='4684910'>rightward</span>
  <span m='4685300'>ray-shooting</span> <span m='4686410'>because</span> <span m='4686860'>of</span>
  <span m='4686950'>things</span> <span m='4687190'>like</span> <span m='4687370'>this.</span>
  <span m='4687580'>If</span> <span m='4687730'>I</span> <span m='4687820'>delete</span>
  <span m='4688150'>this</span> <span m='4688300'>deletion,</span> <span m='4688780'>I</span>
  <span m='4688840'>want</span> <span m='4689020'>to</span> <span m='4689080'>know</span>
  <span m='4689230'>what</span> <span m='4689380'>do</span> <span m='4689500'>I</span>
  <span m='4689560'>hit</span> <span m='4689740'>next.</span> <span m='4690580'>So</span>
  <span m='4690670'>that's</span> <span m='4690930'>a rightward</span> <span m='4691150'>ray-shooting</span>
  <span m='4691810'>among</span> <span m='4692080'>dynamic</span> <span m='4692590'>segments,</span>
  <span m='4693070'>which</span> <span m='4693250'>all</span> <span m='4693430'>happen</span>
  <span m='4693730'>to</span> <span m='4693910'>start</span> <span m='4694210'>at</span>
  <span m='4694300'>minus</span> <span m='4694600'>infinity.</span> <span m='4695530'>So</span>
  <span m='4695650'>it's</span> <span m='4695770'>again--</span> <span m='4697060'>it's</span>
  <span m='4697390'>dynamic</span> <span m='4698340'>ray-shooting,</span> <span m='4699470'>or</span>
  <span m='4699580'>successor</span> <span m='4700050'>queries,</span> <span m='4701080'>but</span>
  <span m='4701290'>in</span> <span m='4701860'>x</span> <span m='4702130'>instead</span>
  <span m='4702430'>of</span> <span m='4702520'>y.</span> <span m='4703450'>So</span>
  <span m='4703750'>with those</span> <span m='4703990'>tricks,</span> <span m='4704500'>you</span>
  <span m='4704620'>can</span> <span m='4704740'>do</span> <span m='4704860'>all</span>
  <span m='4705310'>of</span> <span m='4705460'>the</span> <span m='4705580'>cases</span>
  <span m='4705920'>of</span> <span m='4706060'>inserting</span> <span m='4706510'>deleting,</span>
  <span m='4707410'>deleting</span> <span m='4707800'>insertions,</span> <span m='4708670'>inserting,</span>
  <span m='4710680'>all</span> <span m='4711070'>combinations</span> <span m='4711850'>of</span>
  <span m='4711970'>those</span> <span m='4712210'>things.</span> </p>
type: course
uid: 7a6f6d94d65b1f04b0f7e26b47f4a490

---
None