---
about_this_resource_text: '<p><strong>Description:</strong> Memory hierarchy: Ordered-file
  maintenance, list labeling, order queries, cache-oblivious priority queues.</p>
  <p><strong>Speaker:</strong> Prof. Erik Demaine</p>'
course_id: 6-851-advanced-data-structures-spring-2012
embedded_media:
- id: Video-YouTube-Stream
  media_location: bY8f4DSkQ6M
  parent_uid: 4c9a2d83a6fe9e0bbecbd1597dc48960
  title: Video-YouTube-Stream
  type: Video
  uid: 945164572cd562cd6daa22839ba33403
- id: Video-iTunesU-MP4
  media_location: https://itunes.apple.com/us/itunes-u/session-8-cache-oblivious/id735348884?i=169609920
  parent_uid: 4c9a2d83a6fe9e0bbecbd1597dc48960
  title: Video-iTunes U-MP4
  type: Video
  uid: 260f86e24ab89f090ba6eb16f8543b35
- id: Video-InternetArchive-MP4
  media_location: http://www.archive.org/download/MIT6.851S12/MIT6_851S12_lec08_300k.mp4
  parent_uid: 4c9a2d83a6fe9e0bbecbd1597dc48960
  title: Video-Internet Archive-MP4
  type: Video
  uid: 30cb3d6fa62a88672d91c2e57ed59bf6
- id: Thumbnail-YouTube-JPG
  media_location: https://img.youtube.com/vi/bY8f4DSkQ6M/default.jpg
  parent_uid: 4c9a2d83a6fe9e0bbecbd1597dc48960
  title: Thumbnail-YouTube-JPG
  type: Thumbnail
  uid: e229f5ab6f4e4400c4ba899aeb767051
- id: 3Play-3PlayYouTubeid-MP4
  media_location: bY8f4DSkQ6M
  parent_uid: 4c9a2d83a6fe9e0bbecbd1597dc48960
  title: 3Play-3Play YouTube id
  type: 3Play
  uid: 398f7bf0cf56911ded49dcba20b0d40b
- id: bY8f4DSkQ6M.srt
  parent_uid: 4c9a2d83a6fe9e0bbecbd1597dc48960
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-851-advanced-data-structures-spring-2012/lecture-videos/session-8-cache-oblivious-structures-i/bY8f4DSkQ6M.srt
  title: 3play caption file
  type: null
  uid: 4892c44ca1fa5cfa4b7f3ddb283811b7
- id: bY8f4DSkQ6M.pdf
  parent_uid: 4c9a2d83a6fe9e0bbecbd1597dc48960
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-851-advanced-data-structures-spring-2012/lecture-videos/session-8-cache-oblivious-structures-i/bY8f4DSkQ6M.pdf
  title: 3play pdf file
  type: null
  uid: 3f709b19ee1b973f99127558377c6fbf
- id: Caption-3Play YouTube id-SRT
  parent_uid: 4c9a2d83a6fe9e0bbecbd1597dc48960
  title: Caption-3Play YouTube id-SRT-English - US
  type: Caption
  uid: 90d745723519e2b27260b4d1cb8298cf
- id: Transcript-3Play YouTube id-PDF
  parent_uid: 4c9a2d83a6fe9e0bbecbd1597dc48960
  title: Transcript-3Play YouTube id-PDF-English - US
  type: Transcript
  uid: 91c4d2035beb8b687996379b85f7e679
inline_embed_id: 87093533session8:cache-obliviousstructuresi2785166
layout: video
order_index: null
parent_uid: b66cbbb7b35e74ff17cdbf44e5fb6b1d
related_resources_text: ''
short_url: session-8-cache-oblivious-structures-i
technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-851-advanced-data-structures-spring-2012/lecture-videos/session-8-cache-oblivious-structures-i
template_type: Tabbed
title: 'Session 8: Cache-Oblivious Structures I'
transcript: <p><span m='90'>The</span> <span m='180'>following</span> <span m='630'>content</span>
  <span m='1200'>is</span> <span m='1320'>provided</span> <span m='1770'>under</span>
  <span m='2009'>a</span> <span m='2070'>Creative</span> <span m='2490'>Commons</span>
  <span m='2910'>license.</span> <span m='4030'>Your</span> <span m='4200'>support</span>
  <span m='4710'>will</span> <span m='4860'>help</span> <span m='5100'>MIT</span>
  <span m='5550'>OpenCourseWare</span> <span m='6360'>continue</span> <span m='6870'>to</span>
  <span m='6960'>offer</span> <span m='7380'>high-quality</span> <span m='8100'>educational</span>
  <span m='8730'>resources</span> <span m='9330'>for</span> <span m='9510'>free.</span>
  <span m='10720'>To</span> <span m='10740'>make</span> <span m='10920'>a</span> <span
  m='10980'>donation</span> <span m='11730'>or</span> <span m='11940'>view</span>
  <span m='12390'>additional</span> <span m='12810'>materials</span> <span m='13320'>from</span>
  <span m='13500'>hundreds</span> <span m='13920'>of</span> <span m='14040'>MIT</span>
  <span m='14460'>courses,</span> <span m='15550'>visit</span> <span m='15780'>MIT</span>
  <span m='16200'>OpenCourseWare</span> <span m='17280'>at</span> <span m='17430'>ocw.mit.edu.</span>
  </p><p><span m='21500'>ERIK DEMAINE:</span> <span m='21530'>All</span> <span m='21560'>right.</span>
  <span m='21860'>Today,</span> <span m='22190'>we</span> <span m='22550'>resume</span>
  <span m='23240'>our</span> <span m='23600'>theme</span> <span m='23930'>of</span>
  <span m='24140'>memory</span> <span m='24620'>hierarchy</span> <span m='25700'>efficient</span>
  <span m='26180'>data</span> <span m='26480'>structures.</span> <span m='27680'>And</span>
  <span m='28280'>last</span> <span m='28580'>time,</span> <span m='28790'>we</span>
  <span m='28910'>saw</span> <span m='29300'>cache-oblivious</span> <span m='30140'>b-trees,</span>
  <span m='30920'>which</span> <span m='31160'>achieve</span> <span m='32450'>log</span>
  <span m='34070'>base</span> <span m='34320'>B</span> <span m='34490'>of N</span>
  <span m='35000'>for</span> <span m='36320'>all</span> <span m='36530'>operations--</span>
  <span m='40350'>insert,</span> <span m='41820'>delete,</span> <span m='42110'>search.</span>
  </p><p><span m='46160'>And</span> <span m='46400'>the</span> <span m='46490'>cool</span>
  <span m='46700'>part</span> <span m='47060'>is</span> <span m='47210'>that</span>
  <span m='47330'>we</span> <span m='47450'>could</span> <span m='47600'>do</span>
  <span m='47750'>that</span> <span m='48110'>without</span> <span m='48590'>knowing</span>
  <span m='49310'>what</span> <span m='49550'>B</span> <span m='49760'>was.</span>
  <span m='51770'>And</span> <span m='51980'>it</span> <span m='52040'>was</span>
  <span m='52190'>basically</span> <span m='53410'>a</span> <span m='53590'>binary</span>
  <span m='53930'>search</span> <span m='54260'>tree</span> <span m='55160'>stored</span>
  <span m='55550'>in</span> <span m='55670'>a</span> <span m='55730'>funny</span>
  <span m='56030'>order,</span> <span m='56300'>this</span> <span m='56450'>van Emde</span>
  <span m='56740'>Boas</span> <span m='57110'>order,</span> <span m='58310'>with</span>
  <span m='58610'>an</span> <span m='58760'>ordered</span> <span m='59150'>file</span>
  <span m='59780'>on</span> <span m='59870'>the</span> <span m='59990'>bottom,</span>
  <span m='60860'>which</span> <span m='61040'>we</span> <span m='61130'>left</span>
  <span m='61340'>as</span> <span m='61460'>a</span> <span m='61490'>black</span>
  <span m='61790'>box.</span> <span m='62150'>And</span> <span m='62270'>today,</span>
  <span m='63020'>we're</span> <span m='63140'>going</span> <span m='63380'>to</span>
  <span m='63500'>see</span> <span m='63710'>how</span> <span m='63830'>to</span>
  <span m='63920'>actually</span> <span m='64310'>do</span> <span m='64519'>ordered</span>
  <span m='64819'>files--</span> <span m='65810'>in</span> <span m='66050'>log</span>
  <span m='66380'>squared</span> <span m='66920'>N,</span> <span m='68300'>data</span>
  <span m='68600'>moves</span> <span m='69410'>per</span> <span m='69830'>insert</span>
  <span m='70160'>and</span> <span m='70250'>delete.</span> </p><p><span m='71960'>And</span>
  <span m='72170'>then</span> <span m='72320'>as</span> <span m='72470'>a</span> <span
  m='72530'>little</span> <span m='72770'>diversion,</span> <span m='73430'>we'll</span>
  <span m='74060'>see</span> <span m='74315'>a</span> <span m='74570'>closer</span>
  <span m='74930'>related</span> <span m='75290'>problem to</span> <span m='75780'>this</span>
  <span m='75860'>is</span> <span m='75980'>called</span> <span m='76190'>list</span>
  <span m='76460'>labeling,</span> <span m='77330'>which</span> <span m='77600'>we</span>
  <span m='77750'>needed</span> <span m='78080'>in</span> <span m='78200'>Lecture</span>
  <span m='78620'>1</span> <span m='79160'>and</span> <span m='79280'>left</span>
  <span m='79580'>it</span> <span m='79670'>as</span> <span m='79820'>a</span> <span
  m='79880'>black</span> <span m='80150'>box</span> <span m='80600'>for</span> <span
  m='81140'>full</span> <span m='81350'>persistence.</span> <span m='82100'>We</span>
  <span m='82250'>had</span> <span m='82490'>this</span> <span m='83030'>version</span>
  <span m='83660'>tree</span> <span m='84430'>with</span> <span m='84590'>full</span>
  <span m='84830'>persistence,</span> <span m='86030'>and</span> <span m='86210'>we</span>
  <span m='86300'>needed</span> <span m='86510'>to</span> <span m='86870'>linearize</span>
  <span m='87790'>that</span> <span m='89390'>version</span> <span m='89750'>tree</span>
  <span m='90140'>into</span> <span m='91130'>a</span> <span m='91190'>bunch</span>
  <span m='91460'>of</span> <span m='91580'>numbers</span> <span m='92000'>so</span>
  <span m='92180'>that</span> <span m='92330'>we</span> <span m='92450'>could</span>
  <span m='92600'>then</span> <span m='92810'>compare</span> <span m='93920'>whether</span>
  <span m='94160'>one</span> <span m='94340'>version</span> <span m='94640'>was</span>
  <span m='94760'>an</span> <span m='94850'>ancestor</span> <span m='95330'>of</span>
  <span m='95420'>another.</span> <span m='95870'>And</span> <span m='95990'>for</span>
  <span m='96110'>that,</span> <span m='96230'>we</span> <span m='96350'>needed</span>
  <span m='96980'>to</span> <span m='97100'>be</span> <span m='97190'>able</span>
  <span m='97340'>to</span> <span m='97430'>store</span> <span m='97610'>a</span>
  <span m='97640'>linked</span> <span m='97880'>list,</span> <span m='98240'>and</span>
  <span m='98390'>insert</span> <span m='98720'>and</span> <span m='98810'>delete</span>
  <span m='99110'>in</span> <span m='99260'>the</span> <span m='99350'>linked</span>
  <span m='99560'>list,</span> <span m='100400'>and</span> <span m='100580'>be</span>
  <span m='100700'>able</span> <span m='100910'>to</span> <span m='101120'>query,</span>
  <span m='101660'>who</span> <span m='102590'>is</span> <span m='102890'>this</span>
  <span m='104030'>node</span> <span m='104290'>in</span> <span m='104360'>the</span>
  <span m='104420'>linked</span> <span m='104630'>list,</span> <span m='104930'>precede</span>
  <span m='105950'>this</span> <span m='106130'>node</span> <span m='106340'>in</span>
  <span m='106430'>the</span> <span m='106490'>linked</span> <span m='106700'>list</span>
  <span m='107690'>in</span> <span m='107840'>constant</span> <span m='108290'>time</span>
  <span m='108510'>per</span> <span m='108730'>operation.</span> <span m='109035'>So</span>
  <span m='109340'>we'll</span> <span m='109430'>also</span> <span m='109730'>do</span>
  <span m='109850'>that</span> <span m='110060'>today</span> <span m='110960'>because</span>
  <span m='111250'>it's</span> <span m='112480'>time.</span> </p><p><span m='114170'>And</span>
  <span m='114380'>then</span> <span m='114650'>we're</span> <span m='114770'>going</span>
  <span m='114920'>to</span> <span m='115160'>do</span> <span m='115370'>a</span>
  <span m='115430'>completely</span> <span m='115850'>different</span> <span m='116150'>cache-oblivious</span>
  <span m='116750'>data</span> <span m='116960'>structure.</span> <span m='118070'>That's</span>
  <span m='118490'>interesting,</span> <span m='119340'>mainly</span> <span m='119750'>in</span>
  <span m='119900'>the</span> <span m='119990'>way</span> <span m='120170'>that</span>
  <span m='120320'>it</span> <span m='120410'>adapts</span> <span m='120770'>to</span>
  <span m='121040'>M,</span> <span m='121670'>not</span> <span m='121940'>just</span>
  <span m='122360'>B.</span> <span m='123560'>So</span> <span m='123800'>remember,</span>
  <span m='124400'>B</span> <span m='124850'>was</span> <span m='125150'>the</span>
  <span m='125300'>size</span> <span m='125630'>of</span> <span m='125720'>a</span>
  <span m='125990'>memory</span> <span m='126320'>block.</span> <span m='126680'>When</span>
  <span m='126830'>we</span> <span m='126920'>fetch</span> <span m='127160'>something</span>
  <span m='127430'>from</span> <span m='127580'>memory,</span> <span m='127850'>we</span>
  <span m='127970'>get</span> <span m='128120'>the</span> <span m='128210'>entire</span>
  <span m='128509'>block</span> <span m='128810'>of</span> <span m='128870'>size</span>
  <span m='129139'>B.</span> <span m='129710'>M</span> <span m='130039'>was</span>
  <span m='130250'>the</span> <span m='130340'>size</span> <span m='130669'>of</span>
  <span m='130759'>the</span> <span m='130889'>cache.</span> <span m='132050'>And</span>
  <span m='132140'>so</span> <span m='132260'>there</span> <span m='132360'>were M</span>
  <span m='132650'>over B</span> <span m='133100'>blocks</span> <span m='133820'>in</span>
  <span m='133970'>the</span> <span m='134060'>cache of</span> <span m='134520'>size</span>
  <span m='134810'>B.</span> <span m='136550'>So</span> <span m='136790'>that's</span>
  <span m='137000'>what</span> <span m='137120'>we'll</span> <span m='137240'>do</span>
  <span m='137420'>today.</span> </p><p><span m='140180'>I'm</span> <span m='140390'>also</span>
  <span m='140660'>going</span> <span m='140930'>to</span> <span m='141080'>need</span>
  <span m='142850'>a</span> <span m='144080'>claim--</span> <span m='147332'>which
  we</span> <span m='147770'>won't</span> <span m='148040'>prove</span> <span m='148400'>here--</span>
  <span m='149710'>that</span> <span m='149840'>you</span> <span m='150020'>can</span>
  <span m='150200'>sort</span> <span m='151820'>cache-obliviously</span> <span m='152900'>in</span>
  <span m='153080'>N</span> <span m='153270'>over</span> <span m='153510'>B</span>
  <span m='153830'>log</span> <span m='154160'>base</span> <span m='154460'>N</span>
  <span m='154660'>over</span> <span m='154830'>B</span> <span m='155130'>of</span>
  <span m='155330'>N</span> <span m='155510'>over</span> <span m='155720'>B.</span>
  <span m='156920'>So</span> <span m='157070'>I'm</span> <span m='157130'>going</span>
  <span m='157250'>to</span> <span m='157340'>use</span> <span m='157580'>this</span>
  <span m='157790'>as</span> <span m='157910'>a</span> <span m='157970'>black</span>
  <span m='158240'>box</span> <span m='158600'>today.</span> <span m='159120'>And</span>
  <span m='159290'>we're</span> <span m='159380'>not</span> <span m='159530'>going</span>
  <span m='159650'>to</span> <span m='159710'>fill</span> <span m='159920'>it</span>
  <span m='160010'>in</span> <span m='160130'>because</span> <span m='160370'>it's</span>
  <span m='160490'>not</span> <span m='160670'>a</span> <span m='160730'>data</span>
  <span m='161030'>structure,</span> <span m='161410'>and it's</span> <span m='161570'>a</span>
  <span m='161630'>data</span> <span m='161870'>structures</span> <span m='162260'>class.</span>
  </p><p><span m='163480'>To</span> <span m='163640'>give</span> <span m='163790'>you</span>
  <span m='163910'>some</span> <span m='164600'>feeling</span> <span m='164960'>for</span>
  <span m='165110'>why</span> <span m='165500'>this</span> <span m='165710'>is</span>
  <span m='165800'>the</span> <span m='165920'>right</span> <span m='166130'>bound</span>
  <span m='166340'>for</span> <span m='166460'>sorting,</span> <span m='167390'>if</span>
  <span m='167570'>you</span> <span m='167690'>know</span> <span m='168140'>M and</span>
  <span m='168500'>B,</span> <span m='169970'>then</span> <span m='170300'>the</span>
  <span m='170450'>answer</span> <span m='170930'>is</span> <span m='171810'>M</span>
  <span m='172120'>over</span> <span m='172430'>B</span> <span m='173380'>way</span>
  <span m='174410'>mergesort.</span> <span m='181480'>So</span> <span m='182340'>you</span>
  <span m='182550'>all</span> <span m='182640'>know</span> <span m='182790'>binary</span>
  <span m='183210'>mergesort,</span> <span m='184290'>where</span> <span m='184410'>you</span>
  <span m='184620'>split</span> <span m='184890'>into</span> <span m='185100'>two</span>
  <span m='185280'>parts.</span> <span m='186060'>If</span> <span m='186180'>you</span>
  <span m='186270'>split</span> <span m='186540'>into</span> <span m='186780'>M over</span>
  <span m='187050'>B</span> <span m='187320'>parts</span> <span m='187770'>and</span>
  <span m='187920'>then</span> <span m='188040'>do</span> <span m='188160'>an</span>
  <span m='188250'>M</span> <span m='188520'>over</span> <span m='188720'>B</span>
  <span m='188880'>way</span> <span m='189060'>merge,</span> <span m='189870'>that's</span>
  <span m='190020'>exactly</span> <span m='190620'>what</span> <span m='190950'>a</span>
  <span m='191040'>cache</span> <span m='191400'>can</span> <span m='191550'>handle.</span>
  <span m='192390'>It</span> <span m='193170'>can</span> <span m='193380'>read</span>
  <span m='193650'>one</span> <span m='193950'>block</span> <span m='194310'>from</span>
  <span m='194520'>each</span> <span m='194790'>of</span> <span m='194910'>the</span>
  <span m='195030'>lists</span> <span m='195320'>that</span> <span m='195480'>it's</span>
  <span m='195630'>trying</span> <span m='196500'>to</span> <span m='196650'>merge.</span>
  <span m='197470'>It</span> <span m='197780'>has</span> <span m='198000'>just</span>
  <span m='198270'>enough</span> <span m='198570'>cache</span> <span m='199590'>blocks</span>
  <span m='200010'>for</span> <span m='200130'>that.</span> </p><p><span m='201000'>And</span>
  <span m='201180'>then</span> <span m='201840'>you</span> <span m='202020'>do</span>
  <span m='202200'>the</span> <span m='202290'>merge</span> <span m='202710'>block</span>
  <span m='202980'>by</span> <span m='203100'>block,</span> <span m='203460'>load</span>
  <span m='203700'>new</span> <span m='203880'>blocks</span> <span m='204210'>as</span>
  <span m='204300'>necessary.</span> <span m='205230'>That</span> <span m='205380'>will</span>
  <span m='205470'>give</span> <span m='205650'>you</span> <span m='205740'>a</span>
  <span m='205770'>linear</span> <span m='206100'>time</span> <span m='206340'>merge.</span>
  <span m='206790'>And</span> <span m='206910'>so</span> <span m='207030'>you'll</span>
  <span m='207180'>get</span> <span m='207390'>N</span> <span m='207540'>over</span>
  <span m='207820'>B</span> <span m='208440'>times</span> <span m='208740'>log</span>
  <span m='209000'>base</span> <span m='209210'>M</span> <span m='209360'>over</span>
  <span m='209570'>B.</span> <span m='209850'>And</span> <span m='209970'>it</span>
  <span m='210030'>turns</span> <span m='210270'>out</span> <span m='210420'>the</span>
  <span m='210510'>right</span> <span m='210990'>thing</span> <span m='211170'>in</span>
  <span m='211270'>here</span> <span m='211530'>is N</span> <span m='211650'>over</span>
  <span m='211890'>B or</span> <span m='212250'>N</span> <span m='212460'>is</span>
  <span m='212940'>basically</span> <span m='213300'>the</span> <span m='213390'>same,</span>
  <span m='214530'>because</span> <span m='214710'>it's</span> <span m='214830'>inside</span>
  <span m='215130'>the</span> <span m='215220'>log.</span> <span m='215520'>It's</span>
  <span m='215610'>not</span> <span m='215790'>a</span> <span m='215850'>big</span>
  <span m='216000'>deal.</span> </p><p><span m='217530'>So</span> <span m='217770'>external</span>
  <span m='218160'>memory</span> <span m='218460'>wise,</span> <span m='218700'>that's</span>
  <span m='218910'>how</span> <span m='219000'>you</span> <span m='219150'>do</span>
  <span m='219330'>it.</span> <span m='220090'>You</span> <span m='220110'>can</span>
  <span m='220260'>do</span> <span m='220350'>this</span> <span m='220500'>cache-obliviously</span>
  <span m='221520'>in</span> <span m='221700'>a</span> <span m='221790'>similar</span>
  <span m='222450'>way</span> <span m='222840'>to--</span> <span m='225930'>roughly</span>
  <span m='226320'>speaking,</span> <span m='226870'>in</span> <span m='226970'>a</span>
  <span m='227070'>similar</span> <span m='227280'>way</span> <span m='227430'>to</span>
  <span m='227550'>the</span> <span m='227670'>way</span> <span m='227850'>we</span>
  <span m='227970'>do</span> <span m='228150'>b-trees,</span> <span m='229350'>where</span>
  <span m='229530'>you're</span> <span m='229710'>binary</span> <span m='230070'>searching</span>
  <span m='232350'>in</span> <span m='233010'>the</span> <span m='233260'>number</span>
  <span m='233550'>of</span> <span m='233640'>ways</span> <span m='233940'>you</span>
  <span m='234060'>should</span> <span m='234210'>divide</span> <span m='234630'>your</span>
  <span m='236610'>array</span> <span m='236910'>into.</span> <span m='237540'>I'm</span>
  <span m='237630'>not</span> <span m='237750'>going</span> <span m='237900'>to</span>
  <span m='237960'>get</span> <span m='238050'>into</span> <span m='238200'>details
  on</span> <span m='238660'>that.</span> <span m='239150'>We'll</span> <span m='239310'>focus</span>
  <span m='239730'>on</span> <span m='240840'>cache-oblivious</span> <span m='241380'>priority</span>
  <span m='241860'>queues,</span> <span m='242070'>which</span> <span m='242310'>do</span>
  <span m='242460'>a</span> <span m='242550'>similar</span> <span m='242910'>kind</span>
  <span m='243150'>of</span> <span m='243240'>thing,</span> <span m='244000'>but</span>
  <span m='244110'>get</span> <span m='244260'>it a</span> <span m='244350'>dynamic.</span>
  <span m='246350'>All</span> <span m='246410'>right.</span> <span m='246630'>But</span>
  <span m='246900'>before</span> <span m='247230'>we</span> <span m='247320'>go</span>
  <span m='247470'>there,</span> <span m='247930'>let's</span> <span m='248160'>do</span>
  <span m='249480'>ordered</span> <span m='249780'>file</span> <span m='250020'>maintenance.</span>
  </p><p><span m='260070'>So</span> <span m='260610'>let</span> <span m='260760'>me</span>
  <span m='260940'>first</span> <span m='261750'>remind</span> <span m='262200'>you</span>
  <span m='262320'>of</span> <span m='262410'>the</span> <span m='262500'>problem.</span>
  <span m='263640'>We</span> <span m='263760'>want</span> <span m='264000'>to</span>
  <span m='264090'>store</span> <span m='266580'>N</span> <span m='267330'>items</span>
  <span m='270320'>in</span> <span m='270570'>a</span> <span m='270630'>file,</span>
  <span m='272210'>which</span> <span m='272520'>think</span> <span m='272790'>of</span>
  <span m='272940'>as</span> <span m='273090'>an</span> <span m='273180'>array,</span>
  <span m='276390'>size</span> <span m='278070'>order</span> <span m='278400'>N.</span>
  <span m='280350'>This</span> <span m='280590'>constant's</span> <span m='281040'>bigger</span>
  <span m='281280'>than</span> <span m='281430'>1,</span> <span m='284430'>with</span>
  <span m='284820'>constant-sized</span> <span m='285900'>gaps.</span> <span m='293970'>And</span>
  <span m='294270'>then--</span> <span m='295290'>I</span> <span m='295380'>should</span>
  <span m='295590'>say</span> <span m='296460'>in</span> <span m='296700'>specified</span>
  <span m='297330'>order,</span> <span m='306030'>subject</span> <span m='306510'>to</span>
  <span m='306870'>inserting</span> <span m='307440'>and</span> <span m='307530'>deleting</span>
  <span m='307980'>items</span> <span m='308550'>in</span> <span m='308730'>that</span>
  <span m='308970'>order.</span> </p><p><span m='329420'>So</span> <span m='329930'>this</span>
  <span m='330040'>was</span> <span m='330250'>the</span> <span m='332010'>picture.</span>
  <span m='334240'>We</span> <span m='334440'>have</span> <span m='334620'>an</span>
  <span m='334710'>array.</span> <span m='337820'>We</span> <span m='337990'>get</span>
  <span m='338190'>to</span> <span m='338340'>store</span> <span m='338670'>some</span>
  <span m='339630'>objects</span> <span m='340080'>in</span> <span m='340170'>the</span>
  <span m='340260'>array</span> <span m='342680'>and</span> <span m='342810'>have</span>
  <span m='342930'>these</span> <span m='343080'>blank</span> <span m='343740'>cells</span>
  <span m='344130'>in</span> <span m='344220'>between.</span> <span m='345180'>But</span>
  <span m='345330'>each</span> <span m='345510'>of</span> <span m='345570'>these</span>
  <span m='345780'>gaps</span> <span m='346140'>has</span> <span m='346350'>constant</span>
  <span m='346740'>size.</span> <span m='352960'>Maybe</span> <span m='353260'>these</span>
  <span m='353500'>data</span> <span m='353740'>items</span> <span m='354100'>are</span>
  <span m='354190'>sorted,</span> <span m='354790'>maybe</span> <span m='355090'>not.</span>
  <span m='358540'>And</span> <span m='358690'>then</span> <span m='358870'>we're</span>
  <span m='359020'>able</span> <span m='359290'>to</span> <span m='359410'>say</span>
  <span m='359620'>things</span> <span m='359920'>like,</span> <span m='360310'>OK,</span>
  <span m='360640'>insert</span> <span m='362540'>a</span> <span m='362620'>new</span>
  <span m='362830'>item</span> <span m='363220'>8</span> <span m='364180'>right</span>
  <span m='364390'>after</span> <span m='364690'>7.</span> <span m='365550'>And</span>
  <span m='365680'>so</span> <span m='365830'>then</span> <span m='366010'>you'd</span>
  <span m='366150'>like</span> <span m='366310'>to</span> <span m='366430'>do</span>
  <span m='366580'>that.</span> </p><p><span m='367540'>Then</span> <span m='367660'>you'd</span>
  <span m='367810'>also,</span> <span m='368110'>then,</span> <span m='368320'>like</span>
  <span m='368500'>to</span> <span m='368590'>say</span> <span m='368770'>OK,</span>
  <span m='369070'>now</span> <span m='369340'>insert</span> <span m='370000'>new</span>
  <span m='370300'>item</span> <span m='372430'>9,</span> <span m='372910'>here.</span>
  <span m='374530'>And</span> <span m='375280'>then</span> <span m='375670'>this</span>
  <span m='375830'>guy</span> <span m='376100'>will maybe</span> <span m='376370'>get</span>
  <span m='376610'>shifted</span> <span m='377050'>over.</span> <span m='377500'>So</span>
  <span m='377920'>12</span> <span m='378310'>is</span> <span m='378430'>over</span>
  <span m='378670'>here.</span> <span m='379570'>This</span> <span m='379750'>becomes</span>
  <span m='380110'>blank,</span> <span m='380500'>and</span> <span m='380590'>then</span>
  <span m='380740'>you</span> <span m='380830'>can</span> <span m='380950'>fit</span>
  <span m='381160'>the</span> <span m='381300'>9,</span> <span m='382210'>and</span>
  <span m='382330'>so</span> <span m='382450'>on.</span> <span m='382690'>You</span>
  <span m='382780'>want</span> <span m='382900'>to</span> <span m='382960'>be</span>
  <span m='383020'>able</span> <span m='383140'>to</span> <span m='383200'>do</span>
  <span m='383290'>insertions</span> <span m='383830'>and</span> <span m='383920'>deletions</span>
  <span m='384340'>like</span> <span m='384490'>that</span> <span m='385540'>quickly.</span>
  </p><p><span m='393970'>And</span> <span m='394210'>quickly,</span> <span m='394630'>here,</span>
  <span m='394900'>means</span> <span m='395590'>whenever</span> <span m='395890'>we</span>
  <span m='396010'>do</span> <span m='396130'>an</span> <span m='396190'>insert</span>
  <span m='396520'>or</span> <span m='396580'>delete,</span> <span m='397210'>we're</span>
  <span m='397270'>going</span> <span m='397420'>to</span> <span m='397480'>rearrange</span>
  <span m='398050'>items</span> <span m='398440'>in</span> <span m='398560'>an</span>
  <span m='398680'>interval.</span> <span m='402530'>And</span> <span m='402730'>that</span>
  <span m='402880'>interval</span> <span m='403270'>is</span> <span m='403390'>going</span>
  <span m='403510'>to</span> <span m='403600'>be</span> <span m='403750'>small--</span>
  <span m='406360'>log</span> <span m='406860'>squared</span> <span m='408150'>N</span>
  <span m='409370'>amortized.</span> <span m='415542'>That's</span> <span m='416030'>all</span>
  <span m='416210'>I need to</span> <span m='416550'>say</span> <span m='417010'>here.</span>
  </p><p><span m='420920'>I</span> <span m='421010'>guess</span> <span m='421190'>we</span>
  <span m='421310'>also</span> <span m='421580'>want</span> <span m='421700'>to</span>
  <span m='421790'>say</span> <span m='422030'>that</span> <span m='422180'>when</span>
  <span m='422360'>we're</span> <span m='422480'>moving</span> <span m='422780'>these</span>
  <span m='422930'>items</span> <span m='423230'>in</span> <span m='423320'>the</span>
  <span m='423410'>interval,</span> <span m='423830'>we</span> <span m='423950'>can</span>
  <span m='424100'>do</span> <span m='424280'>it</span> <span m='424430'>efficiently</span>
  <span m='425060'>cache-obliviously,</span> <span m='425960'>because</span> <span
  m='426110'>we</span> <span m='426230'>really</span> <span m='426470'>want</span>
  <span m='426680'>log</span> <span m='426920'>squared</span> <span m='427250'>N</span>
  <span m='427460'>divided</span> <span m='427970'>by</span> <span m='428150'>B.</span>
  <span m='429800'>And</span> <span m='430640'>we</span> <span m='430760'>say</span>
  <span m='430970'>that</span> <span m='431750'>via</span> <span m='433640'>constant</span>
  <span m='434270'>number</span> <span m='434960'>of</span> <span m='435320'>interleaved</span>
  <span m='437570'>scans.</span> <span m='439810'>Scans,</span> <span m='440360'>we</span>
  <span m='440480'>know,</span> <span m='440930'>as</span> <span m='441050'>long</span>
  <span m='441200'>as</span> <span m='441290'>there's</span> <span m='441440'>a</span>
  <span m='441740'>number</span> <span m='442040'>of</span> <span m='442130'>them</span>
  <span m='443000'>and</span> <span m='443150'>your</span> <span m='443300'>cache</span>
  <span m='443630'>has</span> <span m='443750'>at</span> <span m='443840'>least</span>
  <span m='443990'>a</span> <span m='444050'>constant</span> <span m='444410'>size</span>
  <span m='445220'>number</span> <span m='445400'>of</span> <span m='445460'>blocks,</span>
  <span m='446810'>then</span> <span m='447020'>interleave</span> <span m='447410'>scans</span>
  <span m='447680'>are</span> <span m='447770'>always</span> <span m='447950'>going</span>
  <span m='448100'>to</span> <span m='448160'>be</span> <span m='448250'>efficient.</span>
  <span m='448610'>You</span> <span m='448670'>always</span> <span m='448850'>get</span>
  <span m='448970'>to</span> <span m='449090'>divide</span> <span m='449420'>by</span>
  <span m='449570'>B.</span> <span m='451550'>But</span> <span m='451670'>the</span>
  <span m='451790'>focus</span> <span m='452150'>will</span> <span m='452270'>be</span>
  <span m='452420'>on</span> <span m='452570'>making</span> <span m='452840'>sure</span>
  <span m='452990'>the</span> <span m='453110'>interval</span> <span m='453470'>is</span>
  <span m='453530'>small.</span> <span m='454370'>The</span> <span m='454460'>rearrangement</span>
  <span m='455030'>will</span> <span m='455130'>actually</span> <span m='455370'>be</span>
  <span m='455480'>very</span> <span m='455690'>simple,</span> <span m='456290'>so</span>
  <span m='456530'>not</span> <span m='456710'>too</span> <span m='456860'>hard</span>
  <span m='457040'>to</span> <span m='457160'>do.</span> </p><p><span m='459920'>So</span>
  <span m='460100'>this</span> <span m='460340'>will</span> <span m='460580'>give</span>
  <span m='460820'>us</span> <span m='463545'>log</span> <span m='463990'>squared</span>
  <span m='464600'>N</span> <span m='465230'>over</span> <span m='465740'>B</span>
  <span m='467180'>amortized</span> <span m='468920'>memory</span> <span m='469310'>transfers.</span>
  <span m='471080'>So</span> <span m='471200'>that</span> <span m='471340'>was</span>
  <span m='471470'>the</span> <span m='471560'>black</span> <span m='471830'>box</span>
  <span m='472130'>we</span> <span m='472250'>needed</span> <span m='473030'>to</span>
  <span m='473210'>get</span> <span m='474020'>cache-oblivious</span> <span m='474750'>b-trees.</span>
  </p><p><span m='476120'>Remember,</span> <span m='476570'>we</span> <span m='476690'>got</span>
  <span m='476900'>rid</span> <span m='477050'>of</span> <span m='477140'>the</span>
  <span m='477230'>square</span> <span m='477620'>in</span> <span m='477710'>the</span>
  <span m='477770'>log</span> <span m='478100'>by</span> <span m='478220'>using</span>
  <span m='478490'>a</span> <span m='478550'>level</span> <span m='478820'>of</span>
  <span m='478880'>indirection</span> <span m='479480'>that</span> <span m='479610'>removed</span>
  <span m='479870'>one</span> <span m='480020'>of</span> <span m='480080'>the</span>
  <span m='480170'>logs.</span> <span m='481310'>So</span> <span m='481400'>we</span>
  <span m='481460'>got</span> <span m='481610'>log</span> <span m='481880'>N</span>
  <span m='482000'>over</span> <span m='482200'>B.</span> <span m='482900'>So</span>
  <span m='483080'>we</span> <span m='483170'>were</span> <span m='483260'>dominated</span>
  <span m='483770'>by</span> <span m='483920'>log</span> <span m='484190'>base</span>
  <span m='484370'>B</span> <span m='484550'>of N,</span> <span m='484850'>which</span>
  <span m='485000'>is</span> <span m='485120'>what</span> <span m='485270'>we</span>
  <span m='485390'>had</span> <span m='485630'>for</span> <span m='485960'>the</span>
  <span m='486080'>search</span> <span m='487360'>over</span> <span m='487580'>here.</span>
  <span m='489240'>So</span> <span m='489500'>this</span> <span m='489710'>is</span>
  <span m='489830'>the</span> <span m='489950'>step</span> <span m='490220'>we</span>
  <span m='490340'>need.</span> <span m='490670'>And</span> <span m='490850'>this</span>
  <span m='491030'>is</span> <span m='491180'>a</span> <span m='491240'>general</span>
  <span m='491570'>tool</span> <span m='491930'>used</span> <span m='492260'>in</span>
  <span m='492470'>a</span> <span m='492530'>bunch</span> <span m='492800'>of</span>
  <span m='492860'>different</span> <span m='493130'>cache-oblivious</span> <span
  m='493700'>data</span> <span m='493880'>structures,</span> <span m='494360'>sort</span>
  <span m='494600'>of</span> <span m='494720'>one</span> <span m='494870'>of</span>
  <span m='494930'>the</span> <span m='495050'>first</span> <span m='495440'>cache-oblivious</span>
  <span m='496340'>data</span> <span m='496550'>structure</span> <span m='496910'>tools.</span>
  <span m='498690'>It's</span> <span m='498800'>pretty</span> <span m='499040'>handy.</span>
  </p><p><span m='501090'>It's</span> <span m='501140'>actually</span> <span m='501560'>much</span>
  <span m='501800'>older</span> <span m='502220'>than</span> <span m='502430'>cache-oblivious</span>
  <span m='503170'>or</span> <span m='503360'>external</span> <span m='503780'>memory</span>
  <span m='504110'>models.</span> <span m='505200'>This</span> <span m='505280'>results--</span>
  <span m='506600'>removing</span> <span m='507110'>the</span> <span m='507230'>last</span>
  <span m='507620'>line</span> <span m='508100'>and</span> <span m='508340'>this</span>
  <span m='508520'>part,</span> <span m='508790'>which</span> <span m='509000'>makes</span>
  <span m='509270'>it</span> <span m='509360'>efficient</span> <span m='509780'>in</span>
  <span m='509900'>this</span> <span m='510050'>model.</span> <span m='510920'>Just</span>
  <span m='511100'>thinking</span> <span m='511400'>about</span> <span m='511580'>moving</span>
  <span m='511940'>around</span> <span m='512179'>intervals</span> <span m='512720'>in</span>
  <span m='512820'>a</span> <span m='512900'>file</span> <span m='514159'>goes</span>
  <span m='514400'>back</span> <span m='514730'>to</span> <span m='515429'>Itai,</span>
  <span m='515870'>Konheim,</span> <span m='516080'>and</span> <span m='516169'>Rodeh
  in</span> <span m='516650'>1981.</span> <span m='518360'>So</span> <span m='518450'>it's</span>
  <span m='518539'>pretty</span> <span m='518809'>old.</span> <span m='520070'>And</span>
  <span m='520220'>then</span> <span m='520429'>it</span> <span m='520520'>was</span>
  <span m='521480'>brought</span> <span m='521809'>to</span> <span m='521929'>the</span>
  <span m='522049'>cache-oblivious</span> <span m='522710'>world</span> <span m='523220'>in</span>
  <span m='523549'>2000,</span> <span m='524430'>right</span> <span m='524630'>when</span>
  <span m='524780'>this</span> <span m='525440'>model</span> <span m='525740'>was</span>
  <span m='525860'>getting</span> <span m='526100'>started.</span> </p><p><span m='528740'>So</span>
  <span m='530540'>that's</span> <span m='530750'>the</span> <span m='530840'>goal.</span>
  <span m='532550'>Now</span> <span m='532760'>let</span> <span m='532910'>me</span>
  <span m='533060'>tell</span> <span m='533300'>you</span> <span m='535280'>how</span>
  <span m='535490'>this</span> <span m='535610'>is</span> <span m='535730'>going</span>
  <span m='535850'>to</span> <span m='535940'>work.</span> </p><p><span m='536730'>So</span>
  <span m='536790'>a</span> <span m='536810'>rough</span> <span m='537050'>idea</span>
  <span m='537440'>is</span> <span m='537680'>very</span> <span m='537860'>simple.</span>
  <span m='538980'>You</span> <span m='539000'>have</span> <span m='539300'>your</span>
  <span m='539480'>array.</span> <span m='541370'>And</span> <span m='542240'>when</span>
  <span m='542420'>you</span> <span m='542570'>insert</span> <span m='543260'>an</span>
  <span m='543380'>item,</span> <span m='544640'>what</span> <span m='544790'>we</span>
  <span m='544910'>want</span> <span m='545090'>to</span> <span m='545150'>do</span>
  <span m='545550'>is</span> <span m='545870'>find</span> <span m='546260'>an</span>
  <span m='546380'>interval</span> <span m='546890'>containing</span> <span m='547460'>that</span>
  <span m='547640'>item</span> <span m='549330'>of</span> <span m='549620'>some</span>
  <span m='549920'>reasonable</span> <span m='550460'>size</span> <span m='552230'>that's</span>
  <span m='552530'>not</span> <span m='552860'>too</span> <span m='553190'>full</span>
  <span m='553670'>and</span> <span m='553820'>not</span> <span m='554060'>too</span>
  <span m='554300'>sparse.</span> <span m='555800'>If</span> <span m='555950'>we</span>
  <span m='556040'>can</span> <span m='556220'>find--</span> <span m='558200'>so</span>
  <span m='558380'>like</span> <span m='558590'>right</span> <span m='558770'>here,</span>
  <span m='558950'>when</span> <span m='559070'>we're</span> <span m='559190'>inserting</span>
  <span m='559610'>9,</span> <span m='559880'>it</span> <span m='559970'>looks</span>
  <span m='560180'>really</span> <span m='560420'>bad</span> <span m='560780'>right</span>
  <span m='560990'>around</span> <span m='561350'>there.</span> <span m='561720'>And
  so</span> <span m='561950'>there's,</span> <span m='562130'>like,</span> <span m='562340'>too</span>
  <span m='562550'>many</span> <span m='562790'>elements</span> <span m='563150'>packed</span>
  <span m='563480'>right</span> <span m='563660'>around</span> <span m='563870'>that</span>
  <span m='563990'>element.</span> <span m='564270'>And</span> <span m='564400'>that</span>
  <span m='564520'>feels</span> <span m='564830'>bad</span> <span m='565130'>to</span>
  <span m='565310'>us.</span> <span m='565940'>So</span> <span m='566090'>we</span>
  <span m='566180'>grow</span> <span m='566510'>an</span> <span m='566630'>interval</span>
  <span m='566990'>around</span> <span m='567320'>it</span> <span m='567380'>until</span>
  <span m='567590'>we've</span> <span m='567740'>got</span> <span m='567920'>enough</span>
  <span m='568160'>gaps.</span> <span m='569120'>And</span> <span m='569240'>then</span>
  <span m='569360'>we</span> <span m='569450'>just</span> <span m='569690'>evenly</span>
  <span m='570170'>redistribute</span> <span m='570860'>the</span> <span m='570980'>items</span>
  <span m='571400'>in</span> <span m='572540'>that</span> <span m='572690'>interval.</span>
  </p><p><span m='574200'>So</span> <span m='574280'>that's</span> <span m='574490'>basically</span>
  <span m='574790'>what</span> <span m='574870'>we're</span> <span m='574940'>going</span>
  <span m='575050'>to</span> <span m='575150'>do.</span> <span m='575460'>We</span>
  <span m='575560'>just</span> <span m='575690'>have</span> <span m='575870'>to</span>
  <span m='575960'>find</span> <span m='576890'>the</span> <span m='577010'>right</span>
  <span m='577250'>size</span> <span m='577550'>interval</span> <span m='577970'>to</span>
  <span m='578120'>rearrange</span> <span m='578660'>items</span> <span m='578935'>in.</span>
  <span m='579510'>Then</span> <span m='579680'>when</span> <span m='579800'>we</span>
  <span m='579890'>do</span> <span m='580040'>the</span> <span m='580160'>rearrangement,</span>
  <span m='581060'>it's</span> <span m='581210'>always</span> <span m='581450'>going</span>
  <span m='581630'>to</span> <span m='581690'>be</span> <span m='582380'>evenly</span>
  <span m='582910'>redistributing</span> <span m='583610'>within</span> <span m='583850'>the</span>
  <span m='583940'>interval.</span> <span m='585380'>So</span> <span m='585500'>that</span>
  <span m='585650'>strategy</span> <span m='586070'>is</span> <span m='586160'>simple.</span>
  <span m='586640'>And</span> <span m='586850'>to</span> <span m='587030'>think</span>
  <span m='587330'>about</span> <span m='587690'>intervals</span> <span m='588170'>in</span>
  <span m='588290'>a</span> <span m='588320'>nice</span> <span m='588620'>controlled</span>
  <span m='589100'>way,</span> <span m='589760'>we're</span> <span m='589910'>going</span>
  <span m='590030'>to</span> <span m='590120'>build</span> <span m='590810'>a</span>
  <span m='590870'>binary</span> <span m='591290'>tree--</span> <span m='592620'>our</span>
  <span m='592760'>good</span> <span m='592970'>friend.</span> <span m='594020'>So</span>
  <span m='597901'>let me</span> <span m='598280'>just</span> <span m='598490'>draw</span>
  <span m='601530'>this</span> <span m='601700'>binary</span> <span m='602090'>tree.</span>
  </p><p><span m='607550'>Now</span> <span m='608090'>I</span> <span m='608150'>need</span>
  <span m='608330'>to</span> <span m='608450'>do</span> <span m='608570'>something</span>
  <span m='608930'>a</span> <span m='608960'>little</span> <span m='609200'>bit</span>
  <span m='609320'>special</span> <span m='609770'>at</span> <span m='609890'>the</span>
  <span m='609980'>leaves.</span> <span m='612470'>I'm</span> <span m='612620'>going</span>
  <span m='612890'>to</span> <span m='613490'>cluster</span> <span m='613970'>together</span>
  <span m='615100'>log</span> <span m='615580'>N</span> <span m='615890'>items.</span>
  <span m='617750'>So</span> <span m='617990'>down</span> <span m='618290'>here</span>
  <span m='618440'>is</span> <span m='618530'>the</span> <span m='618680'>array,</span>
  <span m='619970'>and</span> <span m='620150'>all</span> <span m='620390'>of</span>
  <span m='620480'>this</span> <span m='620600'>stuff</span> <span m='620870'>up</span>
  <span m='621050'>here</span> <span m='621290'>is</span> <span m='621500'>conceptual.</span>
  <span m='622250'>We</span> <span m='622370'>don't</span> <span m='622550'>really</span>
  <span m='623090'>build</span> <span m='623420'>it.</span> <span m='628370'>In</span>
  <span m='628850'>my lecture</span> <span m='629280'>notes,</span> <span m='629510'>I</span>
  <span m='629570'>can</span> <span m='629690'>just</span> <span m='629930'>copy</span>
  <span m='630320'>and</span> <span m='630410'>paste</span> <span m='630770'>and</span>
  <span m='630860'>this</span> <span m='631010'>is</span> <span m='631130'>a</span>
  <span m='631160'>lot</span> <span m='631310'>easier.</span> <span m='633960'>So</span>
  <span m='634100'>we</span> <span m='634250'>have</span> <span m='634850'>these</span>
  <span m='635120'>chunks</span> <span m='635520'>of</span> <span m='635600'>size</span>
  <span m='636170'>theta</span> <span m='636410'>log</span> <span m='636740'>N</span>
  <span m='637010'>at</span> <span m='637220'>the</span> <span m='637310'>bottom.</span>
  <span m='641610'>I don't</span> <span m='641630'>really</span> <span m='641960'>care</span>
  <span m='642470'>what</span> <span m='642620'>the</span> <span m='642740'>constant</span>
  <span m='643160'>is.</span> <span m='645050'>1</span> <span m='645340'>is</span>
  <span m='645500'>probably</span> <span m='645830'>fine.</span> </p><p><span m='654840'>So</span>
  <span m='654990'>this</span> <span m='655230'>is</span> <span m='655320'>the</span>
  <span m='655470'>array</span> <span m='655740'>down</span> <span m='656010'>here,</span>
  <span m='656220'>and</span> <span m='656310'>we're</span> <span m='656640'>splitting</span>
  <span m='657240'>every</span> <span m='657600'>log</span> <span m='657960'>N</span>
  <span m='658200'>items,</span> <span m='659480'>or</span> <span m='659650'>log</span>
  <span m='659970'>N</span> <span m='660300'>cells</span> <span m='660870'>in</span>
  <span m='660960'>the</span> <span m='661110'>array.</span> <span m='663810'>And</span>
  <span m='663960'>then</span> <span m='664110'>we</span> <span m='664200'>say,</span>
  <span m='664510'>OK,</span> <span m='664900'>well</span> <span m='665880'>conceptually</span>
  <span m='666420'>build</span> <span m='666630'>a</span> <span m='666660'>binary</span>
  <span m='666990'>structure</span> <span m='667260'>tree,</span> <span m='667500'>here.</span>
  <span m='667770'>And</span> <span m='667920'>then</span> <span m='668100'>this</span>
  <span m='668340'>node</span> <span m='668760'>represents</span> <span m='669750'>this</span>
  <span m='669990'>interval.</span> <span m='671100'>And</span> <span m='671370'>this</span>
  <span m='671580'>node</span> <span m='672350'>represents</span> <span m='673410'>this</span>
  <span m='673620'>interval.</span> <span m='674930'>Every</span> <span m='675300'>node</span>
  <span m='675540'>just</span> <span m='675720'>represents</span> <span m='676230'>the</span>
  <span m='676320'>interval</span> <span m='676680'>of</span> <span m='676800'>all</span>
  <span m='676950'>its</span> <span m='677100'>descendant</span> <span m='677730'>leaves.</span>
  <span m='679080'>We've</span> <span m='680460'>seen</span> <span m='680670'>this</span>
  <span m='680790'>trick</span> <span m='681090'>over</span> <span m='681390'>and</span>
  <span m='681480'>over</span> <span m='681690'>again.</span> </p><p><span m='683040'>But</span>
  <span m='683190'>we're</span> <span m='683280'>not</span> <span m='683430'>going</span>
  <span m='683580'>to</span> <span m='683820'>build</span> <span m='684210'>any</span>
  <span m='684390'>data</span> <span m='684630'>structure</span> <span m='685030'>or</span>
  <span m='685080'>have</span> <span m='685260'>some</span> <span m='685440'>augmentation</span>
  <span m='686130'>for</span> <span m='686250'>each</span> <span m='686400'>of</span>
  <span m='686460'>these</span> <span m='686640'>nodes.</span> <span m='687930'>This</span>
  <span m='688140'>is</span> <span m='688260'>how</span> <span m='688410'>we're</span>
  <span m='688530'>going</span> <span m='688800'>to</span> <span m='689730'>build</span>
  <span m='690000'>the</span> <span m='690120'>intervals.</span> <span m='690730'>We're</span>
  <span m='690750'>going</span> <span m='690850'>to</span> <span m='690930'>start</span>
  <span m='691410'>at</span> <span m='691710'>the</span> <span m='691830'>leaf. Let's</span>
  <span m='692220'>say</span> <span m='692370'>we</span> <span m='692490'>want</span>
  <span m='692640'>to</span> <span m='692700'>insert</span> <span m='693060'>an</span>
  <span m='693180'>item</span> <span m='693480'>in</span> <span m='693630'>here.</span>
  <span m='694740'>So</span> <span m='694890'>we</span> <span m='694980'>insert</span>
  <span m='695310'>it</span> <span m='695370'>here.</span> <span m='695650'>If</span>
  <span m='695730'>there's</span> <span m='695910'>not</span> <span m='696150'>room</span>
  <span m='696390'>for</span> <span m='696690'>it,</span> <span m='697140'>we're</span>
  <span m='697200'>going</span> <span m='697310'>to</span> <span m='697410'>walk</span>
  <span m='697740'>up</span> <span m='697890'>the</span> <span m='697980'>tree and</span>
  <span m='698330'>say,</span> <span m='698520'>OK,</span> <span m='698860'>if</span>
  <span m='699030'>this</span> <span m='699810'>interval</span> <span m='700170'>is</span>
  <span m='700290'>too</span> <span m='700530'>dense,</span> <span m='701610'>I'll</span>
  <span m='701910'>look</span> <span m='702210'>at</span> <span m='702690'>this</span>
  <span m='702900'>node</span> <span m='703320'>and</span> <span m='703500'>its</span>
  <span m='703650'>corresponding</span> <span m='704250'>interval</span> <span m='704580'>here</span>
  <span m='704760'>to</span> <span m='704880'>here.</span> <span m='705840'>If</span>
  <span m='705960'>that's</span> <span m='706260'>still</span> <span m='706620'>too</span>
  <span m='706860'>dense,</span> <span m='707670'>I'll</span> <span m='707790'>walk</span>
  <span m='708060'>up</span> <span m='708180'>to</span> <span m='708270'>the</span>
  <span m='708360'>parent,</span> <span m='709170'>and</span> <span m='709290'>so</span>
  <span m='709470'>look</span> <span m='709650'>at</span> <span m='709770'>this</span>
  <span m='709980'>interval</span> <span m='710400'>from</span> <span m='710580'>here</span>
  <span m='710730'>to</span> <span m='710820'>here,</span> <span m='712020'>and</span>
  <span m='712110'>so</span> <span m='712320'>on,</span> <span m='712530'>until</span>
  <span m='712800'>I</span> <span m='712890'>find</span> <span m='713700'>that</span>
  <span m='713850'>in</span> <span m='714030'>the</span> <span m='714210'>end,</span>
  <span m='714840'>at</span> <span m='714930'>most,</span> <span m='715320'>I</span>
  <span m='715500'>redistribute</span> <span m='716220'>the</span> <span m='716310'>entire</span>
  <span m='717810'>array.</span> <span m='719280'>And</span> <span m='719400'>when</span>
  <span m='719550'>I</span> <span m='719640'>do</span> <span m='719760'>that,</span>
  <span m='719940'>I'll</span> <span m='720030'>just</span> <span m='720210'>evenly</span>
  <span m='720620'>redistribute.</span> </p><p><span m='722610'>Let</span> <span m='722760'>me</span>
  <span m='723060'>write</span> <span m='723300'>down</span> <span m='726640'>the</span>
  <span m='726800'>algorithm</span> <span m='727760'>for</span> <span m='728120'>update.</span>
  <span m='729340'>So</span> <span m='729950'>for</span> <span m='730130'>insert</span>
  <span m='730550'>or</span> <span m='730670'>delete,</span> <span m='731900'>same</span>
  <span m='732230'>algorithm,</span> <span m='734330'>you</span> <span m='736850'>update</span>
  <span m='737540'>the</span> <span m='738560'>leaf</span> <span m='740390'>log</span>
  <span m='740840'>N</span> <span m='741020'>chunk.</span> <span m='745220'>You</span>
  <span m='745400'>can</span> <span m='745550'>do</span> <span m='745670'>that</span>
  <span m='745850'>just</span> <span m='746000'>by</span> <span m='746150'>rewriting</span>
  <span m='746690'>the</span> <span m='746780'>entire</span> <span m='747260'>chunk.</span>
  <span m='749020'>We're</span> <span m='749330'>trying</span> <span m='749570'>to</span>
  <span m='749660'>get</span> <span m='749780'>a</span> <span m='749840'>log</span>
  <span m='750080'>squared</span> <span m='750380'>N bound,</span> <span m='750740'>so</span>
  <span m='750890'>we</span> <span m='750980'>can</span> <span m='751130'>afford</span>
  <span m='751400'>to</span> <span m='751490'>rewrite</span> <span m='751820'>it</span>
  <span m='751900'>interval</span> <span m='752070'>as</span> <span m='752280'>size</span>
  <span m='752620'>log</span> <span m='752930'>N.</span> <span m='753470'>So</span>
  <span m='753590'>that's</span> <span m='754670'>for</span> <span m='754910'>free.</span>
  </p><p><span m='758270'>So</span> <span m='758540'>whatever</span> <span m='759440'>leaf</span>
  <span m='759830'>contains</span> <span m='760670'>the</span> <span m='760880'>element</span>
  <span m='761210'>you</span> <span m='761330'>want</span> <span m='761510'>to</span>
  <span m='761630'>insert</span> <span m='762080'>or</span> <span m='762170'>delete.</span>
  <span m='767480'>And</span> <span m='767660'>then</span> <span m='767930'>we're</span>
  <span m='768030'>going</span> <span m='768120'>to</span> <span m='768230'>walk</span>
  <span m='768560'>up</span> <span m='768710'>the</span> <span m='768800'>tree</span>
  <span m='770120'>until</span> <span m='770390'>we</span> <span m='770510'>find</span>
  <span m='770840'>a</span> <span m='770990'>suitable</span> <span m='771710'>interval.</span>
  <span m='783640'>And</span> <span m='783900'>we're</span> <span m='783990'>going</span>
  <span m='784110'>to</span> <span m='784170'>call</span> <span m='784500'>that</span>
  <span m='784770'>node,</span> <span m='785790'>or</span> <span m='786000'>that</span>
  <span m='786180'>interval,</span> <span m='790470'>within</span> <span m='790920'>threshold.</span>
  </p><p><span m='800550'>So</span> <span m='800730'>let</span> <span m='800850'>me</span>
  <span m='800970'>define</span> <span m='801420'>within</span> <span m='801660'>threshold.</span>
  <span m='802650'>We're</span> <span m='802710'>going</span> <span m='802850'>to</span>
  <span m='802920'>look</span> <span m='803130'>at</span> <span m='803280'>the</span>
  <span m='803460'>density</span> <span m='806640'>of</span> <span m='806820'>a</span>
  <span m='806880'>node,</span> <span m='807300'>or</span> <span m='807450'>an</span>
  <span m='807510'>interval.</span> <span m='810000'>And</span> <span m='811080'>that's</span>
  <span m='811290'>just</span> <span m='811440'>going</span> <span m='811560'>to</span>
  <span m='811650'>be</span> <span m='811740'>the</span> <span m='811860'>ratio</span>
  <span m='812460'>of</span> <span m='812760'>the</span> <span m='812880'>number</span>
  <span m='813180'>of</span> <span m='813300'>elements</span> <span m='813840'>that</span>
  <span m='813930'>are</span> <span m='814020'>actually</span> <span m='814500'>down</span>
  <span m='814830'>there</span> <span m='815640'>versus</span> <span m='816210'>the</span>
  <span m='816420'>amount</span> <span m='816720'>of</span> <span m='817080'>slots</span>
  <span m='817710'>in</span> <span m='817800'>the</span> <span m='817950'>array</span>
  <span m='818250'>that</span> <span m='818400'>are</span> <span m='818460'>down</span>
  <span m='818700'>there--</span> <span m='822180'>so</span> <span m='822300'>just</span>
  <span m='822510'>how</span> <span m='822630'>much</span> <span m='822840'>is</span>
  <span m='822960'>occupied.</span> </p><p><span m='840870'>So</span> <span m='841020'>look</span>
  <span m='841200'>at</span> <span m='841260'>that</span> <span m='841380'>ratio.</span>
  <span m='841710'>If</span> <span m='841800'>it's</span> <span m='841930'>100%,</span>
  <span m='842730'>then</span> <span m='842910'>there</span> <span m='843000'>are</span>
  <span m='843030'>no</span> <span m='843270'>blank</span> <span m='843600'>cells</span>
  <span m='843900'>down</span> <span m='844110'>there. If it's</span> <span m='844320'>0%,</span>
  <span m='845040'>then</span> <span m='845420'>everybody</span> <span m='846570'>is</span>
  <span m='847050'>blank.</span> <span m='848470'>So</span> <span m='848550'>we</span>
  <span m='848610'>don't</span> <span m='848730'>want</span> <span m='848940'>either</span>
  <span m='849180'>of</span> <span m='849240'>those</span> <span m='849420'>extremes.</span>
  <span m='849900'>We</span> <span m='849990'>want</span> <span m='850170'>something</span>
  <span m='850530'>in</span> <span m='850620'>between.</span> <span m='851670'>And</span>
  <span m='851850'>we're</span> <span m='851940'>going</span> <span m='852060'>to</span>
  <span m='852120'>do</span> <span m='852240'>that</span> <span m='852450'>by</span>
  <span m='852690'>specifying</span> <span m='853320'>thresholds</span> <span m='854010'>on</span>
  <span m='854160'>this</span> <span m='854460'>density</span> <span m='854970'>and</span>
  <span m='855060'>try</span> <span m='855240'>to</span> <span m='855420'>keep</span>
  <span m='855720'>the</span> <span m='855810'>density</span> <span m='856230'>within</span>
  <span m='856530'>those</span> <span m='856710'>thresholds.</span> <span m='858710'>Let</span>
  <span m='858780'>me</span> <span m='859680'>let</span> <span m='859790'>me</span>
  <span m='859980'>define</span> <span m='860340'>those</span> <span m='860520'>thresholds.</span>
  </p><p><span m='870800'>The</span> <span m='870890'>fun</span> <span m='871130'>part</span>
  <span m='872870'>is</span> <span m='873040'>that</span> <span m='873200'>the</span>
  <span m='873320'>density</span> <span m='873800'>thresholds</span> <span m='874550'>that</span>
  <span m='874700'>you</span> <span m='874820'>maintain</span> <span m='875870'>depend</span>
  <span m='876500'>on</span> <span m='876740'>which</span> <span m='876980'>level</span>
  <span m='877430'>you</span> <span m='877640'>are.</span> <span m='881120'>Not,</span>
  <span m='881300'>like,</span> <span m='881750'>experience</span> <span m='882230'>points,</span>
  <span m='882790'>but</span> <span m='883100'>in</span> <span m='883610'>which</span>
  <span m='884180'>height</span> <span m='884480'>of</span> <span m='884630'>the</span>
  <span m='884720'>tree</span> <span m='885530'>you</span> <span m='885710'>are.</span>
  <span m='886190'>So</span> <span m='886340'>down</span> <span m='886610'>here,</span>
  <span m='886880'>we</span> <span m='887000'>don't</span> <span m='887210'>really</span>
  <span m='887600'>care</span> <span m='888590'>how</span> <span m='888860'>well-distributed</span>
  <span m='889550'>the</span> <span m='889640'>leaves</span> <span m='889940'>are.</span>
  <span m='890570'>I</span> <span m='890630'>mean,</span> <span m='891790'>it can't</span>
  <span m='892220'>be</span> <span m='892340'>0%</span> <span m='893000'>because</span>
  <span m='893150'>then</span> <span m='893300'>that</span> <span m='893420'>would</span>
  <span m='893510'>be</span> <span m='893630'>a</span> <span m='893660'>really</span>
  <span m='893900'>big</span> <span m='894470'>gap.</span> <span m='894920'>But</span>
  <span m='895100'>it</span> <span m='895160'>could</span> <span m='895310'>be</span>
  <span m='895460'>say</span> <span m='895700'>between</span> <span m='896600'>50%</span>
  <span m='897260'>and</span> <span m='897380'>100%.</span> <span m='897620'>It</span>
  <span m='897980'>could</span> <span m='898130'>be</span> <span m='898220'>totally</span>
  <span m='898610'>full.</span> </p><p><span m='899300'>And</span> <span m='899430'>then</span>
  <span m='899550'>once</span> <span m='899780'>it's</span> <span m='900050'>overflowing,</span>
  <span m='901310'>then</span> <span m='901430'>we've</span> <span m='901550'>got</span>
  <span m='901670'>to</span> <span m='901730'>go</span> <span m='901940'>up.</span>
  <span m='902150'>And</span> <span m='902480'>the</span> <span m='902810'>higher</span>
  <span m='903200'>we</span> <span m='903320'>go,</span> <span m='904100'>the</span>
  <span m='904190'>stricter</span> <span m='904760'>we</span> <span m='904910'>get--</span>
  <span m='906940'>hopefully,</span> <span m='908120'>yes--</span> <span m='908630'>strictest</span>
  <span m='909200'>at</span> <span m='909320'>the</span> <span m='909440'>top</span>
  <span m='909710'>of</span> <span m='909770'>the</span> <span m='909860'>tree.</span>
  </p><p><span m='912570'>So</span> <span m='913370'>in</span> <span m='913520'>general,</span>
  <span m='918060'>if</span> <span m='918110'>we</span> <span m='918200'>have</span>
  <span m='918500'>a</span> <span m='918590'>node</span> <span m='919070'>of</span>
  <span m='919360'>the</span> <span m='919460'>depth,</span> <span m='920710'>d,</span>
  <span m='924800'>then</span> <span m='926030'>we</span> <span m='926210'>want</span>
  <span m='927200'>the</span> <span m='927290'>density</span> <span m='929970'>to</span>
  <span m='930050'>be</span> <span m='930320'>at</span> <span m='930410'>least</span>
  <span m='931730'>1/2</span> <span m='932810'>minus</span> <span m='933620'>1/4</span>
  <span m='935390'>d</span> <span m='935780'>over</span> <span m='936230'>h.</span>
  <span m='939590'>And</span> <span m='939860'>we</span> <span m='940010'>want</span>
  <span m='940370'>the</span> <span m='940490'>density</span> <span m='942290'>to</span>
  <span m='942440'>be</span> <span m='942770'>at</span> <span m='942860'>most</span>
  <span m='944630'>3/4</span> <span m='947390'>plus</span> <span m='948170'>1/4</span>
  <span m='949880'>d</span> <span m='950450'>over</span> <span m='950810'>it</span>
  <span m='951380'>h.</span> <span m='952690'>So</span> <span m='952850'>h,</span>
  <span m='953180'>here,</span> <span m='953390'>is</span> <span m='953510'>the</span>
  <span m='953600'>height</span> <span m='953900'>of</span> <span m='954020'>this</span>
  <span m='954290'>tree,</span> <span m='958800'>which</span> <span m='959165'>is</span>
  <span m='959530'>going</span> <span m='959650'>to</span> <span m='959750'>be</span>
  <span m='959870'>something</span> <span m='960170'>like</span> <span m='960540'>log</span>
  <span m='960770'>N</span> <span m='960950'>minus</span> <span m='961310'>log-log</span>
  <span m='961790'>N.</span> <span m='962410'>But</span> <span m='962720'>it</span>
  <span m='962820'>doesn't</span> <span m='962930'>really</span> <span m='963110'>matter.</span>
  <span m='964230'>This</span> <span m='964330'>is</span> <span m='964520'>depth</span>
  <span m='964730'>0,</span> <span m='965270'>depth</span> <span m='965540'>1,</span>
  <span m='965960'>depth</span> <span m='966200'>h.</span> </p><p><span m='971850'>We</span>
  <span m='972110'>just</span> <span m='972350'>are</span> <span m='972530'>linearly</span>
  <span m='973250'>interpolating</span> <span m='974480'>between--</span> <span m='975840'>let's</span>
  <span m='976010'>see,</span> <span m='977110'>this</span> <span m='977300'>is</span>
  <span m='977450'>always</span> <span m='977690'>between</span> <span m='978320'>1/4</span>
  <span m='979220'>and</span> <span m='979640'>1/2--</span> <span m='982790'>1/2</span>
  <span m='983300'>when</span> <span m='983450'>this</span> <span m='983630'>is</span>
  <span m='983720'>0,</span> <span m='984380'>1/4</span> <span m='985040'>when</span>
  <span m='985250'>this</span> <span m='985490'>is</span> <span m='985760'>h.</span>
  <span m='986330'>So</span> <span m='986820'>you</span> <span m='986920'>get</span>
  <span m='987050'>a</span> <span m='987110'>1/2</span> <span m='987350'>minus</span>
  <span m='987650'>1/4.</span> <span m='988790'>And</span> <span m='989000'>this</span>
  <span m='989210'>one</span> <span m='989750'>is</span> <span m='990200'>always</span>
  <span m='990590'>in</span> <span m='990830'>the</span> <span m='990950'>range</span>
  <span m='992240'>3/4</span> <span m='993260'>to</span> <span m='993650'>1.</span>
  <span m='995960'>It's</span> <span m='996260'>3/4</span> <span m='996830'>when</span>
  <span m='996920'>this</span> <span m='997100'>is</span> <span m='997160'>0,</span>
  <span m='997670'>and</span> <span m='997970'>1</span> <span m='998720'>when</span>
  <span m='998930'>this</span> <span m='999110'>is</span> <span m='999290'>h.</span>
  </p><p><span m='1000310'>So</span> <span m='1000520'>at</span> <span m='1000670'>the</span>
  <span m='1000790'>bottom--</span> <span m='1002730'>I</span> <span m='1002860'>was</span>
  <span m='1002980'>a</span> <span m='1003010'>little</span> <span m='1003190'>bit</span>
  <span m='1003310'>off.</span> <span m='1003580'>At</span> <span m='1003670'>the</span>
  <span m='1003790'>bottom,</span> <span m='1004690'>the</span> <span m='1004780'>leaf</span>
  <span m='1005050'>level,</span> <span m='1005980'>when</span> <span m='1006070'>these</span>
  <span m='1006280'>are</span> <span m='1006520'>both</span> <span m='1006900'>h--</span>
  <span m='1009400'>the</span> <span m='1009490'>density</span> <span m='1009850'>has</span>
  <span m='1010000'>to</span> <span m='1010060'>be</span> <span m='1010150'>at</span>
  <span m='1010210'>least</span> <span m='1010480'>a</span> <span m='1010540'>1/4</span>
  <span m='1010930'>and</span> <span m='1011050'>at</span> <span m='1011140'>most,</span>
  <span m='1011920'>100%.</span> <span m='1013600'>And</span> <span m='1013780'>then</span>
  <span m='1013960'>at</span> <span m='1014110'>the</span> <span m='1014200'>root,</span>
  <span m='1014830'>it's</span> <span m='1015010'>going</span> <span m='1015160'>to</span>
  <span m='1015220'>have</span> <span m='1015430'>to</span> <span m='1015580'>be</span>
  <span m='1015880'>between</span> <span m='1017390'>1/2</span> <span m='1018610'>and</span>
  <span m='1018730'>3/4.</span> <span m='1020410'>So</span> <span m='1020560'>it's</span>
  <span m='1020650'>a</span> <span m='1020740'>narrower</span> <span m='1021220'>range.</span>
  <span m='1023110'>And</span> <span m='1023740'>the</span> <span m='1023860'>higher</span>
  <span m='1024130'>you</span> <span m='1024190'>go</span> <span m='1024400'>up,</span>
  <span m='1024579'>the</span> <span m='1024700'>more</span> <span m='1024910'>narrow</span>
  <span m='1025780'>the</span> <span m='1025869'>range</span> <span m='1026260'>on</span>
  <span m='1026380'>the</span> <span m='1026470'>density</span> <span m='1027220'>gets.</span>
  <span m='1028480'>And</span> <span m='1028690'>we</span> <span m='1028780'>do</span>
  <span m='1028930'>it</span> <span m='1029050'>just</span> <span m='1029210'>sort</span>
  <span m='1029470'>of</span> <span m='1029560'>in</span> <span m='1029619'>the</span>
  <span m='1029740'>obvious</span> <span m='1030200'>linear</span> <span m='1030400'>interpolation</span>
  <span m='1031000'>way.</span> </p><p><span m='1032530'>The</span> <span m='1032829'>not</span>
  <span m='1033099'>so</span> <span m='1033220'>obvious</span> <span m='1033490'>thing</span>
  <span m='1033700'>is</span> <span m='1033790'>that</span> <span m='1033910'>this</span>
  <span m='1034089'>is</span> <span m='1034210'>the</span> <span m='1034359'>right</span>
  <span m='1034690'>way</span> <span m='1034810'>to</span> <span m='1034930'>do</span>
  <span m='1035109'>it.</span> <span m='1035609'>There's</span> <span m='1035920'>a</span>
  <span m='1035980'>lot</span> <span m='1036220'>of</span> <span m='1036280'>choices</span>
  <span m='1036730'>for</span> <span m='1036849'>how</span> <span m='1037000'>to</span>
  <span m='1037089'>set</span> <span m='1037300'>these</span> <span m='1037480'>density</span>
  <span m='1037900'>thresholds.</span> <span m='1038550'>But</span> <span m='1039760'>we</span>
  <span m='1039970'>have</span> <span m='1040150'>to</span> <span m='1040300'>basically</span>
  <span m='1040720'>maintain</span> <span m='1041140'>constant</span> <span m='1041589'>density</span>
  <span m='1042010'>everywhere</span> <span m='1042520'>because</span> <span m='1042940'>we're</span>
  <span m='1043089'>trying</span> <span m='1043510'>to</span> <span m='1043690'>maintain</span>
  <span m='1044170'>gaps</span> <span m='1044500'>of</span> <span m='1044589'>constant</span>
  <span m='1044940'>size.</span> <span m='1045859'>So</span> <span m='1045970'>we</span>
  <span m='1046060'>don't</span> <span m='1046240'>have</span> <span m='1046390'>a</span>
  <span m='1046420'>lot</span> <span m='1046569'>of</span> <span m='1046630'>flexibility.</span>
  <span m='1048369'>But</span> <span m='1048430'>it</span> <span m='1048490'>turns</span>
  <span m='1048790'>out,</span> <span m='1049000'>this</span> <span m='1049150'>flexibility</span>
  <span m='1049750'>between</span> <span m='1050080'>two</span> <span m='1050260'>constants,</span>
  <span m='1050980'>like</span> <span m='1051250'>1/4</span> <span m='1051700'>and</span>
  <span m='1051820'>1/2</span> <span m='1052630'>is</span> <span m='1052780'>enough</span>
  <span m='1053890'>to</span> <span m='1054100'>give</span> <span m='1054400'>us</span>
  <span m='1054730'>the</span> <span m='1054850'>performance</span> <span m='1055390'>we</span>
  <span m='1055510'>need.</span> <span m='1057020'>So</span> <span m='1058030'>let's</span>
  <span m='1058210'>see</span> <span m='1058450'>why.</span> </p><p><span m='1061720'>Let</span>
  <span m='1061810'>me</span> <span m='1061930'>finish</span> <span m='1062170'>this</span>
  <span m='1062320'>algorithm.</span> <span m='1062870'>We</span> <span m='1062970'>walk</span>
  <span m='1063130'>up</span> <span m='1063250'>the</span> <span m='1063340'>tree</span>
  <span m='1064420'>until</span> <span m='1064870'>reaching</span> <span m='1065260'>a</span>
  <span m='1065320'>node</span> <span m='1065680'>within</span> <span m='1066010'>threshold.</span>
  <span m='1066670'>Density</span> <span m='1067120'>is</span> <span m='1067240'>this.</span>
  <span m='1068260'>Density</span> <span m='1068620'>threshold</span> <span m='1069190'>is</span>
  <span m='1069340'>this.</span> <span m='1069780'>So now</span> <span m='1069940'>we</span>
  <span m='1070030'>know</span> <span m='1070300'>within</span> <span m='1070600'>threshold</span>
  <span m='1071050'>means.</span> <span m='1071830'>And</span> <span m='1072010'>then</span>
  <span m='1072220'>we</span> <span m='1072400'>evenly</span> <span m='1072940'>rebalance</span>
  <span m='1075460'>or</span> <span m='1075730'>redistribute</span> <span m='1079840'>all</span>
  <span m='1080140'>the</span> <span m='1080260'>descendant</span> <span m='1080710'>elements</span>
  <span m='1087490'>in</span> <span m='1087640'>that</span> <span m='1087820'>interval</span>
  <span m='1088270'>that</span> <span m='1088390'>is</span> <span m='1088510'>within</span>
  <span m='1088810'>threshold.</span> </p><p><span m='1098730'>So</span> <span m='1099060'>what</span>
  <span m='1099240'>you</span> <span m='1099360'>need</span> <span m='1099510'>to</span>
  <span m='1099600'>check</span> <span m='1099870'>is</span> <span m='1099960'>that</span>
  <span m='1100050'>you</span> <span m='1100170'>can</span> <span m='1100320'>do</span>
  <span m='1100410'>this</span> <span m='1100590'>with</span> <span m='1100710'>a</span>
  <span m='1100770'>constant</span> <span m='1101160'>number</span> <span m='1101370'>of</span>
  <span m='1101430'>scans.</span> <span m='1102420'>It's</span> <span m='1102510'>not</span>
  <span m='1102660'>that</span> <span m='1102810'>hard.</span> <span m='1104220'>Just</span>
  <span m='1104580'>read</span> <span m='1104730'>the</span> <span m='1104850'>elements</span>
  <span m='1105120'>in</span> <span m='1105210'>order.</span> <span m='1105570'>Write</span>
  <span m='1105810'>them</span> <span m='1105960'>out</span> <span m='1106170'>to</span>
  <span m='1106380'>a</span> <span m='1106440'>temporary</span> <span m='1106950'>array,</span>
  <span m='1107220'>and</span> <span m='1107310'>then</span> <span m='1107430'>write</span>
  <span m='1107610'>them</span> <span m='1107730'>back.</span> <span m='1108150'>Or</span>
  <span m='1108270'>if</span> <span m='1108360'>you're</span> <span m='1108450'>fancy,</span>
  <span m='1108810'>you</span> <span m='1108930'>can</span> <span m='1109080'>do</span>
  <span m='1109170'>it</span> <span m='1109230'>in</span> <span m='1109350'>place.</span>
  <span m='1110980'>But</span> <span m='1111480'>you</span> <span m='1111570'>can</span>
  <span m='1111690'>just</span> <span m='1111840'>do</span> <span m='1112020'>it</span>
  <span m='1112140'>by</span> <span m='1112450'>a</span> <span m='1112470'>constant</span>
  <span m='1112830'>number</span> <span m='1113070'>of</span> <span m='1113160'>scans</span>
  <span m='1113610'>through</span> <span m='1113760'>the</span> <span m='1113880'>array.</span>
  <span m='1117390'>Just</span> <span m='1117570'>compute</span> <span m='1119970'>what</span>
  <span m='1120450'>should</span> <span m='1120720'>be</span> <span m='1120870'>the</span>
  <span m='1121020'>average</span> <span m='1121500'>gap</span> <span m='1121920'>between</span>
  <span m='1122280'>the</span> <span m='1122370'>elements.</span> <span m='1123230'>Leave</span>
  <span m='1123420'>that</span> <span m='1123580'>many</span> <span m='1123780'>gaps.</span>
  </p><p><span m='1127070'>So</span> <span m='1127895'>the</span> <span m='1128240'>algorithm</span>
  <span m='1128570'>is</span> <span m='1128730'>pretty</span> <span m='1128960'>simple</span>
  <span m='1130880'>once</span> <span m='1131090'>you</span> <span m='1131180'>say,</span>
  <span m='1131480'>OK,</span> <span m='1131720'>I'm</span> <span m='1131810'>going</span>
  <span m='1131930'>to</span> <span m='1131990'>grow</span> <span m='1132290'>intervals.</span>
  <span m='1134090'>Then</span> <span m='1134390'>maybe,</span> <span m='1134630'>you</span>
  <span m='1134720'>think</span> <span m='1135130'>OK,</span> <span m='1135530'>I</span>
  <span m='1135590'>guess</span> <span m='1135860'>I'll</span> <span m='1136160'>grow</span>
  <span m='1136430'>intervals</span> <span m='1136820'>according</span> <span m='1137120'>to</span>
  <span m='1137240'>a</span> <span m='1137270'>binary</span> <span m='1137630'>tree.</span>
  <span m='1137900'>It's</span> <span m='1138050'>a</span> <span m='1138080'>little</span>
  <span m='1138320'>bit</span> <span m='1138410'>more</span> <span m='1138590'>controlled.</span>
  <span m='1139250'>Probably</span> <span m='1139550'>don't</span> <span m='1139700'>have</span>
  <span m='1139910'>to</span> <span m='1140000'>do</span> <span m='1140120'>it</span>
  <span m='1140210'>this</span> <span m='1140360'>way.</span> <span m='1141420'>You</span>
  <span m='1141440'>could</span> <span m='1141590'>just</span> <span m='1141740'>grow</span>
  <span m='1142010'>them</span> <span m='1142190'>by</span> <span m='1142340'>a</span>
  <span m='1142370'>factor</span> <span m='1142700'>of</span> <span m='1142760'>2,</span>
  <span m='1144800'>just</span> <span m='1145100'>around</span> <span m='1145460'>your</span>
  <span m='1145580'>point.</span> <span m='1146090'>But</span> <span m='1146330'>it's</span>
  <span m='1146480'>easier</span> <span m='1146780'>to</span> <span m='1146900'>analyze</span>
  <span m='1147530'>in</span> <span m='1147740'>the</span> <span m='1147830'>setting</span>
  <span m='1148220'>of</span> <span m='1148340'>a</span> <span m='1149000'>binary</span>
  <span m='1149360'>tree.</span> </p><p><span m='1150570'>And</span> <span m='1150670'>then</span>
  <span m='1150680'>once</span> <span m='1150860'>you're</span> <span m='1150950'>doing</span>
  <span m='1151190'>that,</span> <span m='1151490'>the</span> <span m='1151610'>tricky</span>
  <span m='1151880'>part</span> <span m='1152120'>is</span> <span m='1152240'>to</span>
  <span m='1152330'>set</span> <span m='1152510'>the</span> <span m='1152600'>density</span>
  <span m='1153000'>thresholds.</span> <span m='1153600'>But</span> <span m='1153800'>you</span>
  <span m='1153920'>fool</span> <span m='1154190'>around</span> <span m='1154610'>and</span>
  <span m='1154700'>this</span> <span m='1154820'>seems</span> <span m='1155210'>to</span>
  <span m='1155330'>be</span> <span m='1155540'>the</span> <span m='1155690'>best</span>
  <span m='1155930'>way</span> <span m='1156080'>to</span> <span m='1156170'>do</span>
  <span m='1156350'>it.</span> <span m='1158870'>Now</span> <span m='1159110'>the</span>
  <span m='1159200'>question</span> <span m='1159500'>is,</span> <span m='1159620'>why</span>
  <span m='1159860'>does</span> <span m='1160010'>this</span> <span m='1160160'>work.</span>
  <span m='1160920'>How</span> <span m='1160970'>do</span> <span m='1161090'>we</span>
  <span m='1161300'>prove</span> <span m='1162230'>log</span> <span m='1162470'>squared</span>
  <span m='1162800'>amortized</span> <span m='1164030'>interval</span> <span m='1164390'>size</span>
  <span m='1167060'>when</span> <span m='1167240'>we</span> <span m='1167360'>follow</span>
  <span m='1167660'>these</span> <span m='1167810'>dense</span> <span m='1168090'>thresholds?</span>
  </p><p><span m='1168560'>Notice</span> <span m='1168890'>that</span> <span m='1169040'>we're</span>
  <span m='1169160'>not</span> <span m='1169460'>keeping</span> <span m='1169880'>intervals</span>
  <span m='1170990'>within</span> <span m='1171290'>density</span> <span m='1171830'>at</span>
  <span m='1171950'>all</span> <span m='1172100'>times.</span> <span m='1174350'>I</span>
  <span m='1174410'>mean,</span> <span m='1174590'>the</span> <span m='1174680'>whole</span>
  <span m='1174830'>problem</span> <span m='1175340'>is</span> <span m='1175490'>that</span>
  <span m='1175610'>things</span> <span m='1175910'>are</span> <span m='1176030'>not</span>
  <span m='1178100'>within</span> <span m='1178400'>threshold</span> <span m='1179030'>right</span>
  <span m='1179300'>at</span> <span m='1179420'>the</span> <span m='1179510'>start.</span>
  <span m='1180220'>And</span> <span m='1180310'>we</span> <span m='1180410'>have</span>
  <span m='1180560'>to</span> <span m='1180650'>walk</span> <span m='1180980'>up</span>
  <span m='1181130'>the</span> <span m='1181250'>tree</span> <span m='1181460'>quite</span>
  <span m='1181790'>a</span> <span m='1181850'>ways,</span> <span m='1182120'>potentially--</span>
  <span m='1184340'>claim</span> <span m='1184670'>is</span> <span m='1184790'>only</span>
  <span m='1185330'>about</span> <span m='1185630'>log-log</span> <span m='1186470'>N</span>
  <span m='1186620'>levels</span> <span m='1187130'>up</span> <span m='1187340'>the</span>
  <span m='1187430'>tree--</span> <span m='1188480'>to</span> <span m='1188630'>find</span>
  <span m='1188930'>something</span> <span m='1189260'>that's</span> <span m='1189410'>within</span>
  <span m='1189740'>density.</span> <span m='1190160'>And</span> <span m='1190250'>then</span>
  <span m='1190370'>we</span> <span m='1190490'>can</span> <span m='1190610'>redistribute.</span>
  <span m='1191570'>And</span> <span m='1191660'>then</span> <span m='1191750'>we</span>
  <span m='1191870'>fix</span> <span m='1192230'>everything</span> <span m='1192650'>below</span>
  <span m='1193010'>us.</span> <span m='1195710'>All</span> <span m='1195770'>right.</span>
  <span m='1195970'>Well,</span> <span m='1196160'>let's</span> <span m='1197000'>get</span>
  <span m='1197120'>to</span> <span m='1197240'>that.</span> </p><p><span m='1211990'>This</span>
  <span m='1212150'>is</span> <span m='1212270'>really</span> <span m='1212510'>the</span>
  <span m='1212630'>direction</span> <span m='1213050'>we</span> <span m='1213170'>want.
  The</span> <span m='1213640'>thresholds</span> <span m='1214100'>are</span> <span
  m='1214160'>getting</span> <span m='1214430'>tighter</span> <span m='1214850'>and</span>
  <span m='1214970'>tighter,</span> <span m='1215460'>more</span> <span m='1215750'>constrained</span>
  <span m='1216290'>as</span> <span m='1216440'>we</span> <span m='1216560'>go</span>
  <span m='1216770'>up.</span> <span m='1216950'>Because</span> <span m='1217250'>it</span>
  <span m='1217310'>means</span> <span m='1217520'>if</span> <span m='1217730'>we</span>
  <span m='1217880'>walk</span> <span m='1218210'>up</span> <span m='1218360'>a</span>
  <span m='1218450'>lot,</span> <span m='1219590'>we,</span> <span m='1219740'>essentially,</span>
  <span m='1220190'>can</span> <span m='1220370'>pay</span> <span m='1220700'>for</span>
  <span m='1221000'>it</span> <span m='1221450'>because</span> <span m='1221840'>we</span>
  <span m='1222080'>bring</span> <span m='1222500'>that</span> <span m='1222680'>interval</span>
  <span m='1223640'>even</span> <span m='1223970'>farther</span> <span m='1225080'>within</span>
  <span m='1225380'>threshold.</span> </p><p><span m='1227500'>So</span> <span m='1230010'>we</span>
  <span m='1230140'>have</span> <span m='1230560'>some</span> <span m='1230780'>node,</span>
  <span m='1231680'>which</span> <span m='1231860'>is</span> <span m='1231950'>within</span>
  <span m='1232250'>threshold.</span> <span m='1233400'>So</span> <span m='1233450'>we</span>
  <span m='1233510'>bring</span> <span m='1233750'>it</span> <span m='1233870'>into</span>
  <span m='1234110'>the</span> <span m='1234200'>density</span> <span m='1234560'>thresholds</span>
  <span m='1234980'>of</span> <span m='1235070'>here.</span> <span m='1235640'>If</span>
  <span m='1235790'>we</span> <span m='1235850'>look</span> <span m='1236060'>at</span>
  <span m='1236120'>the</span> <span m='1236240'>children</span> <span m='1236750'>of</span>
  <span m='1236870'>that</span> <span m='1237080'>node,</span> <span m='1238280'>their</span>
  <span m='1238700'>density</span> <span m='1239120'>thresholds</span> <span m='1240230'>are</span>
  <span m='1240350'>smaller--</span> <span m='1242930'>sorry,</span> <span m='1243050'>are</span>
  <span m='1243410'>more</span> <span m='1243680'>relaxed.</span> <span m='1244460'>So</span>
  <span m='1244610'>if</span> <span m='1244700'>we</span> <span m='1244790'>bring</span>
  <span m='1245030'>this</span> <span m='1245210'>node</span> <span m='1245720'>into</span>
  <span m='1245960'>threshold</span> <span m='1246350'>by</span> <span m='1246500'>rewriting</span>
  <span m='1246980'>all</span> <span m='1247310'>the</span> <span m='1247400'>leaves</span>
  <span m='1247670'>down</span> <span m='1247880'>here,</span> <span m='1248450'>these</span>
  <span m='1248720'>nodes</span> <span m='1248910'>will</span> <span m='1249020'>not</span>
  <span m='1249200'>only</span> <span m='1249410'>be</span> <span m='1249680'>within</span>
  <span m='1250010'>threshold,</span> <span m='1250820'>they'll</span> <span m='1250940'>be</span>
  <span m='1251090'>far</span> <span m='1251600'>within</span> <span m='1251930'>threshold.</span>
  </p><p><span m='1254090'>If</span> <span m='1254270'>you</span> <span m='1254360'>look</span>
  <span m='1254540'>at</span> <span m='1254630'>their</span> <span m='1254840'>ratios,</span>
  <span m='1256610'>you</span> <span m='1256730'>know,</span> <span m='1256920'>their</span>
  <span m='1257600'>densities--</span> <span m='1258660'>the</span> <span m='1258760'>number</span>
  <span m='1258890'>of</span> <span m='1258980'>elements</span> <span m='1259370'>in</span>
  <span m='1259460'>there,</span> <span m='1260150'>divided</span> <span m='1260510'>by</span>
  <span m='1260750'>the</span> <span m='1260870'>array</span> <span m='1261080'>slots.</span>
  <span m='1261800'>It's</span> <span m='1261920'>going</span> <span m='1262070'>to</span>
  <span m='1262130'>be</span> <span m='1262190'>exactly</span> <span m='1262610'>the</span>
  <span m='1262730'>same.</span> <span m='1263130'>The</span> <span m='1263230'>density</span>
  <span m='1263630'>is</span> <span m='1263720'>equal</span> <span m='1265730'>because</span>
  <span m='1266060'>we're</span> <span m='1266320'>uniformly</span> <span m='1267050'>distributing</span>
  <span m='1267650'>the</span> <span m='1267860'>items</span> <span m='1268160'>here.</span>
  <span m='1268290'>And</span> <span m='1268400'>there's</span> <span m='1268600'>some</span>
  <span m='1268850'>rounding</span> <span m='1269210'>errors,</span> <span m='1269600'>but</span>
  <span m='1270230'>other</span> <span m='1270440'>than</span> <span m='1270590'>rounding.</span>
  <span m='1272070'>And</span> <span m='1272240'>that's</span> <span m='1272540'>actually</span>
  <span m='1272870'>why</span> <span m='1273110'>we</span> <span m='1273260'>have</span>
  <span m='1273410'>these</span> <span m='1273560'>leaves</span> <span m='1273830'>as</span>
  <span m='1274100'>size theta</span> <span m='1274340'>log</span> <span m='1274670'>N,</span>
  <span m='1274820'>so</span> <span m='1275000'>the</span> <span m='1275090'>rounding</span>
  <span m='1275480'>doesn't</span> <span m='1275780'>bite</span> <span m='1276050'>us.</span>
  </p><p><span m='1278990'>We're</span> <span m='1279110'>evenly</span> <span m='1279950'>redistributing</span>
  <span m='1280490'>so</span> <span m='1280610'>the</span> <span m='1280680'>density</span>
  <span m='1280940'>is</span> <span m='1281060'>equal</span> <span m='1281450'>everywhere.</span>
  <span m='1282550'>Left</span> <span m='1282740'>child</span> <span m='1282980'>had</span>
  <span m='1283100'>the</span> <span m='1283220'>same</span> <span m='1283490'>density</span>
  <span m='1283880'>as</span> <span m='1283970'>the</span> <span m='1284090'>parent.</span>
  <span m='1285320'>But</span> <span m='1285470'>if</span> <span m='1285560'>you</span>
  <span m='1285620'>look</span> <span m='1285770'>at</span> <span m='1285830'>the</span>
  <span m='1285920'>density</span> <span m='1286250'>thresholds</span> <span m='1287950'>of</span>
  <span m='1288200'>the</span> <span m='1288320'>child,</span> <span m='1288890'>they</span>
  <span m='1289040'>will</span> <span m='1289160'>be</span> <span m='1289310'>more</span>
  <span m='1289580'>relaxed</span> <span m='1290150'>compared</span> <span m='1290630'>to</span>
  <span m='1290720'>the</span> <span m='1290840'>parent.</span> <span m='1291270'>So</span>
  <span m='1291350'>if</span> <span m='1291470'>the</span> <span m='1291560'>parent</span>
  <span m='1291890'>is</span> <span m='1292040'>within</span> <span m='1292340'>threshold,</span>
  <span m='1292850'>the</span> <span m='1292940'>child</span> <span m='1293390'>will</span>
  <span m='1293540'>be</span> <span m='1293720'>far</span> <span m='1294170'>within</span>
  <span m='1294440'>threshold</span> <span m='1295460'>by</span> <span m='1295640'>at</span>
  <span m='1295700'>least</span> <span m='1296840'>a d</span> <span m='1297335'>over</span>
  <span m='1297830'>h</span> <span m='1298790'>additive</span> <span m='1299690'>amount.</span>
  <span m='1300790'>Sorry,</span> <span m='1301160'>1</span> <span m='1301430'>over</span>
  <span m='1301610'>h,</span> <span m='1302090'>because</span> <span m='1302270'>their</span>
  <span m='1302390'>depths</span> <span m='1303080'>differ</span> <span m='1303350'>by</span>
  <span m='1303560'>1.</span> <span m='1303860'>If this</span> <span m='1304040'>is</span>
  <span m='1304170'>d,</span> <span m='1304560'>this would</span> <span m='1304990'>be
  d</span> <span m='1305420'>plus</span> <span m='1305720'>1.</span> </p><p><span
  m='1311480'>When</span> <span m='1311690'>we</span> <span m='1311840'>rebalance</span>
  <span m='1312380'>a</span> <span m='1312660'>node,</span> <span m='1321560'>we</span>
  <span m='1321770'>put</span> <span m='1323570'>the</span> <span m='1323660'>children</span>
  <span m='1328400'>far</span> <span m='1328910'>within</span> <span m='1329250'>threshold.</span>
  <span m='1335610'>Meaning,</span> <span m='1339560'>if</span> <span m='1339710'>we</span>
  <span m='1339800'>look</span> <span m='1339980'>at</span> <span m='1340100'>the</span>
  <span m='1341180'>absolute</span> <span m='1341900'>difference</span> <span m='1342380'>between</span>
  <span m='1342710'>the</span> <span m='1342830'>density</span> <span m='1344180'>and</span>
  <span m='1344750'>either</span> <span m='1345140'>the</span> <span m='1345290'>upper</span>
  <span m='1345560'>threshold</span> <span m='1346280'>or</span> <span m='1346550'>the</span>
  <span m='1346670'>lower</span> <span m='1346940'>threshold,</span> <span m='1349400'>that</span>
  <span m='1349580'>will</span> <span m='1349700'>be,</span> <span m='1352600'>I</span>
  <span m='1352900'>guess,</span> <span m='1353150'>at</span> <span m='1353210'>least</span>
  <span m='1355040'>1</span> <span m='1355580'>over</span> <span m='1356040'>4h</span>
  <span m='1361010'>because</span> <span m='1361730'>we're</span> <span m='1361970'>increasing</span>
  <span m='1362510'>d</span> <span m='1362630'>by</span> <span m='1362820'>1.</span>
  <span m='1363960'>And it's</span> <span m='1364280'>1</span> <span m='1364460'>over</span>
  <span m='1364640'>for</span> <span m='1364910'>4h</span> <span m='1365900'>for</span>
  <span m='1366020'>each</span> <span m='1366230'>step</span> <span m='1366770'>we</span>
  <span m='1366890'>take.</span> <span m='1369470'>OK</span> <span m='1369650'>so</span>
  <span m='1369800'>the</span> <span m='1369890'>children</span> <span m='1370400'>are</span>
  <span m='1371240'>extra</span> <span m='1371570'>happy.</span> </p><p><span m='1373460'>We</span>
  <span m='1373640'>walked</span> <span m='1373970'>up</span> <span m='1374120'>here</span>
  <span m='1374330'>because</span> <span m='1374690'>before--</span> <span m='1375890'>let's</span>
  <span m='1376070'>say</span> <span m='1376250'>we</span> <span m='1376370'>walked</span>
  <span m='1376700'>up</span> <span m='1376850'>this</span> <span m='1377030'>path.</span>
  <span m='1377510'>So</span> <span m='1377760'>we</span> <span m='1377840'>walked</span>
  <span m='1378080'>from</span> <span m='1378230'>the</span> <span m='1378320'>right</span>
  <span m='1378530'>child.</span> <span m='1380150'>We</span> <span m='1380270'>didn't</span>
  <span m='1380510'>stop</span> <span m='1380990'>here,</span> <span m='1381320'>which</span>
  <span m='1381530'>means</span> <span m='1381770'>this</span> <span m='1382050'>node</span>
  <span m='1382370'>was</span> <span m='1383390'>was</span> <span m='1383930'>beyond</span>
  <span m='1384290'>threshold.</span> <span m='1386420'>But</span> <span m='1386600'>now</span>
  <span m='1387950'>we</span> <span m='1388160'>walked</span> <span m='1388520'>up</span>
  <span m='1389660'>and</span> <span m='1389840'>now</span> <span m='1389990'>we</span>
  <span m='1390140'>fixed</span> <span m='1390680'>this</span> <span m='1390860'>entire</span>
  <span m='1391430'>interval.</span> <span m='1393020'>And</span> <span m='1393170'>now</span>
  <span m='1393320'>it's</span> <span m='1393440'>far</span> <span m='1393740'>within</span>
  <span m='1394040'>threshold.</span> </p><p><span m='1394700'>So</span> <span m='1394850'>before,</span>
  <span m='1396930'>you</span> <span m='1397010'>know, the</span> <span m='1397290'>density</span>
  <span m='1397700'>minus the</span> <span m='1397880'>threshold</span> <span m='1398360'>went</span>
  <span m='1398780'>the</span> <span m='1398840'>wrong</span> <span m='1399080'>way,</span>
  <span m='1399290'>had</span> <span m='1399410'>the</span> <span m='1399500'>wrong</span>
  <span m='1399710'>sign.</span> <span m='1400610'>Now</span> <span m='1400820'>we're</span>
  <span m='1400940'>good,</span> <span m='1401360'>and</span> <span m='1401480'>we're</span>
  <span m='1401630'>good</span> <span m='1401870'>by</span> <span m='1402080'>at</span>
  <span m='1402170'>least</span> <span m='1402520'>a</span> <span m='1402610'>1</span>
  <span m='1402890'>over</span> <span m='1403130'>4h.</span> <span m='1404370'>Now</span>
  <span m='1404550'>h,</span> <span m='1404900'>here,</span> <span m='1406010'>was</span>
  <span m='1406580'>the</span> <span m='1406640'>height</span> <span m='1406820'>of</span>
  <span m='1406880'>the</span> <span m='1407000'>tree.</span> <span m='1407420'>It's</span>
  <span m='1407590'>log</span> <span m='1407930'>N</span> <span m='1408140'>minus</span>
  <span m='1408440'>log-log</span> <span m='1408880'>N.</span> <span m='1409430'>All</span>
  <span m='1409580'>we</span> <span m='1409730'>need</span> <span m='1410390'>is</span>
  <span m='1410570'>that</span> <span m='1410680'>this</span> <span m='1410960'>is</span>
  <span m='1412690'>theta</span> <span m='1412940'>log</span> <span m='1413320'>N--</span>
  <span m='1415180'>sorry,</span> <span m='1415890'>theta</span> <span m='1416300'>1</span>
  <span m='1416510'>over</span> <span m='1416690'>log</span> <span m='1416960'>N.</span>
  <span m='1417480'>h</span> <span m='1417790'>is</span> <span m='1417960'>theta</span>
  <span m='1418190'>log</span> <span m='1418430'>N.</span> </p><p><span m='1424220'>And</span>
  <span m='1425590'>this</span> <span m='1425770'>is</span> <span m='1425920'>a</span>
  <span m='1426070'>ratio--</span> <span m='1427930'>1</span> <span m='1428050'>over</span>
  <span m='1428230'>log</span> <span m='1428560'>N--</span> <span m='1430330'>of</span>
  <span m='1430570'>the</span> <span m='1430960'>number</span> <span m='1431260'>of</span>
  <span m='1431350'>items</span> <span m='1432070'>versus</span> <span m='1432610'>the</span>
  <span m='1432700'>number</span> <span m='1432940'>of</span> <span m='1433000'>slots.</span>
  <span m='1434230'>But</span> <span m='1434380'>we</span> <span m='1434470'>know</span>
  <span m='1434620'>the</span> <span m='1434740'>number</span> <span m='1434980'>of</span>
  <span m='1435040'>slots</span> <span m='1435400'>we're</span> <span m='1435520'>dealing</span>
  <span m='1435820'>with</span> <span m='1436920'>is</span> <span m='1437140'>theta</span>
  <span m='1437380'>log</span> <span m='1437680'>N.</span> <span m='1437950'>And</span>
  <span m='1438070'>so</span> <span m='1438190'>this</span> <span m='1438400'>is</span>
  <span m='1438520'>at</span> <span m='1438610'>least</span> <span m='1438940'>one</span>
  <span m='1439270'>item.</span> <span m='1442030'>This</span> <span m='1442210'>log</span>
  <span m='1442510'>N</span> <span m='1442660'>is</span> <span m='1442840'>designed</span>
  <span m='1443260'>to</span> <span m='1443350'>balance</span> <span m='1443860'>the</span>
  <span m='1444010'>h,</span> <span m='1444610'>here.</span> <span m='1447340'>OK,</span>
  <span m='1447850'>cool.</span> </p><p><span m='1451260'>Let's</span> <span m='1451840'>go</span>
  <span m='1452100'>over</span> <span m='1452550'>here.</span> <span m='1459270'>So
  the</span> <span m='1459710'>idea is</span> <span m='1460660'>if we're</span> <span
  m='1460820'>far</span> <span m='1461150'>within</span> <span m='1461420'>threshold,</span>
  <span m='1461870'>we</span> <span m='1462020'>can</span> <span m='1462200'>charge</span>
  <span m='1462650'>to</span> <span m='1462770'>those</span> <span m='1463010'>items.</span>
  <span m='1463810'>That's</span> <span m='1464030'>our</span> <span m='1464180'>goal.</span>
  </p><p><span m='1490950'>What</span> <span m='1491100'>we're</span> <span m='1491220'>interested</span>
  <span m='1491690'>in--</span> <span m='1491910'>if</span> <span m='1492030'>we</span>
  <span m='1492300'>just</span> <span m='1492540'>rebalanced</span> <span m='1493080'>this</span>
  <span m='1493270'>node,</span> <span m='1493590'>say</span> <span m='1493860'>x.</span>
  <span m='1494820'>We</span> <span m='1494940'>want</span> <span m='1495090'>to</span>
  <span m='1495150'>know</span> <span m='1495300'>when</span> <span m='1495480'>is</span>
  <span m='1495600'>the</span> <span m='1495690'>next</span> <span m='1495900'>time</span>
  <span m='1496170'>x</span> <span m='1496380'>can</span> <span m='1496530'>be</span>
  <span m='1496680'>rebalanced?</span> <span m='1498390'>For</span> <span m='1498540'>x</span>
  <span m='1498810'>to</span> <span m='1498990'>have</span> <span m='1499200'>to</span>
  <span m='1499320'>be</span> <span m='1499440'>rebalanced,</span> <span m='1500070'>that</span>
  <span m='1500250'>means,</span> <span m='1500610'>again,</span> <span m='1501000'>one</span>
  <span m='1501240'>of</span> <span m='1501330'>its</span> <span m='1501480'>children</span>
  <span m='1501930'>will</span> <span m='1502020'>have</span> <span m='1502170'>to</span>
  <span m='1502290'>be</span> <span m='1502470'>out</span> <span m='1502680'>of</span>
  <span m='1502800'>threshold.</span> <span m='1503880'>And</span> <span m='1504000'>then</span>
  <span m='1504150'>we</span> <span m='1504270'>insert or</span> <span m='1504710'>delete</span>
  <span m='1504990'>within</span> <span m='1505320'>that</span> <span m='1505560'>child.</span>
  <span m='1506520'>And</span> <span m='1506640'>then</span> <span m='1506760'>that</span>
  <span m='1506910'>propagates</span> <span m='1507480'>up</span> <span m='1507690'>to</span>
  <span m='1507810'>x.</span> </p><p><span m='1509130'>But</span> <span m='1509250'>right</span>
  <span m='1509430'>now,</span> <span m='1509640'>the</span> <span m='1509760'>children</span>
  <span m='1510150'>are</span> <span m='1510240'>far</span> <span m='1510480'>within</span>
  <span m='1510750'>threshold.</span> <span m='1511510'>So</span> <span m='1511830'>the</span>
  <span m='1511890'>question</span> <span m='1512220'>is,</span> <span m='1512410'>how</span>
  <span m='1512580'>long</span> <span m='1512820'>would</span> <span m='1512940'>it</span>
  <span m='1513000'>take</span> <span m='1513270'>for</span> <span m='1513600'>them</span>
  <span m='1513810'>to</span> <span m='1513960'>get</span> <span m='1514470'>out</span>
  <span m='1514660'>of</span> <span m='1514740'>threshold</span> <span m='1515220'>again?</span>
  <span m='1516060'>Well,</span> <span m='1516360'>you'd</span> <span m='1516540'>have</span>
  <span m='1516780'>to</span> <span m='1517050'>change</span> <span m='1517410'>the</span>
  <span m='1517500'>density</span> <span m='1517920'>by</span> <span m='1518100'>at</span>
  <span m='1518160'>least</span> <span m='1518430'>1</span> <span m='1518610'>over</span>
  <span m='1519330'>an</span> <span m='1519450'>additive--</span> <span m='1520380'>1</span>
  <span m='1520590'>over</span> <span m='1520800'>log</span> <span m='1521260'>N.</span>
  <span m='1521940'>If</span> <span m='1522280'>you</span> <span m='1522570'>multiply</span>
  <span m='1523080'>by</span> <span m='1523230'>the</span> <span m='1523350'>size,</span>
  <span m='1523800'>it's</span> <span m='1523900'>the</span> <span m='1524000'>size</span>
  <span m='1524490'>of</span> <span m='1524610'>the</span> <span m='1524760'>interval</span>
  <span m='1526260'>divided</span> <span m='1526710'>by</span> <span m='1526880'>log</span>
  <span m='1527080'>N.</span> <span m='1527500'>You've</span> <span m='1527600'>got</span>
  <span m='1527610'>to</span> <span m='1527670'>have</span> <span m='1527820'>at</span>
  <span m='1527880'>least</span> <span m='1528180'>that</span> <span m='1528330'>many</span>
  <span m='1528570'>insertions</span> <span m='1529080'>or</span> <span m='1529170'>deletions.</span>
  </p><p><span m='1532650'>Before</span> <span m='1534810'>this</span> <span m='1535110'>node</span>
  <span m='1538020'>rebalances</span> <span m='1538770'>again,</span> <span m='1540330'>one</span>
  <span m='1540540'>of</span> <span m='1540630'>its</span> <span m='1540780'>children</span>
  <span m='1541230'>must</span> <span m='1541470'>get</span> <span m='1541650'>out</span>
  <span m='1541740'>of</span> <span m='1541800'>balance.</span> <span m='1547890'>And</span>
  <span m='1548010'>so</span> <span m='1548220'>you</span> <span m='1548400'>must</span>
  <span m='1548850'>have</span> <span m='1551610'>done</span> <span m='1552150'>at</span>
  <span m='1552300'>least</span> <span m='1553400'>the</span> <span m='1553920'>size</span>
  <span m='1554400'>of</span> <span m='1554460'>the</span> <span m='1554580'>interval</span>
  <span m='1559380'>divided</span> <span m='1559890'>by</span> <span m='1560550'>theta</span>
  <span m='1560640'>log</span> <span m='1560955'>N</span> <span m='1563460'>updates</span>
  <span m='1567410'>for</span> <span m='1567570'>one</span> <span m='1567720'>of</span>
  <span m='1567810'>the</span> <span m='1567900'>children</span> <span m='1568290'>to</span>
  <span m='1568380'>become</span> <span m='1568830'>out</span> <span m='1568960'>of</span>
  <span m='1569010'>balance</span> <span m='1569400'>again.</span> <span m='1570570'>Boom.</span>
  <span m='1571890'>So</span> <span m='1572940'>when</span> <span m='1573120'>this</span>
  <span m='1573240'>rebalance</span> <span m='1573660'>happens</span> <span m='1574020'>again,</span>
  <span m='1574290'>we're</span> <span m='1574380'>going</span> <span m='1574500'>to</span>
  <span m='1574590'>charge</span> <span m='1575070'>to</span> <span m='1575220'>those</span>
  <span m='1575640'>updates,</span> <span m='1577650'>which</span> <span m='1577720'>is</span>
  <span m='1577840'>good</span> <span m='1578350'>because</span> <span m='1578620'>the</span>
  <span m='1579100'>time</span> <span m='1579430'>it</span> <span m='1579490'>takes</span>
  <span m='1579760'>us</span> <span m='1579850'>to</span> <span m='1580000'>do</span>
  <span m='1580120'>the</span> <span m='1580210'>rebalance</span> <span m='1580580'>is</span>
  <span m='1580840'>the</span> <span m='1580930'>size</span> <span m='1581200'>of</span>
  <span m='1581290'>the</span> <span m='1581380'>interval.</span> <span m='1584680'>We</span>
  <span m='1584920'>need</span> <span m='1585040'>to</span> <span m='1585130'>charge</span>
  <span m='1585640'>each</span> <span m='1585820'>of</span> <span m='1585880'>these</span>
  <span m='1586090'>items</span> <span m='1587410'>log</span> <span m='1587675'>N</span>
  <span m='1587940'>times.</span> </p><p><span m='1590340'>So</span> <span m='1590790'>charge</span>
  <span m='1597190'>the</span> <span m='1597280'>rebalance</span> <span m='1597850'>cost,</span>
  <span m='1602840'>which</span> <span m='1603130'>is</span> <span m='1603540'>the</span>
  <span m='1604540'>size</span> <span m='1604990'>of</span> <span m='1605080'>the</span>
  <span m='1605200'>interval</span> <span m='1611640'>to</span> <span m='1612300'>these</span>
  <span m='1612630'>updates.</span> <span m='1617430'>And</span> <span m='1617670'>what</span>
  <span m='1617820'>we</span> <span m='1617940'>know</span> <span m='1618150'>is</span>
  <span m='1618300'>that</span> <span m='1618390'>the</span> <span m='1618510'>updates</span>
  <span m='1618930'>are</span> <span m='1619170'>within</span> <span m='1619560'>the</span>
  <span m='1619680'>interval.</span> </p><p><span m='1631360'>So</span> <span m='1631780'>this</span>
  <span m='1632110'>looks</span> <span m='1632410'>like</span> <span m='1632800'>a</span>
  <span m='1633100'>log</span> <span m='1633425'>N</span> <span m='1633750'>bound,</span>
  <span m='1635720'>which</span> <span m='1635830'>is</span> <span m='1635920'>not</span>
  <span m='1636160'>right.</span> <span m='1636460'>It</span> <span m='1636790'>should</span>
  <span m='1636970'>be</span> <span m='1637090'>a</span> <span m='1637120'>log</span>
  <span m='1637360'>squared</span> <span m='1637720'>N</span> <span m='1637870'>bound.</span>
  <span m='1639040'>The</span> <span m='1639130'>idea</span> <span m='1639460'>is</span>
  <span m='1643540'>when</span> <span m='1643750'>we</span> <span m='1644590'>insert</span>
  <span m='1645040'>into</span> <span m='1645280'>one</span> <span m='1645430'>of</span>
  <span m='1645520'>these</span> <span m='1645700'>leaves,</span> <span m='1647650'>we're</span>
  <span m='1647830'>simultaneously</span> <span m='1648700'>making</span> <span m='1649540'>this</span>
  <span m='1649750'>node</span> <span m='1649990'>worse</span> <span m='1650770'>and</span>
  <span m='1650980'>this</span> <span m='1651160'>node</span> <span m='1651400'>worse</span>
  <span m='1652180'>and</span> <span m='1652390'>this</span> <span m='1652540'>node</span>
  <span m='1652750'>worse.</span> <span m='1654760'>Whenever</span> <span m='1655030'>we</span>
  <span m='1655180'>insert</span> <span m='1655450'>a</span> <span m='1655510'>node,</span>
  <span m='1655810'>it</span> <span m='1655960'>belongs</span> <span m='1656500'>to</span>
  <span m='1656740'>log</span> <span m='1657280'>N</span> <span m='1657490'>intervals</span>
  <span m='1658030'>that</span> <span m='1658150'>we</span> <span m='1658270'>care</span>
  <span m='1658480'>about.</span> </p><p><span m='1659660'>So</span> <span m='1659680'>in</span>
  <span m='1659740'>fact,</span> <span m='1660080'>not</span> <span m='1660220'>only</span>
  <span m='1660490'>are</span> <span m='1660550'>we</span> <span m='1660670'>losing</span>
  <span m='1660970'>this</span> <span m='1661180'>log</span> <span m='1661400'>N,</span>
  <span m='1662170'>because</span> <span m='1662380'>there</span> <span m='1662470'>aren't</span>
  <span m='1662590'>quite</span> <span m='1663010'>enough</span> <span m='1663340'>items</span>
  <span m='1663790'>to</span> <span m='1663970'>charge</span> <span m='1664390'>to--</span>
  <span m='1664915'>the</span> <span m='1665170'>log</span> <span m='1665410'>N</span>
  <span m='1665530'>factor</span> <span m='1665910'>less.</span> <span m='1666790'>We're</span>
  <span m='1666960'>also</span> <span m='1668050'>charging</span> <span m='1668530'>to</span>
  <span m='1668680'>each</span> <span m='1668920'>item</span> <span m='1669410'>another</span>
  <span m='1669670'>factor</span> <span m='1670030'>of</span> <span m='1670120'>log</span>
  <span m='1670360'>N</span> <span m='1670510'>times</span> <span m='1670960'>because</span>
  <span m='1671740'>it</span> <span m='1671860'>lives</span> <span m='1672160'>in</span>
  <span m='1672250'>all</span> <span m='1672400'>these</span> <span m='1672550'>different</span>
  <span m='1672820'>intervals.</span> </p><p><span m='1683610'>Each</span> <span m='1684000'>update</span>
  <span m='1689490'>gets</span> <span m='1689760'>charged</span> <span m='1691400'>at</span>
  <span m='1692250'>most,</span> <span m='1692640'>h,</span> <span m='1693090'>which</span>
  <span m='1693330'>is</span> <span m='1693610'>order</span> <span m='1693960'>log</span>
  <span m='1694260'>N</span> <span m='1694520'>times.</span> </p><p><span m='1700770'>We</span>
  <span m='1700950'>looked</span> <span m='1701220'>at</span> <span m='1702390'>what</span>
  <span m='1702660'>happens</span> <span m='1703170'>for</span> <span m='1703350'>node</span>
  <span m='1703590'>x,</span> <span m='1704250'>but</span> <span m='1704400'>we</span>
  <span m='1704520'>have</span> <span m='1704670'>to</span> <span m='1704790'>apply</span>
  <span m='1705060'>this</span> <span m='1705240'>argument</span> <span m='1705600'>simultaneously</span>
  <span m='1706440'>for</span> <span m='1706590'>all</span> <span m='1706800'>nodes</span>
  <span m='1707100'>x.</span> <span m='1707940'>Fortunately,</span> <span m='1708750'>this</span>
  <span m='1708960'>node</span> <span m='1709230'>versus</span> <span m='1709530'>this</span>
  <span m='1709710'>node,</span> <span m='1710250'>they</span> <span m='1710340'>don't</span>
  <span m='1710550'>share</span> <span m='1710910'>any</span> <span m='1711060'>descendants.</span>
  <span m='1711750'>And</span> <span m='1711840'>so</span> <span m='1711990'>there's</span>
  <span m='1712170'>no</span> <span m='1712320'>multiple</span> <span m='1712710'>charging.</span>
  <span m='1713650'>But</span> <span m='1714180'>node</span> <span m='1714440'>x</span>
  <span m='1714750'>and</span> <span m='1714880'>its</span> <span m='1715050'>parent</span>
  <span m='1715550'>and</span> <span m='1715730'>grandparent</span> <span m='1716005'>and</span>
  <span m='1716280'>all</span> <span m='1716400'>its</span> <span m='1716520'>ancestors,</span>
  <span m='1718450'>they're</span> <span m='1718710'>all</span> <span m='1718890'>talking</span>
  <span m='1719280'>about</span> <span m='1719490'>the</span> <span m='1719580'>same</span>
  <span m='1719850'>nodes.</span> <span m='1720240'>And</span> <span m='1720330'>so</span>
  <span m='1720510'>they</span> <span m='1720720'>will</span> <span m='1720870'>multiple</span>
  <span m='1721320'>charge,</span> <span m='1721740'>but</span> <span m='1721860'>only</span>
  <span m='1722100'>by</span> <span m='1722250'>a</span> <span m='1722280'>factor</span>
  <span m='1722610'>of</span> <span m='1722700'>log</span> <span m='1722900'>N.</span>
  <span m='1723400'>That's</span> <span m='1723540'>something</span> <span m='1723870'>we've</span>
  <span m='1723990'>seen</span> <span m='1724610'>a</span> <span m='1724710'>few</span>
  <span m='1724860'>times,</span> <span m='1725220'>charging</span> <span m='1725580'>log</span>
  <span m='1725770'>N</span> <span m='1725910'>times,</span> <span m='1726870'>for</span>
  <span m='1727020'>every</span> <span m='1727260'>node</span> <span m='1727470'>in</span>
  <span m='1727560'>the</span> <span m='1727650'>tree,</span> <span m='1727920'>like</span>
  <span m='1729270'>range</span> <span m='1729570'>trees</span> <span m='1729870'>having
  N</span> <span m='1730170'>log</span> <span m='1730530'>N</span> <span m='1730680'>space</span>
  <span m='1731130'>in</span> <span m='1731250'>two</span> <span m='1731400'>dimensions.</span>
  <span m='1732720'>Same</span> <span m='1732990'>deal.</span> </p><p><span m='1735470'>So</span>
  <span m='1735720'>we've</span> <span m='1735840'>got</span> <span m='1737210'>size
  of</span> <span m='1737580'>the</span> <span m='1737670'>interval</span> <span m='1737910'>divided</span>
  <span m='1738210'>by</span> <span m='1738330'>log</span> <span m='1738560'>N</span>
  <span m='1738720'>guys</span> <span m='1738960'>to</span> <span m='1739050'>charge</span>
  <span m='1739440'>to,</span> <span m='1739770'>which</span> <span m='1739920'>we</span>
  <span m='1740010'>multiply</span> <span m='1740430'>charge</span> <span m='1740850'>log</span>
  <span m='1741130'>N</span> <span m='1741270'>times,</span> <span m='1742170'>so</span>
  <span m='1742320'>we</span> <span m='1742410'>get</span> <span m='1742530'>a</span>
  <span m='1742590'>log</span> <span m='1742860'>squared</span> <span m='1743340'>amortized</span>
  <span m='1743850'>bound.</span> </p><p><span m='1755180'>So</span> <span m='1755630'>this</span>
  <span m='1755840'>log</span> <span m='1756100'>N</span> <span m='1756320'>is</span>
  <span m='1756470'>hard</span> <span m='1756710'>to</span> <span m='1756860'>avoid</span>
  <span m='1759110'>because</span> <span m='1759350'>we</span> <span m='1759470'>have</span>
  <span m='1759710'>a</span> <span m='1759770'>binary</span> <span m='1760160'>tree</span>
  <span m='1760490'>that's</span> <span m='1761030'>pretty</span> <span m='1761300'>natural.</span>
  <span m='1762890'>This</span> <span m='1763100'>log</span> <span m='1763460'>N,</span>
  <span m='1764750'>essentially,</span> <span m='1765200'>comes</span> <span m='1765560'>from</span>
  <span m='1766660'>this</span> <span m='1766970'>h.</span> <span m='1768050'>The</span>
  <span m='1768140'>fact</span> <span m='1768410'>that</span> <span m='1768530'>we</span>
  <span m='1768650'>can</span> <span m='1768770'>only</span> <span m='1769100'>go</span>
  <span m='1769280'>from</span> <span m='1769490'>one</span> <span m='1769700'>constant</span>
  <span m='1770120'>factor</span> <span m='1770510'>to</span> <span m='1770660'>another.</span>
  <span m='1770960'>And</span> <span m='1771050'>we've</span> <span m='1771170'>got</span>
  <span m='1771380'>log</span> <span m='1771680'>N</span> <span m='1771980'>different</span>
  <span m='1772250'>steps</span> <span m='1772580'>to</span> <span m='1772700'>make.</span>
  <span m='1773570'>We</span> <span m='1773720'>have</span> <span m='1773930'>to</span>
  <span m='1774050'>do</span> <span m='1774290'>1</span> <span m='1774500'>over</span>
  <span m='1774740'>log</span> <span m='1775040'>N</span> <span m='1776870'>increment</span>
  <span m='1777350'>every</span> <span m='1777590'>step.</span> <span m='1777860'>That's</span>
  <span m='1778070'>the</span> <span m='1778190'>best</span> <span m='1778430'>we</span>
  <span m='1778550'>could</span> <span m='1778670'>afford.</span> <span m='1779630'>That's</span>
  <span m='1779840'>why</span> <span m='1780110'>these</span> <span m='1780290'>are</span>
  <span m='1780350'>evenly</span> <span m='1780980'>spaced</span> <span m='1781370'>out</span>
  <span m='1782650'>in</span> <span m='1782810'>this</span> <span m='1782960'>linear</span>
  <span m='1783290'>way.</span> </p><p><span m='1785880'>But</span> <span m='1785900'>if</span>
  <span m='1785990'>we</span> <span m='1786080'>had</span> <span m='1786230'>a</span>
  <span m='1786290'>little</span> <span m='1786620'>more</span> <span m='1786890'>space,</span>
  <span m='1787520'>we</span> <span m='1787730'>could</span> <span m='1787970'>do</span>
  <span m='1788150'>better.</span> <span m='1789200'>So</span> <span m='1789500'>that's</span>
  <span m='1789710'>going</span> <span m='1789830'>to</span> <span m='1789890'>lead</span>
  <span m='1790040'>us</span> <span m='1790190'>to</span> <span m='1790310'>this</span>
  <span m='1790550'>list</span> <span m='1790760'>labeling</span> <span m='1791210'>problem.</span>
  <span m='1792500'>But</span> <span m='1792740'>first,</span> <span m='1792950'>are</span>
  <span m='1793040'>there</span> <span m='1793130'>any</span> <span m='1793280'>questions</span>
  <span m='1793610'>about</span> <span m='1793820'>order</span> <span m='1794070'>file</span>
  <span m='1794330'>maintenance?</span> <span m='1794690'>At</span> <span m='1794750'>this</span>
  <span m='1794900'>point,</span> <span m='1795240'>we are</span> <span m='1795670'>done.</span>
  <span m='1796370'>Yeah.</span> </p><p><span m='1797034'>AUDIENCE:</span> <span m='1797130'>Can</span>
  <span m='1797226'>you</span> <span m='1797322'>explain</span> <span m='1797418'>again</span>
  <span m='1797518'>how</span> <span m='1798002'>is it that you</span> <span m='1798486'>get</span>
  <span m='1798970'>from the</span> <span m='1799454'>size</span> <span m='1799938'>of
  the interval</span> <span m='1800422'>[INAUDIBLE]</span> <span m='1800906'>and</span>
  <span m='1802358'>that each--</span> </p><p><span m='1803330'>ERIK DEMAINE:</span>
  <span m='1803435'>This</span> <span m='1803540'>amortization?</span> </p><p><span
  m='1803880'>AUDIENCE:</span> <span m='1804050'>Yeah,</span> <span m='1805092'>how
  you got to</span> <span m='1805528'>the amortized.</span> </p><p><span m='1806400'>ERIK
  DEMAINE:</span> <span m='1806545'>Yeah.</span> <span m='1806690'>So</span> <span
  m='1806840'>let</span> <span m='1806930'>me</span> <span m='1807020'>explain</span>
  <span m='1807350'>again.</span> <span m='1807620'>So</span> <span m='1808190'>when</span>
  <span m='1808310'>we</span> <span m='1808430'>do</span> <span m='1808610'>rebalance</span>
  <span m='1809480'>of</span> <span m='1809750'>an</span> <span m='1809840'>interval,</span>
  <span m='1810710'>the</span> <span m='1810830'>cost</span> <span m='1811310'>is</span>
  <span m='1811490'>the</span> <span m='1811580'>size</span> <span m='1811910'>of</span>
  <span m='1811970'>the</span> <span m='1812030'>interval.</span> <span m='1812660'>We're</span>
  <span m='1812870'>trying</span> <span m='1813080'>to</span> <span m='1813170'>analyze,</span>
  <span m='1813590'>what</span> <span m='1813740'>is</span> <span m='1813830'>the</span>
  <span m='1813920'>size</span> <span m='1814170'>the</span> <span m='1814210'>interval?</span>
  <span m='1814520'>Prove that</span> <span m='1814750'>is</span> <span m='1814940'>log</span>
  <span m='1815210'>squared</span> <span m='1815510'>N.</span> <span m='1816050'>So</span>
  <span m='1816180'>we have</span> <span m='1816270'>this</span> <span m='1816440'>cost</span>
  <span m='1816960'>of</span> <span m='1817180'>size</span> <span m='1817550'>of</span>
  <span m='1817640'>interval.</span> <span m='1818420'>We're</span> <span m='1818540'>charging</span>
  <span m='1819110'>it</span> <span m='1819530'>to</span> <span m='1819770'>the</span>
  <span m='1819950'>items</span> <span m='1820580'>which</span> <span m='1820970'>just</span>
  <span m='1821390'>got</span> <span m='1822950'>inserted</span> <span m='1823430'>or</span>
  <span m='1823550'>deleted</span> <span m='1824000'>into</span> <span m='1824240'>that</span>
  <span m='1824420'>interval.</span> <span m='1825350'>Before</span> <span m='1826800'>this</span>
  <span m='1827030'>node</span> <span m='1827300'>rebalances</span> <span m='1828720'>again,</span>
  <span m='1829470'>but</span> <span m='1829610'>in</span> <span m='1829730'>general,</span>
  <span m='1830000'>we're</span> <span m='1830030'>interested</span> <span m='1830330'>in</span>
  <span m='1830450'>the--</span> <span m='1831950'>we</span> <span m='1832070'>can</span>
  <span m='1832220'>afford</span> <span m='1832490'>to</span> <span m='1832580'>rebalance</span>
  <span m='1833000'>every</span> <span m='1833210'>node</span> <span m='1833500'>at</span>
  <span m='1833570'>the</span> <span m='1833660'>beginning.</span> </p><p><span m='1834710'>And</span>
  <span m='1834860'>then</span> <span m='1835760'>whenever</span> <span m='1836410'>a</span>
  <span m='1836510'>node</span> <span m='1836810'>rebalances--</span> <span m='1838010'>before
  it</span> <span m='1838400'>rebalances,</span> <span m='1840320'>one</span> <span
  m='1840470'>of</span> <span m='1840560'>its</span> <span m='1840680'>children</span>
  <span m='1841040'>had</span> <span m='1841190'>to</span> <span m='1841250'>be</span>
  <span m='1841400'>out</span> <span m='1841550'>of</span> <span m='1841670'>whack.</span>
  <span m='1842390'>For</span> <span m='1843500'>one</span> <span m='1843680'>of</span>
  <span m='1843770'>its</span> <span m='1844040'>children</span> <span m='1844340'>to</span>
  <span m='1844460'>be</span> <span m='1844580'>out</span> <span m='1844700'>of</span>
  <span m='1844790'>whack,</span> <span m='1846380'>there</span> <span m='1846620'>had</span>
  <span m='1846800'>to</span> <span m='1846890'>have</span> <span m='1846980'>been</span>
  <span m='1847160'>an</span> <span m='1847250'>insertion</span> <span m='1847880'>of</span>
  <span m='1848090'>at</span> <span m='1848180'>least</span> <span m='1848780'>the</span>
  <span m='1848870'>size</span> <span m='1849230'>of</span> <span m='1849290'>the</span>
  <span m='1849410'>interval</span> <span m='1850640'>divided</span> <span m='1851060'>by</span>
  <span m='1851210'>log</span> <span m='1851630'>N,</span> <span m='1852740'>because</span>
  <span m='1852920'>log</span> <span m='1853340'>was</span> <span m='1853660'>h.</span>
  </p><p><span m='1854600'>There's</span> <span m='1854720'>a</span> <span m='1854780'>slight</span>
  <span m='1855110'>discrepancy,</span> <span m='1855680'>here.</span> <span m='1855890'>We're</span>
  <span m='1856010'>talking</span> <span m='1856250'>about</span> <span m='1856400'>the</span>
  <span m='1856460'>size</span> <span m='1856850'>of</span> <span m='1857000'>the</span>
  <span m='1857150'>parent</span> <span m='1857570'>interval</span> <span m='1857930'>versus</span>
  <span m='1858200'>the</span> <span m='1858320'>size</span> <span m='1858590'>of</span>
  <span m='1858650'>the</span> <span m='1858740'>child</span> <span m='1859150'>interval,</span>
  <span m='1859460'>but</span> <span m='1859550'>that's</span> <span m='1859730'>just</span>
  <span m='1859880'>a</span> <span m='1859940'>factor</span> <span m='1860240'>of</span>
  <span m='1860300'>2.</span> <span m='1861560'>So</span> <span m='1861730'>that's</span>
  <span m='1862220'>incorporated</span> <span m='1862790'>by</span> <span m='1862940'>this</span>
  <span m='1863180'>theta.</span> <span m='1864380'>So</span> <span m='1864590'>you</span>
  <span m='1864710'>could</span> <span m='1864860'>have</span> <span m='1865040'>a</span>
  <span m='1865070'>little</span> <span m='1865250'>theta</span> <span m='1865550'>here,</span>
  <span m='1865870'>too,</span> <span m='1866100'>if you</span> <span m='1866300'>like.</span>
  </p><p><span m='1867830'>OK,</span> <span m='1868160'>so</span> <span m='1868370'>for</span>
  <span m='1868490'>the</span> <span m='1868610'>child</span> <span m='1868910'>to</span>
  <span m='1868970'>be</span> <span m='1869090'>out</span> <span m='1869210'>of</span>
  <span m='1869270'>whack,</span> <span m='1869960'>we</span> <span m='1870080'>had</span>
  <span m='1870320'>to</span> <span m='1870410'>have</span> <span m='1870530'>done</span>
  <span m='1870830'>updates</span> <span m='1871300'>of</span> <span m='1871370'>size</span>
  <span m='1871700'>interval</span> <span m='1871970'>divided</span> <span m='1872270'>by</span>
  <span m='1872390'>log</span> <span m='1872540'>N.</span> <span m='1872870'>So we</span>
  <span m='1872990'>charge</span> <span m='1873290'>this</span> <span m='1873470'>cost</span>
  <span m='1874190'>to</span> <span m='1874340'>them.</span> <span m='1875610'>And</span>
  <span m='1875660'>so</span> <span m='1876020'>we</span> <span m='1876170'>have</span>
  <span m='1876290'>to</span> <span m='1876380'>charge</span> <span m='1876770'>log</span>
  <span m='1877070'>N</span> <span m='1877370'>to</span> <span m='1877490'>each</span>
  <span m='1877730'>of</span> <span m='1877820'>those</span> <span m='1878030'>items,</span>
  <span m='1878690'>each</span> <span m='1878870'>of</span> <span m='1878930'>those</span>
  <span m='1879140'>updates.</span> </p><p><span m='1880700'>And</span> <span m='1880820'>then</span>
  <span m='1880940'>there's</span> <span m='1881090'>a</span> <span m='1881160'>second</span>
  <span m='1881540'>problem,</span> <span m='1882060'>which</span> <span m='1882140'>is</span>
  <span m='1882380'>everybody</span> <span m='1884000'>gets</span> <span m='1884270'>charged</span>
  <span m='1884780'>by</span> <span m='1884960'>all</span> <span m='1885230'>of</span>
  <span m='1885350'>its</span> <span m='1885470'>ancestors.</span> <span m='1886190'>And</span>
  <span m='1886280'>it</span> <span m='1886340'>has</span> <span m='1886550'>log</span>
  <span m='1886820'>N</span> <span m='1887090'>ancestors.</span> <span m='1888930'>So</span>
  <span m='1889520'>in</span> <span m='1889670'>all,</span> <span m='1890180'>each</span>
  <span m='1890450'>update</span> <span m='1890810'>gets</span> <span m='1891020'>charged</span>
  <span m='1891380'>at</span> <span m='1891440'>most</span> <span m='1891680'>log</span>
  <span m='1891980'>squared</span> <span m='1892220'>N</span> <span m='1892380'>times.</span>
  <span m='1893170'>So</span> <span m='1893360'>you</span> <span m='1893450'>get</span>
  <span m='1893630'>amortized</span> <span m='1894150'>log</span> <span m='1894390'>squared</span>
  <span m='1895550'>per</span> <span m='1895760'>update.</span> </p><p><span m='1901400'>Other</span>
  <span m='1901550'>questions?</span> </p><p><span m='1904710'>Cool.</span> <span
  m='1905310'>So</span> <span m='1905460'>that's</span> <span m='1905670'>ordered</span>
  <span m='1905850'>files.</span> <span m='1906480'>Now</span> <span m='1906660'>we</span>
  <span m='1906780'>have</span> <span m='1906990'>b-trees.</span> <span m='1908620'>We</span>
  <span m='1909360'>can</span> <span m='1909510'>handle</span> <span m='1909840'>this</span>
  <span m='1910020'>log</span> <span m='1910290'>squared</span> <span m='1910620'>N.</span>
  <span m='1910800'>That</span> <span m='1910920'>was</span> <span m='1911100'>OK</span>
  <span m='1912530'>for</span> <span m='1912660'>B trees,</span> <span m='1913230'>using</span>
  <span m='1913560'>a</span> <span m='1913620'>layer</span> <span m='1913830'>of</span>
  <span m='1913890'>indirection.</span> <span m='1914910'>But</span> <span m='1915180'>it's</span>
  <span m='1915360'>natural</span> <span m='1915690'>to</span> <span m='1915780'>wonder</span>
  <span m='1916110'>whether</span> <span m='1916380'>you</span> <span m='1916560'>can</span>
  <span m='1916710'>do</span> <span m='1916830'>better.</span> <span m='1919470'>In</span>
  <span m='1919620'>general,</span> <span m='1920010'>the</span> <span m='1920130'>conjecture</span>
  <span m='1920670'>is</span> <span m='1920820'>that</span> <span m='1920970'>for</span>
  <span m='1921150'>ordered</span> <span m='1921480'>files,</span> <span m='1921990'>you</span>
  <span m='1922140'>cannot</span> <span m='1922530'>do</span> <span m='1922650'>better.</span>
  <span m='1923220'>If</span> <span m='1923370'>this</span> <span m='1923580'>is</span>
  <span m='1923700'>your</span> <span m='1923820'>problem</span> <span m='1924270'>setup,</span>
  <span m='1925045'>if</span> <span m='1925330'>you</span> <span m='1925440'>can</span>
  <span m='1925560'>only</span> <span m='1925740'>have</span> <span m='1925890'>constant</span>
  <span m='1926280'>sized</span> <span m='1926520'>gaps,</span> <span m='1926940'>you</span>
  <span m='1927000'>need</span> <span m='1927180'>a</span> <span m='1927210'>linear</span>
  <span m='1927600'>size</span> <span m='1927900'>array.</span> <span m='1928920'>You</span>
  <span m='1929040'>need</span> <span m='1929430'>log</span> <span m='1929760'>squared</span>
  <span m='1930000'>N</span> <span m='1930240'>interval</span> <span m='1930700'>updates,</span>
  <span m='1931110'>but</span> <span m='1931230'>no</span> <span m='1931350'>one's</span>
  <span m='1931530'>proved</span> <span m='1931890'>that</span> <span m='1932160'>lower</span>
  <span m='1932400'>bound.</span> <span m='1933320'>So</span> <span m='1933360'>that's</span>
  <span m='1933580'>one</span> <span m='1933750'>open</span> <span m='1934020'>question.</span>
  </p><p><span m='1935670'>Another</span> <span m='1936150'>fun</span> <span m='1936450'>fact</span>
  <span m='1936870'>is</span> <span m='1937170'>we</span> <span m='1937290'>did</span>
  <span m='1937470'>amortized,</span> <span m='1939000'>but</span> <span m='1939150'>it's</span>
  <span m='1939270'>actually</span> <span m='1939570'>possible</span> <span m='1939960'>to</span>
  <span m='1940050'>do</span> <span m='1940230'>worst</span> <span m='1940500'>case.</span>
  <span m='1943080'>It's</span> <span m='1943260'>complicated.</span> <span m='1944250'>Willard</span>
  <span m='1944580'>did</span> <span m='1944790'>it</span> <span m='1944910'>in</span>
  <span m='1945090'>1992.</span> </p><p><span m='1951690'>But</span> <span m='1952460'>let's</span>
  <span m='1952640'>talk</span> <span m='1952850'>about</span> <span m='1953030'>relaxing</span>
  <span m='1953660'>the</span> <span m='1953750'>problem.</span> <span m='1954330'>So</span>
  <span m='1954500'>instead</span> <span m='1954830'>of</span> <span m='1954920'>saying,</span>
  <span m='1955250'>well,</span> <span m='1955370'>the</span> <span m='1955480'>array</span>
  <span m='1955730'>has</span> <span m='1956120'>to</span> <span m='1956210'>be</span>
  <span m='1956330'>linear</span> <span m='1956690'>size,</span> <span m='1957230'>what</span>
  <span m='1957410'>if</span> <span m='1957530'>we</span> <span m='1957620'>let</span>
  <span m='1957830'>it</span> <span m='1957920'>to</span> <span m='1958070'>be</span>
  <span m='1958190'>bigger?</span> <span m='1959090'>And</span> <span m='1959570'>then</span>
  <span m='1959840'>you</span> <span m='1959960'>can</span> <span m='1960080'>do</span>
  <span m='1960170'>better.</span> <span m='1964890'>And</span> <span m='1964910'>this</span>
  <span m='1965120'>is</span> <span m='1965240'>a</span> <span m='1965270'>problem</span>
  <span m='1966740'>called</span> <span m='1967110'>list</span> <span m='1967470'>labeling.</span>
  </p><p><span m='1973740'>So</span> <span m='1974450'>I'm</span> <span m='1974710'>going</span>
  <span m='1974830'>to</span> <span m='1975080'>rephrase</span> <span m='1975710'>it,</span>
  <span m='1976640'>but</span> <span m='1976760'>it's</span> <span m='1976860'>essentially</span>
  <span m='1977300'>the</span> <span m='1977390'>same</span> <span m='1977870'>as</span>
  <span m='1978140'>order</span> <span m='1978350'>file</span> <span m='1978590'>maintenance.</span>
  <span m='1979550'>It's</span> <span m='1979910'>a</span> <span m='1979940'>little</span>
  <span m='1980300'>bit</span> <span m='1983390'>less</span> <span m='1983780'>restriction.</span>
  </p><p><span m='2014310'>So</span> <span m='2014550'>it's</span> <span m='2014700'>a</span>
  <span m='2014820'>dynamic</span> <span m='2015330'>linked</span> <span m='2015570'>list</span>
  <span m='2015750'>problem,</span> <span m='2016170'>like</span> <span m='2016380'>we've</span>
  <span m='2016470'>seen</span> <span m='2016650'>before.</span> <span m='2017580'>And</span>
  <span m='2018330'>each</span> <span m='2018570'>node</span> <span m='2019620'>at</span>
  <span m='2019770'>all</span> <span m='2019980'>times</span> <span m='2020820'>stores</span>
  <span m='2021960'>a</span> <span m='2022050'>label</span> <span m='2028160'>such</span>
  <span m='2028580'>that</span> <span m='2032510'>labels</span> <span m='2033170'>are</span>
  <span m='2033470'>always</span> <span m='2036380'>monotone</span> <span m='2038480'>down</span>
  <span m='2038720'>the</span> <span m='2038810'>list.</span> </p><p><span m='2042650'>So</span>
  <span m='2043130'>think</span> <span m='2043370'>of</span> <span m='2043460'>it</span>
  <span m='2043610'>this</span> <span m='2043790'>way.</span> <span m='2044130'>We</span>
  <span m='2044150'>have</span> <span m='2045210'>a</span> <span m='2045590'>linked</span>
  <span m='2045800'>list.</span> <span m='2051499'>And</span> <span m='2051969'>all</span>
  <span m='2052100'>we're</span> <span m='2052219'>interested</span> <span m='2052550'>is</span>
  <span m='2052699'>maintaining</span> <span m='2053150'>this</span> <span m='2053300'>linked</span>
  <span m='2053510'>list.</span> <span m='2053730'>So</span> <span m='2053870'>we</span>
  <span m='2053989'>want</span> <span m='2054170'>to</span> <span m='2054230'>be</span>
  <span m='2054350'>able</span> <span m='2054469'>to</span> <span m='2054560'>say,</span>
  <span m='2054840'>OK,</span> <span m='2055010'>delete</span> <span m='2055429'>this</span>
  <span m='2055639'>item</span> <span m='2056780'>and</span> <span m='2056960'>update</span>
  <span m='2057320'>these</span> <span m='2057500'>pointers.</span> <span m='2059030'>Or</span>
  <span m='2059239'>maybe,</span> <span m='2059750'>insert</span> <span m='2060860'>a</span>
  <span m='2060920'>new</span> <span m='2061370'>item</span> <span m='2061730'>over</span>
  <span m='2061969'>here.</span> <span m='2063290'>And</span> <span m='2063409'>so</span>
  <span m='2063620'>it's</span> <span m='2063770'>going</span> <span m='2063889'>to</span>
  <span m='2063980'>be</span> <span m='2064100'>linked</span> <span m='2064370'>like</span>
  <span m='2064550'>that.</span> <span m='2065330'>And</span> <span m='2065810'>at</span>
  <span m='2066020'>all</span> <span m='2066230'>times</span> <span m='2066770'>in</span>
  <span m='2066949'>this</span> <span m='2067159'>cell</span> <span m='2067540'>here,</span>
  <span m='2068270'>we're</span> <span m='2068389'>storing</span> <span m='2068780'>a</span>
  <span m='2068810'>number,</span> <span m='2069350'>3,</span> <span m='2070282'>7,</span>
  <span m='2071680'>12,</span> <span m='2073670'>14,</span> <span m='2074370'>42,</span>
  <span m='2074929'>whatever.</span> <span m='2075274'>It</span> <span m='2075620'>could</span>
  <span m='2075739'>be</span> <span m='2075920'>any</span> <span m='2076219'>integer,</span>
  <span m='2076670'>let's</span> <span m='2076820'>say.</span> <span m='2078739'>And</span>
  <span m='2078889'>we</span> <span m='2079010'>need</span> <span m='2079219'>that</span>
  <span m='2079370'>the</span> <span m='2079460'>numbers</span> <span m='2079850'>are</span>
  <span m='2080030'>increasing</span> <span m='2080570'>order</span> <span m='2080790'>down</span>
  <span m='2080989'>the</span> <span m='2081050'>linked</span> <span m='2081260'>list.</span>
  </p><p><span m='2083239'>Now,</span> <span m='2083690'>I</span> <span m='2083790'>claim</span>
  <span m='2083989'>this</span> <span m='2084170'>is</span> <span m='2084260'>basically</span>
  <span m='2084650'>the</span> <span m='2084770'>same</span> <span m='2085790'>as
  an</span> <span m='2086030'>ordered</span> <span m='2086330'>file</span> <span m='2087000'>problem.</span>
  <span m='2088130'>Just</span> <span m='2088280'>think</span> <span m='2088460'>of</span>
  <span m='2088520'>this</span> <span m='2088670'>number</span> <span m='2089090'>as</span>
  <span m='2089210'>being</span> <span m='2089510'>the</span> <span m='2089659'>index</span>
  <span m='2090110'>in</span> <span m='2090199'>the</span> <span m='2090320'>array</span>
  <span m='2090620'>that</span> <span m='2090739'>you</span> <span m='2090830'>store</span>
  <span m='2091100'>it.</span> <span m='2092250'>So</span> <span m='2092270'>this</span>
  <span m='2092420'>should</span> <span m='2092570'>be</span> <span m='2093020'>strictly</span>
  <span m='2093530'>monotone--</span> <span m='2097280'>I</span> <span m='2097370'>guess,</span>
  <span m='2097610'>increasing</span> <span m='2100500'>down</span> <span m='2100870'>the</span>
  <span m='2100970'>list.</span> <span m='2103670'>That</span> <span m='2103820'>means</span>
  <span m='2104450'>none</span> <span m='2104630'>of</span> <span m='2104720'>these</span>
  <span m='2104870'>numbers</span> <span m='2105170'>are</span> <span m='2105230'>the</span>
  <span m='2105350'>same.</span> <span m='2105650'>So</span> <span m='2105800'>we</span>
  <span m='2105890'>can</span> <span m='2106040'>store</span> <span m='2106790'>the</span>
  <span m='2107090'>items--</span> <span m='2108350'>whatever</span> <span m='2108740'>data</span>
  <span m='2109160'>is</span> <span m='2109310'>associated</span> <span m='2109880'>with</span>
  <span m='2110030'>this</span> <span m='2110210'>node--</span> <span m='2110930'>we</span>
  <span m='2111020'>can</span> <span m='2111140'>store</span> <span m='2111380'>that</span>
  <span m='2112250'>in</span> <span m='2112520'>the</span> <span m='2112760'>array</span>
  <span m='2113030'>position</span> <span m='2113420'>3,</span> <span m='2113720'>in</span>
  <span m='2113870'>the</span> <span m='2113990'>array</span> <span m='2114200'>position</span>
  <span m='2114590'>7,</span> <span m='2114950'>in</span> <span m='2115040'>the</span>
  <span m='2115160'>array</span> <span m='2115310'>position</span> <span m='2115670'>12.</span>
  <span m='2116690'>When</span> <span m='2116840'>we</span> <span m='2116990'>insert,</span>
  <span m='2117560'>we</span> <span m='2117680'>have</span> <span m='2117860'>to</span>
  <span m='2117950'>find</span> <span m='2119060'>a</span> <span m='2119630'>new</span>
  <span m='2119840'>label</span> <span m='2120260'>between</span> <span m='2120800'>3</span>
  <span m='2121010'>and</span> <span m='2121130'>7.</span> </p><p><span m='2122370'>Now</span>
  <span m='2122390'>we're</span> <span m='2122510'>allowed</span> <span m='2122690'>to</span>
  <span m='2122750'>change</span> <span m='2123080'>the</span> <span m='2123170'>labels</span>
  <span m='2123710'>dynamically--</span> <span m='2124280'>that's</span> <span m='2124470'>what</span>
  <span m='2124550'>makes</span> <span m='2124760'>this</span> <span m='2124880'>possible--</span>
  <span m='2125690'>which</span> <span m='2125870'>corresponds</span> <span m='2126290'>to</span>
  <span m='2126410'>moving</span> <span m='2126860'>items</span> <span m='2127220'>in</span>
  <span m='2127310'>the</span> <span m='2127460'>array.</span> <span m='2129410'>And</span>
  <span m='2129530'>the</span> <span m='2129650'>only</span> <span m='2129950'>difference</span>
  <span m='2130610'>is</span> <span m='2131600'>about</span> <span m='2131840'>how</span>
  <span m='2132080'>this</span> <span m='2132290'>is</span> <span m='2132410'>physically</span>
  <span m='2132920'>done.</span> <span m='2134420'>With</span> <span m='2134660'>ordered</span>
  <span m='2134930'>file,</span> <span m='2135350'>you</span> <span m='2135470'>have</span>
  <span m='2135590'>to</span> <span m='2135680'>physically</span> <span m='2136220'>move</span>
  <span m='2136490'>items</span> <span m='2137150'>in</span> <span m='2137270'>the</span>
  <span m='2137420'>array.</span> <span m='2137900'>Here,</span> <span m='2138580'>you</span>
  <span m='2138680'>just</span> <span m='2138830'>change</span> <span m='2139220'>a</span>
  <span m='2139280'>number</span> <span m='2139790'>and</span> <span m='2139880'>that's</span>
  <span m='2140240'>moving</span> <span m='2140600'>the</span> <span m='2140690'>item.</span>
  </p><p><span m='2143030'>Where</span> <span m='2143210'>this</span> <span m='2143360'>gets</span>
  <span m='2143570'>interesting</span> <span m='2144050'>is</span> <span m='2144170'>if</span>
  <span m='2144320'>you</span> <span m='2144440'>allow</span> <span m='2144890'>the</span>
  <span m='2145130'>label</span> <span m='2145670'>space--</span> <span m='2146210'>which</span>
  <span m='2146450'>is</span> <span m='2146750'>the</span> <span m='2146960'>storage</span>
  <span m='2147560'>space</span> <span m='2147890'>of</span> <span m='2147980'>the</span>
  <span m='2148130'>array--</span> <span m='2148850'>to</span> <span m='2148940'>become</span>
  <span m='2149240'>super</span> <span m='2149630'>linear.</span> <span m='2150770'>With</span>
  <span m='2150920'>ordered</span> <span m='2151130'>files,</span> <span m='2152420'>it</span>
  <span m='2152510'>doesn't</span> <span m='2152720'>really</span> <span m='2152900'>make</span>
  <span m='2153110'>a</span> <span m='2153170'>lot</span> <span m='2153290'>of</span>
  <span m='2153350'>sense</span> <span m='2153650'>to</span> <span m='2153770'>go</span>
  <span m='2153920'>super</span> <span m='2154320'>linear,</span> <span m='2154640'>at</span>
  <span m='2154700'>least,</span> <span m='2154880'>not</span> <span m='2155090'>by</span>
  <span m='2155270'>more</span> <span m='2155510'>than</span> <span m='2155690'>a</span>
  <span m='2155930'>couple</span> <span m='2156240'>log</span> <span m='2156530'>factors</span>
  <span m='2157760'>because</span> <span m='2158810'>time</span> <span m='2159170'>is</span>
  <span m='2159260'>always</span> <span m='2159470'>at</span> <span m='2159530'>least</span>
  <span m='2159710'>space.</span> <span m='2160340'>If</span> <span m='2160430'>you</span>
  <span m='2160550'>have</span> <span m='2160790'>a</span> <span m='2160850'>giant</span>
  <span m='2161330'>array,</span> <span m='2161660'>you</span> <span m='2161720'>have</span>
  <span m='2161870'>to</span> <span m='2161960'>initialize</span> <span m='2162530'>it.</span>
  <span m='2163130'>And</span> <span m='2163280'>you</span> <span m='2163370'>can't</span>
  <span m='2163580'>afford</span> <span m='2163880'>to</span> <span m='2163970'>initialize</span>
  <span m='2164465'>an array of,</span> <span m='2164960'>say,</span> <span m='2165380'>N</span>
  <span m='2165560'>squared</span> <span m='2166070'>size,</span> <span m='2166580'>if</span>
  <span m='2166960'>you're</span> <span m='2167080'>trying</span> <span m='2167330'>to</span>
  <span m='2167420'>maintain</span> <span m='2167810'>N</span> <span m='2168000'>items.</span>
  </p><p><span m='2168960'>But</span> <span m='2169110'>in</span> <span m='2169230'>list
  labeling,</span> <span m='2169850'>you</span> <span m='2169970'>can.</span> <span
  m='2170420'>I</span> <span m='2170480'>mean,</span> <span m='2171290'>if</span>
  <span m='2171500'>you</span> <span m='2171620'>say</span> <span m='2171890'>all</span>
  <span m='2172370'>these</span> <span m='2172580'>numbers</span> <span m='2173510'>are</span>
  <span m='2173630'>between</span> <span m='2173930'>0</span> <span m='2174190'>and</span>
  <span m='2174290'>N</span> <span m='2174380'>squared,</span> <span m='2175220'>that's</span>
  <span m='2175430'>no</span> <span m='2175550'>big</span> <span m='2175730'>deal</span>
  <span m='2177020'>because</span> <span m='2177380'>you</span> <span m='2177500'>can</span>
  <span m='2177620'>represent</span> <span m='2178280'>a</span> <span m='2178340'>number</span>
  <span m='2179420'>up to</span> <span m='2179840'>N</span> <span m='2180020'>squared,</span>
  <span m='2180310'>which</span> <span m='2180470'>is</span> <span m='2180860'>two</span>
  <span m='2181100'>log</span> <span m='2181370'>N</span> <span m='2181490'>bits.</span>
  <span m='2182400'>So</span> <span m='2182660'>squaring</span> <span m='2183230'>the</span>
  <span m='2183350'>space</span> <span m='2184150'>is</span> <span m='2184280'>no</span>
  <span m='2184430'>big</span> <span m='2184550'>deal</span> <span m='2184730'>for</span>
  <span m='2184900'>list</span> <span m='2185090'>labeling.</span> <span m='2185510'>It</span>
  <span m='2185600'>would</span> <span m='2185780'>be</span> <span m='2185870'>a</span>
  <span m='2185930'>big</span> <span m='2186110'>deal</span> <span m='2186350'>for</span>
  <span m='2186440'>order</span> <span m='2186680'>file</span> <span m='2186890'>maintenance,</span>
  <span m='2187290'>so</span> <span m='2187460'>that's</span> <span m='2187610'>why</span>
  <span m='2187760'>we</span> <span m='2187880'>rephrase.</span> <span m='2188600'>But</span>
  <span m='2188780'>they're</span> <span m='2188930'>basically</span> <span m='2189440'>the</span>
  <span m='2189560'>same</span> <span m='2189800'>problem--</span> <span m='2191840'>just</span>
  <span m='2192020'>a</span> <span m='2192080'>little</span> <span m='2192290'>less</span>
  <span m='2192500'>useful</span> <span m='2192920'>for</span> <span m='2194120'>cache-oblivious</span>
  <span m='2194810'>stuff.</span> </p><p><span m='2202740'>Let</span> <span m='2202830'>me</span>
  <span m='2202950'>tell</span> <span m='2203160'>you</span> <span m='2203340'>what's</span>
  <span m='2203520'>known</span> <span m='2203730'>about</span> <span m='2204020'>mislabelling.</span>
  <span m='2216825'>In</span> <span m='2217330'>terms</span> <span m='2217630'>of</span>
  <span m='2217780'>the</span> <span m='2217870'>amount</span> <span m='2218200'>of</span>
  <span m='2219280'>label</span> <span m='2219610'>space</span> <span m='2219970'>you're</span>
  <span m='2220090'>given,</span> <span m='2231220'>and</span> <span m='2231520'>how</span>
  <span m='2231790'>good</span> <span m='2232000'>a</span> <span m='2232750'>running</span>
  <span m='2233020'>time</span> <span m='2233230'>per</span> <span m='2233350'>update</span>
  <span m='2233810'>we</span> <span m='2233830'>can</span> <span m='2233950'>get,</span>
  <span m='2234960'>in</span> <span m='2235030'>terms</span> <span m='2235300'>of</span>
  <span m='2235390'>best</span> <span m='2235630'>known</span> <span m='2235810'>results.</span>
  </p><p><span m='2237460'>So</span> <span m='2237640'>what</span> <span m='2237790'>we</span>
  <span m='2237910'>just</span> <span m='2238090'>saw</span> <span m='2239170'>is</span>
  <span m='2239350'>that</span> <span m='2239440'>if</span> <span m='2239590'>you</span>
  <span m='2239710'>do--</span> <span m='2241390'>we</span> <span m='2241510'>just</span>
  <span m='2241660'>said</span> <span m='2241870'>linear</span> <span m='2242290'>space.</span>
  <span m='2242810'>But</span> <span m='2242910'>in</span> <span m='2243010'>fact,</span>
  <span m='2243230'>you</span> <span m='2243330'>can</span> <span m='2243430'>get</span>
  <span m='2243460'>1</span> <span m='2243670'>plus</span> <span m='2243880'>epsilon</span>
  <span m='2244330'>space.</span> <span m='2244720'>You</span> <span m='2244810'>can</span>
  <span m='2244960'>say,</span> <span m='2245470'>oh,</span> <span m='2245770'>I</span>
  <span m='2245930'>wouldn't</span> <span m='2246130'>want</span> <span m='2246250'>to</span>
  <span m='2246340'>waste</span> <span m='2246670'>1%</span> <span m='2247300'>of</span>
  <span m='2247390'>my</span> <span m='2247540'>storage</span> <span m='2248020'>space</span>
  <span m='2248380'>in</span> <span m='2248470'>the</span> <span m='2248590'>array.</span>
  <span m='2249560'>And</span> <span m='2249640'>if</span> <span m='2249730'>you</span>
  <span m='2249820'>set</span> <span m='2251350'>the theta</span> <span m='2251695'>at
  the</span> <span m='2252040'>leaves,</span> <span m='2252370'>here,</span> <span
  m='2252790'>to</span> <span m='2252910'>the</span> <span m='2253000'>right</span>
  <span m='2253210'>value,</span> <span m='2254140'>then</span> <span m='2254380'>you</span>
  <span m='2254530'>can</span> <span m='2255130'>just</span> <span m='2255370'>waste</span>
  <span m='2255610'>1%</span> <span m='2256810'>and</span> <span m='2256960'>still</span>
  <span m='2257140'>maintain</span> <span m='2257490'>an</span> <span m='2257560'>ordered</span>
  <span m='2257800'>file.</span> <span m='2258070'>I</span> <span m='2258130'>think</span>
  <span m='2258280'>this</span> <span m='2258430'>is</span> <span m='2258520'>cool</span>
  <span m='2258870'>from</span> <span m='2259120'>a</span> <span m='2259180'>file</span>
  <span m='2259450'>system</span> <span m='2259750'>perspective.</span> <span m='2260910'>But</span>
  <span m='2261040'>in</span> <span m='2261100'>particular,</span> <span m='2261550'>it</span>
  <span m='2261610'>gives</span> <span m='2261850'>us</span> <span m='2262840'>what</span>
  <span m='2262990'>we</span> <span m='2263110'>need.</span> </p><p><span m='2264790'>And</span>
  <span m='2265000'>if</span> <span m='2265150'>you</span> <span m='2265240'>go</span>
  <span m='2265480'>up</span> <span m='2265660'>to</span> <span m='2266170'>N</span>
  <span m='2266590'>log</span> <span m='2267010'>N</span> <span m='2267130'>space,</span>
  <span m='2267940'>it</span> <span m='2268270'>doesn't</span> <span m='2268540'>seem</span>
  <span m='2268750'>to</span> <span m='2268810'>help</span> <span m='2269020'>you</span>
  <span m='2269140'>much.</span> <span m='2270490'>The</span> <span m='2270970'>best</span>
  <span m='2271270'>we</span> <span m='2271360'>know</span> <span m='2271630'>is</span>
  <span m='2271870'>log</span> <span m='2272130'>squared</span> <span m='2272450'>N.</span>
  <span m='2273370'>As</span> <span m='2273720'>I</span> <span m='2273850'>mentioned,
  it</span> <span m='2274180'>could</span> <span m='2274330'>be</span> <span m='2274480'>amortized</span>
  <span m='2275110'>or</span> <span m='2276220'>worst</span> <span m='2276430'>case.</span>
  </p><p><span m='2278830'>If</span> <span m='2279040'>you</span> <span m='2279190'>bump</span>
  <span m='2279460'>up</span> <span m='2279580'>the</span> <span m='2279670'>space</span>
  <span m='2280030'>to</span> <span m='2280210'>N to</span> <span m='2280510'>the</span>
  <span m='2280630'>1</span> <span m='2280810'>plus</span> <span m='2281050'>epsilon--</span>
  <span m='2281520'>so a</span> <span m='2281640'>little</span> <span m='2281950'>bit</span>
  <span m='2282130'>super</span> <span m='2282460'>linear--</span> <span m='2284056'>and</span>
  <span m='2284440'>anything</span> <span m='2285130'>polynomial,</span> <span m='2286820'>then</span>
  <span m='2286990'>the</span> <span m='2287080'>best</span> <span m='2287380'>we</span>
  <span m='2287500'>know</span> <span m='2288610'>is</span> <span m='2289010'>log</span>
  <span m='2289490'>N.</span> <span m='2290220'>And</span> <span m='2290410'>there</span>
  <span m='2290520'>is</span> <span m='2290680'>actually</span> <span m='2290980'>a</span>
  <span m='2291010'>lower</span> <span m='2291310'>bound</span> <span m='2291580'>for</span>
  <span m='2291730'>this</span> <span m='2291910'>result</span> <span m='2292630'>in</span>
  <span m='2292810'>a</span> <span m='2292870'>particular</span> <span m='2293380'>model.</span>
  <span m='2295130'>So</span> <span m='2295880'>it</span> <span m='2296110'>seems</span>
  <span m='2296470'>pretty</span> <span m='2296860'>clear</span> <span m='2297340'>that--</span>
  <span m='2298960'>at</span> <span m='2299050'>least</span> <span m='2299260'>for</span>
  <span m='2299440'>these</span> <span m='2299830'>style</span> <span m='2300400'>of</span>
  <span m='2300730'>data</span> <span m='2301000'>structures,</span> <span m='2301630'>the</span>
  <span m='2302080'>best</span> <span m='2302350'>you</span> <span m='2302470'>can</span>
  <span m='2302650'>do</span> <span m='2302920'>in</span> <span m='2303070'>this</span>
  <span m='2303190'>situation</span> <span m='2303670'>is</span> <span m='2303760'>log
  N.</span> <span m='2304150'>But</span> <span m='2304240'>hey,</span> <span m='2304480'>log
  N</span> <span m='2304765'>is</span> <span m='2305050'>better</span> <span m='2305290'>than</span>
  <span m='2305440'>log</span> <span m='2305630'>squared.</span> </p><p><span m='2307370'>And</span>
  <span m='2307510'>the</span> <span m='2307600'>other</span> <span m='2307810'>obvious</span>
  <span m='2308080'>bound</span> <span m='2308320'>is</span> <span m='2308470'>if</span>
  <span m='2308590'>you</span> <span m='2308680'>have</span> <span m='2308830'>exponential</span>
  <span m='2309460'>space,</span> <span m='2311050'>you</span> <span m='2311200'>can</span>
  <span m='2311380'>do</span> <span m='2311560'>constant,</span> <span m='2313660'>essentially.</span>
  <span m='2314170'>Because</span> <span m='2314530'>with</span> <span m='2314680'>exponential</span>
  <span m='2315160'>space,</span> <span m='2315460'>you</span> <span m='2315580'>can</span>
  <span m='2315700'>just</span> <span m='2315850'>keep</span> <span m='2316090'>bisecting</span>
  <span m='2316690'>the</span> <span m='2316810'>interval</span> <span m='2317110'>between</span>
  <span m='2317440'>two</span> <span m='2317620'>items</span> <span m='2318580'>in</span>
  <span m='2318730'>constant</span> <span m='2319090'>time</span> <span m='2319630'>until</span>
  <span m='2320470'>you've</span> <span m='2320600'>inserted</span> <span m='2321010'>N</span>
  <span m='2321190'>items.</span> <span m='2321620'>And</span> <span m='2321720'>then</span>
  <span m='2321730'>you</span> <span m='2321820'>can</span> <span m='2321940'>rebuild</span>
  <span m='2322270'>the</span> <span m='2322330'>whole</span> <span m='2322450'>data</span>
  <span m='2322660'>structure.</span> <span m='2323570'>So</span> <span m='2324430'>that's</span>
  <span m='2324610'>sort</span> <span m='2324760'>of</span> <span m='2324820'>the</span>
  <span m='2324910'>trivial</span> <span m='2325330'>result.</span> </p><p><span m='2326560'>If</span>
  <span m='2326650'>you</span> <span m='2326710'>don't</span> <span m='2326920'>care</span>
  <span m='2327160'>about</span> <span m='2327370'>how</span> <span m='2327880'>big</span>
  <span m='2328150'>these</span> <span m='2328330'>labels</span> <span m='2328660'>get--</span>
  <span m='2329590'>and</span> <span m='2330040'>how</span> <span m='2330250'>big</span>
  <span m='2330600'>they</span> <span m='2330750'>would</span> <span m='2330880'>get</span>
  <span m='2331060'>is</span> <span m='2331300'>2</span> <span m='2331440'>to</span>
  <span m='2331530'>the</span> <span m='2331700'>N--</span> <span m='2332290'>then</span>
  <span m='2332440'>you</span> <span m='2332560'>can</span> <span m='2332650'>do</span>
  <span m='2332770'>constant</span> <span m='2333150'>time.</span> <span m='2333400'>That's</span>
  <span m='2333580'>really</span> <span m='2333790'>the</span> <span m='2333910'>only</span>
  <span m='2334180'>way</span> <span m='2334360'>we</span> <span m='2334480'>know</span>
  <span m='2334600'>how</span> <span m='2334660'>to</span> <span m='2334750'>do</span>
  <span m='2335240'>constant.</span> <span m='2338650'>So</span> <span m='2338830'>the</span>
  <span m='2338950'>interesting</span> <span m='2339430'>new</span> <span m='2339580'>result,</span>
  <span m='2340320'>here,</span> <span m='2340480'>that</span> <span m='2340600'>I'm</span>
  <span m='2340690'>talking</span> <span m='2341020'>about</span> <span m='2341650'>is</span>
  <span m='2341800'>for</span> <span m='2341920'>polynomial</span> <span m='2342520'>space,</span>
  <span m='2343360'>we</span> <span m='2343450'>can</span> <span m='2343540'>get</span>
  <span m='2343720'>log N.</span> </p><p><span m='2345370'>And</span> <span m='2345610'>rough</span>
  <span m='2345850'>idea is</span> <span m='2346300'>you</span> <span m='2346390'>just</span>
  <span m='2347050'>fixed</span> <span m='2347350'>these</span> <span m='2347560'>density</span>
  <span m='2347980'>intervals.</span> <span m='2349260'>Now</span> <span m='2350350'>you</span>
  <span m='2350440'>don't</span> <span m='2350620'>have</span> <span m='2350950'>to</span>
  <span m='2351070'>make</span> <span m='2351340'>it--</span> <span m='2352480'>I</span>
  <span m='2352540'>mean,</span> <span m='2352640'>you're</span> <span m='2352730'>still</span>
  <span m='2352990'>going</span> <span m='2353080'>to</span> <span m='2353170'>be</span>
  <span m='2353290'>divided</span> <span m='2353980'>by</span> <span m='2354640'>h,</span>
  <span m='2354910'>here,</span> <span m='2355090'>but</span> <span m='2355240'>your</span>
  <span m='2355720'>spread</span> <span m='2356110'>can</span> <span m='2356290'>be</span>
  <span m='2356410'>much</span> <span m='2356620'>bigger.</span> <span m='2357530'>So</span>
  <span m='2357610'>your</span> <span m='2357730'>densities</span> <span m='2358240'>no</span>
  <span m='2358420'>longer</span> <span m='2358660'>have</span> <span m='2358840'>to</span>
  <span m='2358930'>be</span> <span m='2359020'>constants.</span> <span m='2359680'>Now</span>
  <span m='2359890'>we</span> <span m='2360010'>can</span> <span m='2360130'>afford</span>
  <span m='2360430'>a</span> <span m='2360490'>density--</span> <span m='2361720'>near</span>
  <span m='2361930'>the</span> <span m='2362050'>root,</span> <span m='2362270'>we</span>
  <span m='2362380'>can</span> <span m='2362500'>get</span> <span m='2363160'>a</span>
  <span m='2363250'>density</span> <span m='2363760'>of</span> <span m='2363940'>like</span>
  <span m='2364210'>1</span> <span m='2364480'>over--</span> <span m='2365050'>actually,</span>
  <span m='2365650'>anywhere,</span> <span m='2366370'>we</span> <span m='2366460'>can</span>
  <span m='2366580'>afford</span> <span m='2366820'>a</span> <span m='2366880'>density</span>
  <span m='2367330'>of</span> <span m='2367480'>1</span> <span m='2367660'>over</span>
  <span m='2367870'>N.</span> <span m='2369070'>Because</span> <span m='2369280'>if</span>
  <span m='2369400'>we</span> <span m='2369520'>have</span> <span m='2369760'>N</span>
  <span m='2369970'>squared</span> <span m='2370300'>slots</span> <span m='2371170'>and</span>
  <span m='2371290'>only N</span> <span m='2371710'>items</span> <span m='2371980'>to</span>
  <span m='2372070'>put</span> <span m='2372250'>in</span> <span m='2372340'>them,</span>
  <span m='2373000'>then</span> <span m='2373180'>a</span> <span m='2373240'>decent</span>
  <span m='2373720'>density</span> <span m='2374170'>is</span> <span m='2374260'>1</span>
  <span m='2374440'>over</span> <span m='2374540'>N,</span> <span m='2374830'>in</span>
  <span m='2374950'>fact.</span> </p><p><span m='2375810'>It</span> <span m='2376030'>could</span>
  <span m='2376120'>also</span> <span m='2376390'>be</span> <span m='2376510'>constant.</span>
  <span m='2377340'>Constant</span> <span m='2377620'>would</span> <span m='2377770'>be</span>
  <span m='2378430'>all</span> <span m='2378580'>right.</span> <span m='2379330'>So</span>
  <span m='2379540'>we've</span> <span m='2379660'>got</span> <span m='2379810'>a</span>
  <span m='2379870'>big</span> <span m='2380050'>spread</span> <span m='2380350'>there,</span>
  <span m='2380560'>from</span> <span m='2380770'>1</span> <span m='2380890'>over</span>
  <span m='2381100'>N</span> <span m='2381210'>to</span> <span m='2381280'>constant.</span>
  <span m='2382180'>And</span> <span m='2382270'>so</span> <span m='2382390'>we</span>
  <span m='2382480'>can</span> <span m='2382570'>afford</span> <span m='2382840'>to</span>
  <span m='2382900'>take</span> <span m='2383110'>much</span> <span m='2383350'>bigger</span>
  <span m='2383650'>jumps</span> <span m='2384010'>here,</span> <span m='2385260'>of</span>
  <span m='2385750'>like</span> <span m='2385930'>1</span> <span m='2386140'>over</span>
  <span m='2386390'>N.</span> <span m='2389340'>And</span> <span m='2389580'>so</span>
  <span m='2389730'>that</span> <span m='2389970'>gets</span> <span m='2390210'>rid</span>
  <span m='2390450'>of</span> <span m='2391440'>this</span> <span m='2391710'>log</span>
  <span m='2392040'>N</span> <span m='2392220'>factor,</span> <span m='2393650'>essentially.</span>
  <span m='2395650'>That</span> <span m='2395770'>was</span> <span m='2395970'>the</span>
  <span m='2396050'>rough</span> <span m='2396650'>sketch.</span> </p><p><span m='2398450'>I</span>
  <span m='2398540'>have</span> <span m='2399500'>written,</span> <span m='2399740'>here,</span>
  <span m='2400510'>that</span> <span m='2400700'>the</span> <span m='2400790'>densities</span>
  <span m='2401360'>we</span> <span m='2401480'>use</span> <span m='2405950'>are</span>
  <span m='2406100'>no</span> <span m='2406310'>longer</span> <span m='2406610'>uniformly</span>
  <span m='2407150'>spaced.</span> <span m='2408060'>The</span> <span m='2408160'>1</span>
  <span m='2408350'>over</span> <span m='2408560'>alpha</span> <span m='2408950'>to</span>
  <span m='2409080'>the</span> <span m='2409190'>d.</span> <span m='2411110'>Alpha,</span>
  <span m='2411530'>here,</span> <span m='2411860'>is</span> <span m='2412010'>some</span>
  <span m='2412280'>constant</span> <span m='2413060'>in</span> <span m='2413900'>the</span>
  <span m='2414020'>interval</span> <span m='2416090'>between</span> <span m='2416660'>1</span>
  <span m='2416990'>and</span> <span m='2417200'>2.</span> <span m='2419600'>And</span>
  <span m='2419750'>d</span> <span m='2419930'>is</span> <span m='2420110'>the</span>
  <span m='2420200'>depth.</span> <span m='2421070'>So</span> <span m='2421190'>now</span>
  <span m='2421340'>we</span> <span m='2421400'>have</span> <span m='2421520'>exponentially</span>
  <span m='2422210'>increasing</span> <span m='2422690'>densities</span> <span m='2424130'>which</span>
  <span m='2427570'>give</span> <span m='2427760'>you</span> <span m='2427850'>a</span>
  <span m='2427880'>big</span> <span m='2428090'>gap--</span> <span m='2428660'>no</span>
  <span m='2428840'>longer</span> <span m='2429110'>lose</span> <span m='2429350'>this</span>
  <span m='2429530'>log</span> <span m='2429790'>N</span> <span m='2429890'>factor.</span>
  </p><p><span m='2432320'>So</span> <span m='2432610'>you</span> <span m='2432710'>do</span>
  <span m='2432980'>exactly</span> <span m='2433490'>the</span> <span m='2433610'>same</span>
  <span m='2433850'>data</span> <span m='2434030'>structure,</span> <span m='2434990'>these</span>
  <span m='2435200'>different</span> <span m='2435470'>densities.</span> <span m='2436650'>Now</span>
  <span m='2436730'>you've</span> <span m='2436910'>got</span> <span m='2437120'>room</span>
  <span m='2437920'>to</span> <span m='2438110'>fill</span> <span m='2438440'>in</span>
  <span m='2438560'>a</span> <span m='2438620'>whole</span> <span m='2438770'>bunch</span>
  <span m='2439010'>more</span> <span m='2439850'>densities</span> <span m='2440540'>when</span>
  <span m='2440690'>you</span> <span m='2440780'>have,</span> <span m='2441290'>say,</span>
  <span m='2441530'>N</span> <span m='2441710'>squared</span> <span m='2442010'>space.</span>
  <span m='2442840'>And</span> <span m='2443000'>so</span> <span m='2443180'>you</span>
  <span m='2443360'>only</span> <span m='2443660'>get</span> <span m='2443810'>the</span>
  <span m='2443900'>log</span> <span m='2444230'>N</span> <span m='2444350'>factor</span>
  <span m='2444710'>because</span> <span m='2445250'>of</span> <span m='2445430'>the</span>
  <span m='2446210'>number</span> <span m='2446420'>of</span> <span m='2446510'>ancestors</span>
  <span m='2447080'>of</span> <span m='2447170'>a</span> <span m='2447230'>node.</span>
  <span m='2447680'>And</span> <span m='2447770'>you</span> <span m='2447860'>lose</span>
  <span m='2448070'>the</span> <span m='2448160'>other</span> <span m='2448370'>log
  N</span> <span m='2448660'>factor.</span> </p><p><span m='2455470'>Now</span> <span
  m='2455740'>let</span> <span m='2455860'>me</span> <span m='2455980'>tell</span>
  <span m='2456220'>you</span> <span m='2456550'>about</span> <span m='2456760'>another</span>
  <span m='2457030'>problem</span> <span m='2459640'>building</span> <span m='2459970'>on</span>
  <span m='2460120'>this.</span> <span m='2471672'>So</span> <span m='2472140'>this
  is</span> <span m='2472440'>the</span> <span m='2472680'>list</span> <span m='2473750'>order</span>
  <span m='2474030'>maintenance</span> <span m='2474420'>problem.</span> <span m='2475480'>And</span>
  <span m='2475580'>this</span> <span m='2475620'>is</span> <span m='2475680'>the</span>
  <span m='2475800'>problem</span> <span m='2476070'>we</span> <span m='2476190'>saw</span>
  <span m='2476440'>in</span> <span m='2476620'>a</span> <span m='2476670'>Lecture</span>
  <span m='2477000'>1.</span> </p><p><span m='2482520'>So</span> <span m='2482990'>here,</span>
  <span m='2487170'>same</span> <span m='2487530'>as</span> <span m='2488130'>before,</span>
  <span m='2488670'>maintain</span> <span m='2489090'>a</span> <span m='2489150'>linked</span>
  <span m='2489360'>list,</span> <span m='2492540'>subject</span> <span m='2493080'>to,</span>
  <span m='2497130'>insert</span> <span m='2498810'>a</span> <span m='2499000'>node</span>
  <span m='2499830'>at</span> <span m='2499980'>this</span> <span m='2500160'>location,</span>
  <span m='2500880'>delete</span> <span m='2501240'>a</span> <span m='2501300'>node</span>
  <span m='2502530'>at</span> <span m='2502680'>this</span> <span m='2502860'>location,</span>
  <span m='2504630'>and</span> <span m='2506220'>order</span> <span m='2506520'>queries.</span>
  <span m='2513720'>Is</span> <span m='2514140'>node</span> <span m='2515400'>x</span>
  <span m='2515940'>before</span> <span m='2517710'>node</span> <span m='2518040'>y</span>
  <span m='2519390'>in</span> <span m='2519570'>the</span> <span m='2519660'>list?</span>
  <span m='2523110'>This</span> <span m='2523320'>is</span> <span m='2523440'>what</span>
  <span m='2523590'>we</span> <span m='2523710'>needed</span> <span m='2523950'>to</span>
  <span m='2524130'>support</span> <span m='2524730'>full</span> <span m='2524970'>persistence.</span>
  <span m='2526550'>You</span> <span m='2526620'>have</span> <span m='2526800'>a</span>
  <span m='2526860'>big</span> <span m='2527070'>linked</span> <span m='2527280'>list.</span>
  <span m='2534430'>And</span> <span m='2534600'>then</span> <span m='2534720'>if</span>
  <span m='2534840'>I</span> <span m='2534900'>give</span> <span m='2535140'>you</span>
  <span m='2535260'>this</span> <span m='2535470'>node</span> <span m='2536010'>and</span>
  <span m='2536220'>this</span> <span m='2536400'>node,</span> <span m='2536760'>I</span>
  <span m='2536880'>want</span> <span m='2537030'>to</span> <span m='2537090'>know</span>
  <span m='2537180'>that</span> <span m='2537300'>this</span> <span m='2537510'>node</span>
  <span m='2537720'>is</span> <span m='2537810'>before</span> <span m='2538170'>that</span>
  <span m='2538350'>node</span> <span m='2538950'>in</span> <span m='2539070'>the</span>
  <span m='2539160'>list</span> <span m='2539430'>in</span> <span m='2539610'>constant</span>
  <span m='2540150'>time.</span> <span m='2541710'>I</span> <span m='2541830'>claim</span>
  <span m='2542220'>that</span> <span m='2542340'>we</span> <span m='2542460'>can</span>
  <span m='2542610'>solve</span> <span m='2542940'>this</span> <span m='2543090'>problem</span>
  <span m='2544140'>given</span> <span m='2544530'>our</span> <span m='2544650'>solutions</span>
  <span m='2545250'>to</span> <span m='2545520'>list</span> <span m='2545760'>labeling--</span>
  <span m='2548250'>not</span> <span m='2548580'>so</span> <span m='2548910'>obvious,</span>
  <span m='2549300'>how.</span> </p><p><span m='2551840'>List</span> <span m='2552150'>labeling</span>
  <span m='2552600'>is</span> <span m='2552720'>great</span> <span m='2553110'>because</span>
  <span m='2553440'>it</span> <span m='2553530'>lets</span> <span m='2553800'>you</span>
  <span m='2553950'>do</span> <span m='2554160'>order</span> <span m='2554400'>queries,</span>
  <span m='2554820'>right?</span> <span m='2554950'>You</span> <span m='2555030'>just</span>
  <span m='2555210'>compare</span> <span m='2555540'>the</span> <span m='2555660'>two</span>
  <span m='2555810'>labels</span> <span m='2556320'>and</span> <span m='2556440'>you</span>
  <span m='2556710'>instantly</span> <span m='2557130'>discover</span> <span m='2557640'>which</span>
  <span m='2557880'>is</span> <span m='2558000'>before</span> <span m='2558360'>which.</span>
  <span m='2559680'>And</span> <span m='2559830'>so</span> <span m='2560010'>if</span>
  <span m='2560100'>we</span> <span m='2560160'>could</span> <span m='2560280'>afford</span>
  <span m='2560580'>log</span> <span m='2560910'>N</span> <span m='2561080'>time</span>
  <span m='2561390'>over</span> <span m='2561600'>there,</span> <span m='2561840'>we</span>
  <span m='2561960'>could</span> <span m='2562110'>just</span> <span m='2562290'>use</span>
  <span m='2562470'>this</span> <span m='2562590'>solution.</span> <span m='2563820'>And</span>
  <span m='2563940'>this</span> <span m='2564090'>is</span> <span m='2564240'>reasonable.</span>
  <span m='2565420'>But</span> <span m='2565590'>we</span> <span m='2565680'>really</span>
  <span m='2565920'>want</span> <span m='2566100'>constant</span> <span m='2566520'>time</span>
  <span m='2566790'>per</span> <span m='2566910'>operation.</span> <span m='2568140'>Now</span>
  <span m='2568260'>if</span> <span m='2568320'>we</span> <span m='2568380'>do</span>
  <span m='2568500'>constant</span> <span m='2568860'>time</span> <span m='2569140'>per
  operation</span> <span m='2569880'>and</span> <span m='2570210'>we</span> <span
  m='2570330'>use</span> <span m='2570570'>exponential</span> <span m='2571170'>label</span>
  <span m='2571890'>space,</span> <span m='2572410'>this</span> <span m='2572610'>is</span>
  <span m='2572700'>not</span> <span m='2572880'>so</span> <span m='2573030'>good</span>
  <span m='2573240'>because</span> <span m='2573540'>it</span> <span m='2573630'>means</span>
  <span m='2573930'>you</span> <span m='2573990'>need</span> <span m='2574310'>N</span>
  <span m='2574620'>bits</span> <span m='2575010'>to</span> <span m='2575160'>write</span>
  <span m='2575340'>down</span> <span m='2575520'>a</span> <span m='2575580'>label.</span>
  <span m='2576540'>So</span> <span m='2576660'>it's</span> <span m='2576780'>going</span>
  <span m='2576900'>to</span> <span m='2576960'>take,</span> <span m='2577140'>like,</span>
  <span m='2577320'>linear</span> <span m='2577710'>time</span> <span m='2578130'>to</span>
  <span m='2578280'>modify</span> <span m='2578940'>or</span> <span m='2579090'>to</span>
  <span m='2579240'>compare</span> <span m='2579630'>two</span> <span m='2579780'>labels.</span>
  <span m='2582000'>This</span> <span m='2582120'>doesn't</span> <span m='2582360'>save</span>
  <span m='2582690'>you.</span> </p><p><span m='2584540'>We</span> <span m='2584700'>can</span>
  <span m='2584820'>afford</span> <span m='2585210'>to</span> <span m='2585300'>do</span>
  <span m='2585450'>this.</span> <span m='2585870'>This is</span> <span m='2585990'>only</span>
  <span m='2586200'>log</span> <span m='2586590'>N</span> <span m='2586740'>bits</span>
  <span m='2586980'>per</span> <span m='2588120'>label.</span> <span m='2588900'>And</span>
  <span m='2589050'>we</span> <span m='2589140'>assume</span> <span m='2589910'>all</span>
  <span m='2590100'>of</span> <span m='2590200'>our</span> <span m='2590340'>integers</span>
  <span m='2590760'>can</span> <span m='2590940'>store</span> <span m='2591300'>at</span>
  <span m='2591360'>least</span> <span m='2591570'>log N</span> <span m='2591990'>bits--</span>
  <span m='2593190'>something</span> <span m='2593610'>called</span> <span m='2593780'>a</span>
  <span m='2593850'>Word RAM</span> <span m='2594260'>Model.</span> <span m='2596740'>And</span>
  <span m='2597630'>so</span> <span m='2597900'>we</span> <span m='2598110'>can</span>
  <span m='2598260'>afford</span> <span m='2598530'>to</span> <span m='2598620'>store</span>
  <span m='2598830'>these</span> <span m='2598980'>labels,</span> <span m='2599970'>but</span>
  <span m='2600120'>we</span> <span m='2600510'>pay</span> <span m='2600810'>this</span>
  <span m='2601020'>log</span> <span m='2601290'>N</span> <span m='2601380'>time.</span>
  <span m='2602140'>So</span> <span m='2602150'>you've</span> <span m='2602250'>got</span>
  <span m='2602370'>to</span> <span m='2602850'>remove</span> <span m='2603270'>a</span>
  <span m='2603330'>log</span> <span m='2603600'>N</span> <span m='2603720'>factor.</span>
  <span m='2604560'>How</span> <span m='2604680'>do</span> <span m='2604800'>we</span>
  <span m='2604890'>do</span> <span m='2605010'>that?</span> <span m='2605750'>Indirection--</span>
  <span m='2607080'>just</span> <span m='2607320'>like</span> <span m='2607920'>last</span>
  <span m='2608130'>class.</span> <span m='2614230'>Let's do</span> <span m='2614730'>that</span>
  <span m='2614970'>on</span> <span m='2615090'>this</span> <span m='2615270'>board.</span>
  </p><p><span m='2628860'>On</span> <span m='2629010'>the</span> <span m='2629100'>top,</span>
  <span m='2630780'>we're</span> <span m='2630900'>going</span> <span m='2631020'>to</span>
  <span m='2631110'>store</span> <span m='2632550'>N</span> <span m='2632820'>over</span>
  <span m='2633120'>log</span> <span m='2633370'>N</span> <span m='2633570'>items</span>
  <span m='2635670'>using</span> <span m='2637230'>this</span> <span m='2638340'>list</span>
  <span m='2638640'>labeling</span> <span m='2645510'>with</span> <span m='2645900'>label</span>
  <span m='2646260'>space,</span> <span m='2648590'>say,</span> <span m='2648990'>N</span>
  <span m='2649460'>squared.</span> <span m='2651680'>Any</span> <span m='2651960'>polynomial</span>
  <span m='2652530'>will</span> <span m='2652680'>do.</span> <span m='2653420'>And</span>
  <span m='2653520'>so</span> <span m='2653640'>this</span> <span m='2653850'>takes</span>
  <span m='2654090'>log</span> <span m='2654435'>N</span> <span m='2654780'>per</span>
  <span m='2654960'>operation</span> <span m='2655560'>to</span> <span m='2655710'>do</span>
  <span m='2655860'>anything</span> <span m='2656250'>on</span> <span m='2656340'>these</span>
  <span m='2656550'>N</span> <span m='2656700'>over</span> <span m='2656910'>log</span>
  <span m='2657150'>N</span> <span m='2657270'>items.</span> <span m='2658480'>And</span>
  <span m='2658530'>then</span> <span m='2658740'>at</span> <span m='2658830'>the</span>
  <span m='2658950'>bottom,</span> <span m='2659500'>we</span> <span m='2659550'>have</span>
  <span m='2659790'>lots</span> <span m='2660030'>of</span> <span m='2660150'>little</span>
  <span m='2660360'>structures</span> <span m='2660960'>of</span> <span m='2661110'>size</span>
  <span m='2661460'>log</span> <span m='2661800'>N.</span> <span m='2663000'>And</span>
  <span m='2663120'>that's</span> <span m='2663330'>supposed</span> <span m='2663600'>to</span>
  <span m='2663780'>eat</span> <span m='2664020'>up</span> <span m='2664260'>a</span>
  <span m='2664320'>factor</span> <span m='2664740'>of</span> <span m='2664830'>log</span>
  <span m='2665180'>N</span> <span m='2665320'>in</span> <span m='2665430'>our</span>
  <span m='2665550'>update</span> <span m='2665910'>time</span> <span m='2666240'>if</span>
  <span m='2666530'>we</span> <span m='2666610'>do</span> <span m='2666740'>it</span>
  <span m='2666830'>right.</span> </p><p><span m='2675030'>Actually,</span> <span
  m='2675450'>I</span> <span m='2675540'>can</span> <span m='2675690'>just</span>
  <span m='2675870'>do</span> <span m='2675970'>list</span> <span m='2676200'>labeling</span>
  <span m='2676590'>down</span> <span m='2676800'>here</span> <span m='2677010'>as</span>
  <span m='2677130'>well.</span> <span m='2678670'>So</span> <span m='2678690'>if</span>
  <span m='2678810'>I'm</span> <span m='2678960'>only</span> <span m='2679230'>storing</span>
  <span m='2679530'>log</span> <span m='2679830'>N</span> <span m='2680010'>items,</span>
  <span m='2681840'>then</span> <span m='2682200'>I</span> <span m='2682290'>can</span>
  <span m='2682440'>afford</span> <span m='2682980'>to</span> <span m='2683130'>use</span>
  <span m='2683310'>the</span> <span m='2683460'>exponential</span> <span m='2683970'>solution--</span>
  <span m='2684960'>the</span> <span m='2685050'>trivial</span> <span m='2685500'>thing</span>
  <span m='2685830'>where</span> <span m='2685950'>I</span> <span m='2686010'>just</span>
  <span m='2686160'>bisect</span> <span m='2687150'>all</span> <span m='2687300'>the</span>
  <span m='2687360'>labels</span> <span m='2687790'>until</span> <span m='2688290'>all</span>
  <span m='2688770'>the</span> <span m='2688890'>log</span> <span m='2689180'>items</span>
  <span m='2689430'>have</span> <span m='2689520'>changed.</span> <span m='2690480'>Then,</span>
  <span m='2690660'>rewrite</span> <span m='2691050'>them.</span> <span m='2691680'>Because</span>
  <span m='2691920'>2 to the</span> <span m='2692280'>log</span> <span m='2692580'>N</span>
  <span m='2692730'>is</span> <span m='2692820'>only</span> <span m='2693090'>N.</span>
  <span m='2693630'>So</span> <span m='2693810'>here,</span> <span m='2694630'>in</span>
  <span m='2694770'>each</span> <span m='2695010'>of</span> <span m='2695100'>these,</span>
  <span m='2696000'>I</span> <span m='2696150'>do</span> <span m='2696390'>a</span>
  <span m='2696410'>list</span> <span m='2696660'>labeling</span> <span m='2699270'>with</span>
  <span m='2699720'>space</span> <span m='2701830'>2</span> <span m='2702140'>to</span>
  <span m='2702450'>the</span> <span m='2702620'>log</span> <span m='2703080'>N,</span>
  <span m='2704370'>also</span> <span m='2704640'>known</span> <span m='2704850'>as</span>
  <span m='2705000'>N.</span> </p><p><span m='2706800'>So</span> <span m='2707070'>these</span>
  <span m='2707280'>guys</span> <span m='2707550'>are</span> <span m='2707640'>constant</span>
  <span m='2708030'>time</span> <span m='2709680'>to</span> <span m='2709800'>do</span>
  <span m='2709950'>anything</span> <span m='2710340'>in</span> <span m='2710920'>to</span>
  <span m='2711130'>maintain</span> <span m='2711510'>the</span> <span m='2711600'>labels.</span>
  <span m='2712500'>And</span> <span m='2712680'>to</span> <span m='2712800'>maintain</span>
  <span m='2713160'>levels</span> <span m='2713490'>up</span> <span m='2713610'>here--</span>
  <span m='2714420'>so</span> <span m='2714660'>to</span> <span m='2714840'>maintain,</span>
  <span m='2715710'>basically,</span> <span m='2716100'>each</span> <span m='2716280'>of</span>
  <span m='2716370'>these</span> <span m='2716910'>N over</span> <span m='2717210'>log
  N</span> <span m='2717500'>guys,</span> <span m='2717750'>is</span> <span m='2717900'>one</span>
  <span m='2718200'>representative</span> <span m='2718890'>element</span> <span m='2720120'>representing</span>
  <span m='2720720'>this</span> <span m='2720870'>entire</span> <span m='2721230'>group</span>
  <span m='2722210'>as</span> <span m='2722460'>N</span> <span m='2722670'>over</span>
  <span m='2722850'>log N</span> <span m='2723270'>of</span> <span m='2723360'>these</span>
  <span m='2723570'>groups.</span> <span m='2727320'>So</span> <span m='2727530'>this</span>
  <span m='2727770'>label</span> <span m='2728070'>structure</span> <span m='2728460'>is</span>
  <span m='2728520'>supposed</span> <span m='2728790'>to</span> <span m='2728970'>distinguish</span>
  <span m='2729480'>the</span> <span m='2729570'>different</span> <span m='2729840'>groups.</span>
  <span m='2730770'>And</span> <span m='2730920'>then</span> <span m='2731510'>the</span>
  <span m='2732510'>labels</span> <span m='2732840'>in</span> <span m='2732960'>here</span>
  <span m='2733330'>are</span> <span m='2733350'>distinguishing</span> <span m='2733920'>the</span>
  <span m='2734040'>items</span> <span m='2734340'>within</span> <span m='2734550'>the</span>
  <span m='2734670'>group.</span> </p><p><span m='2735270'>Now</span> <span m='2735390'>this</span>
  <span m='2735600'>cost</span> <span m='2735930'>log</span> <span m='2736110'>N</span>
  <span m='2736980'>amortized</span> <span m='2738450'>to</span> <span m='2739710'>keep</span>
  <span m='2739980'>what</span> <span m='2740100'>we</span> <span m='2740250'>need</span>
  <span m='2740460'>up</span> <span m='2740580'>here.</span> <span m='2741620'>But
  now</span> <span m='2741830'>if</span> <span m='2742110'>I</span> <span m='2742260'>want</span>
  <span m='2742770'>the</span> <span m='2742860'>label</span> <span m='2743280'>of</span>
  <span m='2743370'>an</span> <span m='2743460'>item,</span> <span m='2744180'>I</span>
  <span m='2744270'>just</span> <span m='2744450'>take</span> <span m='2745050'>this</span>
  <span m='2745380'>label,</span> <span m='2746580'>comma,</span> <span m='2747510'>this</span>
  <span m='2747690'>label.</span> <span m='2749030'>So</span> <span m='2749190'>if</span>
  <span m='2749290'>I</span> <span m='2749390'>have</span> <span m='2749490'>an</span>
  <span m='2749670'>item</span> <span m='2749970'>here,</span> <span m='2750330'>for</span>
  <span m='2750450'>example,</span> <span m='2752290'>at</span> <span m='2752400'>first,</span>
  <span m='2752700'>I</span> <span m='2752760'>look</span> <span m='2752940'>at</span>
  <span m='2753030'>the</span> <span m='2753120'>label</span> <span m='2753570'>of</span>
  <span m='2753780'>this</span> <span m='2753990'>block</span> <span m='2754620'>as</span>
  <span m='2754830'>stored</span> <span m='2755070'>by</span> <span m='2755220'>this</span>
  <span m='2755910'>data</span> <span m='2756120'>structure.</span> <span m='2757000'>And</span>
  <span m='2757020'>then</span> <span m='2757140'>I</span> <span m='2757200'>look</span>
  <span m='2757410'>at</span> <span m='2757500'>the</span> <span m='2757590'>label</span>
  <span m='2757920'>within</span> <span m='2758190'>the</span> <span m='2758280'>block.</span>
  <span m='2759180'>And</span> <span m='2759300'>so</span> <span m='2759480'>my</span>
  <span m='2759750'>composite</span> <span m='2760410'>label</span> <span m='2765390'>is</span>
  <span m='2765540'>going</span> <span m='2765690'>to</span> <span m='2765750'>be</span>
  <span m='2766140'>an</span> <span m='2766320'>ordered</span> <span m='2766680'>pair</span>
  <span m='2768090'>of</span> <span m='2768480'>top</span> <span m='2768810'>label,</span>
  <span m='2770565'>comma,</span> <span m='2771270'>the</span> <span m='2771390'>bottom</span>
  <span m='2771750'>label.</span> </p><p><span m='2778220'>This</span> <span m='2778370'>is</span>
  <span m='2778520'>kind</span> <span m='2778730'>of</span> <span m='2778790'>funny</span>
  <span m='2779090'>because</span> <span m='2779360'>it</span> <span m='2779450'>looks</span>
  <span m='2779600'>like</span> <span m='2779750'>we're</span> <span m='2779840'>solving</span>
  <span m='2780170'>the</span> <span m='2780260'>list</span> <span m='2780380'>labeling</span>
  <span m='2780890'>problem</span> <span m='2781190'>again,</span> <span m='2782030'>with</span>
  <span m='2782210'>now</span> <span m='2782450'>a</span> <span m='2782530'>space</span>
  <span m='2782900'>of</span> <span m='2783390'>N</span> <span m='2783680'>cubed.</span>
  <span m='2785030'>We've</span> <span m='2785210'>got</span> <span m='2785840'>N</span>
  <span m='2786020'>squared</span> <span m='2786320'>for</span> <span m='2786440'>the</span>
  <span m='2786530'>first</span> <span m='2786770'>coordinate,</span> <span m='2787760'>and</span>
  <span m='2787880'>then</span> <span m='2788060'>N</span> <span m='2788360'>for</span>
  <span m='2788510'>the</span> <span m='2788600'>second</span> <span m='2788900'>coordinate.</span>
  <span m='2789900'>So</span> <span m='2789920'>if</span> <span m='2790010'>you</span>
  <span m='2790100'>just</span> <span m='2790220'>concatenate</span> <span m='2790700'>those</span>
  <span m='2790850'>two</span> <span m='2790970'>labels,</span> <span m='2791330'>that</span>
  <span m='2791570'>lives</span> <span m='2791840'>in</span> <span m='2791960'>a</span>
  <span m='2792020'>bigger</span> <span m='2792290'>label</span> <span m='2792560'>space</span>
  <span m='2792860'>of</span> <span m='2792950'>size</span> <span m='2793220'>N</span>
  <span m='2793400'>cubed.</span> </p><p><span m='2795740'>And</span> <span m='2795860'>yet,</span>
  <span m='2796010'>I</span> <span m='2796070'>claim</span> <span m='2796310'>this</span>
  <span m='2796460'>takes</span> <span m='2796700'>constant</span> <span m='2797240'>amortized</span>
  <span m='2798520'>and</span> <span m='2798650'>is</span> <span m='2798770'>not</span>
  <span m='2799100'>a</span> <span m='2799160'>solution</span> <span m='2799580'>to</span>
  <span m='2799680'>list</span> <span m='2799880'>labeling.</span> <span m='2800750'>It's</span>
  <span m='2801140'>just</span> <span m='2801500'>a</span> <span m='2801560'>matter</span>
  <span m='2802250'>of,</span> <span m='2802620'>again,</span> <span m='2802890'>how</span>
  <span m='2803090'>updates</span> <span m='2803540'>are</span> <span m='2803630'>performed.</span>
  <span m='2804560'>With</span> <span m='2804710'>order</span> <span m='2804930'>file</span>
  <span m='2805190'>maintenance,</span> <span m='2805580'>we</span> <span m='2805640'>had</span>
  <span m='2805730'>to</span> <span m='2805820'>physically</span> <span m='2806300'>move</span>
  <span m='2806510'>items.</span> <span m='2807260'>With</span> <span m='2807440'>list</span>
  <span m='2807740'>labeling</span> <span m='2808130'>problem,</span> <span m='2808940'>we</span>
  <span m='2809120'>had</span> <span m='2809330'>to</span> <span m='2809570'>modify</span>
  <span m='2810290'>the</span> <span m='2810410'>number</span> <span m='2810980'>stored</span>
  <span m='2811340'>with</span> <span m='2811490'>each</span> <span m='2811670'>node.</span>
  <span m='2812450'>That's</span> <span m='2812660'>expensive.</span> <span m='2814010'>In</span>
  <span m='2814220'>this</span> <span m='2814490'>world,</span> <span m='2815690'>if</span>
  <span m='2815840'>we</span> <span m='2815990'>change</span> <span m='2816340'>a</span>
  <span m='2816410'>label</span> <span m='2816770'>up</span> <span m='2816980'>here,</span>
  <span m='2818570'>we</span> <span m='2818780'>are</span> <span m='2818870'>basically</span>
  <span m='2819980'>instantly--</span> <span m='2820730'>say,</span> <span m='2820970'>we</span>
  <span m='2821270'>changed</span> <span m='2821690'>the</span> <span m='2821810'>label</span>
  <span m='2822230'>corresponding</span> <span m='2822830'>to</span> <span m='2823430'>this</span>
  <span m='2823700'>group</span> <span m='2824450'>in</span> <span m='2824630'>here.</span>
  <span m='2825500'>We</span> <span m='2825620'>changed</span> <span m='2825890'>the</span>
  <span m='2825950'>label</span> <span m='2826340'>all</span> <span m='2826640'>of</span>
  <span m='2826730'>these</span> <span m='2826910'>items</span> <span m='2827540'>in</span>
  <span m='2827720'>one</span> <span m='2827960'>operation.</span> <span m='2829070'>Or</span>
  <span m='2829280'>actually, it</span> <span m='2829670'>takes</span> <span m='2829950'>log</span>
  <span m='2830210'>N</span> <span m='2830360'>time.</span> <span m='2831170'>And</span>
  <span m='2831260'>then</span> <span m='2831380'>we</span> <span m='2831470'>change</span>
  <span m='2831800'>the</span> <span m='2831860'>label of</span> <span m='2832340'>all</span>
  <span m='2832610'>log</span> <span m='2832910'>N</span> <span m='2833060'>of</span>
  <span m='2833150'>these</span> <span m='2833330'>items.</span> <span m='2834060'>So</span>
  <span m='2834140'>that's</span> <span m='2834350'>why</span> <span m='2834470'>we</span>
  <span m='2834590'>get</span> <span m='2834950'>constant</span> <span m='2835430'>amortized.</span>
  </p><p><span m='2837080'>So</span> <span m='2837170'>how</span> <span m='2837290'>does</span>
  <span m='2837410'>this</span> <span m='2837530'>work?</span> <span m='2838440'>If</span>
  <span m='2838460'>we</span> <span m='2838580'>insert</span> <span m='2838910'>a</span>
  <span m='2838970'>new</span> <span m='2839150'>item,</span> <span m='2839810'>we</span>
  <span m='2839930'>stick</span> <span m='2840170'>it</span> <span m='2840230'>into</span>
  <span m='2840470'>one</span> <span m='2840590'>of</span> <span m='2840650'>these</span>
  <span m='2840800'>blocks.</span> <span m='2842240'>The</span> <span m='2842360'>block</span>
  <span m='2842600'>that</span> <span m='2842720'>it</span> <span m='2842810'>fits</span>
  <span m='2843050'>into.</span> <span m='2843920'>If</span> <span m='2844100'>this</span>
  <span m='2844250'>block</span> <span m='2844520'>gets</span> <span m='2844760'>too</span>
  <span m='2844940'>full,</span> <span m='2845480'>more</span> <span m='2845720'>than,</span>
  <span m='2845990'>say,</span> <span m='2846560'>1</span> <span m='2846770'>times</span>
  <span m='2847040'>log</span> <span m='2847310'>N,</span> <span m='2847850'>then</span>
  <span m='2847970'>we</span> <span m='2848060'>split</span> <span m='2848330'>it</span>
  <span m='2848420'>in</span> <span m='2848510'>half.</span> <span m='2849260'>If</span>
  <span m='2849410'>it</span> <span m='2849470'>gets</span> <span m='2849680'>too</span>
  <span m='2849920'>sparse</span> <span m='2850430'>by</span> <span m='2850580'>deletion,</span>
  <span m='2851450'>say,</span> <span m='2851630'>less</span> <span m='2851870'>than</span>
  <span m='2851990'>a</span> <span m='2852050'>1/4</span> <span m='2852410'>log</span>
  <span m='2852680'>N,</span> <span m='2853280'>then</span> <span m='2853520'>we'll</span>
  <span m='2853670'>merge</span> <span m='2853940'>it</span> <span m='2854030'>with</span>
  <span m='2854180'>one</span> <span m='2854300'>of</span> <span m='2854450'>its</span>
  <span m='2854600'>neighbors,</span> <span m='2855080'>and</span> <span m='2855170'>then</span>
  <span m='2855290'>possibly</span> <span m='2855770'>split.</span> <span m='2856610'>Each</span>
  <span m='2856820'>of</span> <span m='2856910'>those</span> <span m='2857090'>triggers</span>
  <span m='2857510'>a</span> <span m='2857570'>constant</span> <span m='2857990'>number</span>
  <span m='2858170'>of</span> <span m='2858260'>operations</span> <span m='2858800'>up</span>
  <span m='2858910'>here.</span> <span m='2859900'>And</span> <span m='2860000'>so</span>
  <span m='2860120'>we</span> <span m='2860210'>pay</span> <span m='2860460'>log N,</span>
  <span m='2860960'>but</span> <span m='2861110'>we</span> <span m='2861260'>only</span>
  <span m='2861560'>pay</span> <span m='2861830'>it</span> <span m='2861920'>when</span>
  <span m='2862070'>we've</span> <span m='2862280'>made</span> <span m='2862880'>theta</span>
  <span m='2863240'>log N</span> <span m='2863690'>changes</span> <span m='2864170'>to</span>
  <span m='2864410'>one</span> <span m='2864620'>of</span> <span m='2864680'>these</span>
  <span m='2864890'>blocks.</span> <span m='2865850'>So</span> <span m='2866000'>we</span>
  <span m='2866090'>can</span> <span m='2866240'>charge</span> <span m='2866510'>this</span>
  <span m='2866630'>log</span> <span m='2866870'>N</span> <span m='2866990'>cost</span>
  <span m='2867350'>to</span> <span m='2867470'>those</span> <span m='2867740'>log</span>
  <span m='2867960'>N</span> <span m='2868100'>updates.</span> <span m='2869150'>And</span>
  <span m='2869270'>so</span> <span m='2869510'>this</span> <span m='2869810'>turns</span>
  <span m='2870050'>into</span> <span m='2870230'>constant.</span> <span m='2870770'>This</span>
  <span m='2870950'>down</span> <span m='2871160'>here</span> <span m='2871340'>is</span>
  <span m='2871430'>always</span> <span m='2871640'>constant.</span> <span m='2872670'>And</span>
  <span m='2872770'>so</span> <span m='2872990'>it's</span> <span m='2873200'>constant</span>
  <span m='2873620'>amortized.</span> </p><p><span m='2882530'>And</span> <span m='2882830'>if</span>
  <span m='2883010'>each</span> <span m='2883430'>of</span> <span m='2883550'>these</span>
  <span m='2883730'>blocks</span> <span m='2884270'>remembers</span> <span m='2885410'>what</span>
  <span m='2885620'>the</span> <span m='2885740'>corresponding--</span> <span m='2887480'>and,</span>
  <span m='2887600'>basically,</span> <span m='2887960'>this</span> <span m='2888110'>is</span>
  <span m='2888230'>a</span> <span m='2888290'>linked</span> <span m='2888500'>list,</span>
  <span m='2888800'>here.</span> <span m='2889370'>And</span> <span m='2889460'>then</span>
  <span m='2889550'>we</span> <span m='2889610'>have</span> <span m='2889790'>linked</span>
  <span m='2890000'>list</span> <span m='2890180'>down</span> <span m='2890450'>here,</span>
  <span m='2890900'>and</span> <span m='2891050'>they</span> <span m='2891140'>have</span>
  <span m='2891290'>labels.</span> <span m='2892400'>And</span> <span m='2893360'>it's</span>
  <span m='2893600'>like</span> <span m='2893900'>a,</span> <span m='2894310'>what
  do</span> <span m='2894470'>you</span> <span m='2894530'>call,</span> <span m='2894680'>a</span>
  <span m='2894710'>skip</span> <span m='2894980'>list</span> <span m='2895480'>with</span>
  <span m='2895580'>just</span> <span m='2895760'>two</span> <span m='2895940'>levels.</span>
  <span m='2897110'>And</span> <span m='2897230'>every</span> <span m='2897500'>node</span>
  <span m='2897740'>here</span> <span m='2898160'>just</span> <span m='2898340'>remembers</span>
  <span m='2898820'>what</span> <span m='2899000'>its</span> <span m='2899120'>parent</span>
  <span m='2899540'>is</span> <span m='2899660'>up</span> <span m='2899810'>here.</span>
  </p><p><span m='2900630'>So</span> <span m='2900650'>if</span> <span m='2900740'>you</span>
  <span m='2900830'>want</span> <span m='2901010'>to</span> <span m='2901070'>know</span>
  <span m='2901250'>your</span> <span m='2901490'>composite</span> <span m='2902000'>label,</span>
  <span m='2902360'>you</span> <span m='2902480'>just</span> <span m='2902960'>look</span>
  <span m='2903170'>at</span> <span m='2903290'>the</span> <span m='2904220'>bottom</span>
  <span m='2904550'>label</span> <span m='2904970'>and</span> <span m='2905060'>then</span>
  <span m='2905210'>walk</span> <span m='2905480'>up.</span> <span m='2905660'>Look</span>
  <span m='2905840'>at</span> <span m='2905900'>the</span> <span m='2906020'>top</span>
  <span m='2906290'>label.</span> <span m='2907010'>Those</span> <span m='2907190'>are</span>
  <span m='2907270'>just</span> <span m='2907380'>stored</span> <span m='2907790'>right</span>
  <span m='2908000'>there</span> <span m='2908180'>in</span> <span m='2908360'>the</span>
  <span m='2908450'>nodes.</span> <span m='2909140'>And</span> <span m='2909260'>so</span>
  <span m='2909440'>in</span> <span m='2909530'>constant</span> <span m='2909890'>time,</span>
  <span m='2910160'>you</span> <span m='2910250'>can</span> <span m='2910370'>find</span>
  <span m='2910550'>your</span> <span m='2910640'>top</span> <span m='2910880'>label,</span>
  <span m='2911120'>your</span> <span m='2911240'>bottom</span> <span m='2911520'>label.</span>
  <span m='2912200'>Therefore,</span> <span m='2912410'>you</span> <span m='2912500'>can</span>
  <span m='2912620'>compare</span> <span m='2913010'>two</span> <span m='2913190'>items</span>
  <span m='2913550'>in</span> <span m='2913670'>constant</span> <span m='2914030'>time.</span>
  <span m='2915210'>So</span> <span m='2915320'>this</span> <span m='2915470'>solves</span>
  <span m='2915890'>the</span> <span m='2916010'>problem</span> <span m='2916280'>we</span>
  <span m='2916400'>needed</span> <span m='2916670'>in</span> <span m='2916820'>Lecture</span>
  <span m='2917060'>1.</span> <span m='2917380'>Question?</span> </p><p><span m='2917720'>AUDIENCE:</span>
  <span m='2917969'>Sorry,</span> <span m='2918218'>why</span> <span m='2919214'>isn't</span>
  <span m='2919712'>it</span> <span m='2920210'>the same as the N</span> <span m='2920708'>cubed
  label space?</span> </p><p><span m='2922210'>ERIK DEMAINE:</span> <span m='2922335'>OK.</span>
  <span m='2922460'>Why</span> <span m='2922730'>is</span> <span m='2922850'>it</span>
  <span m='2922910'>not</span> <span m='2923190'>same</span> <span m='2923600'>as</span>
  <span m='2923900'>N</span> <span m='2924140'>cubed</span> <span m='2924500'>label</span>
  <span m='2924830'>space,</span> <span m='2925290'>which</span> <span m='2925370'>I</span>
  <span m='2925430'>claim</span> <span m='2925880'>has</span> <span m='2926060'>a</span>
  <span m='2926120'>lower</span> <span m='2926330'>amount</span> <span m='2926570'>of</span>
  <span m='2926690'>log</span> <span m='2926880'>N?</span> <span m='2927770'>The</span>
  <span m='2927890'>difference</span> <span m='2928320'>is</span> <span m='2929790'>with</span>
  <span m='2929960'>list</span> <span m='2930200'>labeling,</span> <span m='2930650'>you</span>
  <span m='2930740'>have</span> <span m='2930890'>to</span> <span m='2930950'>explicitly</span>
  <span m='2931610'>change</span> <span m='2931940'>the</span> <span m='2932030'>label</span>
  <span m='2932300'>of</span> <span m='2932420'>each</span> <span m='2932600'>items.</span>
  <span m='2933590'>And</span> <span m='2933710'>here,</span> <span m='2934430'>we're</span>
  <span m='2935000'>basically</span> <span m='2935450'>computing</span> <span m='2935990'>the</span>
  <span m='2936080'>label</span> <span m='2936410'>of</span> <span m='2936500'>a</span>
  <span m='2936560'>node</span> <span m='2936800'>now</span> <span m='2937010'>becomes</span>
  <span m='2937370'>a</span> <span m='2937400'>constant</span> <span m='2937760'>time</span>
  <span m='2938000'>algorithm.</span> <span m='2938870'>We're</span> <span m='2938960'>allowed</span>
  <span m='2939200'>to</span> <span m='2939290'>look</span> <span m='2939500'>at</span>
  <span m='2939590'>the</span> <span m='2939650'>label,</span> <span m='2939950'>here,</span>
  <span m='2940180'>then</span> <span m='2940460'>walk</span> <span m='2940790'>up,</span>
  <span m='2941060'>then</span> <span m='2941240'>look</span> <span m='2941420'>at</span>
  <span m='2941480'>the</span> <span m='2941570'>label,</span> <span m='2941840'>here.</span>
  <span m='2942050'>And</span> <span m='2942170'>by</span> <span m='2942320'>changing</span>
  <span m='2942770'>the</span> <span m='2942830'>label</span> <span m='2943070'>up</span>
  <span m='2943220'>here,</span> <span m='2943430'>we</span> <span m='2943640'>change</span>
  <span m='2944000'>it</span> <span m='2944090'>simultaneously</span> <span m='2944840'>for</span>
  <span m='2944960'>log N</span> <span m='2945260'>guys</span> <span m='2945500'>down</span>
  <span m='2945680'>there.</span> <span m='2946550'>So</span> <span m='2946700'>that's</span>
  <span m='2946910'>the</span> <span m='2947000'>big</span> <span m='2947150'>difference</span>
  <span m='2947420'>between</span> <span m='2947720'>this</span> <span m='2948710'>list</span>
  <span m='2949160'>order</span> <span m='2949400'>maintenance</span> <span m='2949880'>problem</span>
  <span m='2950600'>from</span> <span m='2951050'>the</span> <span m='2951980'>list</span>
  <span m='2952190'>labeling</span> <span m='2952700'>problem.</span> </p><p><span
  m='2953000'>These</span> <span m='2953180'>were</span> <span m='2953270'>actually</span>
  <span m='2953510'>all</span> <span m='2953630'>solved</span> <span m='2953990'>in</span>
  <span m='2954230'>the</span> <span m='2954320'>same</span> <span m='2954620'>paper</span>
  <span m='2955010'>by</span> <span m='2955220'>Dietz</span> <span m='2955460'>and</span>
  <span m='2955560'>Slater.</span> <span m='2956540'>But</span> <span m='2957710'>sort</span>
  <span m='2957890'>of</span> <span m='2958070'>successively--</span> <span m='2960200'>slightly</span>
  <span m='2960740'>relaxing</span> <span m='2961250'>on</span> <span m='2961340'>a</span>
  <span m='2961370'>problem</span> <span m='2961790'>makes</span> <span m='2961940'>a</span>
  <span m='2962000'>huge</span> <span m='2962360'>difference</span> <span m='2962810'>in</span>
  <span m='2962930'>the</span> <span m='2963020'>running</span> <span m='2963260'>time</span>
  <span m='2963470'>you</span> <span m='2963530'>can</span> <span m='2963680'>achieve.</span>
  <span m='2963980'>Obviously,</span> <span m='2964310'>we</span> <span m='2964400'>can't</span>
  <span m='2964580'>get</span> <span m='2964700'>any</span> <span m='2964820'>better</span>
  <span m='2965060'>than</span> <span m='2965230'>constant.</span> <span m='2965480'>So</span>
  <span m='2965940'>we're</span> <span m='2966200'>done</span> <span m='2967700'>in--</span>
  <span m='2968690'>of</span> <span m='2968750'>course,</span> <span m='2968930'>then</span>
  <span m='2969110'>there's</span> <span m='2969210'>external</span> <span m='2969560'>memory</span>
  <span m='2969860'>versions--</span> <span m='2970490'>but</span> <span m='2972110'>in</span>
  <span m='2972200'>terms</span> <span m='2972410'>of</span> <span m='2972560'>regular</span>
  <span m='2973070'>data</span> <span m='2973280'>structures.</span> <span m='2976350'>And</span>
  <span m='2977210'>again,</span> <span m='2977810'>Willard</span> <span m='2978530'>made</span>
  <span m='2978800'>it</span> <span m='2979460'>worst</span> <span m='2979730'>case</span>
  <span m='2980450'>constant.</span> <span m='2981200'>That's</span> <span m='2981440'>a</span>
  <span m='2981500'>lot</span> <span m='2981740'>harder.</span> </p><p><span m='2983800'>Other</span>
  <span m='2984240'>questions?</span> <span m='2986890'>Cool.</span> <span m='2987160'>So</span>
  <span m='2987350'>that</span> <span m='2987890'>does</span> <span m='2988140'>order</span>
  <span m='2988310'>file</span> <span m='2988580'>maintenance</span> <span m='2989360'>and</span>
  <span m='2989740'>list labeling.</span> <span m='2992260'>And</span> <span m='2992480'>so</span>
  <span m='2993440'>next,</span> <span m='2993710'>we're</span> <span m='2993800'>going</span>
  <span m='2993940'>to</span> <span m='2994010'>move</span> <span m='2994250'>to</span>
  <span m='2994490'>a</span> <span m='2994520'>very</span> <span m='2994700'>different</span>
  <span m='2995000'>data</span> <span m='2995210'>structure,</span> <span m='2995670'>which</span>
  <span m='2995750'>is</span> <span m='2996050'>cache-oblivious</span> <span m='2996800'>priority</span>
  <span m='2997280'>queue.</span> </p><p><span m='3010070'>We</span> <span m='3010130'>haven't</span>
  <span m='3010340'>really</span> <span m='3010580'>done</span> <span m='3010760'>any</span>
  <span m='3011030'>cache-oblivious</span> <span m='3011660'>data</span> <span m='3011870'>structures,</span>
  <span m='3012320'>yet.</span> <span m='3012500'>So</span> <span m='3012650'>it's</span>
  <span m='3012770'>time</span> <span m='3013040'>to</span> <span m='3013160'>return</span>
  <span m='3013610'>to</span> <span m='3013820'>our</span> <span m='3015020'>original</span>
  <span m='3015380'>goal.</span> <span m='3019640'>We're</span> <span m='3019750'>not</span>
  <span m='3020050'>actually</span> <span m='3020410'>going</span> <span m='3020590'>to</span>
  <span m='3020710'>use</span> <span m='3020860'>ordered</span> <span m='3021100'>files.</span>
  <span m='3021820'>Sadly,</span> <span m='3022240'>that</span> <span m='3022390'>was</span>
  <span m='3023170'>last</span> <span m='3023440'>lecture.</span> <span m='3026644'>So</span>
  <span m='3027120'>All</span> <span m='3027580'>of</span> <span m='3027690'>this</span>
  <span m='3027910'>was</span> <span m='3028250'>a</span> <span m='3029140'>continuation</span>
  <span m='3029800'>of</span> <span m='3029890'>last</span> <span m='3030130'>lecture.</span>
  <span m='3030550'>Now</span> <span m='3030760'>we're</span> <span m='3030820'>going</span>
  <span m='3030940'>to</span> <span m='3031030'>do</span> <span m='3031240'>a</span>
  <span m='3031300'>different</span> <span m='3031630'>data</span> <span m='3031810'>structure.</span>
  <span m='3033060'>It's</span> <span m='3033180'>going</span> <span m='3033340'>to</span>
  <span m='3033400'>adapt</span> <span m='3033700'>to</span> <span m='3033820'>B,</span>
  <span m='3034030'>it's</span> <span m='3034150'>going</span> <span m='3034270'>to</span>
  <span m='3034330'>adapt</span> <span m='3034630'>to</span> <span m='3034750'>M.
  It's</span> <span m='3035110'>cache-oblivious.</span> <span m='3036170'>And</span>
  <span m='3036420'>it</span> <span m='3036730'>achieves</span> <span m='3037340'>priority</span>
  <span m='3037860'>queue.</span> </p><p><span m='3038080'>Now</span> <span m='3038800'>remember,</span>
  <span m='3039160'>this</span> <span m='3039310'>sorting</span> <span m='3039700'>bound--</span>
  <span m='3044830'>N</span> <span m='3045080'>over</span> <span m='3045370'>B</span>
  <span m='3045940'>log</span> <span m='3046240'>base</span> <span m='3046450'>M</span>
  <span m='3046990'>of</span> <span m='3047110'>N</span> <span m='3047260'>over</span>
  <span m='3047440'>B</span> <span m='3048010'>This</span> <span m='3048220'>is</span>
  <span m='3048340'>our</span> <span m='3048410'>sorting</span> <span m='3048770'>bound.</span>
  <span m='3049120'>Then the</span> <span m='3049210'>priority</span> <span m='3049630'>queue</span>
  <span m='3049810'>bound</span> <span m='3050050'>we</span> <span m='3050170'>want</span>
  <span m='3050770'>is</span> <span m='3050920'>this</span> <span m='3051160'>divided</span>
  <span m='3051580'>by</span> <span m='3051790'>N.</span> <span m='3053270'>So</span>
  <span m='3053360'>we</span> <span m='3053410'>want</span> <span m='3053560'>to</span>
  <span m='3053620'>be</span> <span m='3053770'>able</span> <span m='3053890'>to</span>
  <span m='3053950'>do</span> <span m='3054100'>1</span> <span m='3054340'>over</span>
  <span m='3054550'>B</span> <span m='3055690'>log</span> <span m='3056980'>base</span>
  <span m='3057310'>M</span> <span m='3057520'>over</span> <span m='3057760'>B,</span>
  <span m='3059020'>N</span> <span m='3059170'>over</span> <span m='3059380'>b.</span>
  <span m='3061990'>Insert</span> <span m='3063340'>and</span> <span m='3063670'>delete</span>
  <span m='3063950'>min,</span> <span m='3064900'>let's</span> <span m='3065020'>say.</span>
  <span m='3065920'>And</span> <span m='3066070'>this</span> <span m='3066280'>is</span>
  <span m='3066400'>an</span> <span m='3066520'>interesting</span> <span m='3066940'>bound</span>
  <span m='3067210'>because</span> <span m='3067510'>it's</span> <span m='3067660'>usually</span>
  <span m='3068290'>much</span> <span m='3068590'>less</span> <span m='3068830'>than</span>
  <span m='3069040'>1.</span> <span m='3070060'>It's</span> <span m='3070180'>a</span>
  <span m='3070300'>sub</span> <span m='3070570'>constant</span> <span m='3071650'>bound.</span>
  <span m='3071990'>This</span> <span m='3072160'>is</span> <span m='3072280'>going</span>
  <span m='3072420'>to</span> <span m='3072490'>be</span> <span m='3072580'>a</span>
  <span m='3072610'>little</span> <span m='3072910'>o of</span> <span m='3073090'>1,</span>
  <span m='3074740'>assuming</span> <span m='3076720'>this</span> <span m='3076900'>log</span>
  <span m='3078070'>is</span> <span m='3078250'>smaller</span> <span m='3078730'>than</span>
  <span m='3078910'>this</span> <span m='3079120'>B.</span> </p><p><span m='3080530'>So</span>
  <span m='3080950'>it's</span> <span m='3081210'>a</span> <span m='3081250'>little</span>
  <span m='3081460'>o of</span> <span m='3081640'>1</span> <span m='3081950'>if,</span>
  <span m='3083530'>let's</span> <span m='3083740'>say,</span> <span m='3089200'>B</span>
  <span m='3089680'>is</span> <span m='3090190'>bigger</span> <span m='3090640'>than</span>
  <span m='3091030'>the</span> <span m='3091070'>log</span> <span m='3091400'>N,</span>
  <span m='3092270'>roughly.</span> <span m='3093620'>This</span> <span m='3094110'>would,</span>
  <span m='3094450'>in</span> <span m='3094570'>particular,</span> <span m='3095050'>be</span>
  <span m='3095930'>enough.</span> <span m='3097390'>No</span> <span m='3097600'>pun</span>
  <span m='3097810'>intended--</span> <span m='3098080'>be</span> <span m='3098410'>enough.</span>
  <span m='3099820'>So</span> <span m='3101080'>if</span> <span m='3101270'>our</span>
  <span m='3101350'>block</span> <span m='3101590'>size</span> <span m='3101860'>is</span>
  <span m='3101950'>reasonably</span> <span m='3102430'>big--</span> <span m='3103030'>cache</span>
  <span m='3103390'>line</span> <span m='3103600'>is</span> <span m='3103690'>bigger</span>
  <span m='3103930'>than</span> <span m='3104080'>log</span> <span m='3104310'>N,</span>
  <span m='3104880'>which is</span> <span m='3105190'>probably</span> <span m='3106120'>most</span>
  <span m='3106600'>likely</span> <span m='3107110'>in</span> <span m='3107220'>typical</span>
  <span m='3107950'>caches</span> <span m='3108550'>and</span> <span m='3108670'>architectures--</span>
  <span m='3109900'>then</span> <span m='3110530'>this</span> <span m='3110740'>is</span>
  <span m='3111340'>more</span> <span m='3111550'>like</span> <span m='3111760'>1</span>
  <span m='3111900'>over</span> <span m='3112070'>B,</span> <span m='3112300'>never</span>
  <span m='3112540'>mind</span> <span m='3112750'>the</span> <span m='3112840'>log.</span>
  <span m='3114420'>And</span> <span m='3114580'>so</span> <span m='3115030'>we</span>
  <span m='3115150'>have</span> <span m='3115270'>to</span> <span m='3115330'>do</span>
  <span m='3115450'>B</span> <span m='3115690'>operations</span> <span m='3116380'>in</span>
  <span m='3116530'>one</span> <span m='3116800'>step.</span> <span m='3117970'>And</span>
  <span m='3118120'>then</span> <span m='3118650'>to</span> <span m='3118840'>really</span>
  <span m='3119080'>get</span> <span m='3119230'>the</span> <span m='3119320'>log</span>
  <span m='3119650'>right,</span> <span m='3120250'>we</span> <span m='3120340'>have</span>
  <span m='3120520'>to</span> <span m='3120610'>depend</span> <span m='3120970'>on</span>
  <span m='3121150'>M,</span> <span m='3121690'>not</span> <span m='3121900'>just</span>
  <span m='3122110'>B.</span> </p><p><span m='3130690'>As</span> <span m='3130930'>I</span>
  <span m='3131020'>mentioned,</span> <span m='3133010'>that's</span> <span m='3133300'>the</span>
  <span m='3133380'>bound</span> <span m='3133630'>we're</span> <span m='3133720'>going</span>
  <span m='3133840'>to</span> <span m='3133900'>achieve.</span> <span m='3136300'>We</span>
  <span m='3136420'>do</span> <span m='3136600'>need</span> <span m='3136810'>to</span>
  <span m='3136930'>make</span> <span m='3137110'>an</span> <span m='3137200'>assumption</span>
  <span m='3137710'>about</span> <span m='3138010'>M</span> <span m='3138220'>and</span>
  <span m='3138310'>B</span> <span m='3138700'>and</span> <span m='3138850'>how</span>
  <span m='3139000'>they</span> <span m='3139150'>relate.</span> <span m='3140420'>So</span>
  <span m='3140500'>we're</span> <span m='3140590'>going</span> <span m='3140800'>to</span>
  <span m='3140950'>assume</span> <span m='3142660'>a</span> <span m='3142870'>tall</span>
  <span m='3143430'>cache,</span> <span m='3148580'>which</span> <span m='3148740'>is</span>
  <span m='3149130'>M</span> <span m='3149520'>is,</span> <span m='3151250'>let's</span>
  <span m='3151330'>say,</span> <span m='3152430'>B</span> <span m='3152710'>to</span>
  <span m='3152860'>the</span> <span m='3152950'>1</span> <span m='3153160'>plus</span>
  <span m='3153400'>epsilon.</span> <span m='3155230'>So it</span> <span m='3155570'>has</span>
  <span m='3155740'>to</span> <span m='3155830'>be</span> <span m='3156610'>substantially</span>
  <span m='3157300'>bigger</span> <span m='3157570'>than</span> <span m='3157750'>B,</span>
  <span m='3158200'>not</span> <span m='3158380'>by</span> <span m='3158540'>a</span>
  <span m='3158560'>huge</span> <span m='3158800'>amount.</span> <span m='3159475'>It</span>
  <span m='3159760'>could</span> <span m='3159880'>be</span> <span m='3160090'>B</span>
  <span m='3160240'>squared.</span> <span m='3160600'>It could</span> <span m='3160720'>be</span>
  <span m='3160840'>B</span> <span m='3160990'>to</span> <span m='3161080'>the</span>
  <span m='3161190'>1.1</span> <span m='3161770'>power.</span> <span m='3162910'>But</span>
  <span m='3163440'>M</span> <span m='3163690'>is</span> <span m='3163750'>definitely</span>
  <span m='3164050'>at</span> <span m='3164110'>least</span> <span m='3164320'>B.</span>
  <span m='3164800'>And</span> <span m='3165100'>I</span> <span m='3165190'>want</span>
  <span m='3165370'>it</span> <span m='3165460'>to</span> <span m='3165580'>be</span>
  <span m='3165730'>a</span> <span m='3165760'>little</span> <span m='3166000'>bit</span>
  <span m='3166120'>bigger.</span> <span m='3166450'>I</span> <span m='3166540'>want</span>
  <span m='3166660'>the</span> <span m='3166750'>number</span> <span m='3166960'>of</span>
  <span m='3167010'>blocks</span> <span m='3167380'>to</span> <span m='3167530'>be</span>
  <span m='3168640'>not</span> <span m='3168880'>so</span> <span m='3169060'>tiny.</span>
  <span m='3173680'>Here's</span> <span m='3173830'>how</span> <span m='3173950'>we</span>
  <span m='3174070'>do</span> <span m='3174220'>it.</span> </p><p><span m='3199940'>I
  think</span> <span m='3200030'>I need</span> <span m='3200250'>a</span> <span m='3200400'>big</span>
  <span m='3202200'>picture.</span> </p><p><span m='3209260'>So the</span> <span m='3209650'>kind</span>
  <span m='3209920'>of</span> <span m='3209980'>funny</span> <span m='3210250'>thing</span>
  <span m='3210460'>about</span> <span m='3210760'>cache-oblivious</span> <span m='3211270'>priority</span>
  <span m='3211720'>queues</span> <span m='3212010'>is</span> <span m='3212110'>we're</span>
  <span m='3212290'>not</span> <span m='3212560'>going</span> <span m='3212710'>to</span>
  <span m='3212800'>use</span> <span m='3213160'>trees.</span> <span m='3216190'>It's</span>
  <span m='3216310'>basically</span> <span m='3216880'>a</span> <span m='3216940'>bunch</span>
  <span m='3217270'>of</span> <span m='3217870'>arrays</span> <span m='3219010'>in</span>
  <span m='3219160'>a</span> <span m='3219250'>linear</span> <span m='3219730'>order.</span>
  <span m='3222814'>In</span> <span m='3223270'>some</span> <span m='3223480'>ways,</span>
  <span m='3223790'>it's</span> <span m='3223930'>an</span> <span m='3224080'>easier</span>
  <span m='3224380'>data</span> <span m='3224590'>structure.</span> <span m='3225670'>But</span>
  <span m='3225940'>it's</span> <span m='3226240'>definitely</span> <span m='3226780'>more</span>
  <span m='3226990'>complicated.</span> <span m='3232030'>But,</span> <span m='3232240'>hey,</span>
  <span m='3232450'>it's</span> <span m='3232600'>faster</span> <span m='3233380'>than</span>
  <span m='3233530'>b-trees.</span> <span m='3235000'>If</span> <span m='3235480'>you</span>
  <span m='3235540'>don't</span> <span m='3235750'>need</span> <span m='3235900'>to</span>
  <span m='3235960'>be</span> <span m='3236020'>able</span> <span m='3236170'>to</span>
  <span m='3236260'>do</span> <span m='3236380'>searches--</span> <span m='3236650'>if</span>
  <span m='3236920'>you</span> <span m='3236980'>just</span> <span m='3237160'>need</span>
  <span m='3237310'>to</span> <span m='3237400'>be</span> <span m='3237460'>able</span>
  <span m='3237620'>to</span> <span m='3237760'>delete</span> <span m='3238070'>min,</span>
  <span m='3238560'>then</span> <span m='3239140'>priority</span> <span m='3239440'>queues</span>
  <span m='3239770'>are</span> <span m='3239920'>a</span> <span m='3239950'>lot</span>
  <span m='3240130'>faster</span> <span m='3241390'>than</span> <span m='3241540'>b-trees.</span>
  </p><p><span m='3250206'>Let me</span> <span m='3250700'>draw</span> <span m='3250970'>this.</span>
  <span m='3264420'>I</span> <span m='3264750'>want</span> <span m='3264930'>to</span>
  <span m='3264990'>try</span> <span m='3265230'>to</span> <span m='3265320'>draw</span>
  <span m='3265530'>this</span> <span m='3266670'>pseudo-accurate</span> <span m='3268020'>size.</span>
  <span m='3291132'>The</span> <span m='3291670'>only</span> <span m='3291880'>part</span>
  <span m='3292000'>that's</span> <span m='3292210'>inaccurate</span> <span m='3292630'>about</span>
  <span m='3292810'>this</span> <span m='3292960'>picture</span> <span m='3293230'>is</span>
  <span m='3293350'>the</span> <span m='3293470'>dot</span> <span m='3293710'>dot</span>
  <span m='3293950'>dots.</span> <span m='3295050'>Lets</span> <span m='3295350'>me</span>
  <span m='3295480'>cheat</span> <span m='3295680'>a</span> <span m='3295730'>little.</span>
  </p><p><span m='3309160'>So</span> <span m='3309460'>we</span> <span m='3309580'>have</span>
  <span m='3310780'>x</span> <span m='3311110'>to</span> <span m='3311270'>that</span>
  <span m='3311470'>9/4,</span> <span m='3314140'>x to</span> <span m='3314510'>the</span>
  <span m='3314650'>3/2</span> <span m='3316486'>and</span> <span m='3316940'>x.</span>
  <span m='3319440'>This</span> <span m='3319660'>is</span> <span m='3319750'>sort</span>
  <span m='3319990'>of</span> <span m='3320110'>what</span> <span m='3320410'>the</span>
  <span m='3322390'>levels</span> <span m='3323020'>are</span> <span m='3323080'>going</span>
  <span m='3323290'>to</span> <span m='3323380'>look</span> <span m='3323590'>like.</span>
  <span m='3324260'>So</span> <span m='3324340'>we</span> <span m='3324400'>have</span>
  <span m='3324580'>a</span> <span m='3324640'>linear</span> <span m='3325030'>sequence</span>
  <span m='3325450'>of</span> <span m='3325540'>levels.</span> <span m='3326510'>They</span>
  <span m='3326660'>are</span> <span m='3326830'>increasing</span> <span m='3329056'>doubly</span>
  <span m='3329470'>exponentially</span> <span m='3330880'>in</span> <span m='3331000'>size.</span>
  <span m='3332090'>If</span> <span m='3332260'>you</span> <span m='3332320'>look</span>
  <span m='3332590'>at</span> <span m='3333550'>what's</span> <span m='3333760'>going</span>
  <span m='3334120'>on</span> <span m='3334420'>here--</span> <span m='3338260'>double</span>
  <span m='3338540'>exponential--</span> </p><p><span m='3338970'>AUDIENCE:</span>
  <span m='3339209'>Are those exponentials the same as</span> <span m='3339448'>those?</span>
  <span m='3339926'>Or are</span> <span m='3340404'>they inverted?</span> </p><p><span
  m='3341360'>ERIK DEMAINE:</span> <span m='3341456'>It's</span> <span m='3341552'>supposed</span>
  <span m='3341650'>to</span> <span m='3341740'>be</span> <span m='3341920'>this--</span>
  <span m='3342680'>so</span> <span m='3343360'>this</span> <span m='3343540'>is</span>
  <span m='3343630'>the</span> <span m='3343750'>top</span> <span m='3344080'>level,</span>
  <span m='3345730'>and</span> <span m='3346300'>this</span> <span m='3346510'>is</span>
  <span m='3346690'>the</span> <span m='3346810'>bottom</span> <span m='3347170'>level.</span>
  <span m='3351100'>So</span> <span m='3351280'>at</span> <span m='3351400'>the</span>
  <span m='3351490'>top,</span> <span m='3351980'>we're</span> <span m='3352080'>going</span>
  <span m='3352090'>to</span> <span m='3352150'>have</span> <span m='3352300'>something</span>
  <span m='3352660'>of</span> <span m='3352720'>size</span> <span m='3353210'>N.</span>
  <span m='3354060'>And</span> <span m='3354560'>at</span> <span m='3354790'>the</span>
  <span m='3354880'>bottom,</span> <span m='3355240'>we're</span> <span m='3355330'>going</span>
  <span m='3355450'>to</span> <span m='3355510'>have</span> <span m='3355630'>something</span>
  <span m='3355990'>of</span> <span m='3356050'>a</span> <span m='3356080'>size</span>
  <span m='3356350'>C,</span> <span m='3356620'>constant.</span> <span m='3357770'>And</span>
  <span m='3357790'>what</span> <span m='3357910'>I've</span> <span m='3358030'>drawn</span>
  <span m='3358270'>is</span> <span m='3358360'>the</span> <span m='3358480'>generic</span>
  <span m='3358930'>middle</span> <span m='3359170'>part.</span> <span m='3360370'>So</span>
  <span m='3360520'>we</span> <span m='3360610'>go</span> <span m='3360760'>from</span>
  <span m='3360970'>x,</span> <span m='3361390'>to</span> <span m='3361570'>x</span>
  <span m='3361840'>to</span> <span m='3361930'>3/2,</span> <span m='3362470'>to</span>
  <span m='3362560'>x</span> <span m='3362770'>to the</span> <span m='3362880'>9/4.</span>
  <span m='3363400'>Or</span> <span m='3363520'>you</span> <span m='3363580'>could</span>
  <span m='3363730'>say</span> <span m='3364000'>x</span> <span m='3364220'>to the</span>
  <span m='3364340'>9/4,</span> <span m='3364810'>down</span> <span m='3365110'>to</span>
  <span m='3365200'>x to the</span> <span m='3365540'>3/2,</span> <span m='3366520'>down</span>
  <span m='3366760'>to</span> <span m='3366920'>x,</span> <span m='3367420'>according</span>
  <span m='3367840'>to</span> <span m='3367960'>this</span> <span m='3370960'>exponential</span>
  <span m='3371560'>geometric</span> <span m='3372040'>progression,</span> <span m='3372580'>I</span>
  <span m='3372700'>guess.</span> <span m='3373610'>So</span> <span m='3375040'>that's</span>
  <span m='3376030'>how</span> <span m='3376210'>they</span> <span m='3376330'>go.</span>
  </p><p><span m='3376610'>So</span> <span m='3376990'>I</span> <span m='3377050'>mean,</span>
  <span m='3377200'>if</span> <span m='3377250'>it</span> <span m='3377310'>was</span>
  <span m='3377440'>just</span> <span m='3378250'>exponential,</span> <span m='3378970'>it</span>
  <span m='3379030'>would</span> <span m='3379120'>be,</span> <span m='3379270'>like,</span>
  <span m='3379510'>N, N</span> <span m='3379960'>over</span> <span m='3380140'>2,</span>
  <span m='3380410'>N</span> <span m='3380530'>over</span> <span m='3380710'>4.</span>
  <span m='3381580'>But</span> <span m='3381670'>we're</span> <span m='3381790'>doing--</span>
  <span m='3382600'>in</span> <span m='3382780'>logarithms,</span> <span m='3383680'>we're</span>
  <span m='3383950'>changing</span> <span m='3384340'>by</span> <span m='3384490'>constant</span>
  <span m='3384850'>factors.</span> <span m='3385200'>So</span> <span m='3385390'>it's</span>
  <span m='3385470'>doubly</span> <span m='3385750'>exponential.</span> <span m='3388120'>And</span>
  <span m='3388270'>then</span> <span m='3388690'>each</span> <span m='3388960'>of</span>
  <span m='3389020'>the</span> <span m='3389140'>levels</span> <span m='3389800'>is</span>
  <span m='3389980'>decomposed</span> <span m='3390700'>into</span> <span m='3391420'>top</span>
  <span m='3391750'>buffers</span> <span m='3392920'>and</span> <span m='3393220'>bottom--</span>
  <span m='3393810'>or,</span> <span m='3394080'>sorry,</span> <span m='3394420'>up</span>
  <span m='3394690'>buffers</span> <span m='3395320'>and</span> <span m='3395500'>down</span>
  <span m='3395800'>buffers.</span> <span m='3397120'>And</span> <span m='3397330'>as</span>
  <span m='3397480'>you</span> <span m='3397600'>see,</span> <span m='3398200'>the</span>
  <span m='3398320'>size</span> <span m='3398620'>of</span> <span m='3398680'>the</span>
  <span m='3398830'>top</span> <span m='3399070'>buffer</span> <span m='3399820'>is</span>
  <span m='3399940'>equal</span> <span m='3400270'>to</span> <span m='3400390'>the</span>
  <span m='3400540'>sum</span> <span m='3400900'>of</span> <span m='3401020'>the</span>
  <span m='3401110'>sizes</span> <span m='3401590'>of</span> <span m='3401680'>the</span>
  <span m='3401770'>bottom</span> <span m='3402100'>buffers.</span> <span m='3403600'>So</span>
  <span m='3403810'>let</span> <span m='3403990'>me</span> <span m='3404200'>elaborate</span>
  <span m='3405940'>on</span> <span m='3407260'>how</span> <span m='3407380'>this</span>
  <span m='3407560'>works.</span> </p><p><span m='3408920'>It's</span> <span m='3409510'>level</span>
  <span m='3411490'>x</span> <span m='3411730'>to</span> <span m='3411850'>the</span>
  <span m='3411970'>3/2.</span> <span m='3413770'>We're</span> <span m='3413870'>going</span>
  <span m='3413890'>to,</span> <span m='3414040'>generically,</span> <span m='3414640'>be</span>
  <span m='3414730'>looking</span> <span m='3415000'>at x</span> <span m='3415190'>to
  the 3/2.</span> <span m='3416500'>So</span> <span m='3416620'>I</span> <span m='3416650'>can</span>
  <span m='3416770'>easily</span> <span m='3417010'>go</span> <span m='3417160'>down.</span>
  <span m='3417550'>That's of</span> <span m='3417730'>size</span> <span m='3418120'>x.</span>
  <span m='3418390'>And</span> <span m='3418510'>up</span> <span m='3418750'>is</span>
  <span m='3418900'>x</span> <span m='3419140'>to</span> <span m='3419270'>the</span>
  <span m='3419390'>9/4--</span> <span m='3421190'>easily.</span> </p><p><span m='3424660'>There's</span>
  <span m='3424810'>always</span> <span m='3425140'>one</span> <span m='3425510'>up</span>
  <span m='3425710'>buffer</span> <span m='3429888'>of</span> <span m='3430360'>size</span>
  <span m='3434380'>x</span> <span m='3434650'>to</span> <span m='3434800'>the</span>
  <span m='3434920'>3/2.</span> <span m='3437840'>So</span> <span m='3438230'>maybe</span>
  <span m='3439220'>some</span> <span m='3439460'>color.</span> <span m='3442410'>So</span>
  <span m='3442730'>this</span> <span m='3442970'>buffer,</span> <span m='3443330'>here,</span>
  <span m='3444140'>is</span> <span m='3444390'>x</span> <span m='3444680'>to</span>
  <span m='3444830'>the</span> <span m='3444950'>3/2.</span> </p><p><span m='3447420'>And</span>
  <span m='3447470'>then</span> <span m='3447680'>we</span> <span m='3447830'>also</span>
  <span m='3448190'>have</span> <span m='3450790'>up</span> <span m='3451220'>to</span>
  <span m='3452120'>x</span> <span m='3452540'>to the</span> <span m='3452760'>1/2</span>
  <span m='3455000'>down</span> <span m='3455360'>buffers,</span> <span m='3462250'>each</span>
  <span m='3463200'>of</span> <span m='3463750'>size</span> <span m='3465436'>theta</span>
  <span m='3465930'>x.</span> <span m='3469750'>Each</span> <span m='3469960'>of</span>
  <span m='3470020'>these</span> <span m='3470230'>guys</span> <span m='3470530'>has</span>
  <span m='3470710'>size</span> <span m='3471070'>theta</span> <span m='3471450'>x.</span>
  <span m='3475700'>And</span> <span m='3475840'>then</span> <span m='3476020'>the</span>
  <span m='3476110'>number</span> <span m='3476590'>of</span> <span m='3476710'>them</span>
  <span m='3478240'>is,</span> <span m='3478440'>at</span> <span m='3478510'>most,</span>
  <span m='3478840'>x</span> <span m='3479080'>to</span> <span m='3479220'>the</span>
  <span m='3479340'>1/2.</span> <span m='3480610'>And</span> <span m='3480700'>so</span>
  <span m='3480820'>you</span> <span m='3480910'>take</span> <span m='3481090'>the</span>
  <span m='3481180'>product,</span> <span m='3481630'>that's</span> <span m='3481840'>x</span>
  <span m='3482030'>to</span> <span m='3482140'>3/2,</span> <span m='3482740'>which</span>
  <span m='3482890'>is</span> <span m='3482980'>the</span> <span m='3483070'>same</span>
  <span m='3483340'>as the</span> <span m='3483530'>up</span> <span m='3483640'>buffer.</span>
  <span m='3484810'>So</span> <span m='3484960'>that's</span> <span m='3485350'>the</span>
  <span m='3485440'>way</span> <span m='3485740'>this</span> <span m='3486370'>cookie</span>
  <span m='3486820'>crumbles.</span> <span m='3488260'>That's</span> <span m='3488710'>how</span>
  <span m='3489040'>each</span> <span m='3489220'>of</span> <span m='3489280'>these</span>
  <span m='3489460'>guys</span> <span m='3489700'>decomposes</span> <span m='3490390'>into</span>
  <span m='3490960'>little</span> <span m='3491170'>pieces.</span> <span m='3492460'>And</span>
  <span m='3492610'>so,</span> <span m='3492790'>in</span> <span m='3492880'>particular,</span>
  <span m='3493360'>this up</span> <span m='3493830'>buffer,</span> <span m='3494860'>if</span>
  <span m='3495070'>you</span> <span m='3495190'>work</span> <span m='3495370'>it</span>
  <span m='3495460'>out,</span> <span m='3495550'>should</span> <span m='3495700'>be</span>
  <span m='3495790'>exactly</span> <span m='3496360'>the</span> <span m='3496480'>same</span>
  <span m='3496750'>size</span> <span m='3497170'>as</span> <span m='3497320'>this</span>
  <span m='3497530'>down</span> <span m='3497830'>buffer.</span> </p><p><span m='3499180'>Maybe</span>
  <span m='3499330'>it's</span> <span m='3499450'>easier</span> <span m='3499750'>to</span>
  <span m='3499870'>do</span> <span m='3500290'>these</span> <span m='3500560'>two.</span>
  <span m='3501250'>So</span> <span m='3501460'>this</span> <span m='3501670'>down</span>
  <span m='3501940'>buffer</span> <span m='3502240'>has</span> <span m='3502420'>size</span>
  <span m='3502930'>x.</span> <span m='3504250'>And</span> <span m='3504910'>if</span>
  <span m='3505090'>you</span> <span m='3505210'>have</span> <span m='3505360'>a</span>
  <span m='3505420'>structure</span> <span m='3505840'>size</span> <span m='3506110'>x,</span>
  <span m='3506380'>the up</span> <span m='3506650'>buffer</span> <span m='3506950'>has</span>
  <span m='3507100'>size</span> <span m='3507370'>x.</span> <span m='3508070'>x</span>
  <span m='3508250'>of</span> <span m='3508330'>3/2</span> <span m='3508510'>has</span>
  <span m='3508900'>an</span> <span m='3509040'>up</span> <span m='3509120'>buffer</span>
  <span m='3509410'>size of</span> <span m='3509650'>x</span> <span m='3510010'>3/2.</span>
  <span m='3510850'>So</span> <span m='3511000'>this</span> <span m='3511240'>will</span>
  <span m='3511360'>be</span> <span m='3511570'>size</span> <span m='3511870'>x.</span>
  <span m='3512230'>And</span> <span m='3512320'>so</span> <span m='3512470'>these</span>
  <span m='3512680'>match.</span> <span m='3515220'>These</span> <span m='3515390'>are</span>
  <span m='3515560'>equal</span> <span m='3515890'>size.</span> <span m='3516280'>That's</span>
  <span m='3516550'>why</span> <span m='3516790'>I</span> <span m='3516820'>drew</span>
  <span m='3517000'>it</span> <span m='3517090'>this</span> <span m='3517270'>way.</span>
  </p><p><span m='3520630'>Now</span> <span m='3520930'>the</span> <span m='3521080'>dot
  dot</span> <span m='3521430'>dot</span> <span m='3521650'>hides</span> <span m='3521890'>the</span>
  <span m='3521950'>fact</span> <span m='3522220'>that</span> <span m='3522310'>they're</span>
  <span m='3522700'>x</span> <span m='3522910'>to</span> <span m='3523090'>the</span>
  <span m='3523150'>1/2</span> <span m='3523690'>of</span> <span m='3523810'>these.</span>
  <span m='3524000'>So</span> <span m='3524170'>there's</span> <span m='3524380'>a</span>
  <span m='3524410'>lot</span> <span m='3524770'>of</span> <span m='3524950'>down</span>
  <span m='3525190'>buffers.</span> <span m='3525610'>They're</span> <span m='3525790'>actually</span>
  <span m='3526030'>a</span> <span m='3526060'>lot</span> <span m='3526270'>smaller</span>
  <span m='3526630'>than</span> <span m='3526750'>up</span> <span m='3526930'>buffers.</span>
  <span m='3527380'>But</span> <span m='3527920'>these</span> <span m='3528130'>two</span>
  <span m='3528370'>match</span> <span m='3528700'>in</span> <span m='3528790'>size</span>
  <span m='3529270'>and</span> <span m='3529390'>these</span> <span m='3529630'>two</span>
  <span m='3529780'>match</span> <span m='3530040'>in</span> <span m='3530110'>size,</span>
  <span m='3530600'>and</span> <span m='3530700'>so</span> <span m='3530710'>on.</span>
  </p><p><span m='3539370'>OK,</span> <span m='3539850'>there's</span> <span m='3540090'>a</span>
  <span m='3540180'>small</span> <span m='3540630'>exception.</span> <span m='3542040'>I'd</span>
  <span m='3542250'>put</span> <span m='3542500'>theta</span> <span m='3542850'>x</span>
  <span m='3543120'>here.</span> <span m='3544940'>The</span> <span m='3545100'>exception</span>
  <span m='3545610'>is</span> <span m='3545790'>that</span> <span m='3546030'>the</span>
  <span m='3546120'>very</span> <span m='3546480'>first</span> <span m='3546840'>down</span>
  <span m='3547140'>buffer</span> <span m='3548220'>might</span> <span m='3548490'>be</span>
  <span m='3548640'>mostly</span> <span m='3549150'>empty.</span> <span m='3550890'>So</span>
  <span m='3551340'>this</span> <span m='3551520'>one</span> <span m='3551670'>is</span>
  <span m='3551790'>not</span> <span m='3552060'>actually</span> <span m='3553320'>data</span>
  <span m='3553540'>x.</span> <span m='3553890'>Each</span> <span m='3554130'>of</span>
  <span m='3554190'>these</span> <span m='3554490'>will</span> <span m='3554610'>be</span>
  <span m='3554940'>theta</span> <span m='3555280'>x.</span> <span m='3556380'>And</span>
  <span m='3556560'>this</span> <span m='3556800'>one</span> <span m='3557010'>over</span>
  <span m='3557190'>on</span> <span m='3557280'>the</span> <span m='3557370'>left</span>
  <span m='3557670'>will</span> <span m='3557850'>be</span> <span m='3558450'>big
  O</span> <span m='3558900'>of</span> <span m='3559050'>x.</span> <span m='3562300'>Small</span>
  <span m='3563640'>typo</span> <span m='3563920'>in</span> <span m='3564200'>the</span>
  <span m='3564370'>notes,</span> <span m='3564650'>here.</span> <span m='3571010'>So</span>
  <span m='3571730'>if</span> <span m='3571930'>that's</span> <span m='3572140'>not</span>
  <span m='3572290'>sufficiently</span> <span m='3572740'>messy,</span> <span m='3573500'>let</span>
  <span m='3573650'>me</span> <span m='3573760'>redraw</span> <span m='3574242'>it--</span>
  <span m='3575690'>make it</span> <span m='3575900'>a</span> <span m='3575950'>little</span>
  <span m='3576160'>cleaner.</span> </p><p><span m='3600060'>I</span> <span m='3600180'>want</span>
  <span m='3600330'>to</span> <span m='3600390'>look</span> <span m='3600660'>at</span>
  <span m='3600990'>two</span> <span m='3601230'>consecutive</span> <span m='3601860'>levels</span>
  <span m='3603360'>and</span> <span m='3603810'>specify</span> <span m='3605540'>invariants.</span>
  <span m='3612090'>So</span> <span m='3612540'>after</span> <span m='3612810'>all,</span>
  <span m='3612870'>I'm</span> <span m='3612960'>trying</span> <span m='3613200'>to</span>
  <span m='3613290'>maintain</span> <span m='3613620'>a</span> <span m='3613680'>priority</span>
  <span m='3613920'>queue.</span> <span m='3614250'>What</span> <span m='3614400'>the</span>
  <span m='3614520'>heck</span> <span m='3614790'>is</span> <span m='3614970'>this</span>
  <span m='3615180'>thing?</span> <span m='3616500'>The</span> <span m='3616620'>idea</span>
  <span m='3616890'>is</span> <span m='3617100'>that</span> <span m='3617340'>towards</span>
  <span m='3617670'>the</span> <span m='3617760'>bottom,</span> <span m='3618630'>that's</span>
  <span m='3618900'>where</span> <span m='3619020'>the</span> <span m='3619110'>min</span>
  <span m='3619330'>is.</span> <span m='3620760'>That</span> <span m='3620910'>would</span>
  <span m='3621030'>seem</span> <span m='3621240'>good,</span> <span m='3621810'>because</span>
  <span m='3622420'>at</span> <span m='3622530'>the</span> <span m='3622620'>bottom,</span>
  <span m='3622950'>you're</span> <span m='3623070'>constant</span> <span m='3623520'>size.</span>
  <span m='3624330'>I</span> <span m='3624450'>can</span> <span m='3624660'>diddle</span>
  <span m='3624990'>with</span> <span m='3625200'>the</span> <span m='3625290'>thing</span>
  <span m='3625500'>of</span> <span m='3625620'>constant</span> <span m='3625980'>size
  if</span> <span m='3626370'>fits</span> <span m='3626580'>in</span> <span m='3626670'>a</span>
  <span m='3626730'>block</span> <span m='3627060'>or</span> <span m='3627230'>if</span>
  <span m='3627380'>it's</span> <span m='3627540'>in</span> <span m='3627630'>cache.</span>
  <span m='3628500'>It</span> <span m='3628560'>takes</span> <span m='3628770'>me</span>
  <span m='3628920'>zero</span> <span m='3629430'>time</span> <span m='3629850'>to</span>
  <span m='3629970'>touch</span> <span m='3630210'>things</span> <span m='3630540'>near</span>
  <span m='3630690'>the</span> <span m='3630810'>bottom.</span> <span m='3631890'>So</span>
  <span m='3632190'>as</span> <span m='3632340'>long</span> <span m='3632550'>as</span>
  <span m='3632640'>I</span> <span m='3632760'>always</span> <span m='3633030'>keep</span>
  <span m='3633270'>the</span> <span m='3633360'>min</span> <span m='3633600'>down</span>
  <span m='3633870'>there,</span> <span m='3634530'>I</span> <span m='3634650'>can</span>
  <span m='3634830'>do</span> <span m='3634980'>fine</span> <span m='3635280'>min</span>
  <span m='3635610'>in</span> <span m='3635820'>zero</span> <span m='3636180'>time.</span>
  <span m='3636960'>And</span> <span m='3637110'>delete</span> <span m='3637360'>min
  will</span> <span m='3637680'>also</span> <span m='3637970'>be</span> <span m='3638100'>pretty</span>
  <span m='3638340'>fast.</span> </p><p><span m='3639450'>I'm</span> <span m='3639600'>also</span>
  <span m='3639840'>going</span> <span m='3639960'>to</span> <span m='3640050'>insert</span>
  <span m='3640500'>there,</span> <span m='3640860'>because</span> <span m='3641700'>I</span>
  <span m='3641790'>don't</span> <span m='3641910'>know</span> <span m='3642120'>where</span>
  <span m='3642360'>else</span> <span m='3642540'>to</span> <span m='3642630'>put</span>
  <span m='3642840'>it.</span> <span m='3643200'>I'd</span> <span m='3643350'>like</span>
  <span m='3643650'>the</span> <span m='3643770'>larger</span> <span m='3644130'>items</span>
  <span m='3644400'>to</span> <span m='3644490'>be</span> <span m='3644630'>at</span>
  <span m='3644730'>near</span> <span m='3644910'>the</span> <span m='3645000'>top.</span>
  <span m='3645630'>I'd</span> <span m='3645750'>like</span> <span m='3645930'>the</span>
  <span m='3646020'>smaller</span> <span m='3646410'>items</span> <span m='3646680'>to</span>
  <span m='3646770'>be</span> <span m='3646860'>near</span> <span m='3647040'>the</span>
  <span m='3647130'>bottom,</span> <span m='3648060'>but</span> <span m='3649110'>kind</span>
  <span m='3649380'>of</span> <span m='3649440'>hard</span> <span m='3649680'>to</span>
  <span m='3649830'>know,</span> <span m='3650640'>when</span> <span m='3650820'>I</span>
  <span m='3650880'>insert</span> <span m='3651180'>an</span> <span m='3651270'>item,</span>
  <span m='3651480'>where</span> <span m='3651630'>it</span> <span m='3651690'>belongs.</span>
  <span m='3652500'>So</span> <span m='3652650'>I'll</span> <span m='3652710'>just</span>
  <span m='3652860'>start</span> <span m='3653130'>by</span> <span m='3653280'>inserting</span>
  <span m='3653700'>at</span> <span m='3653820'>the</span> <span m='3653910'>bottom.</span>
  <span m='3654420'>And</span> <span m='3654510'>the</span> <span m='3654600'>idea</span>
  <span m='3654870'>is</span> <span m='3655500'>as</span> <span m='3655740'>I</span>
  <span m='3656610'>insert,</span> <span m='3657030'>insert,</span> <span m='3657360'>insert</span>
  <span m='3657690'>down</span> <span m='3657930'>here,</span> <span m='3658500'>things</span>
  <span m='3658710'>will</span> <span m='3658800'>start</span> <span m='3659040'>to</span>
  <span m='3659130'>trickle</span> <span m='3659490'>up.</span> <span m='3660030'>That's</span>
  <span m='3660240'>what</span> <span m='3660360'>the</span> <span m='3660510'>up</span>
  <span m='3660720'>arrows</span> <span m='3661200'>mean,</span> <span m='3661530'>that</span>
  <span m='3661710'>these</span> <span m='3661950'>items</span> <span m='3662220'>are</span>
  <span m='3662310'>moving</span> <span m='3662610'>up.</span> <span m='3663970'>And</span>
  <span m='3664180'>then</span> <span m='3664500'>down</span> <span m='3665340'>arrow</span>
  <span m='3665640'>items</span> <span m='3666090'>are</span> <span m='3666180'>items</span>
  <span m='3666510'>that</span> <span m='3666630'>are</span> <span m='3666690'>moving</span>
  <span m='3666960'>down.</span> <span m='3668580'>Somehow</span> <span m='3668940'>this</span>
  <span m='3669090'>is</span> <span m='3669180'>going</span> <span m='3669330'>to</span>
  <span m='3669390'>work.</span> <span m='3669820'>So</span> <span m='3670020'>let</span>
  <span m='3670140'>me</span> <span m='3670290'>tell</span> <span m='3670500'>you</span>
  <span m='3671220'>the</span> <span m='3671470'>invariants</span> <span m='3671930'>that</span>
  <span m='3672030'>will</span> <span m='3672150'>make</span> <span m='3672360'>this</span>
  <span m='3672510'>work.</span> </p><p><span m='3674190'>If</span> <span m='3674280'>you</span>
  <span m='3674340'>look</span> <span m='3674520'>at</span> <span m='3674610'>the</span>
  <span m='3674730'>down</span> <span m='3675060'>buffers,</span> <span m='3676640'>they</span>
  <span m='3676880'>are</span> <span m='3677040'>sorted.</span> <span m='3678300'>Or</span>
  <span m='3678450'>I</span> <span m='3678540'>should</span> <span m='3678690'>say,</span>
  <span m='3678900'>all</span> <span m='3679110'>the</span> <span m='3679230'>items</span>
  <span m='3679530'>in</span> <span m='3679620'>here</span> <span m='3679920'>are</span>
  <span m='3679950'>less</span> <span m='3680190'>than</span> <span m='3680340'>all</span>
  <span m='3680460'>the</span> <span m='3680520'>items</span> <span m='3680820'>in</span>
  <span m='3680910'>here,</span> <span m='3681630'>and</span> <span m='3681750'>so</span>
  <span m='3681990'>on.</span> <span m='3683010'>But</span> <span m='3683130'>within</span>
  <span m='3683430'>each</span> <span m='3683610'>down</span> <span m='3683820'>buffer,</span>
  <span m='3684240'>it's</span> <span m='3684690'>disordered.</span> <span m='3687270'>Then</span>
  <span m='3688240'>we</span> <span m='3688520'>also</span> <span m='3688880'>know</span>
  <span m='3694940'>this.</span> <span m='3696290'>All</span> <span m='3696500'>the</span>
  <span m='3696620'>items</span> <span m='3696920'>in</span> <span m='3697010'>the</span>
  <span m='3697100'>up</span> <span m='3697310'>buffer</span> <span m='3697700'>in</span>
  <span m='3697820'>a</span> <span m='3697880'>given</span> <span m='3698210'>level--</span>
  <span m='3698580'>this</span> <span m='3698810'>is</span> <span m='3699890'>x</span>
  <span m='3700130'>to</span> <span m='3700220'>the</span> <span m='3700340'>3/2,</span>
  <span m='3701030'>let's</span> <span m='3701410'>say.</span> <span m='3702175'>And
  this</span> <span m='3702590'>is</span> <span m='3702940'>x.</span> <span m='3704960'>All</span>
  <span m='3705170'>of</span> <span m='3705230'>the</span> <span m='3705380'>up</span>
  <span m='3706130'>items</span> <span m='3706850'>are</span> <span m='3707120'>larger</span>
  <span m='3707780'>than</span> <span m='3708110'>all</span> <span m='3708560'>of</span>
  <span m='3708680'>the</span> <span m='3708770'>down</span> <span m='3709070'>items.</span>
  <span m='3710930'>I</span> <span m='3710990'>mean,</span> <span m='3711170'>it's</span>
  <span m='3711260'>just</span> <span m='3711480'>an</span> <span m='3712280'>inequality</span>
  <span m='3712550'>here.</span> <span m='3713970'>So</span> <span m='3714020'>these</span>
  <span m='3714200'>guys</span> <span m='3714380'>are</span> <span m='3714470'>basically</span>
  <span m='3714890'>in</span> <span m='3714980'>a</span> <span m='3715070'>chain.</span>
  <span m='3715430'>Again,</span> <span m='3716060'>the</span> <span m='3716180'>items</span>
  <span m='3716450'>in</span> <span m='3716540'>here</span> <span m='3716900'>are</span>
  <span m='3716930'>not</span> <span m='3717200'>sorted.</span> <span m='3718220'>But</span>
  <span m='3718370'>all</span> <span m='3718500'>the</span> <span m='3718610'>items</span>
  <span m='3718850'>here</span> <span m='3719240'>are</span> <span m='3719390'>bigger</span>
  <span m='3719630'>than</span> <span m='3719780'>all</span> <span m='3719880'>the</span>
  <span m='3719970'>items</span> <span m='3720170'>here</span> <span m='3720380'>are</span>
  <span m='3720410'>bigger</span> <span m='3720650'>than</span> <span m='3720890'>all</span>
  <span m='3720990'>of</span> <span m='3721060'>the</span> <span m='3721160'>items</span>
  <span m='3721400'>here</span> <span m='3721590'>are</span> <span m='3721610'>bigger</span>
  <span m='3722000'>than</span> <span m='3722150'>all</span> <span m='3722240'>the</span>
  <span m='3722360'>items</span> <span m='3722600'>here.</span> </p><p><span m='3722780'>Now</span>
  <span m='3722960'>what</span> <span m='3723110'>about</span> <span m='3723380'>from</span>
  <span m='3723560'>level</span> <span m='3723830'>to</span> <span m='3723950'>level?</span>
  <span m='3725510'>This</span> <span m='3725660'>is</span> <span m='3725780'>a</span>
  <span m='3725840'>little</span> <span m='3726080'>more</span> <span m='3726260'>subtle.</span>
  <span m='3727730'>What</span> <span m='3727910'>we</span> <span m='3728060'>know</span>
  <span m='3730010'>is</span> <span m='3730430'>this.</span> <span m='3734210'>So</span>
  <span m='3734400'>again,</span> <span m='3734670'>we</span> <span m='3734760'>know</span>
  <span m='3734940'>that</span> <span m='3735120'>all</span> <span m='3735240'>the</span>
  <span m='3735360'>down</span> <span m='3735600'>buffers</span> <span m='3735930'>are</span>
  <span m='3736020'>sorted.</span> <span m='3736380'>And</span> <span m='3736500'>we</span>
  <span m='3736590'>know</span> <span m='3736740'>that</span> <span m='3736890'>this</span>
  <span m='3737100'>down</span> <span m='3737340'>buffer,</span> <span m='3737670'>all</span>
  <span m='3737880'>these</span> <span m='3738030'>items</span> <span m='3738360'>come</span>
  <span m='3738570'>before</span> <span m='3738960'>all</span> <span m='3739230'>this</span>
  <span m='3739500'>down</span> <span m='3739770'>buffer</span> <span m='3740040'>items.</span>
  <span m='3740820'>But</span> <span m='3740930'>these</span> <span m='3741210'>up</span>
  <span m='3741440'>buffer</span> <span m='3741560'>items,</span> <span m='3741840'>we</span>
  <span m='3741990'>don't</span> <span m='3742170'>know</span> <span m='3742410'>yet,</span>
  <span m='3743140'>because</span> <span m='3743280'>they're</span> <span m='3743460'>still</span>
  <span m='3743700'>moving</span> <span m='3744000'>up.</span> <span m='3744780'>Now</span>
  <span m='3744900'>we</span> <span m='3745020'>know</span> <span m='3745860'>this.</span>
  <span m='3747130'>They</span> <span m='3747330'>need</span> <span m='3747510'>to</span>
  <span m='3747630'>move</span> <span m='3747840'>up.</span> <span m='3748570'>But</span>
  <span m='3748670'>we</span> <span m='3748770'>still</span> <span m='3748830'>don't</span>
  <span m='3748950'>know</span> <span m='3749070'>how</span> <span m='3749250'>far</span>
  <span m='3749610'>up.</span> <span m='3749820'>We</span> <span m='3749940'>don't</span>
  <span m='3750090'>know</span> <span m='3750210'>how</span> <span m='3750450'>these</span>
  <span m='3750690'>items</span> <span m='3750990'>compare</span> <span m='3751320'>to</span>
  <span m='3751410'>these</span> <span m='3751650'>items.</span> <span m='3752010'>Or</span>
  <span m='3752100'>these</span> <span m='3752310'>items</span> <span m='3752670'>could</span>
  <span m='3753420'>have</span> <span m='3753630'>to</span> <span m='3753690'>go</span>
  <span m='3753840'>higher,</span> <span m='3754590'>could</span> <span m='3754740'>be</span>
  <span m='3754860'>they</span> <span m='3755010'>belong</span> <span m='3755460'>here,</span>
  <span m='3756080'>or</span> <span m='3756180'>are</span> <span m='3756280'>here,</span>
  <span m='3756690'>who</span> <span m='3756780'>knows.</span> </p><p><span m='3758260'>So</span>
  <span m='3758340'>basically,</span> <span m='3758670'>the</span> <span m='3758790'>down</span>
  <span m='3759030'>buffers</span> <span m='3759390'>are</span> <span m='3759510'>more</span>
  <span m='3759750'>or</span> <span m='3759780'>less</span> <span m='3759990'>sorted.</span>
  <span m='3761280'>And</span> <span m='3761400'>so</span> <span m='3761550'>the</span>
  <span m='3761670'>mins</span> <span m='3761940'>are</span> <span m='3762000'>going</span>
  <span m='3762150'>to</span> <span m='3762210'>be</span> <span m='3762300'>down</span>
  <span m='3762450'>at</span> <span m='3762540'>the</span> <span m='3762630'>bottom.</span>
  <span m='3763440'>And</span> <span m='3763570'>the</span> <span m='3763680'>up buffer</span>
  <span m='3763980'>items,</span> <span m='3765120'>I</span> <span m='3765180'>mean,</span>
  <span m='3765360'>they're</span> <span m='3765510'>still</span> <span m='3765720'>moving</span>
  <span m='3765990'>up.</span> <span m='3766230'>We</span> <span m='3766350'>don't</span>
  <span m='3766500'>know</span> <span m='3766650'>where</span> <span m='3766740'>they</span>
  <span m='3766860'>belong,</span> <span m='3767190'>yet.</span> <span m='3767430'>But</span>
  <span m='3767580'>eventually</span> <span m='3767970'>they'll</span> <span m='3768120'>find</span>
  <span m='3768330'>their</span> <span m='3768480'>place</span> <span m='3768960'>and</span>
  <span m='3769080'>start</span> <span m='3769290'>trickling</span> <span m='3769650'>down.</span>
  <span m='3770730'>Roughly</span> <span m='3771060'>speaking,</span> <span m='3771570'>an</span>
  <span m='3771690'>item</span> <span m='3772050'>will</span> <span m='3772170'>go</span>
  <span m='3772410'>up</span> <span m='3772560'>for</span> <span m='3772740'>a</span>
  <span m='3772770'>while</span> <span m='3773190'>and</span> <span m='3773280'>then</span>
  <span m='3773400'>come</span> <span m='3773580'>back</span> <span m='3773760'>down.</span>
  <span m='3774000'>Although,</span> <span m='3774190'>that's</span> <span m='3774390'>not</span>
  <span m='3774570'>literally</span> <span m='3775020'>true.</span> <span m='3775320'>It's</span>
  <span m='3775530'>roughly</span> <span m='3775890'>true.</span> </p><p><span m='3781100'>I</span>
  <span m='3781220'>should</span> <span m='3781640'>say</span> <span m='3781910'>something</span>
  <span m='3782420'>about</span> <span m='3784040'>how</span> <span m='3784310'>we</span>
  <span m='3784430'>actually</span> <span m='3784760'>store</span> <span m='3785150'>this</span>
  <span m='3785960'>in</span> <span m='3786110'>memory,</span> <span m='3786800'>because</span>
  <span m='3787160'>the</span> <span m='3787250'>whole</span> <span m='3787430'>name</span>
  <span m='3787640'>of</span> <span m='3787700'>the</span> <span m='3787820'>game</span>
  <span m='3788240'>is</span> <span m='3789800'>how</span> <span m='3789980'>you</span>
  <span m='3790130'>lay</span> <span m='3790310'>things</span> <span m='3790580'>out</span>
  <span m='3790700'>in</span> <span m='3790790'>memory.</span> <span m='3791090'>In</span>
  <span m='3791190'>cache-oblivious,</span> <span m='3791790'>that's</span> <span
  m='3791960'>all</span> <span m='3792080'>you</span> <span m='3792230'>get</span>
  <span m='3792350'>to</span> <span m='3792440'>choose,</span> <span m='3792770'>basically.</span>
  <span m='3793220'>The</span> <span m='3793310'>rest</span> <span m='3793610'>is</span>
  <span m='3794500'>algorithm,</span> <span m='3794990'>regular</span> <span m='3795410'>RAM</span>
  <span m='3795710'>algorithm.</span> <span m='3796700'>And</span> <span m='3796880'>all</span>
  <span m='3797000'>we</span> <span m='3797120'>do</span> <span m='3797360'>is</span>
  <span m='3797480'>store</span> <span m='3797720'>the</span> <span m='3797840'>items</span>
  <span m='3798170'>in</span> <span m='3798290'>order,</span> <span m='3798680'>say,</span>
  <span m='3798920'>from</span> <span m='3799100'>bottom</span> <span m='3799370'>to</span>
  <span m='3799430'>top.</span> <span m='3800150'>So</span> <span m='3800420'>store</span>
  <span m='3800690'>the</span> <span m='3800780'>entire</span> <span m='3801170'>C</span>
  <span m='3801350'>level,</span> <span m='3801710'>then</span> <span m='3801890'>the</span>
  <span m='3801950'>next</span> <span m='3802160'>level</span> <span m='3802400'>up,</span>
  <span m='3802970'>to</span> <span m='3803060'>store</span> <span m='3803300'>these</span>
  <span m='3803510'>items</span> <span m='3803930'>as</span> <span m='3804080'>consecutive</span>
  <span m='3805010'>arrays.</span> <span m='3805835'>That's</span> <span m='3806240'>what</span>
  <span m='3806300'>we</span> <span m='3806390'>need</span> <span m='3806510'>to.</span>
  <span m='3808190'>Leave</span> <span m='3808430'>enough</span> <span m='3808610'>space</span>
  <span m='3808970'>for</span> <span m='3809150'>x</span> <span m='3809290'>to</span>
  <span m='3809390'>the</span> <span m='3809540'>1/2</span> <span m='3809930'>down</span>
  <span m='3810260'>buffers,</span> <span m='3810680'>each at</span> <span m='3810920'>size</span>
  <span m='3811660'>theta</span> <span m='3811950'>x.</span> </p><p><span m='3834430'>So</span>
  <span m='3836410'>how</span> <span m='3836740'>do</span> <span m='3836830'>we</span>
  <span m='3838690'>do</span> <span m='3838930'>inserts</span> <span m='3839410'>and</span>
  <span m='3839530'>deletes?</span> <span m='3846814'>Let's</span> <span m='3847300'>start</span>
  <span m='3847630'>with</span> <span m='3847810'>insert.</span> <span m='3850330'>As</span>
  <span m='3850540'>I</span> <span m='3850600'>mentioned,</span> <span m='3850990'>we</span>
  <span m='3851140'>want</span> <span m='3851380'>to</span> <span m='3851770'>start</span>
  <span m='3852460'>by</span> <span m='3852640'>inserting</span> <span m='3852970'>in</span>
  <span m='3853060'>the</span> <span m='3853150'>bottom,</span> <span m='3853900'>until</span>
  <span m='3854140'>we</span> <span m='3854260'>run</span> <span m='3854410'>out</span>
  <span m='3854500'>of</span> <span m='3854560'>room</span> <span m='3854740'>in</span>
  <span m='3854800'>the</span> <span m='3854890'>bottom.</span> <span m='3855320'>And</span>
  <span m='3855420'>then</span> <span m='3855950'>things</span> <span m='3856210'>have</span>
  <span m='3856360'>to</span> <span m='3856450'>trickle</span> <span m='3856750'>up.</span>
  <span m='3857780'>So</span> <span m='3857890'>here's</span> <span m='3858160'>the</span>
  <span m='3858280'>basic</span> <span m='3858640'>algorithm.</span> </p><p><span
  m='3872770'>You</span> <span m='3872830'>look</span> <span m='3872980'>at</span>
  <span m='3873070'>the</span> <span m='3873160'>bottom</span> <span m='3873490'>level.</span>
  <span m='3874540'>You</span> <span m='3874720'>stick</span> <span m='3875080'>the</span>
  <span m='3875230'>item</span> <span m='3875500'>into</span> <span m='3875770'>the</span>
  <span m='3875890'>up</span> <span m='3876100'>buffer.</span> <span m='3878030'>This</span>
  <span m='3878140'>is</span> <span m='3878260'>not</span> <span m='3878470'>necessarily</span>
  <span m='3878860'>the</span> <span m='3878950'>right</span> <span m='3879070'>thing</span>
  <span m='3879280'>to</span> <span m='3879340'>do.</span> <span m='3880280'>So</span>
  <span m='3880340'>here,</span> <span m='3880600'>you</span> <span m='3880720'>stick</span>
  <span m='3880960'>it</span> <span m='3881050'>into</span> <span m='3881170'>the
  up</span> <span m='3881470'>buffer.</span> <span m='3881760'>But</span> <span m='3881920'>these</span>
  <span m='3882100'>things</span> <span m='3882340'>are</span> <span m='3882400'>supposed</span>
  <span m='3882640'>to</span> <span m='3882760'>be</span> <span m='3882880'>roughly</span>
  <span m='3883180'>sorted.</span> <span m='3884390'>So</span> <span m='3884410'>once</span>
  <span m='3884560'>you</span> <span m='3884650'>stick</span> <span m='3884890'>it</span>
  <span m='3884980'>there,</span> <span m='3885610'>you</span> <span m='3885730'>say,</span>
  <span m='3886000'>oh,</span> <span m='3886270'>well</span> <span m='3886450'>maybe</span>
  <span m='3886720'>I</span> <span m='3886780'>have</span> <span m='3886990'>to</span>
  <span m='3887400'>go</span> <span m='3887560'>down</span> <span m='3887770'>here.</span>
  <span m='3888080'>Go</span> <span m='3888250'>down</span> <span m='3888350'>here.</span>
  <span m='3889100'>The</span> <span m='3889120'>point</span> <span m='3889300'>is</span>
  <span m='3889540'>the up</span> <span m='3889840'>buffer</span> <span m='3890120'>is</span>
  <span m='3890260'>the</span> <span m='3890320'>only</span> <span m='3890500'>one</span>
  <span m='3890650'>I</span> <span m='3890710'>want</span> <span m='3890890'>to</span>
  <span m='3890980'>be</span> <span m='3891100'>growing</span> <span m='3891700'>in</span>
  <span m='3891850'>size.</span> </p><p><span m='3892750'>So</span> <span m='3892840'>I</span>
  <span m='3892930'>insert</span> <span m='3893230'>into</span> <span m='3893410'>the</span>
  <span m='3893500'>up</span> <span m='3893700'>buffer.</span> <span m='3894430'>And</span>
  <span m='3894610'>say,</span> <span m='3894820'>oh,</span> <span m='3895460'>potentially</span>
  <span m='3895860'>I</span> <span m='3895930'>have</span> <span m='3896050'>to</span>
  <span m='3896140'>swap</span> <span m='3896440'>down</span> <span m='3896650'>here.</span>
  <span m='3897370'>Swap</span> <span m='3898210'>down</span> <span m='3898390'>here.</span>
  <span m='3898600'>I</span> <span m='3898660'>mean,</span> <span m='3898780'>this</span>
  <span m='3898930'>is</span> <span m='3899020'>constant</span> <span m='3899410'>size.</span>
  <span m='3899740'>I</span> <span m='3899830'>can</span> <span m='3899950'>afford</span>
  <span m='3900160'>to</span> <span m='3900220'>look</span> <span m='3900370'>at</span>
  <span m='3900580'>all</span> <span m='3900790'>the</span> <span m='3900910'>items</span>
  <span m='3901210'>here</span> <span m='3901480'>in</span> <span m='3901630'>zero</span>
  <span m='3902020'>time</span> <span m='3903370'>and</span> <span m='3903670'>find</span>
  <span m='3903970'>out</span> <span m='3904090'>which</span> <span m='3904300'>buffer</span>
  <span m='3904600'>it</span> <span m='3904660'>belongs</span> <span m='3905020'>to.</span>
  <span m='3905620'>As</span> <span m='3905860'>I</span> <span m='3905950'>move</span>
  <span m='3906220'>the</span> <span m='3906520'>item</span> <span m='3906790'>down</span>
  <span m='3907000'>here,</span> <span m='3907150'>I</span> <span m='3907210'>swap.</span>
  <span m='3907840'>So</span> <span m='3908620'>I</span> <span m='3908710'>take</span>
  <span m='3908860'>the</span> <span m='3908980'>max</span> <span m='3909340'>item</span>
  <span m='3909550'>here</span> <span m='3909850'>and</span> <span m='3909940'>move</span>
  <span m='3910150'>it</span> <span m='3910240'>up</span> <span m='3910450'>to</span>
  <span m='3910570'>here.</span> <span m='3911060'>Move</span> <span m='3911110'>the</span>
  <span m='3911230'>max</span> <span m='3911500'>item</span> <span m='3911680'>from</span>
  <span m='3911770'>the</span> <span m='3911860'>next</span> <span m='3912820'>down</span>
  <span m='3913090'>buffer</span> <span m='3913510'>and</span> <span m='3913660'>propagate</span>
  <span m='3914140'>it</span> <span m='3914260'>up,</span> <span m='3915130'>so that</span>
  <span m='3915340'>I</span> <span m='3915430'>keep</span> <span m='3915640'>these</span>
  <span m='3915820'>things</span> <span m='3916090'>in</span> <span m='3916300'>order.</span>
  </p><p><span m='3922530'>Swap</span> <span m='3924520'>into</span> <span m='3926170'>bottom</span>
  <span m='3926740'>down</span> <span m='3927080'>buffers</span> <span m='3933070'>if</span>
  <span m='3933310'>necessary--</span> <span m='3936730'>or</span> <span m='3937180'>maybe,</span>
  <span m='3937480'>as</span> <span m='3937780'>necessary.</span> <span m='3938110'>You</span>
  <span m='3938440'>might</span> <span m='3938530'>have</span> <span m='3938650'>to</span>
  <span m='3938710'>do</span> <span m='3938860'>a</span> <span m='3938890'>bunch</span>
  <span m='3939100'>of</span> <span m='3939160'>swaps.</span> <span m='3940170'>But</span>
  <span m='3940300'>it's</span> <span m='3940420'>all</span> <span m='3940540'>constant.</span>
  <span m='3944560'>And</span> <span m='3944710'>then</span> <span m='3945910'>the</span>
  <span m='3945970'>point</span> <span m='3946210'>is</span> <span m='3946360'>the</span>
  <span m='3946510'>only</span> <span m='3946900'>buffer</span> <span m='3947230'>that</span>
  <span m='3947350'>got</span> <span m='3948010'>larger</span> <span m='3948460'>by</span>
  <span m='3948640'>one</span> <span m='3948790'>item</span> <span m='3949060'>was</span>
  <span m='3949210'>the up</span> <span m='3949420'>buffer,</span> <span m='3949930'>because,</span>
  <span m='3950110'>here,</span> <span m='3950260'>we</span> <span m='3950320'>did</span>
  <span m='3950470'>swaps</span> <span m='3950830'>to</span> <span m='3950920'>preserve</span>
  <span m='3951250'>size.</span> <span m='3952480'>And</span> <span m='3952870'>if</span>
  <span m='3953050'>that</span> <span m='3953230'>overflows,</span> <span m='3953920'>then</span>
  <span m='3954130'>we</span> <span m='3954260'>do</span> <span m='3954430'>something</span>
  <span m='3954760'>interesting.</span> <span m='3959580'>And</span> <span m='3959800'>something</span>
  <span m='3960130'>interesting</span> <span m='3960670'>is</span> <span m='3960850'>called</span>
  <span m='3961870'>push.</span> <span m='3966200'>This</span> <span m='3966410'>is</span>
  <span m='3966560'>a</span> <span m='3966620'>separate</span> <span m='3966950'>team,</span>
  <span m='3970780'>which</span> <span m='3970930'>I'll</span> <span m='3971100'>define</span>
  <span m='3971510'>now.</span> </p><p><span m='3989000'>So</span> <span m='3989120'>this</span>
  <span m='3989330'>is</span> <span m='3989770'>the</span> <span m='3989990'>bottom</span>
  <span m='3990380'>level</span> <span m='3990650'>push.</span> <span m='3991040'>But</span>
  <span m='3991190'>I</span> <span m='3991250'>wanted</span> <span m='3991450'>to</span>
  <span m='3991540'>find</span> <span m='3991800'>the</span> <span m='3991880'>generic</span>
  <span m='3992840'>level</span> <span m='3993030'>of</span> <span m='3993070'>push,</span>
  <span m='3993560'>which</span> <span m='3993770'>is</span> <span m='3993950'>we're</span>
  <span m='3994040'>going</span> <span m='3994130'>to</span> <span m='3994250'>be</span>
  <span m='3994400'>pushing</span> <span m='3994910'>x elements</span> <span m='3997400'>into</span>
  <span m='3998750'>level</span> <span m='4000850'>x</span> <span m='4001150'>to</span>
  <span m='4001270'>the</span> <span m='4001390'>3/2.</span> <span m='4007500'>So</span>
  <span m='4009500'>why</span> <span m='4009680'>is</span> <span m='4009800'>that?</span>
  <span m='4011150'>Check it</span> <span m='4011440'>out.</span> </p><p><span m='4012320'>If</span>
  <span m='4012470'>we're</span> <span m='4012710'>at</span> <span m='4013040'>level</span>
  <span m='4013370'>x</span> <span m='4013950'>and</span> <span m='4014360'>our</span>
  <span m='4014600'>up</span> <span m='4014870'>buffer</span> <span m='4015260'>overflows,</span>
  <span m='4016280'>and</span> <span m='4016370'>we're</span> <span m='4016460'>trying</span>
  <span m='4016670'>to</span> <span m='4016760'>push</span> <span m='4017090'>into</span>
  <span m='4017300'>the</span> <span m='4017450'>next</span> <span m='4017690'>level--</span>
  <span m='4018020'>that's</span> <span m='4018200'>level</span> <span m='4018590'>x</span>
  <span m='4018770'>to</span> <span m='4018890'>3/2--</span> <span m='4019970'>then</span>
  <span m='4021560'>the</span> <span m='4021890'>up</span> <span m='4022070'>buffer</span>
  <span m='4022340'>that</span> <span m='4022460'>we're</span> <span m='4022550'>trying</span>
  <span m='4022760'>to</span> <span m='4022850'>push</span> <span m='4023510'>has</span>
  <span m='4023840'>size</span> <span m='4024480'>x.</span> <span m='4025435'>The</span>
  <span m='4025900'>up</span> <span m='4026130'>buffer</span> <span m='4026510'>has</span>
  <span m='4026720'>the</span> <span m='4026810'>same</span> <span m='4027080'>size</span>
  <span m='4027500'>as</span> <span m='4027620'>the</span> <span m='4027740'>level</span>
  <span m='4028220'>name.</span> <span m='4029180'>So</span> <span m='4029320'>if
  we're</span> <span m='4029420'>at</span> <span m='4029480'>level</span> <span m='4029750'>x,</span>
  <span m='4029960'>this</span> <span m='4030140'>has</span> <span m='4030620'>size</span>
  <span m='4030950'>x.</span> <span m='4031190'>We're</span> <span m='4031280'>trying</span>
  <span m='4031430'>to</span> <span m='4031520'>push</span> <span m='4031730'>x</span>
  <span m='4032000'>items</span> <span m='4032780'>up</span> <span m='4032990'>into</span>
  <span m='4033200'>the</span> <span m='4033320'>next</span> <span m='4033590'>thing.</span>
  <span m='4038390'>We're</span> <span m='4038480'>going</span> <span m='4038600'>to</span>
  <span m='4038660'>empty</span> <span m='4039050'>out</span> <span m='4039200'>the
  up</span> <span m='4039410'>buffer.</span> <span m='4039840'>Send</span> <span m='4040130'>all</span>
  <span m='4040370'>those</span> <span m='4040520'>items</span> <span m='4040820'>up</span>
  <span m='4041000'>there.</span> </p><p><span m='4044330'>Cool.</span> <span m='4044990'>So</span>
  <span m='4045200'>what</span> <span m='4045290'>do</span> <span m='4045350'>we</span>
  <span m='4045440'>do?</span> <span m='4045770'>How</span> <span m='4045950'>do</span>
  <span m='4046070'>we</span> <span m='4046370'>do</span> <span m='4046520'>this</span>
  <span m='4046670'>push?</span> <span m='4047390'>First</span> <span m='4047600'>thing</span>
  <span m='4047780'>we</span> <span m='4047870'>do</span> <span m='4048050'>is</span>
  <span m='4048200'>sort</span> <span m='4048560'>the</span> <span m='4048710'>items--</span>
  <span m='4051590'>those</span> <span m='4051830'>x</span> <span m='4052060'>items.</span>
  <span m='4053570'>This</span> <span m='4053750'>is</span> <span m='4053900'>where</span>
  <span m='4054050'>I</span> <span m='4054170'>need</span> <span m='4054560'>the</span>
  <span m='4054680'>black</span> <span m='4054920'>box,</span> <span m='4056060'>which</span>
  <span m='4056300'>is</span> <span m='4056420'>that</span> <span m='4056600'>we</span>
  <span m='4056720'>can</span> <span m='4056900'>sort</span> <span m='4057770'>N</span>
  <span m='4058040'>over</span> <span m='4058220'>B</span> <span m='4058400'>log base</span>
  <span m='4058820'>N</span> <span m='4059000'>over</span> <span m='4059180'>B,</span>
  <span m='4059420'>N</span> <span m='4059540'>over</span> <span m='4059740'>B</span>
  <span m='4059960'>cache-obliviously.</span> <span m='4061340'>So</span> <span m='4061490'>we're</span>
  <span m='4061580'>going</span> <span m='4061700'>to</span> <span m='4062090'>use</span>
  <span m='4062330'>that</span> <span m='4063670'>here.</span> <span m='4065480'>It's</span>
  <span m='4065600'>not</span> <span m='4065780'>hard,</span> <span m='4066080'>but</span>
  <span m='4066230'>I</span> <span m='4066320'>don't</span> <span m='4066500'>want</span>
  <span m='4066620'>to</span> <span m='4066710'>spend</span> <span m='4066980'>time</span>
  <span m='4067280'>on</span> <span m='4067400'>it.</span> </p><p><span m='4068810'>Now</span>
  <span m='4069110'>the</span> <span m='4069230'>interesting</span> <span m='4069740'>bit</span>
  <span m='4070250'>is</span> <span m='4071930'>how</span> <span m='4072200'>we</span>
  <span m='4072710'>do</span> <span m='4072920'>the</span> <span m='4073010'>push.</span>
  <span m='4074480'>The</span> <span m='4074600'>tricky</span> <span m='4074900'>part</span>
  <span m='4075140'>is</span> <span m='4075320'>we</span> <span m='4075410'>have</span>
  <span m='4075530'>all</span> <span m='4075710'>these</span> <span m='4075860'>items,</span>
  <span m='4077000'>we</span> <span m='4077120'>know</span> <span m='4077300'>that</span>
  <span m='4077450'>they're</span> <span m='4077600'>bigger</span> <span m='4078350'>than</span>
  <span m='4078560'>all</span> <span m='4078680'>the</span> <span m='4078800'>items</span>
  <span m='4079100'>below</span> <span m='4079430'>them.</span> <span m='4079670'>Maybe,</span>
  <span m='4079940'>here's</span> <span m='4080210'>a</span> <span m='4080240'>better</span>
  <span m='4080450'>picture.</span> <span m='4080770'>We</span> <span m='4080840'>know</span>
  <span m='4081230'>these</span> <span m='4081410'>guys</span> <span m='4081680'>need</span>
  <span m='4081860'>to</span> <span m='4081980'>go</span> <span m='4082190'>up.</span>
  <span m='4082370'>They're</span> <span m='4082490'>bigger</span> <span m='4082790'>than</span>
  <span m='4083060'>everything,</span> <span m='4083840'>all</span> <span m='4083990'>the</span>
  <span m='4084080'>down</span> <span m='4084560'>items</span> <span m='4084890'>below</span>
  <span m='4085250'>us.</span> <span m='4086300'>But</span> <span m='4086420'>we</span>
  <span m='4086510'>don't</span> <span m='4086660'>know,</span> <span m='4086810'>does</span>
  <span m='4087020'>it</span> <span m='4087110'>fit</span> <span m='4087260'>here?</span>
  <span m='4087800'>Here?</span> <span m='4088470'>Here?</span> <span m='4088950'>Or</span>
  <span m='4088970'>here?</span> </p><p><span m='4090830'>But</span> <span m='4090980'>we</span>
  <span m='4091130'>do</span> <span m='4091250'>know</span> <span m='4091400'>that</span>
  <span m='4091520'>these</span> <span m='4091700'>things</span> <span m='4091910'>are</span>
  <span m='4092000'>ordered.</span> <span m='4092480'>And</span> <span m='4092600'>so</span>
  <span m='4092750'>if</span> <span m='4092840'>we</span> <span m='4092930'>sort</span>
  <span m='4093290'>these</span> <span m='4093500'>items,</span> <span m='4094360'>then</span>
  <span m='4094460'>we</span> <span m='4094550'>can</span> <span m='4094670'>say,</span>
  <span m='4094850'>well,</span> <span m='4095330'>let's</span> <span m='4095570'>start</span>
  <span m='4095840'>by</span> <span m='4095960'>looking</span> <span m='4096260'>here.</span>
  <span m='4096859'>Do</span> <span m='4097010'>any</span> <span m='4097250'>of</span>
  <span m='4097340'>these</span> <span m='4097520'>items</span> <span m='4097939'>fit</span>
  <span m='4098180'>in</span> <span m='4098330'>this</span> <span m='4098510'>block?</span>
  <span m='4098990'>Just</span> <span m='4099140'>look</span> <span m='4099319'>at</span>
  <span m='4099380'>the</span> <span m='4099500'>max,</span> <span m='4099890'>here.</span>
  <span m='4100790'>And</span> <span m='4101569'>if</span> <span m='4102229'>these</span>
  <span m='4102410'>guys</span> <span m='4102620'>are</span> <span m='4102710'>smaller</span>
  <span m='4103100'>than</span> <span m='4103220'>the</span> <span m='4103310'>max,</span>
  <span m='4103609'>here,</span> <span m='4103850'>then</span> <span m='4104029'>they</span>
  <span m='4104120'>belong</span> <span m='4104510'>here.</span> <span m='4104819'>So</span>
  <span m='4104850'>keep</span> <span m='4105080'>inserting</span> <span m='4105529'>there.</span>
  <span m='4106430'>Eventually,</span> <span m='4107240'>we'll</span> <span m='4107390'>get</span>
  <span m='4107510'>bigger</span> <span m='4107750'>than</span> <span m='4107899'>the</span>
  <span m='4107960'>max,</span> <span m='4108229'>then</span> <span m='4108380'>we</span>
  <span m='4108470'>go</span> <span m='4108620'>here.</span> <span m='4109279'>Look</span>
  <span m='4109460'>at</span> <span m='4109520'>the</span> <span m='4109609'>max</span>
  <span m='4109910'>item,</span> <span m='4110180'>here.</span> <span m='4110649'>As</span>
  <span m='4110750'>long</span> <span m='4110930'>as</span> <span m='4111020'>we</span>
  <span m='4111080'>have</span> <span m='4111260'>items</span> <span m='4111620'>here</span>
  <span m='4111859'>that</span> <span m='4111979'>are</span> <span m='4112040'>smaller</span>
  <span m='4112399'>than</span> <span m='4112520'>the</span> <span m='4112580'>max</span>
  <span m='4112850'>here,</span> <span m='4113439'>insert,</span> <span m='4113890'>insert,</span>
  <span m='4114040'>insert,</span> <span m='4114380'>insert,</span> <span m='4115430'>and</span>
  <span m='4115580'>so</span> <span m='4115819'>on.</span> </p><p><span m='4116810'>And</span>
  <span m='4116960'>then</span> <span m='4117330'>when</span> <span m='4118109'>we're</span>
  <span m='4118390'>beyond</span> <span m='4119029'>all</span> <span m='4119210'>of</span>
  <span m='4119270'>these--</span> <span m='4119540'>maybe</span> <span m='4119779'>we're</span>
  <span m='4119930'>immediately</span> <span m='4120380'>beyond</span> <span m='4120710'>all</span>
  <span m='4120779'>of</span> <span m='4120819'>these.</span> <span m='4120979'>We</span>
  <span m='4121040'>have</span> <span m='4121130'>to</span> <span m='4121220'>check,</span>
  <span m='4121529'>oh,</span> <span m='4121750'>bigger than the</span> <span m='4122090'>max,</span>
  <span m='4122359'>bigger</span> <span m='4122540'>than</span> <span m='4122660'>the</span>
  <span m='4122720'>max,</span> <span m='4122990'>bigger than the</span> <span m='4123290'>max.</span>
  <span m='4124100'>Then</span> <span m='4124640'>we</span> <span m='4124790'>put</span>
  <span m='4125000'>all</span> <span m='4125210'>the</span> <span m='4125300'>remaining</span>
  <span m='4125720'>items</span> <span m='4126170'>into</span> <span m='4126410'>the
  up</span> <span m='4126670'>buffer.</span> <span m='4128370'>This</span> <span m='4128450'>is</span>
  <span m='4128569'>called</span> <span m='4128840'>distribution.</span> </p><p><span
  m='4151390'>So</span> <span m='4151569'>we're</span> <span m='4151689'>looking</span>
  <span m='4152050'>at</span> <span m='4152200'>level</span> <span m='4152710'>x</span>
  <span m='4152950'>to</span> <span m='4153069'>the</span> <span m='4153160'>3/2,</span>
  <span m='4154670'>and</span> <span m='4154750'>just</span> <span m='4155500'>scanning</span>
  <span m='4156040'>sequentially.</span> <span m='4161740'>Because</span> <span m='4161979'>we</span>
  <span m='4162100'>just</span> <span m='4162279'>sorted</span> <span m='4162609'>them,</span>
  <span m='4162819'>we're</span> <span m='4163330'>scanning</span> <span m='4163689'>them</span>
  <span m='4163840'>in</span> <span m='4163990'>order.</span> <span m='4165340'>We</span>
  <span m='4166990'>visit</span> <span m='4167410'>the</span> <span m='4167500'>down</span>
  <span m='4167770'>buffers</span> <span m='4168130'>in</span> <span m='4168250'>order.</span>
  <span m='4178460'>And</span> <span m='4178700'>insert</span> <span m='4179120'>into</span>
  <span m='4179330'>the</span> <span m='4179450'>appropriate</span> <span m='4179840'>down</span>
  <span m='4180080'>buffer</span> <span m='4180620'>as</span> <span m='4180800'>we</span>
  <span m='4180890'>go.</span> </p><p><span m='4183740'>Now</span> <span m='4184500'>there's</span>
  <span m='4184850'>a</span> <span m='4184910'>little</span> <span m='4185120'>bit</span>
  <span m='4185240'>that</span> <span m='4185359'>can</span> <span m='4185510'>happen,</span>
  <span m='4185840'>here.</span> <span m='4186950'>Our</span> <span m='4187220'>down</span>
  <span m='4187490'>buffers</span> <span m='4187819'>have</span> <span m='4187970'>a</span>
  <span m='4188029'>limit</span> <span m='4188330'>in</span> <span m='4188479'>size.</span>
  <span m='4189710'>Down</span> <span m='4189950'>buffers</span> <span m='4190279'>are</span>
  <span m='4190310'>supposed</span> <span m='4190550'>to</span> <span m='4190609'>have</span>
  <span m='4190729'>size</span> <span m='4191779'>theta</span> <span m='4192109'>x</span>
  <span m='4192394'>at</span> <span m='4192680'>level</span> <span m='4193010'>x</span>
  <span m='4193229'>the</span> <span m='4193340'>3/2.</span> <span m='4194279'>So</span>
  <span m='4194330'>as</span> <span m='4194450'>we're</span> <span m='4194570'>inserting</span>
  <span m='4194960'>into</span> <span m='4195170'>here,</span> <span m='4195520'>a</span>
  <span m='4195590'>down</span> <span m='4195830'>buffer</span> <span m='4196070'>might</span>
  <span m='4196250'>overflow.</span> <span m='4197480'>I've</span> <span m='4197600'>got</span>
  <span m='4197940'>theta</span> <span m='4198170'>slop,</span> <span m='4198500'>here.</span>
  <span m='4198680'>So</span> <span m='4199250'>when</span> <span m='4199400'>a</span>
  <span m='4199440'>down</span> <span m='4199670'>buffer</span> <span m='4199910'>overflows,</span>
  <span m='4200360'>I</span> <span m='4200450'>just</span> <span m='4200570'>split</span>
  <span m='4200870'>it</span> <span m='4200930'>in</span> <span m='4201020'>half.</span>
  <span m='4202100'>I</span> <span m='4202220'>then</span> <span m='4202400'>make</span>
  <span m='4202610'>two</span> <span m='4203120'>down</span> <span m='4203450'>buffers.</span>
  <span m='4204525'>Well,</span> <span m='4204970'>actually, it would</span> <span
  m='4205280'>be,</span> <span m='4205520'>like,</span> <span m='4205670'>here</span>
  <span m='4206000'>and</span> <span m='4206300'>right</span> <span m='4206480'>next</span>
  <span m='4206690'>to</span> <span m='4206840'>it.</span> </p><p><span m='4207440'>I'm</span>
  <span m='4207500'>going</span> <span m='4207600'>to</span> <span m='4207680'>maintain</span>
  <span m='4208040'>a</span> <span m='4208130'>linked</span> <span m='4208460'>list</span>
  <span m='4208790'>of</span> <span m='4208880'>down</span> <span m='4209120'>buffers.</span>
  <span m='4210920'>And</span> <span m='4211130'>each</span> <span m='4211340'>of</span>
  <span m='4211400'>them</span> <span m='4211700'>will</span> <span m='4211970'>have</span>
  <span m='4212210'>space</span> <span m='4212690'>for</span> <span m='4212840'>say,</span>
  <span m='4213110'>2x</span> <span m='4213620'>items.</span> <span m='4214470'>But</span>
  <span m='4215330'>once</span> <span m='4215540'>I</span> <span m='4215630'>do</span>
  <span m='4215720'>a</span> <span m='4215780'>split,</span> <span m='4216080'>they'll</span>
  <span m='4216230'>both</span> <span m='4216440'>be</span> <span m='4216590'>half</span>
  <span m='4216800'>full.</span> <span m='4219140'>So</span> <span m='4219440'>when</span>
  <span m='4224190'>a</span> <span m='4224320'>down</span> <span m='4224600'>buffer</span>
  <span m='4224960'>overflows,</span> <span m='4233450'>split</span> <span m='4235960'>in</span>
  <span m='4236431'>half</span> <span m='4240670'>and</span> <span m='4241150'>maintain</span>
  <span m='4241810'>a</span> <span m='4242200'>linked</span> <span m='4242530'>list</span>
  <span m='4242950'>of</span> <span m='4243190'>down</span> <span m='4243430'>buffers.</span>
  </p><p><span m='4248840'>Another</span> <span m='4249100'>thing</span> <span m='4249280'>that</span>
  <span m='4249370'>can</span> <span m='4249520'>happen</span> <span m='4249820'>is</span>
  <span m='4250540'>when</span> <span m='4250690'>you</span> <span m='4250780'>increase</span>
  <span m='4251200'>the</span> <span m='4251260'>number</span> <span m='4251700'>down</span>
  <span m='4252010'>buffers,</span> <span m='4252400'>we</span> <span m='4252460'>have</span>
  <span m='4252610'>a</span> <span m='4252640'>limit</span> <span m='4252940'>on</span>
  <span m='4253090'>how</span> <span m='4253330'>many</span> <span m='4253630'>down</span>
  <span m='4253870'>buffers</span> <span m='4254230'>we</span> <span m='4254350'>can</span>
  <span m='4254500'>have--</span> <span m='4255190'>up</span> <span m='4255400'>to</span>
  <span m='4255700'>x</span> <span m='4256090'>the</span> <span m='4256210'>1/2</span>
  <span m='4256660'>of</span> <span m='4256750'>them.</span> <span m='4257680'>So</span>
  <span m='4257830'>if</span> <span m='4257890'>we</span> <span m='4258010'>run</span>
  <span m='4258250'>out</span> <span m='4258400'>of</span> <span m='4258490'>down</span>
  <span m='4258730'>buffers</span> <span m='4259060'>by</span> <span m='4259210'>splitting,</span>
  <span m='4260380'>then</span> <span m='4260560'>we</span> <span m='4260650'>need</span>
  <span m='4260800'>to</span> <span m='4260890'>start</span> <span m='4261100'>using</span>
  <span m='4261370'>the up</span> <span m='4261640'>buffer.</span> <span m='4263000'>So</span>
  <span m='4263110'>maybe</span> <span m='4263410'>here,</span> <span m='4265930'>we</span>
  <span m='4266800'>split,</span> <span m='4267340'>maybe,</span> <span m='4267610'>this</span>
  <span m='4267850'>buffer--</span> <span m='4268860'>is</span> <span m='4269020'>now</span>
  <span m='4269200'>too</span> <span m='4269410'>many</span> <span m='4269950'>down</span>
  <span m='4270220'>buffers</span> <span m='4270490'>total.</span> <span m='4271270'>Then</span>
  <span m='4271390'>we'll</span> <span m='4271480'>just</span> <span m='4271630'>take</span>
  <span m='4271870'>all</span> <span m='4272080'>the</span> <span m='4272200'>elements</span>
  <span m='4272500'>in</span> <span m='4272560'>here</span> <span m='4272680'>and</span>
  <span m='4272770'>stick</span> <span m='4273070'>them</span> <span m='4273250'>into</span>
  <span m='4273430'>the up</span> <span m='4273700'>buffer,</span> <span m='4274750'>because</span>
  <span m='4274960'>that's</span> <span m='4275290'>where</span> <span m='4275470'>they</span>
  <span m='4275620'>belong.</span> </p><p><span m='4278030'>So</span> <span m='4278170'>when</span>
  <span m='4278440'>the</span> <span m='4278560'>number</span> <span m='4279370'>of</span>
  <span m='4279580'>down</span> <span m='4279880'>buffers</span> <span m='4280840'>is</span>
  <span m='4280990'>too</span> <span m='4281200'>big,</span> <span m='4281950'>when</span>
  <span m='4282100'>that</span> <span m='4282370'>number</span> <span m='4282820'>overflows,</span>
  <span m='4291600'>move</span> <span m='4293340'>the</span> <span m='4293460'>last</span>
  <span m='4295470'>down</span> <span m='4295770'>buffer</span> <span m='4301770'>into</span>
  <span m='4302070'>the up</span> <span m='4302340'>buffer.</span> <span m='4307450'>So</span>
  <span m='4307470'>there's</span> <span m='4307620'>basically</span> <span m='4307950'>two</span>
  <span m='4308220'>ways</span> <span m='4308520'>that</span> <span m='4308640'>elements</span>
  <span m='4309000'>are</span> <span m='4309060'>going</span> <span m='4309180'>to</span>
  <span m='4309240'>get</span> <span m='4309420'>into</span> <span m='4309660'>the</span>
  <span m='4309810'>up</span> <span m='4310020'>buffer.</span> <span m='4310470'>One</span>
  <span m='4310710'>way</span> <span m='4310890'>is</span> <span m='4311040'>that</span>
  <span m='4311220'>we</span> <span m='4311310'>run</span> <span m='4311520'>out</span>
  <span m='4311610'>of</span> <span m='4311670'>down</span> <span m='4311880'>buffers,</span>
  <span m='4312300'>and</span> <span m='4312390'>so</span> <span m='4312540'>the</span>
  <span m='4312630'>last</span> <span m='4312980'>down</span> <span m='4313230'>buffer</span>
  <span m='4313590'>starts</span> <span m='4313980'>getting</span> <span m='4314220'>promoted</span>
  <span m='4314610'>into</span> <span m='4315780'>the up</span> <span m='4316170'>buffer.</span>
  </p><p><span m='4316950'>The</span> <span m='4317010'>other</span> <span m='4317190'>possibility</span>
  <span m='4317730'>is</span> <span m='4317850'>that</span> <span m='4317970'>we're</span>
  <span m='4318090'>inserting</span> <span m='4318510'>items</span> <span m='4318780'>that</span>
  <span m='4318870'>are</span> <span m='4318960'>just</span> <span m='4319170'>really</span>
  <span m='4319410'>big</span> <span m='4319860'>in</span> <span m='4320010'>value.</span>
  <span m='4321460'>And</span> <span m='4321540'>if</span> <span m='4321660'>the</span>
  <span m='4321750'>items</span> <span m='4322500'>that</span> <span m='4322770'>are</span>
  <span m='4323190'>getting</span> <span m='4323460'>promoted</span> <span m='4323880'>from</span>
  <span m='4324060'>here</span> <span m='4324330'>into</span> <span m='4324570'>the</span>
  <span m='4324690'>next</span> <span m='4324900'>level</span> <span m='4325230'>just</span>
  <span m='4325410'>happen</span> <span m='4325720'>to</span> <span m='4325800'>be</span>
  <span m='4325860'>larger</span> <span m='4326310'>than</span> <span m='4326430'>all</span>
  <span m='4326590'>these</span> <span m='4326760'>items,</span> <span m='4327430'>we</span>
  <span m='4327560'>will</span> <span m='4327720'>immediately</span> <span m='4328170'>start</span>
  <span m='4328620'>inserting</span> <span m='4329040'>into</span> <span m='4329190'>the
  up</span> <span m='4329430'>buffer.</span> <span m='4329790'>But</span> <span m='4329910'>in</span>
  <span m='4330000'>general,</span> <span m='4330270'>we</span> <span m='4330360'>have</span>
  <span m='4330450'>to</span> <span m='4330510'>look</span> <span m='4330690'>at</span>
  <span m='4330750'>this</span> <span m='4330930'>down</span> <span m='4331140'>buffer.</span>
  <span m='4331830'>Look</span> <span m='4331980'>at</span> <span m='4332040'>this</span>
  <span m='4332220'>one.</span> <span m='4332460'>Look</span> <span m='4332580'>at</span>
  <span m='4332670'>this</span> <span m='4332850'>one,</span> <span m='4333540'>then</span>
  <span m='4333720'>that</span> <span m='4333870'>one.</span> <span m='4336300'>That</span>
  <span m='4336510'>is</span> <span m='4336660'>insert</span> <span m='4337170'>and</span>
  <span m='4337320'>push.</span> </p><p><span m='4338070'>I</span> <span m='4338130'>think</span>
  <span m='4339330'>before</span> <span m='4339930'>I</span> <span m='4339990'>talk</span>
  <span m='4340230'>about</span> <span m='4340440'>delete,</span> <span m='4341010'>I'd</span>
  <span m='4341160'>like</span> <span m='4341310'>to</span> <span m='4341370'>talk</span>
  <span m='4341520'>about</span> <span m='4341730'>the</span> <span m='4341820'>analysis</span>
  <span m='4342390'>of</span> <span m='4342510'>just</span> <span m='4342780'>insert</span>
  <span m='4343170'>and</span> <span m='4343260'>push.</span> <span m='4344040'>Keep</span>
  <span m='4344280'>it</span> <span m='4344460'>simple.</span> <span m='4345720'>And</span>
  <span m='4345810'>then</span> <span m='4345990'>I'll</span> <span m='4346080'>briefly</span>
  <span m='4347220'>tell</span> <span m='4347370'>you</span> <span m='4347460'>about</span>
  <span m='4347670'>deletion.</span> </p><p><span m='4371620'>Oh,</span> <span m='4371950'>I</span>
  <span m='4372010'>didn't</span> <span m='4372220'>say.</span> <span m='4372550'>Sorry.</span>
  <span m='4373210'>There's</span> <span m='4373360'>one</span> <span m='4373540'>more</span>
  <span m='4373690'>step,</span> <span m='4373990'>which</span> <span m='4374170'>is</span>
  <span m='4374260'>the</span> <span m='4374380'>recursion.</span> <span m='4377990'>Running
  out</span> <span m='4378380'>a</span> <span m='4378460'>room,</span> <span m='4378760'>here.</span>
  <span m='4379450'>Maybe</span> <span m='4379690'>I'll</span> <span m='4379780'>go</span>
  <span m='4380020'>over</span> <span m='4381130'>here.</span> <span m='4381470'>This</span>
  <span m='4381580'>is</span> <span m='4381820'>nothing</span> <span m='4382180'>relevant.</span>
  </p><p><span m='4391150'>So</span> <span m='4391360'>I</span> <span m='4391420'>need</span>
  <span m='4391570'>to</span> <span m='4391720'>recurse</span> <span m='4392050'>somehow.</span>
  <span m='4395890'>At</span> <span m='4396010'>some</span> <span m='4396190'>point,</span>
  <span m='4396430'>inserting</span> <span m='4396820'>things</span> <span m='4397030'>into</span>
  <span m='4397210'>the</span> <span m='4397330'>up</span> <span m='4397560'>offer,</span>
  <span m='4398410'>the</span> <span m='4398560'>up</span> <span m='4398740'>buffer</span>
  <span m='4399040'>might</span> <span m='4399220'>overflow.</span> <span m='4399760'>That's</span>
  <span m='4399970'>the</span> <span m='4400090'>one</span> <span m='4400330'>last</span>
  <span m='4400630'>thing</span> <span m='4400840'>that</span> <span m='4400960'>could</span>
  <span m='4401080'>overflow.</span> <span m='4401980'>When</span> <span m='4402100'>that</span>
  <span m='4402250'>happens,</span> <span m='4402820'>I</span> <span m='4402910'>just</span>
  <span m='4403120'>push</span> <span m='4403480'>it</span> <span m='4403750'>to</span>
  <span m='4403900'>the</span> <span m='4403960'>next</span> <span m='4404170'>level</span>
  <span m='4404410'>up.</span> </p><p><span m='4432030'>So</span> <span m='4432360'>as</span>
  <span m='4432600'>we</span> <span m='4432750'>do</span> <span m='4432930'>insertions</span>
  <span m='4433440'>in</span> <span m='4433530'>here,</span> <span m='4435096'>we</span>
  <span m='4435510'>might</span> <span m='4435720'>start</span> <span m='4435930'>inserting</span>
  <span m='4436320'>a</span> <span m='4436380'>lot</span> <span m='4436620'>into</span>
  <span m='4436830'>here.</span> <span m='4437070'>Eventually,</span> <span m='4437490'>this</span>
  <span m='4437670'>will</span> <span m='4437760'>get</span> <span m='4437910'>too</span>
  <span m='4438120'>big.</span> <span m='4438390'>It's</span> <span m='4438470'>supposed</span>
  <span m='4438690'>to</span> <span m='4438750'>have</span> <span m='4438840'>size</span>
  <span m='4439170'>x</span> <span m='4439410'>the</span> <span m='4439500'>3/2.</span>
  <span m='4440200'>If</span> <span m='4440340'>it gets</span> <span m='4440460'>bigger</span>
  <span m='4440700'>than</span> <span m='4440850'>that,</span> <span m='4441360'>take</span>
  <span m='4441630'>all</span> <span m='4441870'>these</span> <span m='4442050'>items</span>
  <span m='4442350'>and</span> <span m='4442440'>just</span> <span m='4442740'>recursively</span>
  <span m='4443460'>push</span> <span m='4443730'>them</span> <span m='4443970'>up</span>
  <span m='4444390'>to</span> <span m='4444480'>the</span> <span m='4444570'>next</span>
  <span m='4444780'>level.</span> <span m='4445620'>And</span> <span m='4445730'>conveniently,</span>
  <span m='4446220'>that's</span> <span m='4446460'>exactly</span> <span m='4446910'>the</span>
  <span m='4447360'>same</span> <span m='4447750'>size</span> <span m='4448170'>as</span>
  <span m='4448260'>we</span> <span m='4448380'>were</span> <span m='4448500'>doing</span>
  <span m='4448710'>before.</span> <span m='4449010'>Here,</span> <span m='4449190'>we</span>
  <span m='4449280'>did</span> <span m='4449460'>x</span> <span m='4449790'>into</span>
  <span m='4449990'>level</span> <span m='4450250'>x to</span> <span m='4450400'>the</span>
  <span m='4450540'>3/2.</span> <span m='4451690'>Next</span> <span m='4451800'>will</span>
  <span m='4451920'>be x to</span> <span m='4452160'>the</span> <span m='4452340'>3/2</span>
  <span m='4452820'>into</span> <span m='4453060'>level</span> <span m='4453330'>x
  to the</span> <span m='4453740'>9/4,</span> <span m='4454560'>and</span> <span m='4454650'>so</span>
  <span m='4454770'>on.</span> <span m='4456660'>Always</span> <span m='4456960'>the</span>
  <span m='4457050'>size</span> <span m='4457380'>of</span> <span m='4457440'>the
  up</span> <span m='4457650'>buffer.</span> </p><p><span m='4462040'>So</span> <span
  m='4462060'>the</span> <span m='4462180'>claim</span> <span m='4462510'>is</span>
  <span m='4462720'>if</span> <span m='4462810'>we</span> <span m='4462900'>look</span>
  <span m='4463140'>at</span> <span m='4463260'>the</span> <span m='4463380'>push</span>
  <span m='4464810'>at</span> <span m='4465000'>level</span> <span m='4465300'>x</span>
  <span m='4465480'>to</span> <span m='4465600'>the</span> <span m='4465690'>3/2--</span>
  <span m='4466260'>which</span> <span m='4466440'>is</span> <span m='4466560'>what</span>
  <span m='4466680'>we</span> <span m='4466770'>just</span> <span m='4466980'>described--</span>
  <span m='4469680'>and</span> <span m='4469920'>we</span> <span m='4470790'>ignore</span>
  <span m='4471270'>the</span> <span m='4471360'>recursion.</span> <span m='4480910'>Then</span>
  <span m='4481960'>the</span> <span m='4482050'>cost</span> <span m='4482740'>is</span>
  <span m='4484840'>x</span> <span m='4485130'>over</span> <span m='4485400'>B</span>
  <span m='4486400'>log</span> <span m='4487030'>base</span> <span m='4487450'>M</span>
  <span m='4487660'>over</span> <span m='4487900'>B</span> <span m='4488570'>of</span>
  <span m='4488970'>x</span> <span m='4489370'>over</span> <span m='4489580'>B--</span>
  <span m='4491560'>so</span> <span m='4491740'>sorting</span> <span m='4492130'>bound</span>
  <span m='4492510'>on</span> <span m='4492790'>x</span> <span m='4493120'>items.</span>
  </p><p><span m='4494590'>So</span> <span m='4495160'>we</span> <span m='4495340'>spend</span>
  <span m='4495670'>that</span> <span m='4495910'>right</span> <span m='4496150'>away</span>
  <span m='4496900'>in</span> <span m='4497020'>the</span> <span m='4497080'>very</span>
  <span m='4497290'>first</span> <span m='4497530'>step.</span> <span m='4497800'>We</span>
  <span m='4497920'>sort</span> <span m='4498610'>x</span> <span m='4499060'>items.</span>
  <span m='4500050'>So</span> <span m='4500200'>that</span> <span m='4501010'>costs</span>
  <span m='4501460'>x</span> <span m='4501760'>over</span> <span m='4501950'>B.</span>
  <span m='4502300'>It</span> <span m='4502650'>has</span> <span m='4502840'>log</span>
  <span m='4502990'>base</span> <span m='4503160'>M</span> <span m='4503320'>over</span>
  <span m='4503500'>B</span> <span m='4503650'>of</span> <span m='4503770'>x</span>
  <span m='4503950'>over</span> <span m='4504130'>B.</span> <span m='4504640'>And</span>
  <span m='4504790'>the</span> <span m='4504880'>whole</span> <span m='4505090'>point</span>
  <span m='4505330'>of</span> <span m='4505390'>the</span> <span m='4505510'>analysis</span>
  <span m='4506050'>is</span> <span m='4506200'>to</span> <span m='4506320'>show</span>
  <span m='4507130'>that</span> <span m='4507640'>this</span> <span m='4507940'>distribution</span>
  <span m='4508480'>step</span> <span m='4508780'>doesn't</span> <span m='4509050'>cost</span>
  <span m='4509380'>any</span> <span m='4509560'>more</span> <span m='4510310'>than</span>
  <span m='4510430'>the</span> <span m='4510520'>sorting</span> <span m='4510850'>step.</span>
  <span m='4514180'>So</span> <span m='4516220'>let's</span> <span m='4516400'>prove</span>
  <span m='4516700'>this</span> <span m='4516880'>claim.</span> </p><p><span m='4519220'>And</span>
  <span m='4521380'>the</span> <span m='4521500'>first</span> <span m='4521860'>observation--</span>
  <span m='4522470'>maybe,</span> <span m='4523120'>don't</span> <span m='4523300'>even</span>
  <span m='4524110'>need</span> <span m='4524230'>to</span> <span m='4524320'>write</span>
  <span m='4524470'>this</span> <span m='4524620'>down.</span> <span m='4524830'>So</span>
  <span m='4525510'>remember,</span> <span m='4525820'>with</span> <span m='4526390'>cache-oblivious</span>
  <span m='4526960'>b-trees,</span> <span m='4527410'>we</span> <span m='4527500'>looked</span>
  <span m='4527770'>at</span> <span m='4527850'>a</span> <span m='4527920'>level</span>
  <span m='4528190'>of</span> <span m='4528310'>detail</span> <span m='4528730'>that</span>
  <span m='4528850'>was</span> <span m='4528940'>sort</span> <span m='4529060'>of</span>
  <span m='4529120'>the</span> <span m='4529240'>relevant</span> <span m='4529660'>one</span>
  <span m='4529810'>that</span> <span m='4529960'>straddled</span> <span m='4530590'>B.</span>
  <span m='4531700'>Now</span> <span m='4531880'>we</span> <span m='4531970'>have</span>
  <span m='4532150'>this</span> <span m='4532300'>data</span> <span m='4532540'>structure</span>
  <span m='4533830'>and</span> <span m='4534010'>there's</span> <span m='4534130'>no</span>
  <span m='4534280'>longer</span> <span m='4534580'>recursive</span> <span m='4535300'>levels</span>
  <span m='4535750'>in</span> <span m='4535870'>this</span> <span m='4536020'>picture.</span>
  <span m='4536800'>It's</span> <span m='4536890'>just</span> <span m='4537070'>a</span>
  <span m='4537130'>list.</span> <span m='4538670'>But</span> <span m='4538720'>one</span>
  <span m='4538870'>of</span> <span m='4538930'>the</span> <span m='4538990'>things</span>
  <span m='4539230'>we</span> <span m='4539320'>said</span> <span m='4539500'>is</span>
  <span m='4539620'>that</span> <span m='4539800'>if</span> <span m='4540040'>you</span>
  <span m='4540130'>look</span> <span m='4540310'>at</span> <span m='4540400'>the</span>
  <span m='4540490'>very</span> <span m='4540700'>small</span> <span m='4541090'>structures,</span>
  <span m='4541570'>those</span> <span m='4541750'>are</span> <span m='4541840'>free</span>
  <span m='4542200'>because</span> <span m='4542380'>they</span> <span m='4542530'>just</span>
  <span m='4542680'>stay</span> <span m='4542890'>in</span> <span m='4543020'>cache.</span>
  </p><p><span m='4544120'>I'm</span> <span m='4544240'>going</span> <span m='4544480'>to</span>
  <span m='4544600'>assume--</span> <span m='4545140'>it's</span> <span m='4545260'>a</span>
  <span m='4545350'>little</span> <span m='4545620'>bit</span> <span m='4545740'>of</span>
  <span m='4545920'>a</span> <span m='4546130'>bastardization</span> <span m='4546880'>of</span>
  <span m='4546970'>notation--</span> <span m='4547780'>assume</span> <span m='4548080'>that</span>
  <span m='4548230'>all</span> <span m='4548530'>the</span> <span m='4548620'>levels</span>
  <span m='4549040'>up</span> <span m='4549220'>to</span> <span m='4549460'>M</span>
  <span m='4550570'>fit</span> <span m='4550900'>in</span> <span m='4551080'>cache.</span>
  <span m='4552310'>It's</span> <span m='4552490'>really</span> <span m='4552790'>up</span>
  <span m='4552940'>to,</span> <span m='4553060'>like,</span> <span m='4553220'>size</span>
  <span m='4553480'>M</span> <span m='4553690'>over</span> <span m='4553930'>2</span>
  <span m='4554290'>or</span> <span m='4554380'>something,</span> <span m='4554800'>but</span>
  <span m='4554890'>let's</span> <span m='4555040'>just</span> <span m='4555190'>call</span>
  <span m='4555430'>it</span> <span m='4555490'>all.</span> <span m='4556090'>If</span>
  <span m='4556300'>x</span> <span m='4556600'>is</span> <span m='4556720'>less</span>
  <span m='4556960'>than</span> <span m='4557140'>M,</span> <span m='4558010'>then</span>
  <span m='4558340'>you</span> <span m='4558460'>know</span> <span m='4558550'>all</span>
  <span m='4558760'>this</span> <span m='4558910'>stuff</span> <span m='4559240'>has</span>
  <span m='4559390'>size</span> <span m='4559750'>order</span> <span m='4560050'>M.</span>
  <span m='4560470'>And</span> <span m='4560560'>so</span> <span m='4560840'>let's
  just</span> <span m='4560980'>say--</span> <span m='4561610'>by</span> <span m='4561820'>redefining</span>
  <span m='4562630'>what</span> <span m='4562780'>M</span> <span m='4562960'>is</span>
  <span m='4563110'>by</span> <span m='4563260'>a</span> <span m='4563290'>constant</span>
  <span m='4563620'>factor--</span> <span m='4564400'>that</span> <span m='4564610'>just</span>
  <span m='4564790'>fits</span> <span m='4565090'>in</span> <span m='4565180'>cache.</span>
  <span m='4566260'>Because</span> <span m='4566470'>we</span> <span m='4566560'>can</span>
  <span m='4566710'>assume</span> <span m='4567010'>whatever</span> <span m='4567520'>cache</span>
  <span m='4567820'>replacement</span> <span m='4568210'>strategy</span> <span m='4568600'>we</span>
  <span m='4568690'>want,</span> <span m='4569380'>assume</span> <span m='4569680'>that</span>
  <span m='4569800'>these</span> <span m='4569980'>things</span> <span m='4571090'>stay</span>
  <span m='4571360'>in</span> <span m='4571450'>cache</span> <span m='4571720'>forever.</span>
  </p><p><span m='4573530'>So</span> <span m='4573670'>all</span> <span m='4573970'>of</span>
  <span m='4574210'>that</span> <span m='4574360'>bottom</span> <span m='4574750'>stuff,</span>
  <span m='4576010'>size</span> <span m='4576480'>up</span> <span m='4576670'>to</span>
  <span m='4576760'>M,</span> <span m='4580600'>is</span> <span m='4580720'>permanently</span>
  <span m='4581170'>in</span> <span m='4581260'>cache</span> <span m='4581620'>and</span>
  <span m='4581740'>costs</span> <span m='4582040'>zero</span> <span m='4582430'>to</span>
  <span m='4582550'>access.</span> <span m='4583930'>So</span> <span m='4584080'>those</span>
  <span m='4584290'>levels</span> <span m='4584650'>are</span> <span m='4584740'>for</span>
  <span m='4584890'>free.</span> <span m='4585790'>So</span> <span m='4585880'>it's</span>
  <span m='4585970'>all</span> <span m='4586150'>about</span> <span m='4586420'>when</span>
  <span m='4586600'>we</span> <span m='4586690'>touch</span> <span m='4586960'>the</span>
  <span m='4587110'>upper</span> <span m='4587350'>levels.</span> <span m='4588760'>And,</span>
  <span m='4589000'>really,</span> <span m='4589330'>the</span> <span m='4589480'>most</span>
  <span m='4589780'>important</span> <span m='4590080'>level would</span> <span m='4590410'>be</span>
  <span m='4590590'>the</span> <span m='4590710'>transition</span> <span m='4591340'>from</span>
  <span m='4591670'>the</span> <span m='4591790'>things</span> <span m='4592060'>that</span>
  <span m='4592180'>fit</span> <span m='4592420'>in</span> <span m='4592510'>cache</span>
  <span m='4593230'>to</span> <span m='4593350'>the</span> <span m='4593470'>next</span>
  <span m='4593710'>level</span> <span m='4593950'>up</span> <span m='4594100'>that</span>
  <span m='4594250'>does</span> <span m='4594400'>not</span> <span m='4594610'>fit</span>
  <span m='4594790'>in</span> <span m='4594910'>cache.</span> <span m='4595270'>That's</span>
  <span m='4595450'>going</span> <span m='4595600'>to</span> <span m='4595660'>be</span>
  <span m='4595750'>the</span> <span m='4595840'>key</span> <span m='4596020'>level.</span>
  </p><p><span m='4596920'>But</span> <span m='4597310'>in</span> <span m='4597460'>general,</span>
  <span m='4598600'>let's</span> <span m='4601030'>look</span> <span m='4601330'>at</span>
  <span m='4602740'>push.</span> <span m='4604020'>Or</span> <span m='4604210'>let's</span>
  <span m='4604420'>just</span> <span m='4608200'>assume</span> <span m='4613000'>x</span>
  <span m='4613240'>to</span> <span m='4613360'>the</span> <span m='4613480'>3/2</span>
  <span m='4614740'>is</span> <span m='4614890'>bigger</span> <span m='4615250'>than</span>
  <span m='4615510'>M.</span> <span m='4617500'>Because</span> <span m='4617680'>we're</span>
  <span m='4617770'>looking</span> <span m='4618010'>at</span> <span m='4618070'>a</span>
  <span m='4618130'>push</span> <span m='4618430'>at</span> <span m='4618490'>level</span>
  <span m='4618760'>x to</span> <span m='4619045'>the 3/2.</span> <span m='4620530'>And</span>
  <span m='4621340'>just</span> <span m='4621580'>by</span> <span m='4621940'>definition,</span>
  <span m='4622600'>if</span> <span m='4622720'>it's</span> <span m='4623050'>less</span>
  <span m='4623470'>than</span> <span m='4623650'>M,</span> <span m='4624040'>it's</span>
  <span m='4624190'>free.</span> <span m='4624970'>Question?</span> </p><p><span m='4626701'>AUDIENCE:</span>
  <span m='4626820'>So</span> <span m='4626939'>how</span> <span m='4627058'>can</span>
  <span m='4627178'>you assume</span> <span m='4627655'>that</span> <span m='4628609'>all
  of the things</span> <span m='4629086'>below</span> <span m='4629563'>that</span>
  <span m='4630517'>particular</span> <span m='4630994'>size</span> <span m='4631471'>always
  stay</span> <span m='4631948'>in cache</span> <span m='4632425'>empty?</span> <span
  m='4632902'>So you're</span> <span m='4633379'>making assumptions</span> <span m='4633856'>on
  the</span> <span m='4635020'>cache</span> <span m='4635320'>replacement?</span>
  </p><p><span m='4635630'>ERIK DEMAINE:</span> <span m='4635735'>I'm</span> <span
  m='4635840'>making</span> <span m='4636130'>assumption</span> <span m='4636520'>on</span>
  <span m='4636610'>the</span> <span m='4636730'>cache</span> <span m='4637180'>replacement</span>
  <span m='4637660'>strategy,</span> <span m='4638020'>which I</span> <span m='4638200'>actually</span>
  <span m='4638500'>made</span> <span m='4638690'>last</span> <span m='4638950'>lecture.</span>
  <span m='4639940'>So</span> <span m='4640720'>I</span> <span m='4640840'>said,</span>
  <span m='4641260'>magically</span> <span m='4641770'>assume</span> <span m='4642610'>that</span>
  <span m='4642760'>we</span> <span m='4642850'>use</span> <span m='4643090'>optimal</span>
  <span m='4643660'>cache</span> <span m='4643930'>replacement.</span> <span m='4645640'>So</span>
  <span m='4645880'>whatever</span> <span m='4646360'>I</span> <span m='4646540'>choose,</span>
  <span m='4647320'>opt</span> <span m='4647570'>is</span> <span m='4647650'>going</span>
  <span m='4647780'>to</span> <span m='4647860'>be</span> <span m='4647980'>better</span>
  <span m='4648220'>than</span> <span m='4648370'>that.</span> <span m='4649820'>So</span>
  <span m='4650350'>you're</span> <span m='4650530'>right.</span> <span m='4650740'>The</span>
  <span m='4650860'>algorithm</span> <span m='4651250'>doesn't</span> <span m='4651490'>get</span>
  <span m='4651610'>to</span> <span m='4651700'>choose</span> <span m='4651910'>what</span>
  <span m='4652030'>stays</span> <span m='4652300'>in</span> <span m='4652390'>cache.</span>
  </p><p><span m='4653320'>But</span> <span m='4653590'>for</span> <span m='4653800'>analysis</span>
  <span m='4654310'>purposes,</span> <span m='4654760'>I</span> <span m='4654820'>can</span>
  <span m='4654940'>say</span> <span m='4655120'>well,</span> <span m='4655240'>suppose</span>
  <span m='4655660'>all</span> <span m='4655780'>these</span> <span m='4655930'>things</span>
  <span m='4656110'>stay</span> <span m='4656260'>in</span> <span m='4656320'>cache.</span>
  <span m='4656650'>If</span> <span m='4656740'>I</span> <span m='4656830'>prove</span>
  <span m='4657010'>an</span> <span m='4657160'>upper</span> <span m='4657430'>bound</span>
  <span m='4657790'>in</span> <span m='4657970'>that</span> <span m='4658810'>world,</span>
  <span m='4659440'>then</span> <span m='4659650'>the</span> <span m='4659740'>optimal</span>
  <span m='4660130'>replacement</span> <span m='4660520'>will</span> <span m='4660610'>do</span>
  <span m='4661720'>better.</span> <span m='4662790'>And</span> <span m='4663880'>the</span>
  <span m='4664660'>LRU</span> <span m='4665250'>or</span> <span m='4665350'>FIFO</span>
  <span m='4665770'>replacement</span> <span m='4666730'>will</span> <span m='4666850'>do</span>
  <span m='4667090'>within</span> <span m='4667330'>a</span> <span m='4667390'>constant</span>
  <span m='4667720'>factor</span> <span m='4667990'>of</span> <span m='4668050'>that,</span>
  <span m='4669940'>again,</span> <span m='4670480'>by</span> <span m='4670600'>changing
  M</span> <span m='4671020'>by</span> <span m='4671350'>a</span> <span m='4671380'>constant</span>
  <span m='4671710'>factor.</span> <span m='4672280'>So I'm</span> <span m='4672730'>freely</span>
  <span m='4673210'>throwing</span> <span m='4673480'>away</span> <span m='4673660'>constant</span>
  <span m='4673990'>factors</span> <span m='4674320'>in</span> <span m='4674410'>my</span>
  <span m='4674530'>cache</span> <span m='4674830'>size,</span> <span m='4675670'>but</span>
  <span m='4675820'>then</span> <span m='4676300'>I</span> <span m='4676450'>will</span>
  <span m='4676570'>get</span> <span m='4676830'>that</span> <span m='4676930'>these</span>
  <span m='4677550'>effectively</span> <span m='4678080'>stay</span> <span m='4678270'>in</span>
  <span m='4678400'>cache.</span> <span m='4678960'>FIFO</span> <span m='4679310'>or</span>
  <span m='4679510'>LRU</span> <span m='4679930'>will</span> <span m='4680050'>do</span>
  <span m='4680200'>that</span> <span m='4680380'>just</span> <span m='4680620'>as</span>
  <span m='4680710'>well,</span> <span m='4681830'>or</span> <span m='4682300'>almost</span>
  <span m='4682720'>as</span> <span m='4682840'>well.</span> <span m='4684010'>Good</span>
  <span m='4684190'>question.</span> </p><p><span m='4685740'>So</span> <span m='4685930'>now</span>
  <span m='4686110'>we</span> <span m='4686230'>can</span> <span m='4686380'>just</span>
  <span m='4686530'>look</span> <span m='4686710'>at</span> <span m='4686770'>the</span>
  <span m='4686860'>pushes</span> <span m='4687190'>above</span> <span m='4687520'>that</span>
  <span m='4687700'>level.</span> <span m='4688580'>And</span> <span m='4688630'>I</span>
  <span m='4688690'>really</span> <span m='4688990'>want</span> <span m='4689110'>to</span>
  <span m='4689170'>look</span> <span m='4689320'>at</span> <span m='4689380'>this</span>
  <span m='4689710'>transition</span> <span m='4690220'>level,</span> <span m='4690590'>but</span>
  <span m='4690670'>we're</span> <span m='4690760'>going</span> <span m='4690880'>to</span>
  <span m='4690940'>have</span> <span m='4691030'>to</span> <span m='4691090'>look</span>
  <span m='4691240'>at</span> <span m='4691300'>all</span> <span m='4691480'>of</span>
  <span m='4691570'>them.</span> <span m='4691850'>So</span> <span m='4692710'>let's</span>
  <span m='4692860'>do</span> <span m='4692980'>this.</span> <span m='4693500'>Now</span>
  <span m='4694030'>I</span> <span m='4694540'>also</span> <span m='4694960'>have</span>
  <span m='4697160'>tall</span> <span m='4697540'>cache</span> <span m='4697930'>assumption.</span>
  <span m='4699850'>M</span> <span m='4700110'>is</span> <span m='4700240'>at</span>
  <span m='4700330'>least</span> <span m='4700690'>B</span> <span m='4700850'>to</span>
  <span m='4701000'>the</span> <span m='4701110'>1</span> <span m='4701260'>plus</span>
  <span m='4701500'>epsilon.</span> </p><p><span m='4702460'>I</span> <span m='4702550'>actually</span>
  <span m='4702910'>want</span> <span m='4703390'>a</span> <span m='4703840'>somewhat</span>
  <span m='4704170'>bigger</span> <span m='4704590'>assumption,</span> <span m='4705170'>which</span>
  <span m='4705250'>is</span> <span m='4705370'>that</span> <span m='4705520'>M</span>
  <span m='4705910'>is</span> <span m='4706180'>greater</span> <span m='4706510'>than</span>
  <span m='4706630'>or</span> <span m='4706660'>equal</span> <span m='4706960'>to</span>
  <span m='4707140'>B</span> <span m='4707380'>squared.</span> <span m='4709120'>If</span>
  <span m='4709270'>it's</span> <span m='4709420'>not</span> <span m='4709690'>B</span>
  <span m='4709870'>squared,</span> <span m='4711010'>you</span> <span m='4711160'>have</span>
  <span m='4711250'>to</span> <span m='4711340'>change</span> <span m='4711940'>this</span>
  <span m='4712270'>3/2</span> <span m='4713020'>and</span> <span m='4713140'>9/4</span>
  <span m='4713740'>and</span> <span m='4713830'>stuff</span> <span m='4714580'>to</span>
  <span m='4714700'>be</span> <span m='4714850'>something</span> <span m='4715210'>a</span>
  <span m='4715270'>little</span> <span m='4715570'>bit</span> <span m='4715780'>bigger</span>
  <span m='4716020'>than</span> <span m='4716190'>1.</span> <span m='4716860'>And</span>
  <span m='4717040'>it</span> <span m='4717100'>gets</span> <span m='4717250'>really</span>
  <span m='4717460'>messy</span> <span m='4717760'>to</span> <span m='4717850'>write</span>
  <span m='4718030'>that</span> <span m='4718210'>down.</span> <span m='4718700'>So</span>
  <span m='4719770'>this</span> <span m='4719950'>data</span> <span m='4720160'>structure</span>
  <span m='4720520'>with</span> <span m='4720700'>appropriate</span> <span m='4721120'>modification</span>
  <span m='4721720'>does</span> <span m='4721900'>work</span> <span m='4722110'>for</span>
  <span m='4722230'>other tall</span> <span m='4722620'>cache</span> <span m='4722950'>assumptions,</span>
  <span m='4723370'>but</span> <span m='4723490'>let's</span> <span m='4723640'>just</span>
  <span m='4723820'>assume</span> <span m='4724090'>this</span> <span m='4724270'>one.</span>
  <span m='4724780'>So</span> <span m='4725080'>this</span> <span m='4725230'>means</span>
  <span m='4725560'>M over</span> <span m='4725830'>B</span> <span m='4726070'>is</span>
  <span m='4726190'>at</span> <span m='4726280'>least</span> <span m='4726490'>B.</span>
  <span m='4727560'>That's</span> <span m='4727750'>sort</span> <span m='4727900'>of</span>
  <span m='4727990'>the</span> <span m='4728080'>clean</span> <span m='4729280'>statement.</span>
  <span m='4729940'>It's</span> <span m='4730150'>true</span> <span m='4730330'>for</span>
  <span m='4730480'>most</span> <span m='4730660'>caches</span> <span m='4731080'>also,</span>
  <span m='4731410'>but</span> <span m='4734200'>this</span> <span m='4734410'>will</span>
  <span m='4734500'>be</span> <span m='4734620'>my</span> <span m='4734770'>assumption.</span>
  </p><p><span m='4736330'>OK.</span> <span m='4737640'>Cool.</span> <span m='4738190'>So</span>
  <span m='4738550'>if</span> <span m='4738790'>we</span> <span m='4738910'>just</span>
  <span m='4739120'>do</span> <span m='4739360'>some</span> <span m='4740560'>algebra.</span>
  <span m='4743050'>Claim</span> <span m='4743430'>is</span> <span m='4743680'>this</span>
  <span m='4743890'>is</span> <span m='4744700'>x</span> <span m='4745030'>is</span>
  <span m='4745150'>greater</span> <span m='4745510'>than</span> <span m='4745840'>B</span>
  <span m='4746140'>to</span> <span m='4746290'>the</span> <span m='4746440'>4/3.</span>
  <span m='4748370'>So</span> <span m='4748450'>that's</span> <span m='4748660'>just</span>
  <span m='4748840'>taking</span> <span m='4749860'>this</span> <span m='4750700'>inequality,</span>
  <span m='4751930'>x</span> <span m='4752420'>the</span> <span m='4752530'>3/2</span>
  <span m='4752950'>is</span> <span m='4753070'>greater</span> <span m='4753280'>than</span>
  <span m='4753400'>or</span> <span m='4753460'>equal</span> <span m='4753670'>to</span>
  <span m='4753730'>B</span> <span m='4753910'>squared</span> <span m='4754420'>and</span>
  <span m='4754900'>raising</span> <span m='4755155'>to</span> <span m='4755410'>the</span>
  <span m='4755470'>exponent,</span> <span m='4755920'>2/3.</span> <span m='4756670'>And</span>
  <span m='4756760'>so</span> <span m='4757000'>this</span> <span m='4757270'>turns</span>
  <span m='4757510'>into</span> <span m='4757680'>x</span> <span m='4758440'>and</span>
  <span m='4758560'>this</span> <span m='4758680'>turns</span> <span m='4758950'>into
  B</span> <span m='4759160'>to</span> <span m='4759490'>the</span> <span m='4759640'>2</span>
  <span m='4759850'>times</span> <span m='4760120'>2/3,</span> <span m='4760550'>which</span>
  <span m='4760600'>would</span> <span m='4760750'>be</span> <span m='4760930'>the</span>
  <span m='4761050'>4/3.</span> <span m='4761570'>So</span> <span m='4761800'>x</span>
  <span m='4762550'>is</span> <span m='4762940'>quite</span> <span m='4763210'>a</span>
  <span m='4763270'>bit</span> <span m='4763390'>bigger</span> <span m='4763630'>than</span>
  <span m='4763810'>B.</span> </p><p><span m='4766120'>In</span> <span m='4766270'>particular,</span>
  <span m='4767000'>this</span> <span m='4767110'>means</span> <span m='4767410'>that</span>
  <span m='4768040'>x</span> <span m='4768310'>over</span> <span m='4768640'>B</span>
  <span m='4769390'>is</span> <span m='4769570'>bigger</span> <span m='4769810'>than</span>
  <span m='4769960'>1,</span> <span m='4770800'>by</span> <span m='4770980'>a</span>
  <span m='4771040'>lot.</span> <span m='4771460'>But</span> <span m='4772960'>if</span>
  <span m='4773170'>we</span> <span m='4773290'>take</span> <span m='4773440'>ceiling's</span>
  <span m='4773860'>on</span> <span m='4773950'>this,</span> <span m='4774220'>no</span>
  <span m='4774370'>big</span> <span m='4774520'>deal.</span> <span m='4775120'>So</span>
  <span m='4775420'>we</span> <span m='4775510'>don't</span> <span m='4775600'>have</span>
  <span m='4775690'>to</span> <span m='4775780'>worry</span> <span m='4775930'>about</span>
  <span m='4776110'>the</span> <span m='4776170'>ceilings.</span> </p><p><span m='4777790'>All</span>
  <span m='4777880'>right.</span> <span m='4778250'>Now</span> <span m='4778970'>the</span>
  <span m='4779060'>claim</span> <span m='4779420'>is</span> <span m='4780260'>that</span>
  <span m='4780440'>the</span> <span m='4780530'>distribution</span> <span m='4781260'>step</span>
  <span m='4783670'>costs--</span> <span m='4786380'>this</span> <span m='4786800'>is</span>
  <span m='4786950'>really</span> <span m='4787160'>the</span> <span m='4787310'>interesting</span>
  <span m='4787880'>part--</span> <span m='4788600'>x</span> <span m='4788840'>over</span>
  <span m='4789050'>B</span> <span m='4789800'>plus</span> <span m='4790790'>x</span>
  <span m='4791090'>to</span> <span m='4791240'>the</span> <span m='4791370'>1/2</span>
  <span m='4793018'>memory</span> <span m='4793430'>transfers.</span> <span m='4797060'>OK.</span>
  <span m='4798050'>Why?</span> </p><p><span m='4799730'>Remember,</span> <span m='4800270'>up</span>
  <span m='4800450'>here</span> <span m='4800660'>we</span> <span m='4800780'>have</span>
  <span m='4801200'>x</span> <span m='4801470'>to</span> <span m='4801690'>1/2</span>
  <span m='4802310'>down</span> <span m='4802670'>buffers</span> <span m='4803590'>that</span>
  <span m='4803760'>we're</span> <span m='4803960'>looking</span> <span m='4804320'>at.</span>
  <span m='4804800'>And</span> <span m='4804950'>we're</span> <span m='4805070'>visiting</span>
  <span m='4805430'>them</span> <span m='4805580'>in</span> <span m='4805670'>order.</span>
  <span m='4805940'>We</span> <span m='4806060'>touch</span> <span m='4806390'>this</span>
  <span m='4806570'>down</span> <span m='4806810'>buffer.</span> <span m='4808100'>And</span>
  <span m='4810020'>really,</span> <span m='4810290'>we</span> <span m='4810380'>just</span>
  <span m='4810530'>care</span> <span m='4810740'>about</span> <span m='4811010'>the</span>
  <span m='4811760'>max,</span> <span m='4812210'>here.</span> <span m='4812990'>And</span>
  <span m='4813170'>then</span> <span m='4813290'>we</span> <span m='4813410'>start</span>
  <span m='4813770'>writing</span> <span m='4814220'>elements</span> <span m='4814670'>one</span>
  <span m='4814880'>by</span> <span m='4815060'>one.</span> <span m='4815540'>But</span>
  <span m='4815660'>if</span> <span m='4815780'>we</span> <span m='4815840'>write</span>
  <span m='4816050'>elements</span> <span m='4816350'>one</span> <span m='4816500'>by</span>
  <span m='4816650'>one,</span> <span m='4817700'>the</span> <span m='4817850'>very</span>
  <span m='4818060'>first</span> <span m='4818450'>element</span> <span m='4818720'>we</span>
  <span m='4818840'>write</span> <span m='4819110'>costs an</span> <span m='4819560'>entire</span>
  <span m='4820130'>memory</span> <span m='4820400'>transfer.</span> <span m='4820730'>We</span>
  <span m='4820790'>have</span> <span m='4820910'>to</span> <span m='4821000'>load</span>
  <span m='4821240'>in</span> <span m='4821360'>a</span> <span m='4821390'>block.</span>
  <span m='4822300'>But</span> <span m='4822400'>then</span> <span m='4822410'>we</span>
  <span m='4822500'>can</span> <span m='4822620'>fill</span> <span m='4822920'>that</span>
  <span m='4823100'>block</span> <span m='4823490'>and</span> <span m='4823580'>then</span>
  <span m='4823760'>write</span> <span m='4824000'>out</span> <span m='4824150'>that</span>
  <span m='4824330'>block.</span> <span m='4825300'>So</span> <span m='4825350'>we</span>
  <span m='4825410'>get</span> <span m='4825530'>to</span> <span m='4825650'>write</span>
  <span m='4825860'>out</span> <span m='4826090'>B</span> <span m='4826280'>items</span>
  <span m='4826790'>in</span> <span m='4827000'>one</span> <span m='4827240'>step.</span>
  </p><p><span m='4828270'>So</span> <span m='4829220'>we</span> <span m='4829400'>pay</span>
  <span m='4829760'>x</span> <span m='4829980'>to</span> <span m='4830040'>the</span>
  <span m='4830180'>1/2</span> <span m='4830690'>because</span> <span m='4830960'>we</span>
  <span m='4831050'>have</span> <span m='4831140'>to</span> <span m='4831230'>touch</span>
  <span m='4831550'>the</span> <span m='4832190'>last</span> <span m='4832580'>block</span>
  <span m='4833090'>of</span> <span m='4835220'>this</span> <span m='4835460'>down</span>
  <span m='4835700'>buffer,</span> <span m='4836130'>this</span> <span m='4836210'>down</span>
  <span m='4836420'>buffer,</span> <span m='4836760'>this</span> <span m='4836810'>down</span>
  <span m='4837170'>buffer.</span> <span m='4837320'>And they're</span> <span m='4837640'>x</span>
  <span m='4837860'>to</span> <span m='4838010'>the</span> <span m='4838070'>1/2</span>
  <span m='4838520'>down</span> <span m='4838850'>buffers.</span> <span m='4839840'>So</span>
  <span m='4839960'>each</span> <span m='4840170'>one,</span> <span m='4840380'>we</span>
  <span m='4840470'>have</span> <span m='4840590'>to</span> <span m='4840650'>pay</span>
  <span m='4840950'>1.</span> <span m='4841400'>That's</span> <span m='4841670'>this</span>
  <span m='4841820'>part.</span> <span m='4842150'>That's the</span> <span m='4842390'>expensive</span>
  <span m='4842840'>part.</span> </p><p><span m='4843560'>But</span> <span m='4843680'>then,</span>
  <span m='4843860'>once</span> <span m='4844070'>we're</span> <span m='4844190'>actually</span>
  <span m='4844550'>writing</span> <span m='4844910'>items,</span> <span m='4845210'>if</span>
  <span m='4845330'>we</span> <span m='4845450'>stay</span> <span m='4845780'>here</span>
  <span m='4845960'>for</span> <span m='4846140'>a</span> <span m='4846200'>while,</span>
  <span m='4847100'>that's</span> <span m='4847310'>basically</span> <span m='4847670'>for</span>
  <span m='4847820'>free.</span> <span m='4848900'>Overall,</span> <span m='4849380'>we're</span>
  <span m='4849500'>writing</span> <span m='4849830'>x</span> <span m='4850100'>items.</span>
  <span m='4851000'>And</span> <span m='4851790'>so</span> <span m='4852040'>to</span>
  <span m='4852110'>write</span> <span m='4852350'>them</span> <span m='4852500'>all</span>
  <span m='4852800'>will</span> <span m='4852950'>only</span> <span m='4853160'>take</span>
  <span m='4853340'>x</span> <span m='4853550'>over</span> <span m='4853790'>B</span>
  <span m='4854480'>ceiling,</span> <span m='4855920'>sort</span> <span m='4856100'>of,</span>
  <span m='4856160'>over</span> <span m='4856430'>the</span> <span m='4856610'>entire</span>
  <span m='4857060'>summation.</span> <span m='4858290'>But</span> <span m='4858530'>we</span>
  <span m='4858710'>have</span> <span m='4858830'>to</span> <span m='4858950'>pay</span>
  <span m='4859220'>1</span> <span m='4859520'>to</span> <span m='4859640'>start</span>
  <span m='4860030'>out</span> <span m='4860240'>here,</span> <span m='4860630'>here,</span>
  <span m='4861110'>and</span> <span m='4861290'>here.</span> <span m='4862700'>So</span>
  <span m='4863600'>this</span> <span m='4863810'>is</span> <span m='4863960'>the</span>
  <span m='4864230'>real</span> <span m='4864560'>amount</span> <span m='4864770'>of</span>
  <span m='4864860'>time.</span> <span m='4865610'>And</span> <span m='4865760'>I</span>
  <span m='4865880'>want</span> <span m='4866060'>to</span> <span m='4866120'>amortize</span>
  <span m='4866630'>that,</span> <span m='4867200'>essentially.</span> </p><p><span
  m='4870800'>So</span> <span m='4872120'>there's</span> <span m='4872330'>two</span>
  <span m='4872480'>cases</span> <span m='4872870'>now.</span> <span m='4874610'>If</span>
  <span m='4876200'>x</span> <span m='4876470'>is</span> <span m='4876590'>greater</span>
  <span m='4876950'>than</span> <span m='4877070'>or</span> <span m='4877130'>equal</span>
  <span m='4877340'>to</span> <span m='4877430'>B</span> <span m='4877610'>squared,</span>
  <span m='4878810'>then</span> <span m='4878960'>we're</span> <span m='4879080'>happy.</span>
  <span m='4880490'>x</span> <span m='4880760'>is</span> <span m='4880850'>greater
  than</span> <span m='4881060'>or</span> <span m='4881120'>equal</span> <span m='4881300'>to</span>
  <span m='4881390'>B</span> <span m='4881540'>squared,</span> <span m='4883100'>then</span>
  <span m='4883580'>this</span> <span m='4883820'>term</span> <span m='4884930'>dominates.</span>
  <span m='4887510'>And</span> <span m='4887810'>so</span> <span m='4887960'>this</span>
  <span m='4888170'>is</span> <span m='4888290'>tinier.</span> <span m='4889550'>All</span>
  <span m='4889910'>right.</span> <span m='4890280'>Say,</span> <span m='4890540'>x</span>
  <span m='4890780'>is</span> <span m='4891140'>B</span> <span m='4891560'>cubed,</span>
  <span m='4892660'>then</span> <span m='4892880'>this</span> <span m='4893060'>is</span>
  <span m='4893180'>x</span> <span m='4893390'>to</span> <span m='4893510'>the</span>
  <span m='4893630'>3/2--</span> <span m='4895010'>sorry,</span> <span m='4895170'>this</span>
  <span m='4895290'>is</span> <span m='4895350'>the</span> <span m='4895400'>B</span>
  <span m='4895630'>to</span> <span m='4895700'>the</span> <span m='4895790'>3/2.</span>
  <span m='4896360'>This</span> <span m='4896570'>is</span> <span m='4896720'>B</span>
  <span m='4897050'>squared,</span> <span m='4897530'>so</span> <span m='4897680'>this</span>
  <span m='4897860'>is</span> <span m='4897950'>bigger.</span> </p><p><span m='4898880'>And</span>
  <span m='4898910'>so</span> <span m='4900320'>then</span> <span m='4900500'>the</span>
  <span m='4900620'>cost</span> <span m='4901040'>is</span> <span m='4901250'>just</span>
  <span m='4902000'>x</span> <span m='4902250'>over</span> <span m='4902620'>B.</span>
  <span m='4904610'>And</span> <span m='4904940'>we're</span> <span m='4905270'>done,</span>
  <span m='4905870'>because</span> <span m='4906230'>we</span> <span m='4906350'>needed</span>
  <span m='4906500'>to</span> <span m='4906590'>prove</span> <span m='4906800'>it's</span>
  <span m='4906950'>x</span> <span m='4907100'>over B</span> <span m='4907430'>times</span>
  <span m='4907640'>log.</span> <span m='4908080'>We</span> <span m='4908210'>had</span>
  <span m='4908300'>to</span> <span m='4908390'>do</span> <span m='4908480'>this</span>
  <span m='4908630'>to</span> <span m='4908750'>sort,</span> <span m='4909770'>but</span>
  <span m='4910100'>this</span> <span m='4910250'>distribution</span> <span m='4910700'>will</span>
  <span m='4910790'>be</span> <span m='4910910'>free.</span> <span m='4911690'>Now</span>
  <span m='4911840'>that</span> <span m='4912050'>says</span> <span m='4913070'>all</span>
  <span m='4913310'>the</span> <span m='4913400'>high</span> <span m='4913670'>levels</span>
  <span m='4914510'>are</span> <span m='4914600'>free.</span> <span m='4915740'>All</span>
  <span m='4915860'>the</span> <span m='4915980'>low</span> <span m='4916160'>levels</span>
  <span m='4916520'>are</span> <span m='4916580'>free.</span> <span m='4919910'>If</span>
  <span m='4920090'>you're</span> <span m='4920180'>less</span> <span m='4920330'>than</span>
  <span m='4920450'>B</span> <span m='4920570'>squared,</span> <span m='4920810'>then</span>
  <span m='4920960'>your</span> <span m='4921050'>less than</span> <span m='4921500'>M
  and</span> <span m='4921620'>you're</span> <span m='4921710'>free.</span> <span
  m='4922560'>It's</span> <span m='4922860'>saying,</span> <span m='4923130'>if</span>
  <span m='4923210'>you're</span> <span m='4923300'>bigger</span> <span m='4923540'>than</span>
  <span m='4923660'>B</span> <span m='4923780'>squared,</span> <span m='4924140'>you're</span>
  <span m='4924290'>free.</span> </p><p><span m='4924770'>But</span> <span m='4925010'>there's</span>
  <span m='4925160'>going</span> <span m='4925300'>to</span> <span m='4925370'>be</span>
  <span m='4925520'>one</span> <span m='4925880'>level</span> <span m='4926180'>right</span>
  <span m='4926420'>in</span> <span m='4926510'>between</span> <span m='4927470'>where</span>
  <span m='4927710'>you're</span> <span m='4928070'>not</span> <span m='4928370'>really</span>
  <span m='4928670'>bigger</span> <span m='4929030'>or</span> <span m='4929150'>smaller.</span>
  <span m='4933100'>So</span> <span m='4933260'>there's</span> <span m='4933470'>one</span>
  <span m='4933770'>level</span> <span m='4934910'>where</span> <span m='4937850'>it's</span>
  <span m='4937940'>going</span> <span m='4938090'>to</span> <span m='4938180'>B</span>
  <span m='4938360'>to the</span> <span m='4938800'>4/3</span> <span m='4940370'>less</span>
  <span m='4940670'>than or equal</span> <span m='4940970'>to</span> <span m='4941090'>x</span>
  <span m='4941660'>less</span> <span m='4941990'>than</span> <span m='4942110'>or</span>
  <span m='4942200'>equal</span> <span m='4942410'>to</span> <span m='4942530'>B</span>
  <span m='4942860'>squared,</span> <span m='4943850'>strictly</span> <span m='4944300'>less</span>
  <span m='4944600'>than.</span> <span m='4945860'>Because</span> <span m='4946100'>you're</span>
  <span m='4946290'>jumping</span> <span m='4947030'>in</span> <span m='4947160'>this</span>
  <span m='4947690'>doubly</span> <span m='4948020'>exponential</span> <span m='4948500'>way,</span>
  <span m='4949280'>you</span> <span m='4949640'>might</span> <span m='4949880'>miss</span>
  <span m='4950120'>slightly.</span> <span m='4951180'>And</span> <span m='4951200'>so</span>
  <span m='4951320'>you're</span> <span m='4951500'>in</span> <span m='4951650'>between</span>
  <span m='4952700'>these</span> <span m='4952880'>two</span> <span m='4953030'>levels.</span>
  </p><p><span m='4956920'>Why</span> <span m='4957140'>is</span> <span m='4957260'>this?</span>
  <span m='4957440'>Because</span> <span m='4958070'>we</span> <span m='4958250'>only</span>
  <span m='4958460'>know</span> <span m='4958580'>that</span> <span m='4958730'>x</span>
  <span m='4959000'>to</span> <span m='4959120'>the</span> <span m='4959270'>3/2</span>
  <span m='4959960'>is</span> <span m='4960080'>less</span> <span m='4960290'>than</span>
  <span m='4960400'>M.</span> <span m='4960530'>We</span> <span m='4960650'>don't</span>
  <span m='4960770'>know</span> <span m='4960890'>that</span> <span m='4961040'>x</span>
  <span m='4963260'>is</span> <span m='4963410'>less</span> <span m='4963620'>than</span>
  <span m='4963720'>M.</span> <span m='4964400'>So</span> <span m='4965240'>we</span>
  <span m='4965300'>have</span> <span m='4965480'>a</span> <span m='4965540'>bit</span>
  <span m='4965660'>of</span> <span m='4965720'>slot</span> <span m='4966191'>there.</span>
  </p><p><span m='4972790'>So</span> <span m='4973030'>then</span> <span m='4976540'>at</span>
  <span m='4976720'>this</span> <span m='4976960'>transition</span> <span m='4977590'>point,</span>
  <span m='4979030'>what</span> <span m='4979210'>we</span> <span m='4979330'>do</span>
  <span m='4979720'>is</span> <span m='4979870'>say,</span> <span m='4980220'>OK,</span>
  <span m='4982630'>we</span> <span m='4982750'>can't</span> <span m='4983170'>afford</span>
  <span m='4983770'>to</span> <span m='4983950'>store</span> <span m='4984190'>this</span>
  <span m='4984400'>whole--</span> <span m='4984850'>x to</span> <span m='4985150'>3/2</span>
  <span m='4986140'>is</span> <span m='4986260'>not</span> <span m='4986440'>less</span>
  <span m='4986680'>than</span> <span m='4986800'>M.</span> <span m='4987110'>So</span>
  <span m='4987130'>we</span> <span m='4987220'>can't</span> <span m='4987460'>afford</span>
  <span m='4987760'>to</span> <span m='4987850'>store</span> <span m='4988120'>all</span>
  <span m='4988210'>this</span> <span m='4988420'>in</span> <span m='4988480'>the</span>
  <span m='4988610'>cache.</span> <span m='4989290'>But</span> <span m='4990130'>we</span>
  <span m='4990280'>can</span> <span m='4990580'>afford</span> <span m='4990910'>to</span>
  <span m='4991000'>store</span> <span m='4991240'>the</span> <span m='4991330'>last</span>
  <span m='4991780'>block</span> <span m='4992140'>of</span> <span m='4992230'>this</span>
  <span m='4992410'>guy</span> <span m='4993070'>and</span> <span m='4993190'>the</span>
  <span m='4993280'>last</span> <span m='4993580'>block</span> <span m='4993790'>of</span>
  <span m='4993850'>this</span> <span m='4993970'>guy,</span> <span m='4994120'>all</span>
  <span m='4994360'>the</span> <span m='4994450'>down</span> <span m='4994720'>buffers</span>
  <span m='4995020'>we</span> <span m='4995140'>can</span> <span m='4995260'>store</span>
  <span m='4995590'>the</span> <span m='4995680'>last</span> <span m='4996010'>block</span>
  <span m='4996460'>in</span> <span m='4996640'>cache.</span> </p><p><span m='4997450'>Why?</span>
  <span m='4999340'>Because</span> <span m='4999820'>there's</span> <span m='5000030'>only</span>
  <span m='5000640'>x</span> <span m='5000960'>to</span> <span m='5001250'>the</span>
  <span m='5001770'>1/2</span> <span m='5002520'>of</span> <span m='5002640'>them.</span>
  <span m='5005410'>And</span> <span m='5005730'>we</span> <span m='5005850'>know</span>
  <span m='5006000'>that</span> <span m='5006150'>x</span> <span m='5006480'>is</span>
  <span m='5006630'>less</span> <span m='5006870'>than</span> <span m='5007050'>B</span>
  <span m='5007200'>squared.</span> <span m='5008230'>So</span> <span m='5008330'>if</span>
  <span m='5008430'>x</span> <span m='5008520'>is</span> <span m='5008640'>less</span>
  <span m='5008800'>than</span> <span m='5008910'>B</span> <span m='5009090'>squared,</span>
  <span m='5010230'>x</span> <span m='5010440'>to</span> <span m='5010570'>the</span>
  <span m='5010680'>1/2</span> <span m='5012690'>is</span> <span m='5012900'>less</span>
  <span m='5013170'>than</span> <span m='5013350'>B,</span> <span m='5014310'>which</span>
  <span m='5014610'>is</span> <span m='5014940'>less</span> <span m='5015210'>than</span>
  <span m='5015390'>M</span> <span m='5015600'>over</span> <span m='5015810'>B</span>
  <span m='5016320'>because</span> <span m='5016740'>M</span> <span m='5017040'>is</span>
  <span m='5017100'>least</span> <span m='5017310'>B</span> <span m='5017490'>squared,</span>
  <span m='5018510'>by</span> <span m='5018650'>tall</span> <span m='5018870'>cache</span>
  <span m='5019170'>assumption.</span> <span m='5020560'>So</span> <span m='5020700'>this</span>
  <span m='5020970'>is</span> <span m='5021090'>the</span> <span m='5021180'>number</span>
  <span m='5021450'>of</span> <span m='5021510'>blocks</span> <span m='5021960'>that</span>
  <span m='5022050'>we</span> <span m='5022140'>can</span> <span m='5022290'>afford</span>
  <span m='5022740'>in</span> <span m='5022920'>cache.</span> <span m='5023700'>This</span>
  <span m='5023850'>is</span> <span m='5023880'>number of</span> <span m='5024120'>blocks</span>
  <span m='5024450'>we</span> <span m='5024570'>want.</span> <span m='5024880'>I</span>
  <span m='5024980'>want</span> <span m='5025170'>1</span> <span m='5025500'>block</span>
  <span m='5025830'>for</span> <span m='5025950'>each</span> <span m='5026160'>of</span>
  <span m='5026250'>these.</span> </p><p><span m='5027220'>So</span> <span m='5027240'>basically</span>
  <span m='5027780'>then,</span> <span m='5028530'>this</span> <span m='5028770'>x</span>
  <span m='5029060'>to</span> <span m='5029120'>the</span> <span m='5029190'>one</span>
  <span m='5029400'>half</span> <span m='5029610'>term</span> <span m='5030210'>disappears</span>
  <span m='5030930'>for</span> <span m='5031050'>the</span> <span m='5031170'>one</span>
  <span m='5031440'>transition</span> <span m='5031990'>level.</span> <span m='5033520'>So</span>
  <span m='5033620'>this</span> <span m='5033780'>is</span> <span m='5033930'>free.</span>
  <span m='5036380'>Because</span> <span m='5036870'>you</span> <span m='5036990'>can</span>
  <span m='5037110'>afford</span> <span m='5039150'>1</span> <span m='5039840'>block</span>
  <span m='5041520'>per</span> <span m='5041940'>down</span> <span m='5042330'>buffer</span>
  <span m='5048990'>in</span> <span m='5049140'>cache.</span> <span m='5051720'>And</span>
  <span m='5051870'>so,</span> <span m='5052140'>again,</span> <span m='5052560'>we</span>
  <span m='5052680'>get</span> <span m='5053250'>an</span> <span m='5053430'>x</span>
  <span m='5053670'>over</span> <span m='5053880'>B</span> <span m='5054060'>cost.</span>
  </p><p><span m='5056620'>So</span> <span m='5056700'>the</span> <span m='5056790'>distribution</span>
  <span m='5057330'>is</span> <span m='5057450'>basically</span> <span m='5057930'>free.</span>
  <span m='5059100'>The</span> <span m='5059190'>hard</span> <span m='5059400'>part</span>
  <span m='5059640'>is</span> <span m='5059800'>the</span> <span m='5059870'>sorting.</span>
  <span m='5061770'>And</span> <span m='5061950'>then</span> <span m='5062250'>the</span>
  <span m='5062400'>idea</span> <span m='5062730'>is</span> <span m='5062980'>that,</span>
  <span m='5063220'>well,</span> <span m='5063480'>OK--</span> <span m='5064200'>now</span>
  <span m='5064320'>this</span> <span m='5064500'>is</span> <span m='5064620'>one</span>
  <span m='5064890'>push.</span> <span m='5066360'>When</span> <span m='5066510'>we</span>
  <span m='5066600'>do</span> <span m='5066750'>an</span> <span m='5066840'>insert,</span>
  <span m='5067320'>that</span> <span m='5067530'>item</span> <span m='5067800'>might</span>
  <span m='5068010'>get</span> <span m='5068190'>pushed</span> <span m='5068490'>many</span>
  <span m='5068820'>times,</span> <span m='5069930'>but</span> <span m='5070110'>basically</span>
  <span m='5070590'>can</span> <span m='5070770'>only</span> <span m='5070980'>get</span>
  <span m='5071160'>pushed</span> <span m='5071550'>once</span> <span m='5071850'>per</span>
  <span m='5072060'>level.</span> <span m='5073200'>So</span> <span m='5073350'>you</span>
  <span m='5073440'>end</span> <span m='5073650'>up</span> <span m='5073740'>taking</span>
  <span m='5074280'>this</span> <span m='5074550'>cost</span> <span m='5075600'>and</span>
  <span m='5075750'>summing</span> <span m='5076260'>it</span> <span m='5076410'>over</span>
  <span m='5076680'>all</span> <span m='5076980'>x.</span> </p><p><span m='5077970'>So</span>
  <span m='5078060'>if</span> <span m='5078180'>you</span> <span m='5078270'>look</span>
  <span m='5078540'>at</span> <span m='5078840'>an</span> <span m='5078930'>insertion,</span>
  <span m='5080140'>amortize</span> <span m='5080880'>what</span> <span m='5081330'>you</span>
  <span m='5081720'>pay--</span> <span m='5082500'>or</span> <span m='5082960'>you</span>
  <span m='5083190'>look</span> <span m='5083370'>at</span> <span m='5083460'>the</span>
  <span m='5083610'>sum</span> <span m='5084090'>over</span> <span m='5084390'>all</span>
  <span m='5084540'>these</span> <span m='5084690'>things.</span> <span m='5088680'>You</span>
  <span m='5088830'>get</span> <span m='5089430'>the</span> <span m='5089520'>sorting</span>
  <span m='5089850'>bound</span> <span m='5090030'>on</span> <span m='5090170'>x--</span>
  <span m='5090630'>summed</span> <span m='5090970'>over</span> <span m='5091230'>x</span>
  <span m='5091770'>where</span> <span m='5091980'>x</span> <span m='5092310'>is</span>
  <span m='5092550'>growing</span> <span m='5092940'>doubly</span> <span m='5093300'>exponential.</span>
  <span m='5094470'>And</span> <span m='5094590'>so</span> <span m='5094710'>this</span>
  <span m='5094950'>becomes</span> <span m='5095370'>a</span> <span m='5095430'>geometric</span>
  <span m='5095910'>series,</span> <span m='5096480'>or</span> <span m='5096630'>even</span>
  <span m='5096900'>super</span> <span m='5097170'>geometric.</span> </p><p><span
  m='5098310'>And</span> <span m='5098400'>so</span> <span m='5098550'>you</span>
  <span m='5098700'>get--</span> <span m='5101190'>I</span> <span m='5101400'>guess</span>
  <span m='5101640'>I</span> <span m='5101700'>should</span> <span m='5102300'>look</span>
  <span m='5102570'>at</span> <span m='5102690'>it</span> <span m='5102810'>per</span>
  <span m='5103110'>element.</span> <span m='5103650'>You</span> <span m='5103710'>look</span>
  <span m='5103890'>at</span> <span m='5103950'>the</span> <span m='5104040'>amortized</span>
  <span m='5104520'>cost</span> <span m='5104790'>per</span> <span m='5104970'>element,</span>
  <span m='5106560'>so</span> <span m='5106710'>I</span> <span m='5106770'>get</span>
  <span m='5106890'>to</span> <span m='5107010'>divide</span> <span m='5107370'>by</span>
  <span m='5107560'>x.</span> <span m='5108780'>Because</span> <span m='5109020'>when</span>
  <span m='5109170'>I</span> <span m='5109230'>do</span> <span m='5109380'>a</span>
  <span m='5109440'>push,</span> <span m='5109740'>I</span> <span m='5109830'>push</span>
  <span m='5110070'>x elements.</span> <span m='5111290'>So</span> <span m='5111390'>I</span>
  <span m='5111450'>get</span> <span m='5111570'>to</span> <span m='5111660'>divide</span>
  <span m='5111900'>by</span> <span m='5112050'>x,</span> <span m='5112290'>here.</span>
  <span m='5112980'>And</span> <span m='5113100'>then</span> <span m='5113490'>if</span>
  <span m='5113730'>an</span> <span m='5113820'>element</span> <span m='5114090'>gets</span>
  <span m='5114270'>pushed</span> <span m='5114570'>to</span> <span m='5114630'>all</span>
  <span m='5114870'>levels,</span> <span m='5115450'>I</span> <span m='5115550'>have</span>
  <span m='5115560'>to</span> <span m='5115680'>sum</span> <span m='5115980'>over</span>
  <span m='5116220'>all</span> <span m='5116340'>these</span> <span m='5116490'>x's.</span>
  <span m='5117500'>But</span> <span m='5117610'>you</span> <span m='5117720'>do</span>
  <span m='5117870'>this</span> <span m='5118050'>summation</span> <span m='5118680'>and</span>
  <span m='5118800'>you</span> <span m='5118950'>get</span> <span m='5120060'>order--</span>
  <span m='5120920'>it's</span> <span m='5121170'>dominated</span> <span m='5121680'>by</span>
  <span m='5121950'>the</span> <span m='5122040'>last</span> <span m='5122370'>term.</span>
  <span m='5127360'>Sorry,</span> <span m='5127770'>this should</span> <span m='5128180'>be</span>
  <span m='5128360'>N.</span> </p><p><span m='5132330'>This</span> <span m='5132570'>is</span>
  <span m='5132690'>the</span> <span m='5132840'>fun</span> <span m='5133110'>part.</span>
  <span m='5133350'>We're</span> <span m='5133470'>taking</span> <span m='5133770'>logs,</span>
  <span m='5134220'>here,</span> <span m='5134820'>but</span> <span m='5134970'>conveniently</span>
  <span m='5135420'>this</span> <span m='5135630'>was</span> <span m='5135750'>doubly</span>
  <span m='5136140'>exponential</span> <span m='5137010'>growing,</span> <span m='5137430'>the</span>
  <span m='5137550'>x</span> <span m='5137790'>over</span> <span m='5138000'>B.</span>
  <span m='5138660'>So</span> <span m='5138810'>when</span> <span m='5138930'>we</span>
  <span m='5139050'>sum</span> <span m='5139290'>these</span> <span m='5139800'>is</span>
  <span m='5140490'>singly</span> <span m='5140940'>exponential.</span> <span m='5141900'>So
  it's</span> <span m='5142100'>a</span> <span m='5142140'>geometric</span> <span
  m='5142620'>series.</span> <span m='5144020'>And</span> <span m='5144060'>so</span>
  <span m='5144690'>we</span> <span m='5145160'>are</span> <span m='5145260'>just</span>
  <span m='5145470'>dominated</span> <span m='5145860'>by</span> <span m='5145980'>the</span>
  <span m='5146070'>last</span> <span m='5146340'>term,</span> <span m='5146640'>which</span>
  <span m='5146850'>is</span> <span m='5146940'>where</span> <span m='5147090'>we</span>
  <span m='5147180'>get</span> <span m='5147330'>log</span> <span m='5147690'>base
  M</span> <span m='5147900'>over B of</span> <span m='5148240'>N</span> <span m='5148420'>over</span>
  <span m='5148620'>B.</span> <span m='5148890'>And</span> <span m='5149010'>this</span>
  <span m='5149220'>is</span> <span m='5149400'>our</span> <span m='5149970'>amortized</span>
  <span m='5150480'>cost</span> <span m='5151410'>per</span> <span m='5151710'>insertion.</span>
  </p><p><span m='5154320'>Deletions</span> <span m='5154890'>are</span> <span m='5154950'>basically</span>
  <span m='5155340'>the</span> <span m='5155430'>same.</span> <span m='5156460'>You</span>
  <span m='5156570'>just</span> <span m='5156720'>two</span> <span m='5156840'>pulls</span>
  <span m='5157170'>instead</span> <span m='5157410'>of</span> <span m='5157470'>pushes.</span>
  <span m='5158460'>And</span> <span m='5158640'>you</span> <span m='5158730'>have,</span>
  <span m='5158880'>sort</span> <span m='5159090'>of,</span> <span m='5159180'>the</span>
  <span m='5159270'>reverse</span> <span m='5159750'>of</span> <span m='5159870'>a</span>
  <span m='5159930'>distribution</span> <span m='5160440'>step--</span> <span m='5160740'>in</span>
  <span m='5161100'>some</span> <span m='5161340'>ways,</span> <span m='5161640'>even</span>
  <span m='5161910'>simpler.</span> <span m='5162675'>You</span> <span m='5162960'>don't</span>
  <span m='5163170'>have</span> <span m='5163350'>to</span> <span m='5163470'>do</span>
  <span m='5163620'>this</span> <span m='5164340'>clever</span> <span m='5164640'>analysis.</span>
  <span m='5165980'>Question?</span> </p><p><span m='5166340'>AUDIENCE:</span> <span
  m='5166520'>Can</span> <span m='5166700'>you explain,</span> <span m='5167060'>once</span>
  <span m='5167517'>again,</span> <span m='5167974'>how is it that</span> <span m='5168431'>you
  got the</span> <span m='5168888'>distributed</span> <span m='5169345'>cost</span>
  <span m='5169802'>of</span> <span m='5170259'>x over B?</span> <span m='5171173'>So
  I</span> <span m='5171630'>understand</span> <span m='5171955'>that every</span>
  <span m='5172280'>time,</span> <span m='5172769'>you need to pay</span> <span m='5173258'>that
  x to the 1/2</span> <span m='5173747'>because</span> <span m='5174236'>you need
  to</span> <span m='5174725'>load.</span> <span m='5175703'>But where did the</span>
  <span m='5176192'>x over B</span> <span m='5176681'>come?</span> </p><p><span m='5177170'>ERIK
  DEMAINE:</span> <span m='5177295'>This</span> <span m='5177420'>is</span> <span
  m='5177480'>essentially</span> <span m='5177900'>amortized</span> <span m='5178560'>per</span>
  <span m='5178830'>element.</span> <span m='5179190'>We're</span> <span m='5179310'>just</span>
  <span m='5179460'>paying</span> <span m='5179730'>1</span> <span m='5179910'>over</span>
  <span m='5180090'>B.</span> <span m='5180390'>Once</span> <span m='5180690'>the</span>
  <span m='5181350'>block</span> <span m='5181650'>has</span> <span m='5181830'>been</span>
  <span m='5182040'>loaded--</span> <span m='5182580'>it's</span> <span m='5182730'>only</span>
  <span m='5182940'>after</span> <span m='5183180'>we</span> <span m='5183360'>insert</span>
  <span m='5183810'>B</span> <span m='5184050'>items</span> <span m='5184410'>that</span>
  <span m='5184500'>we</span> <span m='5184590'>have</span> <span m='5184770'>to</span>
  <span m='5184920'>load</span> <span m='5185160'>another</span> <span m='5185490'>item.</span>
  <span m='5186520'>So</span> <span m='5186570'>that's</span> <span m='5186810'>why</span>
  <span m='5187050'>it's</span> <span m='5187260'>x over</span> <span m='5187630'>B,</span>
  <span m='5188610'>here.</span> <span m='5189940'>Good.</span> <span m='5191130'>Question?</span>
  </p><p><span m='5191520'>AUDIENCE:</span> <span m='5191686'>Which</span> <span m='5191852'>buffers</span>
  <span m='5192020'>do we keep</span> <span m='5192520'>sorted at</span> <span m='5193020'>all
  times?</span> </p><p><span m='5194520'>ERIK DEMAINE:</span> <span m='5194650'>Which</span>
  <span m='5194780'>buffer--</span> </p><p><span m='5195530'>AUDIENCE:</span> <span
  m='5195612'>Which</span> <span m='5195694'>buffers</span> <span m='5195776'>do</span>
  <span m='5195858'>we</span> <span m='5195940'>keep sorted?</span> </p><p><span m='5196350'>ERIK
  DEMAINE:</span> <span m='5196455'>We're</span> <span m='5196560'>only</span> <span
  m='5196860'>going</span> <span m='5197010'>to</span> <span m='5197070'>keep</span>
  <span m='5197430'>the</span> <span m='5197580'>very</span> <span m='5198000'>bottom</span>
  <span m='5198390'>buffer</span> <span m='5198720'>sorted</span> <span m='5199080'>at</span>
  <span m='5199200'>all</span> <span m='5199350'>times.</span> <span m='5201610'>So</span>
  <span m='5201870'>I</span> <span m='5201930'>mean,</span> <span m='5202110'>it</span>
  <span m='5202200'>doesn't</span> <span m='5202380'>really</span> <span m='5202560'>matter.</span>
  <span m='5202830'>You</span> <span m='5202920'>don't</span> <span m='5203040'>even</span>
  <span m='5203220'>have</span> <span m='5203310'>to</span> <span m='5203370'>keep</span>
  <span m='5203550'>those</span> <span m='5203700'>sorted,</span> <span m='5203970'>because</span>
  <span m='5204150'>you</span> <span m='5204240'>can</span> <span m='5204360'>afford</span>
  <span m='5204600'>to</span> <span m='5204660'>look</span> <span m='5204840'>at</span>
  <span m='5204900'>all</span> <span m='5205120'>of</span> <span m='5205170'>them.</span>
  </p><p><span m='5205410'>AUDIENCE:</span> <span m='5205644'>[INAUDIBLE]</span> <span
  m='5205878'>I think</span> <span m='5206346'>the upper levels</span> <span m='5206814'>when
  we're</span> <span m='5207282'>trying to</span> <span m='5207750'>figure out</span>
  <span m='5208218'>where it</span> <span m='5208686'>goes?</span> </p><p><span m='5209160'>ERIK
  DEMAINE:</span> <span m='5209250'>What</span> <span m='5209340'>we</span> <span
  m='5209460'>do</span> <span m='5209640'>need--</span> <span m='5210060'>we</span>
  <span m='5210210'>don't</span> <span m='5210360'>need</span> <span m='5210480'>them</span>
  <span m='5210630'>in</span> <span m='5210750'>sorted</span> <span m='5211140'>order.</span>
  <span m='5211350'>But</span> <span m='5211530'>we</span> <span m='5212970'>need</span>
  <span m='5213090'>to</span> <span m='5213180'>know</span> <span m='5213270'>where</span>
  <span m='5213360'>the</span> <span m='5213480'>max</span> <span m='5213800'>is,</span>
  <span m='5214720'>yeah.</span> <span m='5215130'>So</span> <span m='5215430'>I</span>
  <span m='5215490'>guess,</span> <span m='5215700'>maybe,</span> <span m='5216000'>maintain</span>
  <span m='5216390'>a</span> <span m='5216450'>linked</span> <span m='5216720'>list</span>
  <span m='5217020'>of</span> <span m='5217110'>the</span> <span m='5217260'>items</span>
  <span m='5218520'>would</span> <span m='5218670'>be</span> <span m='5218790'>one</span>
  <span m='5218940'>way</span> <span m='5219060'>to</span> <span m='5219180'>do</span>
  <span m='5219330'>it.</span> <span m='5219640'>So</span> <span m='5219820'>the</span>
  <span m='5220270'>sort</span> <span m='5220530'>order</span> <span m='5220710'>is</span>
  <span m='5220800'>in</span> <span m='5220920'>there,</span> <span m='5221040'>but</span>
  <span m='5221160'>they're</span> <span m='5221250'>not</span> <span m='5221430'>physically</span>
  <span m='5221880'>stored</span> <span m='5222150'>in</span> <span m='5222240'>sorted</span>
  <span m='5222570'>order.</span> <span m='5222900'>That</span> <span m='5223020'>would</span>
  <span m='5223140'>be</span> <span m='5223230'>a</span> <span m='5223260'>little</span>
  <span m='5223470'>bit</span> <span m='5223590'>too</span> <span m='5223770'>much</span>
  <span m='5224010'>to</span> <span m='5224100'>hope</span> <span m='5224250'>for,</span>
  <span m='5224970'>I</span> <span m='5225000'>think.</span> <span m='5225960'>Yeah.</span>
  <span m='5226420'>We</span> <span m='5226560'>do</span> <span m='5226650'>need</span>
  <span m='5226800'>to</span> <span m='5226860'>keep</span> <span m='5227010'>track</span>
  <span m='5227250'>of</span> <span m='5227310'>the</span> <span m='5227400'>max,</span>
  <span m='5227730'>but</span> <span m='5227820'>that's</span> <span m='5228030'>easy</span>
  <span m='5228240'>to</span> <span m='5228360'>do</span> <span m='5228540'>as</span>
  <span m='5228690'>you're</span> <span m='5228810'>inserting.</span> <span m='5231110'>Cool.</span>
  </p><p><span m='5232680'>So</span> <span m='5232920'>that's</span> <span m='5233130'>priority</span>
  <span m='5233460'>queues.</span> <span m='5233790'>You</span> <span m='5233880'>can</span>
  <span m='5234000'>look</span> <span m='5234150'>at</span> <span m='5234220'>the
  notes</span> <span m='5234520'>for</span> <span m='5234820'>deletions.</span> </p>
type: course
uid: 4c9a2d83a6fe9e0bbecbd1597dc48960

---
None