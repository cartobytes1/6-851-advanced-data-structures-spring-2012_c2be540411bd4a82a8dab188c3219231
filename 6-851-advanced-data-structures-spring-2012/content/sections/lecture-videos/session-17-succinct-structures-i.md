---
about_this_resource_text: '<p><strong>Description:</strong> Succinct: Rank, select,
  tries.</p> <p><strong>Speaker:</strong> Prof. Erik Demaine</p>'
course_id: 6-851-advanced-data-structures-spring-2012
embedded_media:
- id: Video-YouTube-Stream
  media_location: 3Y2weLDiUWw
  parent_uid: cdfd82ac5a7d3a096bf1a1c8c982bfa2
  title: Video-YouTube-Stream
  type: Video
  uid: 333db41eacc459939f7568c6142c8d15
- id: Video-iTunesU-MP4
  media_location: https://itunes.apple.com/us/itunes-u/session-17-succinct-structures/id735348884?i=169611736
  parent_uid: cdfd82ac5a7d3a096bf1a1c8c982bfa2
  title: Video-iTunes U-MP4
  type: Video
  uid: d0fee0507550f399435baf0d4ebda859
- id: Video-InternetArchive-MP4
  media_location: http://www.archive.org/download/MIT6.851S12/MIT6_851S12_lec17_300k.mp4
  parent_uid: cdfd82ac5a7d3a096bf1a1c8c982bfa2
  title: Video-Internet Archive-MP4
  type: Video
  uid: 7bea8b2d833509e4be642ec3bbac01a3
- id: Thumbnail-YouTube-JPG
  media_location: https://img.youtube.com/vi/3Y2weLDiUWw/default.jpg
  parent_uid: cdfd82ac5a7d3a096bf1a1c8c982bfa2
  title: Thumbnail-YouTube-JPG
  type: Thumbnail
  uid: 481169aa5dbefc8bc3dab0307911b3b7
- id: 3Play-3PlayYouTubeid-MP4
  media_location: 3Y2weLDiUWw
  parent_uid: cdfd82ac5a7d3a096bf1a1c8c982bfa2
  title: 3Play-3Play YouTube id
  type: 3Play
  uid: 807b020601befd0e029cce00cb041bd2
- id: 3Y2weLDiUWw.srt
  parent_uid: cdfd82ac5a7d3a096bf1a1c8c982bfa2
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-851-advanced-data-structures-spring-2012/lecture-videos/session-17-succinct-structures-i/3Y2weLDiUWw.srt
  title: 3play caption file
  type: null
  uid: 39a21555236df9059c1d5c40dfab032d
- id: 3Y2weLDiUWw.pdf
  parent_uid: cdfd82ac5a7d3a096bf1a1c8c982bfa2
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-851-advanced-data-structures-spring-2012/lecture-videos/session-17-succinct-structures-i/3Y2weLDiUWw.pdf
  title: 3play pdf file
  type: null
  uid: 9280ffde99e5b6489b2eeb65cec376b8
- id: Caption-3Play YouTube id-SRT
  parent_uid: cdfd82ac5a7d3a096bf1a1c8c982bfa2
  title: Caption-3Play YouTube id-SRT-English - US
  type: Caption
  uid: fcb163a026622eaf81cb7694f593b408
- id: Transcript-3Play YouTube id-PDF
  parent_uid: cdfd82ac5a7d3a096bf1a1c8c982bfa2
  title: Transcript-3Play YouTube id-PDF-English - US
  type: Transcript
  uid: 617d3c2795f1a2e8a9ad0d59e5059e64
inline_embed_id: 7338425session17:succinctstructuresi67373613
layout: video
order_index: null
parent_uid: b66cbbb7b35e74ff17cdbf44e5fb6b1d
related_resources_text: ''
short_url: session-17-succinct-structures-i
technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-851-advanced-data-structures-spring-2012/lecture-videos/session-17-succinct-structures-i
template_type: Tabbed
title: 'Session 17: Succinct Structures I'
transcript: <p><span m='90'>The</span> <span m='180'>following</span> <span m='630'>content</span>
  <span m='1200'>is</span> <span m='1320'>provided</span> <span m='1770'>under</span>
  <span m='2009'>a</span> <span m='2070'>Creative</span> <span m='2490'>Commons</span>
  <span m='2910'>license.</span> <span m='4030'>Your</span> <span m='4200'>support</span>
  <span m='4710'>will</span> <span m='4860'>help</span> <span m='5100'>MIT</span>
  <span m='5550'>OpenCourseWare</span> <span m='6360'>continue</span> <span m='6870'>to</span>
  <span m='6960'>offer</span> <span m='7380'>high-quality</span> <span m='8100'>educational</span>
  <span m='8730'>resources</span> <span m='9330'>for</span> <span m='9510'>free.</span>
  <span m='10720'>To</span> <span m='10740'>make</span> <span m='10920'>a</span> <span
  m='10980'>donation</span> <span m='11730'>or</span> <span m='11940'>view</span>
  <span m='12390'>additional</span> <span m='12810'>materials</span> <span m='13320'>from</span>
  <span m='13500'>hundreds</span> <span m='13920'>of</span> <span m='14040'>MIT</span>
  <span m='14460'>courses,</span> <span m='15550'>visit</span> <span m='15780'>MIT</span>
  <span m='16200'>OpenCourseWare</span> <span m='17280'>at</span> <span m='17430'>osw.mit.edu.</span>
  </p><p><span m='21780'>ERIK DEMAINE:</span> <span m='21805'>All</span> <span m='21830'>right.</span>
  <span m='21930'>Today</span> <span m='22300'>we</span> <span m='22510'>start</span>
  <span m='22870'>a</span> <span m='23230'>new</span> <span m='23440'>section</span>
  <span m='23860'>of</span> <span m='23950'>data</span> <span m='24160'>structures.</span>
  <span m='24740'>This</span> <span m='24790'>is</span> <span m='24880'>going</span>
  <span m='25060'>to</span> <span m='25120'>be</span> <span m='25420'>two</span> <span
  m='25840'>lectures</span> <span m='26260'>long,</span> <span m='26500'>so</span>
  <span m='26620'>this</span> <span m='26830'>week</span> <span m='27530'>succinct</span>
  <span m='28240'>data</span> <span m='28510'>structures,</span> <span m='29080'>where</span>
  <span m='29470'>the</span> <span m='29620'>goal</span> <span m='30100'>is</span>
  <span m='30310'>to</span> <span m='30460'>get</span> <span m='31000'>really</span>
  <span m='31390'>small</span> <span m='31840'>space.</span> <span m='37810'>And</span>
  <span m='38860'>first</span> <span m='39100'>thing</span> <span m='39340'>to</span>
  <span m='39460'>do</span> <span m='40210'>is</span> <span m='40360'>to</span> <span
  m='40480'>define</span> <span m='40930'>what</span> <span m='41170'>"small"</span>
  <span m='41530'>means.</span> <span m='43750'>Most</span> <span m='44170'>succinct</span>
  <span m='44590'>data</span> <span m='44800'>structures</span> <span m='45220'>are</span>
  <span m='45340'>also</span> <span m='45700'>static,</span> <span m='46270'>although</span>
  <span m='46470'>there</span> <span m='46600'>are</span> <span m='46630'>a</span>
  <span m='46660'>few</span> <span m='46960'>that</span> <span m='47110'>are</span>
  <span m='47200'>dynamic.</span> <span m='48150'>We'll</span> <span m='48400'>be</span>
  <span m='48520'>focusing</span> <span m='48940'>here</span> <span m='49120'>on</span>
  <span m='49210'>static</span> <span m='52450'>data</span> <span m='52720'>structures.</span>
  </p><p><span m='57400'>And</span> <span m='57580'>so</span> <span m='58210'>in</span>
  <span m='58330'>general,</span> <span m='58660'>the</span> <span m='58750'>name</span>
  <span m='58930'>of</span> <span m='58990'>the</span> <span m='59080'>game</span>
  <span m='59380'>is</span> <span m='59680'>taking</span> <span m='60070'>a</span>
  <span m='60130'>data</span> <span m='60370'>structure</span> <span m='61270'>that</span>
  <span m='61390'>you're</span> <span m='61510'>familiar</span> <span m='61960'>with--</span>
  <span m='62290'>we're</span> <span m='62380'>going</span> <span m='62490'>to</span>
  <span m='62590'>talk</span> <span m='62830'>about</span> <span m='63550'>essentially</span>
  <span m='64000'>two</span> <span m='64239'>today.</span> <span m='65150'>One</span>
  <span m='65230'>is</span> <span m='65349'>binary</span> <span m='65759'>tries,</span>
  <span m='67090'>which</span> <span m='67420'>has</span> <span m='67880'>the</span>
  <span m='67930'>killer</span> <span m='68320'>application</span> <span m='69010'>of</span>
  <span m='69370'>doing</span> <span m='69910'>binary</span> <span m='70450'>suffix</span>
  <span m='70830'>trees</span> <span m='71740'>in</span> <span m='71800'>particular.</span>
  <span m='72280'>So</span> <span m='72360'>it</span> <span m='72430'>could</span>
  <span m='72580'>be</span> <span m='72670'>a</span> <span m='72740'>compressed</span>
  <span m='73150'>try,</span> <span m='73510'>whatever.</span> </p><p><span m='74230'>But</span>
  <span m='74380'>we'll</span> <span m='74530'>assume</span> <span m='74860'>hear</span>
  <span m='75130'>the</span> <span m='75280'>alphabet</span> <span m='75670'>is</span>
  <span m='75790'>binary.</span> <span m='76210'>A</span> <span m='76240'>lot</span>
  <span m='76420'>of</span> <span m='76480'>this</span> <span m='76720'>has</span>
  <span m='76960'>been</span> <span m='77110'>generalized</span> <span m='77590'>to</span>
  <span m='77710'>larger</span> <span m='78040'>alphabets.</span> <span m='78560'>I'll</span>
  <span m='78640'>tell</span> <span m='78820'>you</span> <span m='78880'>a</span>
  <span m='78910'>little</span> <span m='79150'>bit</span> <span m='79240'>about</span>
  <span m='79510'>that.</span> <span m='79760'>But</span> <span m='80240'>to</span>
  <span m='80440'>keep</span> <span m='80650'>it</span> <span m='80740'>simple</span>
  <span m='81010'>in</span> <span m='81130'>lecture,</span> <span m='81430'>I'm</span>
  <span m='81490'>going</span> <span m='81610'>to</span> <span m='81670'>stick</span>
  <span m='81910'>to a</span> <span m='82120'>binary</span> <span m='82480'>alphabet.</span>
  </p><p><span m='83710'>And</span> <span m='83950'>another</span> <span m='84250'>data</span>
  <span m='84430'>structure</span> <span m='84740'>we're</span> <span m='84780'>going</span>
  <span m='84890'>to</span> <span m='84970'>look</span> <span m='85180'>at</span>
  <span m='85390'>is</span> <span m='85690'>a</span> <span m='87160'>bit</span> <span
  m='87400'>vector,</span> <span m='88090'>so</span> <span m='88330'>n</span> <span
  m='88600'>bits</span> <span m='88900'>in</span> <span m='89020'>a</span> <span m='89080'>row.</span>
  <span m='89610'>And</span> <span m='89770'>you</span> <span m='89860'>want to</span>
  <span m='90100'>do</span> <span m='90250'>interesting</span> <span m='90700'>operations,</span>
  <span m='92260'>like</span> <span m='93430'>find</span> <span m='93880'>the</span>
  <span m='94100'>i-th</span> <span m='94420'>1</span> <span m='94690'>bit</span>
  <span m='95290'>in</span> <span m='95470'>constant</span> <span m='95890'>time.</span>
  <span m='96830'>These</span> <span m='96910'>are</span> <span m='97030'>things</span>
  <span m='97270'>that</span> <span m='97390'>are</span> <span m='97450'>easy</span>
  <span m='97810'>to</span> <span m='97900'>do</span> <span m='98260'>in</span> <span
  m='98830'>linear</span> <span m='99280'>space,</span> <span m='100570'>where</span>
  <span m='100840'>linear</span> <span m='101200'>space</span> <span m='101590'>means</span>
  <span m='101890'>order</span> <span m='102190'>and</span> <span m='102520'>words.</span>
  </p><p><span m='103870'>Like</span> <span m='104140'>if</span> <span m='104260'>you</span>
  <span m='104410'>want</span> <span m='104560'>to</span> <span m='104620'>implement</span>
  <span m='104920'>a</span> <span m='104980'>try,</span> <span m='105310'>you</span>
  <span m='105460'>have</span> <span m='105620'>a</span> <span m='105640'>pointer</span>
  <span m='106030'>at</span> <span m='106120'>every</span> <span m='106300'>node,</span>
  <span m='106780'>two</span> <span m='107020'>pointers</span> <span m='107380'>at</span>
  <span m='107470'>every</span> <span m='107620'>node,</span> <span m='108400'>that's</span>
  <span m='108610'>easy.</span> <span m='110050'>Bit</span> <span m='110350'>vectors</span>
  <span m='110740'>you</span> <span m='110830'>could</span> <span m='110950'>store</span>
  <span m='111460'>an</span> <span m='111580'>array</span> <span m='112000'>of</span>
  <span m='112520'>where</span> <span m='112690'>all</span> <span m='112780'>the</span>
  <span m='112900'>1s</span> <span m='113200'>are.</span> <span m='114160'>And</span>
  <span m='114280'>so</span> <span m='115330'>it's</span> <span m='115510'>easy</span>
  <span m='115780'>to</span> <span m='115870'>do</span> <span m='116080'>linear</span>
  <span m='116410'>space,</span> <span m='116830'>but</span> <span m='117070'>linear</span>
  <span m='117370'>space</span> <span m='117700'>is</span> <span m='117820'>not</span>
  <span m='118120'>optimal.</span> </p><p><span m='119450'>And</span> <span m='119590'>there</span>
  <span m='119770'>are</span> <span m='119800'>three</span> <span m='120250'>senses</span>
  <span m='120850'>of</span> <span m='121150'>small</span> <span m='121480'>space</span>
  <span m='121870'>that</span> <span m='121990'>we'll</span> <span m='122140'>be</span>
  <span m='122290'>going</span> <span m='122560'>for.</span> <span m='124540'>The</span>
  <span m='124690'>best</span> <span m='125020'>version</span> <span m='125530'>is</span>
  <span m='125800'>implicit.</span> <span m='128330'>An</span> <span m='128560'>implicit</span>
  <span m='129070'>data</span> <span m='129340'>structure</span> <span m='129820'>means</span>
  <span m='130400'>you</span> <span m='130580'>use</span> <span m='130840'>the</span>
  <span m='130990'>very</span> <span m='131470'>optimum</span> <span m='131990'>number</span>
  <span m='132280'>of</span> <span m='132340'>bits,</span> <span m='133360'>plus</span>
  <span m='133900'>a</span> <span m='133960'>constant.</span> </p><p><span m='137440'>But</span>
  <span m='137590'>here,</span> <span m='137740'>we're</span> <span m='138100'>focusing</span>
  <span m='138550'>on</span> <span m='138700'>bits,</span> <span m='139090'>not</span>
  <span m='139360'>words.</span> <span m='140440'>And</span> <span m='140590'>if</span>
  <span m='140710'>you</span> <span m='140800'>translate</span> <span m='141270'>a</span>
  <span m='141340'>linear</span> <span m='142210'>word</span> <span m='142660'>data</span>
  <span m='142960'>structure,</span> <span m='143830'>and</span> <span m='144250'>words</span>
  <span m='144730'>is</span> <span m='144940'>order</span> <span m='145430'>n</span>
  <span m='145600'>times</span> <span m='146060'>w</span> <span m='146530'>bits,</span>
  <span m='148480'>to store</span> <span m='148960'>something</span> <span m='149290'>like</span>
  <span m='149530'>an</span> <span m='149620'>n-bit</span> <span m='149980'>vector,</span>
  <span m='150310'>you</span> <span m='150460'>should</span> <span m='150640'>really</span>
  <span m='150910'>only</span> <span m='151120'>use</span> <span m='151420'>order</span>
  <span m='151690'>n</span> <span m='152020'>bits,</span> <span m='152440'>not</span>
  <span m='152680'>order</span> <span m='152950'>nw</span> <span m='153730'>bits.</span>
  </p><p><span m='156250'>Now,</span> <span m='156530'>what</span> <span m='156610'>would</span>
  <span m='156700'>be</span> <span m='156850'>ideal</span> <span m='157240'>is</span>
  <span m='157360'>if</span> <span m='157480'>you</span> <span m='157570'>used</span>
  <span m='158020'>n</span> <span m='158290'>bits</span> <span m='159250'>plus</span>
  <span m='159580'>a</span> <span m='159640'>constant.</span> <span m='160210'>The</span>
  <span m='160620'>plus</span> <span m='160850'>a</span> <span m='160950'>constant</span>
  <span m='161440'>is</span> <span m='161740'>essentially</span> <span m='162280'>because</span>
  <span m='162580'>sometimes</span> <span m='163000'>the</span> <span m='163090'>optimum</span>
  <span m='163420'>number</span> <span m='163680'>is</span> <span m='163780'>not</span>
  <span m='163990'>an</span> <span m='164080'>integer.</span> <span m='165050'>And</span>
  <span m='165100'>it's</span> <span m='165220'>hard</span> <span m='165430'>to</span>
  <span m='165550'>store a</span> <span m='165820'>non-integer</span> <span m='166510'>number</span>
  <span m='166780'>of</span> <span m='166840'>bits,</span> <span m='167210'>so</span>
  <span m='167500'>you</span> <span m='167710'>add</span> <span m='167920'>a</span>
  <span m='167980'>constant.</span> <span m='168950'>I</span> <span m='169050'>mean,</span>
  <span m='169540'>I</span> <span m='169690'>wouldn't</span> <span m='170050'>mind</span>
  <span m='170380'>too</span> <span m='170500'>much</span> <span m='170750'>if</span>
  <span m='170800'>you</span> <span m='170890'>added</span> <span m='171160'>order</span>
  <span m='171400'>log</span> <span m='171730'>n</span> <span m='171970'>bits</span>
  <span m='172270'>or</span> <span m='172360'>something.</span> <span m='173170'>But</span>
  <span m='173440'>typically,</span> <span m='173890'>the</span> <span m='174010'>goal</span>
  <span m='174220'>here</span> <span m='174430'>is</span> <span m='174580'>constant.</span>
  <span m='176620'>Sometimes</span> <span m='177040'>you</span> <span m='177130'>can</span>
  <span m='177280'>really</span> <span m='177490'>get</span> <span m='177730'>zero.</span>
  </p><p><span m='178720'>But</span> <span m='180430'>the</span> <span m='180640'>next</span>
  <span m='181000'>best</span> <span m='181270'>thing</span> <span m='181630'>would</span>
  <span m='181780'>be</span> <span m='182110'>a</span> <span m='182260'>succinct</span>
  <span m='183130'>data</span> <span m='183370'>structure,</span> <span m='186460'>where</span>
  <span m='186760'>the</span> <span m='186880'>goal</span> <span m='187120'>is</span>
  <span m='187240'>to</span> <span m='187390'>get</span> <span m='187920'>opt</span>
  <span m='188680'>plus</span> <span m='189430'>little</span> <span m='189790'>o</span>
  <span m='190030'>of</span> <span m='190150'>opt</span> <span m='192010'>bits.</span>
  <span m='194570'>So</span> <span m='194710'>the</span> <span m='194830'>key</span>
  <span m='195070'>here</span> <span m='195310'>is</span> <span m='195430'>to</span>
  <span m='195580'>get</span> <span m='196450'>a</span> <span m='196870'>constant</span>
  <span m='197320'>factor</span> <span m='197710'>of</span> <span m='197800'>1</span>
  <span m='198280'>in</span> <span m='198400'>front.</span> </p><p><span m='200260'>And</span>
  <span m='200740'>then</span> <span m='202530'>the</span> <span m='203830'>worst</span>
  <span m='204460'>thing</span> <span m='204880'>in</span> <span m='205030'>this</span>
  <span m='205450'>regime</span> <span m='205990'>is</span> <span m='206080'>still</span>
  <span m='206260'>pretty</span> <span m='206530'>good.</span> <span m='207100'>It's</span>
  <span m='207370'>order</span> <span m='208040'>opt</span> <span m='208480'>bits.</span>
  <span m='212300'>So</span> <span m='212620'>for</span> <span m='212770'>example,</span>
  <span m='213470'>if</span> <span m='213570'>you're</span> <span m='213580'>storing</span>
  <span m='214290'>an n-bit</span> <span m='214930'>vector,</span> <span m='215865'>if</span>
  <span m='216200'>you</span> <span m='216460'>use</span> <span m='216760'>order</span>
  <span m='217090'>n</span> <span m='217300'>bits,</span> <span m='217600'>that's</span>
  <span m='218170'>still</span> <span m='218410'>better</span> <span m='218740'>than</span>
  <span m='218920'>order</span> <span m='219190'>nw</span> <span m='219760'>bits.</span>
  <span m='219940'>Usually,</span> <span m='221200'>compact</span> <span m='222130'>is</span>
  <span m='222820'>a</span> <span m='222880'>savings</span> <span m='223450'>of</span>
  <span m='223630'>at</span> <span m='223720'>least</span> <span m='223960'>a</span>
  <span m='224020'>factor</span> <span m='224350'>of</span> <span m='224440'>w</span>
  <span m='224980'>over</span> <span m='225220'>what</span> <span m='225370'>you'd</span>
  <span m='225520'>normally</span> <span m='225880'>call</span> <span m='226120'>a</span>
  <span m='226180'>linear</span> <span m='226570'>space</span> <span m='226930'>data</span>
  <span m='227140'>structure.</span> <span m='227690'>So</span> <span m='227800'>this</span>
  <span m='228010'>is</span> <span m='228160'>the</span> <span m='228250'>big</span>
  <span m='228520'>savings,</span> <span m='228940'>factor</span> <span m='229270'>w.</span>
  </p><p><span m='230080'>But</span> <span m='230200'>there's</span> <span m='230350'>a</span>
  <span m='230410'>constant</span> <span m='230800'>here.</span> <span m='231040'>Sometimes</span>
  <span m='231400'>you</span> <span m='231500'>like</span> <span m='231640'>to</span>
  <span m='231730'>get</span> <span m='231880'>rid</span> <span m='232000'>of</span>
  <span m='232060'>that</span> <span m='232210'>constant,</span> <span m='232600'>make</span>
  <span m='232810'>it</span> <span m='232950'>1.</span> <span m='234460'>And</span>
  <span m='234790'>it's</span> <span m='234880'>not</span> <span m='235210'>so</span>
  <span m='235780'>bad</span> <span m='236080'>if</span> <span m='236200'>you</span>
  <span m='236290'>have,</span> <span m='236530'>say,</span> <span m='236770'>another</span>
  <span m='238010'>square</span> <span m='238350'>root</span> <span m='238510'>of</span>
  <span m='238600'>n</span> <span m='239020'>or</span> <span m='239110'>something</span>
  <span m='240200'>little</span> <span m='240480'>o of</span> <span m='240820'>n</span>
  <span m='242230'>bits</span> <span m='242500'>of</span> <span m='242590'>extra</span>
  <span m='242890'>space.</span> <span m='244390'>But</span> <span m='244600'>of</span>
  <span m='244690'>course,</span> <span m='244900'>the</span> <span m='245020'>ideal</span>
  <span m='245380'>would</span> <span m='245470'>be</span> <span m='245560'>to</span>
  <span m='245620'>have</span> <span m='245800'>no</span> <span m='245980'>extra</span>
  <span m='246250'>space,</span> <span m='246580'>and</span> <span m='246670'>that's</span>
  <span m='247450'>implicit.</span> </p><p><span m='248560'>Now,</span> <span m='248920'>it's</span>
  <span m='249040'>a</span> <span m='249070'>little</span> <span m='249280'>confusing.</span>
  <span m='249830'>I</span> <span m='249930'>usually</span> <span m='250090'>call</span>
  <span m='250360'>this</span> <span m='250780'>area</span> <span m='251300'>succinct</span>
  <span m='251590'>data</span> <span m='251800'>structures</span> <span m='252950'>to</span>
  <span m='253150'>mean</span> <span m='253350'>all</span> <span m='253510'>three.</span>
  <span m='254140'>But</span> <span m='254620'>the</span> <span m='254770'>middle</span>
  <span m='255010'>one</span> <span m='255250'>is</span> <span m='255370'>called</span>
  <span m='255610'>succinct.</span> <span m='257140'>That's</span> <span m='257440'>typically</span>
  <span m='257980'>the</span> <span m='258100'>goal</span> <span m='258310'>is</span>
  <span m='258399'>to</span> <span m='258519'>go</span> <span m='258640'>for</span>
  <span m='258790'>succinct,</span> <span m='259329'>because</span> <span m='259630'>implicit</span>
  <span m='260470'>is</span> <span m='260589'>very</span> <span m='260829'>hard,</span>
  <span m='261550'>and</span> <span m='261640'>compact</span> <span m='262270'>is</span>
  <span m='262390'>kind</span> <span m='262570'>of</span> <span m='262630'>like</span>
  <span m='263370'>a</span> <span m='263470'>warm-up</span> <span m='263920'>towards</span>
  <span m='264310'>succinct.</span> <span m='265060'>So</span> <span m='265270'>this</span>
  <span m='265450'>is</span> <span m='265570'>the</span> <span m='265690'>usual</span>
  <span m='266560'>goal</span> <span m='267250'>in</span> <span m='267370'>the</span>
  <span m='267460'>middle.</span> <span m='270100'>And</span> <span m='270220'>we're</span>
  <span m='270340'>going</span> <span m='270490'>to</span> <span m='270550'>do</span>
  <span m='270670'>this</span> <span m='270880'>for</span> <span m='271150'>binary</span>
  <span m='271480'>tries,</span> <span m='272140'>and</span> <span m='272590'>rank</span>
  <span m='272860'>and</span> <span m='272950'>select.</span> </p><p><span m='273730'>So</span>
  <span m='274000'>let</span> <span m='274150'>me</span> <span m='274270'>tell</span>
  <span m='274540'>you</span> <span m='275200'>a</span> <span m='275230'>little</span>
  <span m='275410'>bit</span> <span m='275530'>about</span> <span m='275800'>what's</span>
  <span m='276040'>known.</span> <span m='277690'>Oh,</span> <span m='278350'>sorry.</span>
  <span m='278710'>One</span> <span m='279760'>quick</span> <span m='279970'>example.</span>
  </p><p><span m='280460'>You've</span> <span m='280540'>seen</span> <span m='280810'>implicit</span>
  <span m='281170'>data</span> <span m='281410'>structures.</span> <span m='282100'>You</span>
  <span m='282190'>may</span> <span m='282370'>have</span> <span m='282490'>even</span>
  <span m='282850'>heard</span> <span m='283060'>this</span> <span m='283240'>term</span>
  <span m='283930'>in</span> <span m='284080'>the</span> <span m='284170'>context</span>
  <span m='284770'>of</span> <span m='285640'>heaps.</span> <span m='286130'>Binary</span>
  <span m='286500'>heaps</span> <span m='286930'>are</span> <span m='286990'>an</span>
  <span m='287080'>example</span> <span m='287500'>of</span> <span m='287590'>a</span>
  <span m='287650'>dynamic</span> <span m='288430'>implicit</span> <span m='288880'>data</span>
  <span m='289090'>structure.</span> <span m='289510'>They</span> <span m='289660'>achieve</span>
  <span m='290470'>this</span> <span m='290650'>bound.</span> <span m='292450'>They</span>
  <span m='292570'>have</span> <span m='292720'>no</span> <span m='292900'>extra</span>
  <span m='293200'>space</span> <span m='294530'>in</span> <span m='294840'>the</span>
  <span m='294910'>appropriate</span> <span m='295420'>model.</span> </p><p><span
  m='297130'>And</span> <span m='297520'>another</span> <span m='297820'>one</span>
  <span m='298150'>would</span> <span m='298300'>be</span> <span m='298450'>a</span>
  <span m='298510'>sorted</span> <span m='298900'>array.</span> <span m='299530'>Sorted</span>
  <span m='299890'>array</span> <span m='300100'>supports</span> <span m='300520'>binary</span>
  <span m='300850'>search.</span> <span m='301105'>You</span> <span m='301360'>can't</span>
  <span m='301540'>really</span> <span m='301750'>update</span> <span m='302050'>it,</span>
  <span m='302150'>so</span> <span m='302250'>it's</span> <span m='302350'>a</span>
  <span m='302410'>static</span> <span m='302890'>search</span> <span m='303160'>structure.</span>
  <span m='304090'>It</span> <span m='304240'>achieves</span> <span m='304810'>the</span>
  <span m='304960'>optimal</span> <span m='305500'>number</span> <span m='305710'>of</span>
  <span m='305770'>bits.</span> <span m='306040'>You're</span> <span m='306160'>just</span>
  <span m='306370'>storing</span> <span m='306700'>the</span> <span m='306790'>data.</span>
  </p><p><span m='307310'>And</span> <span m='307330'>usually,</span> <span m='307690'>implicit</span>
  <span m='308020'>data</span> <span m='308230'>structures</span> <span m='309220'>just</span>
  <span m='309520'>store</span> <span m='309820'>the</span> <span m='309940'>data,</span>
  <span m='311010'>though</span> <span m='311110'>sometimes</span> <span m='311500'>they</span>
  <span m='311620'>reorder</span> <span m='312070'>the</span> <span m='312190'>data</span>
  <span m='312460'>in</span> <span m='312580'>interesting</span> <span m='313060'>ways,</span>
  <span m='313360'>like</span> <span m='313600'>sorting.</span> <span m='314230'>A</span>
  <span m='314730'>sorted</span> <span m='315250'>array</span> <span m='315550'>is</span>
  <span m='315670'>one</span> <span m='315820'>way</span> <span m='315910'>to</span>
  <span m='316030'>reorder</span> <span m='317140'>your</span> <span m='317680'>data</span>
  <span m='317890'>items.</span> </p><p><span m='320870'>So</span> <span m='321370'>here's</span>
  <span m='321600'>a</span> <span m='322230'>short</span> <span m='322620'>survey.</span>
  <span m='323490'>This</span> <span m='323640'>is</span> <span m='323760'>definitely</span>
  <span m='324090'>not</span> <span m='324300'>exhaustive,</span> <span m='326010'>but</span>
  <span m='326370'>it</span> <span m='328740'>covers</span> <span m='329100'>a</span>
  <span m='329160'>bunch</span> <span m='329460'>of</span> <span m='329580'>the</span>
  <span m='329700'>main</span> <span m='330000'>results.</span> </p><p><span m='333750'>So</span>
  <span m='334020'>one</span> <span m='334230'>place</span> <span m='334530'>where</span>
  <span m='334680'>this</span> <span m='335370'>area</span> <span m='335730'>really</span>
  <span m='335970'>got</span> <span m='336150'>started--</span> <span m='338240'>well,</span>
  <span m='338400'>there</span> <span m='338520'>are</span> <span m='338550'>a</span>
  <span m='338580'>few</span> <span m='338790'>places,</span> <span m='339210'>actually.</span>
  <span m='344910'>My</span> <span m='345570'>academic</span> <span m='346200'>father,</span>
  <span m='347770'>one</span> <span m='347890'>of</span> <span m='347970'>my</span>
  <span m='348090'>PhD</span> <span m='348510'>advisors,</span> <span m='349410'>Ian</span>
  <span m='349630'>Munro is</span> <span m='350100'>sort</span> <span m='350340'>of</span>
  <span m='351030'>one</span> <span m='351240'>of</span> <span m='351300'>the</span>
  <span m='351390'>fathers</span> <span m='351840'>of</span> <span m='351930'>this</span>
  <span m='352140'>field.</span> <span m='353190'>And</span> <span m='353280'>he</span>
  <span m='353400'>started</span> <span m='353730'>looking</span> <span m='354030'>at</span>
  <span m='354150'>specific</span> <span m='354480'>data</span> <span m='354690'>structures</span>
  <span m='355850'>at</span> <span m='356200'>the</span> <span m='356360'>very</span>
  <span m='356670'>early</span> <span m='356910'>days.</span> </p><p><span m='357150'>And</span>
  <span m='357240'>one</span> <span m='357420'>of</span> <span m='357510'>the</span>
  <span m='357690'>problems</span> <span m='358140'>he</span> <span m='358230'>worked</span>
  <span m='358500'>on</span> <span m='360240'>was</span> <span m='361110'>dynamic</span>
  <span m='361770'>search</span> <span m='362070'>trees.</span> <span m='362790'>So</span>
  <span m='363000'>if</span> <span m='363090'>you</span> <span m='363180'>want</span>
  <span m='363300'>to</span> <span m='363360'>do</span> <span m='363500'>static</span>
  <span m='363870'>search</span> <span m='364110'>trees,</span> <span m='364350'>you</span>
  <span m='364440'>can</span> <span m='364560'>just</span> <span m='364680'>store</span>
  <span m='364860'>the</span> <span m='365010'>items</span> <span m='365310'>in a</span>
  <span m='365400'>sorted</span> <span m='365790'>array,</span> <span m='366760'>easy</span>
  <span m='367140'>log</span> <span m='367460'>n</span> <span m='368160'>search,</span>
  <span m='369180'>no</span> <span m='369360'>extra</span> <span m='369930'>space.</span>
  </p><p><span m='371350'>What</span> <span m='371550'>if</span> <span m='371640'>you</span>
  <span m='371760'>want</span> <span m='371910'>to</span> <span m='371970'>do</span>
  <span m='372120'>inserts</span> <span m='372510'>and</span> <span m='372600'>deletes</span>
  <span m='373230'>also</span> <span m='373620'>in</span> <span m='373740'>log</span>
  <span m='374010'>n</span> <span m='374160'>time</span> <span m='374490'>per</span>
  <span m='374640'>operation,</span> <span m='375720'>just</span> <span m='375960'>like</span>
  <span m='376200'>a</span> <span m='376230'>regular</span> <span m='376610'>search</span>
  <span m='376930'>tree,</span> <span m='377550'>but</span> <span m='377880'>you</span>
  <span m='378030'>want</span> <span m='378210'>to</span> <span m='378270'>do</span>
  <span m='378390'>it</span> <span m='378510'>implicitly?</span> <span m='380390'>Now,</span>
  <span m='380460'>this</span> <span m='380700'>is</span> <span m='380820'>tricky.</span>
  <span m='381330'>And</span> <span m='382080'>there's</span> <span m='382350'>an</span>
  <span m='382440'>old</span> <span m='382700'>result</span> <span m='382980'>that
  would</span> <span m='383160'>let</span> <span m='383400'>you</span> <span m='383550'>get</span>
  <span m='383790'>log</span> <span m='384150'>squared</span> <span m='384840'>per</span>
  <span m='385050'>update</span> <span m='385650'>and</span> <span m='386070'>query,</span>
  <span m='387030'>which</span> <span m='387230'>essentially</span> <span m='388050'>encoded--</span>
  <span m='389130'>you</span> <span m='389280'>can't</span> <span m='389520'>afford</span>
  <span m='389820'>pointers</span> <span m='390450'>at</span> <span m='390570'>all</span>
  <span m='391020'>here.</span> </p><p><span m='391740'>But</span> <span m='391890'>the</span>
  <span m='391980'>idea</span> <span m='392260'>was</span> <span m='392370'>to</span>
  <span m='392520'>encode</span> <span m='392940'>the</span> <span m='393030'>pointers</span>
  <span m='393450'>by</span> <span m='393780'>permuting</span> <span m='395700'>enough</span>
  <span m='396210'>items.</span> <span m='396890'>If</span> <span m='396990'>you</span>
  <span m='397280'>take,</span> <span m='397520'>say,</span> <span m='397680'>log</span>
  <span m='398010'>n</span> <span m='398160'>items,</span> <span m='398630'>then</span>
  <span m='398700'>the</span> <span m='398790'>permutations</span> <span m='399450'>among</span>
  <span m='399720'>them</span> <span m='399900'>is</span> <span m='400050'>roughly</span>
  <span m='400350'>log</span> <span m='400630'>n,</span> <span m='401070'>log</span>
  <span m='401310'>log</span> <span m='401490'>n</span> <span m='401610'>bits.</span>
  <span m='402600'>And</span> <span m='402840'>so</span> <span m='402960'>you</span>
  <span m='403020'>can</span> <span m='403170'>encode</span> <span m='403650'>bits</span>
  <span m='404010'>by</span> <span m='404550'>just</span> <span m='404790'>permuting</span>
  <span m='405390'>pairs</span> <span m='405870'>of</span> <span m='405960'>items.</span>
  <span m='407270'>And</span> <span m='407370'>so</span> <span m='407520'>you</span>
  <span m='407610'>could</span> <span m='407820'>read</span> <span m='408120'>a</span>
  <span m='408180'>pointer</span> <span m='408660'>in</span> <span m='408760'>like</span>
  <span m='408960'>log</span> <span m='409260'>n</span> <span m='409410'>operations,</span>
  <span m='410160'>you</span> <span m='410250'>end</span> <span m='410370'>up</span>
  <span m='410460'>with</span> <span m='410550'>log</span> <span m='410790'>squared.</span>
  </p><p><span m='412200'>And</span> <span m='412380'>then</span> <span m='412620'>Ian</span>
  <span m='412800'>Munro</span> <span m='413460'>got</span> <span m='413940'>down</span>
  <span m='414240'>to</span> <span m='414570'>a</span> <span m='414600'>little</span>
  <span m='415050'>bit</span> <span m='415230'>less</span> <span m='415530'>than</span>
  <span m='415680'>log</span> <span m='415960'>squared.</span> <span m='417200'>And</span>
  <span m='417390'>then</span> <span m='418670'>there's</span> <span m='418890'>a</span>
  <span m='418950'>series</span> <span m='419280'>of</span> <span m='419370'>improvements</span>
  <span m='419940'>over</span> <span m='420120'>the</span> <span m='420180'>last</span>
  <span m='421020'>several</span> <span m='421410'>years.</span> </p><p><span m='422160'>And</span>
  <span m='422230'>the</span> <span m='422310'>final</span> <span m='422610'>result</span>
  <span m='423450'>is</span> <span m='424650'>log</span> <span m='424980'>n</span>
  <span m='426210'>worst</span> <span m='426450'>case</span> <span m='429970'>insert,</span>
  <span m='431440'>delete,</span> <span m='432800'>and</span> <span m='433050'>predecessor.</span>
  <span m='435690'>And</span> <span m='435760'>this</span> <span m='435960'>is</span>
  <span m='436080'>by</span> <span m='436440'>Franceschini</span> <span m='438150'>and</span>
  <span m='438450'>Grossi.</span> <span m='440040'>And</span> <span m='440370'>furthermore,</span>
  <span m='440850'>it's</span> <span m='440970'>cache</span> <span m='441310'>oblivious,
  so</span> <span m='441720'>you</span> <span m='441840'>can</span> <span m='441960'>get</span>
  <span m='442140'>log</span> <span m='442500'>base</span> <span m='442810'>b</span>
  <span m='443200'>of n</span> <span m='444932'>cache</span> <span m='445840'>oblivious.</span>
  <span m='447780'>So</span> <span m='447930'>this</span> <span m='448140'>has</span>
  <span m='448260'>been</span> <span m='448530'>pretty</span> <span m='448740'>much</span>
  <span m='449100'>completely</span> <span m='449610'>solved.</span> <span m='450870'>Implicitly,</span>
  <span m='451570'>you</span> <span m='451740'>can</span> <span m='451920'>do</span>
  <span m='452130'>all</span> <span m='452400'>the</span> <span m='452640'>good</span>
  <span m='452790'>things</span> <span m='453060'>we</span> <span m='453150'>know</span>
  <span m='453300'>how</span> <span m='453390'>to</span> <span m='453510'>do</span>
  <span m='454290'>with</span> <span m='454980'>search</span> <span m='455370'>trees.</span>
  </p><p><span m='456030'>Now,</span> <span m='456180'>this</span> <span m='456330'>is</span>
  <span m='456420'>not</span> <span m='456600'>trying</span> <span m='456780'>to</span>
  <span m='456870'>solve</span> <span m='457080'>the</span> <span m='457170'>predecessor</span>
  <span m='457710'>problem</span> <span m='458040'>using</span> <span m='458340'>Van</span>
  <span m='458610'>Emde</span> <span m='458700'>Boas</span> <span m='459080'>and</span>
  <span m='459180'>such</span> <span m='459620'>tricks.</span> <span m='460050'>That's,</span>
  <span m='460950'>I</span> <span m='461040'>believe,</span> <span m='461340'>open.</span>
  <span m='462320'>But</span> <span m='462510'>for</span> <span m='462810'>a</span>
  <span m='462870'>basic</span> <span m='463260'>log n</span> <span m='463680'>performance,</span>
  <span m='464690'>it's</span> <span m='464910'>solved.</span> </p><p><span m='467750'>Before</span>
  <span m='468950'>this</span> <span m='469130'>got</span> <span m='469370'>solved,</span>
  <span m='470180'>another</span> <span m='470540'>important</span> <span m='470930'>problem</span>
  <span m='472010'>is</span> <span m='472190'>essentially</span> <span m='472870'>the</span>
  <span m='473180'>equivalent</span> <span m='473660'>of</span> <span m='473810'>hashing.</span>
  <span m='474770'>So</span> <span m='474950'>you</span> <span m='475130'>want</span>
  <span m='475280'>a</span> <span m='475430'>succinct</span> <span m='476130'>dictionary.</span>
  <span m='477095'>You</span> <span m='477350'>want</span> <span m='477590'>to</span>
  <span m='477650'>be</span> <span m='477710'>able</span> <span m='477860'>to</span>
  <span m='477980'>do--</span> <span m='479290'>now,</span> <span m='479750'>this</span>
  <span m='479930'>is</span> <span m='479990'>going</span> <span m='480140'>to</span>
  <span m='480230'>be</span> <span m='480320'>static,</span> <span m='481770'>so</span>
  <span m='481870'>there's</span> <span m='481940'>no</span> <span m='482090'>insert</span>
  <span m='482390'>and</span> <span m='482480'>delete.</span> <span m='484100'>It's</span>
  <span m='484310'>just,</span> <span m='485390'>is</span> <span m='485660'>this</span>
  <span m='485900'>item</span> <span m='486320'>in</span> <span m='486500'>the</span>
  <span m='486590'>dictionary?</span> </p><p><span m='487770'>So</span> <span m='487790'>I</span>
  <span m='487820'>have</span> <span m='487970'>a</span> <span m='488140'>universe</span>
  <span m='488460'>of size u.</span> <span m='489080'>I</span> <span m='489410'>have</span>
  <span m='489530'>n</span> <span m='489740'>items</span> <span m='490040'>in</span>
  <span m='490100'>the</span> <span m='490190'>dictionary.</span> <span m='491430'>So</span>
  <span m='491460'>the</span> <span m='491500'>first</span> <span m='491750'>question</span>
  <span m='492110'>is,</span> <span m='492230'>what</span> <span m='492500'>is</span>
  <span m='492620'>the</span> <span m='492800'>optimal</span> <span m='493220'>number</span>
  <span m='493500'>of</span> <span m='493550'>bits?</span> <span m='494910'>And</span>
  <span m='494930'>this</span> <span m='495080'>is</span> <span m='495170'>actually</span>
  <span m='495470'>usually</span> <span m='495800'>very</span> <span m='495980'>easy</span>
  <span m='496250'>to</span> <span m='496370'>compute.</span> <span m='496760'>You</span>
  <span m='496880'>just</span> <span m='497060'>take,</span> <span m='497360'>what</span>
  <span m='497600'>are</span> <span m='497660'>the</span> <span m='498740'>set</span>
  <span m='499070'>of</span> <span m='499130'>possible</span> <span m='499670'>structures</span>
  <span m='500090'>you're</span> <span m='500180'>trying</span> <span m='500390'>to</span>
  <span m='500480'>represent,</span> <span m='500990'>which</span> <span m='501230'>is</span>
  <span m='502130'>n</span> <span m='502880'>items</span> <span m='503390'>out</span>
  <span m='503540'>of</span> <span m='503630'>a</span> <span m='503690'>universe</span>
  <span m='504130'>of</span> <span m='504200'>size</span> <span m='504500'>u?</span>
  <span m='505490'>How</span> <span m='505760'>many</span> <span m='506000'>different</span>
  <span m='506450'>ways</span> <span m='506780'>are</span> <span m='506930'>there</span>
  <span m='507110'>to</span> <span m='507470'>have</span> <span m='507770'>n</span>
  <span m='508040'>items</span> <span m='508550'>in</span> <span m='508700'>a</span>
  <span m='508730'>universe</span> <span m='509090'>of</span> <span m='509150'>size</span>
  <span m='509420'>u?</span> </p><p><span m='515409'>Come</span> <span m='515720'>on.</span>
  <span m='516249'>It's</span> <span m='516549'>easy</span> <span m='516860'>combinatorics.</span>
  <span m='523504'>Somebody?</span> </p><p><span m='526396'>AUDIENCE:</span> <span
  m='526637'>Log</span> <span m='526878'>u</span> <span m='527360'>of</span> <span
  m='527842'>n.</span> </p><p><span m='528340'>ERIK DEMAINE:</span> <span m='528515'>Log</span>
  <span m='529040'>u--</span> </p><p><span m='529800'>AUDIENCE:</span> <span m='529960'>Sorry.</span>
  <span m='532920'>That's how</span> <span m='533416'>many bits</span> <span m='533912'>you'll
  need.</span> </p><p><span m='534410'>ERIK DEMAINE:</span> <span m='534610'>Yeah.</span>
  <span m='534810'>Log</span> <span m='535410'>u</span> <span m='535560'>choose</span>
  <span m='535830'>n</span> <span m='536070'>is</span> <span m='536280'>the</span>
  <span m='536370'>number</span> <span m='536580'>of</span> <span m='536640'>bits</span>
  <span m='536910'>you'll</span> <span m='537000'>need.</span> <span m='537360'>The</span>
  <span m='537420'>number</span> <span m='537660'>of</span> <span m='537750'>different</span>
  <span m='538320'>possibilities</span> <span m='538725'>is</span> <span m='539130'>u</span>
  <span m='539340'>choose</span> <span m='539600'>n.</span> <span m='540360'>You</span>
  <span m='540450'>take</span> <span m='540780'>log</span> <span m='541030'>base</span>
  <span m='541310'>2 of</span> <span m='541490'>that,</span> <span m='541670'>that's</span>
  <span m='541860'>how</span> <span m='541980'>many</span> <span m='542160'>bits</span>
  <span m='542370'>you'll</span> <span m='542490'>need</span> <span m='542730'>to</span>
  <span m='542880'>represent</span> <span m='543420'>this.</span> </p><p><span m='543600'>Now,</span>
  <span m='543750'>this</span> <span m='543900'>is</span> <span m='543990'>not</span>
  <span m='544170'>necessarily</span> <span m='544560'>an</span> <span m='544620'>integer,</span>
  <span m='546450'>because</span> <span m='546690'>it's</span> <span m='547170'>got</span>
  <span m='547350'>a</span> <span m='547380'>log.</span> <span m='547830'>That's</span>
  <span m='548070'>why</span> <span m='548880'>we</span> <span m='549060'>would</span>
  <span m='549180'>have</span> <span m='550600'>plus</span> <span m='550860'>order</span>
  <span m='550970'>1</span> <span m='551070'>if</span> <span m='551220'>we</span>
  <span m='551360'>were</span> <span m='551430'>doing</span> <span m='551640'>implicit.</span>
  <span m='551970'>It's</span> <span m='552120'>not</span> <span m='552300'>known</span>
  <span m='552510'>how</span> <span m='552600'>to</span> <span m='552690'>do</span>
  <span m='552810'>implicit.</span> <span m='553620'>It's</span> <span m='553800'>known</span>
  <span m='553980'>how</span> <span m='554100'>to</span> <span m='554220'>do</span>
  <span m='554430'>succinct,</span> <span m='555460'>so</span> <span m='555540'>this</span>
  <span m='555690'>is</span> <span m='555780'>going</span> <span m='555930'>to</span>
  <span m='556020'>be</span> <span m='556710'>plus</span> <span m='557010'>little</span>
  <span m='557190'>o</span> <span m='558070'>of</span> <span m='558240'>that</span>
  <span m='558450'>thing.</span> </p><p><span m='560880'>And</span> <span m='562910'>actually,</span>
  <span m='563220'>I</span> <span m='563250'>have</span> <span m='563640'>the</span>
  <span m='563760'>explicit</span> <span m='564450'>bound.</span> <span m='566176'>Eraser.</span>
  <span m='571860'>I</span> <span m='571890'>don't</span> <span m='571980'>know</span>
  <span m='572130'>how</span> <span m='572280'>exciting</span> <span m='572700'>this</span>
  <span m='572850'>is,</span> <span m='573060'>but</span> <span m='573330'>you</span>
  <span m='573450'>get</span> <span m='573570'>to</span> <span m='573750'>know</span>
  <span m='574470'>how</span> <span m='574770'>little</span> <span m='575030'>o</span>
  <span m='575220'>it</span> <span m='575310'>is.</span> </p><p><span m='577950'>Log</span>
  <span m='578750'>log</span> <span m='580076'>n</span> <span m='581850'>squared</span>
  <span m='583710'>over</span> <span m='584190'>log</span> <span m='584780'>n.</span>
  <span m='586800'>So</span> <span m='587070'>this</span> <span m='587340'>is</span>
  <span m='587490'>slightly</span> <span m='588150'>smaller,</span> <span m='589080'>so</span>
  <span m='589260'>this</span> <span m='589590'>is</span> <span m='589710'>roughly</span>
  <span m='590040'>something</span> <span m='590430'>like</span> <span m='592220'>u</span>
  <span m='593040'>log</span> <span m='593320'>n.</span> <span m='593725'>It</span>
  <span m='594130'>depends.</span> <span m='594680'>If</span> <span m='595140'>n</span>
  <span m='595270'>is</span> <span m='595370'>small,</span> <span m='595870'>this</span>
  <span m='595950'>is</span> <span m='596070'>like</span> <span m='596250'>u</span>
  <span m='596400'>log</span> <span m='596670'>n.</span> <span m='597480'>If n</span>
  <span m='597630'>is</span> <span m='597750'>big,</span> <span m='598620'>this</span>
  <span m='598770'>is</span> <span m='598890'>like--</span> <span m='601080'>sorry,</span>
  <span m='601600'>n</span> <span m='601790'>log</span> <span m='602040'>u,</span>
  <span m='602280'>I</span> <span m='602550'>should</span> <span m='602730'>say.</span>
  </p><p><span m='603480'>You</span> <span m='603570'>can</span> <span m='603720'>always</span>
  <span m='604020'>encode</span> <span m='604500'>a</span> <span m='604560'>dictionary</span>
  <span m='605040'>using</span> <span m='605340'>n</span> <span m='605450'>log</span>
  <span m='605670'>u</span> <span m='605820'>bits.</span> <span m='606060'>Just</span>
  <span m='606240'>for</span> <span m='606360'>every</span> <span m='606600'>item,</span>
  <span m='606870'>you</span> <span m='606960'>specify</span> <span m='607350'>the</span>
  <span m='607470'>log</span> <span m='607680'>u</span> <span m='607770'>bits.</span>
  <span m='608550'>But</span> <span m='608670'>when</span> <span m='608820'>n</span>
  <span m='608940'>is</span> <span m='609090'>big,</span> <span m='609330'>close</span>
  <span m='609630'>to</span> <span m='609750'>u,</span> <span m='610170'>then</span>
  <span m='610950'>you</span> <span m='611100'>can</span> <span m='611220'>just</span>
  <span m='611460'>use</span> <span m='611670'>a</span> <span m='611700'>bit</span>
  <span m='611910'>vector</span> <span m='612720'>and</span> <span m='612810'>use</span>
  <span m='612990'>u</span> <span m='613170'>bits.</span> </p><p><span m='615150'>And</span>
  <span m='616740'>so</span> <span m='616950'>this</span> <span m='617130'>is</span>
  <span m='617550'>little</span> <span m='617820'>o</span> <span m='617980'>of</span>
  <span m='618060'>n,</span> <span m='618840'>so</span> <span m='619020'>it's</span>
  <span m='619110'>always</span> <span m='619320'>smaller</span> <span m='619860'>than</span>
  <span m='620550'>whatever</span> <span m='620850'>you're</span> <span m='620950'>encoding</span>
  <span m='621390'>over</span> <span m='621570'>here.</span> <span m='622950'>It's</span>
  <span m='623040'>only</span> <span m='623250'>slightly</span> <span m='623640'>smaller</span>
  <span m='623970'>than</span> <span m='624130'>n,</span> <span m='624700'>log log</span>
  <span m='625080'>n</span> <span m='625230'>squared</span> <span m='625620'>over</span>
  <span m='625870'>log</span> <span m='626280'>n,</span> <span m='626550'>but</span>
  <span m='626940'>it's</span> <span m='627150'>a</span> <span m='627180'>little</span>
  <span m='627420'>o of</span> <span m='627600'>1.</span> </p><p><span m='630650'>And</span>
  <span m='631180'>that's</span> <span m='631560'>I</span> <span m='631650'>believe</span>
  <span m='631920'>the</span> <span m='632010'>best</span> <span m='632280'>known.</span>
  <span m='634470'>So</span> <span m='634650'>this</span> <span m='634890'>is</span>
  <span m='635390'>Brodnik</span> <span m='635820'>and</span> <span m='635910'>Munro,</span>
  <span m='636420'>and</span> <span m='636510'>then</span> <span m='636630'>improved</span>
  <span m='636990'>by</span> <span m='637140'>Pagh.</span> <span m='638640'>And</span>
  <span m='639090'>the</span> <span m='639240'>point</span> <span m='639420'>is</span>
  <span m='639540'>you</span> <span m='639630'>get</span> <span m='639810'>constant</span>
  <span m='640230'>time</span> <span m='641700'>membership</span> <span m='641960'>query.</span>
  <span m='645840'>In</span> <span m='645960'>general,</span> <span m='646290'>the</span>
  <span m='646350'>name</span> <span m='646560'>of</span> <span m='646620'>the</span>
  <span m='646680'>game</span> <span m='646920'>is</span> <span m='647010'>you</span>
  <span m='647100'>want</span> <span m='647250'>to</span> <span m='647310'>do</span>
  <span m='647460'>the</span> <span m='647610'>queries</span> <span m='647970'>you're</span>
  <span m='648090'>used</span> <span m='648360'>to</span> <span m='648480'>doing</span>
  <span m='648810'>in</span> <span m='648890'>something</span> <span m='649170'>like</span>
  <span m='649320'>a</span> <span m='649380'>dictionary,</span> <span m='650250'>same</span>
  <span m='650550'>amount</span> <span m='650790'>of</span> <span m='650880'>time,</span>
  <span m='651870'>but</span> <span m='652020'>with</span> <span m='652170'>less</span>
  <span m='652350'>space.</span> </p><p><span m='655100'>OK.</span> <span m='656140'>Next</span>
  <span m='656310'>one</span> <span m='656760'>is--</span> <span m='660090'>maybe</span>
  <span m='660300'>I'll</span> <span m='660450'>go</span> <span m='660730'>over</span>
  <span m='660970'>here--</span> <span m='665010'>binary</span> <span m='665430'>try,</span>
  <span m='666200'>which</span> <span m='666390'>is</span> <span m='666560'>what</span>
  <span m='666835'>we're</span> <span m='670260'>going</span> <span m='670500'>to</span>
  <span m='670600'>work</span> <span m='670810'>on</span> <span m='670930'>today.</span>
  <span m='672790'>There's</span> <span m='673120'>various</span> <span m='673480'>results</span>
  <span m='673810'>on</span> <span m='673930'>this,</span> <span m='674230'>but</span>
  <span m='675460'>sort</span> <span m='675670'>of</span> <span m='675730'>one</span>
  <span m='675880'>of</span> <span m='675940'>the</span> <span m='676030'>main</span>
  <span m='676240'>ones</span> <span m='676480'>is</span> <span m='676540'>by</span>
  <span m='676720'>Munro</span> <span m='677080'>and</span> <span m='677170'>Raman.</span>
  <span m='678690'>Again,</span> <span m='679150'>now</span> <span m='679330'>this</span>
  <span m='679510'>is</span> <span m='679570'>a</span> <span m='679630'>little</span>
  <span m='680230'>harder</span> <span m='680560'>of</span> <span m='680650'>a</span>
  <span m='680710'>question.</span> <span m='681500'>How</span> <span m='681670'>many</span>
  <span m='681970'>binary</span> <span m='682420'>tries</span> <span m='683000'>on</span>
  <span m='683220'>n</span> <span m='683440'>nodes</span> <span m='683830'>are</span>
  <span m='683980'>there?</span> </p><p><span m='685720'>The</span> <span m='685870'>answer,</span>
  <span m='686500'>I</span> <span m='686600'>will</span> <span m='686700'>tell</span>
  <span m='686830'>you,</span> <span m='687370'>is</span> <span m='687610'>the</span>
  <span m='687750'>nth</span> <span m='687960'>Catalan</span> <span m='688390'>number,</span>
  <span m='690610'>which</span> <span m='690850'>is</span> <span m='691060'>a</span>
  <span m='691120'>quantity</span> <span m='691670'>we've</span> <span m='692140'>seen</span>
  <span m='692410'>before.</span> <span m='694990'>2n</span> <span m='695170'>choose</span>
  <span m='695530'>n</span> <span m='696270'>over</span> <span m='696490'>n</span>
  <span m='696640'>plus</span> <span m='696890'>1.</span> <span m='697940'>As</span>
  <span m='698680'>we</span> <span m='698830'>mentioned</span> <span m='699280'>last</span>
  <span m='699490'>time,</span> <span m='699670'>this</span> <span m='699820'>is</span>
  <span m='699910'>roughly</span> <span m='700270'>4</span> <span m='700490'>to</span>
  <span m='700560'>the</span> <span m='700730'>n.</span> </p><p><span m='705620'>This
  is</span> <span m='705880'>kind</span> <span m='706120'>of</span> <span m='706210'>interesting.</span>
  <span m='707560'>We</span> <span m='707680'>saw</span> <span m='707890'>the</span>
  <span m='707980'>Catalan</span> <span m='708310'>number</span> <span m='708550'>in</span>
  <span m='708640'>a</span> <span m='708730'>different</span> <span m='709060'>context,</span>
  <span m='709600'>which</span> <span m='709820'>is</span> <span m='709990'>we</span>
  <span m='710140'>were</span> <span m='710290'>doing</span> <span m='710660'>indirection</span>
  <span m='711520'>and</span> <span m='711610'>using</span> <span m='711910'>lookup</span>
  <span m='712180'>tables</span> <span m='712630'>at</span> <span m='712750'>the</span>
  <span m='712840'>bottom</span> <span m='713820'>on</span> <span m='714070'>all</span>
  <span m='714490'>rooted</span> <span m='715810'>trees</span> <span m='717220'>on</span>
  <span m='718030'>n</span> <span m='718280'>nodes.</span> <span m='718940'>Number</span>
  <span m='719200'>of</span> <span m='719290'>rooted</span> <span m='719500'>trees</span>
  <span m='719800'>on</span> <span m='719920'>n</span> <span m='720070'>nodes</span>
  <span m='720310'>was</span> <span m='720460'>also</span> <span m='721240'>Catalan</span>
  <span m='721630'>number.</span> </p><p><span m='721930'>This</span> <span m='722140'>is</span>
  <span m='722260'>a</span> <span m='722320'>different</span> <span m='722920'>concept,</span>
  <span m='723370'>binary</span> <span m='723760'>tries.</span> <span m='724780'>If</span>
  <span m='725020'>you've</span> <span m='725230'>ever</span> <span m='725470'>taken</span>
  <span m='725750'>a</span> <span m='725790'>combinatorics</span> <span m='726330'>class,</span>
  <span m='726640'>you</span> <span m='726730'>see</span> <span m='726940'>Catalan</span>
  <span m='727420'>numbers</span> <span m='727780'>all</span> <span m='728020'>over</span>
  <span m='728140'>the</span> <span m='728260'>place.</span> <span m='728690'>There's</span>
  <span m='728800'>a</span> <span m='728860'>zillion</span> <span m='729340'>different</span>
  <span m='729640'>things,</span> <span m='729970'>all</span> <span m='731290'>of</span>
  <span m='731410'>them</span> <span m='731620'>the</span> <span m='731710'>number</span>
  <span m='731950'>of</span> <span m='732040'>them</span> <span m='732250'>is</span>
  <span m='732460'>Catalan</span> <span m='732820'>number.</span> <span m='733750'>And</span>
  <span m='733990'>we</span> <span m='734110'>will</span> <span m='734230'>actually</span>
  <span m='734500'>use</span> <span m='734830'>that</span> <span m='735010'>equivalence</span>
  <span m='735460'>between</span> <span m='735700'>binary</span> <span m='736060'>tries</span>
  <span m='736540'>and</span> <span m='736660'>rooted</span> <span m='736960'>trees</span>
  <span m='738040'>at</span> <span m='738190'>the</span> <span m='738280'>end</span>
  <span m='738520'>of</span> <span m='738760'>today's</span> <span m='739090'>lecture.</span>
  <span m='739760'>So</span> <span m='739910'>you'll</span> <span m='740050'>see</span>
  <span m='740260'>why</span> <span m='740610'>they're the</span> <span m='740770'>same</span>
  <span m='741010'>number.</span> </p><p><span m='743210'>OK.</span> <span m='743510'>So</span>
  <span m='743770'>we</span> <span m='743890'>take</span> <span m='744070'>log</span>
  <span m='744370'>of</span> <span m='744460'>that,</span> <span m='745330'>that's</span>
  <span m='745660'>2n</span> <span m='745990'>bits.</span> <span m='746780'>So</span>
  <span m='746860'>you</span> <span m='746980'>need</span> <span m='748140'>2n</span>
  <span m='748750'>bits</span> <span m='749170'>to</span> <span m='749560'>represent</span>
  <span m='750390'>a</span> <span m='750540'>binary</span> <span m='750880'>try.</span>
  <span m='751960'>And</span> <span m='753430'>indeed,</span> <span m='753850'>you</span>
  <span m='754000'>can</span> <span m='754120'>achieve</span> <span m='754540'>2n</span>
  <span m='755020'>plus</span> <span m='755290'>little</span> <span m='755560'>o of
  n</span> <span m='755870'>bits.</span> </p><p><span m='758630'>So</span> <span m='758710'>that's</span>
  <span m='758920'>a</span> <span m='759170'>succinct</span> <span m='759370'>data</span>
  <span m='759610'>structure.</span> <span m='760780'>And</span> <span m='761080'>our</span>
  <span m='761200'>goal</span> <span m='761650'>will</span> <span m='761830'>be</span>
  <span m='762250'>to</span> <span m='762640'>be</span> <span m='763210'>able</span>
  <span m='763480'>to</span> <span m='763630'>do</span> <span m='764260'>constant</span>
  <span m='764680'>time</span> <span m='765760'>traversal</span> <span m='766450'>of</span>
  <span m='766570'>the</span> <span m='766660'>tree,</span> <span m='767150'>so</span>
  <span m='767300'>left</span> <span m='767620'>child,</span> <span m='768610'>right</span>
  <span m='768850'>child,</span> <span m='769990'>parent.</span> <span m='772840'>And</span>
  <span m='773080'>for</span> <span m='773290'>fun,</span> <span m='773960'>another</span>
  <span m='774190'>operation</span> <span m='774680'>we</span> <span m='774790'>might</span>
  <span m='774940'>want</span> <span m='775060'>to</span> <span m='775150'>do</span>
  <span m='775420'>is</span> <span m='775720'>compute</span> <span m='776140'>the</span>
  <span m='776230'>size</span> <span m='776710'>of</span> <span m='776800'>the</span>
  <span m='776920'>current</span> <span m='777160'>subtree.</span> </p><p><span m='779710'>Again,</span>
  <span m='780040'>think</span> <span m='780310'>of</span> <span m='780580'>a</span>
  <span m='780610'>suffix</span> <span m='781050'>tree.</span> <span m='782860'>You</span>
  <span m='782950'>start</span> <span m='783200'>at</span> <span m='783280'>the</span>
  <span m='783370'>root</span> <span m='784210'>and</span> <span m='784480'>you</span>
  <span m='784600'>want</span> <span m='784750'>to</span> <span m='784840'>be</span>
  <span m='784930'>able</span> <span m='785080'>to</span> <span m='785470'>go</span>
  <span m='786040'>along</span> <span m='786330'>the</span> <span m='786400'>left</span>
  <span m='786610'>child</span> <span m='786880'>every</span> <span m='787090'>time</span>
  <span m='787330'>you</span> <span m='787420'>have</span> <span m='787570'>a</span>
  <span m='787630'>0</span> <span m='787960'>bit</span> <span m='788200'>in</span>
  <span m='788350'>your</span> <span m='789250'>query</span> <span m='789610'>string.</span>
  <span m='789940'>You</span> <span m='790030'>want</span> <span m='790180'>to</span>
  <span m='790330'>go</span> <span m='790780'>to</span> <span m='790900'>the</span>
  <span m='790990'>right</span> <span m='791170'>child</span> <span m='791440'>every</span>
  <span m='791620'>time</span> <span m='791830'>you</span> <span m='791890'>have</span>
  <span m='792010'>a</span> <span m='792070'>1</span> <span m='792280'>bit.</span>
  <span m='793360'>Parent</span> <span m='793900'>we</span> <span m='794050'>don't</span>
  <span m='794200'>really</span> <span m='794410'>need,</span> <span m='794680'>but</span>
  <span m='794830'>why</span> <span m='795010'>not?</span> </p><p><span m='795700'>And</span>
  <span m='795820'>then</span> <span m='795970'>subtree</span> <span m='796380'>size</span>
  <span m='796720'>would</span> <span m='796810'>tell</span> <span m='797050'>us,</span>
  <span m='797230'>how</span> <span m='797470'>many</span> <span m='797680'>matches</span>
  <span m='798160'>are</span> <span m='798280'>there</span> <span m='798430'>below</span>
  <span m='798730'>us?</span> <span m='798970'>You</span> <span m='799060'>could</span>
  <span m='799210'>count</span> <span m='799540'>either</span> <span m='799750'>the</span>
  <span m='799870'>number</span> <span m='800080'>of</span> <span m='800170'>nodes</span>
  <span m='800410'>below</span> <span m='800680'>you</span> <span m='800800'>or</span>
  <span m='800890'>the</span> <span m='800980'>number</span> <span m='801220'>of</span>
  <span m='801280'>leaves</span> <span m='801550'>below</span> <span m='801820'>you.</span>
  <span m='801880'>It's</span> <span m='802030'>roughly</span> <span m='802330'>the</span>
  <span m='802450'>same</span> <span m='802810'>for</span> <span m='802930'>a</span>
  <span m='802960'>compact</span> <span m='803920'>try.</span> </p><p><span m='805210'>And</span>
  <span m='805300'>so</span> <span m='805390'>this</span> <span m='805570'>lets</span>
  <span m='805840'>you</span> <span m='805990'>do</span> <span m='807160'>substring</span>
  <span m='807970'>searches.</span> <span m='809080'>And</span> <span m='809200'>we'll</span>
  <span m='809360'>actually</span> <span m='809650'>talk</span> <span m='809870'>more</span>
  <span m='810010'>about</span> <span m='810220'>that</span> <span m='810370'>next</span>
  <span m='810580'>lecture,</span> <span m='810850'>how</span> <span m='810970'>to</span>
  <span m='811090'>actually</span> <span m='811450'>do</span> <span m='811660'>a</span>
  <span m='811720'>full</span> <span m='811960'>suffix</span> <span m='812410'>tree.</span>
  <span m='813140'>But</span> <span m='813190'>this</span> <span m='813370'>is</span>
  <span m='813490'>a</span> <span m='813580'>component</span> <span m='814210'>of</span>
  <span m='814390'>a</span> <span m='815050'>binary</span> <span m='815440'>suffix</span>
  <span m='815860'>tree</span> <span m='816700'>that</span> <span m='816940'>has</span>
  <span m='817180'>the</span> <span m='817240'>same</span> <span m='817510'>performance</span>
  <span m='818650'>but</span> <span m='818890'>uses</span> <span m='819610'>optimal</span>
  <span m='820480'>amount</span> <span m='820750'>of</span> <span m='820840'>space.</span>
  </p><p><span m='821830'>And</span> <span m='821980'>this</span> <span m='822160'>is</span>
  <span m='822280'>a</span> <span m='822340'>big</span> <span m='822580'>motivator</span>
  <span m='823270'>originally</span> <span m='823750'>for</span> <span m='824140'>doing</span>
  <span m='826990'>compact</span> <span m='827590'>or</span> <span m='827920'>succinct</span>
  <span m='828580'>data</span> <span m='828850'>structures.</span> <span m='830080'>At</span>
  <span m='830410'>University</span> <span m='830830'>of</span> <span m='830920'>Waterloo,</span>
  <span m='831360'>they</span> <span m='831440'>were</span> <span m='831550'>doing</span>
  <span m='831760'>this</span> <span m='832090'>new</span> <span m='832480'>OED</span>
  <span m='832900'>project,</span> <span m='833410'>where</span> <span m='834070'>Oxford</span>
  <span m='834370'>English</span> <span m='834580'>Dictionary</span> <span m='835000'>was</span>
  <span m='835180'>trying</span> <span m='835450'>to</span> <span m='835540'>go</span>
  <span m='835900'>online</span> <span m='836760'>or</span> <span m='836860'>digital.</span>
  <span m='837820'>And</span> <span m='837910'>this</span> <span m='838060'>concept</span>
  <span m='838690'>of</span> <span m='838930'>having</span> <span m='839260'>a</span>
  <span m='839320'>CD-ROM</span> <span m='840010'>that</span> <span m='840100'>could</span>
  <span m='840220'>have</span> <span m='840400'>an</span> <span m='840460'>entire</span>
  <span m='841150'>dictionary</span> <span m='841810'>on</span> <span m='841990'>it</span>
  <span m='842500'>was</span> <span m='842740'>crazy.</span> </p><p><span m='844750'>And</span>
  <span m='845140'>CD-ROMs</span> <span m='845800'>were</span> <span m='845890'>really</span>
  <span m='846130'>slow,</span> <span m='846610'>so</span> <span m='846760'>you</span>
  <span m='846850'>don't</span> <span m='847030'>want</span> <span m='847150'>to</span>
  <span m='847210'>just</span> <span m='847390'>scan</span> <span m='847990'>the</span>
  <span m='848110'>entire</span> <span m='848470'>CD</span> <span m='848950'>to</span>
  <span m='849100'>do</span> <span m='849220'>a</span> <span m='849280'>search.</span>
  <span m='850330'>You</span> <span m='850420'>want</span> <span m='850600'>to</span>
  <span m='850660'>be</span> <span m='850720'>able</span> <span m='850840'>to</span>
  <span m='850900'>do</span> <span m='851260'>a</span> <span m='851320'>search</span>
  <span m='851710'>for</span> <span m='851920'>arbitrary</span> <span m='852340'>substrings.</span>
  <span m='852910'>That's</span> <span m='853090'>what</span> <span m='853210'>suffix</span>
  <span m='853600'>trees</span> <span m='853810'>let</span> <span m='853960'>you</span>
  <span m='854050'>do.</span> <span m='854290'>But</span> <span m='854440'>you</span>
  <span m='854560'>really</span> <span m='854860'>can't</span> <span m='855100'>afford</span>
  <span m='855880'>much</span> <span m='856120'>space.</span> <span m='856470'>And</span>
  <span m='856820'>so</span> <span m='857710'>that</span> <span m='857830'>was</span>
  <span m='857950'>the</span> <span m='858040'>motivation</span> <span m='858580'>for</span>
  <span m='858740'>developing</span> <span m='859570'>these</span> <span m='859780'>data</span>
  <span m='859990'>structures</span> <span m='860440'>back</span> <span m='860680'>in</span>
  <span m='860770'>the</span> <span m='860830'>day.</span> </p><p><span m='862630'>Things</span>
  <span m='862840'>are</span> <span m='862900'>a</span> <span m='862930'>lot</span>
  <span m='863080'>easier</span> <span m='863350'>now.</span> <span m='863560'>Space</span>
  <span m='863890'>is</span> <span m='864010'>cheaper.</span> <span m='864550'>But</span>
  <span m='864760'>still,</span> <span m='865180'>there's</span> <span m='865360'>always</span>
  <span m='865570'>going</span> <span m='865750'>to</span> <span m='865810'>be</span>
  <span m='865990'>some</span> <span m='866290'>giant</span> <span m='866650'>thing</span>
  <span m='866920'>that</span> <span m='867040'>you</span> <span m='867160'>need</span>
  <span m='867310'>to</span> <span m='867400'>store</span> <span m='868910'>that</span>
  <span m='869320'>if</span> <span m='869560'>you</span> <span m='869680'>want</span>
  <span m='869830'>to</span> <span m='869890'>store</span> <span m='870100'>a</span>
  <span m='870130'>data</span> <span m='870340'>structure,</span> <span m='870640'>you</span>
  <span m='870700'>really</span> <span m='871000'>can't</span> <span m='871270'>afford</span>
  <span m='871570'>much</span> <span m='871780'>space.</span> </p><p><span m='874060'>Cool.</span>
  <span m='874780'>So</span> <span m='875050'>that's</span> <span m='876010'>static.</span>
  <span m='877480'>There</span> <span m='877660'>is</span> <span m='877780'>a</span>
  <span m='877840'>dynamic</span> <span m='878320'>version.</span> <span m='879540'>It's
  a</span> <span m='879730'>more</span> <span m='879910'>recent</span> <span m='880210'>result</span>
  <span m='880630'>from</span> <span m='880960'>just</span> <span m='881140'>a</span>
  <span m='881170'>few</span> <span m='881380'>years</span> <span m='881590'>ago.</span>
  </p><p><span m='882340'>You</span> <span m='882460'>can</span> <span m='882640'>do</span>
  <span m='882880'>constant</span> <span m='883360'>time,</span> <span m='884560'>insert,</span>
  <span m='885070'>and</span> <span m='885250'>delete</span> <span m='886520'>of</span>
  <span m='886720'>a</span> <span m='886810'>leaf.</span> <span m='889240'>And</span>
  <span m='889600'>you</span> <span m='889690'>can</span> <span m='889870'>do</span>
  <span m='890670'>a</span> <span m='890830'>subdivision</span> <span m='891550'>of</span>
  <span m='891670'>an</span> <span m='891760'>edge.</span> <span m='896860'>These</span>
  <span m='897100'>are</span> <span m='897220'>operations</span> <span m='897790'>we</span>
  <span m='897880'>saw</span> <span m='898120'>for</span> <span m='898300'>dynamic</span>
  <span m='898750'>LCA.</span> </p><p><span m='902010'>So</span> <span m='902290'>same</span>
  <span m='902560'>operations</span> <span m='903070'>as</span> <span m='903160'>dynamic</span>
  <span m='903610'>LCA,</span> <span m='904150'>you</span> <span m='904240'>can</span>
  <span m='904390'>do</span> <span m='904510'>these</span> <span m='904720'>in</span>
  <span m='904810'>constant</span> <span m='905200'>time</span> <span m='905890'>and</span>
  <span m='906010'>still</span> <span m='906250'>maintain</span> <span m='907600'>the</span>
  <span m='907840'>succinct</span> <span m='908170'>binary</span> <span m='908820'>try</span>
  <span m='909040'>representation,</span> <span m='909800'>where</span> <span m='909910'>you</span>
  <span m='910000'>can</span> <span m='910120'>do</span> <span m='910240'>all</span>
  <span m='910330'>these</span> <span m='910480'>traversal</span> <span m='910900'>operations.</span>
  <span m='911410'>So</span> <span m='911680'>we</span> <span m='911770'>won't</span>
  <span m='911920'>cover</span> <span m='912160'>that.</span> <span m='912430'>We</span>
  <span m='912880'>will</span> <span m='913000'>cover</span> <span m='913240'>the</span>
  <span m='913360'>static</span> <span m='913690'>version</span> <span m='914020'>today.</span>
  </p><p><span m='916360'>Then</span> <span m='917350'>that's</span> <span m='917650'>for</span>
  <span m='917780'>binary</span> <span m='918220'>alphabet.</span> <span m='918640'>Let</span>
  <span m='918790'>me</span> <span m='918880'>tell</span> <span m='919090'>you</span>
  <span m='919240'>what's</span> <span m='919480'>known</span> <span m='919720'>about</span>
  <span m='921550'>larger</span> <span m='921940'>alphabet.</span> <span m='922720'>This
  is</span> <span m='922890'>a</span> <span m='922960'>problem</span> <span m='923230'>I</span>
  <span m='923320'>worked</span> <span m='923590'>on</span> <span m='924070'>a</span>
  <span m='924130'>while</span> <span m='924400'>ago,</span> <span m='924820'>though
  our</span> <span m='925090'>result</span> <span m='925450'>is</span> <span m='925600'>no</span>
  <span m='925750'>longer</span> <span m='926020'>the</span> <span m='926110'>best.</span>
  </p><p><span m='928690'>So</span> <span m='928960'>here,</span> <span m='930860'>it's</span>
  <span m='931030'>a</span> <span m='931060'>little</span> <span m='931300'>complicated.</span>
  <span m='932350'>But</span> <span m='932530'>the</span> <span m='932620'>number</span>
  <span m='932980'>of</span> <span m='933130'>tries,</span> <span m='935230'>number</span>
  <span m='935620'>of</span> <span m='935890'>k-ary</span> <span m='936420'>tries,</span>
  <span m='936720'>so</span> <span m='937020'>k is</span> <span m='937210'>now</span>
  <span m='937360'>the</span> <span m='937450'>size of</span> <span m='937750'>the</span>
  <span m='937900'>alphabet,</span> <span m='939760'>is</span> <span m='941230'>kn</span>
  <span m='942060'>plus</span> <span m='942100'>1</span> <span m='943150'>choose</span>
  <span m='944020'>n</span> <span m='945670'>over</span> <span m='946180'>kn</span>
  <span m='946810'>plus</span> <span m='947150'>1.</span> <span m='952120'>And</span>
  <span m='952840'>so</span> <span m='953230'>it's</span> <span m='953320'>succinct,</span>
  <span m='953800'>meaning</span> <span m='954370'>we</span> <span m='954580'>can</span>
  <span m='954730'>achieve</span> <span m='955030'>log</span> <span m='955390'>of</span>
  <span m='955480'>that</span> <span m='955870'>plus</span> <span m='956170'>little</span>
  <span m='956500'>o of</span> <span m='956740'>that</span> <span m='958090'>bits.</span>
  <span m='959790'>And</span> <span m='960090'>the</span> <span m='960210'>queries</span>
  <span m='960600'>we</span> <span m='960690'>can</span> <span m='960840'>achieve</span>
  <span m='961320'>are</span> <span m='961590'>constant</span> <span m='962010'>time,</span>
  <span m='964170'>child</span> <span m='964920'>with</span> <span m='965130'>label</span>
  <span m='965510'>i,</span> <span m='971670'>and</span> <span m='971850'>parent,</span>
  <span m='972960'>and</span> <span m='973230'>subtree</span> <span m='973620'>size.</span>
  <span m='981430'>So</span> <span m='981700'>we</span> <span m='981850'>can</span>
  <span m='981970'>do</span> <span m='982120'>all</span> <span m='982300'>the</span>
  <span m='982390'>things</span> <span m='982780'>we</span> <span m='982900'>were</span>
  <span m='982990'>able</span> <span m='983170'>to</span> <span m='983230'>do</span>
  <span m='983410'>before.</span> </p><p><span m='984680'>The</span> <span m='984940'>analog</span>
  <span m='985480'>of</span> <span m='985600'>left</span> <span m='985780'>child</span>
  <span m='986080'>and</span> <span m='986170'>right</span> <span m='986320'>child</span>
  <span m='986620'>now</span> <span m='986860'>is</span> <span m='987370'>I</span>
  <span m='987520'>have</span> <span m='987730'>a</span> <span m='987790'>character</span>
  <span m='988270'>in</span> <span m='988390'>my</span> <span m='988540'>pattern,</span>
  <span m='988990'>p,</span> <span m='989770'>and</span> <span m='989920'>I</span>
  <span m='990040'>want</span> <span m='990190'>to</span> <span m='990250'>know</span>
  <span m='990430'>which</span> <span m='990670'>child</span> <span m='991000'>has</span>
  <span m='991270'>that</span> <span m='991450'>label.</span> <span m='992120'>So</span>
  <span m='992830'>it's</span> <span m='992950'>not</span> <span m='993430'>the</span>
  <span m='993550'>same</span> <span m='993880'>as</span> <span m='993970'>finding</span>
  <span m='994210'>the</span> <span m='994360'>i-th</span> <span m='994630'>child</span>
  <span m='995080'>of</span> <span m='995200'>a</span> <span m='995260'>node.</span>
  <span m='997630'>The</span> <span m='997750'>edges</span> <span m='997990'>are</span>
  <span m='998080'>labeled</span> <span m='998470'>by</span> <span m='999370'>their</span>
  <span m='999520'>letter</span> <span m='999790'>in</span> <span m='999880'>the</span>
  <span m='999970'>alphabet,</span> <span m='1001080'>and</span> <span m='1001200'>you</span>
  <span m='1001320'>can</span> <span m='1001440'>achieve</span> <span m='1001770'>that.</span>
  <span m='1003030'>We</span> <span m='1003180'>had</span> <span m='1003300'>an</span>
  <span m='1003390'>earlier</span> <span m='1003720'>result</span> <span m='1004080'>that</span>
  <span m='1004350'>achieved</span> <span m='1004650'>like</span> <span m='1004830'>log</span>
  <span m='1005130'>log</span> <span m='1005460'>or</span> <span m='1005550'>something,</span>
  <span m='1005940'>and</span> <span m='1006030'>then</span> <span m='1006150'>finally
  it</span> <span m='1006450'>was</span> <span m='1006570'>brought</span> <span m='1006780'>down</span>
  <span m='1006930'>to</span> <span m='1007020'>constant</span> <span m='1008010'>by</span>
  <span m='1009840'>Farzan</span> <span m='1010500'>and</span> <span m='1010770'>Muno.</span>
  </p><p><span m='1013020'>So</span> <span m='1018380'>couple</span> <span m='1018740'>more.</span>
  <span m='1019070'>Why</span> <span m='1019160'>don't</span> <span m='1019340'>I</span>
  <span m='1019430'>just</span> <span m='1019700'>mention</span> <span m='1020120'>what</span>
  <span m='1020300'>they</span> <span m='1020450'>are?</span> <span m='1021080'>It's</span>
  <span m='1021410'>getting</span> <span m='1022100'>a</span> <span m='1022180'>little</span>
  <span m='1023550'>tedious.</span> </p><p><span m='1024490'>There's a</span> <span
  m='1024530'>lot</span> <span m='1024710'>of</span> <span m='1024800'>other</span>
  <span m='1024980'>things</span> <span m='1025190'>you</span> <span m='1025280'>might</span>
  <span m='1025430'>want</span> <span m='1025550'>to</span> <span m='1025640'>store.</span>
  <span m='1027589'>You</span> <span m='1027770'>can</span> <span m='1028339'>store</span>
  <span m='1029540'>succinct</span> <span m='1030020'>permutations,</span> <span m='1031000'>although</span>
  <span m='1031200'>there</span> <span m='1031270'>are</span> <span m='1031349'>some</span>
  <span m='1031550'>open</span> <span m='1031849'>problems</span> <span m='1032270'>here.</span>
  <span m='1032839'>So</span> <span m='1032930'>you</span> <span m='1033020'>want</span>
  <span m='1033170'>to</span> <span m='1033230'>store</span> <span m='1033589'>a</span>
  <span m='1033680'>permutation</span> <span m='1034369'>using</span> <span m='1034670'>log</span>
  <span m='1035030'>n</span> <span m='1035180'>factorial</span> <span m='1035750'>bits,</span>
  <span m='1036530'>plus</span> <span m='1036829'>little</span> <span m='1037010'>o
  of n.</span> </p><p><span m='1038359'>If</span> <span m='1038599'>you</span> <span
  m='1038750'>want</span> <span m='1038930'>to</span> <span m='1039000'>achieve</span>
  <span m='1039260'>succincts,</span> <span m='1039920'>the</span> <span m='1040040'>best</span>
  <span m='1040310'>known--</span> <span m='1041869'>oh,</span> <span m='1042050'>and</span>
  <span m='1042099'>the</span> <span m='1042339'>interesting</span> <span m='1042829'>query</span>
  <span m='1043640'>is</span> <span m='1043819'>you</span> <span m='1043940'>want</span>
  <span m='1044119'>to</span> <span m='1044180'>be</span> <span m='1044300'>able</span>
  <span m='1044510'>to</span> <span m='1044660'>do</span> <span m='1045079'>the</span>
  <span m='1045790'>k-th</span> <span m='1046220'>power</span> <span m='1046700'>of</span>
  <span m='1046819'>your</span> <span m='1046940'>permutation,</span> <span m='1047790'>so</span>
  <span m='1048380'>see</span> <span m='1048680'>where</span> <span m='1049250'>an</span>
  <span m='1049370'>item</span> <span m='1049640'>goes</span> <span m='1050030'>after</span>
  <span m='1050360'>k</span> <span m='1050630'>steps.</span> <span m='1051620'>Best</span>
  <span m='1051800'>query</span> <span m='1052160'>known</span> <span m='1052370'>for</span>
  <span m='1052460'>that</span> <span m='1052640'>is</span> <span m='1052760'>log</span>
  <span m='1053070'>n</span> <span m='1053180'>over</span> <span m='1053390'>log</span>
  <span m='1053630'>log</span> <span m='1053840'>n</span> <span m='1053960'>if</span>
  <span m='1054080'>you</span> <span m='1054200'>want</span> <span m='1054350'>succinct.</span>
  </p><p><span m='1055400'>If</span> <span m='1055550'>you</span> <span m='1055670'>only</span>
  <span m='1056000'>want</span> <span m='1056330'>compact,</span> <span m='1057800'>then</span>
  <span m='1058220'>it's</span> <span m='1058400'>known</span> <span m='1058550'>how</span>
  <span m='1058680'>to</span> <span m='1058760'>do</span> <span m='1058880'>constant</span>
  <span m='1059300'>time.</span> <span m='1060090'>So</span> <span m='1060320'>an</span>
  <span m='1060440'>interesting</span> <span m='1060830'>open</span> <span m='1061070'>question</span>
  <span m='1061370'>is,</span> <span m='1061460'>can</span> <span m='1061640'>you</span>
  <span m='1061730'>achieve</span> <span m='1062030'>succinct</span> <span m='1062570'>constant</span>
  <span m='1063060'>time</span> <span m='1063270'>queries?</span> <span m='1065210'>If</span>
  <span m='1065450'>you</span> <span m='1065540'>relax</span> <span m='1065930'>either,</span>
  <span m='1066380'>then</span> <span m='1066640'>it's</span> <span m='1066935'>known</span>
  <span m='1067230'>how</span> <span m='1067550'>to</span> <span m='1067670'>do</span>
  <span m='1067850'>it.</span> <span m='1068850'>There's</span> <span m='1069020'>a</span>
  <span m='1069050'>generalization</span> <span m='1069800'>of</span> <span m='1069920'>this</span>
  <span m='1070100'>to</span> <span m='1070230'>functions,</span> <span m='1072290'>where</span>
  <span m='1072560'>one</span> <span m='1072740'>of</span> <span m='1072800'>those</span>
  <span m='1072980'>results</span> <span m='1073400'>is</span> <span m='1073490'>known,</span>
  <span m='1073820'>the</span> <span m='1073910'>other</span> <span m='1074060'>one</span>
  <span m='1074210'>isn't.</span> </p><p><span m='1077000'>You</span> <span m='1077210'>can</span>
  <span m='1077420'>try</span> <span m='1077660'>to</span> <span m='1077780'>do</span>
  <span m='1078230'>Abelian</span> <span m='1078770'>groups.</span> <span m='1086906'>There
  are</span> <span m='1087330'>finite</span> <span m='1087860'>Abelian</span> <span
  m='1088220'>groups.</span> <span m='1088530'>There</span> <span m='1088710'>aren't</span>
  <span m='1089120'>too</span> <span m='1089330'>many</span> <span m='1089600'>different</span>
  <span m='1089870'>ones, and</span> <span m='1090140'>you</span> <span m='1090290'>can</span>
  <span m='1090710'>represent</span> <span m='1091190'>an</span> <span m='1091310'>entire</span>
  <span m='1091790'>Abelian</span> <span m='1092240'>group</span> <span m='1092510'>on</span>
  <span m='1092690'>n</span> <span m='1092900'>items</span> <span m='1093770'>using</span>
  <span m='1094070'>log</span> <span m='1094380'>n</span> <span m='1094490'>bits,</span>
  <span m='1095090'>which</span> <span m='1095110'>is</span> <span m='1095240'>pretty</span>
  <span m='1095450'>crazy,</span> <span m='1095780'>order</span> <span m='1096050'>log</span>
  <span m='1096260'>n</span> <span m='1096410'>bits.</span> <span m='1097430'>And</span>
  <span m='1097580'>you</span> <span m='1097700'>can</span> <span m='1097820'>represent</span>
  <span m='1098180'>an</span> <span m='1098300'>item</span> <span m='1098570'>in</span>
  <span m='1098690'>that</span> <span m='1098840'>group</span> <span m='1099140'>in</span>
  <span m='1099350'>log</span> <span m='1099590'>n</span> <span m='1099680'>bits</span>
  <span m='1100010'>and</span> <span m='1100100'>do</span> <span m='1100850'>multiplication,</span>
  <span m='1101580'>inverse,</span> <span m='1102510'>and</span> <span m='1102850'>equality</span>
  <span m='1103190'>testing.</span> </p><p><span m='1104480'>There's</span> <span
  m='1104660'>other</span> <span m='1104930'>results</span> <span m='1105500'>on</span>
  <span m='1105830'>graphs,</span> <span m='1106480'>which</span> <span m='1106650'>I</span>
  <span m='1106730'>won't</span> <span m='1106880'>get</span> <span m='1107030'>into.</span>
  <span m='1107270'>Those</span> <span m='1107480'>are</span> <span m='1107540'>a</span>
  <span m='1107570'>little</span> <span m='1108140'>harder</span> <span m='1108410'>to</span>
  <span m='1108560'>state.</span> </p><p><span m='1110210'>And</span> <span m='1110360'>then</span>
  <span m='1110540'>another</span> <span m='1110990'>interesting</span> <span m='1111470'>case</span>
  <span m='1111830'>is</span> <span m='1112370'>integers.</span> <span m='1114890'>So</span>
  <span m='1115550'>you</span> <span m='1115670'>want</span> <span m='1115850'>to</span>
  <span m='1115910'>store</span> <span m='1116120'>an</span> <span m='1116240'>integer</span>
  <span m='1116660'>and</span> <span m='1116750'>you</span> <span m='1116840'>want</span>
  <span m='1116990'>to</span> <span m='1117050'>be</span> <span m='1117140'>able</span>
  <span m='1117260'>to</span> <span m='1117350'>increment</span> <span m='1117860'>and</span>
  <span m='1117980'>decrement</span> <span m='1118460'>the</span> <span m='1118550'>integer.</span>
  <span m='1119840'>And</span> <span m='1120020'>you</span> <span m='1120110'>want</span>
  <span m='1120320'>to</span> <span m='1120380'>do</span> <span m='1120650'>as</span>
  <span m='1120860'>few</span> <span m='1121370'>bit</span> <span m='1121600'>operations</span>
  <span m='1122150'>as</span> <span m='1122270'>possible.</span> </p><p><span m='1123470'>Worst</span>
  <span m='1123740'>case,</span> <span m='1125660'>for</span> <span m='1125840'>example,</span>
  <span m='1126270'>if</span> <span m='1126370'>you</span> <span m='1126470'>have</span>
  <span m='1126570'>lots</span> <span m='1126680'>of</span> <span m='1126800'>1s</span>
  <span m='1127820'>in</span> <span m='1127970'>your</span> <span m='1128090'>bit</span>
  <span m='1128330'>string,</span> <span m='1128570'>you</span> <span m='1128660'>do</span>
  <span m='1128810'>an</span> <span m='1128900'>increment,</span> <span m='1129320'>you</span>
  <span m='1129410'>don't</span> <span m='1129560'>want</span> <span m='1129680'>to</span>
  <span m='1130550'>pay</span> <span m='1131210'>linear</span> <span m='1131690'>costs,</span>
  <span m='1132160'>linear</span> <span m='1132440'>number</span> <span m='1132650'>of</span>
  <span m='1132710'>bit</span> <span m='1132860'>updates</span> <span m='1133310'>to</span>
  <span m='1133400'>do</span> <span m='1133580'>it.</span> <span m='1135020'>And</span>
  <span m='1135200'>so</span> <span m='1135680'>you</span> <span m='1135920'>can</span>
  <span m='1136280'>achieve</span> <span m='1137600'>implicit,</span> <span m='1138290'>so</span>
  <span m='1139430'>just</span> <span m='1139640'>a</span> <span m='1139670'>constant</span>
  <span m='1140060'>number</span> <span m='1140270'>of</span> <span m='1140360'>extra</span>
  <span m='1140660'>bits</span> <span m='1140960'>of</span> <span m='1141050'>space.</span>
  <span m='1143960'>If</span> <span m='1144170'>I</span> <span m='1144230'>have</span>
  <span m='1144350'>an</span> <span m='1144450'>n-bit</span> <span m='1144800'>integer,</span>
  <span m='1146430'>then</span> <span m='1146600'>I</span> <span m='1146750'>can</span>
  <span m='1146960'>do</span> <span m='1147470'>an</span> <span m='1147740'>increment</span>
  <span m='1149480'>or</span> <span m='1149630'>a</span> <span m='1149730'>decrement</span>
  <span m='1152210'>in</span> <span m='1153830'>order</span> <span m='1154160'>log</span>
  <span m='1154640'>n</span> <span m='1156090'>bit</span> <span m='1156290'>reads,</span>
  <span m='1159560'>and</span> <span m='1160280'>constant</span> <span m='1160940'>bit</span>
  <span m='1161180'>writes.</span> <span m='1165520'>And</span> <span m='1165650'>this</span>
  <span m='1165830'>is</span> <span m='1165980'>Raman</span> <span m='1166430'>and</span>
  <span m='1166600'>Munro</span> <span m='1167450'>from</span> <span m='1167660'>a</span>
  <span m='1167720'>couple</span> <span m='1167990'>years</span> <span m='1168200'>ago.</span>
  </p><p><span m='1169710'>So</span> <span m='1169760'>this</span> <span m='1169940'>is</span>
  <span m='1170060'>pretty</span> <span m='1170390'>good.</span> <span m='1170600'>Of</span>
  <span m='1170720'>course,</span> <span m='1170930'>ideal</span> <span m='1171290'>would</span>
  <span m='1171470'>be</span> <span m='1171650'>to</span> <span m='1171740'>do</span>
  <span m='1171950'>a</span> <span m='1172040'>constant</span> <span m='1172700'>number</span>
  <span m='1173450'>of--</span> <span m='1174480'>well, a constant number of</span>
  <span m='1174920'>bit</span> <span m='1175220'>reads</span> <span m='1175520'>or</span>
  <span m='1175610'>writes</span> <span m='1175940'>would</span> <span m='1176060'>be</span>
  <span m='1176300'>optimal,</span> <span m='1176900'>I</span> <span m='1176990'>guess.</span>
  <span m='1178430'>I</span> <span m='1178700'>personally</span> <span m='1179120'>would</span>
  <span m='1179210'>be</span> <span m='1179270'>interested</span> <span m='1179600'>in</span>
  <span m='1179720'>getting a</span> <span m='1179990'>constant</span> <span m='1180380'>number</span>
  <span m='1180620'>of</span> <span m='1180740'>word</span> <span m='1181160'>reads</span>
  <span m='1181490'>and</span> <span m='1181610'>writes.</span> <span m='1183710'>But</span>
  <span m='1183950'>that's</span> <span m='1184250'>an</span> <span m='1184370'>open</span>
  <span m='1184640'>problem,</span> <span m='1185000'>I</span> <span m='1185090'>believe.</span>
  </p><p><span m='1186530'>So</span> <span m='1188380'>there's</span> <span m='1188600'>only</span>
  <span m='1188840'>order</span> <span m='1189050'>n</span> <span m='1189170'>bit</span>
  <span m='1189350'>reads.</span> <span m='1189710'>If</span> <span m='1189800'>they</span>
  <span m='1189940'>were</span> <span m='1190070'>all</span> <span m='1190220'>consecutive,</span>
  <span m='1190850'>that</span> <span m='1191030'>would</span> <span m='1191180'>be</span>
  <span m='1191750'>a</span> <span m='1191880'>constant</span> <span m='1192230'>number</span>
  <span m='1192440'>of</span> <span m='1192530'>word</span> <span m='1192800'>reads,</span>
  <span m='1193100'>but</span> <span m='1193250'>they're</span> <span m='1193400'>kind</span>
  <span m='1193580'>of</span> <span m='1193640'>spread</span> <span m='1193970'>out.</span>
  <span m='1194675'>It'd</span> <span m='1195080'>be</span> <span m='1195170'>nice</span>
  <span m='1195440'>to</span> <span m='1195560'>get</span> <span m='1196460'>constant</span>
  <span m='1196850'>number</span> <span m='1197120'>of</span> <span m='1197270'>word</span>
  <span m='1199100'>operations.</span> </p><p><span m='1203740'>So</span> <span m='1203820'>that's</span>
  <span m='1204030'>a</span> <span m='1204090'>quick</span> <span m='1204300'>survey</span>
  <span m='1204690'>of</span> <span m='1204780'>what's</span> <span m='1205020'>known.</span>
  </p><p><span m='1207300'>Let's</span> <span m='1207510'>do</span> <span m='1207660'>some</span>
  <span m='1207840'>actual</span> <span m='1208350'>data</span> <span m='1208560'>structures</span>
  <span m='1208980'>now.</span> <span m='1209200'>So</span> <span m='1209400'>we're</span>
  <span m='1209490'>going</span> <span m='1209600'>to</span> <span m='1209700'>be</span>
  <span m='1209790'>focusing</span> <span m='1210390'>on</span> <span m='1212190'>this</span>
  <span m='1214140'>synced</span> <span m='1214680'>binary</span> <span m='1215060'>tries.</span>
  <span m='1216930'>And</span> <span m='1217260'>we're</span> <span m='1217360'>going</span>
  <span m='1217500'>to</span> <span m='1217560'>do</span> <span m='1217680'>two</span>
  <span m='1217920'>versions</span> <span m='1218340'>of</span> <span m='1218490'>it.</span>
  <span m='1218700'>One</span> <span m='1218940'>of</span> <span m='1219000'>them</span>
  <span m='1219390'>is</span> <span m='1220860'>level</span> <span m='1221220'>order.</span>
  <span m='1232920'>And</span> <span m='1233190'>the</span> <span m='1233310'>other</span>
  <span m='1233550'>will</span> <span m='1233760'>use</span> <span m='1234120'>a</span>
  <span m='1234230'>balanced</span> <span m='1234570'>parenthesis</span> <span m='1235110'>representation.</span>
  </p><p><span m='1238140'>So</span> <span m='1239760'>let's</span> <span m='1239880'>start</span>
  <span m='1240090'>with</span> <span m='1240220'>the</span> <span m='1240300'>level</span>
  <span m='1240570'>order</span> <span m='1240780'>one.</span> <span m='1240960'>This</span>
  <span m='1241140'>is</span> <span m='1241230'>very</span> <span m='1241470'>easy.</span>
  <span m='1285990'>So</span> <span m='1286670'>I'm</span> <span m='1286820'>going</span>
  <span m='1287060'>to</span> <span m='1287390'>just</span> <span m='1287570'>loop</span>
  <span m='1287840'>over</span> <span m='1288050'>the</span> <span m='1288140'>nodes</span>
  <span m='1288410'>in</span> <span m='1288500'>my</span> <span m='1288740'>try</span>
  <span m='1289550'>in</span> <span m='1289730'>level</span> <span m='1290030'>order,</span>
  <span m='1290390'>so</span> <span m='1290570'>level</span> <span m='1290870'>by</span>
  <span m='1291050'>level,</span> <span m='1291950'>and</span> <span m='1292160'>write</span>
  <span m='1292460'>one</span> <span m='1292700'>bit</span> <span m='1292910'>to</span>
  <span m='1293030'>say</span> <span m='1293240'>whether</span> <span m='1293420'>there's</span>
  <span m='1293630'>a</span> <span m='1293690'>left</span> <span m='1293900'>child</span>
  <span m='1294410'>and</span> <span m='1294530'>one</span> <span m='1294710'>bit</span>
  <span m='1294830'>to</span> <span m='1294950'>say</span> <span m='1295130'>whether</span>
  <span m='1295340'>there's</span> <span m='1295550'>a</span> <span m='1295610'>right</span>
  <span m='1295790'>child.</span> </p><p><span m='1296660'>Let's</span> <span m='1296840'>do</span>
  <span m='1297140'>a</span> <span m='1297170'>little</span> <span m='1297380'>example.</span>
  <span m='1321000'>So</span> <span m='1321140'>here</span> <span m='1321410'>is</span>
  <span m='1321620'>a</span> <span m='1322760'>binary</span> <span m='1323090'>try.</span>
  <span m='1326110'>And</span> <span m='1326300'>I'm</span> <span m='1326360'>going</span>
  <span m='1326480'>to</span> <span m='1326570'>write</span> <span m='1328230'>a</span>
  <span m='1328580'>bit</span> <span m='1328930'>string</span> <span m='1329240'>for</span>
  <span m='1329510'>it.</span> <span m='1330680'>So</span> <span m='1330830'>first,</span>
  <span m='1331070'>I'm</span> <span m='1331490'>going to</span> <span m='1331710'>look</span>
  <span m='1331850'>at</span> <span m='1331910'>the</span> <span m='1332000'>top</span>
  <span m='1332270'>level.</span> <span m='1333140'>I</span> <span m='1333200'>have</span>
  <span m='1333590'>the</span> <span m='1333710'>node</span> <span m='1333980'>A.</span>
  <span m='1334672'>It has</span> <span m='1335020'>a</span> <span m='1335060'>left</span>
  <span m='1335270'>child</span> <span m='1335600'>of</span> <span m='1335660'>B,</span>
  <span m='1336290'>right</span> <span m='1336470'>child of</span> <span m='1336830'>C,</span>
  <span m='1337340'>so</span> <span m='1337550'>I</span> <span m='1337640'>write</span>
  <span m='1338480'>1,</span> <span m='1339206'>1.</span> <span m='1340270'>And</span>
  <span m='1340620'>this</span> <span m='1340820'>corresponds</span> <span m='1341330'>to</span>
  <span m='1341450'>B.</span> <span m='1342180'>This</span> <span m='1342410'>corresponds</span>
  <span m='1342890'>to</span> <span m='1342970'>C.</span> </p><p><span m='1344930'>OK.</span>
  <span m='1346340'>Then</span> <span m='1346760'>next</span> <span m='1347030'>level
  is</span> <span m='1347450'>B.</span> <span m='1347930'>It</span> <span m='1348080'>has</span>
  <span m='1348410'>no</span> <span m='1348680'>left</span> <span m='1348980'>child</span>
  <span m='1350330'>and</span> <span m='1350510'>it</span> <span m='1350570'>has</span>
  <span m='1350840'>a</span> <span m='1350900'>right</span> <span m='1351140'>child,</span>
  <span m='1351740'>which</span> <span m='1351950'>is</span> <span m='1352130'>D.</span>
  <span m='1353150'>I'm</span> <span m='1353250'>just</span> <span m='1353420'>writing</span>
  <span m='1353690'>down</span> <span m='1353900'>the</span> <span m='1353990'>labels</span>
  <span m='1354320'>so</span> <span m='1354440'>I</span> <span m='1354500'>don't</span>
  <span m='1354680'>get</span> <span m='1354830'>lost.</span> </p><p><span m='1355970'>Then</span>
  <span m='1356210'>we</span> <span m='1356330'>have</span> <span m='1356900'>node</span>
  <span m='1357200'>C,</span> <span m='1360170'>which</span> <span m='1360560'>has</span>
  <span m='1363040'>a</span> <span m='1363100'>left</span> <span m='1363340'>child</span>
  <span m='1363880'>and</span> <span m='1364000'>a</span> <span m='1364060'>right</span>
  <span m='1364250'>child,</span> <span m='1364740'>E</span> <span m='1365080'>and</span>
  <span m='1365250'>F.</span> <span m='1367640'>Then</span> <span m='1367990'>we</span>
  <span m='1368140'>have</span> <span m='1368750'>node D,</span> <span m='1369470'>which</span>
  <span m='1369830'>has</span> <span m='1369970'>no</span> <span m='1370150'>left</span>
  <span m='1370390'>child.</span> <span m='1371365'>It</span> <span m='1371710'>has</span>
  <span m='1371870'>a</span> <span m='1371920'>right</span> <span m='1372130'>child,</span>
  <span m='1374610'>which</span> <span m='1374630'>is</span> <span m='1374870'>G.</span>
  </p><p><span m='1376481'>Node E</span> <span m='1376900'>has</span> <span m='1377260'>no</span>
  <span m='1377530'>children.</span> <span m='1378770'>Node</span> <span m='1379020'>F</span>
  <span m='1379420'>has</span> <span m='1379720'>no</span> <span m='1379930'>children.</span>
  <span m='1381230'>Node</span> <span m='1381370'>G</span> <span m='1381790'>has</span>
  <span m='1382150'>no</span> <span m='1382390'>children.</span> </p><p><span m='1385250'>OK.</span>
  <span m='1385480'>So</span> <span m='1385660'>there</span> <span m='1385930'>is</span>
  <span m='1386110'>a</span> <span m='1386500'>2n-bit</span> <span m='1387080'>string.</span>
  <span m='1387380'>This</span> <span m='1387520'>is</span> <span m='1387640'>obviously</span>
  <span m='1388300'>2n</span> <span m='1388950'>bits</span> <span m='1392710'>for</span>
  <span m='1393190'>n</span> <span m='1393370'>nodes,</span> <span m='1394850'>so</span>
  <span m='1394900'>this</span> <span m='1395050'>is</span> <span m='1395140'>one</span>
  <span m='1395350'>way</span> <span m='1395470'>to</span> <span m='1395560'>prove</span>
  <span m='1395860'>there's</span> <span m='1396040'>at</span> <span m='1396130'>most</span>
  <span m='1396400'>four</span> <span m='1396560'>to</span> <span m='1396660'>the</span>
  <span m='1396850'>n</span> <span m='1397470'>tries.</span> <span m='1399140'>And</span>
  <span m='1401860'>well,</span> <span m='1402130'>we'll</span> <span m='1402340'>talk</span>
  <span m='1402550'>about</span> <span m='1403240'>how</span> <span m='1403390'>useful</span>
  <span m='1403750'>it</span> <span m='1403840'>is.</span> </p><p><span m='1404210'>I</span>
  <span m='1404310'>want</span> <span m='1404320'>to</span> <span m='1404380'>give</span>
  <span m='1404530'>you</span> <span m='1404620'>another</span> <span m='1404920'>representation</span>
  <span m='1405760'>of</span> <span m='1406030'>the</span> <span m='1406120'>same</span>
  <span m='1406390'>thing,</span> <span m='1407840'>which</span> <span m='1407980'>is</span>
  <span m='1409390'>if</span> <span m='1409540'>we</span> <span m='1409630'>take</span>
  <span m='1409810'>these</span> <span m='1409990'>nodes</span> <span m='1410800'>and</span>
  <span m='1410980'>add</span> <span m='1411340'>on--</span> <span m='1412290'>wherever</span>
  <span m='1412600'>there's</span> <span m='1412810'>an</span> <span m='1412930'>absent</span>
  <span m='1413380'>leaf,</span> <span m='1413780'>I'm</span> <span m='1413880'>going</span>
  <span m='1413980'>to</span> <span m='1414080'>add</span> <span m='1414280'>what</span>
  <span m='1414430'>we</span> <span m='1414580'>call</span> <span m='1414940'>an</span>
  <span m='1415060'>external</span> <span m='1415540'>node,</span> <span m='1416800'>as</span>
  <span m='1417040'>you</span> <span m='1417160'>sometimes</span> <span m='1417580'>see</span>
  <span m='1417910'>in</span> <span m='1418090'>data</span> <span m='1418300'>structures</span>
  <span m='1418690'>books.</span> <span m='1420310'>One</span> <span m='1420520'>way</span>
  <span m='1420640'>to</span> <span m='1420730'>represent</span> <span m='1421180'>a</span>
  <span m='1421240'>null</span> <span m='1421450'>pointer,</span> <span m='1421840'>say,</span>
  <span m='1422080'>oh,</span> <span m='1422260'>there's</span> <span m='1422440'>a</span>
  <span m='1422500'>node</span> <span m='1422740'>there</span> <span m='1423190'>that</span>
  <span m='1423310'>has</span> <span m='1423490'>no</span> <span m='1423640'>children.</span>
  <span m='1426170'>This</span> <span m='1426340'>unifies</span> <span m='1427060'>things</span>
  <span m='1427270'>a</span> <span m='1427330'>little</span> <span m='1427570'>bit,</span>
  <span m='1427750'>because</span> <span m='1427930'>now</span> <span m='1428140'>every</span>
  <span m='1428350'>node</span> <span m='1428590'>either</span> <span m='1428800'>has</span>
  <span m='1428980'>two</span> <span m='1429160'>children</span> <span m='1429580'>or</span>
  <span m='1429670'>no</span> <span m='1429850'>children.</span> <span m='1431530'>Another</span>
  <span m='1431860'>way</span> <span m='1431980'>to</span> <span m='1432070'>think</span>
  <span m='1432250'>about</span> <span m='1432490'>the</span> <span m='1432580'>same</span>
  <span m='1432820'>thing.</span> </p><p><span m='1434650'>And</span> <span m='1434800'>it</span>
  <span m='1434860'>turns</span> <span m='1435190'>out</span> <span m='1436330'>if</span>
  <span m='1436450'>you</span> <span m='1436540'>look</span> <span m='1436720'>at</span>
  <span m='1436810'>this</span> <span m='1436990'>bit</span> <span m='1437170'>string</span>
  <span m='1438880'>and</span> <span m='1439600'>add</span> <span m='1439810'>a</span>
  <span m='1439900'>1</span> <span m='1440230'>in</span> <span m='1440350'>front--</span>
  <span m='1441810'>so I'll</span> <span m='1442000'>put</span> <span m='1442180'>this</span>
  <span m='1442330'>one</span> <span m='1442480'>in</span> <span m='1442570'>parentheses--</span>
  <span m='1444760'>then</span> <span m='1445850'>what</span> <span m='1446170'>this</span>
  <span m='1446380'>is</span> <span m='1446500'>encoding</span> <span m='1447190'>is</span>
  <span m='1447720'>just</span> <span m='1447940'>for</span> <span m='1448060'>every</span>
  <span m='1448390'>node</span> <span m='1449320'>in</span> <span m='1449470'>level</span>
  <span m='1449800'>order,</span> <span m='1450640'>are</span> <span m='1450790'>you</span>
  <span m='1450970'>a</span> <span m='1451060'>real</span> <span m='1451360'>node</span>
  <span m='1451660'>or</span> <span m='1451780'>are</span> <span m='1451960'>you</span>
  <span m='1452110'>an</span> <span m='1452170'>external</span> <span m='1452620'>node?</span>
  <span m='1453220'>Are</span> <span m='1453340'>you</span> <span m='1453460'>an</span>
  <span m='1453550'>internal</span> <span m='1453910'>node</span> <span m='1454120'>or</span>
  <span m='1454180'>an</span> <span m='1454270'>external</span> <span m='1454690'>node?</span>
  </p><p><span m='1456060'>A</span> <span m='1456430'>here</span> <span m='1457990'>is</span>
  <span m='1458200'>internal.</span> <span m='1458770'>B</span> <span m='1459160'>is</span>
  <span m='1459490'>internal.</span> <span m='1459790'>C</span> <span m='1460090'>is</span>
  <span m='1460450'>internal.</span> <span m='1461290'>This</span> <span m='1461530'>is</span>
  <span m='1461710'>an</span> <span m='1461800'>external</span> <span m='1462310'>node.</span>
  <span m='1464110'>Then</span> <span m='1464350'>this</span> <span m='1464560'>is</span>
  <span m='1464680'>internal,</span> <span m='1465580'>internal,</span> <span m='1466540'>internal.</span>
  </p><p><span m='1467590'>Then</span> <span m='1468610'>external,</span> <span m='1470110'>G,</span>
  <span m='1471110'>external,</span> <span m='1471610'>external,</span> <span m='1472110'>external,</span>
  <span m='1472610'>external,</span> <span m='1473610'>external,</span> <span m='1474005'>external.</span>
  <span m='1475450'>The</span> <span m='1475570'>zeros</span> <span m='1475870'>correspond</span>
  <span m='1476320'>to</span> <span m='1476380'>external</span> <span m='1476710'>nodes</span>
  <span m='1476920'>because</span> <span m='1477100'>those</span> <span m='1477250'>are</span>
  <span m='1477340'>absent</span> <span m='1477700'>children.</span> </p><p><span
  m='1478490'>So</span> <span m='1478620'>same</span> <span m='1478960'>thing.</span>
  <span m='1480216'>So</span> <span m='1480710'>I'll</span> <span m='1480730'>write</span>
  <span m='1481030'>equivalently,</span> <span m='1491690'>1</span> <span m='1492050'>equals</span>
  <span m='1492440'>an</span> <span m='1492530'>internal</span> <span m='1492920'>node</span>
  <span m='1497920'>and</span> <span m='1498260'>0</span> <span m='1499430'>equals</span>
  <span m='1499760'>an</span> <span m='1499860'>external</span> <span m='1500290'>node.</span>
  </p><p><span m='1512530'>Of</span> <span m='1512650'>course,</span> <span m='1512890'>to</span>
  <span m='1513010'>do</span> <span m='1513160'>this,</span> <span m='1513370'>we</span>
  <span m='1513490'>need</span> <span m='1513670'>one</span> <span m='1513850'>more</span>
  <span m='1514030'>bit.</span> <span m='1518720'>And</span> <span m='1518970'>I'm</span>
  <span m='1519190'>going</span> <span m='1519340'>to</span> <span m='1519430'>take</span>
  <span m='1519670'>this</span> <span m='1519880'>view</span> <span m='1520330'>primarily,</span>
  <span m='1520960'>because</span> <span m='1521290'>it's</span> <span m='1521530'>a</span>
  <span m='1521590'>little</span> <span m='1521920'>easier</span> <span m='1522220'>to</span>
  <span m='1522340'>work.</span> <span m='1522550'>It</span> <span m='1522910'>doesn't</span>
  <span m='1523180'>really</span> <span m='1523420'>make</span> <span m='1523600'>much
  of a</span> <span m='1523870'>difference,</span> <span m='1524260'>just</span> <span
  m='1524380'>shifts</span> <span m='1524650'>everything</span> <span m='1525040'>over</span>
  <span m='1525250'>by</span> <span m='1525400'>1.</span> <span m='1527350'>And</span>
  <span m='1527890'>I'd</span> <span m='1528040'>like</span> <span m='1528220'>to</span>
  <span m='1528490'>write</span> <span m='1528730'>down</span> <span m='1529840'>the</span>
  <span m='1530020'>indices</span> <span m='1530560'>here,</span> <span m='1530800'>so</span>
  <span m='1531010'>we</span> <span m='1531100'>have</span> <span m='1531280'>1,</span>
  <span m='1531740'>2,</span> <span m='1532200'>3,</span> <span m='1533120'>4,</span>
  <span m='1533580'>5,</span> <span m='1534500'>6,</span> <span m='1534960'>7</span>
  <span m='1543580'>into</span> <span m='1543820'>this</span> <span m='1544000'>array.</span>
  </p><p><span m='1546340'>Because</span> <span m='1546700'>now</span> <span m='1547000'>our</span>
  <span m='1547090'>challenge</span> <span m='1547450'>is</span> <span m='1547810'>all</span>
  <span m='1548080'>right, great.</span> <span m='1548350'>We've</span> <span m='1548530'>represented</span>
  <span m='1549130'>a</span> <span m='1549190'>binary</span> <span m='1549680'>try.</span>
  <span m='1550090'>But</span> <span m='1550240'>we</span> <span m='1550420'>want</span>
  <span m='1550570'>to</span> <span m='1550660'>be</span> <span m='1550780'>able</span>
  <span m='1550900'>to</span> <span m='1551050'>do</span> <span m='1551200'>constant</span>
  <span m='1551500'>time,</span> <span m='1551980'>left</span> <span m='1552250'>child,</span>
  <span m='1552760'>right</span> <span m='1552970'>child,</span> <span m='1553510'>parent.</span>
  <span m='1554170'>We're</span> <span m='1554290'>not</span> <span m='1554410'>going</span>
  <span m='1554530'>to</span> <span m='1554620'>be</span> <span m='1554710'>able</span>
  <span m='1554830'>to</span> <span m='1554890'>do</span> <span m='1555010'>subtree</span>
  <span m='1555460'>size.</span> <span m='1555810'>Level</span> <span m='1556120'>order</span>
  <span m='1556460'>is</span> <span m='1556540'>really</span> <span m='1556810'>not</span>
  <span m='1557020'>good</span> <span m='1557260'>for</span> <span m='1557380'>subtree</span>
  <span m='1557770'>size.</span> <span m='1558520'>But</span> <span m='1558640'>left</span>
  <span m='1558850'>child,</span> <span m='1559090'>right</span> <span m='1559240'>child,</span>
  <span m='1559540'>and</span> <span m='1559660'>parent</span> <span m='1560440'>we</span>
  <span m='1560590'>can</span> <span m='1560740'>do</span> <span m='1561010'>in</span>
  <span m='1561160'>constant</span> <span m='1561520'>time.</span> </p><p><span m='1564410'>And</span>
  <span m='1564610'>the</span> <span m='1564730'>reason</span> <span m='1565010'>that</span>
  <span m='1565060'>we</span> <span m='1565150'>can</span> <span m='1565270'>do</span>
  <span m='1565390'>it</span> <span m='1565450'>in</span> <span m='1565540'>constant</span>
  <span m='1565870'>time</span> <span m='1566920'>is</span> <span m='1567010'>because</span>
  <span m='1567220'>there's</span> <span m='1567370'>a</span> <span m='1567430'>nice</span>
  <span m='1567670'>lemma,</span> <span m='1568390'>kind</span> <span m='1568630'>of</span>
  <span m='1568720'>analogous</span> <span m='1569260'>to</span> <span m='1571180'>binary</span>
  <span m='1571600'>heaps.</span> </p><p></p><p><span m='1615800'>So</span> <span
  m='1616670'>the</span> <span m='1616760'>claim</span> <span m='1617060'>is</span>
  <span m='1617180'>if</span> <span m='1617300'>we</span> <span m='1617390'>look</span>
  <span m='1617660'>at</span> <span m='1617930'>the</span> <span m='1618560'>i-th</span>
  <span m='1619010'>internal</span> <span m='1619580'>node,</span> <span m='1619990'>so</span>
  <span m='1620060'>for</span> <span m='1620180'>example</span> <span m='1621200'>C</span>
  <span m='1621680'>is</span> <span m='1621920'>the</span> <span m='1622070'>third</span>
  <span m='1622400'>internal</span> <span m='1622820'>node,</span> <span m='1623980'>so</span>
  <span m='1624410'>internal</span> <span m='1624770'>node</span> <span m='1624950'>number</span>
  <span m='1625280'>3,</span> <span m='1626690'>then</span> <span m='1627020'>we</span>
  <span m='1627200'>look</span> <span m='1627410'>at</span> <span m='1627470'>positions</span>
  <span m='1628340'>2</span> <span m='1628550'>times</span> <span m='1628970'>3,</span>
  <span m='1629240'>and</span> <span m='1629330'>2</span> <span m='1629480'>times</span>
  <span m='1629680'>3</span> <span m='1629840'>plus</span> <span m='1630080'>1,</span>
  <span m='1630270'>so</span> <span m='1630410'>6</span> <span m='1630800'>and</span>
  <span m='1630920'>7</span> <span m='1631820'>in</span> <span m='1631940'>this</span>
  <span m='1632120'>array.</span> <span m='1632960'>And</span> <span m='1633080'>we</span>
  <span m='1633170'>get</span> <span m='1633350'>the</span> <span m='1633440'>two</span>
  <span m='1633710'>children</span> <span m='1634250'>E</span> <span m='1634430'>and</span>
  <span m='1634550'>F.</span> <span m='1635930'>So</span> <span m='1636650'>that</span>
  <span m='1636800'>worked.</span> <span m='1637040'>6</span> <span m='1637310'>and</span>
  <span m='1637400'>7</span> <span m='1638140'>are</span> <span m='1638290'>E</span>
  <span m='1638390'>and F.</span> </p><p><span m='1639800'>Or</span> <span m='1640430'>this</span>
  <span m='1640580'>one</span> <span m='1640760'>would</span> <span m='1640840'>be</span>
  <span m='1641090'>the</span> <span m='1641330'>fourth</span> <span m='1642000'>internal</span>
  <span m='1642440'>node.</span> <span m='1642740'>D is</span> <span m='1643150'>the</span>
  <span m='1643250'>fourth</span> <span m='1643490'>internal</span> <span m='1643820'>node.</span>
  <span m='1645560'>And</span> <span m='1645980'>so</span> <span m='1646430'>at</span>
  <span m='1646570'>positions</span> <span m='1647000'>8</span> <span m='1647240'>and</span>
  <span m='1647360'>9</span> <span m='1647840'>should</span> <span m='1648050'>be</span>
  <span m='1648170'>this</span> <span m='1648380'>external</span> <span m='1648800'>node</span>
  <span m='1649100'>and</span> <span m='1649340'>G.</span> <span m='1650200'>8</span>
  <span m='1650630'>is</span> <span m='1650750'>an</span> <span m='1650810'>external</span>
  <span m='1651170'>node.</span> <span m='1651410'>9</span> <span m='1651710'>is</span>
  <span m='1651860'>g.</span> <span m='1653310'>So</span> <span m='1653460'>it</span>
  <span m='1653530'>works.</span> </p><p><span m='1654870'>This is a</span> <span
  m='1655060'>lemma.</span> <span m='1656520'>You</span> <span m='1656680'>can</span>
  <span m='1656830'>prove</span> <span m='1657070'>it</span> <span m='1657190'>pretty</span>
  <span m='1657430'>easily</span> <span m='1661300'>by</span> <span m='1661540'>induction</span>
  <span m='1661990'>on</span> <span m='1662210'>i.</span> <span m='1666966'>So</span>
  <span m='1668910'>the</span> <span m='1669000'>idea</span> <span m='1669210'>is,</span>
  <span m='1669430'>well,</span> <span m='1669760'>if</span> <span m='1669900'>you</span>
  <span m='1670020'>look</span> <span m='1670260'>at</span> <span m='1671790'>let's</span>
  <span m='1671880'>say</span> <span m='1672090'>the</span> <span m='1672390'>i-th</span>
  <span m='1672750'>internal</span> <span m='1673140'>node</span> <span m='1674520'>and</span>
  <span m='1674820'>the</span> <span m='1674940'>i</span> <span m='1675180'>minus</span>
  <span m='1675510'>first</span> <span m='1675810'>internal</span> <span m='1676200'>node,</span>
  <span m='1677790'>this</span> <span m='1678000'>one</span> <span m='1678120'>has</span>
  <span m='1678390'>two</span> <span m='1678600'>left</span> <span m='1679090'>children.</span>
  <span m='1679620'>Don't</span> <span m='1679770'>know</span> <span m='1679920'>whether</span>
  <span m='1680130'>they're</span> <span m='1680310'>internal</span> <span m='1680730'>or</span>
  <span m='1680790'>external.</span> </p><p><span m='1681570'>Between</span> <span
  m='1682050'>them--</span> <span m='1682620'>they're</span> <span m='1682740'>on</span>
  <span m='1682830'>the</span> <span m='1682920'>same</span> <span m='1683190'>level</span>
  <span m='1683530'>and</span> <span m='1683640'>we're</span> <span m='1684120'>in</span>
  <span m='1684210'>level</span> <span m='1684510'>order,</span> <span m='1684850'>so</span>
  <span m='1685830'>anything</span> <span m='1686250'>in</span> <span m='1686310'>between</span>
  <span m='1686670'>here</span> <span m='1686850'>is</span> <span m='1686940'>an</span>
  <span m='1687030'>external</span> <span m='1687420'>node.</span> <span m='1688380'>So</span>
  <span m='1688530'>they</span> <span m='1688650'>have</span> <span m='1688830'>no</span>
  <span m='1688980'>children,</span> <span m='1690360'>which</span> <span m='1690540'>means</span>
  <span m='1690840'>if</span> <span m='1690960'>you</span> <span m='1691050'>look</span>
  <span m='1691230'>at</span> <span m='1691320'>the</span> <span m='1691440'>children</span>
  <span m='1691790'>of</span> <span m='1691950'>i,</span> <span m='1693050'>they're</span>
  <span m='1693060'>going</span> <span m='1693180'>to</span> <span m='1693240'>appear</span>
  <span m='1693540'>right</span> <span m='1693810'>after</span> <span m='1694110'>the</span>
  <span m='1694230'>children</span> <span m='1694620'>of i</span> <span m='1694860'>minus</span>
  <span m='1695200'>1,</span> <span m='1697084'>because</span> <span m='1699070'>we're</span>
  <span m='1699320'>level</span> <span m='1699590'>order.</span> </p><p><span m='1700080'>So</span>
  <span m='1700280'>we</span> <span m='1700460'>have</span> <span m='1700700'>these</span>
  <span m='1700880'>two</span> <span m='1701000'>guys.</span> <span m='1701930'>The</span>
  <span m='1703010'>next</span> <span m='1703310'>nodes</span> <span m='1703640'>at</span>
  <span m='1703730'>this</span> <span m='1703880'>level</span> <span m='1704210'>are</span>
  <span m='1704240'>going</span> <span m='1704350'>to</span> <span m='1704450'>be</span>
  <span m='1704570'>these</span> <span m='1704750'>two</span> <span m='1704900'>guys.</span>
  <span m='1706800'>So</span> <span m='1707870'>this</span> <span m='1708050'>one</span>
  <span m='1708230'>appeared</span> <span m='1708590'>at</span> <span m='1709890'>2i</span>
  <span m='1710310'>minus</span> <span m='1710600'>2,</span> <span m='1710810'>and</span>
  <span m='1710900'>2i</span> <span m='1711180'>minus</span> <span m='1711470'>1.</span>
  <span m='1711860'>This one will</span> <span m='1711980'>appear</span> <span m='1712340'>at</span>
  <span m='1712640'>2i</span> <span m='1713720'>and</span> <span m='1715130'>2i</span>
  <span m='1715430'>plus</span> <span m='1715700'>1.</span> </p><p><span m='1716630'>This</span>
  <span m='1716810'>is</span> <span m='1716930'>if</span> <span m='1717350'>i and</span>
  <span m='1717560'>i minus</span> <span m='1717770'>1</span> <span m='1717910'>are</span>
  <span m='1717970'>on</span> <span m='1718070'>the</span> <span m='1718160'>same</span>
  <span m='1718430'>level,</span> <span m='1719240'>but</span> <span m='1719420'>it</span>
  <span m='1719480'>also</span> <span m='1719810'>works</span> <span m='1720110'>if</span>
  <span m='1720260'>they're</span> <span m='1720410'>in</span> <span m='1720470'>different</span>
  <span m='1720770'>levels.</span> <span m='1730760'>So</span> <span m='1730780'>if</span>
  <span m='1730900'>I'm</span> <span m='1731050'>i minus</span> <span m='1731320'>1</span>
  <span m='1731590'>is</span> <span m='1731740'>the</span> <span m='1731890'>last</span>
  <span m='1732340'>node</span> <span m='1732610'>on</span> <span m='1732730'>its</span>
  <span m='1732880'>level,</span> <span m='1733630'>again</span> <span m='1733960'>it's</span>
  <span m='1734110'>going</span> <span m='1734230'>to</span> <span m='1734290'>have</span>
  <span m='1734740'>two</span> <span m='1734980'>children</span> <span m='1735400'>here,</span>
  <span m='1736720'>which</span> <span m='1736900'>will</span> <span m='1737020'>be</span>
  <span m='1737170'>the</span> <span m='1737320'>last</span> <span m='1737740'>nodes</span>
  <span m='1738070'>on</span> <span m='1738190'>this</span> <span m='1738340'>level.</span>
  <span m='1740050'>And</span> <span m='1740140'>then</span> <span m='1740290'>right</span>
  <span m='1740530'>after</span> <span m='1740830'>that</span> <span m='1741040'>will</span>
  <span m='1741160'>come</span> <span m='1741430'>the</span> <span m='1741520'>children</span>
  <span m='1742390'>of</span> <span m='1742690'>i,</span> <span m='1743320'>again</span>
  <span m='1743860'>at</span> <span m='1743950'>position</span> <span m='1744340'>2i</span>
  <span m='1745710'>and</span> <span m='1745920'>2i</span> <span m='1746200'>plus</span>
  <span m='1746460'>1.</span> </p><p><span m='1751000'>OK.</span> <span m='1751300'>So</span>
  <span m='1751930'>that's</span> <span m='1752410'>essentially</span> <span m='1752830'>the</span>
  <span m='1752890'>proof</span> <span m='1753610'>that</span> <span m='1753760'>this</span>
  <span m='1753940'>works</span> <span m='1754180'>out.</span> <span m='1754910'>There's</span>
  <span m='1755010'>lots</span> <span m='1755170'>of</span> <span m='1755230'>ways</span>
  <span m='1755410'>to</span> <span m='1755500'>see</span> <span m='1755710'>why</span>
  <span m='1755860'>this</span> <span m='1756040'>is</span> <span m='1756160'>true,</span>
  <span m='1756520'>but</span> <span m='1756700'>I</span> <span m='1756790'>think</span>
  <span m='1757510'>I'll</span> <span m='1757600'>leave</span> <span m='1757780'>it</span>
  <span m='1757840'>at</span> <span m='1757930'>that.</span> </p><p><span m='1760475'>OK.</span>
  <span m='1761890'>So</span> <span m='1762070'>this</span> <span m='1762280'>is</span>
  <span m='1762370'>good</span> <span m='1762550'>news.</span> <span m='1762880'>It</span>
  <span m='1762970'>says</span> <span m='1765340'>if</span> <span m='1765480'>we</span>
  <span m='1765600'>have</span> <span m='1765750'>the i-th</span> <span m='1766050'>internal</span>
  <span m='1766410'>node,</span> <span m='1766770'>we</span> <span m='1766890'>can</span>
  <span m='1767070'>find</span> <span m='1767460'>the</span> <span m='1767580'>left</span>
  <span m='1767820'>and</span> <span m='1767910'>the</span> <span m='1767970'>right</span>
  <span m='1768150'>children.</span> <span m='1768540'>But</span> <span m='1768660'>these</span>
  <span m='1768870'>are</span> <span m='1768960'>in</span> <span m='1769120'>different</span>
  <span m='1770010'>namespaces,</span> <span m='1770820'>right?</span> </p><p><span
  m='1771000'>On</span> <span m='1771120'>the</span> <span m='1771210'>one</span>
  <span m='1771360'>hand,</span> <span m='1771570'>we're</span> <span m='1771690'>counting</span>
  <span m='1772500'>by</span> <span m='1772680'>internal</span> <span m='1773010'>nodes.</span>
  <span m='1773310'>On</span> <span m='1773400'>the</span> <span m='1773460'>other</span>
  <span m='1773610'>hand,</span> <span m='1773760'>we're</span> <span m='1773880'>counting</span>
  <span m='1774240'>by</span> <span m='1774420'>position</span> <span m='1774960'>in</span>
  <span m='1775050'>the</span> <span m='1775170'>array,</span> <span m='1776170'>which</span>
  <span m='1776280'>is</span> <span m='1776430'>counting</span> <span m='1777150'>position</span>
  <span m='1777690'>by</span> <span m='1778020'>internal</span> <span m='1778590'>and</span>
  <span m='1778830'>external</span> <span m='1779280'>nodes.</span> <span m='1781120'>This</span>
  <span m='1781350'>counts</span> <span m='1781710'>both</span> <span m='1781920'>0's</span>
  <span m='1782250'>and</span> <span m='1782370'>1's.</span> <span m='1783180'>This</span>
  <span m='1783360'>only</span> <span m='1783570'>counts</span> <span m='1783890'>1's.</span>
  </p><p></p><p><span m='1803410'>So</span> <span m='1803620'>we</span> <span m='1803740'>need</span>
  <span m='1804160'>a</span> <span m='1804250'>mechanism</span> <span m='1804820'>for</span>
  <span m='1804970'>translating</span> <span m='1805690'>between</span> <span m='1805990'>those</span>
  <span m='1806170'>two</span> <span m='1806350'>worlds,</span> <span m='1807370'>translating</span>
  <span m='1809070'>between</span> <span m='1809320'>indices</span> <span m='1809710'>that</span>
  <span m='1809800'>only</span> <span m='1810010'>count</span> <span m='1810250'>1's</span>
  <span m='1810600'>and</span> <span m='1810700'>indices</span> <span m='1810980'>that</span>
  <span m='1811750'>count</span> <span m='1812020'>0's</span> <span m='1812350'>and</span>
  <span m='1812530'>1's.</span> <span m='1813610'>And</span> <span m='1813760'>this</span>
  <span m='1813970'>is</span> <span m='1814060'>the</span> <span m='1814150'>idea</span>
  <span m='1814510'>of</span> <span m='1814780'>rank</span> <span m='1815080'>and</span>
  <span m='1815200'>select.</span> </p><p></p><p><span m='1826360'>So</span> <span
  m='1826590'>in</span> <span m='1826660'>general,</span> <span m='1827090'>if</span>
  <span m='1827120'>I</span> <span m='1827190'>have</span> <span m='1827420'>a</span>
  <span m='1827890'>string</span> <span m='1828310'>of</span> <span m='1828460'>n</span>
  <span m='1828680'>bits,</span> <span m='1830050'>I</span> <span m='1830170'>want</span>
  <span m='1830350'>to</span> <span m='1830410'>be</span> <span m='1830560'>able</span>
  <span m='1830710'>to</span> <span m='1830800'>compute</span> <span m='1832600'>the</span>
  <span m='1832720'>rank</span> <span m='1833080'>of</span> <span m='1833200'>a</span>
  <span m='1833260'>bit,</span> <span m='1843480'>which</span> <span m='1843650'>is</span>
  <span m='1844070'>the</span> <span m='1844310'>number</span> <span m='1844610'>of</span>
  <span m='1844730'>1's</span> <span m='1846260'>at</span> <span m='1846500'>or</span>
  <span m='1846680'>before</span> <span m='1847490'>position</span> <span m='1848020'>i.</span>
  <span m='1848650'>So</span> <span m='1848840'>I'm</span> <span m='1848960'>given</span>
  <span m='1849290'>a</span> <span m='1849320'>position</span> <span m='1849740'>like</span>
  <span m='1849950'>6</span> <span m='1850350'>and I</span> <span m='1850490'>want</span>
  <span m='1850640'>to</span> <span m='1850730'>know</span> <span m='1850850'>how</span>
  <span m='1851000'>many</span> <span m='1851210'>1's</span> <span m='1851490'>are
  there</span> <span m='1851720'>up</span> <span m='1851900'>to</span> <span m='1852020'>6,</span>
  <span m='1852410'>which</span> <span m='1852620'>would</span> <span m='1852710'>be</span>
  <span m='1852980'>5</span> <span m='1854280'>in</span> <span m='1854420'>the</span>
  <span m='1854510'>full</span> <span m='1855980'>array</span> <span m='1856250'>here.</span>
  <span m='1857360'>Or</span> <span m='1857510'>I'm</span> <span m='1857750'>given</span>
  <span m='1858050'>a</span> <span m='1858110'>query</span> <span m='1858470'>like</span>
  <span m='1859010'>8,</span> <span m='1859910'>number</span> <span m='1860360'>of</span>
  <span m='1860450'>1's</span> <span m='1860870'>is</span> <span m='1861020'>6</span>
  <span m='1861620'>up</span> <span m='1861830'>to</span> <span m='1862670'>position</span>
  <span m='1863090'>8.</span> <span m='1864470'>And</span> <span m='1864650'>then</span>
  <span m='1864830'>the</span> <span m='1864950'>inverse</span> <span m='1865550'>of</span>
  <span m='1866090'>rank</span> <span m='1867170'>is</span> <span m='1867320'>select,</span>
  <span m='1870410'>which</span> <span m='1870590'>gives</span> <span m='1870890'>you</span>
  <span m='1871160'>the</span> <span m='1871430'>position</span> <span m='1874190'>of</span>
  <span m='1874520'>the</span> <span m='1874710'>j-th</span> <span m='1875050'>1</span>
  <span m='1875390'>bit.</span> </p><p><span m='1879470'>So</span> <span m='1879650'>this</span>
  <span m='1879860'>lets</span> <span m='1880100'>you</span> <span m='1880220'>translate</span>
  <span m='1880850'>between</span> <span m='1882260'>these</span> <span m='1882500'>two</span>
  <span m='1882710'>worlds</span> <span m='1883070'>of</span> <span m='1883190'>counting</span>
  <span m='1883670'>just</span> <span m='1883880'>the</span> <span m='1884000'>1's,</span>
  <span m='1885045'>which is</span> <span m='1885460'>rank,</span> <span m='1887630'>or</span>
  <span m='1888680'>going</span> <span m='1888890'>to</span> <span m='1889010'>the</span>
  <span m='1889140'>j-th</span> <span m='1889430'>1</span> <span m='1889670'>bit,</span>
  <span m='1889970'>that's</span> <span m='1890210'>select.</span> <span m='1897860'>So</span>
  <span m='1898220'>this</span> <span m='1898430'>lets</span> <span m='1898730'>you</span>
  <span m='1898850'>compute</span> <span m='1899630'>the</span> <span m='1899720'>left</span>
  <span m='1899990'>child</span> <span m='1901100'>as</span> <span m='1901340'>just</span>
  <span m='1901820'>being at</span> <span m='1902250'>position</span> <span m='1902750'>twice</span>
  <span m='1903230'>the</span> <span m='1903350'>rank,</span> <span m='1905510'>because</span>
  <span m='1905660'>the</span> <span m='1905750'>rank</span> <span m='1906080'>tells</span>
  <span m='1906470'>you</span> <span m='1907850'>this</span> <span m='1908090'>value</span>
  <span m='1908760'>i,</span> <span m='1909290'>which</span> <span m='1909560'>is</span>
  <span m='1909770'>which</span> <span m='1910010'>internal</span> <span m='1910470'>node</span>
  <span m='1910790'>are</span> <span m='1911000'>you.</span> <span m='1912340'>That's</span>
  <span m='1912590'>your</span> <span m='1912680'>rank.</span> <span m='1913250'>You</span>
  <span m='1913310'>multiply</span> <span m='1913730'>by</span> <span m='1913850'>2</span>
  <span m='1914190'>and</span> <span m='1914280'>that</span> <span m='1914450'>was</span>
  <span m='1914630'>the</span> <span m='1914810'>position</span> <span m='1915530'>of</span>
  <span m='1915710'>the</span> <span m='1915830'>left</span> <span m='1916010'>child.</span>
  </p><p><span m='1917240'>Right</span> <span m='1917480'>child</span> <span m='1919130'>is</span>
  <span m='1919640'>going</span> <span m='1919850'>to</span> <span m='1919910'>be</span>
  <span m='1920000'>that</span> <span m='1920420'>plus</span> <span m='1920750'>1.</span>
  <span m='1922400'>Parent</span> <span m='1924500'>is</span> <span m='1924620'>going</span>
  <span m='1924740'>to</span> <span m='1924830'>use</span> <span m='1925130'>select.</span>
  <span m='1926000'>So</span> <span m='1926150'>if</span> <span m='1926240'>we</span>
  <span m='1926300'>want</span> <span m='1926480'>the</span> <span m='1926570'>parent</span>
  <span m='1926960'>of</span> <span m='1927080'>i,</span> <span m='1929270'>this</span>
  <span m='1929480'>is</span> <span m='1929630'>going</span> <span m='1929810'>to</span>
  <span m='1929870'>be</span> <span m='1931610'>select</span> <span m='1933760'>of</span>
  <span m='1935380'>i</span> <span m='1936410'>over</span> <span m='1936770'>2</span>
  <span m='1937125'>with</span> <span m='1937480'>a</span> <span m='1937610'>floor.</span>
  <span m='1941102'>So</span> <span m='1941600'>that's</span> <span m='1941630'>just</span>
  <span m='1941850'>the</span> <span m='1941980'>inverse</span> <span m='1942430'>of</span>
  <span m='1942550'>left</span> <span m='1942790'>and</span> <span m='1942910'>right</span>
  <span m='1943090'>child.</span> <span m='1943480'>If</span> <span m='1943630'>I</span>
  <span m='1943690'>divide</span> <span m='1944020'>by</span> <span m='1944170'>2</span>
  <span m='1944320'>and</span> <span m='1944410'>take</span> <span m='1944560'>the</span>
  <span m='1944680'>floor,</span> <span m='1944940'>I</span> <span m='1945120'>get
  rid of</span> <span m='1945280'>that</span> <span m='1945460'>plus</span> <span
  m='1945760'>1,</span> <span m='1946030'>I</span> <span m='1946120'>get</span> <span
  m='1946330'>the</span> <span m='1946450'>rank.</span> <span m='1946840'>And</span>
  <span m='1946930'>then</span> <span m='1947020'>I</span> <span m='1947080'>do</span>
  <span m='1947230'>select,</span> <span m='1947740'>sub</span> <span m='1948240'>1,</span>
  <span m='1949120'>and</span> <span m='1949750'>that's</span> <span m='1950050'>the</span>
  <span m='1950200'>inverse</span> <span m='1950590'>of</span> <span m='1950710'>rank.</span>
  </p><p><span m='1953170'>So</span> <span m='1953350'>that</span> <span m='1953530'>lets</span>
  <span m='1953800'>me</span> <span m='1954640'>implement.</span> <span m='1955690'>If</span>
  <span m='1955870'>I</span> <span m='1955960'>have</span> <span m='1956260'>rank</span>
  <span m='1956480'>and</span> <span m='1956640'>select in</span> <span m='1957130'>constant</span>
  <span m='1957430'>time,</span> <span m='1957730'>now</span> <span m='1957940'>I</span>
  <span m='1958030'>can</span> <span m='1958210'>do</span> <span m='1958440'>left</span>
  <span m='1958660'>child,</span> <span m='1958930'>right</span> <span m='1959110'>child,</span>
  <span m='1959380'>parent</span> <span m='1959710'>in</span> <span m='1959800'>constant</span>
  <span m='1960160'>time.</span> <span m='1961010'>The</span> <span m='1961110'>remaining</span>
  <span m='1961300'>challenge</span> <span m='1961750'>is,</span> <span m='1961960'>how</span>
  <span m='1962170'>do</span> <span m='1962290'>I</span> <span m='1962350'>do</span>
  <span m='1962500'>rank</span> <span m='1962770'>and</span> <span m='1962990'>select?</span>
  <span m='1963940'>And</span> <span m='1964030'>that's</span> <span m='1964300'>what</span>
  <span m='1964450'>we're</span> <span m='1964520'>going</span> <span m='1964640'>to</span>
  <span m='1964720'>do</span> <span m='1964870'>next.</span> <span m='1966150'>Any</span>
  <span m='1966280'>questions</span> <span m='1966670'>about</span> <span m='1966910'>that</span>
  <span m='1967090'>before</span> <span m='1967390'>we</span> <span m='1967510'>go</span>
  <span m='1967660'>on?</span> </p><p><span m='1970756'>All right.</span> <span m='1972680'>So</span>
  <span m='1972970'>now</span> <span m='1973300'>we</span> <span m='1973540'>do</span>
  <span m='1974080'>real</span> <span m='1974710'>data</span> <span m='1974980'>structures.</span>
  <span m='1975530'>This</span> <span m='1975580'>is</span> <span m='1975640'>going</span>
  <span m='1975790'>to</span> <span m='1975880'>be</span> <span m='1976000'>some</span>
  <span m='1976450'>integer</span> <span m='1976810'>data</span> <span m='1977050'>structures,</span>
  <span m='1978310'>some</span> <span m='1978580'>fun</span> <span m='1978820'>stuff.</span>
  <span m='1981520'>It's</span> <span m='1981630'>going</span> <span m='1981720'>to</span>
  <span m='1981810'>use</span> <span m='1981960'>some</span> <span m='1982110'>techniques</span>
  <span m='1982560'>we</span> <span m='1982680'>know,</span> <span m='1984210'>but</span>
  <span m='1984480'>in</span> <span m='1984870'>a</span> <span m='1984930'>different</span>
  <span m='1985260'>setting,</span> <span m='1985620'>because</span> <span m='1985830'>now</span>
  <span m='1986610'>our</span> <span m='1986730'>goal</span> <span m='1986970'>is</span>
  <span m='1987090'>to</span> <span m='1987210'>really</span> <span m='1987660'>minimize</span>
  <span m='1988110'>space.</span> <span m='1990021'>We're</span> <span m='1990480'>going</span>
  <span m='1991150'>to</span> <span m='1991230'>use</span> <span m='1991440'>indirection</span>
  <span m='1992820'>and</span> <span m='1992940'>lookup</span> <span m='1993240'>tables</span>
  <span m='1993660'>in</span> <span m='1993780'>a</span> <span m='1993840'>new</span>
  <span m='1994140'>kind</span> <span m='1994350'>of</span> <span m='1994440'>way.</span>
  </p><p><span m='2000380'>These</span> <span m='2000500'>are</span> <span m='2000590'>going</span>
  <span m='2000710'>to</span> <span m='2000770'>be</span> <span m='2000980'>word</span>
  <span m='2001190'>RAM</span> <span m='2001520'>data</span> <span m='2001760'>structures.</span>
  <span m='2002960'>I</span> <span m='2003020'>want</span> <span m='2003200'>to</span>
  <span m='2003260'>do</span> <span m='2003380'>both</span> <span m='2003620'>rank
  and</span> <span m='2003950'>select in</span> <span m='2004340'>constant</span>
  <span m='2004715'>time.</span> <span m='2007160'>And</span> <span m='2008360'>the</span>
  <span m='2008450'>amount</span> <span m='2008660'>of</span> <span m='2008720'>space</span>
  <span m='2009020'>I</span> <span m='2009080'>have</span> <span m='2009260'>is</span>
  <span m='2009350'>little</span> <span m='2009800'>o of</span> <span m='2010060'>n.</span>
  </p><p><span m='2010630'>I</span> <span m='2010730'>want</span> <span m='2010970'>succinct.</span>
  <span m='2011410'>And</span> <span m='2011830'>I'm</span> <span m='2011940'>going</span>
  <span m='2012030'>to</span> <span m='2012190'>store</span> <span m='2012500'>the</span>
  <span m='2012590'>bit</span> <span m='2012800'>vector.</span> <span m='2014720'>So</span>
  <span m='2014900'>then</span> <span m='2015290'>in</span> <span m='2015470'>addition</span>
  <span m='2015770'>to</span> <span m='2015860'>the bit</span> <span m='2016050'>vector,</span>
  <span m='2016390'>all I'm</span> <span m='2016720'>allowed</span> <span m='2017150'>for</span>
  <span m='2017420'>rank</span> <span m='2017630'>and</span> <span m='2017720'>select</span>
  <span m='2018020'>is</span> <span m='2018170'>little</span> <span m='2018430'>o</span>
  <span m='2018600'>of n</span> <span m='2018830'>space.</span> <span m='2019820'>That's</span>
  <span m='2020000'>the</span> <span m='2020090'>cool</span> <span m='2020300'>part.</span>
  </p><p><span m='2024200'>So</span> <span m='2024450'>rank</span> <span m='2026110'>is</span>
  <span m='2026190'>one</span> <span m='2026370'>of</span> <span m='2026430'>the</span>
  <span m='2026520'>first</span> <span m='2027030'>succinct</span> <span m='2027390'>data</span>
  <span m='2027600'>structures.</span> <span m='2027990'>It's</span> <span m='2028490'>by</span>
  <span m='2029240'>Jacobson,</span> <span m='2030240'>1989.</span> <span m='2036740'>So</span>
  <span m='2037580'>a</span> <span m='2037940'>first</span> <span m='2038300'>observation</span>
  <span m='2038990'>is,</span> <span m='2039650'>what</span> <span m='2039860'>can</span>
  <span m='2040010'>we</span> <span m='2040130'>do</span> <span m='2040260'>with</span>
  <span m='2040370'>a</span> <span m='2040430'>lookup</span> <span m='2040760'>table?</span>
  <span m='2042770'>Suppose</span> <span m='2043160'>I</span> <span m='2043250'>wanted</span>
  <span m='2043550'>to</span> <span m='2043670'>store</span> <span m='2043970'>all</span>
  <span m='2044120'>the</span> <span m='2044240'>answers,</span> <span m='2045980'>but</span>
  <span m='2046250'>I</span> <span m='2046430'>can't</span> <span m='2046760'>afford</span>
  <span m='2049400'>much</span> <span m='2049610'>space.</span> </p><p></p><p><span
  m='2063489'>Well,</span> <span m='2065290'>let's</span> <span m='2065500'>do</span>
  <span m='2066150'>sort</span> <span m='2066380'>of</span> <span m='2066469'>a</span>
  <span m='2066489'>worksheet.</span> <span m='2067030'>If</span> <span m='2067150'>I</span>
  <span m='2067239'>had</span> <span m='2067480'>space</span> <span m='2068440'>x,</span>
  <span m='2069480'>or</span> <span m='2069610'>if</span> <span m='2069730'>I</span>
  <span m='2069820'>looked</span> <span m='2070030'>at</span> <span m='2070120'>all</span>
  <span m='2070330'>bit</span> <span m='2070510'>strings</span> <span m='2070810'>of</span>
  <span m='2070900'>length</span> <span m='2071230'>x</span> <span m='2072110'>and</span>
  <span m='2072370'>then</span> <span m='2072520'>I</span> <span m='2072580'>wanted</span>
  <span m='2072850'>to</span> <span m='2072940'>store</span> <span m='2073270'>them,</span>
  <span m='2074949'>that's</span> <span m='2075130'>going</span> <span m='2075280'>to</span>
  <span m='2075340'>cost--</span> <span m='2076179'>or</span> <span m='2076300'>store</span>
  <span m='2077320'>a</span> <span m='2077380'>lookup</span> <span m='2077679'>table</span>
  <span m='2077980'>for</span> <span m='2078130'>each</span> <span m='2078370'>of</span>
  <span m='2078460'>them,</span> <span m='2079690'>it's</span> <span m='2079780'>going</span>
  <span m='2079929'>to</span> <span m='2079989'>cost--</span> <span m='2080380'>well,</span>
  <span m='2080560'>there's</span> <span m='2080800'>2 to</span> <span m='2081040'>the</span>
  <span m='2081190'>x</span> <span m='2081460'>different</span> <span m='2081790'>bit</span>
  <span m='2081969'>strings</span> <span m='2083050'>of</span> <span m='2083190'>that</span>
  <span m='2083389'>length.</span> <span m='2085440'>Then</span> <span m='2085620'>for</span>
  <span m='2085800'>each</span> <span m='2086070'>of</span> <span m='2086130'>them,</span>
  <span m='2086550'>I</span> <span m='2086699'>have</span> <span m='2086940'>to</span>
  <span m='2087030'>store</span> <span m='2087690'>all</span> <span m='2088050'>possible</span>
  <span m='2088590'>answers</span> <span m='2089010'>to</span> <span m='2089130'>rank</span>
  <span m='2089400'>and</span> <span m='2089489'>select</span> <span m='2089880'>queries.</span>
  <span m='2091449'>So</span> <span m='2092750'>there's</span> <span m='2093210'>order</span>
  <span m='2093630'>x</span> <span m='2094020'>different</span> <span m='2094350'>queries.</span>
  <span m='2095190'>You</span> <span m='2095250'>could</span> <span m='2095400'>query</span>
  <span m='2095760'>every</span> <span m='2096840'>bit.</span> </p><p><span m='2098250'>And</span>
  <span m='2098340'>then</span> <span m='2098490'>for</span> <span m='2098610'>each</span>
  <span m='2098850'>of</span> <span m='2098910'>them,</span> <span m='2099090'>I</span>
  <span m='2099150'>have</span> <span m='2099300'>to</span> <span m='2099420'>write</span>
  <span m='2099600'>down</span> <span m='2099780'>an</span> <span m='2099870'>answer.</span>
  <span m='2100440'>So</span> <span m='2100650'>this</span> <span m='2100920'>is</span>
  <span m='2101070'>going</span> <span m='2101220'>to</span> <span m='2101310'>be</span>
  <span m='2102570'>log</span> <span m='2102900'>x</span> <span m='2103230'>bits,</span>
  <span m='2103870'>because</span> <span m='2104100'>the</span> <span m='2104220'>answer</span>
  <span m='2104730'>is</span> <span m='2105030'>a</span> <span m='2105060'>value</span>
  <span m='2105390'>between</span> <span m='2105930'>0</span> <span m='2106170'>and</span>
  <span m='2106260'>x</span> <span m='2106440'>minus</span> <span m='2106710'>1,</span>
  <span m='2107050'>so</span> <span m='2107150'>it</span> <span m='2107250'>takes</span>
  <span m='2107320'>log</span> <span m='2107610'>x bits</span> <span m='2108060'>to</span>
  <span m='2108150'>write</span> <span m='2108330'>it</span> <span m='2108390'>down.</span>
  <span m='2109810'>So</span> <span m='2109910'>this</span> <span m='2109950'>is</span>
  <span m='2110040'>how</span> <span m='2110160'>much</span> <span m='2110340'>space</span>
  <span m='2110610'>it's</span> <span m='2110700'>going</span> <span m='2110880'>to</span>
  <span m='2110940'>be</span> <span m='2111540'>to</span> <span m='2111660'>store</span>
  <span m='2112350'>the</span> <span m='2112440'>answer</span> <span m='2112710'>for</span>
  <span m='2112890'>all</span> <span m='2113100'>bit</span> <span m='2113280'>strings</span>
  <span m='2113640'>of</span> <span m='2113730'>length</span> <span m='2114050'>x.</span>
  </p><p><span m='2115500'>So</span> <span m='2116010'>what</span> <span m='2116160'>should</span>
  <span m='2116250'>I</span> <span m='2116340'>set</span> <span m='2116510'>x</span>
  <span m='2116760'>to?</span> <span m='2118260'>I'd</span> <span m='2118380'>like</span>
  <span m='2118620'>this</span> <span m='2118770'>to</span> <span m='2118890'>be</span>
  <span m='2119040'>little</span> <span m='2119260'>o of</span> <span m='2119460'>n,</span>
  <span m='2120550'>so</span> <span m='2120810'>anything</span> <span m='2121260'>that's</span>
  <span m='2121500'>a</span> <span m='2121560'>little</span> <span m='2121890'>bit</span>
  <span m='2122070'>less</span> <span m='2122400'>than</span> <span m='2122810'>log</span>
  <span m='2123250'>n</span> <span m='2124140'>is</span> <span m='2124290'>going</span>
  <span m='2124470'>to</span> <span m='2124560'>be</span> <span m='2124710'>OK.</span>
  <span m='2125460'>And</span> <span m='2125550'>in</span> <span m='2125670'>particular,</span>
  <span m='2127170'>1/2</span> <span m='2127470'>log</span> <span m='2127725'>n</span>
  <span m='2127980'>is</span> <span m='2128610'>a</span> <span m='2128910'>good</span>
  <span m='2129030'>enough</span> <span m='2129240'>choice.</span> <span m='2130540'>If</span>
  <span m='2130920'>we</span> <span m='2131040'>use</span> <span m='2131250'>1/2</span>
  <span m='2131520'>log n</span> <span m='2131970'>bits,</span> <span m='2132880'>this</span>
  <span m='2132960'>is</span> <span m='2133050'>going</span> <span m='2133200'>to</span>
  <span m='2133290'>be</span> <span m='2133830'>root</span> <span m='2134150'>n,</span>
  <span m='2135990'>log</span> <span m='2136380'>n</span> <span m='2136620'>log</span>
  <span m='2136860'>log</span> <span m='2136960'>n,</span> <span m='2140200'>which</span>
  <span m='2140340'>is</span> <span m='2141300'>little</span> <span m='2141530'>o
  of</span> <span m='2141670'>n,</span> <span m='2142350'>quite</span> <span m='2142560'>small</span>
  <span m='2143580'>as</span> <span m='2143820'>succinct</span> <span m='2144120'>data</span>
  <span m='2144300'>structures</span> <span m='2144660'>go.</span> <span m='2144810'>We're</span>
  <span m='2144930'>going</span> <span m='2145040'>to</span> <span m='2145110'>use</span>
  <span m='2145260'>more</span> <span m='2145440'>space</span> <span m='2145770'>than</span>
  <span m='2145920'>root</span> <span m='2146110'>n.</span> </p><p><span m='2147060'>The</span>
  <span m='2147150'>point</span> <span m='2147360'>is,</span> <span m='2147480'>if</span>
  <span m='2147600'>we</span> <span m='2147720'>could</span> <span m='2147870'>get</span>
  <span m='2148080'>down</span> <span m='2148350'>to bit</span> <span m='2148650'>strings</span>
  <span m='2149040'>of</span> <span m='2149310'>logarithmic</span> <span m='2149850'>size,</span>
  <span m='2150330'>we'd</span> <span m='2150510'>be</span> <span m='2150630'>done.</span>
  <span m='2151410'>But</span> <span m='2151530'>we</span> <span m='2151710'>have</span>
  <span m='2151890'>a</span> <span m='2152010'>bit</span> <span m='2152220'>string</span>
  <span m='2152520'>of</span> <span m='2152730'>linear</span> <span m='2153060'>size.</span>
  <span m='2154660'>So</span> <span m='2154680'>how</span> <span m='2154860'>do</span>
  <span m='2154950'>we</span> <span m='2155130'>reduce</span> <span m='2155490'>it?</span>
  <span m='2156450'>Something</span> <span m='2157110'>like</span> <span m='2157350'>indirection.</span>
  </p><p></p><p><span m='2170360'>So</span> <span m='2173770'>the</span> <span m='2173860'>funny</span>
  <span m='2174100'>thing</span> <span m='2174280'>here</span> <span m='2174430'>is</span>
  <span m='2174550'>we're</span> <span m='2174670'>going</span> <span m='2174790'>to</span>
  <span m='2175240'>do</span> <span m='2175840'>indirection</span> <span m='2176500'>twice,</span>
  <span m='2177580'>kind</span> <span m='2177790'>of</span> <span m='2177880'>recursively,</span>
  <span m='2178510'>but</span> <span m='2178750'>stopping</span> <span m='2179230'>after</span>
  <span m='2179470'>two</span> <span m='2179620'>levels.</span> <span m='2180890'>The</span>
  <span m='2180990'>first</span> <span m='2181180'>level</span> <span m='2181540'>of</span>
  <span m='2181600'>indirection</span> <span m='2183010'>is</span> <span m='2184120'>going</span>
  <span m='2184270'>to</span> <span m='2184330'>reduce</span> <span m='2184660'>things</span>
  <span m='2185530'>down</span> <span m='2185770'>to</span> <span m='2186430'>size</span>
  <span m='2187060'>log</span> <span m='2187400'>squared.</span> <span m='2196640'>So</span>
  <span m='2196740'>we're</span> <span m='2196840'>going</span> <span m='2196940'>to</span>
  <span m='2197040'>take</span> <span m='2197080'>our</span> <span m='2197200'>n</span>
  <span m='2197380'>bit</span> <span m='2197530'>string,</span> <span m='2198490'>divide</span>
  <span m='2198880'>into</span> <span m='2199600'>chunks of</span> <span m='2200090'>size</span>
  <span m='2200420'>log</span> <span m='2200650'>squared</span> <span m='2201050'>n,</span>
  <span m='2201130'>so</span> <span m='2201250'>there's</span> <span m='2201460'>n</span>
  <span m='2201640'>over</span> <span m='2201850'>log</span> <span m='2202100'>squared</span>
  <span m='2202390'>n</span> <span m='2202570'>chunks.</span> <span m='2203830'>They</span>
  <span m='2204010'>look</span> <span m='2207330'>something</span> <span m='2207720'>like</span>
  <span m='2207930'>this,</span> <span m='2209440'>log</span> <span m='2210310'>squared</span>
  <span m='2211200'>n.</span> </p><p></p><p><span m='2217650'>And</span> <span m='2218190'>the</span>
  <span m='2218340'>idea</span> <span m='2218640'>is</span> <span m='2219060'>right</span>
  <span m='2219330'>now</span> <span m='2219450'>we're</span> <span m='2219570'>trying</span>
  <span m='2219980'>to just do</span> <span m='2220140'>rank,</span> <span m='2221250'>so</span>
  <span m='2221610'>rank</span> <span m='2222570'>number</span> <span m='2222870'>of</span>
  <span m='2222950'>1's</span> <span m='2223440'>at</span> <span m='2223680'>or</span>
  <span m='2223770'>before</span> <span m='2224070'>a</span> <span m='2224160'>given</span>
  <span m='2224430'>position.</span> <span m='2225580'>So</span> <span m='2225630'>what</span>
  <span m='2225770'>I'm</span> <span m='2225840'>going</span> <span m='2225960'>to</span>
  <span m='2226020'>do</span> <span m='2226170'>is</span> <span m='2226290'>that</span>
  <span m='2226500'>each</span> <span m='2226800'>of</span> <span m='2226890'>these</span>
  <span m='2227250'>vertical</span> <span m='2227670'>bars,</span> <span m='2228750'>I'm</span>
  <span m='2228840'>going</span> <span m='2228960'>to</span> <span m='2229020'>store</span>
  <span m='2230250'>the</span> <span m='2230340'>cumulative</span> <span m='2230820'>rank</span>
  <span m='2231060'>so</span> <span m='2231240'>far.</span> </p><p><span m='2240075'>Why</span>
  <span m='2240490'>log</span> <span m='2240740'>squared?</span> <span m='2241090'>Basically</span>
  <span m='2241540'>because</span> <span m='2241840'>this</span> <span m='2241960'>is</span>
  <span m='2242080'>what</span> <span m='2242260'>I</span> <span m='2242320'>can</span>
  <span m='2242470'>afford.</span> <span m='2243190'>To</span> <span m='2243310'>store</span>
  <span m='2243610'>that</span> <span m='2243760'>cumulative</span> <span m='2244270'>rank</span>
  <span m='2245830'>is</span> <span m='2247680'>log</span> <span m='2248080'>n</span>
  <span m='2248350'>bits.</span> <span m='2250360'>I</span> <span m='2250420'>mean,</span>
  <span m='2250570'>this</span> <span m='2250720'>rank</span> <span m='2250960'>is</span>
  <span m='2251080'>going</span> <span m='2251160'>to</span> <span m='2251290'>get</span>
  <span m='2251440'>very</span> <span m='2251620'>big.</span> <span m='2251920'>By</span>
  <span m='2252070'>the</span> <span m='2252220'>end,</span> <span m='2252390'>it</span>
  <span m='2252460'>will</span> <span m='2252550'>have</span> <span m='2252730'>most</span>
  <span m='2253030'>of</span> <span m='2253120'>the</span> <span m='2253210'>1</span>
  <span m='2253420'>bits,</span> <span m='2253690'>so it</span> <span m='2253960'>could</span>
  <span m='2254140'>be</span> <span m='2254290'>potentially</span> <span m='2254770'>linear.</span>
  <span m='2255580'>So</span> <span m='2255640'>I'm</span> <span m='2255700'>going</span>
  <span m='2255760'>to</span> <span m='2255830'>need</span> <span m='2256030'>log</span>
  <span m='2256300'>n</span> <span m='2256450'>bits</span> <span m='2256780'>to</span>
  <span m='2257020'>write</span> <span m='2257230'>that</span> <span m='2257440'>down.</span>
  </p><p><span m='2259180'>But</span> <span m='2259450'>how</span> <span m='2259690'>many</span>
  <span m='2259900'>of</span> <span m='2259960'>these</span> <span m='2260110'>vertical</span>
  <span m='2260470'>bars</span> <span m='2260740'>are</span> <span m='2260890'>there?</span>
  <span m='2261430'>Well,</span> <span m='2261560'>only</span> <span m='2261880'>n</span>
  <span m='2262010'>over log</span> <span m='2262390'>squared</span> <span m='2262690'>n</span>
  <span m='2262810'>of</span> <span m='2262930'>them.</span> <span m='2264415'>So</span>
  <span m='2266170'>I</span> <span m='2266230'>have</span> <span m='2266770'>n</span>
  <span m='2267280'>over</span> <span m='2267670'>log</span> <span m='2267940'>squared</span>
  <span m='2268270'>n</span> <span m='2269500'>things</span> <span m='2269740'>I</span>
  <span m='2269800'>need</span> <span m='2269950'>to</span> <span m='2270070'>write</span>
  <span m='2270250'>down.</span> <span m='2270670'>Each</span> <span m='2270880'>of</span>
  <span m='2270940'>them</span> <span m='2271150'>is</span> <span m='2271270'>log</span>
  <span m='2271570'>n</span> <span m='2271750'>bits.</span> </p><p></p><p><span m='2280218'>So</span>
  <span m='2284202'>do</span> <span m='2284720'>some</span> <span m='2284930'>cancellation.</span>
  <span m='2286065'>This</span> <span m='2286420'>cancels</span> <span m='2286890'>with</span>
  <span m='2287120'>that.</span> <span m='2288860'>We</span> <span m='2288950'>have
  n</span> <span m='2289070'>over</span> <span m='2289370'>log</span> <span m='2289610'>n</span>
  <span m='2289760'>bits</span> <span m='2290030'>overall,</span> <span m='2292790'>which</span>
  <span m='2292970'>is</span> <span m='2293240'>slightly</span> <span m='2293850'>little</span>
  <span m='2294010'>o of</span> <span m='2294200'>n.</span> <span m='2294690'>And</span>
  <span m='2294710'>that's</span> <span m='2295400'>the</span> <span m='2295640'>bound</span>
  <span m='2295880'>we're</span> <span m='2295940'>going</span> <span m='2296150'>to</span>
  <span m='2296240'>achieve.</span> </p><p><span m='2297820'>OK.</span> <span m='2298230'>Of</span>
  <span m='2298370'>course,</span> <span m='2298580'>now</span> <span m='2298820'>we</span>
  <span m='2298970'>have</span> <span m='2299180'>to</span> <span m='2299300'>solve</span>
  <span m='2299930'>the</span> <span m='2300050'>problem</span> <span m='2300440'>within</span>
  <span m='2300740'>a</span> <span m='2300800'>chunk.</span> <span m='2301970'>But</span>
  <span m='2302090'>we've</span> <span m='2302260'>at least</span> <span m='2302570'>reduced
  to</span> <span m='2302960'>something</span> <span m='2303260'>of size</span> <span
  m='2303590'>log</span> <span m='2303870'>squared.</span> <span m='2304400'>Unfortunately,</span>
  <span m='2304910'>we</span> <span m='2305030'>need</span> <span m='2305180'>something</span>
  <span m='2305480'>of</span> <span m='2305540'>size</span> <span m='2305780'>1/2</span>
  <span m='2306050'>log</span> <span m='2306360'>n</span> <span m='2306500'>before</span>
  <span m='2306800'>we</span> <span m='2306890'>can</span> <span m='2307010'>use</span>
  <span m='2307130'>a</span> <span m='2307160'>lookup</span> <span m='2307490'>table.</span>
  </p><p><span m='2307950'>So</span> <span m='2307970'>there's</span> <span m='2308120'>a</span>
  <span m='2308180'>bit</span> <span m='2308300'>of</span> <span m='2308390'>a</span>
  <span m='2308450'>gap</span> <span m='2308750'>here,</span> <span m='2309020'>so</span>
  <span m='2309460'>we're</span> <span m='2309530'>going</span> <span m='2309650'>to</span>
  <span m='2309710'>use</span> <span m='2309830'>indirection</span> <span m='2310460'>a</span>
  <span m='2310520'>second</span> <span m='2310820'>time.</span> <span m='2321320'>This</span>
  <span m='2321500'>time,</span> <span m='2321770'>we</span> <span m='2321890'>can</span>
  <span m='2322040'>go</span> <span m='2322250'>all</span> <span m='2322490'>the</span>
  <span m='2322580'>way</span> <span m='2322850'>to</span> <span m='2323870'>1/2</span>
  <span m='2324170'>log</span> <span m='2324470'>n.</span> <span m='2343230'>So</span>
  <span m='2343380'>I'll</span> <span m='2343550'>use</span> <span m='2343820'>red</span>
  <span m='2344090'>vertical</span> <span m='2344450'>bars</span> <span m='2344720'>to</span>
  <span m='2344990'>denote</span> <span m='2345380'>the</span> <span m='2345620'>subchunks.</span>
  </p><p><span m='2346440'>Each</span> <span m='2346520'>of</span> <span m='2346580'>these</span>
  <span m='2346850'>is</span> <span m='2347120'>1/2</span> <span m='2347435'>log</span>
  <span m='2347750'>n.</span> <span m='2350900'>Overall</span> <span m='2351350'>size</span>
  <span m='2351650'>of</span> <span m='2351740'>a</span> <span m='2351840'>chunk</span>
  <span m='2352110'>here</span> <span m='2352380'>is</span> <span m='2352540'>log</span>
  <span m='2352770'>squared</span> <span m='2353080'>n.</span> <span m='2355910'>So</span>
  <span m='2356390'>every</span> <span m='2356780'>one</span> <span m='2356930'>of</span>
  <span m='2356990'>these</span> <span m='2357200'>chunks</span> <span m='2357560'>gets</span>
  <span m='2357860'>further</span> <span m='2358220'>divided.</span> </p><p><span
  m='2359150'>Now,</span> <span m='2359900'>how</span> <span m='2360110'>could</span>
  <span m='2360260'>this</span> <span m='2360440'>help?</span> <span m='2360710'>Why</span>
  <span m='2360980'>didn't</span> <span m='2361230'>I</span> <span m='2361370'>just</span>
  <span m='2361550'>subdivide</span> <span m='2362040'>into</span> <span m='2362240'>chunks</span>
  <span m='2362570'>of</span> <span m='2362630'>size</span> <span m='2362900'>1/2</span>
  <span m='2363200'>log</span> <span m='2363470'>n</span> <span m='2363590'>before?</span>
  <span m='2364400'>I</span> <span m='2364430'>mean,</span> <span m='2364580'>why</span>
  <span m='2364830'>I</span> <span m='2364910'>couldn't</span> <span m='2365240'>do</span>
  <span m='2365420'>it</span> <span m='2365510'>is</span> <span m='2365630'>clear.</span>
  <span m='2365960'>If</span> <span m='2366110'>I</span> <span m='2366170'>did</span>
  <span m='2366350'>n</span> <span m='2366500'>over</span> <span m='2366710'>log n</span>
  <span m='2367160'>of</span> <span m='2367250'>them,</span> <span m='2367430'>each</span>
  <span m='2367610'>of</span> <span m='2367670'>them</span> <span m='2367850'>stores</span>
  <span m='2368330'>log</span> <span m='2368570'>n</span> <span m='2368720'>bits,</span>
  <span m='2369590'>I'd</span> <span m='2369770'>have</span> <span m='2371200'>a</span>
  <span m='2371470'>linear</span> <span m='2371660'>number</span> <span m='2371910'>of</span>
  <span m='2371950'>bits.</span> <span m='2372200'>I</span> <span m='2372290'>can't</span>
  <span m='2372470'>afford</span> <span m='2372850'>a linear</span> <span m='2373040'>number</span>
  <span m='2373220'>of</span> <span m='2373280'>bits.</span> <span m='2373490'>That</span>
  <span m='2373640'>would</span> <span m='2373760'>only</span> <span m='2373940'>be</span>
  <span m='2374060'>compact,</span> <span m='2374570'>not</span> <span m='2374760'>succinct.</span>
  </p><p><span m='2376610'>How</span> <span m='2376760'>does</span> <span m='2376940'>it</span>
  <span m='2377030'>help</span> <span m='2377240'>me</span> <span m='2377420'>to</span>
  <span m='2377600'>first</span> <span m='2378020'>reduce</span> <span m='2378280'>to</span>
  <span m='2378540'>this</span> <span m='2379880'>and</span> <span m='2380030'>then</span>
  <span m='2380210'>reduce to</span> <span m='2380660'>this?</span> <span m='2382260'>Well,</span>
  <span m='2383090'>what</span> <span m='2383330'>I</span> <span m='2383420'>want</span>
  <span m='2383570'>to</span> <span m='2383630'>do</span> <span m='2383870'>at</span>
  <span m='2383990'>each</span> <span m='2384260'>of</span> <span m='2384350'>these</span>
  <span m='2386270'>red</span> <span m='2386840'>vertical</span> <span m='2387200'>bars</span>
  <span m='2388310'>is</span> <span m='2388430'>store</span> <span m='2390350'>the</span>
  <span m='2390440'>cumulative</span> <span m='2390950'>rank,</span> <span m='2391220'>but</span>
  <span m='2391340'>not</span> <span m='2391550'>the</span> <span m='2391700'>overall</span>
  <span m='2392240'>cumulative</span> <span m='2392720'>rank.</span> <span m='2393050'>I</span>
  <span m='2393170'>only</span> <span m='2393380'>need</span> <span m='2394100'>the</span>
  <span m='2394190'>cumulative</span> <span m='2394640'>rank</span> <span m='2395300'>within</span>
  <span m='2395810'>the</span> <span m='2395900'>overall</span> <span m='2396320'>chunk,</span>
  <span m='2401900'>not</span> <span m='2402380'>relative</span> <span m='2402920'>to</span>
  <span m='2403010'>the</span> <span m='2403160'>entire</span> <span m='2403670'>array.</span>
  </p><p><span m='2405800'>Why</span> <span m='2405950'>does</span> <span m='2406130'>that</span>
  <span m='2406280'>help</span> <span m='2406490'>me?</span> </p><p><span m='2411520'>AUDIENCE:</span>
  <span m='2411640'>Need</span> <span m='2411760'>less</span> <span m='2411880'>bits.</span>
  </p><p><span m='2412980'>ERIK DEMAINE:</span> <span m='2413085'>Need</span> <span
  m='2413190'>less</span> <span m='2413430'>bits.</span> <span m='2414480'>These</span>
  <span m='2414720'>ranks</span> <span m='2415080'>can't</span> <span m='2415290'>get</span>
  <span m='2415470'>too</span> <span m='2415650'>big,</span> <span m='2415920'>because</span>
  <span m='2416250'>the</span> <span m='2416340'>overall</span> <span m='2416760'>size</span>
  <span m='2417030'>of</span> <span m='2417120'>a</span> <span m='2417150'>chunk</span>
  <span m='2417540'>is</span> <span m='2417690'>just</span> <span m='2417870'>log</span>
  <span m='2418170'>squared.</span> <span m='2419520'>Log</span> <span m='2419910'>of</span>
  <span m='2420000'>log</span> <span m='2420210'>squared</span> <span m='2420600'>is</span>
  <span m='2420690'>log</span> <span m='2420990'>log</span> <span m='2421230'>n.</span>
  <span m='2421940'>So</span> <span m='2422070'>I</span> <span m='2422160'>only</span>
  <span m='2422370'>need</span> <span m='2423480'>log</span> <span m='2423810'>log</span>
  <span m='2424050'>n</span> <span m='2424200'>bits</span> <span m='2425520'>to</span>
  <span m='2425670'>write</span> <span m='2425910'>down</span> <span m='2426960'>those</span>
  <span m='2427590'>cumulative</span> <span m='2428130'>ranks.</span> </p><p><span
  m='2431200'>And</span> <span m='2431220'>so</span> <span m='2433200'>total</span>
  <span m='2433500'>size</span> <span m='2433920'>here</span> <span m='2434520'>is</span>
  <span m='2434670'>going</span> <span m='2434820'>to</span> <span m='2434910'>be</span>
  <span m='2435330'>n</span> <span m='2435580'>over</span> <span m='2435920'>log</span>
  <span m='2436230'>n</span> <span m='2438060'>times</span> <span m='2438650'>log
  log</span> <span m='2438990'>n</span> <span m='2441176'>bits,</span> <span m='2443670'>because</span>
  <span m='2443850'>there's</span> <span m='2444030'>n</span> <span m='2444150'>over</span>
  <span m='2444360'>log n</span> <span m='2444750'>of</span> <span m='2444840'>these</span>
  <span m='2445050'>red</span> <span m='2445260'>vertical</span> <span m='2445620'>bars.</span>
  <span m='2446760'>Each</span> <span m='2446940'>one</span> <span m='2447080'>I</span>
  <span m='2447110'>only</span> <span m='2447290'>need</span> <span m='2447410'>to</span>
  <span m='2447540'>write</span> <span m='2447840'>log</span> <span m='2448110'>log</span>
  <span m='2448260'>n</span> <span m='2448380'>bits.</span> <span m='2448720'>And</span>
  <span m='2448820'>this</span> <span m='2448920'>is</span> <span m='2449400'>slightly</span>
  <span m='2449900'>little</span> <span m='2450230'>o of n.</span> <span m='2450450'>It's</span>
  <span m='2450660'>actually</span> <span m='2450900'>a</span> <span m='2450930'>little</span>
  <span m='2451170'>bit</span> <span m='2451290'>bigger</span> <span m='2451560'>than</span>
  <span m='2451710'>this,</span> <span m='2451980'>but</span> <span m='2452100'>still</span>
  <span m='2452380'>little</span> <span m='2452670'>of of</span> <span m='2452870'>n.</span>
  <span m='2454260'>So</span> <span m='2455130'>we</span> <span m='2455280'>can</span>
  <span m='2455400'>still</span> <span m='2455640'>afford</span> <span m='2455940'>this.</span>
  </p><p><span m='2457050'>And</span> <span m='2457170'>now</span> <span m='2457410'>we're</span>
  <span m='2457860'>done,</span> <span m='2458220'>because</span> <span m='2459150'>these</span>
  <span m='2459570'>subchunks</span> <span m='2460320'>are</span> <span m='2460420'>of</span>
  <span m='2460470'>size</span> <span m='2460930'>1/2</span> <span m='2461260'>log
  n,</span> <span m='2461970'>so</span> <span m='2462120'>I</span> <span m='2462180'>can</span>
  <span m='2462300'>use</span> <span m='2462490'>this</span> <span m='2462600'>lookup</span>
  <span m='2462930'>table</span> <span m='2463890'>and</span> <span m='2464010'>solve</span>
  <span m='2464250'>my</span> <span m='2464370'>problem.</span> <span m='2465600'>So</span>
  <span m='2469680'>let</span> <span m='2469740'>me</span> <span m='2469860'>step</span>
  <span m='2470100'>forward,</span> <span m='2470520'>just</span> <span m='2470670'>putting</span>
  <span m='2470970'>everything</span> <span m='2471330'>together.</span> </p><p><span
  m='2475200'>To</span> <span m='2475350'>compute</span> <span m='2475740'>the</span>
  <span m='2475830'>rank</span> <span m='2476160'>of</span> <span m='2476280'>a</span>
  <span m='2476340'>query,</span> <span m='2477270'>first</span> <span m='2477540'>thing</span>
  <span m='2477690'>you</span> <span m='2477780'>do</span> <span m='2477930'>is</span>
  <span m='2478050'>figure</span> <span m='2478290'>out</span> <span m='2478380'>which</span>
  <span m='2478620'>chunk</span> <span m='2478920'>you</span> <span m='2479010'>fall</span>
  <span m='2479280'>into,</span> <span m='2479550'>which</span> <span m='2479700'>you</span>
  <span m='2479790'>can</span> <span m='2479910'>do</span> <span m='2480030'>by</span>
  <span m='2480180'>division,</span> <span m='2481020'>integer</span> <span m='2481180'>division.</span>
  <span m='2482760'>These</span> <span m='2483030'>things</span> <span m='2483270'>are</span>
  <span m='2483360'>stored</span> <span m='2483630'>in</span> <span m='2483720'>an</span>
  <span m='2483810'>array,</span> <span m='2484410'>so</span> <span m='2484500'>you</span>
  <span m='2484620'>just</span> <span m='2484920'>compute,</span> <span m='2485280'>what</span>
  <span m='2485490'>is</span> <span m='2485610'>that</span> <span m='2485730'>cumulative</span>
  <span m='2486210'>rank?</span> <span m='2492300'>So</span> <span m='2492420'>you</span>
  <span m='2492540'>take</span> <span m='2492750'>the</span> <span m='2492840'>rank</span>
  <span m='2493110'>of</span> <span m='2493200'>that</span> <span m='2493380'>chunk,</span>
  <span m='2495300'>you</span> <span m='2495510'>add</span> <span m='2495810'>on</span>
  <span m='2497160'>the</span> <span m='2497310'>rank</span> <span m='2498330'>of</span>
  <span m='2498540'>the</span> <span m='2498660'>subchunk</span> <span m='2499350'>within</span>
  <span m='2500340'>the</span> <span m='2500430'>chunk,</span> <span m='2503490'>and</span>
  <span m='2503670'>then</span> <span m='2503850'>you</span> <span m='2504030'>add</span>
  <span m='2504330'>on</span> <span m='2504690'>the</span> <span m='2504810'>rank</span>
  <span m='2505620'>of</span> <span m='2506430'>the</span> <span m='2506580'>element</span>
  <span m='2508020'>in</span> <span m='2508170'>the</span> <span m='2508290'>subchunk.</span>
  </p><p><span m='2513000'>So</span> <span m='2513450'>rank</span> <span m='2513750'>of
  the</span> <span m='2513900'>chunk</span> <span m='2514860'>is</span> <span m='2514920'>stored</span>
  <span m='2515220'>in</span> <span m='2515310'>the</span> <span m='2515430'>array</span>
  <span m='2516310'>known</span> <span m='2516420'>as</span> <span m='2516570'>2.</span>
  <span m='2517560'>The</span> <span m='2517680'>rank</span> <span m='2517950'>of</span>
  <span m='2518070'>the</span> <span m='2518130'>subchunk</span> <span m='2518640'>within</span>
  <span m='2518850'>the</span> <span m='2518940'>chunk</span> <span m='2519300'>is</span>
  <span m='2519450'>stored</span> <span m='2519720'>in</span> <span m='2519840'>the</span>
  <span m='2519960'>array,</span> <span m='2520530'>in</span> <span m='2520680'>the</span>
  <span m='2520800'>array</span> <span m='2521040'>known</span> <span m='2521250'>as</span>
  <span m='2521370'>3.</span> <span m='2522270'>And</span> <span m='2522390'>then</span>
  <span m='2522570'>to</span> <span m='2522630'>compute</span> <span m='2522900'>the</span>
  <span m='2523020'>rank</span> <span m='2523350'>of</span> <span m='2523470'>the</span>
  <span m='2523590'>element</span> <span m='2524310'>in</span> <span m='2524460'>the</span>
  <span m='2524540'>subchunk,</span> <span m='2525180'>you</span> <span m='2525330'>use</span>
  <span m='2525510'>the</span> <span m='2525630'>lookup</span> <span m='2525930'>table,</span>
  <span m='2527460'>which</span> <span m='2527610'>is</span> <span m='2527700'>essentially</span>
  <span m='2528180'>telling</span> <span m='2528480'>you</span> <span m='2528570'>for</span>
  <span m='2528720'>every</span> <span m='2528930'>possible</span> <span m='2529440'>subchunk</span>
  <span m='2530340'>what</span> <span m='2530520'>the</span> <span m='2530640'>answers</span>
  <span m='2530970'>are.</span> <span m='2531990'>So</span> <span m='2533400'>3</span>
  <span m='2533640'>times</span> <span m='2533850'>a</span> <span m='2533910'>constant</span>
  <span m='2534480'>is</span> <span m='2534600'>a</span> <span m='2534660'>constant.</span>
  <span m='2535800'>And</span> <span m='2535890'>we</span> <span m='2535980'>get</span>
  <span m='2536160'>rank,</span> <span m='2536580'>constant</span> <span m='2536970'>time,</span>
  <span m='2538260'>and</span> <span m='2538605'>n</span> <span m='2538950'>log</span>
  <span m='2539190'>log</span> <span m='2539400'>n</span> <span m='2539520'>over</span>
  <span m='2539790'>log</span> <span m='2540090'>n</span> <span m='2540270'>space.</span>
  </p><p><span m='2545700'>If</span> <span m='2545880'>you're</span> <span m='2546000'>concerned</span>
  <span m='2546510'>that</span> <span m='2547290'>n</span> <span m='2547590'>times</span>
  <span m='2547850'>log</span> <span m='2548000'>log</span> <span m='2548160'>n</span>
  <span m='2548370'>over</span> <span m='2548580'>log</span> <span m='2548820'>n</span>
  <span m='2548940'>is</span> <span m='2549060'>not</span> <span m='2549270'>very</span>
  <span m='2549510'>sublinear,</span> <span m='2550800'>you</span> <span m='2550920'>can</span>
  <span m='2551040'>do</span> <span m='2551160'>a</span> <span m='2551190'>little</span>
  <span m='2551400'>bit</span> <span m='2551550'>better</span> <span m='2555800'>using</span>
  <span m='2556220'>fancier</span> <span m='2556640'>tricks.</span> <span m='2569620'>Namely,</span>
  <span m='2570070'>you</span> <span m='2570190'>can</span> <span m='2570340'>achieve</span>
  <span m='2572320'>n</span> <span m='2572560'>over</span> <span m='2572740'>log</span>
  <span m='2573100'>to</span> <span m='2573250'>the</span> <span m='2573340'>kn</span>
  <span m='2575380'>space.</span> <span m='2586590'>This</span> <span m='2586740'>is</span>
  <span m='2586800'>the</span> <span m='2586860'>result</span> <span m='2587160'>of</span>
  <span m='2587220'>Patrascu</span> <span m='2587920'>from</span> <span m='2588570'>2008.</span>
  </p><p><span m='2589830'>I'm</span> <span m='2589920'>not</span> <span m='2590070'>going</span>
  <span m='2590190'>to</span> <span m='2590250'>go</span> <span m='2590400'>into</span>
  <span m='2590640'>how</span> <span m='2590790'>it's</span> <span m='2590940'>done.</span>
  <span m='2591810'>But</span> <span m='2592140'>if</span> <span m='2592230'>you're</span>
  <span m='2592320'>interested,</span> <span m='2593370'>it's</span> <span m='2593490'>a</span>
  <span m='2593550'>little</span> <span m='2593760'>bit</span> <span m='2593940'>less.</span>
  <span m='2594420'>It</span> <span m='2594480'>would</span> <span m='2594570'>be</span>
  <span m='2594660'>nice</span> <span m='2594930'>to</span> <span m='2595020'>do</span>
  <span m='2595290'>better.</span> <span m='2595620'>But</span> <span m='2595800'>my</span>
  <span m='2596040'>guess</span> <span m='2596610'>is</span> <span m='2596760'>there</span>
  <span m='2596850'>should</span> <span m='2597060'>be</span> <span m='2597180'>a</span>
  <span m='2597240'>lower</span> <span m='2597510'>bounds,</span> <span m='2598050'>that</span>
  <span m='2598440'>with</span> <span m='2598760'>constant--</span> <span m='2599500'>so</span>
  <span m='2599520'>this</span> <span m='2599700'>is</span> <span m='2599790'>for</span>
  <span m='2599940'>any</span> <span m='2600240'>constant</span> <span m='2600760'>k.</span>
  </p><p><span m='2605280'>It</span> <span m='2605400'>would</span> <span m='2605490'>be</span>
  <span m='2605610'>nice</span> <span m='2606000'>to</span> <span m='2606180'>do</span>
  <span m='2606330'>better,</span> <span m='2606910'>like</span> <span m='2607140'>square</span>
  <span m='2607330'>root</span> <span m='2607400'>of n</span> <span m='2607680'>or</span>
  <span m='2607770'>something.</span> <span m='2608120'>But</span> <span m='2608250'>my</span>
  <span m='2608370'>guess</span> <span m='2608640'>is</span> <span m='2608790'>there's</span>
  <span m='2608940'>a</span> <span m='2609000'>matching</span> <span m='2609300'>lower</span>
  <span m='2609510'>bound.</span> <span m='2610530'>I</span> <span m='2610560'>don't</span>
  <span m='2610770'>think</span> <span m='2610950'>that's</span> <span m='2611170'>known.</span>
  </p><p><span m='2613500'>OK.</span> <span m='2613770'>So</span> <span m='2613920'>that</span>
  <span m='2614040'>was</span> <span m='2614220'>rank.</span> <span m='2616020'>Our</span>
  <span m='2616140'>next</span> <span m='2616350'>challenge</span> <span m='2616740'>is</span>
  <span m='2616830'>to</span> <span m='2616950'>do</span> <span m='2617100'>select,</span>
  <span m='2617610'>the</span> <span m='2617760'>inverse.</span> <span m='2618810'>And</span>
  <span m='2618900'>select</span> <span m='2619470'>is</span> <span m='2620010'>a</span>
  <span m='2620070'>little</span> <span m='2620400'>bit</span> <span m='2620550'>harder,</span>
  <span m='2621240'>I</span> <span m='2621360'>would</span> <span m='2621510'>say.</span>
  <span m='2623320'>Don't</span> <span m='2623460'>have</span> <span m='2623640'>a</span>
  <span m='2623670'>great</span> <span m='2623910'>intuition</span> <span m='2624300'>why.</span>
  <span m='2628746'>But it is.</span> </p><p><span m='2632710'>And</span> <span m='2633160'>we're</span>
  <span m='2633310'>going</span> <span m='2633450'>to</span> <span m='2633520'>be</span>
  <span m='2633640'>able</span> <span m='2633820'>to</span> <span m='2633880'>use</span>
  <span m='2634270'>the</span> <span m='2634390'>same</span> <span m='2634930'>kind</span>
  <span m='2635140'>of</span> <span m='2635260'>technique.</span> <span m='2636100'>So</span>
  <span m='2636310'>again,</span> <span m='2637420'>we</span> <span m='2637510'>can</span>
  <span m='2637630'>use</span> <span m='2637810'>a</span> <span m='2637900'>lookup</span>
  <span m='2638170'>table</span> <span m='2639430'>and--</span> <span m='2641842'>I'll</span>
  <span m='2642310'>do</span> <span m='2642460'>that</span> <span m='2642610'>first.</span>
  </p><p></p><p><span m='2657710'>So</span> <span m='2658660'>just</span> <span m='2658870'>like</span>
  <span m='2659050'>before,</span> <span m='2659780'>if</span> <span m='2659860'>we</span>
  <span m='2659950'>have</span> <span m='2660130'>bit</span> <span m='2660310'>strings</span>
  <span m='2660610'>of</span> <span m='2660730'>length</span> <span m='2661270'>at</span>
  <span m='2661390'>most</span> <span m='2661750'>1/2</span> <span m='2662110'>log</span>
  <span m='2662330'>n,</span> <span m='2664450'>then</span> <span m='2664900'>we're</span>
  <span m='2665050'>only</span> <span m='2665290'>going</span> <span m='2665470'>to</span>
  <span m='2665530'>need</span> <span m='2665920'>something</span> <span m='2666280'>like</span>
  <span m='2666520'>root</span> <span m='2666700'>n</span> <span m='2666850'>space.</span>
  <span m='2667420'>It's</span> <span m='2667540'>root</span> <span m='2667810'>n</span>
  <span m='2668630'>again</span> <span m='2668890'>times</span> <span m='2669220'>log</span>
  <span m='2669550'>n</span> <span m='2670330'>log</span> <span m='2670600'>log</span>
  <span m='2670840'>n</span> <span m='2670990'>space,</span> <span m='2672670'>just</span>
  <span m='2672910'>like</span> <span m='2673120'>rank.</span> </p><p><span m='2673690'>There</span>
  <span m='2673970'>are at</span> <span m='2674260'>most</span> <span m='2674575'>n</span>
  <span m='2674890'>possible</span> <span m='2675370'>queries,</span> <span m='2675790'>actually</span>
  <span m='2676180'>fewer,</span> <span m='2676630'>because</span> <span m='2676900'>there</span>
  <span m='2676990'>may</span> <span m='2677110'>be</span> <span m='2677230'>fewer</span>
  <span m='2677470'>1</span> <span m='2677660'>bits.</span> <span m='2677920'>But</span>
  <span m='2678040'>at</span> <span m='2678130'>most,</span> <span m='2678340'>there
  are</span> <span m='2678550'>n</span> <span m='2678820'>1</span> <span m='2679030'>bits</span>
  <span m='2679390'>to</span> <span m='2679510'>query.</span> <span m='2680350'>An</span>
  <span m='2680470'>answer</span> <span m='2680950'>is</span> <span m='2681100'>now</span>
  <span m='2681280'>an</span> <span m='2681400'>index,</span> <span m='2681880'>which</span>
  <span m='2682120'>is</span> <span m='2682720'>within</span> <span m='2683050'>a</span>
  <span m='2683140'>thing</span> <span m='2683410'>of</span> <span m='2683500'>size</span>
  <span m='2683770'>1/2</span> <span m='2684010'>log</span> <span m='2684220'>n.</span>
  <span m='2684370'>So</span> <span m='2684460'>I</span> <span m='2684520'>just</span>
  <span m='2684700'>have</span> <span m='2684790'>to</span> <span m='2684880'>write</span>
  <span m='2685030'>down</span> <span m='2685210'>an</span> <span m='2685300'>index</span>
  <span m='2686170'>of</span> <span m='2686230'>that</span> <span m='2686410'>size,</span>
  <span m='2686860'>Soit's</span> <span m='2687130'>it's</span> <span m='2687770'>log</span>
  <span m='2688040'>log</span> <span m='2688210'>n</span> <span m='2688330'>bits</span>
  <span m='2688570'>to</span> <span m='2688690'>write</span> <span m='2688840'>it</span>
  <span m='2688900'>down.</span> </p><p><span m='2690730'>Cool.</span> <span m='2691570'>So</span>
  <span m='2692230'>that's</span> <span m='2692470'>the</span> <span m='2692560'>same.</span>
  <span m='2693190'>Now</span> <span m='2693400'>the</span> <span m='2693490'>challenge</span>
  <span m='2693970'>is</span> <span m='2694090'>about</span> <span m='2694330'>getting</span>
  <span m='2694600'>down</span> <span m='2694840'>to</span> <span m='2696010'>1/2</span>
  <span m='2696280'>log</span> <span m='2696460'>n</span> <span m='2696670'>bits.</span>
  <span m='2697030'>We're going</span> <span m='2697180'>to</span> <span m='2697330'>use</span>
  <span m='2697450'>the</span> <span m='2697510'>same</span> <span m='2697780'>technique</span>
  <span m='2698380'>of</span> <span m='2699160'>two</span> <span m='2699400'>levels</span>
  <span m='2699760'>of</span> <span m='2699850'>indirection.</span> <span m='2700990'>But</span>
  <span m='2701170'>they</span> <span m='2701320'>work</span> <span m='2701590'>differently.</span>
  <span m='2703000'>There's</span> <span m='2703210'>an</span> <span m='2703300'>extra</span>
  <span m='2704140'>thing</span> <span m='2704530'>we</span> <span m='2704650'>need</span>
  <span m='2704800'>to</span> <span m='2704890'>deal</span> <span m='2705130'>with</span>
  <span m='2706920'>in</span> <span m='2707380'>select.</span> </p><p><span m='2710650'>There</span>
  <span m='2710740'>will</span> <span m='2710830'>be</span> <span m='2710980'>two</span>
  <span m='2711190'>cases,</span> <span m='2711860'>depending</span> <span m='2712210'>on</span>
  <span m='2712630'>whether</span> <span m='2712930'>your</span> <span m='2713650'>array</span>
  <span m='2714070'>has</span> <span m='2714880'>lots</span> <span m='2715240'>of</span>
  <span m='2715360'>1's</span> <span m='2715720'>or</span> <span m='2715810'>not</span>
  <span m='2716020'>so</span> <span m='2716170'>many</span> <span m='2716440'>1's.</span>
  <span m='2718030'>And</span> <span m='2718120'>those</span> <span m='2718300'>two</span>
  <span m='2718450'>cases</span> <span m='2719680'>can</span> <span m='2719890'>vary</span>
  <span m='2720310'>throughout</span> <span m='2720670'>the</span> <span m='2720760'>string.</span>
  <span m='2724850'>So</span> <span m='2726500'>what</span> <span m='2726710'>we</span>
  <span m='2726860'>do,</span> <span m='2728960'>first</span> <span m='2729260'>of</span>
  <span m='2729380'>all,</span> <span m='2731040'>is--</span> <span m='2736356'>actually,</span>
  <span m='2736820'>maybe</span> <span m='2737090'>I'll</span> <span m='2737180'>go</span>
  <span m='2737480'>over</span> <span m='2737750'>here.</span> <span m='2740580'>I'll</span>
  <span m='2741650'>stick</span> <span m='2741950'>here.</span> <span m='2742190'>Whatever.</span>
  </p><p><span m='2748310'>So</span> <span m='2748460'>we're</span> <span m='2748550'>back</span>
  <span m='2748820'>to</span> <span m='2749090'>an</span> <span m='2749210'>n-bit</span>
  <span m='2749480'>string.</span> <span m='2767100'>So</span> <span m='2767250'>we're</span>
  <span m='2767340'>looking</span> <span m='2767760'>at</span> <span m='2768630'>we</span>
  <span m='2768750'>want</span> <span m='2768930'>the</span> <span m='2769080'>analog</span>
  <span m='2769950'>of</span> <span m='2771120'>this</span> <span m='2771250'>structure,</span>
  <span m='2771990'>this</span> <span m='2772130'>structure</span> <span m='2772530'>of</span>
  <span m='2772620'>chunks.</span> <span m='2773380'>Now,</span> <span m='2773520'>we</span>
  <span m='2773640'>can't</span> <span m='2773910'>just</span> <span m='2774060'>say,</span>
  <span m='2774460'>oh,</span> <span m='2774660'>take</span> <span m='2774900'>the</span>
  <span m='2774990'>bit</span> <span m='2775140'>string,</span> <span m='2775560'>divide
  it</span> <span m='2775950'>into</span> <span m='2776130'>chunks</span> <span m='2776430'>of</span>
  <span m='2776520'>equal</span> <span m='2776760'>size,</span> <span m='2777930'>because</span>
  <span m='2778320'>then</span> <span m='2778620'>given</span> <span m='2778920'>a</span>
  <span m='2778980'>query,</span> <span m='2779910'>we</span> <span m='2779970'>want</span>
  <span m='2780100'>to</span> <span m='2780170'>do</span> <span m='2780270'>select</span>
  <span m='2780645'>of</span> <span m='2781020'>j,</span> <span m='2782460'>we</span>
  <span m='2782640'>need</span> <span m='2782760'>to</span> <span m='2782910'>know</span>
  <span m='2785820'>which</span> <span m='2786090'>of</span> <span m='2786150'>these</span>
  <span m='2786360'>chunks</span> <span m='2786720'>j</span> <span m='2786930'>belongs</span>
  <span m='2787380'>to.</span> </p><p><span m='2788010'>So</span> <span m='2788100'>instead</span>
  <span m='2788370'>of</span> <span m='2788430'>making</span> <span m='2788670'>them</span>
  <span m='2788820'>equal</span> <span m='2789090'>size,</span> <span m='2789510'>we're</span>
  <span m='2789590'>going</span> <span m='2789660'>to</span> <span m='2789780'>make</span>
  <span m='2789960'>them</span> <span m='2790110'>have</span> <span m='2790260'>an</span>
  <span m='2790350'>equal</span> <span m='2790590'>number</span> <span m='2790860'>of</span>
  <span m='2790950'>1</span> <span m='2791190'>bits.</span> <span m='2792160'>So</span>
  <span m='2792180'>then</span> <span m='2792330'>we</span> <span m='2792420'>can</span>
  <span m='2792540'>just</span> <span m='2792660'>take</span> <span m='2792900'>j,</span>
  <span m='2793830'>divide</span> <span m='2794310'>by</span> <span m='2795390'>the</span>
  <span m='2795480'>size</span> <span m='2795870'>of</span> <span m='2795990'>these</span>
  <span m='2796230'>chunks,</span> <span m='2796680'>which</span> <span m='2796860'>is</span>
  <span m='2796950'>log</span> <span m='2797280'>n</span> <span m='2797420'>log</span>
  <span m='2797660'>log</span> <span m='2797810'>n.</span> <span m='2798900'>You</span>
  <span m='2799020'>could</span> <span m='2799140'>probably</span> <span m='2799410'>do</span>
  <span m='2799530'>log</span> <span m='2799800'>squared</span> <span m='2800160'>as</span>
  <span m='2800280'>well,</span> <span m='2800520'>but</span> <span m='2800820'>log</span>
  <span m='2801120'>n</span> <span m='2801210'>log</span> <span m='2801420'>log</span>
  <span m='2801480'>n</span> <span m='2803000'>is</span> <span m='2803160'>a</span>
  <span m='2803220'>slightly</span> <span m='2803700'>better</span> <span m='2803970'>choice.</span>
  </p><p><span m='2807150'>And</span> <span m='2807330'>so</span> <span m='2808800'>we</span>
  <span m='2808920'>just</span> <span m='2809070'>divide</span> <span m='2809550'>every</span>
  <span m='2809760'>log</span> <span m='2810030'>n</span> <span m='2810120'>log</span>
  <span m='2810300'>log</span> <span m='2810480'>n</span> <span m='2811740'>1</span>
  <span m='2812040'>bit,</span> <span m='2812580'>put</span> <span m='2812760'>a</span>
  <span m='2812820'>vertical</span> <span m='2813210'>bar.</span> <span m='2813900'>That</span>
  <span m='2814050'>way,</span> <span m='2814170'>given</span> <span m='2814470'>j,</span>
  <span m='2814710'>we</span> <span m='2814800'>divide</span> <span m='2815130'>by</span>
  <span m='2815250'>this</span> <span m='2815430'>thing,</span> <span m='2815640'>take</span>
  <span m='2815820'>the floor,</span> <span m='2816300'>that</span> <span m='2816450'>tells</span>
  <span m='2816690'>us</span> <span m='2816810'>which</span> <span m='2817020'>chunk</span>
  <span m='2817260'>we</span> <span m='2817380'>belong</span> <span m='2817680'>to.</span>
  <span m='2818940'>So it's</span> <span m='2819150'>different.</span> <span m='2820020'>Decomposing</span>
  <span m='2820590'>by</span> <span m='2820770'>1</span> <span m='2821040'>space</span>
  <span m='2821400'>instead</span> <span m='2821640'>of</span> <span m='2821730'>01</span>
  <span m='2822180'>space.</span> </p><p><span m='2824490'>And</span> <span m='2824730'>so</span>
  <span m='2825060'>for</span> <span m='2825270'>those</span> <span m='2825480'>guys,</span>
  <span m='2825750'>we</span> <span m='2825840'>just</span> <span m='2825960'>store</span>
  <span m='2826170'>an</span> <span m='2826230'>array.</span> <span m='2827160'>If</span>
  <span m='2827310'>your</span> <span m='2827430'>query</span> <span m='2827670'>happens</span>
  <span m='2828060'>to</span> <span m='2828600'>have</span> <span m='2829020'>a</span>
  <span m='2829500'>0</span> <span m='2829920'>mod</span> <span m='2830190'>this,</span>
  <span m='2830700'>then</span> <span m='2830850'>you</span> <span m='2830970'>have</span>
  <span m='2831150'>your</span> <span m='2831300'>answer.</span> <span m='2832020'>Otherwise,</span>
  <span m='2832470'>you</span> <span m='2832530'>still</span> <span m='2832710'>need</span>
  <span m='2832860'>to</span> <span m='2832950'>query</span> <span m='2833280'>within</span>
  <span m='2833580'>the</span> <span m='2833700'>chunk.</span> <span m='2834810'>In
  some</span> <span m='2835020'>sense,</span> <span m='2835530'>the</span> <span m='2836610'>array</span>
  <span m='2837120'>has</span> <span m='2837240'>gotten</span> <span m='2837480'>divided</span>
  <span m='2838920'>something</span> <span m='2839310'>like</span> <span m='2839490'>this,</span>
  <span m='2841870'>so</span> <span m='2841920'>the</span> <span m='2842010'>number</span>
  <span m='2842340'>of</span> <span m='2842460'>1</span> <span m='2842730'>bits</span>
  <span m='2843300'>in</span> <span m='2843450'>here</span> <span m='2843720'>is</span>
  <span m='2844200'>always</span> <span m='2844440'>the</span> <span m='2844530'>same,</span>
  <span m='2845410'>log</span> <span m='2845850'>n</span> <span m='2847290'>log</span>
  <span m='2847530'>log</span> <span m='2847770'>n</span> <span m='2848680'>1's.</span>
  </p><p><span m='2850840'>So</span> <span m='2851010'>you</span> <span m='2851130'>can</span>
  <span m='2851280'>now</span> <span m='2851460'>teleport</span> <span m='2852060'>to</span>
  <span m='2852180'>the</span> <span m='2852300'>appropriate</span> <span m='2852730'>chunk.
  And</span> <span m='2853200'>the</span> <span m='2853290'>issue</span> <span m='2853590'>is,</span>
  <span m='2853770'>how</span> <span m='2853950'>do</span> <span m='2854070'>I</span>
  <span m='2854160'>solve</span> <span m='2854460'>a</span> <span m='2854520'>chunk?</span>
  <span m='2854850'>But</span> <span m='2855000'>now</span> <span m='2855210'>chunks</span>
  <span m='2855540'>have</span> <span m='2855640'>different</span> <span m='2856020'>sizes,</span>
  <span m='2856720'>which</span> <span m='2856770'>is</span> <span m='2856890'>kind</span>
  <span m='2857070'>of</span> <span m='2857160'>annoying.</span> </p><p><span m='2858050'>That's</span>
  <span m='2858300'>why</span> <span m='2858510'>we</span> <span m='2858630'>need</span>
  <span m='2859320'>this</span> <span m='2859500'>extra</span> <span m='2859800'>step,</span>
  <span m='2861640'>which</span> <span m='2861810'>is</span> <span m='2862140'>within</span>
  <span m='2865110'>a</span> <span m='2865200'>group</span> <span m='2868230'>of</span>
  <span m='2869460'>log</span> <span m='2869850'>n</span> <span m='2870330'>log</span>
  <span m='2870600'>log</span> <span m='2870810'>n</span> <span m='2872250'>1</span>
  <span m='2872580'>bits--</span> <span m='2873040'>I'm</span> <span m='2873210'>calling</span>
  <span m='2873480'>them</span> <span m='2873660'>groups</span> <span m='2873990'>now,</span>
  <span m='2874200'>instead</span> <span m='2874470'>of</span> <span m='2874560'>chunks.</span>
  <span m='2877350'>So</span> <span m='2877950'>each</span> <span m='2878220'>of</span>
  <span m='2878280'>these</span> <span m='2878460'>groups</span> <span m='2879090'>has</span>
  <span m='2879450'>different</span> <span m='2879780'>size.</span> <span m='2880830'>Let's</span>
  <span m='2880950'>suppose</span> <span m='2881700'>it</span> <span m='2881820'>has</span>
  <span m='2883080'>size</span> <span m='2883510'>r,</span> <span m='2888310'>so</span>
  <span m='2888490'>say</span> <span m='2888640'>it's</span> <span m='2888790'>r</span>
  <span m='2889030'>bits</span> <span m='2889300'>long.</span> <span m='2894180'>R</span>
  <span m='2894450'>is</span> <span m='2894650'>going</span> <span m='2894790'>to</span>
  <span m='2894850'>be</span> <span m='2894910'>different</span> <span m='2895240'>for</span>
  <span m='2895360'>each</span> <span m='2895570'>chunk,</span> <span m='2895920'>but</span>
  <span m='2896190'>we'll</span> <span m='2896940'>do</span> <span m='2897040'>this</span>
  <span m='2897220'>for</span> <span m='2897340'>every</span> <span m='2897580'>chunk,</span>
  <span m='2899140'>every</span> <span m='2899350'>group.</span> </p><p><span m='2901040'>Then</span>
  <span m='2901120'>there's</span> <span m='2901270'>two</span> <span m='2901420'>cases.</span>
  <span m='2902750'>If</span> <span m='2902800'>r</span> <span m='2903040'>is</span>
  <span m='2903190'>big,</span> <span m='2905860'>we're</span> <span m='2906320'>done.</span>
  <span m='2908080'>How</span> <span m='2908230'>big?</span> <span m='2909360'>Well,</span>
  <span m='2909730'>if</span> <span m='2909850'>it's</span> <span m='2909970'>at</span>
  <span m='2910030'>least</span> <span m='2910300'>the</span> <span m='2910420'>square</span>
  <span m='2911200'>of</span> <span m='2911320'>the</span> <span m='2911410'>number</span>
  <span m='2911770'>of</span> <span m='2911890'>1</span> <span m='2912160'>bits,</span>
  <span m='2912910'>that</span> <span m='2913060'>means</span> <span m='2913270'>it's</span>
  <span m='2913420'>very</span> <span m='2913750'>sparse.</span> <span m='2915090'>Only</span>
  <span m='2915370'>square</span> <span m='2915670'>root</span> <span m='2915880'>of</span>
  <span m='2916000'>the</span> <span m='2916420'>bits</span> <span m='2916870'>are</span>
  <span m='2917110'>1's.</span> <span m='2917560'>The</span> <span m='2917650'>rest</span>
  <span m='2917920'>are</span> <span m='2918010'>all</span> <span m='2918130'>0's.</span>
  </p><p><span m='2920270'>But</span> <span m='2920350'>then,</span> <span m='2920860'>I</span>
  <span m='2921010'>can</span> <span m='2921160'>afford</span> <span m='2921490'>to</span>
  <span m='2921580'>just</span> <span m='2921760'>store</span> <span m='2922030'>all</span>
  <span m='2922120'>the</span> <span m='2922270'>answers.</span> <span m='2940070'>I'm</span>
  <span m='2940170'>just</span> <span m='2940180'>going</span> <span m='2940330'>to</span>
  <span m='2940390'>store</span> <span m='2940600'>a</span> <span m='2940630'>lookup</span>
  <span m='2940960'>table</span> <span m='2941230'>of</span> <span m='2941320'>all</span>
  <span m='2941440'>the</span> <span m='2941560'>answers</span> <span m='2941950'>if</span>
  <span m='2942100'>it's</span> <span m='2942220'>very</span> <span m='2942430'>sparse,</span>
  <span m='2942910'>because</span> <span m='2943270'>then</span> <span m='2970460'>I</span>
  <span m='2970560'>claim</span> <span m='2970940'>I</span> <span m='2971030'>only</span>
  <span m='2971240'>need</span> <span m='2971390'>this</span> <span m='2971600'>many</span>
  <span m='2971880'>bits</span> <span m='2972830'>in</span> <span m='2972980'>order</span>
  <span m='2973280'>to</span> <span m='2974270'>store</span> <span m='2975290'>all</span>
  <span m='2975530'>of</span> <span m='2975650'>these</span> <span m='2975830'>answers.</span>
  </p><p><span m='2976300'>So</span> <span m='2976370'>if</span> <span m='2976880'>I</span>
  <span m='2977000'>do</span> <span m='2977150'>this</span> <span m='2977330'>for</span>
  <span m='2977480'>all</span> <span m='2977750'>groups</span> <span m='2978830'>that</span>
  <span m='2978950'>have</span> <span m='2979160'>a</span> <span m='2979190'>large</span>
  <span m='2979550'>number</span> <span m='2979820'>of</span> <span m='2979880'>bits,</span>
  <span m='2980570'>I</span> <span m='2980660'>store</span> <span m='2980900'>this</span>
  <span m='2981110'>lookup</span> <span m='2981420'>array,</span> <span m='2982550'>how</span>
  <span m='2984380'>many--</span> <span m='2984950'>if</span> <span m='2985130'>I</span>
  <span m='2985220'>sum</span> <span m='2985490'>up</span> <span m='2985610'>the</span>
  <span m='2985700'>size</span> <span m='2986060'>of</span> <span m='2986180'>all</span>
  <span m='2986240'>of</span> <span m='2986300'>these</span> <span m='2986450'>arrays,</span>
  <span m='2986840'>how</span> <span m='2986990'>much</span> <span m='2987170'>do</span>
  <span m='2987290'>I</span> <span m='2987380'>pay?</span> <span m='2988670'>Well,</span>
  <span m='2990980'>the</span> <span m='2991100'>lookup</span> <span m='2991400'>array</span>
  <span m='2992330'>has</span> <span m='2992630'>this</span> <span m='2992810'>kind</span>
  <span m='2992990'>of</span> <span m='2993080'>size.</span> <span m='2993470'>There
  are</span> <span m='2993590'>log</span> <span m='2993950'>n</span> <span m='2994100'>log</span>
  <span m='2994340'>log</span> <span m='2994550'>n</span> <span m='2995290'>1</span>
  <span m='2995540'>bits.</span> <span m='2996260'>And</span> <span m='2996410'>each</span>
  <span m='2996590'>of</span> <span m='2996650'>them</span> <span m='2996830'>I</span>
  <span m='2996920'>need</span> <span m='2997070'>to</span> <span m='2997160'>store</span>
  <span m='2997370'>an</span> <span m='2997460'>index</span> <span m='2998420'>for</span>
  <span m='2998660'>them.</span> </p><p><span m='2999500'>Now,</span> <span m='2999620'>this</span>
  <span m='2999770'>could</span> <span m='2999980'>cost</span> <span m='3000370'>log</span>
  <span m='3000690'>n</span> <span m='3000820'>bits,</span> <span m='3001090'>because</span>
  <span m='3001450'>potentially</span> <span m='3002620'>one</span> <span m='3002830'>of</span>
  <span m='3002890'>these</span> <span m='3004150'>groups</span> <span m='3004570'>is</span>
  <span m='3004750'>very</span> <span m='3005050'>large.</span> <span m='3005410'>It</span>
  <span m='3005470'>could</span> <span m='3005590'>be</span> <span m='3005710'>almost</span>
  <span m='3005920'>linear</span> <span m='3006280'>size.</span> <span m='3006660'>So</span>
  <span m='3006740'>I</span> <span m='3006820'>need</span> <span m='3007420'>log</span>
  <span m='3007680'>n</span> <span m='3007810'>bits</span> <span m='3008020'>to</span>
  <span m='3008140'>write</span> <span m='3008320'>down</span> <span m='3008500'>a</span>
  <span m='3008560'>position</span> <span m='3009010'>in</span> <span m='3009100'>there.</span>
  <span m='3009850'>There's</span> <span m='3010030'>log</span> <span m='3010360'>n</span>
  <span m='3010510'>log</span> <span m='3010720'>log</span> <span m='3010930'>n</span>
  <span m='3011080'>1</span> <span m='3011260'>bits</span> <span m='3011500'>to</span>
  <span m='3011580'>write</span> <span m='3011740'>down</span> <span m='3011860'>to</span>
  <span m='3011920'>position</span> <span m='3012340'>for.</span> <span m='3012670'>So</span>
  <span m='3012850'>this</span> <span m='3013030'>is</span> <span m='3013150'>the</span>
  <span m='3013270'>size</span> <span m='3014530'>of</span> <span m='3015370'>one</span>
  <span m='3016360'>of</span> <span m='3016540'>these</span> <span m='3016750'>arrays.</span>
  </p><p><span m='3019240'>Now,</span> <span m='3019390'>how</span> <span m='3019630'>many</span>
  <span m='3019840'>of</span> <span m='3019930'>these</span> <span m='3020620'>could</span>
  <span m='3020800'>I</span> <span m='3020890'>possibly</span> <span m='3021430'>need</span>
  <span m='3021610'>to</span> <span m='3021700'>store?</span> <span m='3022650'>Well,</span>
  <span m='3022750'>I</span> <span m='3022810'>know</span> <span m='3022960'>that</span>
  <span m='3023020'>this</span> <span m='3023290'>group</span> <span m='3024040'>has</span>
  <span m='3024430'>log</span> <span m='3024760'>n</span> <span m='3024940'>log</span>
  <span m='3025150'>log</span> <span m='3025390'>n</span> <span m='3025570'>squared</span>
  <span m='3026170'>bits</span> <span m='3026500'>in</span> <span m='3026590'>it,</span>
  <span m='3027440'>so</span> <span m='3027520'>the</span> <span m='3027610'>maximum</span>
  <span m='3028120'>number</span> <span m='3028360'>of</span> <span m='3028420'>such</span>
  <span m='3028690'>groups</span> <span m='3029500'>is</span> <span m='3029650'>n</span>
  <span m='3029950'>over</span> <span m='3030280'>that,</span> <span m='3031450'>n</span>
  <span m='3031600'>over</span> <span m='3031840'>log</span> <span m='3032110'>n</span>
  <span m='3032260'>log</span> <span m='3032500'>log</span> <span m='3032680'>n</span>
  <span m='3032830'>squared.</span> </p><p><span m='3034110'>And</span> <span m='3034120'>now</span>
  <span m='3035290'>we</span> <span m='3035380'>get</span> <span m='3035530'>to</span>
  <span m='3035620'>do</span> <span m='3035740'>some</span> <span m='3035920'>cancellation.</span>
  <span m='3038250'>So</span> <span m='3038560'>this</span> <span m='3038980'>2</span>
  <span m='3039460'>cancels</span> <span m='3040000'>with</span> <span m='3040120'>this</span>
  <span m='3040300'>log</span> <span m='3040600'>n</span> <span m='3040720'>log</span>
  <span m='3040930'>log</span> <span m='3041140'>n.</span> <span m='3042010'>And</span>
  <span m='3042100'>then</span> <span m='3042220'>this</span> <span m='3042370'>log</span>
  <span m='3042700'>n</span> <span m='3042910'>cancels</span> <span m='3043165'>with</span>
  <span m='3043420'>this</span> <span m='3043630'>log</span> <span m='3043930'>n.</span>
  <span m='3044830'>And</span> <span m='3044950'>so</span> <span m='3045130'>we</span>
  <span m='3045250'>get</span> <span m='3047350'>n</span> <span m='3047830'>over</span>
  <span m='3049030'>log</span> <span m='3049360'>log</span> <span m='3049810'>n</span>
  <span m='3051370'>bits,</span> <span m='3052970'>which</span> <span m='3053080'>is</span>
  <span m='3053440'>slightly</span> <span m='3054490'>little</span> <span m='3054860'>of
  of</span> <span m='3054990'>n.</span> </p><p><span m='3056470'>OK.</span> <span
  m='3057750'>Again,</span> <span m='3058090'>it</span> <span m='3058180'>is</span>
  <span m='3058330'>possible</span> <span m='3058840'>to</span> <span m='3058990'>get</span>
  <span m='3059200'>n</span> <span m='3059350'>over</span> <span m='3059695'>log</span>
  <span m='3060040'>to</span> <span m='3060160'>the</span> <span m='3060280'>k</span>
  <span m='3060530'>space.</span> <span m='3061750'>But</span> <span m='3061900'>we</span>
  <span m='3062020'>won't</span> <span m='3062200'>do</span> <span m='3062290'>that</span>
  <span m='3062440'>here.</span> <span m='3063170'>We'll</span> <span m='3063280'>be</span>
  <span m='3063400'>happy</span> <span m='3063730'>enough</span> <span m='3064000'>with</span>
  <span m='3064330'>n</span> <span m='3064480'>over</span> <span m='3064630'>log</span>
  <span m='3064870'>log</span> <span m='3065050'>n.</span> </p><p><span m='3067150'>OK.</span>
  <span m='3067390'>But</span> <span m='3067510'>we're</span> <span m='3067630'>not</span>
  <span m='3067900'>done,</span> <span m='3068230'>unfortunately.</span> <span m='3069040'>So</span>
  <span m='3069250'>we've</span> <span m='3069430'>now</span> <span m='3070300'>reduced</span>
  <span m='3070720'>in two</span> <span m='3071140'>groups,</span> <span m='3072340'>and</span>
  <span m='3072470'>I've</span> <span m='3072580'>only</span> <span m='3072730'>given</span>
  <span m='3072970'>you</span> <span m='3073060'>one</span> <span m='3073300'>case.</span>
  <span m='3073760'>This</span> <span m='3073960'>is</span> <span m='3074080'>when</span>
  <span m='3074410'>r</span> <span m='3074740'>is</span> <span m='3075070'>large.</span>
  </p><p><span m='3076165'>The</span> <span m='3076540'>other</span> <span m='3076690'>cases,</span>
  <span m='3077050'>r is</span> <span m='3077260'>small,</span> <span m='3077770'>meaning</span>
  <span m='3078100'>the</span> <span m='3078220'>number</span> <span m='3078520'>of</span>
  <span m='3078640'>bits</span> <span m='3079000'>in</span> <span m='3079090'>the</span>
  <span m='3079180'>group</span> <span m='3079540'>is</span> <span m='3079660'>at</span>
  <span m='3079780'>most</span> <span m='3080110'>log</span> <span m='3080470'>n</span>
  <span m='3080650'>log</span> <span m='3080920'>log</span> <span m='3081130'>n</span>
  <span m='3081310'>squared.</span> <span m='3082570'>That's</span> <span m='3082780'>a</span>
  <span m='3082840'>good</span> <span m='3083050'>case</span> <span m='3083290'>for</span>
  <span m='3083410'>us,</span> <span m='3083560'>because</span> <span m='3083720'>that's</span>
  <span m='3083980'>pretty</span> <span m='3084310'>similar</span> <span m='3084760'>to</span>
  <span m='3084880'>rank.</span> <span m='3085810'>Here</span> <span m='3085960'>we</span>
  <span m='3086080'>got</span> <span m='3086290'>chunks</span> <span m='3086610'>of</span>
  <span m='3086680'>size</span> <span m='3086920'>log</span> <span m='3087170'>squared.</span>
  <span m='3087500'>Here</span> <span m='3087620'>it's</span> <span m='3087760'>slightly</span>
  <span m='3088240'>larger</span> <span m='3088570'>than</span> <span m='3088720'>log</span>
  <span m='3088950'>squared,</span> <span m='3089320'>but</span> <span m='3089470'>only</span>
  <span m='3089740'>by</span> <span m='3089890'>a</span> <span m='3089950'>poly</span>
  <span m='3090250'>log</span> <span m='3090490'>log</span> <span m='3090730'>factor.</span>
  </p><p><span m='3092770'>And</span> <span m='3092950'>that</span> <span m='3093130'>would</span>
  <span m='3093280'>correspond</span> <span m='3093880'>to</span> <span m='3094930'>this</span>
  <span m='3095440'>step</span> <span m='3095830'>2</span> <span m='3096160'>in</span>
  <span m='3096350'>rank.</span> <span m='3097210'>You</span> <span m='3097270'>do</span>
  <span m='3097390'>step</span> <span m='3097660'>2</span> <span m='3097840'>and</span>
  <span m='3097960'>step</span> <span m='3098200'>3</span> <span m='3098470'>here.</span>
  <span m='3099440'>Then</span> <span m='3099670'>we</span> <span m='3099790'>get</span>
  <span m='3100030'>step</span> <span m='3100300'>2</span> <span m='3100570'>of</span>
  <span m='3100710'>rank.</span> <span m='3101110'>We've</span> <span m='3101260'>reduced</span>
  <span m='3101650'>to</span> <span m='3102430'>poly</span> <span m='3102790'>log</span>
  <span m='3103600'>size</span> <span m='3104020'>chunks</span> <span m='3105850'>by</span>
  <span m='3106000'>getting</span> <span m='3106240'>rid</span> <span m='3106390'>of</span>
  <span m='3106450'>this</span> <span m='3106630'>case.</span> </p><p><span m='3107810'>And</span>
  <span m='3107890'>so</span> <span m='3108250'>we</span> <span m='3108400'>have</span>
  <span m='3108550'>to</span> <span m='3108640'>do</span> <span m='3108790'>it</span>
  <span m='3108850'>again,</span> <span m='3109720'>because</span> <span m='3109930'>we</span>
  <span m='3110050'>have</span> <span m='3110230'>poly</span> <span m='3110555'>log</span>
  <span m='3110880'>size</span> <span m='3111250'>groups.</span> <span m='3112000'>But</span>
  <span m='3112120'>we</span> <span m='3112210'>need</span> <span m='3112360'>to</span>
  <span m='3112450'>get</span> <span m='3112630'>down</span> <span m='3112870'>to</span>
  <span m='3112960'>groups</span> <span m='3113290'>of</span> <span m='3113470'>size</span>
  <span m='3114430'>log,</span> <span m='3115540'>1/2</span> <span m='3115820'>log.</span>
  <span m='3117160'>So</span> <span m='3117370'>we</span> <span m='3117430'>need</span>
  <span m='3117640'>to</span> <span m='3118210'>do</span> <span m='3118480'>another</span>
  <span m='3118870'>layer</span> <span m='3119170'>of</span> <span m='3119260'>indirection.</span>
  </p><p></p><p><span m='3145740'>So</span> <span m='3145950'>we</span> <span m='3146070'>get</span>
  <span m='3146220'>to</span> <span m='3146310'>do</span> <span m='3146490'>steps</span>
  <span m='3146850'>2</span> <span m='3147060'>and</span> <span m='3147180'>3</span>
  <span m='3147630'>again.</span> <span m='3149310'>This</span> <span m='3149520'>is</span>
  <span m='3149670'>what</span> <span m='3149820'>I'll</span> <span m='3149940'>call</span>
  <span m='3150240'>step</span> <span m='3150550'>4.</span> <span m='3156330'>Repeat</span>
  <span m='3156780'>steps</span> <span m='3157200'>2</span> <span m='3157410'>and</span>
  <span m='3157530'>3</span> <span m='3161898'>on--</span> <span m='3162880'>oh,</span>
  <span m='3163080'>sorry.</span> <span m='3163410'>I</span> <span m='3163470'>didn't</span>
  <span m='3163680'>say</span> <span m='3164990'>I</span> <span m='3165450'>need an</span>
  <span m='3165840'>else</span> <span m='3166230'>clause.</span> <span m='3168150'>Else</span>
  <span m='3169530'>I'm</span> <span m='3169650'>going</span> <span m='3169770'>to</span>
  <span m='3169830'>call</span> <span m='3170220'>this</span> <span m='3170550'>bit</span>
  <span m='3170760'>vector</span> <span m='3171750'>a</span> <span m='3171810'>reduced</span>
  <span m='3172380'>bit</span> <span m='3172560'>vector.</span> <span m='3176640'>So</span>
  <span m='3176760'>I've</span> <span m='3176880'>reduced</span> <span m='3177360'>to</span>
  <span m='3178470'>order</span> <span m='3180000'>log</span> <span m='3180360'>n</span>
  <span m='3181830'>log</span> <span m='3182160'>log</span> <span m='3182400'>n</span>
  <span m='3182580'>squared</span> <span m='3183090'>bits.</span> </p><p><span m='3189510'>And</span>
  <span m='3189630'>so</span> <span m='3189880'>step</span> <span m='3190140'>4</span>
  <span m='3191070'>is</span> <span m='3191370'>on</span> <span m='3192630'>all</span>
  <span m='3193050'>reduced</span> <span m='3193590'>strings,</span> <span m='3195200'>all</span>
  <span m='3195390'>reduced</span> <span m='3195840'>bit</span> <span m='3196020'>strings.</span>
  <span m='3202310'>I</span> <span m='3202440'>want</span> <span m='3202620'>to</span>
  <span m='3202680'>do</span> <span m='3202830'>steps</span> <span m='3203130'>2</span>
  <span m='3203310'>and</span> <span m='3203430'>3</span> <span m='3203640'>again.</span>
  <span m='3205440'>Let</span> <span m='3205590'>me</span> <span m='3205710'>do</span>
  <span m='3205860'>it</span> <span m='3205980'>quickly.</span> <span m='3209250'>My</span>
  <span m='3209400'>goal</span> <span m='3209790'>is</span> <span m='3210030'>to</span>
  <span m='3210300'>further</span> <span m='3210690'>reduce</span> <span m='3214810'>to</span>
  <span m='3223440'>poly</span> <span m='3223960'>log</span> <span m='3224320'>log</span>
  <span m='3224590'>n.</span> <span m='3225760'>I</span> <span m='3225940'>took</span>
  <span m='3226150'>n</span> <span m='3226300'>bit</span> <span m='3226480'>strings</span>
  <span m='3226840'>and</span> <span m='3226930'>I</span> <span m='3226990'>got</span>
  <span m='3227200'>down</span> <span m='3227410'>to</span> <span m='3227500'>log</span>
  <span m='3228000'>poly</span> <span m='3228310'>log</span> <span m='3228640'>bits.</span>
  </p><p><span m='3229510'>I</span> <span m='3229570'>do</span> <span m='3229690'>it</span>
  <span m='3229780'>again,</span> <span m='3230200'>I</span> <span m='3230290'>should</span>
  <span m='3230470'>get</span> <span m='3230620'>down</span> <span m='3230830'>to</span>
  <span m='3231130'>poly</span> <span m='3231280'>log</span> <span m='3231550'>log</span>
  <span m='3231790'>bits.</span> <span m='3232240'>And</span> <span m='3232330'>indeed,</span>
  <span m='3232600'>I</span> <span m='3232690'>can.</span> <span m='3233050'>And</span>
  <span m='3233170'>this</span> <span m='3233380'>is</span> <span m='3233500'>plenty</span>
  <span m='3233980'>small.</span> <span m='3234670'>Poly</span> <span m='3235000'>log</span>
  <span m='3235270'>log</span> <span m='3235870'>is</span> <span m='3235990'>way</span>
  <span m='3236140'>smaller</span> <span m='3236500'>than</span> <span m='3236680'>1/2</span>
  <span m='3236920'>log,</span> <span m='3237910'>so</span> <span m='3238120'>we</span>
  <span m='3238180'>don't</span> <span m='3238480'>even</span> <span m='3238750'>need</span>
  <span m='3239230'>that</span> <span m='3239380'>much</span> <span m='3239590'>of</span>
  <span m='3239650'>the</span> <span m='3239740'>lookup</span> <span m='3240010'>table.</span>
  </p><p><span m='3242710'>Fine.</span> <span m='3243340'>So</span> <span m='3243785'>I'll
  call</span> <span m='3244230'>this</span> <span m='3244480'>2</span> <span m='3244940'>prime.</span>
  <span m='3251110'>I</span> <span m='3251410'>want</span> <span m='3251560'>to</span>
  <span m='3251650'>make</span> <span m='3251830'>this</span> <span m='3251980'>explicit,</span>
  <span m='3252520'>because</span> <span m='3252820'>they</span> <span m='3252940'>are</span>
  <span m='3253090'>slightly</span> <span m='3253660'>different,</span> <span m='3254500'>because</span>
  <span m='3254710'>now</span> <span m='3254920'>everything's</span> <span m='3255310'>relative</span>
  <span m='3256090'>to</span> <span m='3257920'>the</span> <span m='3258160'>reduced</span>
  <span m='3258610'>string,</span> <span m='3259090'>which</span> <span m='3259300'>is</span>
  <span m='3259420'>poly log.</span> </p><p></p><p><span m='3277710'>This gets</span>
  <span m='3277920'>hard</span> <span m='3278070'>to</span> <span m='3278160'>pronounce,</span>
  <span m='3278580'>but</span> <span m='3278760'>every</span> <span m='3279150'>log</span>
  <span m='3279540'>log</span> <span m='3280050'>n</span> <span m='3280410'>square-th</span>
  <span m='3281610'>1</span> <span m='3281910'>bit,</span> <span m='3282750'>we're</span>
  <span m='3282870'>going</span> <span m='3282970'>to</span> <span m='3283080'>write</span>
  <span m='3283290'>down</span> <span m='3283530'>the</span> <span m='3283620'>relative</span>
  <span m='3284160'>index</span> <span m='3284710'>within</span> <span m='3285480'>the</span>
  <span m='3285690'>reduced</span> <span m='3286080'>string</span> <span m='3286500'>of</span>
  <span m='3286590'>size</span> <span m='3287090'>log</span> <span m='3287520'>n.</span>
  <span m='3288090'>So</span> <span m='3288240'>writing</span> <span m='3288600'>down</span>
  <span m='3288780'>the</span> <span m='3288870'>relative</span> <span m='3289320'>index</span>
  <span m='3289890'>only</span> <span m='3290310'>costs</span> <span m='3291600'>log</span>
  <span m='3291930'>log</span> <span m='3292170'>n</span> <span m='3292410'>bits,</span>
  <span m='3294810'>because</span> <span m='3295140'>we're</span> <span m='3295290'>in</span>
  <span m='3295530'>something</span> <span m='3295860'>of</span> <span m='3295950'>size</span>
  <span m='3296240'>log</span> <span m='3296440'>n,</span> <span m='3296790'>so writing</span>
  <span m='3297240'>down</span> <span m='3297330'>that</span> <span m='3297450'>index</span>
  <span m='3297810'>is</span> <span m='3297900'>short.</span> <span m='3299340'>We</span>
  <span m='3299490'>write</span> <span m='3299730'>it</span> <span m='3299820'>down</span>
  <span m='3300270'>for</span> <span m='3300420'>all</span> <span m='3300630'>of</span>
  <span m='3300690'>these,</span> <span m='3301150'>so</span> <span m='3301560'>we</span>
  <span m='3301710'>end</span> <span m='3301860'>up</span> <span m='3301980'>paying</span>
  <span m='3303930'>n</span> <span m='3305850'>over</span> <span m='3306210'>log</span>
  <span m='3306600'>log</span> <span m='3306960'>n</span> <span m='3307230'>squared.</span>
  <span m='3308910'>That's</span> <span m='3309120'>the</span> <span m='3309240'>maximum</span>
  <span m='3309780'>number</span> <span m='3310140'>of</span> <span m='3310260'>these</span>
  <span m='3310470'>indices</span> <span m='3310920'>that</span> <span m='3311040'>we</span>
  <span m='3311130'>need</span> <span m='3311280'>to</span> <span m='3311400'>store.</span>
  <span m='3312240'>Each</span> <span m='3312480'>of</span> <span m='3312540'>them</span>
  <span m='3313080'>we</span> <span m='3313230'>pay</span> <span m='3313440'>log</span>
  <span m='3313770'>log n.</span> </p><p><span m='3314340'>So</span> <span m='3314460'>here</span>
  <span m='3314670'>I'm</span> <span m='3314970'>summing</span> <span m='3315690'>over</span>
  <span m='3316140'>all</span> <span m='3316440'>the</span> <span m='3316530'>reduced</span>
  <span m='3316860'>bit</span> <span m='3317040'>strings.</span> <span m='3317400'>This</span>
  <span m='3317550'>is</span> <span m='3317670'>an</span> <span m='3317760'>overall</span>
  <span m='3318210'>size.</span> <span m='3319140'>It's</span> <span m='3319530'>at</span>
  <span m='3319620'>most</span> <span m='3319920'>n</span> <span m='3320070'>over</span>
  <span m='3320250'>log</span> <span m='3320520'>log n</span> <span m='3320730'>squared</span>
  <span m='3321000'>that</span> <span m='3321120'>we</span> <span m='3321240'>need</span>
  <span m='3321360'>to</span> <span m='3321480'>store.</span> <span m='3321810'>Could</span>
  <span m='3321960'>be</span> <span m='3322110'>fewer</span> <span m='3322530'>if</span>
  <span m='3322680'>there</span> <span m='3322800'>aren't</span> <span m='3322920'>many</span>
  <span m='3323130'>reduced</span> <span m='3323430'>bit</span> <span m='3323580'>strings.</span>
  <span m='3324200'>But</span> <span m='3324960'>worst</span> <span m='3325140'>case,</span>
  <span m='3325380'>everything</span> <span m='3325920'>ends</span> <span m='3326130'>up</span>
  <span m='3326220'>being</span> <span m='3326430'>reduced,</span> <span m='3327880'>so</span>
  <span m='3327930'>we</span> <span m='3328020'>have</span> <span m='3328110'>this</span>
  <span m='3328380'>many</span> <span m='3328710'>times</span> <span m='3329040'>that</span>
  <span m='3329190'>many</span> <span m='3329700'>times</span> <span m='3329940'>that</span>
  <span m='3330030'>many</span> <span m='3330210'>bits.</span> <span m='3331270'>And</span>
  <span m='3331380'>we</span> <span m='3331470'>get</span> <span m='3331740'>n</span>
  <span m='3331910'>over</span> <span m='3332100'>log</span> <span m='3332340'>log</span>
  <span m='3332550'>n</span> <span m='3332730'>bits.</span> </p><p><span m='3337620'>This</span>
  <span m='3337860'>is</span> <span m='3338010'>roughly</span> <span m='3338670'>following</span>
  <span m='3339210'>the</span> <span m='3339300'>pattern</span> <span m='3339780'>of</span>
  <span m='3339960'>step</span> <span m='3340260'>2</span> <span m='3340500'>over</span>
  <span m='3340680'>here.</span> <span m='3341490'>Step</span> <span m='3341730'>2</span>
  <span m='3341910'>over</span> <span m='3342090'>here</span> <span m='3342930'>didn't</span>
  <span m='3343140'>just</span> <span m='3343350'>have</span> <span m='3343530'>the</span>
  <span m='3343620'>log</span> <span m='3343920'>term.</span> <span m='3344060'>It</span>
  <span m='3344220'>also</span> <span m='3344490'>had</span> <span m='3344670'>an</span>
  <span m='3345150'>auxiliary</span> <span m='3345660'>log</span> <span m='3345930'>log</span>
  <span m='3346140'>term.</span> <span m='3347020'>So</span> <span m='3347070'>if</span>
  <span m='3347160'>you</span> <span m='3347370'>felt</span> <span m='3347640'>like</span>
  <span m='3347910'>it,</span> <span m='3348090'>you</span> <span m='3348270'>could</span>
  <span m='3348480'>make</span> <span m='3348660'>this</span> <span m='3348840'>log</span>
  <span m='3349140'>log n</span> <span m='3349380'>times</span> <span m='3349950'>log</span>
  <span m='3350250'>log</span> <span m='3350580'>log</span> <span m='3350910'>n.</span>
  <span m='3351660'>But</span> <span m='3351840'>it</span> <span m='3351930'>will</span>
  <span m='3352050'>actually</span> <span m='3352260'>give</span> <span m='3352410'>you</span>
  <span m='3352530'>worse</span> <span m='3352800'>space</span> <span m='3353220'>bound,</span>
  <span m='3353470'>so</span> <span m='3353610'>this</span> <span m='3353790'>is</span>
  <span m='3353850'>slightly</span> <span m='3354180'>better.</span> </p><p><span
  m='3357240'>OK.</span> <span m='3357450'>Then</span> <span m='3357660'>we</span>
  <span m='3357810'>apply</span> <span m='3358200'>step</span> <span m='3358530'>3</span>
  <span m='3358770'>prime,</span> <span m='3360610'>which</span> <span m='3360750'>is</span>
  <span m='3360930'>we</span> <span m='3361500'>look</span> <span m='3361800'>at</span>
  <span m='3361890'>each</span> <span m='3362070'>of</span> <span m='3362130'>the</span>
  <span m='3362250'>groups</span> <span m='3362580'>that</span> <span m='3362730'>we've</span>
  <span m='3363330'>identified.</span> <span m='3364440'>And</span> <span m='3364620'>either</span>
  <span m='3364950'>it's</span> <span m='3366270'>big</span> <span m='3366510'>and</span>
  <span m='3366600'>it</span> <span m='3366660'>has</span> <span m='3366840'>lots</span>
  <span m='3367050'>of</span> <span m='3367110'>0</span> <span m='3367350'>bits,</span>
  <span m='3368100'>or</span> <span m='3368220'>it's</span> <span m='3368340'>not</span>
  <span m='3368550'>big.</span> <span m='3369960'>And</span> <span m='3370200'>in</span>
  <span m='3370320'>either</span> <span m='3370530'>case,</span> <span m='3370800'>we're</span>
  <span m='3370890'>going</span> <span m='3371050'>to</span> <span m='3371100'>be</span>
  <span m='3371220'>happy.</span> </p><p><span m='3375220'>So if</span> <span m='3375570'>a</span>
  <span m='3375630'>group</span> <span m='3379310'>of</span> <span m='3381450'>log</span>
  <span m='3381900'>log</span> <span m='3382350'>n</span> <span m='3383760'>squared</span>
  <span m='3384420'>1</span> <span m='3384840'>bits</span> <span m='3386700'>has</span>
  <span m='3388050'>r</span> <span m='3388350'>bits,</span> <span m='3389480'>we</span>
  <span m='3389860'>look</span> <span m='3390000'>at</span> <span m='3390090'>each</span>
  <span m='3390240'>of</span> <span m='3390300'>them</span> <span m='3390450'>individually.</span>
  <span m='3392020'>And</span> <span m='3392460'>if</span> <span m='3393330'>r</span>
  <span m='3393720'>is</span> <span m='3393900'>at</span> <span m='3393990'>least</span>
  <span m='3394560'>the</span> <span m='3394680'>square</span> <span m='3395070'>of</span>
  <span m='3395160'>that,</span> <span m='3395490'>so</span> <span m='3395730'>log</span>
  <span m='3396090'>log</span> <span m='3396340'>n</span> <span m='3396480'>to</span>
  <span m='3396600'>the</span> <span m='3396720'>fourth</span> <span m='3397350'>power--</span>
  <span m='3399320'>so</span> <span m='3399600'>we're</span> <span m='3399750'>losing</span>
  <span m='3400110'>constants</span> <span m='3400530'>in</span> <span m='3400620'>the</span>
  <span m='3400740'>exponents,</span> <span m='3401280'>but</span> <span m='3401430'>it's</span>
  <span m='3401520'>not</span> <span m='3401700'>a</span> <span m='3401760'>big</span>
  <span m='3401940'>deal--</span> <span m='3403650'>then</span> <span m='3406530'>store</span>
  <span m='3409800'>relative--</span> <span m='3412830'>I</span> <span m='3412890'>mean,</span>
  <span m='3413030'>store all the</span> <span m='3413430'>answers,</span> <span m='3413970'>but</span>
  <span m='3414150'>now</span> <span m='3414420'>as</span> <span m='3414570'>relative</span>
  <span m='3414990'>indices.</span> </p><p><span m='3421530'>OK.</span> <span m='3422030'>Let's</span>
  <span m='3422370'>go</span> <span m='3422510'>over</span> <span m='3422720'>here.</span>
  <span m='3433770'>So</span> <span m='3433980'>how</span> <span m='3434190'>much</span>
  <span m='3434470'>do</span> <span m='3434590'>these</span> <span m='3434790'>relative</span>
  <span m='3435300'>indices</span> <span m='3435750'>cost?</span> <span m='3436320'>Again,</span>
  <span m='3436770'>it's</span> <span m='3437250'>at</span> <span m='3437520'>most</span>
  <span m='3437820'>order</span> <span m='3438090'>log</span> <span m='3438360'>log</span>
  <span m='3438540'>n</span> <span m='3438670'>bits</span> <span m='3444970'>to</span>
  <span m='3445290'>write</span> <span m='3445530'>them</span> <span m='3445680'>down.</span>
  <span m='3447060'>We</span> <span m='3447210'>don't</span> <span m='3447450'>know</span>
  <span m='3447690'>that</span> <span m='3447810'>a</span> <span m='3447870'>group</span>
  <span m='3448110'>is</span> <span m='3448230'>any</span> <span m='3448410'>smaller</span>
  <span m='3449070'>than</span> <span m='3449360'>log</span> <span m='3449600'>n,</span>
  <span m='3449880'>but</span> <span m='3450030'>it's</span> <span m='3450150'>at</span>
  <span m='3450250'>most</span> <span m='3450550'>the</span> <span m='3450600'>original</span>
  <span m='3450900'>size</span> <span m='3451170'>of</span> <span m='3451380'>log
  n.</span> <span m='3452140'>It's only</span> <span m='3452480'>log</span> <span
  m='3452610'>log</span> <span m='3452970'>n</span> <span m='3453090'>bits</span>
  <span m='3453270'>to</span> <span m='3453390'>write</span> <span m='3453570'>each</span>
  <span m='3453810'>of</span> <span m='3453870'>them</span> <span m='3454020'>down.</span>
  </p><p><span m='3454950'>And</span> <span m='3455070'>now</span> <span m='3455370'>we</span>
  <span m='3455490'>get</span> <span m='3455670'>to</span> <span m='3455790'>say,</span>
  <span m='3456060'>oh,</span> <span m='3456330'>well,</span> <span m='3456450'>we</span>
  <span m='3456600'>had</span> <span m='3456720'>to</span> <span m='3456810'>write</span>
  <span m='3456990'>down</span> <span m='3457300'>log</span> <span m='3457680'>log
  n</span> <span m='3457920'>squared</span> <span m='3458240'>1</span> <span m='3458450'>bits.</span>
  <span m='3458700'>But</span> <span m='3458850'>this</span> <span m='3459000'>can</span>
  <span m='3459150'>only</span> <span m='3459360'>happen</span> <span m='3459750'>n</span>
  <span m='3459900'>over</span> <span m='3460110'>log</span> <span m='3460350'>log</span>
  <span m='3460560'>n</span> <span m='3460690'>to</span> <span m='3460770'>the</span>
  <span m='3460860'>fourth</span> <span m='3461700'>many</span> <span m='3461910'>times.</span>
  <span m='3463110'>So</span> <span m='3463610'>the</span> <span m='3463740'>space</span>
  <span m='3464220'>is</span> <span m='3465530'>n</span> <span m='3465810'>over</span>
  <span m='3467060'>log</span> <span m='3467910'>log</span> <span m='3468210'>n</span>
  <span m='3468420'>to</span> <span m='3468570'>the</span> <span m='3468720'>fourth.</span>
  </p><p><span m='3469350'>That's</span> <span m='3470070'>the</span> <span m='3470190'>maximum</span>
  <span m='3470730'>number</span> <span m='3471090'>of</span> <span m='3471210'>these</span>
  <span m='3472500'>I</span> <span m='3472530'>guess</span> <span m='3472710'>you</span>
  <span m='3472800'>call</span> <span m='3472950'>them</span> <span m='3473130'>sparse</span>
  <span m='3474360'>bit</span> <span m='3474550'>vectors,</span> <span m='3475470'>sparse</span>
  <span m='3475920'>groups</span> <span m='3476460'>there</span> <span m='3476610'>could</span>
  <span m='3476760'>be,</span> <span m='3477720'>because</span> <span m='3477900'>each</span>
  <span m='3478080'>of</span> <span m='3478140'>them</span> <span m='3478290'>is</span>
  <span m='3478440'>at</span> <span m='3478530'>least</span> <span m='3478740'>this</span>
  <span m='3478890'>big.</span> <span m='3479340'>The total</span> <span m='3479610'>number</span>
  <span m='3479850'>of</span> <span m='3479910'>them</span> <span m='3480090'>is</span>
  <span m='3480180'>at</span> <span m='3480240'>most</span> <span m='3480450'>n</span>
  <span m='3480600'>divided</span> <span m='3480930'>by</span> <span m='3481110'>that.</span>
  <span m='3481790'>For</span> <span m='3481930'>each</span> <span m='3482120'>of</span>
  <span m='3482240'>them,</span> <span m='3482400'>we</span> <span m='3482490'>have</span>
  <span m='3482670'>to</span> <span m='3482790'>write</span> <span m='3483030'>down</span>
  <span m='3483420'>log</span> <span m='3483720'>log</span> <span m='3484050'>n</span>
  <span m='3484440'>squared</span> <span m='3485820'>different</span> <span m='3486120'>indices</span>
  <span m='3487110'>for</span> <span m='3487290'>our</span> <span m='3487500'>array.</span>
  <span m='3488370'>And</span> <span m='3488460'>each</span> <span m='3488640'>of</span>
  <span m='3488700'>those</span> <span m='3488880'>indices</span> <span m='3489330'>cost</span>
  <span m='3489810'>log</span> <span m='3490080'>log</span> <span m='3490320'>n</span>
  <span m='3490470'>bits</span> <span m='3490740'>to</span> <span m='3490860'>write</span>
  <span m='3491070'>down.</span> </p><p><span m='3492720'>So</span> <span m='3492990'>this</span>
  <span m='3493230'>is</span> <span m='3494560'>log log</span> <span m='3494760'>n</span>
  <span m='3494940'>to</span> <span m='3495030'>the</span> <span m='3495090'>third</span>
  <span m='3495310'>power.</span> <span m='3495720'>This is</span> <span m='3495900'>log</span>
  <span m='3496080'>log n</span> <span m='3496320'>to</span> <span m='3496410'>the</span>
  <span m='3496530'>fourth</span> <span m='3496770'>power.</span> <span m='3497680'>So</span>
  <span m='3497730'>again,</span> <span m='3498190'>this</span> <span m='3498270'>is</span>
  <span m='3498420'>n</span> <span m='3498660'>over</span> <span m='3498850'>log</span>
  <span m='3499140'>log</span> <span m='3499410'>n.</span> <span m='3499950'>You</span>
  <span m='3500040'>can</span> <span m='3500190'>tell</span> <span m='3500490'>I've</span>
  <span m='3500970'>tuned</span> <span m='3501330'>all</span> <span m='3501510'>of</span>
  <span m='3501600'>these</span> <span m='3501810'>numbers</span> <span m='3502230'>to</span>
  <span m='3502560'>come</span> <span m='3502770'>out</span> <span m='3502980'>to</span>
  <span m='3503580'>n</span> <span m='3503760'>over</span> <span m='3504070'>log log
  n</span> <span m='3504540'>bits.</span> </p><p><span m='3508700'>OK.</span> <span
  m='3511050'>That</span> <span m='3511290'>was</span> <span m='3511470'>the</span>
  <span m='3511650'>if</span> <span m='3511880'>case.</span> <span m='3512230'>There's</span>
  <span m='3512460'>the</span> <span m='3512670'>else</span> <span m='3512940'>case,</span>
  <span m='3513970'>which</span> <span m='3514080'>is</span> <span m='3514200'>that</span>
  <span m='3514350'>you</span> <span m='3514590'>have</span> <span m='3514830'>reduced</span>
  <span m='3515280'>to</span> <span m='3515840'>poly</span> <span m='3516030'>log</span>
  <span m='3516300'>log</span> <span m='3516540'>size,</span> <span m='3517050'>namely</span>
  <span m='3518000'>then</span> <span m='3518590'>in</span> <span m='3519230'>the</span>
  <span m='3519350'>dense</span> <span m='3519660'>case,</span> <span m='3520050'>you</span>
  <span m='3520170'>have</span> <span m='3521080'>r is</span> <span m='3521420'>at</span>
  <span m='3521520'>most</span> <span m='3521850'>log</span> <span m='3522120'>log</span>
  <span m='3522330'>n</span> <span m='3522430'>to</span> <span m='3522570'>the</span>
  <span m='3522690'>fourth.</span> <span m='3524070'>So</span> <span m='3524250'>at</span>
  <span m='3524340'>this</span> <span m='3524520'>point,</span> <span m='3526740'>else</span>
  <span m='3528150'>you</span> <span m='3528390'>are</span> <span m='3528840'>further</span>
  <span m='3529170'>reduced.</span> </p><p><span m='3535170'>When</span> <span m='3535340'>you're</span>
  <span m='3535440'>further</span> <span m='3535710'>reduced,</span> <span m='3536850'>you</span>
  <span m='3536970'>have</span> <span m='3537240'>at</span> <span m='3537300'>most</span>
  <span m='3539430'>log</span> <span m='3539760'>log</span> <span m='3540060'>n</span>
  <span m='3541330'>to</span> <span m='3541740'>the</span> <span m='3541860'>fourth</span>
  <span m='3542790'>bits.</span> <span m='3544230'>And</span> <span m='3544410'>at</span>
  <span m='3544470'>most,</span> <span m='3544710'>log</span> <span m='3544980'>log</span>
  <span m='3545150'>n</span> <span m='3545510'>squared</span> <span m='3545950'>of</span>
  <span m='3546060'>them</span> <span m='3546390'>are</span> <span m='3546540'>1</span>
  <span m='3546810'>bits.</span> <span m='3547230'>But</span> <span m='3547380'>we</span>
  <span m='3547470'>don't</span> <span m='3547590'>really</span> <span m='3547770'>care</span>
  <span m='3547980'>about</span> <span m='3548160'>that.</span> <span m='3548700'>Once</span>
  <span m='3548910'>we're</span> <span m='3549030'>down</span> <span m='3549270'>to</span>
  <span m='3549360'>a</span> <span m='3549420'>bit</span> <span m='3549570'>vector</span>
  <span m='3549870'>of</span> <span m='3550040'>poly</span> <span m='3550260'>log</span>
  <span m='3550500'>log</span> <span m='3550710'>size,</span> <span m='3551640'>we</span>
  <span m='3551760'>can</span> <span m='3551940'>use</span> <span m='3552660'>our</span>
  <span m='3552750'>lookup</span> <span m='3553050'>table</span> <span m='3554220'>and</span>
  <span m='3554340'>we're</span> <span m='3554430'>done.</span> </p><p><span m='3561140'>So</span>
  <span m='3561220'>that's</span> <span m='3561420'>select.</span> <span m='3562170'>If</span>
  <span m='3562350'>you</span> <span m='3562460'>want</span> <span m='3562600'>to</span>
  <span m='3562690'>do</span> <span m='3562840'>a</span> <span m='3562870'>select</span>
  <span m='3563320'>on</span> <span m='3563480'>an</span> <span m='3564280'>index,</span>
  <span m='3565420'>first</span> <span m='3565790'>you</span> <span m='3565870'>figure</span>
  <span m='3566230'>out</span> <span m='3567550'>which</span> <span m='3567910'>group</span>
  <span m='3568230'>it's</span> <span m='3568420'>in</span> <span m='3569080'>by</span>
  <span m='3569230'>dividing</span> <span m='3569680'>by</span> <span m='3569830'>log</span>
  <span m='3570130'>n</span> <span m='3570280'>log</span> <span m='3570490'>log</span>
  <span m='3570700'>n,</span> <span m='3570910'>taking</span> <span m='3571210'>the</span>
  <span m='3571300'>floor.</span> <span m='3572710'>You</span> <span m='3572890'>teleport</span>
  <span m='3573490'>to</span> <span m='3573610'>the</span> <span m='3573730'>appropriate</span>
  <span m='3574150'>group</span> <span m='3574450'>using</span> <span m='3574750'>this</span>
  <span m='3574900'>array.</span> <span m='3576100'>Then</span> <span m='3576850'>within</span>
  <span m='3577210'>that</span> <span m='3577360'>group,</span> <span m='3578590'>there's</span>
  <span m='3578830'>a</span> <span m='3578890'>bit</span> <span m='3579160'>saying</span>
  <span m='3579520'>whether</span> <span m='3579760'>it</span> <span m='3579850'>was</span>
  <span m='3579970'>sparse</span> <span m='3580420'>or</span> <span m='3580600'>dense.</span>
  <span m='3582430'>If</span> <span m='3582670'>it</span> <span m='3582820'>was</span>
  <span m='3583000'>sparse,</span> <span m='3584350'>so</span> <span m='3584770'>lots</span>
  <span m='3585130'>of</span> <span m='3585190'>0's</span> <span m='3585580'>in</span>
  <span m='3585700'>it,</span> <span m='3586270'>then</span> <span m='3586600'>you</span>
  <span m='3586810'>have</span> <span m='3587050'>a</span> <span m='3587110'>lookup</span>
  <span m='3587380'>table</span> <span m='3587650'>that</span> <span m='3587740'>gives</span>
  <span m='3587890'>you</span> <span m='3588010'>all</span> <span m='3588130'>your</span>
  <span m='3588280'>answers</span> <span m='3589690'>for</span> <span m='3589810'>the</span>
  <span m='3589900'>remainder</span> <span m='3590350'>of</span> <span m='3590440'>your</span>
  <span m='3591310'>query.</span> </p><p><span m='3592610'>If</span> <span m='3592690'>it's</span>
  <span m='3592870'>dense,</span> <span m='3593770'>then</span> <span m='3594250'>you</span>
  <span m='3594400'>go</span> <span m='3594610'>over</span> <span m='3594820'>here.</span>
  <span m='3596050'>You</span> <span m='3596170'>know that</span> <span m='3596420'>this</span>
  <span m='3596740'>thing</span> <span m='3596980'>will</span> <span m='3597160'>be</span>
  <span m='3597280'>stored,</span> <span m='3598210'>and</span> <span m='3598330'>so</span>
  <span m='3598780'>you</span> <span m='3598990'>figure</span> <span m='3599290'>out</span>
  <span m='3599410'>which</span> <span m='3600190'>subgroup</span> <span m='3600730'>you</span>
  <span m='3600850'>belong</span> <span m='3601210'>to</span> <span m='3601460'>by</span>
  <span m='3601810'>dividing</span> <span m='3602410'>by</span> <span m='3602830'>log</span>
  <span m='3603190'>log</span> <span m='3603490'>n</span> <span m='3603760'>squared,</span>
  <span m='3604970'>taking</span> <span m='3605170'>the</span> <span m='3605260'>floor.</span>
  <span m='3606670'>There's</span> <span m='3606940'>an</span> <span m='3607030'>array,</span>
  <span m='3607980'>this</span> <span m='3608200'>thing,</span> <span m='3609160'>that</span>
  <span m='3609760'>teleports</span> <span m='3610390'>you</span> <span m='3610510'>to</span>
  <span m='3610810'>that</span> <span m='3611860'>group--</span> <span m='3613390'>sorry,
  to</span> <span m='3613630'>that</span> <span m='3613840'>subgroup.</span> </p><p><span
  m='3615340'>And</span> <span m='3615520'>then</span> <span m='3616450'>you</span>
  <span m='3616570'>apply--</span> <span m='3618370'>then</span> <span m='3618580'>there's</span>
  <span m='3618760'>a</span> <span m='3618820'>bit</span> <span m='3619030'>there</span>
  <span m='3619270'>saying</span> <span m='3619570'>whether</span> <span m='3619720'>it</span>
  <span m='3619780'>was</span> <span m='3619870'>sparse</span> <span m='3620200'>or</span>
  <span m='3620270'>dense.</span> <span m='3620750'>If it was</span> <span m='3621160'>sparse,</span>
  <span m='3621770'>there's</span> <span m='3621850'>a</span> <span m='3621880'>lookup</span>
  <span m='3622180'>table</span> <span m='3622480'>giving</span> <span m='3622750'>you</span>
  <span m='3622840'>the</span> <span m='3622960'>answer.</span> <span m='3623590'>If</span>
  <span m='3623790'>it</span> <span m='3623900'>was</span> <span m='3624040'>dense,</span>
  <span m='3624940'>there's</span> <span m='3625240'>an</span> <span m='3625390'>index</span>
  <span m='3625990'>into</span> <span m='3627040'>the</span> <span m='3627130'>number</span>
  <span m='3627400'>1</span> <span m='3627670'>lookup</span> <span m='3627970'>table</span>
  <span m='3629110'>that</span> <span m='3629230'>tells</span> <span m='3629590'>you</span>
  <span m='3629770'>what</span> <span m='3630010'>this</span> <span m='3630190'>bit</span>
  <span m='3630340'>string</span> <span m='3630670'>is,</span> <span m='3631650'>because</span>
  <span m='3631890'>there</span> <span m='3632130'>is</span> <span m='3632320'>only</span>
  <span m='3632620'>log</span> <span m='3632900'>log</span> <span m='3633070'>n</span>
  <span m='3633190'>to</span> <span m='3633250'>the</span> <span m='3633340'>fourth</span>
  <span m='3633640'>bits.</span> <span m='3635300'>In</span> <span m='3635410'>fact,</span>
  <span m='3635620'>that</span> <span m='3635800'>is</span> <span m='3635980'>the</span>
  <span m='3636100'>index.</span> <span m='3637000'>Just</span> <span m='3637150'>what</span>
  <span m='3637360'>those</span> <span m='3637570'>bits</span> <span m='3637810'>are</span>
  <span m='3638080'>lets</span> <span m='3638350'>you</span> <span m='3638860'>look</span>
  <span m='3639100'>up</span> <span m='3639220'>into</span> <span m='3639430'>this</span>
  <span m='3639580'>table</span> <span m='3640120'>and</span> <span m='3640270'>solve</span>
  <span m='3640510'>your</span> <span m='3640630'>query</span> <span m='3640870'>in</span>
  <span m='3641010'>constant</span> <span m='3641290'>time,</span> <span m='3641830'>in</span>
  <span m='3641920'>all</span> <span m='3642070'>cases</span> <span m='3642490'>constant</span>
  <span m='3642840'>time.</span> <span m='3643320'>But</span> <span m='3643680'>here's</span>
  <span m='3643870'>a</span> <span m='3643930'>little</span> <span m='3644140'>bit</span>
  <span m='3644260'>more</span> <span m='3644500'>branching,</span> <span m='3646120'>depending</span>
  <span m='3646450'>on</span> <span m='3646520'>your</span> <span m='3646610'>situation.</span>
  </p><p><span m='3648120'>As</span> <span m='3648240'>I</span> <span m='3648320'>said,</span>
  <span m='3648520'>select</span> <span m='3648880'>is</span> <span m='3648970'>a</span>
  <span m='3649000'>little</span> <span m='3649180'>more</span> <span m='3649300'>complicated</span>
  <span m='3649840'>than</span> <span m='3649990'>rank.</span> <span m='3650310'>But</span>
  <span m='3650440'>in</span> <span m='3650530'>the</span> <span m='3650650'>end,</span>
  <span m='3651330'>constant</span> <span m='3651720'>time,</span> <span m='3652580'>little</span>
  <span m='3652900'>of of</span> <span m='3653050'>n</span> <span m='3653170'>space,</span>
  <span m='3653620'>n</span> <span m='3653770'>over</span> <span m='3653950'>log</span>
  <span m='3654190'>log</span> <span m='3654270'>n,</span> <span m='3654920'>which
  can</span> <span m='3655420'>again</span> <span m='3655690'>be</span> <span m='3655810'>improved</span>
  <span m='3657220'>by</span> <span m='3657580'>Patrascu,</span> <span m='3658390'>n</span>
  <span m='3658600'>over</span> <span m='3658870'>log</span> <span m='3659160'>to</span>
  <span m='3659350'>the</span> <span m='3659440'>k</span> <span m='3660440'>for</span>
  <span m='3660690'>any</span> <span m='3660910'>constant</span> <span m='3661010'>k.</span>
  <span m='3661300'>Question?</span> </p><p><span m='3661660'>AUDIENCE:</span> <span
  m='3661817'>Can</span> <span m='3661974'>you</span> <span m='3662131'>just</span>
  <span m='3662602'>quickly remind</span> <span m='3663073'>us how the</span> <span
  m='3664015'>2 and</span> <span m='3664486'>3</span> <span m='3665428'>changed</span>
  <span m='3665899'>[INAUDIBLE]?</span> </p><p><span m='3666850'>ERIK DEMAINE:</span>
  <span m='3666955'>OK.</span> <span m='3667060'>How</span> <span m='3667270'>did</span>
  <span m='3667390'>2</span> <span m='3667600'>and</span> <span m='3667690'>3</span>
  <span m='3667900'>change?</span> <span m='3668330'>You</span> <span m='3668440'>don't</span>
  <span m='3668620'>actually</span> <span m='3669250'>really</span> <span m='3669580'>need</span>
  <span m='3669730'>to</span> <span m='3669820'>change</span> <span m='3670120'>them.</span>
  <span m='3670300'>The</span> <span m='3670390'>big</span> <span m='3670600'>change</span>
  <span m='3670790'>is</span> <span m='3671080'>that</span> <span m='3671420'>you're</span>
  <span m='3671500'>storing</span> <span m='3671830'>only</span> <span m='3672010'>relative</span>
  <span m='3672460'>indices,</span> <span m='3672910'>not</span> <span m='3673660'>indices.</span>
  </p><p><span m='3675250'>So</span> <span m='3675550'>before,</span> <span m='3677140'>we
  were</span> <span m='3677320'>storing</span> <span m='3677650'>an</span> <span m='3677740'>array</span>
  <span m='3678160'>of</span> <span m='3678280'>indices</span> <span m='3678820'>of</span>
  <span m='3678970'>every</span> <span m='3679450'>log</span> <span m='3679780'>log</span>
  <span m='3680020'>nth</span> <span m='3680770'>1</span> <span m='3680950'>bit.</span>
  <span m='3681160'>These</span> <span m='3681370'>were</span> <span m='3682210'>global</span>
  <span m='3682900'>pointers.</span> <span m='3684130'>But</span> <span m='3684310'>now</span>
  <span m='3685000'>after</span> <span m='3685870'>2</span> <span m='3686050'>and</span>
  <span m='3686140'>3,</span> <span m='3686650'>we've</span> <span m='3686830'>reduced
  to</span> <span m='3687220'>something</span> <span m='3687520'>of</span> <span m='3687580'>size</span>
  <span m='3688000'>log</span> <span m='3688360'>n</span> <span m='3688720'>or</span>
  <span m='3688810'>poly</span> <span m='3689095'>log</span> <span m='3689380'>n.</span>
  <span m='3689920'>We</span> <span m='3690010'>need</span> <span m='3690160'>to</span>
  <span m='3690280'>exploit</span> <span m='3690670'>that</span> <span m='3690880'>here,</span>
  <span m='3691870'>so that</span> <span m='3692100'>we were</span> <span m='3692230'>only</span>
  <span m='3692470'>storing</span> <span m='3692740'>log</span> <span m='3692950'>log</span>
  <span m='3693130'>n</span> <span m='3693310'>bits.</span> <span m='3693520'>If we</span>
  <span m='3693640'>didn't</span> <span m='3693850'>do</span> <span m='3693970'>that,</span>
  <span m='3694210'>this</span> <span m='3694390'>would</span> <span m='3694480'>be</span>
  <span m='3694690'>order</span> <span m='3694900'>n</span> <span m='3695080'>bits</span>
  <span m='3695470'>and</span> <span m='3695560'>it would</span> <span m='3695650'>be</span>
  <span m='3695770'>too</span> <span m='3695950'>big.</span> </p><p><span m='3697330'>That's</span>
  <span m='3697630'>really</span> <span m='3697840'>the</span> <span m='3697930'>only</span>
  <span m='3698110'>thing</span> <span m='3698290'>you</span> <span m='3698380'>need</span>
  <span m='3698530'>to</span> <span m='3698620'>change.</span> <span m='3698980'>The</span>
  <span m='3699100'>other</span> <span m='3699250'>thing</span> <span m='3699460'>I</span>
  <span m='3699520'>changed</span> <span m='3699790'>was</span> <span m='3699940'>this</span>
  <span m='3700090'>value.</span> <span m='3701050'>If</span> <span m='3701200'>you</span>
  <span m='3701290'>follow</span> <span m='3701650'>that</span> <span m='3701860'>plan,</span>
  <span m='3702490'>it</span> <span m='3702610'>would</span> <span m='3702790'>be--</span>
  <span m='3707690'>it</span> <span m='3707930'>was</span> <span m='3708030'>also</span>
  <span m='3708310'>a</span> <span m='3708330'>square.</span> <span m='3710130'>So</span>
  <span m='3710310'>we</span> <span m='3710370'>did</span> <span m='3710520'>have</span>
  <span m='3710670'>to</span> <span m='3710760'>add</span> <span m='3710990'>a</span>
  <span m='3711030'>square</span> <span m='3711390'>here.</span> <span m='3711690'>You</span>
  <span m='3711810'>could</span> <span m='3711960'>also</span> <span m='3712200'>add</span>
  <span m='3712380'>a</span> <span m='3712440'>log</span> <span m='3712710'>log</span>
  <span m='3713010'>log</span> <span m='3713460'>n</span> <span m='3713820'>term</span>
  <span m='3714150'>here,</span> <span m='3714960'>but</span> <span m='3715080'>it</span>
  <span m='3715140'>won't</span> <span m='3715320'>matter.</span> <span m='3715680'>Basically</span>
  <span m='3716160'>you</span> <span m='3716520'>do</span> <span m='3716640'>something</span>
  <span m='3716970'>that</span> <span m='3717120'>works.</span> </p><p><span m='3719010'>The</span>
  <span m='3719160'>square</span> <span m='3719820'>was</span> <span m='3719970'>necessary</span>
  <span m='3720450'>to</span> <span m='3720540'>cancel</span> <span m='3720870'>out</span>
  <span m='3720990'>this</span> <span m='3721170'>guy,</span> <span m='3721380'>for</span>
  <span m='3721500'>example.</span> <span m='3722040'>If you</span> <span m='3722130'>didn't</span>
  <span m='3722280'>do</span> <span m='3722400'>the</span> <span m='3722520'>square--</span>
  <span m='3723250'>well,</span> <span m='3724000'>so</span> <span m='3724110'>instead</span>
  <span m='3724410'>of</span> <span m='3724530'>this,</span> <span m='3724770'>you</span>
  <span m='3724860'>could</span> <span m='3725010'>have</span> <span m='3725100'>done</span>
  <span m='3725280'>log</span> <span m='3725550'>log</span> <span m='3725730'>n</span>
  <span m='3725910'>times</span> <span m='3726390'>log</span> <span m='3726660'>log</span>
  <span m='3726870'>log</span> <span m='3727110'>n</span> <span m='3727260'>without</span>
  <span m='3727590'>the</span> <span m='3727680'>square.</span> <span m='3728610'>Then</span>
  <span m='3728820'>here</span> <span m='3729000'>you</span> <span m='3729150'>would</span>
  <span m='3729240'>have</span> <span m='3729330'>gotten</span> <span m='3729590'>n</span>
  <span m='3729780'>over</span> <span m='3730020'>log</span> <span m='3730290'>log</span>
  <span m='3730530'>log</span> <span m='3730800'>n.</span> <span m='3732300'>So</span>
  <span m='3732420'>you</span> <span m='3732540'>could</span> <span m='3732700'>have</span>
  <span m='3732810'>followed</span> <span m='3733140'>the</span> <span m='3733230'>same</span>
  <span m='3733470'>pattern.</span> <span m='3733800'>You'd</span> <span m='3733870'>just</span>
  <span m='3734010'>get</span> <span m='3734130'>a</span> <span m='3734190'>slightly</span>
  <span m='3734520'>worse</span> <span m='3734650'>space</span> <span m='3734970'>bound.</span>
  </p><p><span m='3735390'>I</span> <span m='3735510'>tuned</span> <span m='3735780'>it</span>
  <span m='3735900'>here.</span> <span m='3736500'>Here</span> <span m='3736770'>we</span>
  <span m='3736920'>needed--</span> <span m='3737880'>here</span> <span m='3738090'>we</span>
  <span m='3738210'>could</span> <span m='3738360'>not</span> <span m='3738600'>have</span>
  <span m='3738750'>afforded</span> <span m='3739170'>to</span> <span m='3739290'>go</span>
  <span m='3739380'>to</span> <span m='3739500'>log</span> <span m='3739740'>squared,</span>
  <span m='3740100'>if</span> <span m='3740250'>I</span> <span m='3740370'>recall</span>
  <span m='3740730'>correctly,</span> <span m='3741630'>though</span> <span m='3741720'>you</span>
  <span m='3741840'>can</span> <span m='3742050'>check</span> <span m='3742320'>that.</span>
  <span m='3744090'>Maybe</span> <span m='3744270'>it's</span> <span m='3744360'>a</span>
  <span m='3744390'>good</span> <span m='3744530'>pset</span> <span m='3744880'>question.</span>
  </p><p><span m='3747540'>There's</span> <span m='3747810'>lots</span> <span m='3748080'>of</span>
  <span m='3748140'>choices</span> <span m='3748500'>that</span> <span m='3748620'>work</span>
  <span m='3748890'>here.</span> <span m='3749340'>But</span> <span m='3749550'>this</span>
  <span m='3749730'>is</span> <span m='3749910'>the</span> <span m='3750060'>one</span>
  <span m='3750210'>I</span> <span m='3750270'>find</span> <span m='3750480'>the</span>
  <span m='3750570'>cleanest</span> <span m='3751060'>that</span> <span m='3751170'>gets</span>
  <span m='3751530'>a</span> <span m='3751590'>decent</span> <span m='3751920'>bound,</span>
  <span m='3752670'>not</span> <span m='3752850'>the</span> <span m='3752940'>best</span>
  <span m='3753120'>bound,</span> <span m='3753390'>but</span> <span m='3754800'>reasonable.</span>
  <span m='3755220'>Other</span> <span m='3755400'>questions?</span> </p><p><span
  m='3757140'>I</span> <span m='3757160'>think</span> <span m='3757260'>that's</span>
  <span m='3757470'>all</span> <span m='3757650'>that</span> <span m='3757820'>I</span>
  <span m='3757980'>changed.</span> <span m='3758770'>The</span> <span m='3759660'>sparsity</span>
  <span m='3760140'>definition</span> <span m='3760590'>was</span> <span m='3760740'>still</span>
  <span m='3760920'>a</span> <span m='3760980'>squared</span> <span m='3761940'>thing,</span>
  <span m='3762780'>so it was</span> <span m='3763080'>squared</span> <span m='3763620'>over</span>
  <span m='3763800'>here</span> <span m='3764730'>and</span> <span m='3764880'>it</span>
  <span m='3765000'>was</span> <span m='3765810'>squared</span> <span m='3766170'>over</span>
  <span m='3766350'>here.</span> <span m='3766520'>It's</span> <span m='3766620'>just</span>
  <span m='3766770'>the</span> <span m='3766860'>thing</span> <span m='3767040'>we
  were</span> <span m='3767190'>squaring</span> <span m='3767610'>was</span> <span
  m='3767700'>a</span> <span m='3767730'>little</span> <span m='3767940'>different.</span>
  </p><p><span m='3771540'>OK.</span> <span m='3774370'>One more</span> <span m='3774640'>thing</span>
  <span m='3774850'>I</span> <span m='3774910'>want</span> <span m='3775030'>to</span>
  <span m='3775120'>talk</span> <span m='3775390'>about.</span> <span m='3776900'>So</span>
  <span m='3780070'>at</span> <span m='3780220'>this</span> <span m='3780400'>point,</span>
  <span m='3781690'>we</span> <span m='3781840'>just</span> <span m='3782110'>finish</span>
  <span m='3782680'>this</span> <span m='3782920'>level</span> <span m='3783400'>order</span>
  <span m='3783700'>representation</span> <span m='3784690'>of</span> <span m='3784870'>binary</span>
  <span m='3785290'>tries,</span> <span m='3786690'>because</span> <span m='3786880'>we</span>
  <span m='3786970'>already</span> <span m='3787150'>saw</span> <span m='3787360'>left</span>
  <span m='3787600'>child,</span> <span m='3787840'>right</span> <span m='3788020'>child,</span>
  <span m='3788290'>and</span> <span m='3788380'>parent,</span> <span m='3789460'>reduced</span>
  <span m='3789850'>to</span> <span m='3790000'>rank</span> <span m='3790270'>and</span>
  <span m='3790360'>select.</span> <span m='3791250'>We</span> <span m='3791420'>just</span>
  <span m='3791590'>solved</span> <span m='3791830'>rank</span> <span m='3792040'>and</span>
  <span m='3792130'>select</span> <span m='3792490'>in</span> <span m='3792580'>little</span>
  <span m='3792820'>o of n</span> <span m='3793120'>bits,</span> <span m='3793670'>so</span>
  <span m='3793870'>at</span> <span m='3793930'>least</span> <span m='3794110'>statically</span>
  <span m='3797620'>we</span> <span m='3797800'>can</span> <span m='3797980'>do</span>
  <span m='3798670'>left</span> <span m='3798880'>child,</span> <span m='3799090'>right</span>
  <span m='3799240'>child,</span> <span m='3799480'>parent</span> <span m='3800320'>in</span>
  <span m='3800440'>a</span> <span m='3800500'>binary</span> <span m='3800830'>try</span>
  <span m='3801080'>now</span> <span m='3801310'>in</span> <span m='3801400'>constant</span>
  <span m='3801790'>time per</span> <span m='3802120'>operation,</span> <span m='3803680'>2n</span>
  <span m='3804160'>plus</span> <span m='3804400'>little</span> <span m='3804660'>o
  of n</span> <span m='3804940'>bits</span> <span m='3805180'>of</span> <span m='3805240'>space.</span>
  <span m='3805660'>The</span> <span m='3805750'>2n</span> <span m='3806050'>bits</span>
  <span m='3806290'>are</span> <span m='3806380'>to</span> <span m='3806470'>store</span>
  <span m='3806950'>those</span> <span m='3807220'>2n</span> <span m='3807490'>bits</span>
  <span m='3807730'>that</span> <span m='3807820'>we</span> <span m='3807940'>wrote</span>
  <span m='3808090'>down</span> <span m='3808270'>before.</span> <span m='3809410'>So</span>
  <span m='3809560'>that's</span> <span m='3811290'>succinct</span> <span m='3811960'>binary</span>
  <span m='3812380'>tries.</span> <span m='3813220'>Done.</span> </p><p><span m='3814960'>One</span>
  <span m='3815710'>mention,</span> <span m='3816340'>there</span> <span m='3816550'>are</span>
  <span m='3816640'>some</span> <span m='3816880'>dynamic</span> <span m='3817300'>versions.</span>
  <span m='3817900'>In</span> <span m='3818020'>particular,</span> <span m='3820560'>there</span>
  <span m='3820680'>are</span> <span m='3820720'>dynamic</span> <span m='3821140'>versions</span>
  <span m='3821440'>of</span> <span m='3821530'>rank</span> <span m='3821740'>and</span>
  <span m='3822120'>select.</span> <span m='3823180'>But</span> <span m='3823780'>the</span>
  <span m='3823900'>best</span> <span m='3824380'>versions</span> <span m='3824890'>that</span>
  <span m='3825010'>are</span> <span m='3825100'>known</span> <span m='3825370'>to</span>
  <span m='3825490'>do</span> <span m='3825610'>dynamic</span> <span m='3825905'>rank</span>
  <span m='3826200'>and</span> <span m='3826420'>select</span> <span m='3827920'>achieve</span>
  <span m='3828230'>something</span> <span m='3828550'>like</span> <span m='3829480'>log</span>
  <span m='3829840'>over</span> <span m='3830050'>log</span> <span m='3830350'>log</span>
  <span m='3832460'>time</span> <span m='3832690'>per</span> <span m='3832810'>operation,</span>
  <span m='3835030'>if</span> <span m='3835340'>you're</span> <span m='3835540'>interested</span>
  <span m='3835630'>in</span> <span m='3835930'>dynamic.</span> </p><p><span m='3842355'>So</span>
  <span m='3842850'>this</span> <span m='3843050'>is</span> <span m='3843140'>kind</span>
  <span m='3843350'>of</span> <span m='3843440'>annoying.</span> <span m='3843830'>If</span>
  <span m='3843950'>you</span> <span m='3844040'>want</span> <span m='3844160'>to</span>
  <span m='3844220'>go</span> <span m='3844330'>to</span> <span m='3844430'>dynamic,</span>
  <span m='3845020'>either</span> <span m='3845240'>you</span> <span m='3845330'>pay</span>
  <span m='3845540'>more</span> <span m='3845720'>time</span> <span m='3846230'>or</span>
  <span m='3846380'>you</span> <span m='3846470'>don't</span> <span m='3846680'>use</span>
  <span m='3846800'>rank and</span> <span m='3847100'>select.</span> <span m='3847570'>But</span>
  <span m='3847970'>I'm</span> <span m='3848150'>not</span> <span m='3848240'>going</span>
  <span m='3848360'>to</span> <span m='3848420'>worry</span> <span m='3848540'>too</span>
  <span m='3848660'>much</span> <span m='3848840'>about</span> <span m='3849050'>dynamic.</span>
  <span m='3850160'>Stick</span> <span m='3850400'>to</span> <span m='3850490'>rank</span>
  <span m='3850660'>and</span> <span m='3850820'>select.</span> </p><p><span m='3851060'>But</span>
  <span m='3851150'>there's</span> <span m='3851330'>one</span> <span m='3851480'>more</span>
  <span m='3851630'>thing</span> <span m='3851900'>on</span> <span m='3852020'>this</span>
  <span m='3852170'>list,</span> <span m='3852440'>which</span> <span m='3852710'>is</span>
  <span m='3854510'>a</span> <span m='3854660'>different</span> <span m='3855020'>way</span>
  <span m='3855260'>to</span> <span m='3855410'>do</span> <span m='3855700'>succinct</span>
  <span m='3856000'>binary</span> <span m='3856370'>tries.</span> <span m='3856820'>And</span>
  <span m='3856920'>this</span> <span m='3857090'>different</span> <span m='3857420'>way</span>
  <span m='3857710'>is</span> <span m='3857950'>going</span> <span m='3858080'>to</span>
  <span m='3858170'>be</span> <span m='3858320'>more</span> <span m='3858560'>powerful,</span>
  <span m='3859170'>more</span> <span m='3859250'>useful</span> <span m='3860450'>for</span>
  <span m='3860630'>things</span> <span m='3860870'>like</span> <span m='3861020'>suffix</span>
  <span m='3862070'>trees,</span> <span m='3862430'>which</span> <span m='3862610'>is</span>
  <span m='3862730'>what</span> <span m='3862850'>we're</span> <span m='3862930'>going</span>
  <span m='3863000'>to</span> <span m='3863090'>do</span> <span m='3863240'>next</span>
  <span m='3863480'>class.</span> <span m='3864180'>So</span> <span m='3864260'>I</span>
  <span m='3864320'>want</span> <span m='3864470'>to</span> <span m='3864530'>tell</span>
  <span m='3864710'>you</span> <span m='3864800'>a</span> <span m='3864830'>little</span>
  <span m='3865070'>bit</span> <span m='3865190'>about</span> <span m='3866930'>this.</span>
  </p><p><span m='3868250'>The</span> <span m='3868400'>level</span> <span m='3868670'>order</span>
  <span m='3868935'>representation</span> <span m='3869440'>is</span> <span m='3869510'>kind</span>
  <span m='3869690'>of</span> <span m='3869750'>like</span> <span m='3869900'>a</span>
  <span m='3869960'>warm-up.</span> <span m='3871040'>It</span> <span m='3871130'>motivates</span>
  <span m='3871640'>rank and</span> <span m='3871970'>select.</span> <span m='3873770'>But</span>
  <span m='3874670'>it</span> <span m='3874820'>does</span> <span m='3875000'>not</span>
  <span m='3875330'>let</span> <span m='3875540'>us</span> <span m='3875720'>do</span>
  <span m='3875960'>subtree</span> <span m='3876440'>size.</span> <span m='3876740'>Subtree</span>
  <span m='3877180'>size</span> <span m='3877610'>would</span> <span m='3877760'>be</span>
  <span m='3877910'>nice</span> <span m='3878180'>to</span> <span m='3878300'>do,</span>
  <span m='3878900'>because</span> <span m='3879250'>you</span> <span m='3879350'>care</span>
  <span m='3879530'>about</span> <span m='3879800'>how</span> <span m='3879950'>many</span>
  <span m='3880160'>matches</span> <span m='3880580'>you</span> <span m='3880820'>have</span>
  <span m='3881150'>after</span> <span m='3881390'>you</span> <span m='3881480'>do</span>
  <span m='3881600'>a</span> <span m='3881660'>search</span> <span m='3882000'>down</span>
  <span m='3882110'>a</span> <span m='3882190'>suffix</span> <span m='3882590'>tree.</span>
  </p><p><span m='3883790'>Level</span> <span m='3884060'>order</span> <span m='3884300'>just</span>
  <span m='3884510'>ain't</span> <span m='3884660'>going</span> <span m='3884750'>to</span>
  <span m='3884840'>cut</span> <span m='3885080'>it</span> <span m='3885170'>for</span>
  <span m='3885290'>that,</span> <span m='3886400'>so</span> <span m='3886580'>we're</span>
  <span m='3886640'>going</span> <span m='3886760'>to</span> <span m='3886850'>use</span>
  <span m='3887720'>different</span> <span m='3888050'>representation.</span> <span
  m='3889490'>We're</span> <span m='3889610'>still</span> <span m='3889850'>going</span>
  <span m='3889970'>to</span> <span m='3890030'>use</span> <span m='3890210'>rank</span>
  <span m='3890410'>and</span> <span m='3890510'>select</span> <span m='3890960'>a</span>
  <span m='3890990'>lot.</span> <span m='3894050'>And</span> <span m='3894370'>I'll</span>
  <span m='3894830'>generalize</span> <span m='3895430'>forms</span> <span m='3895700'>of</span>
  <span m='3895790'>rank</span> <span m='3895960'>and</span> <span m='3896060'>select.</span>
  <span m='3905600'>But</span> <span m='3905780'>it's</span> <span m='3905930'>going</span>
  <span m='3906050'>to</span> <span m='3906110'>be</span> <span m='3906230'>a</span>
  <span m='3906260'>little</span> <span m='3906530'>bit</span> <span m='3906710'>more</span>
  <span m='3906920'>handy.</span> </p><p><span m='3907460'>Essentially</span> <span
  m='3907940'>I</span> <span m='3908060'>want</span> <span m='3908330'>to</span> <span
  m='3908390'>do</span> <span m='3909380'>more</span> <span m='3909620'>like</span>
  <span m='3909830'>a</span> <span m='3909890'>depth-first</span> <span m='3910370'>search</span>
  <span m='3910670'>of</span> <span m='3910790'>the</span> <span m='3910960'>try,</span>
  <span m='3912230'>less</span> <span m='3912650'>like</span> <span m='3912990'>a--</span>
  <span m='3919330'>less</span> <span m='3919690'>level</span> <span m='3920020'>order,</span>
  <span m='3920630'>so</span> <span m='3920860'>more</span> <span m='3921160'>depth-first.</span>
  <span m='3923430'>OK.</span> <span m='3924100'>Here's</span> <span m='3924370'>our</span>
  <span m='3924700'>friend</span> <span m='3925250'>the</span> <span m='3925330'>binary</span>
  <span m='3925690'>try,</span> <span m='3932910'>same</span> <span m='3933210'>one</span>
  <span m='3933390'>as</span> <span m='3933540'>before.</span> <span m='3937130'>We</span>
  <span m='3937290'>had</span> <span m='3937410'>our</span> <span m='3937470'>binary</span>
  <span m='3937770'>representation</span> <span m='3938430'>of</span> <span m='3938550'>it.</span>
  <span m='3938770'>I'm</span> <span m='3938870'>not</span> <span m='3938910'>going</span>
  <span m='3939030'>to</span> <span m='3939450'>draw</span> <span m='3939630'>that</span>
  <span m='3939810'>here.</span> </p><p><span m='3941320'>First</span> <span m='3941490'>thing</span>
  <span m='3941640'>I</span> <span m='3941700'>want</span> <span m='3941880'>to</span>
  <span m='3941940'>do</span> <span m='3942060'>is</span> <span m='3942120'>say,</span>
  <span m='3942430'>hey,</span> <span m='3942510'>look,</span> <span m='3943620'>this</span>
  <span m='3943890'>is</span> <span m='3944040'>the</span> <span m='3944160'>same</span>
  <span m='3944490'>thing</span> <span m='3945120'>as</span> <span m='3945600'>a</span>
  <span m='3945840'>rooted</span> <span m='3947070'>ordered</span> <span m='3947490'>tree.</span>
  <span m='3952170'>I already</span> <span m='3952500'>mentioned</span> <span m='3952920'>that</span>
  <span m='3953040'>there's</span> <span m='3953250'>the</span> <span m='3953340'>same</span>
  <span m='3953670'>number</span> <span m='3954060'>of</span> <span m='3954180'>them.</span>
  <span m='3954840'>There's</span> <span m='3954970'>Catalan</span> <span m='3955980'>of</span>
  <span m='3956130'>these</span> <span m='3956490'>and</span> <span m='3956580'>there's</span>
  <span m='3956730'>Catalan</span> <span m='3957280'>of</span> <span m='3957390'>these.</span>
  </p><p><span m='3958430'>So a</span> <span m='3958590'>rooted</span> <span m='3958910'>ordered</span>
  <span m='3959100'>tree</span> <span m='3959430'>has</span> <span m='3959640'>a</span>
  <span m='3959700'>node,</span> <span m='3959955'>it</span> <span m='3960210'>has</span>
  <span m='3960360'>some</span> <span m='3960570'>number</span> <span m='3960780'>of</span>
  <span m='3960870'>children,</span> <span m='3962040'>then</span> <span m='3962160'>more</span>
  <span m='3962340'>nodes.</span> <span m='3963360'>The</span> <span m='3963660'>children</span>
  <span m='3964050'>are</span> <span m='3964170'>ordered,</span> <span m='3964680'>but</span>
  <span m='3964830'>they</span> <span m='3964920'>don't</span> <span m='3965070'>have</span>
  <span m='3965220'>labels</span> <span m='3965580'>on</span> <span m='3965730'>them.</span>
  <span m='3966000'>So</span> <span m='3966210'>it's</span> <span m='3966330'>a</span>
  <span m='3966420'>tree,</span> <span m='3966690'>not</span> <span m='3966870'>a</span>
  <span m='3966960'>try.</span> </p><p><span m='3971500'>So</span> <span m='3973060'>I</span>
  <span m='3973150'>claim</span> <span m='3973420'>these</span> <span m='3973570'>two</span>
  <span m='3973690'>things</span> <span m='3973930'>are</span> <span m='3973990'>equivalent.</span>
  <span m='3974530'>And</span> <span m='3974620'>there's</span> <span m='3974800'>a</span>
  <span m='3974860'>nice</span> <span m='3975400'>combinatorial</span> <span m='3976210'>bijection</span>
  <span m='3976600'>between</span> <span m='3976960'>them,</span> <span m='3977540'>which</span>
  <span m='3977880'>you</span> <span m='3977980'>may</span> <span m='3978160'>have</span>
  <span m='3978250'>seen</span> <span m='3978460'>before.</span> <span m='3979380'>It's</span>
  <span m='3979540'>kind</span> <span m='3979720'>of</span> <span m='3980170'>a</span>
  <span m='3980230'>classic.</span> <span m='3980890'>But</span> <span m='3981010'>here</span>
  <span m='3981220'>we're</span> <span m='3981550'>going</span> <span m='3981700'>to</span>
  <span m='3981760'>use</span> <span m='3981970'>it</span> <span m='3983350'>for</span>
  <span m='3983530'>handy</span> <span m='3983750'>stuff.</span> </p><p><span m='3984500'>Basically</span>
  <span m='3989330'>so</span> <span m='3989560'>binary</span> <span m='3989950'>tries</span>
  <span m='3990340'>distinguish</span> <span m='3990850'>between</span> <span m='3991150'>left</span>
  <span m='3991390'>and</span> <span m='3991480'>right.</span> <span m='3992180'>Rooted</span>
  <span m='3992500'>order</span> <span m='3992710'>trees</span> <span m='3993070'>do</span>
  <span m='3993220'>not.</span> <span m='3994080'>They</span> <span m='3994150'>just</span>
  <span m='3994480'>have</span> <span m='3994750'>order.</span> </p><p><span m='3996160'>So</span>
  <span m='3996460'>to</span> <span m='3996580'>clean</span> <span m='3996790'>that</span>
  <span m='3996970'>up,</span> <span m='3997240'>I'm</span> <span m='3997450'>going</span>
  <span m='3997690'>to</span> <span m='3998110'>look</span> <span m='3998380'>at</span>
  <span m='3998530'>the</span> <span m='3998740'>right</span> <span m='3999220'>spine</span>
  <span m='3999850'>of</span> <span m='4000000'>the</span> <span m='4000120'>try,</span>
  <span m='4001590'>distinguish</span> <span m='4002100'>that,</span> <span m='4002310'>because</span>
  <span m='4002610'>right</span> <span m='4002850'>and</span> <span m='4002940'>left</span>
  <span m='4003480'>make</span> <span m='4003750'>the</span> <span m='4003810'>difference</span>
  <span m='4004170'>here,</span> <span m='4005110'>and</span> <span m='4005130'>then</span>
  <span m='4005280'>recurse.</span> <span m='4006010'>So</span> <span m='4006090'>this</span>
  <span m='4006270'>is</span> <span m='4006390'>the</span> <span m='4006510'>right</span>
  <span m='4006690'>spine</span> <span m='4007140'>of</span> <span m='4007420'>down</span>
  <span m='4007700'>here.</span> <span m='4008640'>This</span> <span m='4008790'>is</span>
  <span m='4008910'>the right</span> <span m='4009210'>spine</span> <span m='4010110'>of</span>
  <span m='4010290'>this</span> <span m='4010440'>subtree.</span> <span m='4012300'>Now</span>
  <span m='4012540'>every</span> <span m='4012810'>node</span> <span m='4013050'>lives</span>
  <span m='4013290'>in</span> <span m='4013380'>some</span> <span m='4013650'>right</span>
  <span m='4013830'>spine.</span> </p><p><span m='4015030'>And</span> <span m='4015120'>then</span>
  <span m='4015270'>I'm</span> <span m='4015390'>just</span> <span m='4015510'>going</span>
  <span m='4015600'>to</span> <span m='4016050'>rotate</span> <span m='4017220'>45</span>
  <span m='4017880'>degrees</span> <span m='4019810'>counterclockwise.</span> <span
  m='4021390'>So</span> <span m='4022140'>I</span> <span m='4022260'>have</span> <span
  m='4022960'>A,</span> <span m='4023340'>E,</span> <span m='4023720'>G.</span> <span
  m='4024600'>That's</span> <span m='4024900'>my</span> <span m='4025110'>first</span>
  <span m='4025470'>right</span> <span m='4025710'>spine.</span> <span m='4026280'>I'm</span>
  <span m='4026370'>going</span> <span m='4026520'>to</span> <span m='4026580'>think</span>
  <span m='4026850'>of</span> <span m='4026940'>them</span> <span m='4027270'>as</span>
  <span m='4027630'>children</span> <span m='4028830'>of</span> <span m='4029070'>a</span>
  <span m='4029160'>new</span> <span m='4029490'>root</span> <span m='4029730'>node.</span>
  </p><p><span m='4031710'>And</span> <span m='4031860'>then</span> <span m='4032910'>they</span>
  <span m='4033180'>have</span> <span m='4033480'>children</span> <span m='4033840'>below</span>
  <span m='4034170'>that</span> <span m='4034380'>which</span> <span m='4034560'>correspond</span>
  <span m='4034980'>to</span> <span m='4035100'>the</span> <span m='4035190'>right</span>
  <span m='4035400'>spines</span> <span m='4036030'>that</span> <span m='4036210'>hang</span>
  <span m='4036540'>below.</span> <span m='4037110'>So</span> <span m='4037320'>A,</span>
  <span m='4037530'>for</span> <span m='4037680'>example,</span> <span m='4038860'>has</span>
  <span m='4039360'>this</span> <span m='4040380'>right</span> <span m='4040590'>spine,</span>
  <span m='4040920'>B,</span> <span m='4041100'>C,</span> <span m='4041586'>D.</span>
  <span m='4043044'>So we have</span> <span m='4043530'>B,</span> <span m='4044160'>C,</span>
  <span m='4045000'>D</span> <span m='4046260'>here.</span> <span m='4048090'>E</span>
  <span m='4048870'>has</span> <span m='4049140'>a</span> <span m='4049200'>right</span>
  <span m='4049410'>spine</span> <span m='4049840'>of F</span> <span m='4050130'>hanging</span>
  <span m='4050460'>off</span> <span m='4050610'>of</span> <span m='4050700'>it.</span>
  <span m='4052880'>G</span> <span m='4053160'>has</span> <span m='4053400'>no</span>
  <span m='4053550'>right</span> <span m='4053760'>spine</span> <span m='4054030'>hanging</span>
  <span m='4054300'>off</span> <span m='4054450'>of</span> <span m='4054540'>it.</span>
  </p><p><span m='4055590'>So</span> <span m='4055740'>you</span> <span m='4055830'>need</span>
  <span m='4055980'>to</span> <span m='4056070'>prove</span> <span m='4056430'>that</span>
  <span m='4056550'>this</span> <span m='4056760'>is</span> <span m='4056880'>a</span>
  <span m='4056960'>real</span> <span m='4057180'>bijection.</span> <span m='4057900'>Every</span>
  <span m='4059370'>binary</span> <span m='4059730'>try</span> <span m='4060060'>can</span>
  <span m='4060240'>be</span> <span m='4060360'>so</span> <span m='4060570'>converted</span>
  <span m='4060830'>into</span> <span m='4061090'>a</span> <span m='4061230'>rooted</span>
  <span m='4061500'>order</span> <span m='4061740'>tree.</span> <span m='4062320'>And</span>
  <span m='4062430'>it's</span> <span m='4062610'>unique,</span> <span m='4063190'>so</span>
  <span m='4064370'>if</span> <span m='4064470'>it's</span> <span m='4064590'>different</span>
  <span m='4064860'>over</span> <span m='4065040'>here,</span> <span m='4065230'>it</span>
  <span m='4065280'>will</span> <span m='4065370'>be</span> <span m='4065430'>different</span>
  <span m='4065700'>over</span> <span m='4065910'>here.</span> </p><p><span m='4066450'>And</span>
  <span m='4066570'>you</span> <span m='4066690'>can</span> <span m='4066810'>convert</span>
  <span m='4067080'>backwards</span> <span m='4067530'>as</span> <span m='4067650'>well,</span>
  <span m='4067880'>if</span> <span m='4067980'>you</span> <span m='4068040'>just</span>
  <span m='4068220'>delete</span> <span m='4068490'>the</span> <span m='4068610'>super-root</span>
  <span m='4069630'>and</span> <span m='4069810'>turn</span> <span m='4070170'>all</span>
  <span m='4070320'>the</span> <span m='4070440'>children</span> <span m='4070800'>into</span>
  <span m='4071010'>a</span> <span m='4071040'>right</span> <span m='4071250'>spine</span>
  <span m='4071640'>or</span> <span m='4071700'>recurse.</span> <span m='4072150'>They're</span>
  <span m='4072270'>really</span> <span m='4072480'>the</span> <span m='4072630'>same</span>
  <span m='4073110'>thing.</span> <span m='4074010'>This</span> <span m='4074160'>is</span>
  <span m='4074250'>why</span> <span m='4074460'>there's</span> <span m='4074640'>Catalan</span>
  <span m='4075090'>of</span> <span m='4075210'>each</span> <span m='4075390'>of</span>
  <span m='4075450'>them.</span> </p><p><span m='4078210'>OK.</span> <span m='4081390'>Now</span>
  <span m='4081750'>what</span> <span m='4082020'>I'd</span> <span m='4082140'>really</span>
  <span m='4082350'>like</span> <span m='4082560'>to</span> <span m='4082680'>get</span>
  <span m='4082830'>to</span> <span m='4083160'>is</span> <span m='4083580'>balanced</span>
  <span m='4083990'>parentheses.</span> <span m='4092260'>And</span> <span m='4092440'>while</span>
  <span m='4092680'>it's</span> <span m='4092800'>a</span> <span m='4092860'>little</span>
  <span m='4093580'>unclear</span> <span m='4094180'>how</span> <span m='4094300'>to</span>
  <span m='4094390'>represent</span> <span m='4094820'>a</span> <span m='4094870'>binary</span>
  <span m='4095260'>try</span> <span m='4095890'>with</span> <span m='4096069'>balanced</span>
  <span m='4096370'>parentheses,</span> <span m='4097330'>these</span> <span m='4097540'>things</span>
  <span m='4097810'>it's</span> <span m='4097930'>really</span> <span m='4098200'>clear</span>
  <span m='4098470'>how</span> <span m='4098560'>to</span> <span m='4098649'>represent</span>
  <span m='4099069'>a</span> <span m='4099130'>binary--</span> <span m='4100330'>represent</span>
  <span m='4100840'>with</span> <span m='4100960'>balanced</span> <span m='4101260'>parentheses.</span>
  <span m='4102250'>Here</span> <span m='4102550'>I</span> <span m='4102640'>just</span>
  <span m='4102880'>do</span> <span m='4103750'>an</span> <span m='4103899'>Euler</span>
  <span m='4104229'>tour,</span> <span m='4104740'>which</span> <span m='4105140'>was</span>
  <span m='4105609'>a</span> <span m='4105700'>depth-first</span> <span m='4106120'>search</span>
  <span m='4106670'>visiting</span> <span m='4107020'>these</span> <span m='4107200'>things.</span>
  </p><p><span m='4108040'>And</span> <span m='4108120'>every</span> <span m='4108310'>time</span>
  <span m='4108790'>I</span> <span m='4108910'>start</span> <span m='4109270'>a node,</span>
  <span m='4109600'>I'll write</span> <span m='4109810'>an</span> <span m='4109979'>open</span>
  <span m='4110229'>paren.</span> <span m='4110590'>Every</span> <span m='4110800'>time</span>
  <span m='4110979'>I</span> <span m='4111040'>finish</span> <span m='4111340'>a</span>
  <span m='4111399'>node,</span> <span m='4111569'>I</span> <span m='4111660'>write</span>
  <span m='4111790'>a</span> <span m='4111850'>close</span> <span m='4112120'>paren.</span>
  <span m='4113020'>Similar</span> <span m='4113410'>to</span> <span m='4113649'>representation</span>
  <span m='4114279'>we</span> <span m='4114370'>talked</span> <span m='4114580'>about</span>
  <span m='4114880'>before.</span> </p><p><span m='4116330'>So</span> <span m='4116500'>this</span>
  <span m='4116710'>would</span> <span m='4116830'>be--</span> <span m='4118029'>I'm</span>
  <span m='4118450'>going</span> <span m='4118600'>to</span> <span m='4118660'>need</span>
  <span m='4118810'>more</span> <span m='4118990'>space.</span> <span m='4122020'>This
  is</span> <span m='4122200'>going</span> <span m='4122350'>to</span> <span m='4122439'>be</span>
  <span m='4122590'>an</span> <span m='4122830'>open</span> <span m='4123189'>paren</span>
  <span m='4123640'>for</span> <span m='4123930'>star.</span> <span m='4124960'>Why</span>
  <span m='4125180'>don't</span> <span m='4125260'>I</span> <span m='4125620'>make</span>
  <span m='4125830'>that</span> <span m='4125979'>one</span> <span m='4126130'>really</span>
  <span m='4126340'>big?</span> <span m='4127420'>We</span> <span m='4127510'>start</span>
  <span m='4127779'>here.</span> </p><p><span m='4128470'>Then</span> <span m='4128770'>we</span>
  <span m='4128920'>open</span> <span m='4129319'>the</span> <span m='4129540'>A</span>
  <span m='4129819'>chunk.</span> <span m='4130899'>Then</span> <span m='4131109'>we</span>
  <span m='4131229'>do</span> <span m='4131560'>B,</span> <span m='4131950'>which</span>
  <span m='4132310'>has</span> <span m='4132580'>no</span> <span m='4132760'>children.</span>
  <span m='4134170'>Then</span> <span m='4134319'>we</span> <span m='4134439'>do</span>
  <span m='4134590'>C,</span> <span m='4134979'>which</span> <span m='4135160'>has</span>
  <span m='4135370'>no</span> <span m='4135520'>children.</span> <span m='4136779'>Then</span>
  <span m='4136930'>we</span> <span m='4137050'>do</span> <span m='4137200'>D,</span>
  <span m='4137470'>which</span> <span m='4137649'>has</span> <span m='4137859'>no</span>
  <span m='4138010'>children.</span> <span m='4139569'>And</span> <span m='4139689'>that</span>
  <span m='4139930'>finishes</span> <span m='4140600'>A.</span> </p><p><span m='4142939'>OK.</span>
  <span m='4143350'>Then</span> <span m='4143529'>we</span> <span m='4143620'>start</span>
  <span m='4143970'>E.</span> <span m='4146425'>Then</span> <span m='4146920'>we</span>
  <span m='4147010'>do</span> <span m='4147189'>F.</span> <span m='4150189'>Then</span>
  <span m='4150430'>we</span> <span m='4150670'>finish</span> <span m='4151540'>F.</span>
  <span m='4151830'>We</span> <span m='4151930'>finish</span> <span m='4152490'>E.</span>
  <span m='4154029'>Then</span> <span m='4154210'>we</span> <span m='4154359'>do</span>
  <span m='4155020'>G.</span> <span m='4158290'>And</span> <span m='4158529'>then</span>
  <span m='4158680'>we're</span> <span m='4158800'>done</span> <span m='4159069'>with</span>
  <span m='4159420'>star.</span> </p><p><span m='4163340'>So</span> <span m='4163420'>that's
  a</span> <span m='4163779'>very</span> <span m='4164050'>easy</span> <span m='4164319'>transformation.</span>
  <span m='4165040'>Again,</span> <span m='4165399'>there</span> <span m='4165550'>are</span>
  <span m='4165609'>Catalan</span> <span m='4166120'>many</span> <span m='4166420'>of</span>
  <span m='4166510'>these</span> <span m='4166960'>balanced</span> <span m='4167319'>parens.</span>
  <span m='4168220'>You</span> <span m='4168279'>think,</span> <span m='4168490'>oh,</span>
  <span m='4168640'>there's</span> <span m='4168850'>2</span> <span m='4169000'>to</span>
  <span m='4169090'>the</span> <span m='4169210'>n</span> <span m='4169330'>of</span>
  <span m='4169420'>them,</span> <span m='4172399'>because</span> <span m='4172609'>each</span>
  <span m='4173560'>paren</span> <span m='4173840'>could</span> <span m='4173990'>be</span>
  <span m='4174109'>open</span> <span m='4174319'>or</span> <span m='4174380'>closed.</span>
  <span m='4174830'>But</span> <span m='4175069'>they</span> <span m='4175189'>have</span>
  <span m='4175340'>to</span> <span m='4175430'>be</span> <span m='4175520'>balanced,</span>
  <span m='4175800'>so</span> <span m='4176080'>it's</span> <span m='4176210'>a</span>
  <span m='4176270'>little</span> <span m='4176479'>bit</span> <span m='4176630'>more</span>
  <span m='4176810'>constrained</span> <span m='4177229'>than</span> <span m='4177380'>that.</span>
  <span m='4179810'>And</span> <span m='4179990'>so</span> <span m='4180050'>it</span>
  <span m='4180140'>ends</span> <span m='4180290'>up</span> <span m='4180380'>being</span>
  <span m='4180529'>Catalan</span> <span m='4180904'>of n</span> <span m='4181279'>over</span>
  <span m='4181479'>2</span> <span m='4182010'>if</span> <span m='4182170'>there's</span>
  <span m='4182390'>n</span> <span m='4182560'>parens,</span> <span m='4185149'>because</span>
  <span m='4185810'>there's</span> <span m='4186170'>2</span> <span m='4186410'>parens</span>
  <span m='4186830'>here</span> <span m='4187010'>for</span> <span m='4187160'>every</span>
  <span m='4187399'>node</span> <span m='4187640'>over</span> <span m='4187819'>here.</span>
  </p><p><span m='4188430'>This</span> <span m='4188510'>is</span> <span m='4188600'>going</span>
  <span m='4188720'>to</span> <span m='4188810'>be</span> <span m='4188939'>our</span>
  <span m='4189020'>bit</span> <span m='4189229'>string.</span> <span m='4190310'>Open</span>
  <span m='4190609'>parens</span> <span m='4190910'>are</span> <span m='4190970'>0's.</span>
  <span m='4191450'>Close</span> <span m='4191750'>parens</span> <span m='4192080'>are</span>
  <span m='4192170'>1's.</span> <span m='4193729'>This</span> <span m='4193910'>has</span>
  <span m='4194300'>roughly</span> <span m='4194600'>2n</span> <span m='4194990'>bits,</span>
  <span m='4195380'>2n</span> <span m='4196070'>plus</span> <span m='4196370'>2,</span>
  <span m='4196700'>I</span> <span m='4196760'>guess,</span> <span m='4197030'>for</span>
  <span m='4197180'>the</span> <span m='4197300'>star,</span> <span m='4199190'>relative</span>
  <span m='4199640'>to</span> <span m='4199760'>this</span> <span m='4199980'>n.</span>
  </p><p><span m='4201880'>So</span> <span m='4202100'>basically,</span> <span m='4202730'>nodes</span>
  <span m='4203150'>here</span> <span m='4204490'>correspond</span> <span m='4205060'>to</span>
  <span m='4205240'>nodes</span> <span m='4205640'>here,</span> <span m='4206810'>which</span>
  <span m='4206990'>correspond</span> <span m='4207620'>to</span> <span m='4208640'>an</span>
  <span m='4208790'>open</span> <span m='4209120'>paren,</span> <span m='4209550'>close</span>
  <span m='4210000'>paren</span> <span m='4210380'>pair</span> <span m='4210800'>over</span>
  <span m='4211040'>here.</span> <span m='4212300'>Now,</span> <span m='4212630'>we</span>
  <span m='4212780'>can't</span> <span m='4212990'>afford</span> <span m='4213260'>to</span>
  <span m='4213350'>store</span> <span m='4213530'>these</span> <span m='4213710'>labels.</span>
  <span m='4214190'>Those</span> <span m='4214400'>are</span> <span m='4214460'>just</span>
  <span m='4214730'>guidelines</span> <span m='4215225'>to</span> <span m='4215720'>think</span>
  <span m='4215990'>about</span> <span m='4216260'>what</span> <span m='4216410'>you</span>
  <span m='4216530'>need.</span> </p><p><span m='4218430'>So</span> <span m='4218780'>let's</span>
  <span m='4218990'>think</span> <span m='4219200'>about</span> <span m='4219620'>there</span>
  <span m='4219700'>are</span> <span m='4219740'>three</span> <span m='4219980'>things</span>
  <span m='4220220'>we</span> <span m='4220370'>really</span> <span m='4220610'>want</span>
  <span m='4220850'>here,</span> <span m='4221600'>left</span> <span m='4221870'>child,</span>
  <span m='4222770'>right</span> <span m='4223010'>child,</span> <span m='4223970'>and</span>
  <span m='4224120'>parent.</span> <span m='4231270'>This</span> <span m='4231540'>is</span>
  <span m='4231750'>the</span> <span m='4232740'>thing</span> <span m='4232950'>that</span>
  <span m='4233070'>we</span> <span m='4233220'>care</span> <span m='4233520'>about,</span>
  <span m='4233940'>but</span> <span m='4234150'>this</span> <span m='4234390'>is</span>
  <span m='4234510'>what</span> <span m='4234690'>we're</span> <span m='4234780'>going</span>
  <span m='4235040'>to</span> <span m='4235170'>store.</span> <span m='4236190'>So</span>
  <span m='4236400'>I</span> <span m='4236460'>want</span> <span m='4236610'>to</span>
  <span m='4236670'>translate</span> <span m='4237270'>from</span> <span m='4237450'>here</span>
  <span m='4238050'>to</span> <span m='4238170'>here</span> <span m='4238950'>to</span>
  <span m='4239070'>here.</span> <span m='4239610'>This</span> <span m='4239730'>is</span>
  <span m='4239850'>an</span> <span m='4239940'>exercise</span> <span m='4240690'>in</span>
  <span m='4241440'>translation.</span> </p><p><span m='4242920'>So</span> <span m='4242970'>what</span>
  <span m='4243120'>does</span> <span m='4243210'>a</span> <span m='4243270'>left</span>
  <span m='4243540'>child</span> <span m='4243960'>mean</span> <span m='4244320'>here?</span>
  <span m='4244830'>Left</span> <span m='4245180'>child</span> <span m='4246300'>over</span>
  <span m='4246570'>here</span> <span m='4247950'>corresponds</span> <span m='4248790'>to--</span>
  <span m='4251670'>well,</span> <span m='4251850'>I</span> <span m='4251910'>guess</span>
  <span m='4252090'>it</span> <span m='4252150'>goes--</span> <span m='4252780'>in</span>
  <span m='4253050'>general,</span> <span m='4253450'>the</span> <span m='4253550'>left</span>
  <span m='4253620'>child</span> <span m='4254370'>goes</span> <span m='4254640'>to</span>
  <span m='4254760'>this</span> <span m='4254910'>branch,</span> <span m='4255370'>which</span>
  <span m='4255390'>is</span> <span m='4255510'>like</span> <span m='4255750'>all</span>
  <span m='4256050'>of</span> <span m='4256170'>these</span> <span m='4256350'>children</span>
  <span m='4256680'>pointers</span> <span m='4257010'>from</span> <span m='4257210'>A.</span>
  <span m='4258180'>But</span> <span m='4258330'>really,</span> <span m='4259350'>if</span>
  <span m='4259470'>you</span> <span m='4259560'>follow</span> <span m='4259830'>the</span>
  <span m='4259890'>left</span> <span m='4260070'>child,</span> <span m='4260410'>you</span>
  <span m='4260510'>get</span> <span m='4260550'>to</span> <span m='4260670'>B,</span>
  <span m='4261090'>not</span> <span m='4261390'>any</span> <span m='4261570'>of</span>
  <span m='4261630'>the</span> <span m='4261750'>other</span> <span m='4261960'>things</span>
  <span m='4262200'>on</span> <span m='4262290'>the</span> <span m='4262350'>right</span>
  <span m='4262530'>spine.</span> <span m='4262930'>You</span> <span m='4263030'>always</span>
  <span m='4263200'>get</span> <span m='4263310'>to</span> <span m='4263400'>the</span>
  <span m='4263520'>top</span> <span m='4263790'>of</span> <span m='4263850'>the</span>
  <span m='4263940'>right</span> <span m='4264120'>spine.</span> </p><p><span m='4264780'>Top</span>
  <span m='4264990'>of</span> <span m='4265050'>the</span> <span m='4265110'>right</span>
  <span m='4265290'>spine</span> <span m='4265590'>is</span> <span m='4265680'>the</span>
  <span m='4265770'>left-most</span> <span m='4267000'>node</span> <span m='4267300'>in</span>
  <span m='4267390'>the</span> <span m='4267480'>spine</span> <span m='4267840'>here.</span>
  <span m='4268570'>In</span> <span m='4268670'>other</span> <span m='4268770'>words,</span>
  <span m='4268990'>it</span> <span m='4269010'>is</span> <span m='4269280'>the</span>
  <span m='4269520'>first</span> <span m='4270000'>child</span> <span m='4272760'>of</span>
  <span m='4273000'>a node.</span> <span m='4273390'>First</span> <span m='4273660'>child</span>
  <span m='4273930'>of</span> <span m='4274020'>a</span> <span m='4274080'>node,</span>
  <span m='4274350'>if</span> <span m='4274470'>there</span> <span m='4274620'>is</span>
  <span m='4274770'>one,</span> <span m='4275420'>is</span> <span m='4275520'>going</span>
  <span m='4275700'>to</span> <span m='4275760'>be</span> <span m='4275820'>the</span>
  <span m='4275910'>left</span> <span m='4276120'>child</span> <span m='4276450'>over</span>
  <span m='4276630'>here.</span> </p><p><span m='4278580'>Right</span> <span m='4278950'>child</span>
  <span m='4279540'>is</span> <span m='4279690'>like</span> <span m='4279870'>following</span>
  <span m='4280380'>the</span> <span m='4280470'>spine.</span> <span m='4281040'>That's</span>
  <span m='4281370'>like</span> <span m='4281610'>going</span> <span m='4282360'>this</span>
  <span m='4282570'>way.</span> <span m='4283590'>So</span> <span m='4283800'>right</span>
  <span m='4284100'>child</span> <span m='4284700'>is</span> <span m='4285510'>what</span>
  <span m='4285750'>I</span> <span m='4285870'>would</span> <span m='4285990'>call</span>
  <span m='4286230'>next</span> <span m='4286680'>sibling.</span> <span m='4289920'>The</span>
  <span m='4290040'>next</span> <span m='4290250'>sibling</span> <span m='4290610'>to</span>
  <span m='4290700'>the</span> <span m='4290820'>right,</span> <span m='4291690'>if</span>
  <span m='4291840'>there</span> <span m='4291990'>is</span> <span m='4292110'>one,</span>
  <span m='4292710'>that's</span> <span m='4292890'>going</span> <span m='4293010'>to</span>
  <span m='4293070'>correspond</span> <span m='4293520'>to</span> <span m='4293580'>the</span>
  <span m='4293700'>right</span> <span m='4293850'>child,</span> <span m='4294180'>because</span>
  <span m='4294360'>we're</span> <span m='4294450'>just</span> <span m='4294600'>following</span>
  <span m='4295020'>a</span> <span m='4295080'>right</span> <span m='4295290'>spine.</span>
  </p><p><span m='4296796'>OK.</span> <span m='4297180'>Parent</span> <span m='4298950'>is</span>
  <span m='4299100'>a</span> <span m='4299160'>little</span> <span m='4299460'>trickier.</span>
  <span m='4300750'>Parent</span> <span m='4301020'>is</span> <span m='4301140'>the</span>
  <span m='4301200'>reverse</span> <span m='4301560'>of</span> <span m='4301650'>these,</span>
  <span m='4301830'>so</span> <span m='4302070'>either</span> <span m='4303600'>you</span>
  <span m='4303810'>take</span> <span m='4304170'>your</span> <span m='4304380'>previous</span>
  <span m='4304980'>sibling--</span> <span m='4306110'>but</span> <span m='4306270'>if</span>
  <span m='4306420'>you're</span> <span m='4306540'>here</span> <span m='4306840'>and</span>
  <span m='4306930'>there</span> <span m='4307080'>is</span> <span m='4307200'>no</span>
  <span m='4307350'>previous</span> <span m='4307710'>sibling,</span> <span m='4308610'>then</span>
  <span m='4308910'>you</span> <span m='4309030'>take</span> <span m='4309270'>your</span>
  <span m='4309390'>actual</span> <span m='4309720'>parent,</span> <span m='4311260'>because</span>
  <span m='4311580'>parent</span> <span m='4312000'>should</span> <span m='4312240'>walk</span>
  <span m='4312600'>up</span> <span m='4312750'>here.</span> <span m='4313120'>This
  was</span> <span m='4313270'>like</span> <span m='4313440'>going</span> <span m='4313650'>left,</span>
  <span m='4314400'>previous</span> <span m='4314730'>sibling,</span> <span m='4315090'>previous</span>
  <span m='4315390'>sibling.</span> <span m='4316110'>Parent</span> <span m='4316360'>of</span>
  <span m='4316440'>this</span> <span m='4316620'>guy,</span> <span m='4316800'>though,</span>
  <span m='4317580'>is</span> <span m='4317820'>the</span> <span m='4317910'>actual</span>
  <span m='4318330'>parent</span> <span m='4318690'>over</span> <span m='4318900'>here.</span>
  <span m='4320410'>So</span> <span m='4320550'>this</span> <span m='4320730'>is</span>
  <span m='4320850'>going</span> <span m='4321090'>to</span> <span m='4321240'>be</span>
  <span m='4322090'>previous</span> <span m='4322500'>sibling</span> <span m='4323160'>if</span>
  <span m='4323370'>there</span> <span m='4323520'>is</span> <span m='4323670'>one,</span>
  <span m='4325710'>or</span> <span m='4326550'>if</span> <span m='4326640'>there</span>
  <span m='4326790'>isn't</span> <span m='4327030'>one,</span> <span m='4327720'>you</span>
  <span m='4327840'>go</span> <span m='4327960'>to</span> <span m='4328050'>the</span>
  <span m='4328170'>parent.</span> </p><p><span m='4334150'>OK.</span> <span m='4334530'>So</span>
  <span m='4334740'>that's</span> <span m='4335040'>easy</span> <span m='4335480'>translation.</span>
  <span m='4336390'>Now</span> <span m='4336630'>we</span> <span m='4336720'>need</span>
  <span m='4336870'>to</span> <span m='4336960'>convert</span> <span m='4337380'>these</span>
  <span m='4337710'>pictures</span> <span m='4338910'>into</span> <span m='4339300'>balanced</span>
  <span m='4339630'>parentheses</span> <span m='4340140'>pictures,</span> <span m='4340590'>which</span>
  <span m='4340770'>is</span> <span m='4340890'>also</span> <span m='4341160'>going</span>
  <span m='4341220'>to</span> <span m='4341370'>be easy</span> <span m='4341490'>in</span>
  <span m='4341820'>itself.</span> <span m='4342180'>But</span> <span m='4342300'>to</span>
  <span m='4342420'>jump</span> <span m='4342810'>all</span> <span m='4342990'>the</span>
  <span m='4343080'>way</span> <span m='4343200'>from</span> <span m='4343350'>binary</span>
  <span m='4343680'>tries</span> <span m='4344010'>to</span> <span m='4344100'>balanced</span>
  <span m='4344400'>parens</span> <span m='4344760'>would</span> <span m='4344910'>be</span>
  <span m='4345030'>pretty</span> <span m='4345480'>confusing,</span> <span m='4346960'>so</span>
  <span m='4346980'>that's</span> <span m='4347190'>why</span> <span m='4347340'>we</span>
  <span m='4347460'>have</span> <span m='4347610'>this</span> <span m='4347790'>intermediate</span>
  <span m='4348270'>step.</span> </p><p><span m='4349480'>So</span> <span m='4349830'>we</span>
  <span m='4350010'>want</span> <span m='4351150'>first</span> <span m='4351690'>child</span>
  <span m='4352670'>here.</span> <span m='4353760'>If</span> <span m='4353910'>I</span>
  <span m='4354030'>have</span> <span m='4354240'>a</span> <span m='4354300'>paren--</span>
  <span m='4354750'>like</span> <span m='4355080'>I'm</span> <span m='4355260'>looking</span>
  <span m='4355500'>at</span> <span m='4355600'>A.</span> <span m='4356790'>So</span>
  <span m='4357110'>A</span> <span m='4357360'>corresponds</span> <span m='4357870'>to</span>
  <span m='4357930'>this</span> <span m='4358140'>paren</span> <span m='4359220'>and</span>
  <span m='4359340'>this</span> <span m='4359520'>paren.</span> </p><p><span m='4360440'>I'm</span>
  <span m='4360540'>going</span> <span m='4360660'>to</span> <span m='4360720'>represent</span>
  <span m='4361140'>the</span> <span m='4361230'>node</span> <span m='4361630'>let's</span>
  <span m='4361650'>say</span> <span m='4361800'>by</span> <span m='4361980'>the</span>
  <span m='4362070'>first</span> <span m='4362470'>paren.</span> <span m='4365130'>Then</span>
  <span m='4365310'>the</span> <span m='4365370'>first</span> <span m='4365640'>child</span>
  <span m='4366220'>is</span> <span m='4366360'>just</span> <span m='4366660'>the</span>
  <span m='4366780'>very</span> <span m='4366960'>next</span> <span m='4367170'>character.</span>
  <span m='4368490'>You</span> <span m='4368670'>put</span> <span m='4368850'>the</span>
  <span m='4368940'>first</span> <span m='4369150'>child</span> <span m='4369510'>right</span>
  <span m='4369720'>after</span> <span m='4370050'>that</span> <span m='4370230'>open</span>
  <span m='4370500'>paren.</span> </p><p><span m='4371650'>So</span> <span m='4371670'>this</span>
  <span m='4371850'>is</span> <span m='4371940'>really</span> <span m='4372780'>the</span>
  <span m='4372900'>next</span> <span m='4373260'>character</span> <span m='4374410'>if
  we</span> <span m='4374480'>want</span> <span m='4374640'>to</span> <span m='4374700'>find</span>
  <span m='4374880'>the</span> <span m='4374970'>first</span> <span m='4375210'>child.</span>
  <span m='4376740'>This</span> <span m='4377040'>is</span> <span m='4378030'>if</span>
  <span m='4378930'>it's</span> <span m='4379140'>an</span> <span m='4379320'>open</span>
  <span m='4379680'>paren.</span> <span m='4381090'>It</span> <span m='4381180'>could</span>
  <span m='4381390'>be</span> <span m='4381510'>the</span> <span m='4381600'>very</span>
  <span m='4381840'>next--</span> <span m='4382230'>like if</span> <span m='4382470'>you're</span>
  <span m='4382560'>doing</span> <span m='4382800'>B,</span> <span m='4383070'>the</span>
  <span m='4383190'>very</span> <span m='4383370'>next</span> <span m='4383550'>character</span>
  <span m='4383770'>is</span> <span m='4383970'>a</span> <span m='4384030'>close</span>
  <span m='4384300'>paren,</span> <span m='4384540'>that</span> <span m='4384690'>means</span>
  <span m='4384900'>there</span> <span m='4385260'>are</span> <span m='4385320'>no</span>
  <span m='4385470'>children.</span> </p><p><span m='4386760'>But</span> <span m='4386910'>that's</span>
  <span m='4387090'>how</span> <span m='4387150'>you</span> <span m='4387270'>can</span>
  <span m='4387420'>tell</span> <span m='4387600'>whether</span> <span m='4387840'>there's</span>
  <span m='4388080'>a</span> <span m='4388140'>child.</span> <span m='4388450'>If</span>
  <span m='4388560'>there's</span> <span m='4388710'>an</span> <span m='4388800'>open</span>
  <span m='4389010'>paren</span> <span m='4389250'>right</span> <span m='4389400'>after</span>
  <span m='4389640'>your</span> <span m='4389760'>open</span> <span m='4390030'>paren,</span>
  <span m='4390810'>that's</span> <span m='4391050'>your</span> <span m='4391140'>next</span>
  <span m='4391440'>child.</span> <span m='4393150'>That's</span> <span m='4393330'>your</span>
  <span m='4393420'>first</span> <span m='4393690'>child,</span> <span m='4394110'>I</span>
  <span m='4394170'>should</span> <span m='4394350'>say.</span> </p><p><span m='4395550'>Now</span>
  <span m='4395730'>what</span> <span m='4395880'>about</span> <span m='4396150'>next</span>
  <span m='4396660'>sibling?</span> <span m='4397770'>So</span> <span m='4398040'>let's</span>
  <span m='4398250'>say</span> <span m='4399000'>again</span> <span m='4399270'>I'm</span>
  <span m='4399370'>at</span> <span m='4399510'>A.</span> <span m='4401514'>And</span>
  <span m='4401940'>I</span> <span m='4402060'>want</span> <span m='4402270'>to</span>
  <span m='4402360'>know</span> <span m='4402600'>the</span> <span m='4402750'>next</span>
  <span m='4403050'>sibling.</span> <span m='4403530'>Next</span> <span m='4403680'>sibling</span>
  <span m='4404050'>is</span> <span m='4404220'>E.</span> <span m='4405930'>So</span>
  <span m='4406080'>that's</span> <span m='4406290'>like</span> <span m='4406620'>I</span>
  <span m='4406710'>go</span> <span m='4406920'>to</span> <span m='4407010'>the</span>
  <span m='4407130'>close</span> <span m='4407490'>paren</span> <span m='4407820'>for</span>
  <span m='4408000'>A,</span> <span m='4408240'>and</span> <span m='4408480'>then</span>
  <span m='4408600'>I</span> <span m='4408660'>go to</span> <span m='4408820'>the</span>
  <span m='4408930'>next</span> <span m='4409140'>character.</span> </p><p><span m='4410910'>So</span>
  <span m='4411060'>this</span> <span m='4411240'>would</span> <span m='4411330'>be</span>
  <span m='4415520'>go</span> <span m='4416160'>to</span> <span m='4416850'>the</span>
  <span m='4417000'>close</span> <span m='4417360'>paren</span> <span m='4417900'>for</span>
  <span m='4418110'>where</span> <span m='4418260'>you</span> <span m='4418440'>are</span>
  <span m='4418560'>right</span> <span m='4418740'>now,</span> <span m='4420330'>and</span>
  <span m='4420510'>then</span> <span m='4420930'>go</span> <span m='4421110'>to</span>
  <span m='4421200'>the</span> <span m='4421320'>next</span> <span m='4421560'>character.</span>
  <span m='4424940'>This</span> <span m='4425110'>is,</span> <span m='4425400'>again,</span>
  <span m='4425850'>if</span> <span m='4426060'>it's</span> <span m='4426210'>an</span>
  <span m='4426330'>open</span> <span m='4426630'>paren.</span> <span m='4426990'>If</span>
  <span m='4427080'>it's</span> <span m='4427200'>a</span> <span m='4427260'>close</span>
  <span m='4427570'>paren,</span> <span m='4427830'>then</span> <span m='4427950'>you</span>
  <span m='4428040'>have</span> <span m='4428310'>no</span> <span m='4428490'>next</span>
  <span m='4428730'>sibling.</span> <span m='4429630'>So</span> <span m='4429700'>again,</span>
  <span m='4429900'>you</span> <span m='4430020'>can</span> <span m='4430200'>tell</span>
  <span m='4431040'>whether</span> <span m='4431210'>this</span> <span m='4431400'>operation</span>
  <span m='4431880'>fails.</span> </p><p><span m='4432960'>What</span> <span m='4433110'>we</span>
  <span m='4433260'>need</span> <span m='4433830'>is</span> <span m='4434040'>an</span>
  <span m='4434130'>operation</span> <span m='4435570'>given</span> <span m='4435840'>a</span>
  <span m='4435900'>bit</span> <span m='4436140'>string</span> <span m='4436710'>representing</span>
  <span m='4437460'>balanced</span> <span m='4437790'>parentheses</span> <span m='4438870'>and</span>
  <span m='4438990'>given</span> <span m='4439290'>a</span> <span m='4439350'>query</span>
  <span m='4439620'>position</span> <span m='4440460'>of a</span> <span m='4440580'>left</span>
  <span m='4440850'>paren,</span> <span m='4441660'>I</span> <span m='4441780'>need</span>
  <span m='4441960'>to</span> <span m='4442080'>know</span> <span m='4442290'>what</span>
  <span m='4442530'>is</span> <span m='4442710'>the</span> <span m='4442860'>matching</span>
  <span m='4443370'>right</span> <span m='4443600'>paren.</span> <span m='4444630'>And</span>
  <span m='4444850'>I'll</span> <span m='4444960'>just</span> <span m='4445440'>wave</span>
  <span m='4445650'>my</span> <span m='4445800'>hands</span> <span m='4446130'>and</span>
  <span m='4446220'>claim</span> <span m='4446520'>that</span> <span m='4446730'>can</span>
  <span m='4446850'>be</span> <span m='4446970'>done</span> <span m='4447240'>with</span>
  <span m='4447330'>the</span> <span m='4447450'>same</span> <span m='4447690'>techniques</span>
  <span m='4448110'>as</span> <span m='4448230'>rank</span> <span m='4448410'>and</span>
  <span m='4448510'>select.</span> <span m='4450090'>It's</span> <span m='4450180'>not</span>
  <span m='4450360'>easy.</span> <span m='4450810'>It's</span> <span m='4450930'>quite</span>
  <span m='4451110'>a</span> <span m='4451170'>bit</span> <span m='4451290'>harder.</span>
  <span m='4451740'>But</span> <span m='4452070'>you</span> <span m='4452160'>do</span>
  <span m='4452370'>enough</span> <span m='4452700'>of</span> <span m='4452820'>these</span>
  <span m='4453000'>recursions,</span> <span m='4454200'>eventually</span> <span m='4454710'>you</span>
  <span m='4455940'>can</span> <span m='4456120'>solve</span> <span m='4456420'>it.</span>
  </p><p><span m='4459090'>OK.</span> <span m='4459450'>Last</span> <span m='4459900'>operation</span>
  <span m='4460320'>is</span> <span m='4460410'>parent</span> <span m='4461190'>over</span>
  <span m='4461400'>here,</span> <span m='4461880'>which</span> <span m='4462220'>corresponds</span>
  <span m='4462660'>to</span> <span m='4462750'>previous</span> <span m='4463200'>sibling,</span>
  <span m='4464100'>or</span> <span m='4464250'>parent</span> <span m='4464700'>over</span>
  <span m='4464910'>here,</span> <span m='4466210'>which</span> <span m='4466260'>corresponds</span>
  <span m='4467010'>to--</span> <span m='4470730'>there are</span> <span m='4470970'>two</span>
  <span m='4471180'>cases.</span> <span m='4472320'>We</span> <span m='4472620'>want</span>
  <span m='4472860'>to</span> <span m='4472920'>move</span> <span m='4473130'>backwards,</span>
  <span m='4473580'>so</span> <span m='4473700'>here</span> <span m='4473880'>we're</span>
  <span m='4474030'>always</span> <span m='4474240'>ending</span> <span m='4474480'>with</span>
  <span m='4474660'>next</span> <span m='4474930'>character.</span> <span m='4476040'>So</span>
  <span m='4476280'>first</span> <span m='4476490'>thing</span> <span m='4476640'>we</span>
  <span m='4476730'>do</span> <span m='4476850'>is</span> <span m='4477060'>go</span>
  <span m='4477240'>to</span> <span m='4477330'>the</span> <span m='4477420'>previous</span>
  <span m='4477760'>character.</span> </p><p><span m='4482840'>And</span> <span m='4483440'>there</span>
  <span m='4483600'>are</span> <span m='4483630'>two</span> <span m='4483840'>cases.</span>
  <span m='4485920'>If</span> <span m='4486030'>it's</span> <span m='4486210'>a</span>
  <span m='4486420'>close</span> <span m='4487020'>paren--</span> <span m='4487640'>so</span>
  <span m='4487680'>let's</span> <span m='4487830'>say</span> <span m='4488010'>we're</span>
  <span m='4488160'>here</span> <span m='4488460'>at</span> <span m='4488580'>E,</span>
  <span m='4489950'>we</span> <span m='4490030'>go</span> <span m='4490170'>to</span>
  <span m='4490230'>the</span> <span m='4490350'>previous</span> <span m='4490770'>character.</span>
  <span m='4491190'>If</span> <span m='4491340'>it's</span> <span m='4491460'>a</span>
  <span m='4491520'>close</span> <span m='4491820'>paren,</span> <span m='4492150'>then</span>
  <span m='4492450'>A</span> <span m='4493230'>is</span> <span m='4493370'>our</span>
  <span m='4493500'>previous</span> <span m='4493920'>sibling,</span> <span m='4494675'>and</span>
  <span m='4494940'>so</span> <span m='4495090'>we</span> <span m='4495210'>want</span>
  <span m='4495360'>to</span> <span m='4495420'>do</span> <span m='4495510'>the</span>
  <span m='4495600'>previous</span> <span m='4495930'>sibling</span> <span m='4496290'>situation.</span>
  <span m='4497340'>We</span> <span m='4497490'>again</span> <span m='4497790'>find</span>
  <span m='4498060'>the</span> <span m='4498180'>match.</span> <span m='4498570'>We</span>
  <span m='4498690'>hit</span> <span m='4498870'>percent</span> <span m='4499380'>and</span>
  <span m='4499500'>vi</span> <span m='4500070'>and--</span> <span m='4500745'>what's</span>
  <span m='4501120'>the</span> <span m='4501210'>corresponding</span> <span m='4501720'>thing</span>
  <span m='4501900'>in</span> <span m='4501990'>Emacs?</span> <span m='4502110'>I</span>
  <span m='4502590'>forget.</span> </p><p><span m='4503580'>You</span> <span m='4503700'>go</span>
  <span m='4503820'>to</span> <span m='4503910'>the</span> <span m='4504030'>matching</span>
  <span m='4504450'>close</span> <span m='4504720'>paren--</span> <span m='4505690'>sorry,</span>
  <span m='4506190'>open</span> <span m='4506430'>paren.</span> <span m='4507240'>And</span>
  <span m='4507360'>then</span> <span m='4507540'>there</span> <span m='4507690'>you</span>
  <span m='4507810'>go.</span> <span m='4508090'>You've</span> <span m='4508140'>got</span>
  <span m='4508260'>your</span> <span m='4508350'>previous</span> <span m='4508650'>sibling.</span>
  </p><p><span m='4509430'>So</span> <span m='4509580'>if</span> <span m='4509790'>it's</span>
  <span m='4510030'>a</span> <span m='4510870'>close</span> <span m='4511290'>paren,</span>
  <span m='4512220'>then</span> <span m='4512430'>you</span> <span m='4512550'>go</span>
  <span m='4512760'>to</span> <span m='4513390'>the</span> <span m='4513540'>corresponding</span>
  <span m='4514050'>open</span> <span m='4514290'>paren.</span> <span m='4515280'>If</span>
  <span m='4516120'>the</span> <span m='4516420'>previous</span> <span m='4516810'>character</span>
  <span m='4517330'>is an</span> <span m='4517780'>open</span> <span m='4518130'>paren,</span>
  <span m='4519210'>then</span> <span m='4519330'>you're</span> <span m='4519450'>done.</span>
  <span m='4520140'>That's</span> <span m='4520350'>your</span> <span m='4520440'>parent.</span>
  </p><p><span m='4521160'>So</span> <span m='4521270'>like</span> <span m='4521470'>here</span>
  <span m='4521730'>if</span> <span m='4521850'>you're</span> <span m='4521970'>at</span>
  <span m='4522180'>A,</span> <span m='4522570'>you</span> <span m='4522960'>go</span>
  <span m='4523050'>to</span> <span m='4523090'>the</span> <span m='4523130'>previous</span>
  <span m='4523500'>character</span> <span m='4523890'>and</span> <span m='4523980'>it's</span>
  <span m='4524280'>open</span> <span m='4524630'>paren,</span> <span m='4525540'>then</span>
  <span m='4525690'>you've</span> <span m='4525780'>just</span> <span m='4525930'>found</span>
  <span m='4526140'>the</span> <span m='4526230'>parent</span> <span m='4526490'>of
  A.</span> <span m='4526950'>There</span> <span m='4527070'>was</span> <span m='4527340'>no</span>
  <span m='4527550'>previous</span> <span m='4527910'>sibling.</span> <span m='4529680'>So</span>
  <span m='4530280'>in</span> <span m='4530400'>either</span> <span m='4530550'>case</span>
  <span m='4530790'>you</span> <span m='4530910'>end</span> <span m='4531030'>up</span>
  <span m='4531120'>with</span> <span m='4531330'>an</span> <span m='4531420'>open</span>
  <span m='4531660'>paren,</span> <span m='4531990'>corresponding</span> <span m='4532530'>to</span>
  <span m='4532620'>either</span> <span m='4532890'>your</span> <span m='4532980'>previous</span>
  <span m='4533280'>sibling</span> <span m='4534090'>or</span> <span m='4534210'>your</span>
  <span m='4534330'>parent.</span> <span m='4536400'>So</span> <span m='4536700'>that's</span>
  <span m='4537060'>left</span> <span m='4537330'>child,</span> <span m='4537600'>right</span>
  <span m='4537780'>child,</span> <span m='4538080'>parent.</span> <span m='4538620'>If</span>
  <span m='4538800'>you</span> <span m='4538920'>have</span> <span m='4539160'>this</span>
  <span m='4540120'>matching</span> <span m='4540690'>paren</span> <span m='4541080'>operation,</span>
  <span m='4541770'>you can</span> <span m='4542160'>do</span> <span m='4542310'>all</span>
  <span m='4542450'>of</span> <span m='4542510'>these</span> <span m='4542670'>in</span>
  <span m='4542790'>constant</span> <span m='4543180'>time,</span> <span m='4544170'>and</span>
  <span m='4546240'>little</span> <span m='4546570'>of</span> <span m='4546770'>n</span>
  <span m='4546930'>space</span> <span m='4547320'>beyond</span> <span m='4547740'>the</span>
  <span m='4547830'>2n</span> <span m='4548220'>bits</span> <span m='4548550'>to</span>
  <span m='4548670'>write</span> <span m='4548880'>down</span> <span m='4549570'>that</span>
  <span m='4549720'>bit</span> <span m='4549900'>string.</span> </p><p><span m='4552300'>That's</span>
  <span m='4552810'>not</span> <span m='4553020'>so</span> <span m='4553200'>exciting,</span>
  <span m='4553620'>because</span> <span m='4553860'>we</span> <span m='4553980'>just</span>
  <span m='4554190'>reinvented</span> <span m='4555150'>the</span> <span m='4555270'>same</span>
  <span m='4555810'>results</span> <span m='4556170'>we</span> <span m='4556260'>had</span>
  <span m='4556440'>before</span> <span m='4557170'>of</span> <span m='4557610'>doing</span>
  <span m='4557850'>left,</span> <span m='4558120'>right,</span> <span m='4558540'>and</span>
  <span m='4558750'>parent</span> <span m='4559740'>in</span> <span m='4559860'>constant</span>
  <span m='4560250'>time.</span> <span m='4561000'>But</span> <span m='4561210'>what</span>
  <span m='4561420'>we</span> <span m='4561570'>buy</span> <span m='4561900'>out</span>
  <span m='4562020'>of</span> <span m='4562110'>this</span> <span m='4562260'>representation</span>
  <span m='4563100'>is</span> <span m='4563220'>we</span> <span m='4563340'>can</span>
  <span m='4563460'>now</span> <span m='4563670'>do</span> <span m='4563820'>subtree</span>
  <span m='4564330'>size.</span> <span m='4566010'>So</span> <span m='4569030'>this
  is</span> <span m='4569180'>a</span> <span m='4569230'>little</span> <span m='4569490'>bit</span>
  <span m='4570780'>trickier.</span> </p><p><span m='4573000'>Let</span> <span m='4573090'>me</span>
  <span m='4573240'>go</span> <span m='4573390'>to</span> <span m='4573690'>another</span>
  <span m='4573960'>board.</span> <span m='4578407'>But</span> <span m='4578870'>whereas</span>
  <span m='4579220'>with</span> <span m='4579400'>level</span> <span m='4579760'>representation</span>
  <span m='4580510'>it</span> <span m='4580600'>was</span> <span m='4580750'>impossible,</span>
  <span m='4581920'>now</span> <span m='4582340'>it</span> <span m='4582430'>is</span>
  <span m='4582580'>possible.</span> <span m='4592650'>And</span> <span m='4592800'>we're</span>
  <span m='4592890'>going</span> <span m='4593040'>to</span> <span m='4593250'>use</span>
  <span m='4593600'>subtree</span> <span m='4593970'>size</span> <span m='4594330'>I</span>
  <span m='4594390'>think</span> <span m='4594630'>next</span> <span m='4594960'>class,</span>
  <span m='4595440'>when</span> <span m='4595590'>we</span> <span m='4595680'>do</span>
  <span m='4596700'>compact</span> <span m='4597330'>suffix</span> <span m='4597960'>trees.</span>
  <span m='4601150'>So</span> <span m='4602660'>subtree</span> <span m='4603140'>size</span>
  <span m='4603980'>is</span> <span m='4604130'>what</span> <span m='4604310'>we</span>
  <span m='4604460'>want</span> <span m='4606000'>in</span> <span m='4606500'>the</span>
  <span m='4606590'>binary</span> <span m='4607010'>try.</span> </p><p><span m='4609880'>In</span>
  <span m='4610070'>the</span> <span m='4610190'>rooted</span> <span m='4610580'>ordered</span>
  <span m='4611025'>tree</span> <span m='4611470'>it's</span> <span m='4611600'>a</span>
  <span m='4611630'>little</span> <span m='4611870'>tricky,</span> <span m='4612170'>because</span>
  <span m='4612320'>subtrees</span> <span m='4612770'>no</span> <span m='4612890'>longer</span>
  <span m='4613160'>correspond</span> <span m='4613580'>to</span> <span m='4613670'>subtrees.</span>
  <span m='4614420'>For</span> <span m='4614570'>example,</span> <span m='4614960'>the</span>
  <span m='4615050'>subtree</span> <span m='4615680'>of</span> <span m='4616010'>C</span>
  <span m='4617480'>consists</span> <span m='4618050'>of</span> <span m='4618920'>this</span>
  <span m='4619100'>subtree</span> <span m='4620270'>and</span> <span m='4620660'>this</span>
  <span m='4620860'>subtree,</span> <span m='4622050'>so</span> <span m='4622070'>it's</span>
  <span m='4622190'>really</span> <span m='4622490'>C--</span> <span m='4623450'>over</span>
  <span m='4623660'>here,</span> <span m='4623820'>it's</span> <span m='4623910'>C</span>
  <span m='4624290'>and</span> <span m='4624470'>all</span> <span m='4624680'>of</span>
  <span m='4624770'>its</span> <span m='4624920'>right</span> <span m='4625160'>siblings.</span>
  <span m='4627400'>So</span> <span m='4627650'>this</span> <span m='4627890'>is</span>
  <span m='4629400'>size</span> <span m='4630110'>of</span> <span m='4630470'>the</span>
  <span m='4630560'>node</span> <span m='4633590'>plus</span> <span m='4634340'>size</span>
  <span m='4636030'>of</span> <span m='4636460'>right</span> <span m='4636740'>siblings,</span>
  <span m='4640400'>however</span> <span m='4640730'>many</span> <span m='4640910'>you</span>
  <span m='4641030'>have.</span> </p><p><span m='4643220'>OK.</span> <span m='4643430'>So</span>
  <span m='4643610'>in</span> <span m='4644000'>the</span> <span m='4644180'>rooted</span>
  <span m='4644570'>ordered</span> <span m='4644855'>tree,</span> <span m='4645140'>it's</span>
  <span m='4645320'>actually</span> <span m='4645650'>kind</span> <span m='4645830'>of</span>
  <span m='4645920'>messy.</span> <span m='4646730'>Turns</span> <span m='4646970'>out</span>
  <span m='4647090'>in</span> <span m='4647180'>the</span> <span m='4647270'>balanced</span>
  <span m='4647540'>parenthesis</span> <span m='4648800'>it's</span> <span m='4649100'>pretty</span>
  <span m='4650270'>clean,</span> <span m='4651650'>because</span> <span m='4652040'>all</span>
  <span m='4652250'>your</span> <span m='4652400'>right</span> <span m='4652580'>siblings</span>
  <span m='4653420'>correspond</span> <span m='4653960'>to</span> <span m='4655100'>paren</span>
  <span m='4655520'>groups</span> <span m='4656000'>that</span> <span m='4656150'>just</span>
  <span m='4656300'>follow</span> <span m='4656660'>each</span> <span m='4656840'>other.</span>
  <span m='4657230'>And</span> <span m='4657320'>you</span> <span m='4657470'>want</span>
  <span m='4657650'>to</span> <span m='4657710'>know--</span> <span m='4658550'>so</span>
  <span m='4658670'>these</span> <span m='4658880'>are</span> <span m='4658970'>a</span>
  <span m='4659000'>bunch</span> <span m='4659240'>of</span> <span m='4659330'>siblings</span>
  <span m='4659840'>here</span> <span m='4662295'>of</span> <span m='4662720'>varying</span>
  <span m='4663080'>size.</span> </p><p><span m='4663860'>And</span> <span m='4664130'>we're</span>
  <span m='4664280'>given,</span> <span m='4664580'>say,</span> <span m='4664760'>this</span>
  <span m='4664880'>sibling.</span> <span m='4665270'>We</span> <span m='4665360'>want</span>
  <span m='4665510'>to</span> <span m='4665570'>know</span> <span m='4665700'>for</span>
  <span m='4665830'>this</span> <span m='4665990'>sibling,</span> <span m='4666470'>up</span>
  <span m='4666680'>to</span> <span m='4666950'>all</span> <span m='4667790'>the</span>
  <span m='4667910'>ones</span> <span m='4668150'>to</span> <span m='4668270'>the</span>
  <span m='4668360'>right--</span> <span m='4668820'>so</span> <span m='4668870'>there's</span>
  <span m='4669190'>an</span> <span m='4669620'>enclosing</span> <span m='4670370'>parenthesis</span>
  <span m='4671000'>here</span> <span m='4671210'>for</span> <span m='4671960'>our</span>
  <span m='4672290'>parent</span> <span m='4672710'>in</span> <span m='4672830'>this</span>
  <span m='4672950'>representation.</span> <span m='4675320'>We</span> <span m='4675470'>want</span>
  <span m='4675650'>to</span> <span m='4675710'>know</span> <span m='4676010'>the</span>
  <span m='4676220'>length</span> <span m='4676520'>of</span> <span m='4676610'>these,</span>
  <span m='4678010'>so</span> <span m='4678190'>it's</span> <span m='4678350'>just--</span>
  <span m='4684130'>we</span> <span m='4684370'>want</span> <span m='4684550'>to</span>
  <span m='4684610'>take</span> <span m='4684880'>the--</span> <span m='4685150'>here</span>
  <span m='4685420'>we</span> <span m='4685600'>are</span> <span m='4686020'>at</span>
  <span m='4686170'>this</span> <span m='4686440'>left</span> <span m='4686720'>paren.</span>
  <span m='4687400'>We</span> <span m='4687550'>want</span> <span m='4687700'>to</span>
  <span m='4687760'>compute</span> <span m='4688060'>the</span> <span m='4688180'>distance</span>
  <span m='4689920'>to</span> <span m='4691480'>the</span> <span m='4691630'>enclosing</span>
  <span m='4694170'>close</span> <span m='4694570'>paren.</span> <span m='4696590'>So</span>
  <span m='4696850'>that's</span> <span m='4697120'>here.</span> <span m='4699880'>That's</span>
  <span m='4700060'>our</span> <span m='4700120'>enclosing</span> <span m='4700630'>close</span>
  <span m='4700880'>paren.</span> </p><p><span m='4701110'>So</span> <span m='4701530'>here's</span>
  <span m='4701860'>a</span> <span m='4701920'>new</span> <span m='4702070'>operation.</span>
  <span m='4702670'>Given</span> <span m='4703180'>a</span> <span m='4703270'>paren</span>
  <span m='4703620'>pair,</span> <span m='4704350'>I</span> <span m='4704410'>want</span>
  <span m='4704530'>to</span> <span m='4704650'>compute</span> <span m='4705130'>the
  enclosing</span> <span m='4706270'>paren</span> <span m='4706585'>pair,</span> <span
  m='4706900'>these</span> <span m='4707110'>guys.</span> <span m='4709080'>That</span>
  <span m='4709450'>can</span> <span m='4709600'>also</span> <span m='4709870'>be</span>
  <span m='4709960'>done</span> <span m='4710110'>in</span> <span m='4710200'>constant</span>
  <span m='4710560'>time</span> <span m='4710860'>with</span> <span m='4711040'>rank-and-select-like</span>
  <span m='4711850'>techniques.</span> <span m='4713110'>And</span> <span m='4713230'>then</span>
  <span m='4713380'>you</span> <span m='4713440'>just</span> <span m='4713620'>measure</span>
  <span m='4714010'>this</span> <span m='4714220'>distance</span> <span m='4715330'>and</span>
  <span m='4715540'>you</span> <span m='4715600'>divide</span> <span m='4715900'>by</span>
  <span m='4716050'>2.</span> </p><p><span m='4716620'>That</span> <span m='4716830'>will</span>
  <span m='4716950'>give</span> <span m='4717160'>you</span> <span m='4717340'>the</span>
  <span m='4717520'>number</span> <span m='4718480'>of</span> <span m='4718810'>nodes</span>
  <span m='4719320'>in</span> <span m='4719470'>here.</span> <span m='4719690'>It's</span>
  <span m='4719830'>half</span> <span m='4720130'>the</span> <span m='4720190'>number</span>
  <span m='4720430'>of</span> <span m='4720490'>paren.</span> <span m='4721810'>That</span>
  <span m='4721960'>will</span> <span m='4722050'>give</span> <span m='4722200'>you</span>
  <span m='4722290'>subtree</span> <span m='4722650'>size.</span> </p><p><span m='4723580'>And</span>
  <span m='4723770'>we</span> <span m='4723820'>have</span> <span m='4723910'>a</span>
  <span m='4723970'>couple</span> <span m='4724450'>extra</span> <span m='4724750'>seconds,</span>
  <span m='4725140'>so</span> <span m='4725900'>another</span> <span m='4726160'>bonus</span>
  <span m='4726790'>is</span> <span m='4727000'>suppose</span> <span m='4727420'>you</span>
  <span m='4727510'>want</span> <span m='4727660'>to</span> <span m='4727720'>know</span>
  <span m='4727930'>the</span> <span m='4728020'>number</span> <span m='4728320'>of</span>
  <span m='4728410'>leaves</span> <span m='4728770'>in</span> <span m='4728860'>a</span>
  <span m='4728980'>subtree.</span> <span m='4733390'>If</span> <span m='4733510'>I</span>
  <span m='4733600'>recall</span> <span m='4734020'>correctly,</span> <span m='4735400'>that's</span>
  <span m='4735660'>something</span> <span m='4736060'>like--</span> <span m='4737350'>instead</span>
  <span m='4737680'>of</span> <span m='4737770'>doing</span> <span m='4738010'>this</span>
  <span m='4738190'>distance</span> <span m='4738445'>to</span> <span m='4738700'>the
  enclosing</span> <span m='4740050'>paren,</span> <span m='4740500'>you</span> <span
  m='4740590'>do</span> <span m='4740740'>something</span> <span m='4741100'>like</span>
  <span m='4742090'>rank</span> <span m='4743340'>of--</span> <span m='4745300'>just</span>
  <span m='4745570'>rank</span> <span m='4745870'>of</span> <span m='4745960'>that.</span>
  <span m='4746470'>Those are</span> <span m='4746740'>the</span> <span m='4746830'>number</span>
  <span m='4747100'>of</span> <span m='4747220'>leaves</span> <span m='4750740'>of</span>
  <span m='4752660'>the</span> <span m='4753545'>enclosing</span> <span m='4756620'>close</span>
  <span m='4756920'>paren--</span> <span m='4758920'>this</span> <span m='4759230'>is</span>
  <span m='4759440'>getting</span> <span m='4759950'>notationally</span> <span m='4760430'>confusing--</span>
  <span m='4761210'>minus</span> <span m='4761840'>the</span> <span m='4761990'>rank</span>
  <span m='4764180'>of</span> <span m='4766010'>here.</span> </p><p><span m='4768060'>OK.</span>
  <span m='4768200'>So</span> <span m='4768470'>I</span> <span m='4768620'>just</span>
  <span m='4768800'>want</span> <span m='4768920'>to</span> <span m='4769010'>compute</span>
  <span m='4769340'>how</span> <span m='4769610'>many</span> <span m='4769970'>open</span>
  <span m='4770390'>parens,</span> <span m='4770510'>close</span> <span m='4770750'>parens</span>
  <span m='4771050'>are</span> <span m='4771260'>there</span> <span m='4771440'>from</span>
  <span m='4771620'>here</span> <span m='4771830'>to</span> <span m='4771920'>here.</span>
  <span m='4772790'>And</span> <span m='4772880'>so</span> <span m='4773000'>I</span>
  <span m='4773060'>just</span> <span m='4773240'>take</span> <span m='4773450'>the</span>
  <span m='4773540'>rank</span> <span m='4773810'>here,</span> <span m='4774380'>subtract</span>
  <span m='4774800'>by</span> <span m='4774920'>the</span> <span m='4775010'>rank</span>
  <span m='4775250'>here.</span> <span m='4776030'>That</span> <span m='4776150'>gives</span>
  <span m='4776330'>me</span> <span m='4776420'>the</span> <span m='4776540'>number</span>
  <span m='4776780'>of</span> <span m='4776870'>leaves</span> <span m='4777140'>in</span>
  <span m='4777320'>that</span> <span m='4777500'>range.</span> </p><p><span m='4778770'>So</span>
  <span m='4778820'>this</span> <span m='4779030'>is</span> <span m='4779120'>a</span>
  <span m='4779210'>generalization</span> <span m='4779840'>of</span> <span m='4779930'>rank.</span>
  <span m='4780120'>Before</span> <span m='4780410'>we</span> <span m='4780500'>did</span>
  <span m='4780650'>rank</span> <span m='4780980'>of</span> <span m='4781130'>just</span>
  <span m='4781310'>a</span> <span m='4781370'>single</span> <span m='4781730'>bit.</span>
  <span m='4782360'>This</span> <span m='4782500'>is</span> <span m='4782600'>rank</span>
  <span m='4782930'>of</span> <span m='4783140'>a</span> <span m='4783230'>two-bit</span>
  <span m='4783620'>pattern.</span> <span m='4784610'>But</span> <span m='4785180'>two
  bits</span> <span m='4785570'>is</span> <span m='4785690'>not</span> <span m='4785810'>much</span>
  <span m='4785990'>harder</span> <span m='4786170'>than</span> <span m='4786320'>one</span>
  <span m='4786500'>bit.</span> <span m='4786920'>You</span> <span m='4787010'>can</span>
  <span m='4787580'>very</span> <span m='4787790'>easily</span> <span m='4788090'>adapt</span>
  <span m='4788480'>the</span> <span m='4788600'>rank</span> <span m='4788870'>structure</span>
  <span m='4789260'>we</span> <span m='4789380'>saw</span> <span m='4790100'>to</span>
  <span m='4790190'>do</span> <span m='4790340'>any</span> <span m='4790580'>two-bit</span>
  <span m='4790940'>pattern</span> <span m='4791270'>instead</span> <span m='4791570'>of</span>
  <span m='4791660'>just</span> <span m='4792170'>the</span> <span m='4792260'>one</span>
  <span m='4792470'>bit.</span> </p><p><span m='4794870'>So</span> <span m='4795380'>that</span>
  <span m='4795590'>gives</span> <span m='4795860'>you</span> <span m='4796040'>the</span>
  <span m='4796100'>number</span> <span m='4796310'>of</span> <span m='4796400'>leaves</span>
  <span m='4796580'>in</span> <span m='4796670'>the</span> <span m='4796730'>subtree,</span>
  <span m='4797090'>which</span> <span m='4797270'>corresponds</span> <span m='4797690'>to</span>
  <span m='4797750'>the</span> <span m='4797840'>number</span> <span m='4798050'>of</span>
  <span m='4798110'>matches.</span> <span m='4798840'>So</span> <span m='4798890'>you</span>
  <span m='4798980'>can</span> <span m='4799100'>do</span> <span m='4799220'>lots</span>
  <span m='4799460'>of</span> <span m='4799520'>fun</span> <span m='4799730'>things</span>
  <span m='4800480'>like</span> <span m='4800660'>this.</span> <span m='4800975'>This</span>
  <span m='4801290'>representation</span> <span m='4801920'>is</span> <span m='4801970'>super</span>
  <span m='4802150'>powerful</span> <span m='4803260'>and</span> <span m='4803490'>we'll</span>
  <span m='4803790'>use</span> <span m='4804090'>it next</span> <span m='4804390'>time.</span>
  </p>
type: course
uid: cdfd82ac5a7d3a096bf1a1c8c982bfa2

---
None